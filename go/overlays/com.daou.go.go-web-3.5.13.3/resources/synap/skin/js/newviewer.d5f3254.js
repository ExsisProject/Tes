/*!
 * 
 * Product name/Version: SynapDocumentViewer 23.4.0
 * 
 */!function(e){function t(t){for(var i,a,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);h.length;)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={1:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;r.push([172,0]),n()}([function(e,t,n){"use strict";(function(e,i){var o=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.ORIENTATION=t.SERVICE_VERSION=void 0;var a,s,l=n(3),c=n(1),d=n(37),u=n(61),h=n(107),f=n(52),p=n(19);!function(e){e[e.v2019=0]="v2019",e[e.v2022=1]="v2022"}(a=t.SERVICE_VERSION||(t.SERVICE_VERSION={})),function(e){e[e.PORTRAIT=0]="PORTRAIT",e[e.LANDSCAPE=1]="LANDSCAPE"}(s=t.ORIENTATION||(t.ORIENTATION={}));var m=function(){function t(){}var n;return t.ajaxCall=function(n,i,o,r){return void 0===i&&(i="GET"),void 0===o&&(o=null),void 0===r&&(r=null),new e((function(e,a){var s="";if(o&&"object"==typeof o.param)for(var l in s.length>0&&(s+="&"),o.param)s+=l+"="+encodeURIComponent(o.param[l])+"&";s=t.setExtraParam(s);var c=new XMLHttpRequest;if("POST"===i)if("json"===r){var d=t.setQueryString(n,s);c.open("POST",d,!0),c.setRequestHeader("Content-Type","application/json")}else c.open("POST",n,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");else{d=t.setQueryString(n,s);c.open("GET",d,!0),"js"===r&&c.setRequestHeader("Content-Type","application/javascript; charset=UTF-8")}if(window.localSynap&&window.localSynap.config&&"object"==typeof window.localSynap.config.extraHeader)for(var l in window.localSynap.config.extraHeader)c.setRequestHeader(l,window.localSynap.config.extraHeader[l]);c.onreadystatechange=function(){4===c.readyState&&(c.status>=200&&c.status<400?e(null!==r&&"xml"===r?c.responseXML:c.responseText):null!==r&&"xml"===r&&500===c.status?e(null):a(new Error(c.status.toString())))},"POST"===i&&"json"===r?c.send(o):c.send(s)}))},t.setQueryString=function(e,t){var n=c.Browser.instance.isIE9Lower()?encodeURI(e):e;return n.indexOf("?")>-1?n+="&"+t:n+="?"+t,n},t.setExtraParam=function(e){var t=e;if(window.localSynap&&window.localSynap.config&&"object"==typeof window.localSynap.config.extraParam)for(var n in t.length>0&&(t+="&"),window.localSynap.config.extraParam)t+=n+"="+encodeURIComponent(window.localSynap.config.extraParam[n])+"&";return t},t.getJson=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),o(this,void 0,void 0,(function(){var i;return r(this,(function(o){switch(o.label){case 0:return[4,this.ajaxCall(e,"GET",t,n)];case 1:return i=o.sent(),[2,JSON.parse(i)]}}))}))},t.postJsonAjax=function(e,n){void 0===n&&(n=null);var i=null,o=t.getUrlWithExtraParam(e);return l.ajax({type:"POST",url:o,data:n,contentType:"application/json",async:!1,success:function(e){i=e},error:function(e){throw new Error(e.status+" "+e.statusText)}}),i},t.postJson=function(e,t){return void 0===t&&(t=null),o(this,void 0,void 0,(function(){var n;return r(this,(function(i){switch(i.label){case 0:return[4,this.ajaxCall(e,"POST",t)];case 1:return n=i.sent(),[2,JSON.parse(n)]}}))}))},t.getXml=function(e,t){return void 0===t&&(t=null),o(this,void 0,void 0,(function(){var n;return r(this,(function(i){switch(i.label){case 0:return[4,this.ajaxCall(e,"GET",t,"xml")];case 1:return n=i.sent(),[2,this.xmlToJson(n)]}}))}))},t.getThumbnailXml=function(e,t){return void 0===t&&(t=null),o(this,void 0,void 0,(function(){var n,i;return r(this,(function(o){switch(o.label){case 0:return[4,this.ajaxCall(e,"GET",t,"xml")];case 1:return(n=o.sent())?[3,4]:(i=e.replace("thumbnailxml","thumbnail"),[4,this.ajaxCall(i,"GET",t)]);case 2:return o.sent(),[4,this.ajaxCall(e,"GET",t,"xml")];case 3:n=o.sent(),o.label=4;case 4:return[2,this.xmlParse(n)]}}))}))},t.xmlParse=function(e){var t={};if(!e.hasChildNodes())return t;var n=e.getElementsByTagName("page")[0];if("page"!=n.tagName)return{};if(n.attributes.length>0){t.page={};for(var i=0;i<n.attributes.length;i++){var o=n.attributes.item(i);t.page[o.nodeName]=o.nodeValue}}var r=c.Browser.instance.isIE9Lower(),a=function(e){var t=[],n="",i=e.getElementsByTagName("text");return Array.from(i).forEach((function(e){if(r||0!==e.textContent.length){for(var i={},o=0;o<e.attributes.length;o++){var a=e.attributes.item(o);i[a.nodeName]=Number(a.nodeValue).toFixed(2)}var s=function(e){return r?0===e.text.length?" ":e.text:e.textContent}(e);t.push({"@attributes":i,text:s}),n+=s}})),{textResult:t,allText:n}},s=e.getElementsByTagName("cell"),l=e.getElementsByTagName("shape");if(s.length>0||l.length>0){var d=function(e){var t=[],n="",i=e.getElementsByTagName("cell");return Array.from(i).forEach((function(e){for(var i={},o=0;o<e.attributes.length;o++){var r=e.attributes.item(o);i[r.nodeName]=Number(r.nodeValue).toFixed(2)}var s=a(e);n+=s.allText+"\n",t.push({"@attributes":i,text:s.textResult,allText:s.allText})})),{cellsResult:t,allText:n}}(e);t.cells=d.cellsResult,t.result=d.allText}else{var u=a(e);t.text=u.textResult,t.result=r?u.allText:n.textContent.replace(/\n/gi,"")}for(var h=[],f=0,p=0,m=e.getElementsByTagName("link");p<m.length;p++){for(var g=m[p],v={},b={},y=0;y<g.attributes.length;y++){var E=g.attributes.item(y);"l"==E.nodeName||"t"==E.nodeName||"w"==E.nodeName||"h"==E.nodeName?b[E.nodeName]=Number(E.nodeValue).toFixed(2):v[E.nodeName]=E.nodeValue}v["@attributes"]=b,h[f]=v,f++}return t.link=h,t},t.xmlToJson=function(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n);t["@attributes"][i.nodeName]=i.nodeValue}}}else if(3===e.nodeType){var o=e.nodeValue.trim();if(o.length)return o}else if(4===e.nodeType)return e.data;if(e.hasChildNodes())for(var r=0,a=e.childNodes.length;r<a;r++){var s=e.childNodes.item(r),l=s.nodeName;if(void 0===t[l]){var c=this.xmlToJson(s);Object.keys(new Object(c)).length&&(l[0]&&"#"===l[0]?t=c:t[l]=c)}else{var d=this.xmlToJson(s);if(0===Object.keys(new Object(d)).length)continue;void 0===t[l].push?t[l]=[t[l],d]:t[l].push(d)}}return t},t.isMobileMode=function(){if(c.Browser.instance.isMobile)return!0;if(document.documentElement.clientWidth<=t.MaxMobileModeWidth)return!0;var e=screen.width/screen.height;return screen.width>=1024&&screen.height<=1024&&e<=1.7||(c.Browser.instance.isIE?screen.width*d.DetectZoom.getRatio():screen.width)<=1024},t.isSmallScreen=function(){return document.documentElement.clientWidth<=500},t.isFullScreen=function(){return l("#container").hasClass("wrap__container--presentation")},t.isBrowserFullScreen=function(){return t.isFullScreen()&&!l(".wrap__header").hasClass("wrap__header--presentation")},t.isSupportFullScreen=function(){var e=top.document;return top.document.fullscreenEnabled||e.mozFullScreenEnabled||e.webkitFullscreenEnabled||e.msFullscreenEnabled},t.getThumbPath=function(e,n,i,o){void 0===o&&(o=null);var r=i||u.DPI.thumbDPI,a="";if(o)for(var s in o)a+="&"+s+"="+encodeURIComponent(o[s]);if(t.isUseAnnotation(e)&&(a+="&dispAnnot=2"),""!=(a=t.setExtraParam(a))&&"&"!=a.charAt(0)&&(a="&"+a),e.status.imageConverting){var l=window.localSynap.config.thumbnailExt?"."+window.localSynap.config.thumbnailExt:".png";return e.contextPath+"/thumbnail/"+n+l+"?dpi="+r+"&withXml=false"+a}return e.contextPath+"/thumbnail/"+e.jobId+"/"+n+"?dpi="+r+"&withXml=true"+a},t.getResultPath=function(e,n){var i=e.resultPath+"/"+n;return t.getUrlWithExtraParam(i)},t.getUrlWithExtraParam=function(e){var n=t.setExtraParam("");return t.setQueryString(e,n)},t.setAnnotQueryString=function(e){return void 0!==e.annotToken?"annotToken="+e.annotToken:""},t.printConsoleLog=function(e){window.console&&console.log(e)},t.getMouseHandlerDispatch=function(e,t){return void 0===t&&(t=function(e){return!0}),function(n){if(t(n))if(c.Browser.instance.isIE){(i=document.createEvent("MouseEvent")).initMouseEvent&&i.initMouseEvent(n.type,!0,!0,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),e.dispatchEvent(i)}else{var i=new MouseEvent(n.type,n);e.dispatchEvent(i)}}},t.getKeybordHandlerDispatch=function(e){return function(t){if(c.Browser.instance.isIE||c.Browser.instance.isEdge){(n=document.createEvent("KeyboardEvent")).initKeyboardEvent&&n.initKeyboardEvent(t.type,!0,!0,t.view,t.key,t.location,t.modifiersList,t.repeat,t.locale),e.dispatchEvent(n)}else{var n=new KeyboardEvent(t.type,t);e.dispatchEvent(n)}}},t.getTouchHandlerDispatch=function(e){return function(t){var n=new TouchEvent(t.type,t);e.dispatchEvent(n)}},t.fill=function(e,t){for(var n=0;n<e.length;n++)e[n]=t;return e},t.getParameter=function(){var e=document.createElement("a");e.href=window.location.href;for(var t={},n=0,i=e.search.slice(1).split("&");n<i.length;n++){var o=i[n],r=o.split("=")[0],a=o.split("=")[1];t[r]=decodeURIComponent(a)}return t},t.getParameterFromURL=function(e){var t=document.createElement("a");t.href=e;for(var n={},i=0,o=t.search.slice(1).split("&");i<o.length;i++){var r=o[i],a=r.split("=")[0],s=r.split("=")[1];null!=s&&(n[a]=decodeURIComponent(s))}return n},t.getServerDpi=function(n){return o(void 0,void 0,e,(function(){var e,i,o;return r(this,(function(r){switch(r.label){case 0:e=96,i=n+"/config/dpi",o=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.ajaxCall(i,"GET")];case 2:return o=r.sent(),e=parseInt(o),[3,4];case 3:return r.sent(),t.printConsoleLog("fail to call api - /cli"),[3,4];case 4:return[2,e]}}))}))},t.MaxMobileModeWidth=768,t.isSupportKeyFrame=function(){var e=getComputedStyle(document.querySelector(".wrap__contents"));return!(!e.animation&&!e.webkitAnimation)},t.sleep=function(t){return new e((function(e){return setTimeout(e,t)}))},t.bindClickOrTouchEvent=function(e,n,i,o,r){void 0===i&&(i=function(e){}),void 0===o&&(o=function(t){e.removeClass(n)}),void 0===r&&(r=function(t){e.addClass(n)}),e.on(c.Browser.instance.isMobile?"touchstart":"mouseover",(function(t){e.prop("disabled")||r(t)})).on(c.Browser.instance.isMobile?"click touchend":"mouseout click",(function(t){(c.Browser.instance.isMobile&&"click"===t.type||"touchend"===t.type||"mouseout"===t.type)&&o(t),"click"===t.type&&(e.prop("disabled")||i(t))}));for(var a=0;a<e.length;++a)t.bindEnterKey(e[a])},t.bindClickEvent=function(e,n,i){void 0===n&&(n=function(e){}),void 0===i&&(i=!1),e.addEventListener("click",(function(e){n(e)})),i?t.bindEnterKey(e,n):t.bindEnterKey(e)},t.bindOnceClickEvent=function(e,n){var i=function(t){n(t),e.removeEventListener("click",i)};e.addEventListener("click",i),t.bindOnceEnterKey(e)},t.getDimensionHtmlForPDF=function(e){var t=[];if(1==e.index.pdf_cnt){var n={index:0,width:e.index.pdf_list.pdf.w,height:e.index.pdf_list.pdf.h,origin_width:e.index.pdf_list.pdf.w,origin_height:e.index.pdf_list.pdf.h,path:e.index.pdf_list.pdf.path_html};return t[0]=n,t}var i=1,o=parseInt(e.index.pdf_cnt);return 1===window.localSynap.config.loadingRangeType&&(e.index.startPage&&(i=parseInt(e.index.startPage)),e.index.endPage&&(o=parseInt(e.index.endPage))),l.each(e.index.pdf_list.pdf,(function(e,n){var r=parseInt(n.id);if(r<i)return!0;if(r>o)return!1;var a=parseInt(e)-i+1,s={index:a,width:n.w,height:n.h,origin_width:n.w,origin_height:n.h,path:n.path_html};t[a]=s})),t},t.getDimensionHtmlForImage=function(e){var t=[];if(1==e.index.image_cnt){var n={index:0,width:e.index.width,height:e.index.height,origin_width:e.index.width,origin_height:e.index.height,path:e.index.image_list.image.path_image};t[0]=n}else l.each(e.index.image_list.image,(function(e,n){var i={index:e,width:n.w,height:n.h,origin_width:n.w,origin_height:n.h,path:n.path_image};t[e]=i}));return t},t.isServer=function(e){return e.productType===h.PRODUCT_TYPE.SERVER},t.isHtmlSkin=function(e){return t.isHtmlWordSkin(e)||t.isHtmlCellSkin(e)||t.isHtmlSlideSkin(e)},t.isHtmlWordSkin=function(e){return t.isConvHtml(e)&&"word"===e.skinType},t.isHtmlCellSkin=function(e){return t.isConvHtml(e)&&"cell"===e.skinType},t.isHtmlSlideSkin=function(e){return t.isConvHtml(e)&&"slide"===e.skinType},t.isHtmlImageSkin=function(e){return t.isConvHtml(e)&&("image"===e.skinType||"pdf"===e.skinType)},t.isConvHtml=function(e){return e.status.convertType===h.CONV_TYPE.HTML},t.isConvImg=function(e){return e.status.convertType===h.CONV_TYPE.IMAGE},t.isHTMLFormat=function(e){return"mhtml"===e.fileType||"html"===e.fileType||"msg"===e.fileType||"eml"===e.fileType},t.useSingle=function(e){return t.isHtmlSkin(e)&&e.status.single},t.getHeadScale=function(e){var t="string"==typeof l(e).css("transform")?l(e).css("transform").replace("matrix(","").split(","):[];return 6===t.length?parseFloat(t[0]):1},t.isUseAnnotation=function(e){return!t.isConvHtml(e)&&!!window.localSynap.config.useAnnotation&&!e.status.simode},t.isUseSearch=function(e){return(null==window.localSynap.config.search||window.localSynap.config.search)&&"image"!==e.skinType&&!e.status.simode&&!t.isHtmlSkin(e)},t.isCellSkin=function(e){return"cell"===e.skinType},t.isPDF=function(e){return"pdf"===e.skinType},t.needDocumentFitCss=function(e){return t.isHtmlWordSkin(e)||t.isHtmlCellSkin(e)},t.allowCopy=function(){return!(!1===window.localSynap.config.allowCopy)},t.removeContentsAreaTooltip=function(){return!!window.localSynap.config.removeContentsAreaTooltip},t.rotatePdf=function(e){return!1===window.localSynap.config.search&&!window.localSynap.config.useAnnotation&&"pdf"===e.skinType&&!!window.localSynap.config.rotatePdf},t.rotateImage=function(e){return!window.localSynap.config.useAnnotation&&"image"===e.skinType},t.fixedPageFit=function(){return!!window.localSynap.config.fixedPageFit},t.headerAutoHide=function(){return!(!1===window.localSynap.config.headerAutoHide)},t.setServiceType=function(e){t.SERVICE_TYPE=e},t.isDocslive=function(){return"docslive"===t.SERVICE_TYPE},t.setServiceVersion=function(e){t.SERVICE_VERSION="v2019"===e?a.v2019:a.v2022},t.getServiceVersion=function(){return t.SERVICE_VERSION},t.getServiceVersionString=function(){return t.getServiceVersion()===a.v2019?"2019":"2022"},t.isSupportedVer2022=function(){return t.getServiceVersion()===a.v2022},t.clone=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.getSize=function(e,t){var n=e,i="B";return t||-1===e?"-":(e>1073741824?(n=e/1073741824,i="GB"):e>1048576?(n=e/1048576,i="MB"):e>1024&&(n=e/1024,i="KB"),""+n.toFixed(1)+i)},t.toFixedNumber=function(e,t){return"string"==typeof e?parseFloat(parseFloat(e).toFixed(t)):parseFloat(e.toFixed(t))},t.addClass=function(e,t){if(e)if(e.classList)e.classList.add(t);else{for(var n=!1,i=e.className.trim().split(" "),o=0;o<i.length;o++)if(i[o]===t){n=!0;break}n||(e.className=e.className.trim()+" "+t)}},t.removeClass=function(e,t){if(e)if(e.classList)e.classList.remove(t);else{var n="";e.className.trim().split(" ").forEach((function(e){e!==t&&(n+=e+" ")})),e.className=n.trim()}},t.addClasses=function(e,n){for(var i=0,o=e;i<o.length;i++){var r=o[i];t.addClass(r,n)}},t.removeClasses=function(e,n){for(var i=0,o=e;i<o.length;i++){var r=o[i];t.removeClass(r,n)}},t.removeElem=function(e){e&&(e.remove?e.remove():e.parentNode.removeChild(e))},t.getClickEventName=function(){return"click"},t.getClickOrTouchEventName=function(){return c.Browser.instance.isMobile?"touchend":"click"},t.getClickStartEventName=function(){return c.Browser.instance.isMobile?"touchstart":c.Browser.instance.isSafari||c.Browser.instance.isIE10Lower()?"mousedown":"pointerdown"},t.getClickEndEventName=function(){return c.Browser.instance.isMobile?"touchend":c.Browser.instance.isSafari||c.Browser.instance.isIE10Lower()?"mouseup":"pointerup"},t.getMoveEventName=function(){return c.Browser.instance.isMobile?"touchmove":c.Browser.instance.isSafari||c.Browser.instance.isIE10Lower()?"mousemove":"pointermove"},t.hasClass=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},t.hasClassForEventTargetEl=function(e,n,i){void 0===i&&(i=3);var o=function(e){return e&&"HTML"===e.tagName};if(o(e))return!1;for(var r=t.containClassName(e,n),a=e,s=1;s<i;++s){if(r)return!0;var l=t.getParentElement(a);if(!l||o(l))return!1;r=t.containClassName(l,n),a=l}return r},t.nonPassiveEventListenerOption={passive:!1},t.isSelected=function(){var e=window.getSelection();return!!(e&&e.rangeCount>0&&e.toString())},t.cancelSelection=function(){var e=window.getSelection();e&&e.rangeCount>0&&e.getRangeAt(0).getClientRects().length>0&&e.removeAllRanges()},t.getSelectedTextElIdRange=function(){var e=window.getSelection().getRangeAt(0),n=e.startContainer,i=e.endContainer,o=1===n.nodeType?n:n.parentNode;if(c.Browser.instance.isIOS){if(o.id.indexOf("page-area")>-1){var r=o.id.substring("page-area".length);o=document.getElementById("text-"+r+"-0")}}var a=1===i.nodeType?i:i.parentNode;return o&&o.className&&-1!==o.className.indexOf("text")&&a&&a.className&&-1!==a.className.indexOf("text")?{startTextId:o.id,endTextId:a.id}:(t.cancelSelection(),null)},t.blendColors=function(e,t,n){var i=e.match(/\w\w/g).map((function(e){return parseInt(e,16)})),o=i[0],r=i[1],a=i[2],s=t.match(/\w\w/g).map((function(e){return parseInt(e,16)})),l=s[0],c=s[1],d=s[2];return"#"+Math.round(o+(l-o)*n).toString(16).padStart(2,"0")+Math.round(r+(c-r)*n).toString(16).padStart(2,"0")+Math.round(a+(d-a)*n).toString(16).padStart(2,"0")},t.removeExtension=function(e,t){var n=e.lastIndexOf(".");return-1!==n&&e.substring(n+1)===t?e.substring(0,n):e},t.disableEvent=function(e){e.preventDefault()},t.showLoadingDimmed=function(e){void 0===e&&(e=!1);if(t.removeClass(document.getElementById("loading-dimmed"),"loading-dimmed--hide"),e){var n=document.getElementById("percent-message");t.removeClass(n,"hide")}},t.hideLoadingDimmed=function(){t.addClass(document.getElementById("loading-dimmed"),"loading-dimmed--hide");var e=document.getElementById("percent-message");t.addClass(e,"hide")},t.getTimestamp=function(){var e=new Date;return"D:"+e.getFullYear().toString().padStart(4,"0")+(e.getMonth()+1).toString().padStart(2,"0")+e.getDate().toString().padStart(2,"0")+e.getHours().toString().padStart(2,"0")+e.getMinutes().toString().padStart(2,"0")+e.getSeconds().toString().padStart(2,"0")},t.syncTimer=function(t,n){return o(void 0,void 0,void 0,(function(){return r(this,(function(i){return[2,new e((function(e){setTimeout((function(){t(),e()}),n)}))]}))}))},t.getIdxFromElmId=function(e,t){return parseInt(e.substring(t.length))},t.getParentElement=function(e){var t=e.parentElement?e.parentElement:e.parentNode;return null===t&&console.log(e+"cannot get parent"),t},t.getTmpPathElem=function(e){return t.getParentElement(e).getElementsByClassName("tmp-marker-path")?t.getParentElement(e).getElementsByClassName("tmp-marker-path")[e.childElementCount-1]:e.getElementById("tmp-marker-path")},t.containClassName=function(e,t){return!!e&&(e.classList?e.classList.contains(t):!(!e.getAttribute||!e.getAttribute("class"))&&e.getAttribute("class").indexOf(t)>-1)},t.disableKeyEventForPageMove=function(e){e.addEventListener("keydown",(function(e){switch(e.keyCode){case f.keyMap.PAGEUP:case f.keyMap.PAGEDOWN:e.preventDefault(),e.stopPropagation();break;case f.keyMap.HOME:case f.keyMap.END:case f.keyMap.UPARROW:case f.keyMap.LEFTARROW:case f.keyMap.DOWNARROW:case f.keyMap.RIGHTARROW:e.stopPropagation()}}))},t.rangeVal=function(e,t,n){return Math.min(Math.max(t,e),n)},t.isFunction=function(e){return"function"==typeof e},t.bindEnterKey=function(e,t){e.addEventListener("keydown",(function(n){"Enter"===n.key&&(t?t(n):e.click())}))},t.bindOnceEnterKey=function(e){var t=function(){return function(n){"Enter"===n.key&&(e.click(),e.removeEventListener("keydown",t))}};e.addEventListener("keydown",t)},t.basicTabList=["page__input","select-arrow","header-tablist__input","export-pdf-btn","server-pdf-btn","marker-btn","sns-btn","info-btn","print-btn","thumbnailview-btn","download-btn","search-btn","search__input","search-prev","search-next","search-close","backgroundcolor-btn","presentation-btn","tabmore","fullscreen","more-btn","mobile-download-btn","mobile-export-pdf-btn","mobile-sns-btn","mobile-bgcolor-btn","mobile-print-btn","mobile-info-btn","mobile-window-close-btn","mobile-thumbnailbar","fullscreen-close","fullscreen-prev","fullscreen-next"],t.curTabList=new i,t.setTabIndexList=function(e,n,i){for(var o=isNaN(n)?1:n,r=e||t.basicTabList,a=0;a<r.length;a++)t.setTabIndex(document.getElementById(r[a]),i?o:o++);return o},t.clearTabIndexList=function(e){for(var n=e||t.basicTabList,i=0;i<n.length;i++)t.rmTabIndex(document.getElementById(n[i]))},t.setTabIndex=function(e,n){e&&(e.tabIndex=n,t.curTabList.set(e,n))},t.rmTabIndex=function(e){e&&(e.tabIndex=-1,t.curTabList.delete(e))},t.initTabIndex=function(){t.curTabList.forEach((function(e,t){t.tabIndex=-1}))},t.restoreTabIndex=function(){t.curTabList.forEach((function(e,t){t.tabIndex=e}))},t.getPageXOffset=function(e){return void 0===e&&(e=!1),c.Browser.instance.isIOS&&(!e||c.Browser.instance.isIOS12Lower())||!c.Browser.instance.isSupportVisualViewport()?window.pageXOffset:window.visualViewport.offsetLeft},t.getPageYOffset=function(e){return void 0===e&&(e=!1),c.Browser.instance.isIOS&&(!e||c.Browser.instance.isIOS12Lower())||!c.Browser.instance.isSupportVisualViewport()?window.pageYOffset:window.visualViewport.offsetTop},t.getInnerWidth=function(){return c.Browser.instance.isIOS||!c.Browser.instance.isSupportVisualViewport()?window.innerWidth:window.visualViewport.width},t.getInnerHeight=function(){return c.Browser.instance.isIOS||!c.Browser.instance.isSupportVisualViewport()?window.innerHeight:window.visualViewport.height},t.setVHVariable=function(){return document.documentElement.style.setProperty("--vh",t.getInnerHeight()/p.ScaleEvent.getBrowserScale()*.01+"px")},t.adjustBrowserScale=function(e){var n=t.getInnerWidth()/document.getElementById("container").clientWidth;e.style.transform=1==n?"":"scale("+n+")"},t.getDefaultViewPortString=function(){return window.screen.width<=t.MaxMobileModeWidth||c.Browser.instance.isIOS?"width=device-width, initial-scale=1.0, minimum-scale=1.0":"width=device-width, minimum-scale=1.0"},t.isActiveSearch=function(){return t.hasClass(document.getElementById("search-btn__img"),"search-btn__img--on")},t.isTabletInCSS=(n=window.matchMedia&&window.matchMedia("screen and (max-device-width: 1024px) and (min-device-height: 1024px) and (min-device-aspect-ratio : 10/17), screen and (min-device-width: 1024px) and (max-device-height: 1024px) and (max-device-aspect-ratio : 17/10)").matches,function(){var e=!c.Browser.instance.isMobile&&document.documentElement.clientWidth<=t.MaxMobileModeWidth;return n&&!e}),t.getOrientation=function(){var e="string"==typeof window.orientation?Number.parseInt(window.orientation):window.orientation;return 90!==Math.abs(e)?s.PORTRAIT:s.LANDSCAPE},t.get4DigitFormatString=function(e){var t=String(e);return"0000".substring(0,"0000".length-t.length)+t},t.checkRange=function(e,t,n){return t<=e&&e<=n},t.addEventListenerOnce=function(e,t,n){if(c.Browser.instance.isIE){var i=function(){n(),e.removeEventListener(t,i)};e.addEventListener(t,i)}else e.addEventListener(t,n,{once:!0})},t.getChildren=function(e){if(e.children)return Array.from(e.children);var t=e.childNodes;return Array.from(t)},t.eventBindFocusOutline=function(){if(c.Browser.instance.isIE){var e=document.createElement("style");e.sheet.insertRule("body.useKeyBoard :focus { outline: solid; }",0),document.head.appendChild(e)}document.addEventListener("keydown",(function(e){"Tab"===e.key&&t.addClass(document.body,"useKeyBoard")})),document.addEventListener("mousedown",(function(){t.removeClass(document.body,"useKeyBoard")}))},t.deleteObj=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)delete e[t[n]]},t}();t.Util=m}).call(this,n(4),n(41))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Browser=void 0;var i=function(){function e(){var e=this;this.getVersion=function(t){var n=e.userAgent.match(t);if(n&&n.length<2)return-1;try{return parseInt(n[1])}catch(e){return-1}},this.getIEVersion=function(){var t=e.getVersion("Trident/([0-9]+)");return t>2?t+4:e.getVersion("MSIE ([0-9]+)")},this.getChromeVersion=function(){return e.getVersion("Chrome/([0-9]+)")},this.getFirefoxVersion=function(){return e.getVersion("Firefox/([0-9]+)")},this.getAndroidVersion=function(){return e.getVersion("Android ([0-9]+)")},this.getIOSVersion=function(){return e.getVersion("OS ([0-9]+)")},this.getOperaVersion=function(){var t=e.getVersion("OPR/([0-9]+)");return t>-1?t:e.getVersion("Opera/([0-9]+)")},this.getEdgeVersion=function(){return e.getVersion("Edge/([0-9]+)")},this.isIE9Lower=function(){return e.isIE&&e.getIEVersion()<=9},this.isIE10Lower=function(){return e.isIE&&e.getIEVersion()<=10},this.isIOS12Lower=function(){return e.isIOS&&!e.isIPadOSInDesktopSafari&&e.getIOSVersion()<13},this.isIOS13Lower=function(){return!e.isIPadOSInDesktopSafari&&(e.isIOS&&e.getIOSVersion()<14)},this.isIOS9Lower=function(){return e.isIOS&&!e.isIPadOSInDesktopSafari&&e.getIOSVersion()<10},this.isIOS15Over=function(){return e.isIOS&&!e.isIPadOSInDesktopSafari&&e.getIOSVersion()>14},this.isSupportVisualViewport=function(){return void 0!==window.visualViewport},this.appName=navigator.appName,this.userAgent=navigator.userAgent,this.isAndroid=this.userAgent.indexOf("Android")>-1,this.isIPadOSInDesktopSafari="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,this.isiPhone=this.userAgent.indexOf("iPhone")>-1,this.isiPad=this.userAgent.indexOf("iPad")>-1||this.isIPadOSInDesktopSafari,this.isIOS=this.isiPad||this.isiPhone||this.userAgent.indexOf("iPod")>-1,this.isWindowMobile=this.userAgent.indexOf("IEMobile")>-1,this.isMobile=this.isAndroid||this.isIOS||this.isWindowMobile,this.isIPhoneX=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&375===window.screen.width&&812===window.screen.height,this.isIPhoneXS=this.isIPhoneX,this.isIPhoneXSMax=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&414===window.screen.width&&896===window.screen.height,this.isIPhoneXR=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&2===window.devicePixelRatio&&414===window.screen.width&&896===window.screen.height,this.isMac=navigator.platform.toUpperCase().indexOf("MAC")>=0,this.isIE=!this.isMobile&&("Microsoft Internet Explorer"===this.appName||this.userAgent.indexOf("MSIE")>-1||this.userAgent.indexOf("Trident")>-1),this.isFirefox=!this.isMobile&&this.userAgent.indexOf("Firefox")>-1,this.isOpera=!this.isMobile&&(this.userAgent.indexOf("Opera")>-1||this.userAgent.indexOf("OPR")>-1),this.isEdge=!this.isMobile&&this.userAgent.indexOf("Edge")>-1,this.isChrome=!this.isMobile&&!this.isOpera&&!this.isEdge&&this.userAgent.indexOf("Chrome")>-1,this.isSafari=!this.isMobile&&!this.isChrome&&!this.isEdge&&this.userAgent.indexOf("Safari")>-1,this.isWebkit=this.userAgent.indexOf("AppleWebKit")>-1,this.isWhale=this.userAgent.indexOf("Whale")>-1,this.version=this.getBrowserVersion()}return e.prototype.getBrowserVersion=function(){if(this.isMobile){if(this.isAndroid)return this.getAndroidVersion();if(this.isIOS)return this.getIOSVersion();if(this.isWindowMobile)return this.getIEVersion()}else{if(this.isIE)return this.getIEVersion();if(this.isChrome)return this.getChromeVersion();if(this.isFirefox)return this.getFirefoxVersion();if(this.isSafari)return this.getIOSVersion();if(this.isOpera)return this.getOperaVersion();if(this.isEdge)return this.getEdgeVersion()}return-1},Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_instanceForceCreate",{get:function(){return e._instance&&delete e._instance,e._instance=new e,e._instance},enumerable:!1,configurable:!0}),e}();t.Browser=i},,,,,function(e,t,n){"use strict";(function(e,i){var o=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.annotScrollMove=t.MARKER_ACTION=t.ANNOT_STATUS_TYPE=void 0;var a,s,l=n(3),c=n(27),d=n(0),u=n(1),h=n(38),f=n(16),p=n(30),m=n(32),g=n(33),v=n(17),b=n(289),y=n(290),E=n(55),I=n(108),S=n(26),w=n(43),_=n(165),T=n(63),x=n(156);!function(e){e[e.ADD=0]="ADD",e[e.DELETE=1]="DELETE",e[e.MODIFY=2]="MODIFY"}(a=t.ANNOT_STATUS_TYPE||(t.ANNOT_STATUS_TYPE={})),function(e){e[e.ADD=0]="ADD",e[e.DELETE=1]="DELETE",e[e.MODIFY=2]="MODIFY"}(s=t.MARKER_ACTION||(t.MARKER_ACTION={})),t.annotScrollMove=function(e,t,n){var i,o,r,a,s,l,c,d=function(e,t,n,i){e.scrollIntoView?e.scrollIntoView(n):t.scrollTop=i},h=document.getElementById(e);if(h.scrollIntoViewIfNeeded){var p=document.getElementById("contents").style.top;u.Browser.instance.isIOS&&(document.getElementById("contents").style.top="0px"),h.scrollIntoViewIfNeeded(),u.Browser.instance.isIOS&&(document.getElementById("contents").style.top=p)}else{var m=f.default.getAnnotRatio(t,n),g="svg"===h.tagName,v={left:parseFloat(h.style.left)*(g?m:1),top:parseFloat(h.style.top)*(g?m:1),width:g?parseFloat(h.style.width):w.MemoIcon.width*m,height:g?parseFloat(h.style.height):w.MemoIcon.height*m},b=u.Browser.instance.isIOS?document.documentElement:document.getElementById("contents"),y=(i=b,o=h.getBoundingClientRect(),r=i.getBoundingClientRect(),a=o.left-r.left,s=o.right-r.left,l=o.top-r.top,c=o.bottom-r.top,{left:a<0&&s>0,right:a<i.clientWidth&&s>i.clientWidth,innerLR:a>=0&&s<=i.clientWidth,top:l<0&&c>0,bottom:l<i.clientHeight&&c>i.clientHeight,innerTB:l>=0&&c<=i.clientHeight});y.left?b.scrollLeft=v.left:y.right?b.scrollLeft=v.left+v.width-b.clientWidth:y.innerLR||(b.scrollLeft=v.left-b.offsetLeft-b.clientWidth/2+v.width/2);var E=S.Page.getPageScrollTop(t.toString())+v.top;if(y.top)d(h,b,y.top,E);else if(y.bottom){var I=E+v.height-b.clientHeight;d(h,b,y.bottom,I>0?I:0)}else y.innerTB||(b.scrollTop=E-b.offsetTop-b.clientHeight/2+v.height/2)}};var C=function(){function e(){var t=this;this.SELECTION_STROKE_WIDTH={DEFAULT:"5",MOBILE:"30"},this.MARKER_LAYER="marker-section",this.ANNOTATION_LAYER="annotationlayer",this.MARKER_UNDOREDO_WAITTIME=100,this.MARKER_UNDOREDO_MAX=20,this.undoStack=[],this.redoStack=[],this.isTempDisabledUndoRedo=!1,this.annotTabList=["page__input","select-arrow","header-tablist__input","export-pdf-btn","marker-btn","annotation-list-btn","marker-undo-btn","marker-redo-btn","marker-eraser-btn","marker-pencil-btn","marker-shapes-btn","marker-square-btn","marker-line-btn","marker-circle-btn","marker-arrowline-btn","marker-memo-btn","marker-freetext-btn","select-annotation-btn","marker-hand-scroll-btn","annotation-close"],this.funcgetAnnotationInfos=null,this.getAnnotationInfo=function(e,n){return f.default.getAnnotData(t.funcgetAnnotationInfos(),e,n)},this.createMarkerLayerDiv=function(e,n){for(var i=e;i<n;i++){var o=document.createElement("div");o.id="markerlayer"+i,o.className=d.Util.isCellSkin(t.docInfo)?"markerlayer markerlayer-cell marker-loading":"markerlayer marker-loading";var r=d.Util.isCellSkin(t.docInfo)?document.getElementById("cell-common"):document.getElementById("page"+i),a=r.offsetWidth,s=r.offsetHeight;o.style.cssText="width:"+a+"px;height:"+s+"px;";var l=document.createElement("section");l.className="marker-section",l.id="marker-section"+i,l.style.cssText="width:"+a+"px;height:"+s+"px;",o.appendChild(l);var c=document.createDocumentFragment();c.appendChild(o),document.getElementById("markerlayer"+i)||f.default.getPageOrSheetAreaId(d.Util.isCellSkin(t.docInfo),i).appendChild(c)}},this.createMarkerLayer=function(){if(!d.Util.isCellSkin(t.docInfo)||!g.ImageSheet.sheetLoadFail){var e=f.default.getAnnotLoadingRange(t.docInfo,0),n=e.startIdx,i=e.endIdx;t.createMarkerLayerDiv(n,i)}},this.appendMarkerScaleElm=function(n){var i=document.createElement("div");return i.className="marker-scale",e.isAnnotMode&&d.Util.addClass(i,"marker-scale--pointer"),(T.DrawingEraser.isActive||e.isScrollMode)&&d.Util.addClass(i,"disableEvent"),n.appendChild(i),t.setMarkerScale(i),i},this.setMarkerScale=function(e){var n=d.Util.getIdxFromElmId(d.Util.getParentElement(e).id,"annotationlayer"),i=f.default.getAnnotRatio(n,d.Util.isCellSkin(t.docInfo));e.style.cssText="-ms-transform:scale("+i+"); transform:scale("+i+"); "},this.marker=function(n){d.Util.isCellSkin(t.docInfo)&&g.ImageSheet.sheetLoadFail?e.isAnnotMode&&t.outAnnotMode():(d.Util.isCellSkin(t.docInfo)&&(t.createMarkerLayer(),t.appendMarkerScaleElm(document.getElementById("annotationlayer"+n.pageOrSheetIdx))),e.isDrawingMode?t.drawing.gotoDrawingMode():e.isAnnotMode,(d.Util.isCellSkin(t.docInfo)||n.annotationInfos)&&t.loadMarker(n.annotationInfos,n.pageOrSheetIdx),e.isMarkerLoading&&(e.isMarkerLoading=!1,t.removeMarkerLoadingState(),n.afterFunc&&n.afterFunc()))},this.render=function(e,n,i){void 0===i&&(i=null);var o=i||document.getElementById("annotationlayer"+e);!o.getElementsByClassName("marker-scale")[0]&&t.appendMarkerScaleElm(o),"memo"===f.getAnnotType(n.annot)?t.memo.renderMemo(e,n):(t.drawing.renderMarker(e,n,o),"freetext"!==n.annot.type&&n.annot.contents&&n.annot.contents.text&&n.annot.contents.text.length&&t.memo.renderMemo(e,n))},this.modifyRendering=function(n){var i=n.annot,o=n.prevAnnot;if(!o||i.annot.l===o.annot.l&&i.annot.t===o.annot.t||(t.eventObserver.dragAnnotEnd.notify({page:n.page,annotId:i.id}),"memo"!==f.getAnnotType(i.annot))){var r=f.getAnnotType(i.annot),a=e.createtMarkerId(n.page,i.id),s="freetext"===r?c.select("div#"+a):c.select("svg#"+a);t.drawing.getDrawingTool(r).redrawAttr(s.node(),i);var u=i.annot.contents?l.extend(!0,{},i.annot.contents):{t:"",d:"",text:""};if("memo"!==f.getAnnotType(i.annot)&&"freetext"!==f.getAnnotType(i.annot)&&0===u.text.length){var h=document.getElementById(w.MemoIcon.getMemoId(n.page,n.annot.id));d.Util.removeElem(h)}else"freetext"===i.annot.type?x.Freetext.updateTextArea(n.page,i):u.text.length&&t.memo.renderMemo(n.page,i)}},this.deleteRendering=function(t,n){var i=e.createtMarkerId(t,n);d.Util.removeElem(document.getElementById(i)),e.annotObjectMap.has(i)&&(e.annotObjectMap.get(i).delete(),e.annotObjectMap.delete(i));var o=w.MemoIcon.getMemoId(t,n);d.Util.removeElem(document.getElementById(o)),e.annotObjectMap.has(o)&&(e.annotObjectMap.get(o).delete(),e.annotObjectMap.delete(o))},this._loadMarker=function(e,n){var i=e[n];if(i)for(var o=document.getElementById("annotationlayer"+n),r=0,a=i;r<a.length;r++){var s=a[r];t.render(n,s,o)}},this.loadMarker=function(n,i){for(var o in t._loadMarker(n,i),n){var r=parseInt(o);i!==r&&t._loadMarker(n,r)}e.isAnnotMode&&t.checkUndoRedoState()},this.removeMarkerLoadingState=function(){if(u.Browser.instance.isMobile){d.Util.removeClass(document.getElementById("marker-undo-btn__img"),"mobile-marker-loading"),d.Util.removeClass(document.getElementById("marker-redo-btn__img"),"mobile-marker-loading")}else l(".annotationlayer").removeClass("marker-loading")},this.fullScreen=function(e){e.isFullScreen?l(".markerlayer").addClass("markerlayer--presentation"):l(".markerlayer").removeClass("markerlayer--presentation")},this.resizeMarkerScale=function(){if(!d.Util.isCellSkin(t.docInfo)||!g.ImageSheet.sheetLoadFail){for(var e=0,n=Array.prototype.slice.call(document.getElementsByClassName("marker-scale"));e<n.length;e++){var i=n[e];t.setMarkerScale(i)}for(var o=0,r=Array.prototype.slice.call(document.getElementsByClassName("markerlayer"));o<r.length;o++){var a=r[o],s=d.Util.isCellSkin(t.docInfo)?document.getElementById("cell-common"):d.Util.getParentElement(a).getElementsByClassName("contents-page__img")[0],l=s.offsetWidth,u=s.offsetHeight,h=a.getElementsByClassName("marker-section")[0];a.style.display="none",h.style.display="none",a.style.width=l+"px",a.style.height=u+"px",h.style.width=l+"px",h.style.height=u+"px";var f=h.getElementsByClassName("tmp-marker-svg");0!==f.length&&(f[0].style.display="none",c.select(f[0]).style("width",s.offsetWidth+"px").style("height",s.offsetHeight+"px"),f[0].style.display=""),a.style.display="",h.style.display=""}t.memo&&t.memo.rePosition()}},this.replaceUndoRedoNewId=function(e,t,n){for(var i=0,o=n;i<o.length;i++){var r=o[i];r.annotId===e&&(r.annotId=t)}},this.addRenderAfterUndoRedo=function(e){t.render(e.page,e.annot)},this.addAfterUndoRedo=function(e,n){if(!0===e.rs.success){var i=n[n.length-1].annotId;t.replaceUndoRedoNewId(i,e.annot.id,t.redoStack),t.replaceUndoRedoNewId(i,e.annot.id,t.undoStack);var o=d.Util.isCellSkin(t.docInfo);t.movePageForUndoRedo(e.page,(function(){o&&(t.moveScrollSheet(e.annot.annot,e.page),document.getElementById("contents-area").style.visibility=""),t.addRenderAfterUndoRedo(e)}))}},this.addAfterSaveUndo=function(e){t.addAfterUndoRedo(e,t.redoStack)},this.addAfterSaveRedo=function(e){t.addAfterUndoRedo(e,t.undoStack)},this.deleteAfterSaveUndo=function(e){var n=d.Util.isCellSkin(t.docInfo);t.movePageForUndoRedo(e.page,(function(){n&&(document.getElementById("contents-area").style.visibility="")}))},this.updateMarkerStatus=function(e,n,i,o,r){void 0===o&&(o=null),void 0===r&&(r=null);var a={status:e,page:n,annot:{id:i,annot:o},afterFunc:r,isUndoRedo:!0};t.eventObserver.saveAnnotationServer.notify(a)},this.outAnnotMode=function(){document.getElementById("marker-btn").title=v.LocaleMessage.getMessage("icon_annotation_open"),document.getElementById("marker-btn__img").title=v.LocaleMessage.getMessage("icon_annotation_open"),t.drawing.outDrawingMode();for(var n=0,i=Array.prototype.slice.call(document.getElementsByClassName("marker-scale"));n<i.length;n++){var o=i[n];d.Util.removeClass(o,"marker-scale--pointer")}var r=document.getElementById("marker-btn__img");d.Util.removeClass(r,"marker-btn__img--on"),t.drawing.hideShapeMenu(),t.eventObserver.unSelectAnnotation.notify(),e.isAnnotMode=!1,t.checkUndoRedoState(),d.Util.isMobileMode()&&m.Thumbnail.THUMB_STATUS!==m.THUMB_FLAG.on&&(t.eventObserver.mobileThumb.notify(h.ShowActionType.HIDE3SEC),t.eventObserver.mobileHeader.notify(h.ShowActionType.HIDE3SEC)),e.isMarkerLoading&&(e.isMarkerLoading=!1,t.removeMarkerLoadingState()),t.eventObserver.annotMode.notify(e.isAnnotMode)},this.gotoAnnotMode=function(){if(!g.ImageSheet.sheetLoadFail){for(var n=0,i=Array.prototype.slice.call(document.getElementsByClassName("marker-scale"));n<i.length;n++){var o=i[n];d.Util.addClass(o,"marker-scale--pointer")}document.getElementById("marker-btn").title=v.LocaleMessage.getMessage("icon_annotation_close"),document.getElementById("marker-btn__img").title=v.LocaleMessage.getMessage("icon_annotation_close");var r=document.getElementById("marker-btn__img");d.Util.addClass(r,"marker-btn__img--on"),t.drawing.clickSelectBtn(),e.isAnnotMode=!0,t.eventObserver.mobileHeader.notify(h.ShowActionType.SHOW),t.eventObserver.annotMode.notify(e.isAnnotMode)}},this.markerBtnEventBind=function(){var n=function(){e.isAnnotMode?(t.outAnnotMode(),d.Util.clearTabIndexList(t.annotTabList),d.Util.setTabIndexList()):(t.gotoAnnotMode(),d.Util.clearTabIndexList(),d.Util.setTabIndexList(t.annotTabList))};d.Util.bindClickEvent(document.getElementById("marker-btn"),n),d.Util.bindClickEvent(document.getElementById("annotation-close"),n),d.Util.bindOnceClickEvent(document.getElementById("marker-btn"),(function(){t.annotList.loadAnnotList()}))},this.checkUndoRedoState=function(){var e=document.getElementById("marker-undo-btn__img"),n=document.getElementById("marker-redo-btn__img");0===t.undoStack.length?d.Util.hasClass(e,"marker-undo-btn__img--off")||d.Util.addClass(e,"marker-undo-btn__img--off"):d.Util.hasClass(e,"marker-undo-btn__img--off")&&d.Util.removeClass(e,"marker-undo-btn__img--off"),0===t.redoStack.length?d.Util.hasClass(n,"marker-redo-btn__img--off")||d.Util.addClass(n,"marker-redo-btn__img--off"):d.Util.hasClass(n,"marker-redo-btn__img--off")&&d.Util.removeClass(n,"marker-redo-btn__img--off")},this.initRedoStack=function(){t.redoStack=[]},this.modifyRenderAfterUndoRedo=function(e){t.modifyRendering(e)},this.modifyAfterSaveUndoRedo=function(e){if(!0===e.rs.success){var n=e,i=d.Util.isCellSkin(t.docInfo);t.movePageForUndoRedo(e.page,(function(){i&&(t.moveScrollSheet(e.annot.annot,e.page),document.getElementById("contents-area").style.visibility=""),t.modifyRenderAfterUndoRedo(n)}))}},this.undoMarkerStatus=function(e){var n=e.annotId,i=e.pageIdx;switch(e.status){case s.ADD:t.updateMarkerStatus(a.DELETE,i,n,e.markerInfo,t.deleteAfterSaveUndo);break;case s.MODIFY:t.updateMarkerStatus(a.MODIFY,i,n,e.prevMarkerInfo,t.modifyAfterSaveUndoRedo);break;case s.DELETE:t.updateMarkerStatus(a.ADD,i,n,e.markerInfo,t.addAfterSaveUndo)}},this.movePageForUndoRedo=function(e,n){var i=d.Util.isCellSkin(t.docInfo);e!==(d.Util.isCellSkin(t.docInfo)?t.docInfo.currentSheet:t.docInfo.currentPage)?i?(t.eventObserver.sheet.notify({sheetIdx:e,afterFunc:n}),document.getElementById("contents-area").style.visibility="hidden"):t.eventObserver.page.notify({pageNum:e,isScroll:!1,afterFunc:n}):n()},this.undoEvent=function(n){return o(t,void 0,void 0,(function(){var t;return r(this,(function(i){switch(i.label){case 0:return e.isMarkerLoading||(0===this.undoStack.length||this.isTempDisabledUndoRedo)?[2]:[4,this.eventObserver.unSelectAnnotation.notify()];case 1:return i.sent(),this.eventObserver.closeProp.notify(),e.isDrawingMode&&this.drawing.markerSelectEvent(),t=this.undoStack.pop(),this.redoStack.push(t),this.redoStack.length>this.MARKER_UNDOREDO_MAX&&this.redoStack.shift(),this.undoMarkerStatus(t),this.checkUndoRedoState(),n&&n.stopPropagation(),[2]}}))}))},this.redoMarkerStatus=function(e){var n=e.annotId,i=e.pageIdx;switch(e.status){case s.ADD:t.updateMarkerStatus(a.ADD,i,n,e.markerInfo,t.addAfterSaveRedo);break;case s.MODIFY:t.updateMarkerStatus(a.MODIFY,i,n,e.markerInfo,t.modifyAfterSaveUndoRedo);break;case s.DELETE:t.updateMarkerStatus(a.DELETE,i,n,e.markerInfo,t.deleteAfterSaveUndo)}},this.redoEvent=function(n){return o(t,void 0,void 0,(function(){var t;return r(this,(function(i){switch(i.label){case 0:return e.isMarkerLoading||(0===this.redoStack.length||this.isTempDisabledUndoRedo)?[2]:[4,this.eventObserver.unSelectAnnotation.notify()];case 1:return i.sent(),this.eventObserver.closeProp.notify(),t=this.redoStack[this.redoStack.length-1],e.isDrawingMode&&this.drawing.markerSelectEvent(),this.redoStack.pop(),this.pushUndoStack(t),this.redoMarkerStatus(t),this.checkUndoRedoState(),n&&n.stopPropagation(),[2]}}))}))},this.undoRedoEventBind=function(){d.Util.bindClickEvent(document.getElementById("marker-undo-btn"),t.undoEvent),d.Util.bindClickEvent(document.getElementById("marker-redo-btn"),t.redoEvent)},this.moveScrollSheet=function(e,n){var i=document.getElementById("contents").offsetHeight/2,o=document.getElementById("contents").offsetWidth/2,r=p.default.instance.getRatioByOriginSize(n,d.Util.isCellSkin(t.docInfo)),a=parseInt(e.l)*r+parseInt(e.h)/2-o,s=parseInt(e.t)*r+parseInt(e.w)/2-i;t.eventObserver.afterUndoRedoSheet.notify({scrollLeft:a,scrollTop:s})},this.disablePinchZoom=function(e){e.touches.length>1&&e.preventDefault()},this.disablePinchZoomInContentAreaEventBind=function(){return document.getElementById("contents-area").addEventListener("touchstart",t.disablePinchZoom,!1)},this.ablePinchZoomInContentAreaEventBind=function(){return document.getElementById("contents-area").removeEventListener("touchstart",t.disablePinchZoom,!1)},this.eventBind=function(e){t.markerBtnEventBind(),t.undoRedoEventBind(),t.eventObserver=e,t.eventObserver.loadAnnotation.subscribe(t.marker),t.eventObserver.fullScreen.subscribe(t.fullScreen),t.eventObserver.undoMarker.subscribe(t.undoEvent),t.eventObserver.redoMarker.subscribe(t.redoEvent),!d.Util.isCellSkin(t.docInfo)&&t.docInfo.status.pageNum>_.ImagePage.initPageNum&&t.eventObserver.initLoadAfter.subscribe((function(){t.createMarkerLayerDiv(_.ImagePage.initPageNum,t.docInfo.status.pageNum)}))},this.getPageIdxWhenInAnnotationMode=function(){return t.docInfo.currentPage},this.pushUndoStack=function(e){t.undoStack.push(e),t.undoStack.length>t.MARKER_UNDOREDO_MAX&&t.undoStack.shift()},this.load=function(e,n,i,a){return o(t,void 0,void 0,(function(){var t,o,s,l;return r(this,(function(r){for(this.docInfo=e,this.funcgetAnnotationInfos=a,this.createMarkerLayer(),t=Array.prototype.slice.call(document.getElementsByClassName("marker-scale")),o=0,s=t;o<s.length;o++)l=s[o],this.setMarkerScale(l);return this.annotList=new I.default,this.annotList.load(e,n,a),this.annotationPopup=new b.default,this.annotationPopup.load(this.docInfo,n,a),this.memo=new y.default,this.memo.load(e,n,a),this.drawing=new E.default,this.drawing.load(e,n,this),this.eventBind(n),this.loadMarker(i,0),[2]}))}))}}return e.annotObjectMap=new i,e.isAnnotMode=!1,e.isMarkerLoading=!1,e.isScrollMode=!1,e.isDrawingMode=!1,e.parseMarkerId=function(e){if(e){var t=e.split("-");return{pageOrSheetIdx:Number(t[1]),annotId:Number(t[2])}}},e.createtMarkerId=function(e,t){return"marker-"+e+"-"+t},e}();t.default=C}).call(this,n(4),n(41))},,,,,,,,,,function(e,t,n){"use strict";(function(e,i){var o=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createAnnotationLayer=t.getAnnotType=void 0;var a=n(1),s=n(51),l=n(0),c=n(33),d=n(6),u=n(166),h=n(30),f=n(162),p=n(169),m=n(167),g=n(44);function v(e,t){var n=document.getElementById("annotationlayer"+e);if(!n){var i=t?document.getElementById("cell-common"):document.getElementById("page"+e);if((n=document.createElement("div")).id="annotationlayer"+e,d.default.isAnnotMode&&e>b.DEFAULT_LOADING_CNT?n.className=t?"annotationlayer annotationlayer-cell marker-loading":"annotationlayer marker-loading":n.className=t?"annotationlayer annotationlayer-cell":"annotationlayer",!t){var o=document.getElementById("page"+e);l.Util.hasClass(o,"img-loading")&&l.Util.addClass(n,"annotationlayer--hide")}n.style.cssText="width:"+i.style.width+";height:"+i.style.height+";";var r=document.createDocumentFragment();r.appendChild(n),b.getPageOrSheetAreaId(t,e).appendChild(r)}}t.getAnnotType=function(e){var t,n,i=e.type;return"line"===e.type&&(i=!e.le||"none"===(null===(t=e.le)||void 0===t?void 0:t.head.toLocaleLowerCase())&&"none"===(null===(n=e.le)||void 0===n?void 0:n.tail.toLocaleLowerCase())?i:"arrowline"),i},t.createAnnotationLayer=v;var b=function(){function e(t){var n=this;this.docInfo=null,this.eventObserver=null,this.textObj={},this.localId=0,this.localServerIdMap=new i,this.LOADING_DIMMED_TIMEOUT=300,this.getAnnotationInfos=function(){return n.annotationInfos},this.pushAnnotInfoPerPage=function(e,t){n.annotationInfos[t]||(n.annotationInfos[t]=[]),n.annotationInfos[t].push(e)},this.modifyAnnotInfoPerPage=function(e,t){var i=n.annotationInfos[t].findIndex((function(t){return t.id===e.id}));n.annotationInfos[t][i]=e},this.deleteAnnotInfoPerPage=function(e,t){var i=n.annotationInfos[e].findIndex((function(e){return e.id===t}));i>-1&&n.annotationInfos[e].splice(i,1)},this.setEditedAnnotation=function(t){e.EDITED_ANNOTAION!==t&&(e.EDITED_ANNOTAION=t)},this.sortByDate=function(e){e.sort((function(e,t){var n=e.annot.contents&&e.annot.contents.d?e.annot.contents.d:"D:99999999999999",i=t.annot.contents&&t.annot.contents.d?t.annot.contents.d:"D:99999999999999";return parseInt(n.slice(2))-parseInt(i.slice(2))}))},this.checkRequireValidation=function(e){var t=[];for(var n in e){Boolean(e[n].annot.type&&e[n].annot.l&&e[n].annot.t&&e[n].annot.w&&e[n].annot.h)&&t.push(e[n])}return t},this.getAnnotationInfosAllPagesFromServer=function(e){return o(n,void 0,void 0,(function(){var t,n,i,o;return r(this,(function(r){switch(r.label){case 0:return[4,f.getAnnotList(e)];case 1:if((t=r.sent()).success)for(n in this.annotationInfos=t.data.pages,this.annotationInfos)for(i in this.annotationInfos[n]=this.checkRequireValidation(this.annotationInfos[n]),this.sortByDate(this.annotationInfos[n]),this.annotationInfos[n])o=this.annotationInfos[n][i].id,this.localServerIdMap.set(o,o),this.localId=Math.max(this.localId,o);return[2]}}))}))},this.getAnnotationInfosInCurPageRange=function(){var t=l.Util.isCellSkin(n.docInfo)?n.docInfo.currentSheet:n.docInfo.currentPage,i=e.getAnnotLoadingRange(n.docInfo,t),o=i.startIdx,r=l.Util.isCellSkin(n.docInfo)?o:i.endIdx-1,a={};for(var s in n.annotationInfos)if(!(o>Number(s))){if(r<Number(s))break;a[s]=n.annotationInfos[s]}return a},this._setAnnotationLayer=function(e){var t=document.getElementById("annotationlayer"+e);if(t){var i=l.Util.isCellSkin(n.docInfo)?document.getElementById("cell-common"):document.getElementById("page"+e);n.resizeAnnotationLayer(t,i)}else v(e,l.Util.isCellSkin(n.docInfo))},this.setAnnotationLayer=function(t,i){void 0===i&&(i=!1);var o=i?{startIdx:0,endIdx:n.docInfo.status.pageNum}:e.getAnnotLoadingRange(n.docInfo,t);n._setAnnotationLayer(t);for(var r=o.startIdx;r<o.endIdx;r++)t!==r&&n._setAnnotationLayer(r)},this.addMarkerLoadingState=function(){if(a.Browser.instance.isMobile){l.Util.hasClass(document.getElementById("marker-undo-btn__img"),"marker-redo-btn__img--off")||l.Util.addClass(document.getElementById("marker-undo-btn__img"),"mobile-marker-loading"),l.Util.hasClass(document.getElementById("marker-redo-btn__img"),"marker-redo-btn__img--off")||l.Util.addClass(document.getElementById("marker-redo-btn__img"),"mobile-marker-loading")}},this.focusPage=function(e){return o(n,void 0,void 0,(function(){var t;return r(this,(function(n){return this.setAnnotationLayer(e.pageNum),d.default.isAnnotMode&&(d.default.isMarkerLoading=!0,this.addMarkerLoadingState()),!l.Util.isUseSearch(this.docInfo)&&l.Util.removeContentsAreaTooltip()||this.eventObserver.searchText.notify(e.pageNum),l.Util.isUseAnnotation(this.docInfo)&&(t=this.getAnnotationInfosInCurPageRange(),this.eventObserver.loadAnnotation.notify({annotationInfos:t,pageOrSheetIdx:e.pageNum,afterFunc:e.afterFunc})),[2]}))}))},this.moveSheet=function(e){return o(n,void 0,void 0,(function(){var t,n;return r(this,(function(i){return t=l.Util.isUseAnnotation(this.docInfo),document.getElementById("annotationlayer"+e.sheetIdx)||(c.ImageSheet.sheetLoadFail||this.setAnnotationLayer(e.sheetIdx),d.default.isAnnotMode&&(d.default.isMarkerLoading=!0,this.addMarkerLoadingState()),t&&(n=this.getAnnotationInfosInCurPageRange(),this.eventObserver.loadAnnotation.notify({annotationInfos:n,pageOrSheetIdx:e.sheetIdx,afterFunc:e.afterFunc}))),[2]}))}))},this.rePosition=function(){for(var t=n.docInfo.currentPage,i=e.getAnnotLoadingRange(n.docInfo,t),o=i.startIdx;o<i.endIdx;o++){var r=document.getElementById("annotationlayer"+o);r&&(void 0!==n.textLayer&&l.Util.isUseSearch(n.docInfo)&&n.textLayer.updatePosition(r,o),void 0!==n.linkLayer&&n.linkLayer.updateLinkPosition(r,o))}},this.resizeAnnotationLayer=function(e,t){t.style.width!==e.style.width&&(e.style.width=""+t.style.width,e.style.height=""+t.style.height)},this.resizePage=function(){l.Util.isCellSkin(n.docInfo)?c.ImageSheet.sheetLoadFail||n.setAnnotationLayer(n.docInfo.currentSheet):(h.default.instance.init(n.docInfo.status.pageNum),n.setAnnotationLayer(n.docInfo.currentPage,!0)),n.rePosition(),l.Util.isUseAnnotation(n.docInfo)&&n.marker&&n.marker.resizeMarkerScale()},this.isActiveSaveAnnotation={0:!1,1:!1,2:!1},this.handleSaveAnnotation=function(e){n.isActiveSaveAnnotation[e.status]||(n.isActiveSaveAnnotation[e.status]=!0,l.Util.showLoadingDimmed(),e.status===d.ANNOT_STATUS_TYPE.ADD?n.addAnnotation(e):e.status===d.ANNOT_STATUS_TYPE.MODIFY?n.modifyAnnotation(e):e.status===d.ANNOT_STATUS_TYPE.DELETE&&n.deleteAnnotation(e),n.setEditedAnnotation(!1),l.Util.hideLoadingDimmed(),n.isActiveSaveAnnotation[e.status]=!1)},this.applyAnnot=function(t){var i=t.type,o=t.content,r=o.page,a=o.annot,s=null;if(0===i)n.marker.render(r,a),n.pushAnnotInfoPerPage(a,r),s=d.ANNOT_STATUS_TYPE.ADD;else if(1===i){var l=e.getAnnotData(n.getAnnotationInfos(),r,a.id);n.marker.modifyRendering({page:r,annot:a,prevAnnot:l}),n.modifyAnnotInfoPerPage(a,r),s=d.ANNOT_STATUS_TYPE.MODIFY}else{if(2!==i)return;n.marker.deleteRendering(r,a.id),n.deleteAnnotInfoPerPage(r,a.id),s=d.ANNOT_STATUS_TYPE.DELETE}var c={status:s,page:r,annot:a,afterFunc:null,isUndoRedo:!1};n.eventObserver.updateAnnotList.notify(c)},this.addAnnotation=function(e){var t=null;try{var i=f.addAnnot(n.docInfo,JSON.stringify({page:e.page,annot:e.annot.annot}));if(i.success){var o=e;n.localServerIdMap.delete(e.annot.id),n.localServerIdMap.set(++n.localId,i.data.id),o.annot.id=n.localId,n.pushAnnotInfoPerPage(o.annot,o.page),n.eventObserver.updateAnnotList.notify(o),e.isUndoRedo||(n.marker.pushUndoStack({status:d.MARKER_ACTION.ADD,pageIdx:o.page,annotId:o.annot.id,markerInfo:o.annot.annot}),n.marker.initRedoStack(),n.marker.checkUndoRedoState()),t={rs:i,page:o.page,annot:o.annot},l.Util.isDocslive()&&n.eventObserver.saveAnnotCb.notify({type:0,content:{page:o.page,annot:o.annot}})}else s.default.instance.annotSaveFailedDialog(),t={rs:i,page:e.page,annot:e.annot}}catch(n){s.default.instance.annotSaveExceptDialog(),t={rs:{success:!1},page:e.page,annot:e.annot}}return e.afterFunc&&e.afterFunc(t),t},this.deleteAnnotation=function(e){return o(n,void 0,void 0,(function(){var t,n,i;return r(this,(function(o){switch(o.label){case 0:t=null,o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.localServerIdMap.get(e.annot.id),[4,f.removeAnnot(this.docInfo,n.toString())];case 2:return(i=o.sent()).success?(this.deleteAnnotInfoPerPage(e.page,e.annot.id),this.eventObserver.updateAnnotList.notify(e),e.isUndoRedo||(this.marker.pushUndoStack({status:d.MARKER_ACTION.DELETE,pageIdx:e.page,annotId:e.annot.id,markerInfo:e.annot.annot}),this.marker.initRedoStack(),this.marker.checkUndoRedoState()),this.marker.deleteRendering(e.page,e.annot.id),t={rs:i,page:e.page},l.Util.isDocslive()&&this.eventObserver.saveAnnotCb.notify({type:2,content:{page:e.page,annot:e.annot}})):(s.default.instance.annotFailedDialog(i.code),t={rs:i,page:e.page}),[3,4];case 3:return o.sent(),s.default.instance.annotSaveExceptDialog(),t={rs:{success:!1},page:e.page},[3,4];case 4:return e.afterFunc&&e.afterFunc(t),[2,t]}}))}))},this.modifyAnnotation=function(t){var i=null;try{var o=e.getAnnotData(n.getAnnotationInfos(),t.page,t.annot.id),r=n.localServerIdMap.get(t.annot.id),a=f.modifyAnnot(n.docInfo,r.toString(),JSON.stringify({annot:t.annot.annot}));a.success?(n.modifyAnnotInfoPerPage(t.annot,t.page),n.eventObserver.updateAnnotList.notify(t),t.isUndoRedo||(n.marker.pushUndoStack({status:d.MARKER_ACTION.MODIFY,pageIdx:t.page,annotId:t.annot.id,markerInfo:t.annot.annot,prevMarkerInfo:o.annot}),n.marker.initRedoStack(),n.marker.checkUndoRedoState()),i={rs:a,page:t.page,annot:t.annot,prevAnnot:o},l.Util.isDocslive()&&n.eventObserver.saveAnnotCb.notify({type:1,content:{page:t.page,annot:t.annot}})):(s.default.instance.annotFailedDialog(a.code),i={rs:a,page:t.page})}catch(e){s.default.instance.annotSaveExceptDialog(),i={rs:{success:!1},page:t.page}}return t.afterFunc&&t.afterFunc(i),i},this.isActiveExportPdf=!1,this.exportPdf=function(e){return o(n,void 0,void 0,(function(){var t,n,i=this;return r(this,(function(o){if(this.isActiveExportPdf)return[2];this.isActiveExportPdf=!0,l.Util.showLoadingDimmed();try{t=encodeURIComponent(e.title),n=f.getPdfDownUrl(this.docInfo,t,e.dispAnnot),window.open(n,"_blank")}catch(e){s.default.instance.confirmDialog("msg_export_pdf_failed")}return setTimeout((function(){l.Util.hideLoadingDimmed(),i.isActiveExportPdf=!1}),this.LOADING_DIMMED_TIMEOUT),[2]}))}))},this.isActiveSaveServerPdf=!1,this.saveServerPdf=function(){return o(n,void 0,void 0,(function(){var e,t=this;return r(this,(function(n){switch(n.label){case 0:if(this.isActiveSaveServerPdf)return[2];this.isActiveSaveServerPdf=!0,l.Util.showLoadingDimmed(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,f.uploadPdf(this.docInfo)];case 2:return(e=n.sent()).success?s.default.instance.confirmDialog("msg_saved"):s.default.instance.annotFailedDialog(e.code),[3,4];case 3:return n.sent(),s.default.instance.confirmDialog("msg_server_pdf_failed"),[3,4];case 4:return setTimeout((function(){l.Util.hideLoadingDimmed(),t.isActiveSaveServerPdf=!1}),this.LOADING_DIMMED_TIMEOUT),[2]}}))}))},this.editedAnnotation=function(){n.setEditedAnnotation(!0)},this.eventBind=function(e){n.eventObserver=e,n.eventObserver.page.subscribe(n.focusPage),n.eventObserver.sheet.subscribe(n.moveSheet),n.eventObserver.resizePage.subscribe(n.resizePage),l.Util.isUseAnnotation(n.docInfo)&&(n.eventObserver.editedAnnotation.subscribe(n.editedAnnotation),n.eventObserver.saveAnnotationServer.subscribe(n.handleSaveAnnotation),n.eventObserver.exportPdf.subscribe(n.exportPdf),n.eventObserver.saveServerPdf.subscribe(n.saveServerPdf),l.Util.isDocslive()&&n.eventObserver.applyAnnot.subscribe(n.applyAnnot))},this.load=function(t,i){return o(n,void 0,void 0,(function(){var n;return r(this,(function(o){switch(o.label){case 0:return this.docInfo=t,this.eventBind(i),e.SERVER_DPI=this.docInfo.dpi,e.DEFAULT_DPI=l.Util.isCellSkin(this.docInfo)?96:72,e.DPI_RATIO=e.SERVER_DPI/e.DEFAULT_DPI,l.Util.isCellSkin(this.docInfo)?c.ImageSheet.sheetLoadFail?[3,2]:(this.setAnnotationLayer(this.docInfo.currentSheet),l.Util.isUseSearch(this.docInfo)?(this.textLayer=new m.CellTextLayer(this.docInfo,this.eventObserver,this.textObj),[4,this.textLayer.load()]):[3,2]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return h.default.instance.init(this.docInfo.status.pageNum),this.setAnnotationLayer(this.docInfo.currentPage),!(l.Util.isConvHtml(t)&&l.Util.isPDF(t)||l.Util.isConvImg(t))||!l.Util.isUseSearch(this.docInfo)&&l.Util.removeContentsAreaTooltip()?[3,5]:(this.textLayer=new p.WordTextLayer(this.docInfo,this.eventObserver,this.textObj),[4,this.textLayer.load()]);case 4:o.sent(),o.label=5;case 5:return(l.Util.isConvHtml(t)&&l.Util.isPDF(t)||l.Util.isConvImg(t))&&(this.linkLayer=new u.LinkLayer,this.linkLayer.load(t,this.textObj,i)),l.Util.isUseAnnotation(this.docInfo)&&(n=this.getAnnotationInfosInCurPageRange(),this.marker=new d.default,this.marker.load(t,i,n,this.getAnnotationInfos)),[2]}}))}))},e.permission=t,t.login&&(e.loginId=t.profile.username)}return e.isFullScreen=!1,e.DEFAULT_LOADING_CNT=5,e.EDITED_ANNOTAION=!1,e.loginId=null,e.isAbleToEditAuthor=function(){return null===e.loginId},e.getSheetTileXml=function(e,t,n,i,a,s,c){return o(void 0,void 0,void 0,(function(){var o,d;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),e.status.imageConverting?(o=e.contextPath+"/thumbnailxml/"+l.Util.get4DigitFormatString(t+1)+"_d"+n+"_x"+i+"_y"+a+"_w"+s+"_h"+c+".xml",[4,l.Util.getThumbnailXml(o)]):[3,2];case 1:return[2,r.sent()];case 2:return d=e.contextPath+"/thumbnailxml/"+e.status.id+"/"+t+"?dpi="+n+"&x="+i+"&y="+a+"&w="+s+"&h="+c,l.Util.isUseAnnotation(e)&&(d+="&dispAnnot=2"),[4,l.Util.getThumbnailXml(d)];case 3:return[2,r.sent()];case 4:return r.sent(),[2,{}];case 5:return[2]}}))}))},e.getXml=function(e,t,n){return o(void 0,void 0,void 0,(function(){var i;return r(this,(function(o){switch(o.label){case 0:return e.status.startPageNum&&(t+=e.status.startPageNum-1),l.Util.isConvHtml(e)?i=e.resultPath+"/"+e.status.fileName+".files/"+e.status.fileName+"_"+(t+1)+".xml":(i=e.contextPath+"/thumbnailxml/"+e.status.id+"/"+t+"?dpi="+n,l.Util.isUseAnnotation(e)&&(i+="&dispAnnot=2"),e.status.imageConverting&&(i=e.contextPath+"/thumbnailxml/"+t+".xml")),[4,l.Util.getThumbnailXml(i)];case 1:return[2,o.sent()]}}))}))},e.getPageOrSheetAreaId=function(e,t){return e?document.getElementById("sheet"):document.getElementById("page-area"+t)},e.parseTextId=function(e){if(e){var t=e.split("-");return{pageNum:Number(t[1]),idx:Number(t[2])}}},e.isValidColorType=function(e){return 0===e.indexOf("type")&&l.Util.checkRange(Number(e.substring(4)),1,24)},e.isValidThickness=function(t){return l.Util.checkRange(Number(t),e.SERVER_DPI/96*1,e.SERVER_DPI/96*16)},e.isValidTransparency=function(e){return l.Util.checkRange(Number(e),0,1)},e.isValidTextAlign=function(e){return["left, center, right"].includes(e)},e.isValidFontSize=function(e){return g.default.fontSizes.includes(e)},e.getAnnotInfoPerPage=function(e,t){return e[t]},e.thicknessPxToAnnotDPI=function(t){return parseFloat((t/e.DPI_RATIO).toFixed(2))},e.getAnnotRatio=function(t,n){return h.default.instance.getRatioByOriginSize(t,n)*e.DPI_RATIO},e.getAnnotData=function(e,t,n){var i=e[t].findIndex((function(e){return e.id===n}));return i>-1?e[t][i]:null},e.getAnnotLoadingRange=function(t,n){var i=0,o=0;return l.Util.isCellSkin(t)?o=(i=t.currentSheet)+1:(i=n-e.DEFAULT_LOADING_CNT<0?0:n-e.DEFAULT_LOADING_CNT,o=n+e.DEFAULT_LOADING_CNT>t.status.pageNum?t.status.pageNum:n+e.DEFAULT_LOADING_CNT),{startIdx:i,endIdx:o}},e}();t.default=b}).call(this,n(4),n(41))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.LocaleMessage=void 0;var r=n(0),a=function(){function e(){}return e.getMessage=function(t){return e.messages[t]},e.defaultLanguage="en",e.currentLanguage=null,e.messages=null,e.setLocale=function(t){return i(void 0,void 0,void 0,(function(){var n,i;return o(this,(function(o){switch(o.label){case 0:return n={ZH_CN:"zh",ZH:"zh",ZH_TW:"tw",TW:"tw",JA_JP:"ja",JA:"ja",EN_US:"en",EN:"en",KO:"ko",KO_KR:"ko"},e.currentLanguage=n[t.toUpperCase()]||e.defaultLanguage,i=e,[4,r.Util.getJson("locales/"+e.currentLanguage+".js?"+(new Date).getTime(),null,"js")];case 1:return i.messages=o.sent(),[2,e.currentLanguage]}}))}))},e.setLocaleMessage=function(){document.getElementById("mobile-download-btn").innerText=e.getMessage("msg_download"),document.getElementById("mobile-bgcolor-btn").innerText=e.getMessage("msg_light_backgroundcolor"),document.getElementById("mobile-sns-btn").innerText=e.getMessage("sns_title"),document.getElementById("mobile-info-btn").innerText=e.getMessage("info_menu"),document.getElementById("mobile-print-btn").innerText=e.getMessage("print_menu"),document.getElementById("total-page").setAttribute("data-content",""+e.getMessage("page_total")),document.getElementById("page__input").title=e.getMessage("current-page"),document.getElementById("page__input-label").innerText=e.getMessage("current-page"),document.getElementById("mobile-download-btn").title=e.getMessage("icon_download"),document.getElementById("mobile-bgcolor-btn").title=e.getMessage("icon_backgroundcolor"),document.getElementById("mobile-info-btn").title=e.getMessage("info_menu"),document.getElementById("mobile-print-btn").title=e.getMessage("print_menu"),document.getElementById("laser-btn").title=e.getMessage("laser-btn"),document.getElementById("laser-btn__img").title=e.getMessage("laser-btn"),document.getElementById("sns-btn").title=e.getMessage("sns_title"),document.getElementById("sns-btn__img").alt=e.getMessage("sns_title"),document.getElementById("info-btn").title=e.getMessage("info_menu"),document.getElementById("info-btn__img").alt=e.getMessage("info_menu"),document.getElementById("select-arrow").title=e.getMessage("icon_move_page_open"),document.getElementById("select-arrow-img").alt=e.getMessage("icon_move_page_open"),document.getElementById("header-tablist").title=e.getMessage("icon_move_sheet_open"),document.getElementById("header-tablist__input").alt=e.getMessage("icon_move_sheet_open"),document.getElementById("tabmore").title=e.getMessage("icon_move_sheet_open"),document.getElementById("tabmore__img").alt=e.getMessage("icon_move_sheet_open"),document.getElementById("sheet-prev").title=e.getMessage("icon_prev_sheet"),document.getElementById("sheet-prev__img").alt=e.getMessage("icon_prev_sheet"),document.getElementById("sheet-next").title=e.getMessage("icon_next_sheet"),document.getElementById("sheet-next__img").alt=e.getMessage("icon_next_sheet"),document.getElementById("thumbnailview-btn").title=e.getMessage("icon_thumbnail_open"),document.getElementById("thumbnail-btn").title=e.getMessage("icon_thumbnail_open"),document.getElementById("mobile-thumbnailbar").title=e.getMessage("icon_thumbnail_close"),document.getElementById("web-thumbnailbar").title=e.getMessage("icon_thumbnail_drag"),document.getElementById("download-btn").title=e.getMessage("icon_download"),document.getElementById("download-btn__img").alt=e.getMessage("icon_download"),document.getElementById("backgroundcolor-btn").title=e.getMessage("icon_backgroundcolor"),document.getElementById("backgroundcolor-btn__img").alt=e.getMessage("icon_backgroundcolor"),document.getElementById("print-btn").title=e.getMessage("print_menu"),document.getElementById("print-btn__img").alt=e.getMessage("print_menu"),document.getElementById("presentation-btn").title=e.getMessage("icon_fullscreen_open"),document.getElementById("desktop-fullscreen-btn__img").alt=e.getMessage("icon_fullscreen_open"),document.getElementById("fullscreen").title=e.getMessage("icon_fullscreen_open"),document.getElementById("mobile-fullscreen-btn__img").alt=e.getMessage("icon_fullscreen_open"),document.getElementById("more").title=e.getMessage("icon_more"),document.getElementById("more-btn").title=e.getMessage("icon_more"),document.getElementById("search-btn").title=e.getMessage("icon_search"),document.getElementById("search-btn__img").alt=e.getMessage("icon_search"),document.getElementById("marker-btn").title=e.getMessage("icon_annotation_open"),document.getElementById("marker-btn__img").title=e.getMessage("icon_annotation_open"),document.getElementById("server-pdf-btn").title=e.getMessage("msg_server_pdf"),document.getElementById("server-pdf-btn__img").title=e.getMessage("msg_server_pdf"),document.getElementById("mobile-server-pdf-btn").title=e.getMessage("msg_server_pdf"),document.getElementById("export-pdf-btn").title=e.getMessage("msg_export_pdf"),document.getElementById("export-pdf-btn__img").title=e.getMessage("msg_export_pdf"),document.getElementById("mobile-export-pdf-btn").title=e.getMessage("msg_export_pdf"),document.getElementById("mobile-sns-btn").title=e.getMessage("sns_title"),document.getElementById("page-hand-scroll").title=e.getMessage("icon_hand_scroll"),document.getElementById("page-prev").title=e.getMessage("icon_prev_page"),document.getElementById("page-next").title=e.getMessage("icon_next_page"),document.getElementById("page-zoomout").title=e.getMessage("icon_zoomout"),document.getElementById("page-zoomin").title=e.getMessage("icon_zoomin"),document.getElementById("page-originsize").title=e.getMessage("icon_originsize"),document.getElementById("page-pagewidthfit").title=e.getMessage("icon_pagewidthfit"),document.getElementById("page-pagefit").title=e.getMessage("icon_pagefit"),document.getElementById("page-rotate").title=e.getMessage("icon_rotate_clockwise"),document.getElementById("cell-hand-scroll").title=e.getMessage("icon_hand_scroll"),document.getElementById("cell-first").title=e.getMessage("icon_first_sheet"),document.getElementById("cell-prev").title=e.getMessage("icon_prev_sheet"),document.getElementById("cell-next").title=e.getMessage("icon_next_sheet"),document.getElementById("cell-end").title=e.getMessage("icon_end_sheet"),document.getElementById("cell-zoomout").title=e.getMessage("icon_zoomout"),document.getElementById("cell-zoomin").title=e.getMessage("icon_zoomin"),document.getElementById("fullscreen-close").title=e.getMessage("icon_fullscreen_close"),document.getElementById("fullscreen-close__img").alt=e.getMessage("icon_fullscreen_close"),document.getElementById("fullscreen-prev").title=e.getMessage("icon_prev"),document.getElementById("fullscreen-next").title=e.getMessage("icon_next"),document.getElementById("search__label").textContent=e.getMessage("input-searchword"),document.getElementById("search-prev").title=e.getMessage("icon_prev"),document.getElementById("search-next").title=e.getMessage("icon_next"),document.getElementById("search-close").title=e.getMessage("icon_close"),document.getElementById("marker-eraser-btn").title=e.getMessage("icon_eraser_marker"),document.getElementById("marker-eraser-btn__img").alt=e.getMessage("icon_eraser_marker"),document.getElementById("marker-undo-btn").title=e.getMessage("icon_marker_undo"),document.getElementById("marker-undo-btn__img").alt=e.getMessage("icon_marker_undo"),document.getElementById("marker-redo-btn").title=e.getMessage("icon_marker_redo"),document.getElementById("marker-redo-btn__img").alt=e.getMessage("icon_marker_redo"),document.getElementById("annotation-close").title=e.getMessage("icon_annotation_close"),document.getElementById("annotation-close-btn__img").alt=e.getMessage("icon_annotation_close"),document.getElementById("annotation-list-btn").title=e.getMessage("icon_annotation_list"),document.getElementById("annotation-list-btn__img").alt=e.getMessage("icon_annotation_list"),document.getElementById("select-annotation-btn").title=e.getMessage("icon_select_annotation"),document.getElementById("select-annotation-btn__img").alt=e.getMessage("icon_select_annotation"),document.getElementById("marker-hand-scroll-btn").title=e.getMessage("icon_hand_scroll"),document.getElementById("marker-hand-scroll-btn__img").alt=e.getMessage("icon_hand_scroll"),document.getElementById("marker-shapes-btn").title=e.getMessage("icon_marker_shapes"),document.getElementById("marker-shapes-btn__img").title=e.getMessage("icon_marker_shapes"),document.getElementById("marker-pencil-btn").title=e.getMessage("icon_marker_pen"),document.getElementById("marker-pencil-btn__img").title=e.getMessage("icon_marker_pen"),document.getElementById("marker-memo-btn").title=e.getMessage("icon_memo"),document.getElementById("marker-memo-btn__img").title=e.getMessage("icon_memo"),document.getElementById("marker-freetext-btn").title=e.getMessage("icon_freetext"),document.getElementById("marker-freetext-btn__img").title=e.getMessage("icon_freetext"),document.getElementById("marker-square-btn").title=e.getMessage("icon_marker_square"),document.getElementById("marker-square-btn__img").title=e.getMessage("icon_marker_square"),document.getElementById("marker-line-btn").title=e.getMessage("icon_marker_line"),document.getElementById("marker-line-btn__img").title=e.getMessage("icon_marker_line"),document.getElementById("marker-circle-btn").title=e.getMessage("icon_marker_circle"),document.getElementById("marker-circle-btn__img").title=e.getMessage("icon_marker_circle"),document.getElementById("marker-arrowline-btn").title=e.getMessage("icon_marker_arrowline"),document.getElementById("marker-arrowline-btn__img").title=e.getMessage("icon_marker_arrowline"),document.getElementById("thickness_title").innerText=e.getMessage("marker_thickness"),document.getElementById("thickness__input").title=e.getMessage("marker_thickness"),document.getElementById("transparency_title").innerText=e.getMessage("marker_transparency"),document.getElementById("transparency__input").title=e.getMessage("marker_transparency"),document.getElementById("text-style-btn").innerText=e.getMessage("text-style-btn"),document.getElementById("text-style-btn").title=e.getMessage("text-style-btn"),document.getElementById("border-style-btn").innerText=e.getMessage("border-style-btn"),document.getElementById("border-style-btn").title=e.getMessage("border-style-btn"),document.getElementById("fill-style-btn").innerText=e.getMessage("fill-style-btn"),document.getElementById("fill-style-btn").title=e.getMessage("fill-style-btn"),document.getElementById("font-size_title").innerText=e.getMessage("freetext_font-size"),document.getElementById("font-size__input").title=e.getMessage("freetext_font-size"),document.getElementById("text-alignment_title").innerText=e.getMessage("freetext_text-alignment"),document.getElementById("left-align-btn").title=e.getMessage("freetext_left-align-btn"),document.getElementById("center-align-btn").title=e.getMessage("freetext_center-align-btn"),document.getElementById("right-align-btn").title=e.getMessage("freetext_right-align-btn"),document.getElementById("color-type1-btn").title=e.getMessage("color-type1"),document.getElementById("color-type2-btn").title=e.getMessage("color-type2"),document.getElementById("color-type3-btn").title=e.getMessage("color-type3"),document.getElementById("color-type4-btn").title=e.getMessage("color-type4"),document.getElementById("color-type5-btn").title=e.getMessage("color-type5"),document.getElementById("color-type6-btn").title=e.getMessage("color-type6"),document.getElementById("color-type7-btn").title=e.getMessage("color-type7"),document.getElementById("color-type8-btn").title=e.getMessage("color-type8"),document.getElementById("color-type9-btn").title=e.getMessage("color-type9"),document.getElementById("color-type10-btn").title=e.getMessage("color-type10"),document.getElementById("color-type11-btn").title=e.getMessage("color-type11"),document.getElementById("color-type12-btn").title=e.getMessage("color-type12"),document.getElementById("color-type13-btn").title=e.getMessage("color-type13"),document.getElementById("color-type14-btn").title=e.getMessage("color-type14"),document.getElementById("color-type15-btn").title=e.getMessage("color-type15"),document.getElementById("color-type16-btn").title=e.getMessage("color-type16"),document.getElementById("color-type17-btn").title=e.getMessage("color-type17"),document.getElementById("color-type18-btn").title=e.getMessage("color-type18"),document.getElementById("color-type19-btn").title=e.getMessage("color-type19"),document.getElementById("color-type20-btn").title=e.getMessage("color-type20"),document.getElementById("color-type21-btn").title=e.getMessage("color-type21"),document.getElementById("color-type22-btn").title=e.getMessage("color-type22"),document.getElementById("color-type23-btn").title=e.getMessage("color-type23"),document.getElementById("color-type24-btn").title=e.getMessage("color-type24"),document.getElementById("annotation-popup__memo").title=e.getMessage("icon_memo"),document.getElementById("annotation-popup__prop").title=e.getMessage("icon_prop"),document.getElementById("annotation-popup__delete").title=e.getMessage("icon_delete"),document.getElementsByClassName("annotation-popup__img--memo")[0].alt=e.getMessage("icon_memo"),document.getElementById("annotation-memo__author-label").innerText=e.getMessage("input_author")+" : ",document.getElementById("annotation-memo__delete-btn").title=e.getMessage("icon_delete"),document.getElementById("annotation-memo__delete-btn").alt=e.getMessage("icon_delete"),document.getElementById("annotation-memo__content").title=e.getMessage("memo-content"),document.getElementById("annotation-memo__content-label").innerText=e.getMessage("memo-content"),document.getElementById("annotation-color-picker__color--yellow").title=e.getMessage("hightlight_color_yellow"),document.getElementById("annotation-color-picker__color--yellow").alt=e.getMessage("hightlight_color_yellow"),document.getElementById("annotation-color-picker__color--green").title=e.getMessage("hightlight_color_green"),document.getElementById("annotation-color-picker__color--green").alt=e.getMessage("hightlight_color_green"),document.getElementById("annotation-color-picker__color--blue").title=e.getMessage("hightlight_color_blue"),document.getElementById("annotation-color-picker__color--blue").alt=e.getMessage("hightlight_color_blue"),document.getElementById("annotation-color-picker__color--pink").title=e.getMessage("hightlight_color_pink"),document.getElementById("annotation-color-picker__color--pink").alt=e.getMessage("hightlight_hightlight_color_pinkcolor_pink"),document.getElementById("annotation-color-picker__color--transparent").title=e.getMessage("hightlight_color_none"),document.getElementById("annotation-color-picker__color--transparent").alt=e.getMessage("hightlight_color_none"),document.getElementById("fileExplorer-header__closeBtn").title=e.getMessage("fileExplore-close"),document.getElementById("fileExplorer-path__nextBtn").title=e.getMessage("fileExplore-next"),document.getElementById("fileExplorer-path__prevBtn").title=e.getMessage("fileExplore-prev"),document.getElementById("fileExplorer-fileTree-sort__div-fileName").title=e.getMessage("fileExplore-filename-sort"),document.getElementById("fileExplorer-fileTree-sort__div-fileType").title=e.getMessage("fileExplore-filetype-sort"),document.getElementById("fileExplorer-fileTree-sort__div-fileSize").title=e.getMessage("fileExplore-filesize-sort"),document.getElementsByClassName("fileExplorer-allCount__txt")[0].innerText=e.getMessage("fileExplorer-allCount__txt"),document.getElementsByClassName("fileExplorer-allCount__txt")[0].title=e.getMessage("fileExplorer-allCount__txt"),document.getElementById("fileExplorer-sort-fileName").title=e.getMessage("fileExplorer-sort-fileName"),document.getElementById("fileExplorer-sort-fileName").innerText=e.getMessage("fileExplorer-sort-fileName"),document.getElementById("fileExplorer-sort-fileType").title=e.getMessage("fileExplorer-sort-fileType"),document.getElementById("fileExplorer-sort-fileType").innerText=e.getMessage("fileExplorer-sort-fileType"),document.getElementById("fileExplorer-sort-fileSize").title=e.getMessage("fileExplorer-sort-fileSize"),document.getElementById("fileExplorer-sort-fileSize").innerText=e.getMessage("fileExplorer-sort-fileSize"),document.getElementsByClassName("fileExplorer-viewerBtn__txt")[0].title=e.getMessage("fileExplorer-viewerBtn__txt"),document.getElementsByClassName("fileExplorer-viewerBtn__txt")[0].innerText=e.getMessage("fileExplorer-viewerBtn__txt"),document.getElementById("annotation-list__search__input").placeholder=e.getMessage("annotation_list_search_input"),document.getElementById("annotation-list__search__input").title=e.getMessage("annotation_list_search_input"),document.getElementById("annotation-list__search_btn").title=e.getMessage("annotation_list_search_btn"),document.getElementById("annotation-list__search-result__txt").innerText=e.getMessage("annotation_list_search_result_txt"),document.getElementById("annotation-list__search__input-label").innerText=e.getMessage("annotation_list_search_input")},e}();t.LocaleMessage=a}).call(this,n(4))},,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.ScaleEvent=t.TransformOriginType=void 0;var i,o=n(3),r=n(1),a=n(0),s=n(32);!function(e){e[e.LEFT_TOP=0]="LEFT_TOP",e[e.LEFT_BOTTOM=1]="LEFT_BOTTOM",e[e.RIGHT_TOP=2]="RIGHT_TOP",e[e.RIGHT_BOTTOM=3]="RIGHT_BOTTOM"}(i=t.TransformOriginType||(t.TransformOriginType={}));var l=function(){function t(){}return t.getHeaderAreaHeightWithAnnot=function(){return this._commonHeaderHeight()+this._markerHeaderHeight},t.getDocumentWidth=function(){return this._documentWidth},t.setDocumentWidth=function(e){this._documentWidth=e},t.isAbsolutePosition=function(){return this._useAbsolute},t.getBrowserScale=function(){return r.Browser.instance.isIOS&&0!==this._documentWidth?a.Util.getInnerWidth()/this._documentWidth:a.Util.getInnerWidth()/document.getElementById("container").clientWidth},t.isDefaultBrowserScale=function(){return 1===this.getBrowserScale()},t.getBrowserScaleString=function(){return"scale("+this.getBrowserScale()+")"},t.isSupportScale=function(){return r.Browser.instance.isMobile&&r.Browser.instance.isSupportVisualViewport()},t.getElementStyleMap=function(t){for(var n=new e,i=0;i<t.style.length;i++){var o=t.style[i];n.set(o,t.style[o])}return n},t.getMergedCSSText=function(e,t){for(var n in t)""===t[n]?e.has(n)&&e.delete(n):e.set(n,t[n]);var i="";return e.forEach((function(e,t){""!==e&&(i+=t+":"+e+";")})),i},t.getScaleTransformToMap=function(e,t){var n=this.getBrowserScale(),i="",o="";1!=n&&(i="scale("+n+")",o=t);var r=this.getElementStyleMap(e);return r.set("transform",i),r.set("transform-origin",o),r.set("transform-origin-x",""),r.set("transform-origin-y",""),r.set("transform-origin-z",""),r},t.scale=function(e,t){void 0===t&&(t="left top");var n=this.getScaleTransformToMap(e,t);return e.style.cssText=this.getMergedCSSText(n,{}),this.getBrowserScale()},t.scaleWithPosition=function(e,t,n,o,r){void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=void 0);var s=this.getBrowserScale(),l=1!==s,c="",d="",u="";if(l){switch(t){case i.RIGHT_TOP:c=a.Util.getPageXOffset()+a.Util.getInnerWidth()-n+"px",d=a.Util.getPageYOffset()+o+"px";break;case i.RIGHT_BOTTOM:c=a.Util.getPageXOffset()+a.Util.getInnerWidth()-n+"px",d=a.Util.getPageYOffset()+a.Util.getInnerHeight()-o+"px";break;case i.LEFT_BOTTOM:c=a.Util.getPageXOffset()+n+"px",d=a.Util.getPageYOffset()+a.Util.getInnerHeight()-o+"px";break;case i.LEFT_TOP:default:c=a.Util.getPageXOffset()+n+"px",d=a.Util.getPageYOffset()+o+"px"}this._useAbsolute&&(u="absolute")}var h=this.getScaleTransformToMap(e,"left top"),f={left:c,top:d,position:u};return void 0!==r&&(f.height=l?r:""),e.style.cssText=this.getMergedCSSText(h,f),s},t.saveViewportStatus=function(){this._pageXOffset=a.Util.getPageXOffset(),this._pageYOffset=a.Util.getPageYOffset()},t.isChangePageOffset=function(){var e=r.Browser.instance.isIOS&&this._pageYOffset!==a.Util.getPageYOffset()&&1!==this.getBrowserScale();return this._pageXOffset!==a.Util.getPageXOffset()||e},t.disableScrollEvent=function(){t.disableiOSFocusScale(),t._stopScroll=!0},t.enableScrollEvent=function(){t.enableiOSFocusScale(),t._stopScroll=!1},t.isStopScroll=function(){return this._stopScroll},t.disableiOSFocusScale=function(){var e=document.querySelector('meta[name="viewport"]');this._viewportContent=e.getAttribute("content"),e.setAttribute("content",this._viewportContent+", user-scalable=no")},t.enableiOSFocusScale=function(){""!==this._viewportContent&&(document.querySelector('meta[name="viewport"]').setAttribute("content",this._viewportContent),this._viewportContent="")},t._doScaleSkinThumbnail=function(){var e=this.getBrowserScale(),n=0;if(s.Thumbnail.THUMB_STATUS===s.THUMB_FLAG.on){var r=document.getElementById("thumbnail"),l=parseInt(o(".wrap__thumbnail").css("padding-top")),c=a.Util.getInnerHeight()/e-l;0===this._firstThumbnailWidth&&(this._firstThumbnailWidth=parseInt(o(".wrap__thumbnail").css("width"))),n=this._firstThumbnailWidth*e,t.scaleWithPosition(r,i.LEFT_TOP,0,0,c+"px")}var d=document.getElementById("thumbnailbar"),u=parseInt(o(".wrap__thumbnailbar").css("width")),h=(a.Util.getInnerHeight()-u*e)/2;t.scaleWithPosition(d,i.LEFT_TOP,n,h)},t.doScaleSkinContents=function(e){var t=document.getElementById("contents");if(a.Util.hasClass(t,"wrap__contents--marker-mode")){var n=this.getHeaderAreaHeightWithAnnot()*e;t.style.top=n+"px"}else if(!r.Browser.instance.isMobile||a.Util.headerAutoHide()||a.Util.isFullScreen())t.style.top="";else{n=this._commonHeaderHeight()*e;t.style.top=n+"px"}},t._doScaleSkinThumbsAndAnnot=function(e,n){if(t._doScaleSkinThumbnail(),e){var r=document.getElementById("marker-header");t.scaleWithPosition(r,i.LEFT_TOP,0,this._markerHeaderHeight*n);var s=document.getElementById("annotation-list"),l=parseInt(o(".wrap__annotation-list").css("padding-top")),c=a.Util.getInnerHeight()/n-l;t.scaleWithPosition(s,i.LEFT_TOP,0,0,c+"px")}},t.doScale=function(e,n){if(e&&r.Browser.instance.isIOS){var o=!0;if(r.Browser.instance.isSupportVisualViewport()&&(o=window.visualViewport.scale<1),this._firstShowHeader&&o)return void(this._firstShowHeader=!1)}if(!(this._firstShowHeader&&(this._firstShowHeader=!1,t.isDefaultBrowserScale())||a.Util.hasClass(this.objHeader,"wrap__header--hide")&&a.Util.headerAutoHide())){var s=t.scaleWithPosition(this.objHeader,i.LEFT_TOP,0,0);s<1?(this.objHeader.style.outlineStyle="solid",this.objHeader.style.outlineColor="#000000",this.objHeader.style.outlineWidth=s<.3?"medium":"thin"):(this.objHeader.style.outlineStyle="",this.objHeader.style.outlineColor="",this.objHeader.style.outlineWidth=""),this.doScaleSkinContents(s),e||this._doScaleSkinThumbsAndAnnot(n,s)}},t._stopScroll=!1,t._firstShowHeader=!0,t._viewportContent="",t._pageXOffset=0,t._pageYOffset=0,t._firstThumbnailWidth=0,t._documentWidth=0,t._useAbsolute=r.Browser.instance.isIOS&&r.Browser.instance.getIOSVersion()>=11||r.Browser.instance.isIPadOSInDesktopSafari,t._commonHeaderHeight=function(){return parseInt(o(".wrap__header").css("height"))},t._markerHeaderHeight=parseInt(o(".marker-header").css("height")),t.objHeader=document.getElementById("header"),t}();t.ScaleEvent=l}).call(this,n(41))},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingTool=t.getViewBox=t.getHalfBorderSize=t.getAnnotSizeWithStroke=t.getPathList=t.getAnnotInfoFontColor=t.getAnnotInfoFontSize=t.getAnnotInfoTextAlign=t.getAnnotInfoPathText=t.getAnnotInfoStrokeWidth=t.getAnnotInfoAlpha=t.getAnnotInfoInnerColor=t.getAnnotInfoColor=void 0;var i=n(27),o=n(16),r=n(0);function a(e){return e&&e.w?e.w:"1.0"}function s(e,t){return void 0===t&&(t=2),{left:e.left.toFixed(t),top:e.top.toFixed(t),width:e.width.toFixed(t),height:e.height.toFixed(t)}}function l(e){return e?parseFloat(a(e))/2:0}function c(e,t,n,i,o){var r=l(o);return s({left:parseFloat(e)+r-d.VIEWBOX_RANGE,top:parseFloat(t)+r-d.VIEWBOX_RANGE,width:parseFloat(n)-2*r+2*d.VIEWBOX_RANGE,height:parseFloat(i)-2*r+2*d.VIEWBOX_RANGE})}t.getAnnotInfoColor=function(e){return e||"none"},t.getAnnotInfoInnerColor=function(e){return e||"none"},t.getAnnotInfoAlpha=function(e){return e||"1.0"},t.getAnnotInfoStrokeWidth=a,t.getAnnotInfoPathText=function(e){return e&&e.text?e.text:""},t.getAnnotInfoTextAlign=function(e){return e||"left"},t.getAnnotInfoFontSize=function(e){return e||"12"},t.getAnnotInfoFontColor=function(e){return e||"000000"},t.getPathList=function(e){for(var t=e,n=t.indexOf("M"),i=[];n>-1;){var o=t.indexOf("M",n+1),r=o>-1?t.substring(n,o):t.substring(n);i.push(r),n=o}return i},t.getAnnotSizeWithStroke=function(e,t,n,i,o){return s({left:e-o/2,top:t-o/2,width:n+o,height:i+o})},t.getHalfBorderSize=l,t.getViewBox=c;var d=function(){function e(e,t,n,o,a){var s=this;this.marker=null,this.eventObserver=null,this.newSvg=null,this.curMarkerSection=null,this.attr=null,this.funcSaveDrawing=null,this.isCell=!1,this.redrawAttrEl=function(e,t,n){},this.getMarkerStyleAttr=function(e,t){return null},this.moveMarker=function(e,t,n){return""},this.createAnnotBaseInfo=function(e,t,n,i,o){var a=s.getAnnotSize(i,o);return{id:e,annot:{type:"",l:a.left,t:a.top,w:a.width,h:a.height,c:t,a:n,contents:{d:r.Util.getTimestamp(),t:s.attr.author,text:""}}}},this.markerDrawBind=function(e,t,n){"mousedown"===i.event.type?e.on("mousemove",(function(){n()})):"pointerdown"===i.event.type?e.on("pointermove",(function(){n()})):e.on("touchmove",(function(){i.event.preventDefault();var o=parseFloat(e.node().style.width),r=parseFloat(e.node().style.height),a=i.touches(this)[0];a[0]<0||a[0]>o||a[1]<0||a[1]>r?t(e,this):n()}))},this.getSvgElement=function(){return s.newSvg&&s.newSvg.node()},this.getCurMarkerSection=function(){return s.curMarkerSection},this.clear=function(){s.newSvg=null,s.curMarkerSection=null},this.setSvgStyle=function(e,t){var n=e.style;for(var i in t){var o=t[i];if("color"===i){var r="#"+o;n.stroke=r}else"innerColor"===i?n.fill="none"===o?o:"#"+o:"thickness"===i?n["stroke-width"]=o:"transparency"===i&&(n.opacity=o)}},this.redrawMoveAttr=function(e,t){var n=c(t.annot.l,t.annot.t,t.annot.w,t.annot.h,null),o=n.left,r=n.top,a=n.width,s=n.height;i.select(e).attr("viewBox",o+" "+r+" "+a+" "+s).style("left",o+"px").style("top",r+"px").style("width",a+"px").style("height",s+"px")},this.eventBindClear=function(e){e.on("touchstart",null),e.on("touchend",null),e.on("mousedown",null),e.on("mouseup",null),e.on("mouseleave",null),e.on("click",null),e.on("pointerdown",null),e.on("pointerup",null),e.on("pointermove",null)},this.eventBind=function(e){s.eventBindClear(e),s.markerEventBind(e,(function(){return r.Util.isSmallScreen()?r.Util.hasClass(document.getElementById("prop-submenu"),"hide"):(s.eventObserver.closeProp.notify(),!0)}))},this.marker=e,this.eventObserver=t,this.attr=n,this.funcSaveDrawing=o,this.isCell=a}return e.prototype.setAnnotInfoAuthor=function(e){e.annot.contents||(e.annot.contents={d:"",t:"",text:""}),e.annot.contents.t=this.attr.author.trim()},e.prototype.setAnnotInfoText=function(e,t){(e.annot.contents||(e.annot.contents={d:"",t:"",text:""}),e.annot.contents.text=t,"freetext"===o.getAnnotType(e.annot))&&(e.annot.rc[0].contents=t)},e.prototype.setAnnotInfoTop=function(e,t){e.annot.t=t},e.prototype.setAnnotInfoLeft=function(e,t){e.annot.l=t},e.prototype.setAnnotInfoWidth=function(e,t){e.annot.w=t},e.prototype.setAnnotInfoHeight=function(e,t){e.annot.h=t},e.prototype.setAnnotInfoColor=function(e,t){e.annot.c=t},e.prototype.setAnnotInfoAlpha=function(e,t){e.annot.a=""+t},e.prototype.setAnnotInfoTextAlign=function(e,t){var n=e.annot;n.ds&&(n.ds.align=t,n.rc[0].align=t)},e.prototype.setAnnotInfoFontSize=function(e,t){var n=e.annot;n.ds&&(n.ds.size=t,n.rc[0].size=t)},e.prototype.setAnnotInfoFontColor=function(e,t){var n=e.annot;n.ds&&(n.ds.c=t,n.rc[0].c=t)},e.prototype.setAnnotInfoInnerColor=function(e,t){},e.prototype.modifyAnnotInfo=function(e,t){for(var n in t){var i=t[n];switch(n){case"color":this.setAnnotInfoColor(e,i);break;case"innerColor":this.setAnnotInfoInnerColor(e,i);break;case"thickness":this.setAnnotInfoThickness(e,i);break;case"transparency":this.setAnnotInfoAlpha(e,i);break;case"author":this.setAnnotInfoAuthor(e);break;case"text":this.setAnnotInfoText(e,i);break;case"left":this.setAnnotInfoLeft(e,i);break;case"top":this.setAnnotInfoTop(e,i);break;case"width":this.setAnnotInfoWidth(e,i);break;case"height":this.setAnnotInfoHeight(e,i);break;case"path":this.setAnnotInfoPath(e,i);break;case"textAlign":this.setAnnotInfoTextAlign(e,i);break;case"fontSize":this.setAnnotInfoFontSize(e,i);break;case"fontColor":this.setAnnotInfoFontColor(e,i)}}return e},e.VIEWBOX_RANGE=5,e.hexToRgb=function(e){if(!/^[0-9a-fA-F]+$/.test(e)||6!==e.length)return"transparent";e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return t+t+n+n+i+i}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?"rgb("+parseInt(t[1],16)+","+parseInt(t[2],16)+","+parseInt(t[3],16)+")":"#"+e},e}();t.DrawingTool=d},,,function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Page=t.VIEW_MODE=t.RESIZE_TYPE=void 0;var r,a,s=n(1),l=n(37),c=n(38),d=n(0),u=n(3),h=n(32),f=n(53),p=n(164),m=n(6),g=n(19),v=n(78);!function(e){e[e.PageFit=0]="PageFit",e[e.PageWidthFit=1]="PageWidthFit",e[e.PageZoom=2]="PageZoom",e[e.SlidePageFit=3]="SlidePageFit"}(r=t.RESIZE_TYPE||(t.RESIZE_TYPE={})),function(e){e[e.desktop=0]="desktop",e[e.mobile=1]="mobile"}(a=t.VIEW_MODE||(t.VIEW_MODE={}));var b=function(){function e(){var t=this;this.starterLen=20,this.eventObserver=null,this.docInfo=null,this.transparentImg="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.SCROLL_TIMEOUT=80,this.lastTop=null,this.curZoomFactor=l.DetectZoom.getRatio(),this.scrollContentAreaEl=s.Browser.instance.isIOS?u(document):u("#contents"),this.DEFAULT_LOADING_CNT=5,this.isChangingZoomRatio=!1,this.TIMEOUT_WAIT_FOR_ZOOM_RATIO_INIT=1e3,this.changeZoomRatioTimer=null,this.preScrollHeight=0,this.viewMode=a.desktop,this.isOrientationchange=!1,this.getDefaultLoadingCnt=function(){return t.DEFAULT_LOADING_CNT},this.setDefaultLoadingCnt=function(e){t.DEFAULT_LOADING_CNT=e},this.updatePageFocus=function(){if(s.Browser.instance.isIE10Lower()&&t.isChangingZoomRatio)t.eventObserver.page.notify({pageNum:t.docInfo.currentPage,isScroll:!1});else{var n=t.docInfo.status.pageNum;if(s.Browser.instance.isIOS)for(var i=t.scrollContentAreaEl.scrollTop()+e.containerTop(),o=0;o<n;++o){if(i<u("#page-area"+o).offset().top+e.CURRENT_SIZE[o].height/2)return void t.eventObserver.page.notify({pageNum:o,isScroll:!0})}else for(o=0;o<n;++o){var r=e.CURRENT_SIZE[o].height,a=document.getElementById("page-area"+o).getBoundingClientRect().top+r;if(a>0&&a-r/2>e.containerTop())return void(o!==t.docInfo.currentPage&&t.eventObserver.page.notify({pageNum:o,isScroll:!0}))}t.eventObserver.page.notify({pageNum:t.docInfo.status.pageNum-1,isScroll:!0})}},this.scrollEventBind=function(){var n;t.scrollContentAreaEl.on("scroll",(function(i){if(t.preScrollHeight==document.getElementById("container").scrollHeight){if(!(d.Util.isMobileMode()&&t.viewMode!==a.mobile||!d.Util.isMobileMode()&&t.viewMode!==a.desktop)&&(clearTimeout(n),v.MobileEvent.virtualKeyboardMode!==v.VK_MODE.changeStatus)){var o=document.getElementById("contents").offsetHeight;if(null===t.lastTop){var l=document.getElementById("contents").scrollHeight;t.lastTop=l-o}var c=window.innerHeight,u=o!==c?t.lastTop-(c-o):t.lastTop;if(!(null!==t.lastTop&&t.scrollContentAreaEl.scrollTop()>=u-5)){var h=d.Util.isFullScreen()||!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);return!h||h&&(!s.Browser.instance.isMobile&&100!==t.curZoomFactor||s.Browser.instance.isMobile&&e.RESIZE_OBJ.type!=r.PageFit)?(n=setTimeout(t.updatePageFocus,t.SCROLL_TIMEOUT),void t.eventObserver.scroll.notify(i.originalEvent)):void 0}var f=document.getElementById("page-area"+t.docInfo.currentPage).getBoundingClientRect().top;n=f>0?setTimeout((function(){t.eventObserver.page.notify({pageNum:t.docInfo.currentPage,isScroll:!0})}),t.SCROLL_TIMEOUT):setTimeout((function(){t.eventObserver.page.notify({pageNum:t.docInfo.status.pageNum-1,isScroll:!0})}),t.SCROLL_TIMEOUT)}}else t.preScrollHeight=document.getElementById("container").scrollHeight}))},this.focusPage=function(n){s.Browser.instance.isMobile&&t.docInfo.currentPage!==n.pageNum&&u("#thumb-area"+t.docInfo.currentPage).addClass("thumb--nohover"),t.docInfo.currentPage=n.pageNum,t.loadPageImg(t.docInfo.currentPage),t.eventObserver.moveBtn.notify(),!0!==n.isScroll&&(t.scrollContentAreaEl.scrollTop(e.getPageScrollTop(n.pageNum)),e.updateFullscreenCloseBtn(t.docInfo),n.callback&&n.callback())},this.checkMoveControlbar=function(){0===t.docInfo.currentPage?(u("#page-prev").removeClass("controlbar--enable"),u("#page-prev").removeClass("controlbar-prev--hover"),u("#page-prev").prop("disabled",!0),u("#mobile-controlbar-prev__btn").addClass("mobile-controlbar-floating__btn--disabled"),u("#mobile-controlbar-prev__btn").prop("disabled",!0)):(u("#page-prev").addClass("controlbar--enable"),u("#page-prev").prop("disabled",!1),u("#mobile-controlbar-prev__btn").removeClass("mobile-controlbar-floating__btn--disabled"),u("#mobile-controlbar-prev__btn").prop("disabled",!1)),t.docInfo.currentPage===t.docInfo.status.pageNum-1?(u("#page-next").removeClass("controlbar--enable"),u("#page-next").removeClass("controlbar-next--hover"),u("#page-next").prop("disabled",!0),u("#mobile-controlbar-next__btn").addClass("mobile-controlbar-floating__btn--disabled"),u("#mobile-controlbar-next__btn").prop("disabled",!0)):(u("#page-next").addClass("controlbar--enable"),u("#page-next").prop("disabled",!1),u("#mobile-controlbar-next__btn").removeClass("mobile-controlbar-floating__btn--disabled"),u("#mobile-controlbar-next__btn").prop("disabled",!1))},this.moveBackPage=function(){0!==t.docInfo.currentPage&&t.eventObserver.page.notify({pageNum:t.docInfo.currentPage-1,isScroll:!1})},this.moveNextPage=function(){t.docInfo.currentPage!==t.docInfo.status.pageNum-1&&t.eventObserver.page.notify({pageNum:t.docInfo.currentPage+1,isScroll:!1})},this.orientationchange=function(){return i(t,void 0,void 0,(function(){return o(this,(function(e){return d.Util.isBrowserFullScreen()&&this._resizePage(),this.isOrientationchange=!0,[2]}))}))},this.resizeWindow=function(){return i(t,void 0,void 0,(function(){var e,t=this;return o(this,(function(n){switch(n.label){case 0:return p.Presentation.doingFullScreenCloseEvent?[2]:(d.Util.isMobileMode()&&this.viewMode!==a.mobile?this.viewMode=a.mobile:d.Util.isMobileMode()||this.viewMode===a.desktop||(this.viewMode=a.desktop),clearTimeout(this.changeZoomRatioTimer),this.lastTop=null,e=l.DetectZoom.getRatio(),this.isChangingZoomRatio=!1,this.curZoomFactor!==e&&(this.curZoomFactor=e,this.isChangingZoomRatio=!0,this.changeZoomRatioTimer=setTimeout((function(){t.isChangingZoomRatio=!1}),this.TIMEOUT_WAIT_FOR_ZOOM_RATIO_INIT)),document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(this._innerResizeWindow(),this.eventObserver.resizePage.notify(),[2]):s.Browser.instance.isIOS?[4,this._resizePageForIOS()]:[3,2]);case 1:return n.sent(),[3,3];case 2:this._resizePage(this.isOrientationchange||!this.isChangingZoomRatio),this.isOrientationchange=!1,n.label=3;case 3:return this.checkResizeControlBar(),this.eventObserver.resizePage.notify(),[2]}}))}))},this._resizePage=function(n){return void 0===n&&(n=!0),i(t,void 0,void 0,(function(){return o(this,(function(t){return this._innerResizeWindow(),n&&v.MobileEvent.virtualKeyboardMode!==v.VK_MODE.changeStatus&&this.scrollContentAreaEl.scrollTop(e.getPageScrollTop(this.docInfo.currentPage)),[2]}))}))},this._resizePageForIOS=function(){return i(t,void 0,void 0,(function(){var t,n=this;return o(this,(function(i){switch(i.label){case 0:return d.Util.isFullScreen()&&(document.getElementById("fullscreen-close").style.top=""),t=this.docInfo.currentPage,u("#wrap__index").css("height",""),[4,d.Util.syncTimer((function(){if(u("#thumbnail").height()>u("#wrap__index").height()){s.Browser.instance.isiPad?u("#wrap__index").css("height",0===window.orientation?768*screen.height/screen.width-85:768*screen.width/screen.height-85):u("#wrap__index").css("height",0===window.orientation?screen.height-85:screen.width)}u("#contents-area").css("visibility","hidden"),u("#wrap__index").css("visibility","hidden"),u("#page__input").css("color","#333333"),n.scrollContentAreaEl.scrollTop(e.getPageScrollTop("0"))}),500)];case 1:return i.sent(),[4,d.Util.syncTimer((function(){return n._innerResizeWindow()}),100)];case 2:return i.sent(),this.eventObserver.page.notify({pageNum:t,isScroll:!1}),[4,d.Util.syncTimer((function(){u("#contents-area").css("visibility",""),u("#wrap__index").css("visibility",""),u("#page__input").css("color","")}),100)];case 3:return i.sent(),[2]}}))}))},this.presentationResize=function(){t.pageResizeAction.resizePage(t.preResizeObj.percent,t.getRotateMap()),t.scrollContentAreaEl.scrollTop(e.getPageScrollTop(t.docInfo.currentPage))},this.setFullscreeniOSEvent=function(e){s.Browser.instance.isiPhone&&s.Browser.instance.isIOS15Over()&&e("resize",t.presentationResize)},this.notSupportFullscreenIN=function(){return i(t,void 0,void 0,(function(){var t,n=this;return o(this,(function(i){switch(i.label){case 0:return t=this.docInfo.currentPage,s.Browser.instance.isIOS?[4,d.Util.syncTimer((function(){return n.pageResizeAction.resizePage(n.preResizeObj.percent,n.getRotateMap())}),200)]:[3,3];case 1:return i.sent(),this.eventObserver.resizePage.notify(),this.scrollContentAreaEl.scrollTop(e.getPageScrollTop(t)),[4,d.Util.syncTimer((function(){return u("#contents-area").css("visibility","")}),100)];case 2:return i.sent(),this.setFullscreeniOSEvent(window.addEventListener),[3,4];case 3:this.pageResizeAction.resizePage(this.preResizeObj.percent,this.getRotateMap()),this.eventObserver.resizePage.notify(),this.scrollContentAreaEl.scrollTop(e.getPageScrollTop(t)),i.label=4;case 4:return e.updateFullscreenCloseBtn(this.docInfo),this.checkResizeControlBar(),this.lastTop=null,[2]}}))}))},this.notSupportFullscreenOUT=function(){return i(t,void 0,void 0,(function(){var t,n=this;return o(this,(function(i){switch(i.label){case 0:return t=this.docInfo.currentPage,s.Browser.instance.isIOS?[4,d.Util.syncTimer((function(){n.pageResizeAction.resizePage(n.preResizeObj.percent,n.getRotateMap()),n.eventObserver.resizePage.notify()}),e.IOS_WAITTIME_FOR_PREVENT_RELOAD)]:[3,3];case 1:return i.sent(),this.scrollContentAreaEl.scrollTop(e.getPageScrollTop(t)),[4,d.Util.syncTimer((function(){u("#contents-area").css("visibility",""),u("#wrap__index").css("visibility",""),u("#page__input").css("color","")}),100)];case 2:return i.sent(),this.setFullscreeniOSEvent(window.removeEventListener),[3,4];case 3:this.pageResizeAction.resizePage(this.preResizeObj.percent,this.getRotateMap()),this.eventObserver.resizePage.notify(),this.scrollContentAreaEl.scrollTop(e.getPageScrollTop(t)),i.label=4;case 4:return this.checkResizeControlBar(),this.lastTop=null,[2]}}))}))},this.annotMode=function(e){return i(t,void 0,void 0,(function(){return o(this,(function(t){return e?u("#contents").addClass("wrap__contents--marker-mode"):u("#contents").removeClass("wrap__contents--marker-mode"),this.scrollEventBind(),[2]}))}))},this.fullScreen=function(n){return i(t,void 0,void 0,(function(){var t;return o(this,(function(i){return"cell"===n.skinType||(t=f.Head.bgColorMode===f.BGCOLOR_MODE.lightScreen?"img-loading-bright":"img-loading",n.isFullScreen?(u(document.body).addClass("wrap__contents--page-fullscreen"),u("#contents").addClass("wrap__contents--page-fullscreen"),s.Browser.instance.isIOS&&(u("#contents-area").css("visibility","hidden"),this.scrollContentAreaEl.scrollTop(e.getPageScrollTop("0"))),u("#container").addClass("wrap__container--presentation"),u("#contents").addClass("wrap__contents--presentation"),u("#thumbnailbar").addClass("wrap__thumbnailbar--presentation"),u("."+t).addClass("img-loading-black"),n.isSupport||u(".wrap__header").addClass("wrap__header--presentation"),this.setFitAction(),n.isSupport||(u(".wrap__header").addClass("wrap__header--presentation"),!n.error&&this.notSupportFullscreenIN())):(u(document.body).removeClass("wrap__contents--page-fullscreen"),d.Util.isFullScreen()&&(s.Browser.instance.isIOS&&(u("#contents-area").css("visibility","hidden"),u("#wrap__index").css("visibility","hidden"),u("#page__input").css("color","#333333"),this.scrollContentAreaEl.scrollTop(e.getPageScrollTop("0"))),this.eventObserver.bgColor.notify(f.Head.bgColorMode),u("#container").removeClass("wrap__container--presentation"),u("#contents").removeClass("wrap__contents--presentation"),u("#thumbnailbar").removeClass("wrap__thumbnailbar--presentation"),u("#contents").removeClass("wrap__contents--page-fullscreen"),u(".contents-page").removeClass("img-loading-black"),u(".contents-page__img").removeClass("img-loading-black"),u(".contents-page > img").removeAttr("style"),u(".contents-page > iframe").removeAttr("style"),e.RESIZE_OBJ=this.preResizeObj,this.pageResizeAction=this.prePageAction,n.isSupport||(u(".wrap__header").removeClass("wrap__header--presentation"),this.notSupportFullscreenOUT()),d.Util.isMobileMode()&&h.Thumbnail.THUMB_STATUS===h.THUMB_FLAG.off&&(this.eventObserver.mobileHeader.notify(c.ShowActionType.HIDE3SEC),this.eventObserver.mobileThumb.notify(c.ShowActionType.HIDE3SEC)),this.fullscreenAfterEvent()))),[2]}))}))},this.mouseEventBind=function(){u("#contents-area").on("click",(function(){s.Browser.instance.isMobile||d.Util.isFullScreen()||window.setTimeout((function(){t.toggleMobileHeaderAndThumb()}),0)}))},this.toggleMobileHeaderAndThumb=function(){if(d.Util.isMobileMode()&&!m.default.isAnnotMode){var e=(d.Util.isConvImg(t.docInfo)||d.Util.isHtmlImageSkin(t.docInfo))&&"none"===u(".wrap__thumbnailbar").css("display");"none"===u(".wrap__header").css("display")||e?h.Thumbnail.isOn()?(t.eventObserver.mobileThumb.notify(c.ShowActionType.SHOW),t.eventObserver.mobileHeader.notify(c.ShowActionType.SHOW)):(t.eventObserver.mobileThumb.notify(c.ShowActionType.HIDE3SEC),t.eventObserver.mobileHeader.notify(c.ShowActionType.HIDE3SEC)):(t.eventObserver.mobileThumb.notify(c.ShowActionType.HIDE),t.eventObserver.mobileHeader.notify(c.ShowActionType.HIDE))}},this.singleTap=function(){t.toggleMobileHeaderAndThumb()}}return e.getPageScrollTop=function(t){var n=document.getElementById("page-area"+t);return null===n?0:n.offsetTop-(s.Browser.instance.isIOS?e.containerTop():0)},e.prototype.load=function(e,t){this.docInfo=e,this.preScrollHeight=document.getElementById("container").scrollHeight,s.Browser.instance.isIOS&&(u("#wrap").addClass("wrap--ios"),u("#container").addClass("wrap__container--ios"),u("#contents").addClass("wrap__contents--ios"),u("#thumbnail").addClass("wrap__thumbnail--ios"),u("#annotation-list").addClass("wrap__annotation-list--ios"),u("#footer").addClass("wrap__footer--ios")),d.Util.isMobileMode()&&(this.viewMode=a.mobile)},e.RESIZE_OBJ={type:r.PageFit,percent:0},e.ORIGIN_SIZE=[],e.CURRENT_SIZE=[],e.isOutFullscreen=!1,e.IOS_WAITTIME_FOR_PREVENT_RELOAD=700,e.containerTop=function(){return parseInt(u("#container").css("top"))},e.fullscreenBtnWidth=parseInt(u(".fullscreen-close").css("width")),e.updateFullscreenCloseBtn=function(t){if(d.Util.isFullScreen()&&s.Browser.instance.isMobile&&!d.Util.needDocumentFitCss(t)){var n=document.getElementById("fullscreen-close"),i=g.ScaleEvent.getBrowserScale();if(1===i&&s.Browser.instance.isIOS&&!s.Browser.instance.isiPad&&s.Browser.instance.getIOSVersion()>=11&&s.Browser.instance.getIOSVersion()<=13){var o=document.getElementById("page-area0").getBoundingClientRect().top;return n.style.position="absolute",void(n.style.top=Math.abs(o)+"px")}g.ScaleEvent.scaleWithPosition(n,g.TransformOriginType.RIGHT_TOP,e.fullscreenBtnWidth*i,0)}},e}();t.Page=b}).call(this,n(4))},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(26),r=n(33),a=n(0),s=function(){function e(){this.ratioList=null,this.getRatioByOriginSize=function(t,n){return n?r.ImageSheet.resizePercent/100:e.instance.getRatio(t)*o.Page.ORIGIN_SIZE[t].width/o.Page.ORIGIN_SIZE[t].origin_width},this.getPageOrCurrentSheetRatio=function(t,n){return n?r.ImageSheet.resizePercent/100:e.instance.getRatio(t)}}return Object.defineProperty(e,"instance",{get:function(){return i||(i=new e),i},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.ratioList=a.Util.fill(new Array(e),Number.MIN_SAFE_INTEGER)},e.prototype.getRatio=function(e){return this.ratioList?(this.ratioList[e]===Number.MIN_SAFE_INTEGER&&(this.ratioList[e]=parseFloat(document.getElementById("page"+e).style.width)/o.Page.ORIGIN_SIZE[e].width),this.ratioList[e]):(a.Util.printConsoleLog("Cannot get ratio"),1)},e.prototype.getDocumentRatio=function(e,t){return t?100/r.ImageSheet.resizePercent:o.Page.ORIGIN_SIZE[e].width/parseFloat(document.getElementById("page"+e).style.width)},e}();t.default=s},,function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thumbnail=t.THUMB_FLAG=void 0;var r,a=n(1),s=n(17),l=n(37),c=n(0),d=n(3),u=n(272),h=n(273),f=n(6);!function(e){e[e.on=0]="on",e[e.off=1]="off"}(r=t.THUMB_FLAG||(t.THUMB_FLAG={}));var p=function(){function e(){var t=this;this.eventObserver=null,this.docInfo=null,this.transparentImg="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.THUMB_SIZE=[],this.initThumbNum=21,this.isWindowCSS=window.CSS&&window.CSS.supports&&window.CSS.supports("--page-width","0"),this.protectedObj={timer:this.thumbBtnTimer},this.thumbnailMobile=new u.ThumbnailMobile(this.protectedObj),this.thumbnailDesktop=new h.ThumbnailDesktop(this.protectedObj),this.webThumbnailResize=function(){var n=!1;d("#web-thumbnailbar").on(a.Browser.instance.isMobile?"touchstart":"mousedown",(function(){n=!0,d("#container").css("pointer-events","none")}));var i=0;d(document).on(a.Browser.instance.isMobile?"touchmove":"mousemove",(function(e){if(n){var i=a.Browser.instance.isMobile?e.changedTouches[0].pageX:e.clientX,o=i>0?i:0;o<520&&(t.jqContents.css("left",o),d(".wrap__thumbnail").css({width:o,"overflow-y":"scroll"}),t.jqThumbnailBar.css("left",o),t.eventObserver.resizeContents.notify())}else d("#container").css("pointer-events","auto")})).on(a.Browser.instance.isMobile?"touchend":"mouseup",(function(o){if(d("#container").css("pointer-events","auto"),n){n=!1;var l=a.Browser.instance.isMobile?o.changedTouches[0].pageX:o.clientX,c=l-i;c>0&&l<100||c<0&&l<160||0===i&&0===l?(i=0,e.THUMB_STATUS=r.off,t.thumbnailDesktop.hideThumb(),t.eventObserver.resizeContents.notify()):(t.loadThumbImg(t.getThumbIndex()),i=l>520?520:l,c>0&&l>=100?i=385<i&&i<=520?520:231<i&&i<=385?355:200:c<0&&l<520&&(i=320<=l&&l<480?355:160<=l&&l<320?200:520),t.jqContents.css("left",i),d(".wrap__thumbnail").css({width:i,"overflow-y":"scroll"}),t.jqThumbnailBar.css("left",i),e.THUMB_STATUS=r.on,t.focusPage({pageNum:t.docInfo.currentPage}),t.jqThumbnailButton.addClass("thumbnail-btn__img--on"),document.getElementById("thumbnailview-btn").title=s.LocaleMessage.getMessage("icon_thumbnail_close"),document.getElementById("thumbnail-btn").title=s.LocaleMessage.getMessage("icon_thumbnail_close")),t.eventObserver.resizeWindow.notify()}}))},this.loadThumbImg=function(e){return i(t,void 0,void 0,(function(){var t,n,i,r,a,s,c,d,u;return o(this,(function(o){for(3,t=this.jqThumbnail.height(),n=this.docInfo.status.pageNum,0==(i=document.getElementById("thumb-content"+e).clientHeight)&&(i=this._getThumbHeight(this.THUMB_SIZE[e])),r=Math.ceil(t/i),document.getElementById("thumbnail").clientWidth>200&&(r+=20),a=e-3<0?0:e-3,s=e+r+1,c=l.DetectZoom?l.DetectZoom.getRatio():100,s!==n&&c<100&&(s+=Math.ceil(n*(c/100))),s=s>n||s===n-1?n:s,d=a;d<s;d++)(u=document.getElementById("thumb"+d)).src!==this.transparentImg&&""!==u.src||(this.onLoadImg(u,d),this.loadThumbDelay(d));return[2]}))}))},this.thumbMovePage=function(e){var n=parseInt(e.currentTarget.getAttribute("data-index"));if(t.docInfo.currentPage!==n){var i=t.docInfo.status.pageNum;isNaN(n)||n<0||n>i||t.eventObserver.page.notify({pageNum:n,isScroll:!1})}},this.toggleEvent=function(){if(!f.default.isAnnotMode&&(t.thumbnailActions.toggleAction(),e.THUMB_STATUS===r.on)){var n=t.docInfo.currentPage;t.focusPage({pageNum:n}),t.setThumbnailAreaHeightForIOS()}},this.focusPage=function(n){if(e.THUMB_STATUS!=r.off){d("#thumb-area"+n.pageNum).removeClass("thumb--nohover"),d(".thumb__div").removeClass("thumb__focus");var i=document.getElementById("thumbnail").clientHeight-d(".wrap__header").height(),o=document.getElementById("thumb-content"+n.pageNum).clientHeight,a=document.getElementById("thumbnail").scrollTop,s=d("#thumb-area"+n.pageNum).parent().position().top-d("#thumb-area0").parent().position().top;(a>s||s+o>=a+i)&&(document.getElementById("thumbnail").scrollTop=document.getElementById("thumb-content"+n.pageNum).offsetTop-i/4),d("#thumb-area"+n.pageNum).addClass("thumb__focus"),t.loadThumbImg(t.docInfo.currentPage)}},this.resizeWindow=function(){c.Util.isFullScreen()||(c.Util.isMobileMode()&&t.thumbnailActions===t.thumbnailDesktop?(t.thumbnailActions.initThumb(),t.thumbnailActions=t.thumbnailMobile,t.thumbnailActions.changeMode(t.docInfo.currentPage),t.isWindowCSS||t.thumbSizeResize(0,t.docInfo.status.pageNum,t.docInfo.currentPage)):c.Util.isMobileMode()||t.thumbnailActions!==t.thumbnailMobile||(t.thumbnailActions.initThumb(),t.thumbnailActions=t.thumbnailDesktop,t.thumbnailActions.changeMode(t.docInfo.currentPage),t.isWindowCSS||t.thumbSizeResize(0,t.docInfo.status.pageNum,t.docInfo.currentPage)))},this.fullScreen=function(e){"cell"!==e.skinType&&(e.isFullScreen?(t.jqThumbnail.addClass("wrap__thumbnail--presentation"),t.jqThumbnailBar.addClass("wrap__thumbnailbar--presentation")):(t.jqThumbnail.removeClass("wrap__thumbnail--presentation"),t.jqThumbnailBar.removeClass("wrap__thumbnailbar--presentation")))},this.annotMode=function(e){e?(t.jqThumbnail.addClass("wrap__thumbnail--marker-mode"),t.jqThumbnailBar.addClass("wrap__thumbnailbar--marker-mode")):(t.jqThumbnail.removeClass("wrap__thumbnail--marker-mode"),t.jqThumbnailBar.removeClass("wrap__thumbnailbar--marker-mode"))},this.getThumbIndex=function(){var e=document.getElementById("wrap__index").clientHeight,n=document.getElementById("thumbnail").scrollTop;return n<0&&(!l.DetectZoom||100===l.DetectZoom.getRatio())?t.docInfo.currentPage:Math.floor(t.docInfo.status.pageNum/(e/n))},this.scrollEventBind=function(){var n;d("#thumbnail").on("scroll",(function(){clearTimeout(n),n=window.setTimeout((function(){if(e.THUMB_STATUS!=r.off){var n=t.getThumbIndex();t.loadThumbImg(n)}}),50)}))},this.thumbSizeResize=function(e,n,i){var o=t.docInfo.currentPage+t.initThumbNum;if(o=o>t.docInfo.status.pageNum?t.docInfo.status.pageNum:o,null!==i)for(var r=i=i-5<0?0:i-5;r<o;r++)t._thumbSizeRepeat(t.THUMB_SIZE[r],r);setTimeout((function(){for(var r=e;r<n;r++)null!=i?(r<i||r>=o)&&t._thumbSizeRepeat(t.THUMB_SIZE[r],r):t._thumbSizeRepeat(t.THUMB_SIZE[r],r)}),100)},this._thumbSizeRepeat=function(e,n){var i=t._getThumbHeight(e);document.getElementById("thumb"+n).style.height=i+"px"},this._getThumbHeight=function(e){return e&&void 0!==e.mobileHeight?!0===c.Util.isMobileMode()?e.mobileHeight:e.desktopHeight:!0===c.Util.isMobileMode()?t.THUMB_SIZE[0].mobileHeight:t.THUMB_SIZE[0].desktopHeight},this.setThumbnailAreaHeightForIOS=function(){if(a.Browser.instance.isIOS&&0!==d("#wrap__index").height()&&d("#thumbnail").height()>d("#wrap__index").height()){a.Browser.instance.isiPad?d("#wrap__index").css("height",0===window.orientation?768*screen.height/screen.width-85:768*screen.width/screen.height-85):d("#wrap__index").css("height",0===window.orientation?screen.height-85:screen.width)}},this.jqThumbnail=d("#thumbnail"),this.jqThumbnailButton=d("#thumbnail-btn"),this.jqThumbnailBar=d("#thumbnailbar"),this.jqContents=d("#contents")}return e.THUMB_STATUS=r.off,e.isOn=function(){return e.THUMB_STATUS===r.on},e}();t.Thumbnail=p}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageSheet=void 0;var s=n(37),l=n(1),c=n(0),d=n(80),u=n(38),h=n(3),f=n(53),p=n(163),m=n(51),g=n(285),v=n(81),b=function(t){function n(){var i=null!==t&&t.apply(this,arguments)||this;return i.dpiSheet=null,i.sheetWidth=null,i.sheetHeight=null,i.maxBrowserTop=-1,i.transparentImg="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i.scrollContentAreaEl=l.Browser.instance.isIOS?h(document):h("#contents"),i.scrollSheetEventBind=function(){var e;i.scrollContentAreaEl.on("scroll",(function(t){clearTimeout(e),e=setTimeout(i.scrollEvent,100),i.eventObserver.scroll.notify(t.originalEvent)}))},i.getTitle=function(t,n,o){return r(i,void 0,e,(function(){var e,i;return a(this,(function(r){switch(r.label){case 0:"",e=t+"/title/"+n+"/"+o,this.docInfo.status.imageConverting&&(e=t+"/title/"+o+".js"),i=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.Util.ajaxCall(e,"GET")];case 2:return i=r.sent(),[3,4];case 3:return r.sent(),c.Util.printConsoleLog("fail to call api - /title"),[3,4];case 4:return[2,i.replace(/^\s+|\s+$/g,"")]}}))}))},i.getDimension=function(t,o,s){return r(i,void 0,e,(function(){var e,i,r,l,d,u,h;return a(this,(function(a){switch(a.label){case 0:o=void 0!==o?o:0,e=t.contextPath+"/dimension/"+t.status.id+"/"+o+"?dpi="+s,this.docInfo.status.imageConverting&&(e=t.contextPath+"/dimension/"+o+".js?dpi="+s),r=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,c.Util.getJson(e)];case 2:if(r=a.sent(),l=r[0].w,d=r[0].h,0===l&&0===d)throw Error;return window.localSynap.config.sheetMinSize&&window.localSynap.config.sheetMinSize.length>1&&(u=window.localSynap.config.sheetMinSize[0],h=window.localSynap.config.sheetMinSize[1],u>l&&(l=u>1e5?1e5:u),h>d&&(d=h>1e5?1e5:h)),i={sheetWidth:l,sheetHeight:d},[3,4];case 3:return a.sent(),n.sheetLoadFail=!0,this.showSheetAlertDialog(),[2,i];case 4:return n.sheetLoadFail=!1,[2,i]}}))}))},i.showSheetAlertDialog=function(){c.Util.printConsoleLog("fail to call api - /dimension");var e=m.default.instance.getSheetPageOpenFailedDialogEl(),t=document.createElement("div");t.id="sheet-dialog",t.className="sheet-dialog",t.appendChild(e),document.getElementById("contents").appendChild(t)},i.removeSheetAlertDialog=function(){var e=document.getElementById("sheet-dialog"),t=document.getElementById("contents");e&&t.removeChild(e)},i.scrollEvent=function(){i.addContentDiv(),i.resizeCell(n.resizePercent)},i.createContentDiv=function(e){i.sheetWidth=e.sheetWidth,i.sheetHeight=e.sheetHeight,n.maxCol=Math.ceil(i.sheetWidth/n.defaultCellWidth),n.maxRow=Math.ceil(i.sheetHeight/n.defaultCellHeight);var t=n.defaultCellHeight*(n.resizePercent/100),o=n.defaultCellHeight*(n.resizePercent/100),r='<div id="sheet" name="sheet">\n\t\t\t\t\t\t<div id="cell-common" name="cell-common" class="cell-common" style="width:'+i.sheetWidth+"px;height:"+i.sheetHeight+'px;"></div>\n\t\t\t\t\t</div>';document.getElementById("contents-area").innerHTML=r;var a=(n.maxRow-1)*t;if(i.maxBrowserTop<a&&-1!==i.maxBrowserTop){var s=i.maxBrowserTop/n.defaultCellHeight,l=n.maxCol-1,c=i.sheetCreateElement(s,l,i.maxBrowserTop,l*o,n.lastRowHeight,n.lastColWidth);h("#cell-common").append(c)}i.addContentDiv()},i.changeDPIContentDiv=function(e){return r(i,void 0,void 0,(function(){var t,i,o,r,s,l,d,u,h,f,p,m,g;return a(this,(function(a){switch(a.label){case 0:return c.Util.isServer(this.docInfo)?this.dpiSheet.hasHighDPIRatio()?[3,2]:[4,this.getDimension(this.docInfo,this.docInfo.currentSheet,this.dpiSheet.HIGH_DPI)]:[2];case 1:if(t=a.sent(),n.sheetLoadFail)return[2];this.dpiSheet.setHighDPIRatio(this.sheetWidth,t.sheetWidth),a.label=2;case 2:if(!this.dpiSheet.changeDPI(e))return[2];for(i=this.getLoadingRange(e),o=i.startRow,r=i.endRow,s=i.startCol,l=i.endCol,d=o;d<r;++d)for(u=s;u<l;++u)h=document.getElementById("piece"+d+"_"+u),f=n.getSheetSize(d,u),p=f.sheetWidth,m=f.sheetHeight,g={idx:this.docInfo.currentSheet,rowIdx:d,colIdx:u,width:p,height:m},h.src=this.dpiSheet.getNewPath(g);return[2]}}))}))},i.getLoadingRange=function(e){void 0===e&&(e=0);var t=document.getElementById("contents").offsetWidth,o=document.getElementById("contents").offsetHeight,r=n.defaultCellHeight*(n.resizePercent/100),a=n.defaultCellHeight*(n.resizePercent/100),s=2;e>0&&e<100&&(s=2*Math.ceil(100/e));var l=Math.ceil(i.scrollContentAreaEl.scrollTop()/r),c=(l=l>2?l-2:0)+Math.ceil(o/a);c=c+s>n.maxRow?n.maxRow:c+s;var d=Math.ceil(i.scrollContentAreaEl.scrollLeft()/r),u=(d=d>2?d-2:0)+Math.ceil(t/r);return{startRow:l,endRow:c,startCol:d,endCol:u=u+s>n.maxCol?n.maxCol:u+s}},i.addContentDiv=function(e){void 0===e&&(e=0);var t=i.getLoadingRange(e),o=t.startRow,r=t.endRow,a=t.startCol,s=t.endCol,l=n.defaultCellWidth*(n.resizePercent/100),d=n.defaultCellHeight*(n.resizePercent/100),u=h("#cell-common");n.lastColWidth=i.sheetWidth%n.defaultCellWidth==0?n.defaultCellWidth:i.sheetWidth%n.defaultCellWidth,n.lastRowHeight=i.sheetHeight%n.defaultCellHeight==0?n.defaultCellHeight:i.sheetHeight%n.defaultCellHeight;for(var f=document.createDocumentFragment(),p=o;p<r;++p)for(var m=a;m<s;++m){var g=n.getSheetSize(p,m),v=g.sheetWidth,b=g.sheetHeight,y=h("#cellpage"+p+"_"+m,u);if(0===y.length){var E=p*l,I=m*d,S=i.sheetCreateElement(p,m,E,I,v,b);f.appendChild(S)}else if(c.Util.isServer(i.docInfo)){var w=y.children()[0];if(i.dpiSheet.isEqualDPI(w.src))continue;var _={idx:i.docInfo.currentSheet,rowIdx:p,colIdx:m,width:v,height:b};w.src=i.dpiSheet.getNewPath(_)}}try{document.getElementById("cell-common").appendChild(f)}catch(e){console.log("There is not yet cell-common")}},i.sheetCreateElement=function(e,t,n,o,r,a){var s=document.createElement("div");s.id="cellpage"+e+"_"+t,s.className="cell__div",s.style.cssText="top:"+n+"px;left:"+o+"px;";var l=document.createElement("img");l.id="piece"+e+"_"+t,c.Util.isFullScreen()?l.className="cell__piece img-loading-black":l.className=f.Head.bgColorMode===f.BGCOLOR_MODE.darkScreen?"cell__piece img-loading":"cell__piece img-loading-bright",l.style.cssText="width:"+r+"px;height:"+a+"px",l.src=i.transparentImg;var d=document.getElementById("sheet"+i.docInfo.currentSheet).textContent;l.alt=d+" sheet image";var u={idx:i.docInfo.currentSheet,rowIdx:e,colIdx:t,width:r,height:a},h=i.dpiSheet.getParam(u),p="";return c.Util.isServer(i.docInfo)?p=c.Util.getThumbPath(i.docInfo,u.idx,i.dpiSheet.getDPI(),h):(p=i.docInfo.contextPath+"/thumbnail/"+c.Util.get4DigitFormatString(i.docInfo.currentSheet+1)+"_d"+i.dpiSheet.getDPI()+"_x"+h.x+"_y"+h.y+"_w"+r+"_h"+a,p+=window.localSynap.config.thumbnailExt?"."+window.localSynap.config.thumbnailExt:".png"),i.eventObserver.sheetChangeTile.notify(h),l.onerror=function(){l.setAttribute("src",i.transparentImg),l.className+=" img-retry",l.onclick=function(){c.Util.isFullScreen()?l.className="cell__piece img-loading-black":l.className=f.Head.bgColorMode===f.BGCOLOR_MODE.darkScreen?"cell__piece img-loading":"cell__piece img-loading-bright",l.src=p}},l.src=p,s.appendChild(l),s},i._zoomCalculation=function(e,t){for(var i=n.resizePercent,o=document.getElementById("cell-common").getElementsByTagName("div")[0].id,r=0,a=e;r<a.length;r++){var s=a[r],l=n.cellPageRE.exec(o).slice(1,3).map((function(e){return parseInt(e,10)})),c=l[0],d=l[1],u=s/100*(d===n.maxCol-1?n.lastColWidth:n.defaultCellWidth),h=document.getElementById("piece"+c+"_"+d).clientWidth;if(t(u,h)&&!(Math.abs(u-h)<1)){i=s;break}}return i},i.zoomCell=function(e){var t=null;e===d.ZOOM_TYPE.ZoomOut?(t=i._zoomCalculation(d.Controlbar.ZOOM_LIST.slice().reverse(),(function(e,t){return e<t})),i.addContentDiv(t)):e===d.ZOOM_TYPE.ZoomIn&&(t=i._zoomCalculation(d.Controlbar.ZOOM_LIST,(function(e,t){return e>t}))),t!==n.resizePercent&&(i.changeDPIContentDiv(t),i.resizeCell(t),i.eventObserver.resizePage.notify())},i.resizeCell=function(e){n.resizePercent=e;var t=e/100,o=n.defaultCellWidth*t,r=n.defaultCellHeight*t,a=n.lastColWidth*t,s=n.lastRowHeight*t,d=i.sheetWidth*t,u=i.sheetHeight*t,f=c.Util.isTabletInCSS()?20:0,p=l.Browser.instance.isIOS?Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop):document.getElementById("contents").scrollTop,m=l.Browser.instance.isIOS?Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft):document.getElementById("contents").scrollLeft,g=h("#piece0_0").height();h("#cell-common").css({width:d,height:u,"margin-bottom":f});for(var v=document.getElementById("cell-common").children,b=0;b<v.length;b++){var y=v[b].id,E=n.cellPageRE.exec(y).slice(1,3).map((function(e){return parseInt(e,10)})),I=E[0],S=E[1],w=r*I;i.maxBrowserTop<w&&-1!==i.maxBrowserTop?h("#"+y).css({top:i.maxBrowserTop,left:o*S}):h("#"+y).css({top:w,left:o*S}),S===n.maxCol-1?h("#piece"+I+"_"+S).css("width",a):h("#piece"+I+"_"+S).css("width",o),I===n.maxRow-1?h("#piece"+I+"_"+S).css("height",s):h("#piece"+I+"_"+S).css("height",r)}var _=h("#piece0_0").height();if(g!==_){var T=_/g;i.scrollContentAreaEl.scrollTop(p*T),i.scrollContentAreaEl.scrollLeft(m*T),i.checkResizeControlBar()}},i.moveScrollforMarker=function(e){var t=e.scrollLeft,n=e.scrollTop,i=document.getElementById("contents"),o=i.scrollLeft,r=i.scrollTop,a=i.offsetHeight,s=i.offsetWidth;(t<o-s/2||t>o+s/2||n<r-a/2||n>r+a/2)&&(document.getElementById("contents").scrollLeft=t,document.getElementById("contents").scrollTop=n)},i.loadSheet=function(t){return r(i,void 0,e,(function(){var e;return a(this,(function(i){switch(i.label){case 0:return this.docInfo.currentSheet=t,n.resizePercent=100,this.dpiSheet.initDPI(),h("#contents-area").empty(),this.removeSheetAlertDialog(),[4,this.getDimension(this.docInfo,t,this.dpiSheet.ORIGINAL_DPI)];case 1:return e=i.sent(),n.sheetLoadFail?[2]:(this.createContentDiv(e),l.Browser.instance.isMobile&&(n.resizePercent=50,this.resizeCell(n.resizePercent)),this.checkMoveControlbar(),this.checkResizeControlBar(),document.getElementById("contents-area").focus(),[2])}}))}))},i.checkResizeControlBar=function(){n.resizePercent===d.Controlbar.ZOOM_LIST[0]?(h("#cell-zoomout").removeClass("controlbar--enable"),h("#cell-zoomout").removeClass("controlbar-zoomout--hover"),h("#cell-zoomout").prop("disabled",!0),h("#mobile-controlbar-zoomout__btn").addClass("mobile-controlbar-floating__btn--disabled"),h("#mobile-controlbar-zoomout__btn").prop("disabled",!0)):(h("#cell-zoomout").addClass("controlbar--enable"),h("#cell-zoomout").prop("disabled",!1),h("#mobile-controlbar-zoomout__btn").removeClass("mobile-controlbar-floating__btn--disabled"),h("#mobile-controlbar-zoomout__btn").prop("disabled",!1)),n.resizePercent===d.Controlbar.ZOOM_LIST[d.Controlbar.ZOOM_LIST.length-1]?(h("#cell-zoomin").removeClass("controlbar--enable"),h("#cell-zoomin").removeClass("controlbar-zoomin--hover"),h("#cell-zoomin").prop("disabled",!0),h("#mobile-controlbar-zoomin__btn").addClass("mobile-controlbar-floating__btn--disabled"),h("#mobile-controlbar-zoomin__btn").prop("disabled",!0)):(h("#cell-zoomin").addClass("controlbar--enable"),h("#cell-zoomin").prop("disabled",!1),h("#mobile-controlbar-zoomin__btn").removeClass("mobile-controlbar-floating__btn--disabled"),h("#mobile-controlbar-zoomin__btn").prop("disabled",!1))},i.bindControlbarEvent=function(){c.Util.bindClickOrTouchEvent(h("#cell-first"),"controlbar-first--hover",(function(){i.eventObserver.sheet.notify({sheetIdx:0})})),c.Util.bindClickOrTouchEvent(h("#cell-end"),"controlbar-end--hover",(function(){i.eventObserver.sheet.notify({sheetIdx:i.docInfo.status.pageNum-1})})),c.Util.bindClickOrTouchEvent(h("#cell-prev"),"controlbar-prev--hover",(function(){i.eventObserver.sheet.notify({sheetIdx:i.docInfo.currentSheet-1})})),c.Util.bindClickOrTouchEvent(h("#cell-next"),"controlbar-next--hover",(function(){i.eventObserver.sheet.notify({sheetIdx:i.docInfo.currentSheet+1})})),c.Util.bindClickOrTouchEvent(h("#cell-zoomout"),"controlbar-zoomout--hover",(function(){i.zoomCell(d.ZOOM_TYPE.ZoomOut)})),c.Util.bindClickOrTouchEvent(h("#cell-zoomin"),"controlbar-zoomin--hover",(function(){i.zoomCell(d.ZOOM_TYPE.ZoomIn)})),c.Util.bindClickOrTouchEvent(h("#cell-hand-scroll"),"controlbar-hand-scroll--hover",v.MouseScroll.instance.bindDesktopControlbar({elem:document.getElementById("cell-hand-scroll"),selector:"controlbar-hand-scroll--hover"}),v.MouseScroll.instance.mouseOut)},i.resizeWindow=function(){h("#contents").removeAttr("style"),c.Util.isMobileMode()&&(h("#tablist-popup").hide(),c.Util.isFullScreen()||i.eventObserver.mobileHeader.notify(u.ShowActionType.HIDE3SEC)),c.Util.isFullScreen()||c.Util.isFullScreen()||(i.sheetTabResize(),s.DetectZoom.getRatio()<100&&i.addContentDiv())},i.singleTap=function(){i.toggleMobileHeader()},i.mouseEventBind=function(){h("#contents").on("click",(function(){l.Browser.instance.isMobile||i.toggleMobileHeader()}))},i.eventObserverBind=function(e){i.eventObserver=e,i.eventObserver.sheet.subscribe(i.moveSheet),i.eventObserver.resizeWindow.subscribe(i.resizeWindow),i.eventObserver.fullScreen.subscribe(i.fullScreen),i.eventObserver.singleTap.subscribe(i.singleTap),i.eventObserver.afterUndoRedoSheet.subscribe(i.moveScrollforMarker),i.eventObserver.zoom.subscribe(i.zoomCell)},i.eventBind=function(){i.scrollSheetEventBind(),i.mouseEventBind()},i.setMaxBrowserTop=function(){var e=l.Browser.instance;e.isMobile||(e.isIE||e.isEdge?i.maxBrowserTop=1535e3:e.isFirefox&&(i.maxBrowserTop=17895e3))},i.setTabIndex=function(){var e=c.Util.setTabIndexList(),t=document.getElementById("tabmore").tabIndex,n=document.getElementById("header-tablist__input").tabIndex;c.Util.setTabIndex(document.getElementById("contents"),e++);for(var o=0;o<i.maxPage;o++)c.Util.setTabIndex(document.getElementById("tablist"+o),t+1),c.Util.setTabIndex(document.getElementById("mobileTablist"+o),n),c.Util.setTabIndex(document.getElementById("sheet"+o),e)},i.load=function(t,n){return r(i,void 0,e,(function(){return a(this,(function(e){switch(e.label){case 0:return this.docInfo=t,this.maxPage=this.docInfo.status.pageNum,h("#wrap").addClass("wrap--cell"),l.Browser.instance.isIOS&&(h("#wrap").addClass("wrap--ios"),h("#container").addClass("wrap__container--ios"),h("#contents").addClass("wrap__contents--ios"),h("#annotation-list").addClass("wrap__annotation-list--ios"),h("#footer").addClass("wrap__footer--ios")),h("#header-title-text").addClass("wrap__title--cell"),h("#contents-area").addClass("wrap__contents-area"),this.setMaxBrowserTop(),this.bindControlbarEvent(),this.dpiSheet=new g.DPISheet(t),this.eventObserverBind(n),[4,this.loadSheetTab(this.docInfo.currentSheet)];case 1:return e.sent(),[4,this.loadSheet(this.docInfo.currentSheet)];case 2:return e.sent(),this.setTabIndex(),this.eventBind(),this.dpiSheet.load(n),document.getElementById("contents-area").focus(),[2]}}))}))},i}return o(n,t),n.getEndRowCol=function(){var e=document.getElementById("cell-common").getElementsByTagName("div").length,t=document.getElementById("cell-common").getElementsByTagName("div")[e-1].id,i=n.cellPageRE.exec(t).slice(1,3).map((function(e){return parseInt(e,10)}));return{endRow:i[0],endCol:i[1]}},n.defaultCellWidth=1e3,n.defaultCellHeight=1e3,n.lastColWidth=0,n.lastRowHeight=0,n.maxRow=0,n.maxCol=0,n.sheetLoadFail=!1,n.resizePercent=100,n.cellPageRE=/cellpage(\d+)_(\d+)/,n.getSheetSize=function(e,t){var i=n.defaultCellWidth,o=n.defaultCellHeight;return e===n.maxRow-1&&(o=n.lastRowHeight),t===n.maxCol-1&&(i=n.lastColWidth),{sheetWidth:i,sheetHeight:o}},n}(p.Sheet);t.ImageSheet=b}).call(this,n(4))},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DetectZoom=void 0;var i=n(0),o=n(1),r=function(){function e(){}return e.getRatio=function(){return this._zoom||(this._zoom=this.detectFunction()),Math.round(100*this._zoom())},e.detectFunction=function(){return window.devicePixelRatio?function(){if(o.Browser.instance.isIE||o.Browser.instance.isFirefox||o.Browser.instance.isEdge)return window.devicePixelRatio;try{var e=Math.abs(window.top.outerWidth-window.top.innerWidth),t=window.top.innerWidth,n=e>=1&&e<=20||!window.top.outerWidth?t:window.top.outerWidth;return Math.round((i.Util.isFullScreen()?screen.width:n)/t*100)/100}catch(e){return 1}}:isNaN(screen.logicalXDPI)||isNaN(screen.systemXDPI)?window.navigator.msMaxTouchPoints?function(){return Math.round(document.documentElement.offsetHeight/window.innerHeight*100)/100}:window.chrome&&!(window.opera||navigator.userAgent.indexOf(" Opera")>=0)?function(){try{return Math.round(window.top.outerWidth/window.top.innerWidth*100)/100}catch(e){return 1}}:Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0?function(){try{return Math.round(window.top.outerWidth/window.top.innerWidth*100)/100}catch(e){return 1}}:"orientation"in window&&"webkitRequestAnimationFrame"in window?function(){var e="string"==typeof window.orientation?Number.parseInt(window.orientation):window.orientation;return(90===Math.abs(e)?screen.height:screen.width)/window.innerWidth}:"webkitRequestAnimationFrame"in window?function(){var e=function(e){return e.replace(/;/g," !important;")},t=document.createElement("div");t.innerHTML="1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>0",t.setAttribute("style",e("font: 100px/1em sans-serif; -webkit-text-size-adjust: none; text-size-adjust: none; height: auto; width: 1em; padding: 0; overflow: visible;"));var n=document.createElement("div");n.setAttribute("style",e("width:0; height:0; overflow:hidden; visibility:hidden; position: absolute;")),n.appendChild(t),document.body.appendChild(n);var i=1e3/t.clientHeight;return i=Math.round(100*i)/100,document.body.removeChild(n),i}:navigator.userAgent.indexOf("Opera")>=0?function(){try{return Math.round(window.top.outerWidth/window.top.innerWidth*100)/100}catch(e){return 1}}:function(){return 1}:function(){return Math.round(screen.deviceXDPI/screen.logicalXDPI*100)/100}},e}();t.DetectZoom=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowActionType=void 0,function(e){e.SHOW="show",e.HIDE="hide",e.HIDE3SEC="hide3sec"}(t.ShowActionType||(t.ShowActionType={}))},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoIcon=void 0;var i=n(16),o=n(23),r=n(0),a=n(6),s=n(55),l=n(62),c=function(){function e(t,n,o,c,d,u){var h=this;this.eventObserver=null,this.memoIconEl=null,this.memoContent=null,this.annotId=0,this.pageOrSheetIdx=0,this.isCell=!1,this.click=function(){a.default.isScrollMode||(h.eventObserver.unSelectAnnotation.notify(),l.MemoContent.isShow()?a.default.isAnnotMode&&"memo"!==i.getAnnotType(e.getMemoInfo(h.memoIconEl.id))&&h.eventObserver.selectAnnotation.notify({page:h.pageOrSheetIdx,annotId:h.annotId,showMemo:!1,showPopup:!1}):h.eventObserver.selectAnnotation.notify({page:h.pageOrSheetIdx,annotId:h.annotId,showMemo:!0,showPopup:!1}))},this.drag=function(){var t=!1,n=0,o=0,l=s.getAnnotArea(!0,h.pageOrSheetIdx,h.isCell),c=l.left,d=l.right,u=l.top,f=l.bottom,p=i.default.getAnnotRatio,m=null,g=function(e){return{clientX:e instanceof MouseEvent?e.clientX:e.touches[0].clientX,clientY:e instanceof MouseEvent?e.clientY:e.touches[0].clientY}},v=function(e){var i=g(e),r=i.clientX,a=i.clientY,s=n-r,l=o-a;n=r,o=a,m.setPos(s/p(h.pageOrSheetIdx,h.isCell),l/p(h.pageOrSheetIdx,h.isCell)),m.isMove()&&(s&&(h.memoIconEl.style.left=m.getLeft()+"px"),l&&(h.memoIconEl.style.top=m.getTop()+"px"),t=!0,h.memoContent.hide(!0))},b=function(){document.removeEventListener("touchmove",r.Util.disableEvent,r.Util.nonPassiveEventListenerOption),document.removeEventListener(r.Util.getMoveEventName(),v),document.removeEventListener(r.Util.getClickEndEventName(),b),m.isMove()&&e.updateMemoInfo(h.memoIconEl,m.getMoveX(),m.getMoveY())};h.memoIconEl.addEventListener(r.Util.getClickStartEventName(),(function(i){a.default.isScrollMode||(t=!1,a.default.isAnnotMode&&function(t){var i=g(t),a=i.clientX,l=i.clientY;n=a,o=l;var y=e.getMemoInfo(h.memoIconEl.id);m=s.annotPos(parseFloat(y.w),parseFloat(y.h),parseFloat(y.l),parseFloat(y.t),c(),d()/p(h.pageOrSheetIdx,h.isCell),u(),f()/p(h.pageOrSheetIdx,h.isCell)),document.addEventListener("touchmove",r.Util.disableEvent,r.Util.nonPassiveEventListenerOption),document.addEventListener(r.Util.getMoveEventName(),v),document.addEventListener(r.Util.getClickEndEventName(),b)}(i))})),h.memoIconEl.addEventListener(r.Util.getClickOrTouchEventName(),(function(){a.default.isScrollMode||!t&&h.click()}))},this.createMemoIcon=function(t){h.memoIconEl=document.createElement("div"),h.memoIconEl.id=e.getMemoId(h.pageOrSheetIdx,h.annotId),h.memoIconEl.className="memo-icon";var n=e.getPosition(t,h.pageOrSheetIdx,h.isCell),i=n.top,o=n.left;h.memoIconEl.style.cssText="left: "+o+"px; top: "+i+"px",document.getElementById("annotationlayer"+h.pageOrSheetIdx).getElementsByClassName("marker-scale")[0].appendChild(h.memoIconEl)},this.delete=function(){r.Util.deleteObj(h)},this.eventObserver=t,this.annotId=d,this.pageOrSheetIdx=c,this.isCell=u,this.memoContent=o,this.createMemoIcon(n),"memo"===i.getAnnotType(n)?this.drag():this.memoIconEl.addEventListener("click",this.click)}return e.rePositionDependentMemo=function(t,n,i,r){var s=a.default.parseMarkerId(t),l=s.pageOrSheetIdx,c=s.annotId,d=document.getElementById(e.getMemoId(l,c));if(d){var u=n-e.height>=0?n-e.height:n+r+2*o.DrawingTool.VIEWBOX_RANGE;d.style.top=u+"px",d.style.left=i+"px"}},e.getMemoInfo=null,e.updateMemoInfo=null,e.width=20,e.height=20,e.setMemoCommonFunc=function(t,n){e.getMemoInfo=t,e.updateMemoInfo=n},e.getMemoId=function(e,t){return"memo-"+e+"-"+t},e.getPosition=function(t,n,r){var a=parseFloat(t.t),l=parseFloat(t.l);"memo"!==i.getAnnotType(t)&&(a-=o.DrawingTool.VIEWBOX_RANGE,l-=o.DrawingTool.VIEWBOX_RANGE,a-e.height<0?a+=parseFloat(t.h)+2*o.DrawingTool.VIEWBOX_RANGE:a-=e.height);var c=s.getAnnotArea(!0,n,r),d=c.left,u=c.right,h=c.top,f=c.bottom,p=i.default.getAnnotRatio(n,r),m=s.annotPos(parseFloat(t.w),parseFloat(t.h),l,a,d(),u()/p,h(),f()/p);return{top:m.getTop(),left:m.getLeft()}},e}();t.MemoIcon=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorType=void 0;var i,o=n(3),r=n(0),a=n(1),s=n(16),l=n(17),c=n(6),d=n(55),u=n(19),h=n(78);!function(e){e[e.Text=0]="Text",e[e.Border=1]="Border",e[e.Fill=2]="Fill"}(i=t.ColorType||(t.ColorType={}));var f=function(){function e(t,n,f){var p=this;this.docInfo=null,this.selectedAttr={color:"type2",innerColor:"type24",thickness:4,transparency:.5,textAlign:"left",fontSize:"12",fontColor:"type24"},this.orgAttr=void 0,this.hasFill=!1,this.colorTypeSelected=i.Border,this.activeMarkerId=void 0,this.colorSelectedClassSelector="prop-submenu-color--selected",this.propSubmenu=document.getElementById("prop-submenu"),this.propTabDivElm=document.getElementById("prop-submenu__tab"),this.propBorderTabBtn=document.getElementById("border-style-btn"),this.propFillTabBtn=document.getElementById("fill-style-btn"),this.propTextTabBtn=document.getElementById("text-style-btn"),this.textStyleTab=document.getElementById("text-style"),this.borderStyleTab=document.getElementById("border-style"),this.fillStyleTab=document.getElementById("fill-style"),this.colorLine=document.getElementById("color-line"),this.textTabHeight=282,this.borderTabHeight=237,this.fillTabHeight=177,this.heightGapOfTextBorder=30,this.heightGapOfFill=20,this.popupWidth=269,this.textAlignBtnList=["left-align-btn","right-align-btn","center-align-btn"],this.styleTabList=["thickness__input","transparency__input","text-style-btn","border-style-btn","fill-style-btn","left-align-btn","right-align-btn","center-align-btn","font-size__input","color-type1-btn","color-type2-btn","color-type3-btn","color-type4-btn","color-type5-btn","color-type6-btn","color-type7-btn","color-type8-btn","color-type9-btn","color-type10-btn","color-type11-btn","color-type12-btn","color-type13-btn","color-type14-btn","color-type15-btn","color-type16-btn","color-type17-btn","color-type18-btn","color-type19-btn","color-type20-btn","color-type21-btn","color-type22-btn","color-type23-btn","color-type24-btn"],this.isFreetextMarker=function(){var e=void 0===p.activeMarkerId&&r.Util.hasClass(document.getElementById("marker-freetext-block"),"more-prop");return p.activeMarkerId&&r.Util.hasClass(document.getElementById(p.activeMarkerId),"freetext")||e},this.hideAnnotList=function(e){c.default.isAnnotMode&&r.Util.isSmallScreen()&&p.eventObserver.hideAnnotListInMobile.notify(e)},this.handlePropTab=function(){p.isFreetextMarker()?(r.Util.removeClass(p.propTextTabBtn,"hide"),r.Util.removeClass(p.propBorderTabBtn,"hide"),r.Util.removeClass(p.propFillTabBtn,"hide"),p.showTextStyleTab()):p.hasFill?(r.Util.addClass(p.propTextTabBtn,"hide"),r.Util.removeClass(p.propBorderTabBtn,"hide"),r.Util.removeClass(p.propFillTabBtn,"hide"),p.showBorderStyleTab()):(r.Util.addClass(p.propTextTabBtn,"hide"),r.Util.addClass(p.propFillTabBtn,"hide"),p.showBorderStyleTab())},this.styleMenuOnCss=function(){r.Util.removeClass(p.propSubmenu,"hide"),p.handlePropTab(),p.hideAnnotList(!0)},this.styleMenuOffCss=function(){return!r.Util.hasClass(p.propSubmenu,"hide")&&(r.Util.addClass(p.propSubmenu,"hide"),p.hideAnnotList(!1),!0)},this.toggleStyleMenu=function(e,t,n){c.default.isMarkerLoading||p.styleMenuOffCss()||(p.setMarkerAttributes(e,t),p.showStyleMenu({activeMarkerId:void 0}),r.Util.setTabIndexList(p.styleTabList,n.tabIndex,!0))},this.setMarkerAttributes=function(e,t){p.orgAttr={};var n;for(var i in p.selectedAttr)""===(n=e[i])||null==n||null!==n&&"object"==typeof n&&!Object.keys(n).length||(p.orgAttr[i]=e[i],p.selectedAttr[i]!==e[i]&&(p.selectedAttr[i]=e[i]));p.hasFill=t},this.saveAnnotStyle=function(){var t=p.hasFill?p.selectedAttr:{color:p.selectedAttr.color,thickness:p.selectedAttr.thickness,transparency:p.selectedAttr.transparency,textAlign:p.selectedAttr.textAlign,fontSize:p.selectedAttr.fontSize,fontColor:p.selectedAttr.fontColor};if(p.activeMarkerId&&JSON.stringify(p.orgAttr)!==JSON.stringify(t)){var n={color:e.getTypeToHexColor(p.selectedAttr.color),thickness:s.default.thicknessPxToAnnotDPI(p.selectedAttr.thickness),transparency:p.selectedAttr.transparency,textAlign:p.selectedAttr.textAlign,fontSize:p.selectedAttr.fontSize,fontColor:e.getTypeToHexColor(p.selectedAttr.fontColor)};if(p.hasFill){var i=e.getTypeToHexColor(p.selectedAttr.innerColor);n.innerColor=i}var o=p.activeMarkerId;p.eventObserver.modifyMarkerAttr.notify({elemId:o,attr:n}),p.activeMarkerId=void 0}},this.styleMenuInactiveEventBind=function(){o(document).on(r.Util.getClickOrTouchEventName(),(function(e){if(!r.Util.hasClass(p.propSubmenu,"hide")){var t=e.target;if(t.id){var n=t.id;if("annotation-popup__prop"===n)return;if(0===n.indexOf("marker-pencil")||0===n.indexOf("marker-freetext")||document.getElementById("marker-menu__sub-shapes").contains(t))return}r.Util.hasClass(t,"annotation-popup__img--prop")||r.Util.hasClassForEventTargetEl(t,"prop-submenu",7)||p.eventObserver.closeProp.notify()}}))},this.setColorType=function(t){o("."+p.colorSelectedClassSelector).removeClass(p.colorSelectedClassSelector+"-dark").removeClass(p.colorSelectedClassSelector+"-bright").removeClass(""+p.colorSelectedClassSelector);var n=e.getColorTypeId(t.id),i=["type2","type3","type7","type8","type9","type10","type11","type12"].find((function(e){return e===n}))?p.colorSelectedClassSelector+"-bright":p.colorSelectedClassSelector+"-dark";r.Util.addClass(t,""+p.colorSelectedClassSelector),r.Util.addClass(t,i)},this.colorBtnEventBind=function(){p.bindColorClickOrTouchEvent(o(".prop-submenu-color__block"),".prop-submenu-color--hover",(function(t){var n=p.hasFill&&p.colorTypeSelected===i.Fill,r=p.colorTypeSelected===i.Text?"fontColor":n?"innerColor":"color",a=o("."+p.colorSelectedClassSelector)[0].id,s=e.getColorTypeId(a),l=t.target,c=e.getTypeToHexColor(e.getColorTypeId(l.id)),d=n||"none"!==c?l:document.getElementById(a),u=e.getColorTypeId(d.id);p.eventObserver.changeMarkerStyle.notify({oldValue:s,newValue:u,attrName:r,setSelectedStyle:function(){s!==u&&(p.setColorType(d),p.selectedAttr[r]=u)}}),t.preventDefault()}))},this.setInputRangeTrackFill=function(e){if(!a.Browser.instance.isIE){var t=(parseInt(e.value)-parseInt(e.min))/(parseInt(e.max)-parseInt(e.min))*100;o(e).css("background","linear-gradient(to right, #333 0%, #333 "+t+"%, #e1e1e1 "+t+"%, #e1e1e1 100%)")}},this.bindInputRangeClickOrTouchEvent=function(e){var t=document.getElementById(e+"__input"),n=function(){var t=p.selectedAttr[e],n=document.getElementById(e+"__input").value,i=function(e){return"thickness"===e?Math.round(parseInt(n)/(96/s.default.DEFAULT_DPI)*s.default.DPI_RATIO):"transparency"===e?((100-parseInt(n))/100).toFixed(2):n};p.eventObserver.changeMarkerStyle.notify({oldValue:t,newValue:i(e),attrName:""+e,setSelectedStyle:function(){document.getElementById(e+"_result").innerText=n,p.selectedAttr[e]=i(e)}})};a.Browser.instance.isIE?(r.Util.addClass(t,"prop-submenu-slider__input-ms"),t.addEventListener("change",(function(){n()}))):t.addEventListener("input",(function(e){p.setInputRangeTrackFill(e.target),n()})),r.Util.disableKeyEventForPageMove(t)},this.thicknessBtnEventBind=function(){p.bindInputRangeClickOrTouchEvent("thickness")},this.transparencyBtnEventBind=function(){p.bindInputRangeClickOrTouchEvent("transparency")},this.disabledTransparentColor=function(){var e=document.getElementById("color-type1-btn");p.colorTypeSelected===i.Fill?r.Util.removeClass(e,"color-type1-btn--disabled"):r.Util.addClass(e,"color-type1-btn--disabled")},this.setStyleMenuItem=function(){var t=p.hasFill&&p.colorTypeSelected==i.Fill?p.selectedAttr.innerColor:p.selectedAttr.color;p.disabledTransparentColor(),p.setColorType(document.getElementById(e.createtColorTypeId(t)));["thickness","transparency"].forEach((function(e){var t=function(e){var t=p.selectedAttr[e];return"thickness"===e?t=Math.round(t/s.default.DPI_RATIO*(96/s.default.DEFAULT_DPI)):"transparency"===e&&(t=(100*(1-t)).toFixed(0)),"number"==typeof t?t.toString():t}(e),n=document.getElementById(e+"__input");n.value=t,document.getElementById(e+"_result").innerText=t,p.setInputRangeTrackFill(n)})),p.isFreetextMarker()&&p.setTextStyleMenuItem()},this.setTextStyleMenuItem=function(){var t=p.selectedAttr.fontSize,n=p.selectedAttr.textAlign;p.handleAlignBtnActive(n);var i=document.getElementById("font-size__input"),o=e.fontSizes.indexOf(t);i.selectedIndex=o},this.fontSizeSelectEventBind=function(){var e=document.getElementById("font-size__input");e.addEventListener("change",(function(){var t=p.selectedAttr.fontSize,n=e.options[e.selectedIndex].value;p.eventObserver.changeMarkerStyle.notify({oldValue:t,newValue:""+n,attrName:"fontSize",setSelectedStyle:function(){p.selectedAttr.fontSize=""+n}})}))},this.handleAlignBtnActive=function(e){for(var t=0;t<p.textAlignBtnList.length;++t)e+"-align-btn"!==p.textAlignBtnList[t]&&r.Util.removeClass(document.getElementById(p.textAlignBtnList[t]),"prop-active");r.Util.addClass(document.getElementById(e+"-align-btn"),"prop-active")},this.textAlignBtnEventBind=function(){["left","right","center"].forEach((function(e){var t=document.getElementById(e+"-align-btn");r.Util.bindClickEvent(t,(function(){var t=p.selectedAttr.textAlign;p.handleAlignBtnActive(e),p.eventObserver.changeMarkerStyle.notify({oldValue:t,newValue:""+e,attrName:"textAlign",setSelectedStyle:function(){p.selectedAttr.textAlign=""+e}})}))}))},this.propTabBtnEventBind=function(){p.propTextTabBtn.addEventListener("click",(function(){p.showTextStyleTab()})),p.propBorderTabBtn.addEventListener("click",(function(){p.showBorderStyleTab()})),p.propFillTabBtn.addEventListener("click",(function(){p.showFillStyleTab()}))},this.showTextStyleTab=function(){r.Util.removeClass(p.propBorderTabBtn,"prop-active"),r.Util.removeClass(p.propFillTabBtn,"prop-active"),r.Util.addClass(p.propTextTabBtn,"prop-active"),r.Util.removeClass(p.textStyleTab,"hide"),r.Util.addClass(p.borderStyleTab,"hide");var t=document.getElementById(e.createtColorTypeId(p.selectedAttr.fontColor));p.setColorType(t),document.getElementById("color_name").innerText=l.LocaleMessage.getMessage("freetext_font-color"),p.propSubmenu.style.height=r.Util.isSmallScreen()?p.textTabHeight+p.heightGapOfTextBorder+"px":p.textTabHeight+"px",p.colorTypeSelected=i.Text,p.disabledTransparentColor()},this.showBorderStyleTab=function(){r.Util.removeClass(p.propTextTabBtn,"prop-active"),r.Util.removeClass(p.propFillTabBtn,"prop-active"),r.Util.addClass(p.propBorderTabBtn,"prop-active"),r.Util.removeClass(p.borderStyleTab,"hide"),r.Util.addClass(p.textStyleTab,"hide");var t=document.getElementById(e.createtColorTypeId(p.selectedAttr.color));p.setColorType(t),p.hasFill?document.getElementById("color_name").innerText=l.LocaleMessage.getMessage("marker_border_color"):document.getElementById("color_name").innerText=l.LocaleMessage.getMessage("marker_color"),p.propSubmenu.style.height=r.Util.isSmallScreen()?p.borderTabHeight+p.heightGapOfTextBorder+"px":p.borderTabHeight+"px",p.colorTypeSelected=i.Border,p.disabledTransparentColor()},this.showFillStyleTab=function(){r.Util.removeClass(p.propTextTabBtn,"prop-active"),r.Util.removeClass(p.propBorderTabBtn,"prop-active"),r.Util.addClass(p.propFillTabBtn,"prop-active"),r.Util.addClass(p.borderStyleTab,"hide"),r.Util.addClass(p.textStyleTab,"hide");var t=document.getElementById(e.createtColorTypeId(p.selectedAttr.innerColor));p.setColorType(t),document.getElementById("color_name").innerText=l.LocaleMessage.getMessage("marker_fill_color"),p.propSubmenu.style.height=r.Util.isSmallScreen()?p.fillTabHeight+p.heightGapOfFill+"px":p.fillTabHeight+"px",p.colorTypeSelected=i.Fill,p.disabledTransparentColor()},this.getStyleMenuPosition=function(e,t){var n=c.default.parseMarkerId(p.activeMarkerId).pageOrSheetIdx,i=document.getElementById(p.activeMarkerId),o={left:parseFloat(i.style.left)*e,top:parseFloat(i.style.top)*e,width:parseFloat(i.style.width)*e,height:parseFloat(i.style.height)*e,obj:i},r=p.popupWidth*u.ScaleEvent.getBrowserScale(),a=(p.isFreetextMarker()?p.textTabHeight:p.borderTabHeight)*u.ScaleEvent.getBrowserScale(),s=d.popUpPos(o,r,a,p.docInfo,n,t);return{left:s.left,top:s.top}},this.setPosition=function(e,t){var n=u.ScaleEvent.getBrowserScale();if(r.Util.isSmallScreen())if(1!==n){if(u.ScaleEvent.isAbsolutePosition())return p.propSubmenu.style.position="absolute",void u.ScaleEvent.scaleWithPosition(p.propSubmenu,u.TransformOriginType.LEFT_TOP,0,1*n);var i=r.Util.getPageYOffset();if(!a.Browser.instance.isIOS){var o=u.ScaleEvent.getHeaderAreaHeightWithAnnot()+1;i=r.Util.getPageYOffset()+o*n}p.propSubmenu.style.cssText="position: fixed; transform-origin: left top; left : "+r.Util.getPageXOffset()+"px; top: "+i+"px",u.ScaleEvent.scale(p.propSubmenu)}else{var s=document.getElementById("marker-header").getBoundingClientRect();p.propSubmenu.style.cssText="left: 0px; top:"+s.bottom+"px"}else{p.propSubmenu.style.cssText="";var l=p.activeMarkerId?p.getStyleMenuPosition(e,t):function(){var e,t=null===(e=window.event.target)||void 0===e?void 0:e.getBoundingClientRect();if(1!==n&&u.ScaleEvent.isAbsolutePosition()){p.propSubmenu.style.position="absolute";var i=t.left-p.popupWidth*n/2,o=r.Util.getPageYOffset()+t.top-t.height+1*n;return{left:i>0?r.Util.getPageXOffset()+i:0,top:o}}p.propSubmenu.style.position="fixed";var a=t.left-p.popupWidth*n/2;return{left:a>0?a:0,top:t.bottom+1*n}}();1!==n&&u.ScaleEvent.scale(p.propSubmenu),p.propSubmenu.style.left=l.left+"px",p.propSubmenu.style.top=l.top+"px"}},this.showStyleMenu=function(e){var t=e.activeMarkerId,n=e.ratio,i=e.isTop;p.activeMarkerId=t,p.setPosition(n,i),p.setStyleMenuItem(),p.styleMenuOnCss()},this.resizeWindow=function(){var e,t,n;c.default.isAnnotMode&&!r.Util.containClassName(p.propSubmenu,"hide")&&h.MobileEvent.virtualKeyboardMode!==h.VK_MODE.changeStatus&&(p.activeMarkerId&&(e=c.default.parseMarkerId(p.activeMarkerId),t=e.pageOrSheetIdx,n=e.annotId,p.eventObserver.selectAnnotation.notify({page:t,annotId:n,showMemo:!1,showPopup:!0})),p.eventObserver.closeProp.notify())},this.bindColorClickOrTouchEvent=function(e,t,n){e.on(a.Browser.instance.isMobile?"touchstart":"mouseover",(function(e){var n=e.target.className.indexOf("submenu__block")>-1?e.target:r.Util.getParentElement(e.target);o(n).addClass(t)})).on(a.Browser.instance.isMobile?"touchend click":"mouseout click",(function(e){if("touchend"===e.type||"mouseout"===e.type){var i=e.target.className.indexOf("submenu__block")>-1?e.target:r.Util.getParentElement(e.target);o(i).removeClass(t)}"touchend"!==e.type&&"click"!==e.type||n(e)}));for(var i=0;i<e.length;++i)r.Util.bindEnterKey(e[i])},this.disableClickAndTouchEvent=function(){c.default.isDrawingMode&&a.Browser.instance.isMobile&&a.Browser.instance.isIOS&&(p.propSubmenu.addEventListener("click",(function(e){e.preventDefault()})),p.propSubmenu.addEventListener("touchstart",(function(e){e.touches.length>1&&e.preventDefault()})))},this.closeStyleMenu=function(){p.styleMenuOffCss()&&p.saveAnnotStyle(),r.Util.clearTabIndexList(p.styleTabList)},this.eventBind=function(e){var t;p.styleMenuInactiveEventBind(),p.colorBtnEventBind(),p.thicknessBtnEventBind(),p.transparencyBtnEventBind(),p.disableClickAndTouchEvent(),p.propTabBtnEventBind(),p.textAlignBtnEventBind(),p.fontSizeSelectEventBind(),p.eventObserver=e,p.eventObserver.showProp.subscribe(p.showStyleMenu),p.eventObserver.resizeWindow.subscribe(p.resizeWindow),p.eventObserver.closeProp.subscribe(p.closeStyleMenu),t=!1,p.eventObserver.dragAnnotStart.subscribe((function(){var e=r.Util.isSmallScreen(),n=!r.Util.hasClass(p.propSubmenu,"hide");e||(t=n),n&&p.eventObserver.closeProp.notify()})),p.eventObserver.dragAnnotEnd.subscribe((function(e){var n=e.page,i=e.annotId,o=e.showStyle,a=e.ratio;r.Util.isSmallScreen()||i&&t&&o&&(p.activeMarkerId=c.default.createtMarkerId(n,i),p.setPosition(a),p.styleMenuOnCss()),t=!1}))},this.setMarkerAttributes(f,!1),this.eventBind(n),this.docInfo=t}return e.fontSizes=["6","8","9","10","12","14","18","20","24","26","28","36","48","72"],e.getColorTypeId=function(e){return e.split("-")[1]},e.createtColorTypeId=function(e){return"color-"+e+"-btn"},e.getRgbToColorType=function(t){if(!t)return t;for(var n=document.getElementsByClassName("prop-submenu-color__block"),i=0;i<n.length;++i){var o=n.item(i).id,r=e.getColorTypeId(o);if(e.getTypeToHexColor(r)===t)return r}return"type2"},e.getTypeToHexColor=function(t){return document.getElementById(e.createtColorTypeId(t)).dataset.color},e}();t.default=f},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),o=n(0),r=n(295),a=n(111),s=n(110),l=n(296),c=n(1),d=n(52),u=n(19),h=null,f=function(){function e(){var t=this;this.resizeEvent=null,this.init=function(){var e=document.getElementById(a.default.dialogWrapperElSelector);e&&t.modalEl.removeChild(e);var n=document.getElementById(a.default.dimmedElSelector);n&&t.modalEl.removeChild(n),u.ScaleEvent.disableiOSFocusScale()},this.alignHorizontally=function(){var t=document.getElementById(a.default.dialogElSelector),n=document.getElementById(a.default.dialogWrapperElSelector),i=o.Util.getPageXOffset(!0)+(o.Util.getInnerWidth()-t.offsetWidth)/2,r=t.offsetHeight*u.ScaleEvent.getBrowserScale(),s=o.Util.getInnerHeight(),l=s*e.getModalTopRatio();s<r+l&&(l=0),l+=o.Util.getPageYOffset(!0),n.style.left=i+"px",n.style.top=l+"px",u.ScaleEvent.scale(n,"center top")},this.resizeModal=function(){var e=t.alignHorizontally;return c.Browser.instance.isIOS?function(){setTimeout((function(){e()}),100)}:e},this.render=function(e,n){if(void 0===n&&(n=null),t.init(),t.modalEl.style.display="block",n){var i=document.createElement("div");i.id=a.default.dimmedElSelector,i.className=a.default.dimmedElSelector,i.addEventListener(o.Util.getClickEventName(),(function(){n()})),t.modalEl.appendChild(i)}var r=document.createElement("div");r.id=a.default.dialogWrapperElSelector,r.className=a.default.dialogWrapperElSelector,o.Util.initTabIndex(),e.tabIndex=0,r.appendChild(e),t.modalEl.appendChild(r),t.modalEl.style.display="block",t.alignHorizontally(),window.addEventListener("resize",t.resizeEvent),c.Browser.instance.isSupportVisualViewport()&&window.visualViewport.addEventListener("resize",t.resizeEvent),e.focus()},this.renderWithDialogObject=function(e,n){void 0===n&&(n=null),t.render(e.create(),n)},this.remove=function(){t.modalEl.style.display="",window.removeEventListener("resize",t.resizeEvent),c.Browser.instance.isSupportVisualViewport()&&window.visualViewport.removeEventListener("resize",t.resizeEvent),o.Util.restoreTabIndex(),u.ScaleEvent.enableiOSFocusScale()},this.msgDialog=function(e,n){void 0===n&&(n=null);var i=t.elFactory.createLocaleMsgBox(e),o=t.elFactory.createDialogEl();o.appendChild(i),t.render(o,n)},this.confirmDialog=function(e,n,i){void 0===n&&(n="msg_submit"),void 0===i&&(i=function(){t.remove()});var o=t.elFactory.createLocaleMsgBox(e),r=t.elFactory.createSingleBtnBoxEl(n,s.BUTTON_COLOR.BLACK,i).boxEl,a=t.elFactory.createDialogEl();a.appendChild(o),a.appendChild(r),t.render(a),a.addEventListener("keydown",(function(e){"Enter"===e.key&&i()}))},this.questionDialog=function(e,n,i,o,r,a,s){void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===s&&(s=null);var l=t.elFactory.createLocaleMsgBox(e),c=t.elFactory.create2AnswerBtnBoxEl(n,i,o,r).boxEl,d=t.elFactory.createDialogEl();d.appendChild(l),null!==s&&d.appendChild(t.elFactory.createCheckBox(s)),d.appendChild(c),t.render(d,a),d.addEventListener("keydown",(function(e){"Enter"===e.key?o&&o():"Escape"===e.key&&r&&r()}))},this.questionMessageDialog=function(e,n,i,o,r,a){void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=null),t.questionDialog(e,n,i,(function(){t.remove(),null!==o&&o()}),(function(){t.remove(),null!==r&&r()}),null,a)},this.prevPwdValue="",this.passwordDialog=function(e,n,r){void 0===e&&(e=""),void 0===n&&(n=null),void 0===r&&(r=null);var a=t.elFactory.createLocaleMsgBox("msg_exception_doc"),s=document.createElement("div");s.className="dialog__pwd-input";var l=document.createElement("input");if(l.className="pwd-input",l.type="password",l.title=i.LocaleMessage.getMessage("dialog-passwd"),s.appendChild(l),e){l.value=t.prevPwdValue,o.Util.addClass(l,"pwd-input--warn");var c=document.createElement("div");c.className="pwd-warn-msg",c.innerHTML=i.LocaleMessage.getMessage(e),s.appendChild(c)}var d=function(){t.prevPwdValue=l.value,n&&n(l.value),l&&l.focus()},u=t.elFactory.create2AnswerBtnBoxEl("msg_submit","msg_cancel",d,r).boxEl,h=t.elFactory.createDialogEl();h.appendChild(a),h.appendChild(s),h.appendChild(u),t.render(h),l.focus(),h.addEventListener("keydown",(function(e){"Enter"===e.key?d():"Escape"===e.key&&r&&r()}))},this.downloadAsDialog=function(e,n,r,s){void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null);var l=!e,u=t.elFactory.createLocaleMsgBox("msg_download_as"),h=document.createElement("input");h.className="input",h.id="download-input",h.placeholder=i.LocaleMessage.getMessage("msg_input_filename"),h.value=e,h.addEventListener("keypress",(function(){l&&(o.Util.removeClass(h,"input--warn"),h.placeholder=i.LocaleMessage.getMessage("msg_input_filename"),l=!1)})),c.Browser.instance.isIE9Lower()&&(h.addEventListener("focus",(function(){l&&(o.Util.removeClass(h,"input--warn"),h.value="",l=!1)})),h.addEventListener("focusout",(function(){""===h.value&&(l=!0,o.Util.addClass(h,"input--warn"),h.value=i.LocaleMessage.getMessage("msg_input_filename_warn"))})));var f=function(){if(h.value&&h.value!==i.LocaleMessage.getMessage("msg_input_filename_warn")){var e=h.value;e=e.replace(/[\\/:*?"<>|]+/g,"_"),t.remove(),n&&n(e)}else l=!0,o.Util.addClass(h,"input--warn"),h.placeholder=i.LocaleMessage.getMessage("msg_input_filename_warn"),c.Browser.instance.isIE9Lower()&&(h.value=i.LocaleMessage.getMessage("msg_input_filename_warn"))},p=function(){t.remove(),r&&r()},m=t.elFactory.create2AnswerBtnBoxEl("msg_save","msg_cancel",f,p).boxEl,g=t.elFactory.createDialogEl();g.appendChild(u);var v=document.createElement("div");v.className=a.default.dialogElSelector+"__input",v.appendChild(h),g.appendChild(v),null!==s&&g.appendChild(t.elFactory.createCheckBox(s)),g.appendChild(m),t.render(g),g.addEventListener("keydown",(function(e){"Enter"===e.key?f():"Escape"!==e.key&&e.keyCode!==d.keyMap.ESC||p()}))},this.infoDialog=function(e,n,r){void 0===e&&(e=""),void 0===n&&(n=null),void 0===r&&(r=function(){t.remove()});var l=document.createElement("div");"ko"===i.LocaleMessage.currentLanguage?l.className="info-logo":l.className="info-logo-en";var c=document.createElement("div");c.className="content";var u=" "+o.Util.getServiceVersionString(),h=[];e&&h.push({key:i.LocaleMessage.getMessage("info_company_name"),value:e}),h.push({key:i.LocaleMessage.getMessage("info_product_name_version_key"),value:i.LocaleMessage.getMessage("info_product_name_version_value")+u});var f=document.createElement("div");f.className="content__key-value",f.appendChild(t.elFactory.createKeyValueBoxEl(h)),c.appendChild(f);var p=document.createElement("div");p.className="content__copyright",p.innerHTML=i.LocaleMessage.getMessage("into_product_copyright"),c.appendChild(p);var m=function(){t.remove(),r&&r()},g=t.elFactory.createSingleBtnBoxEl("msg_submit",s.BUTTON_COLOR.BLACK,m).boxEl,v=t.elFactory.createDialogEl(!1),b=document.createElement("div");b.className=a.default.dialogElSelector+"__info-logo",b.appendChild(l),b.title=i.LocaleMessage.getMessage("dialog_logo"),v.appendChild(b);var y=document.createElement("div");if(y.className=a.default.dialogElSelector+"__info-content",y.appendChild(c),v.appendChild(y),n){var E=document.createElement("div");for(var I in E.className="metabox",n){var S=document.createElement("div");S.className="metabox__key-value";var w=n[I][0].name,_=n[I][1].content?n[I][1].content:"",T=document.createElement("div");T.innerText=w,T.className="metabox__key-box";var x=document.createElement("div");x.innerText=_,x.className="metabox__value-box",S.appendChild(T),S.appendChild(x),E.appendChild(S)}y.appendChild(E),y.style.borderBottom="0px",y.style.marginBottom="0px"}v.appendChild(g),t.render(v),v.addEventListener("keydown",(function(e){"Enter"!==e.key&&"Escape"!==e.key&&e.keyCode!==d.keyMap.ESC||m()}))},this.snsDialog=function(){t.renderWithDialogObject(new l.default(t.elFactory))},this.refreshDialog=function(){t.confirmDialog("msg_exception_open_failed","msg_refresh",(function(){location.reload()}))},this.deleteMarkerDialog=function(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null),t.questionDialog(e,"msg_submit","msg_cancel",(function(){t.remove(),n&&n()}),(function(){t.remove(),i&&i()}))},this.annotFailedDialog=function(e){var n="msg_save_annotation_failed";switch(e){case 102:n="msg_annotation_permission_error";break;case 103:n="msg_annotation_admin_error"}t.confirmDialog(n,"msg_close")},this.annotSaveFailedDialog=function(){t.confirmDialog("msg_save_annotation_failed","msg_close")},this.annotSaveExceptDialog=function(){t.confirmDialog("msg_save_annotation_except","msg_close")},this.getSheetPageOpenFailedDialogEl=function(){var e=t.elFactory.createLocaleMsgBox("msg_sheet_convFail"),n=t.elFactory.createDialogEl(!1);return n.appendChild(e),n},this.openDocErrorDialog=function(e){if(c.Browser.instance.isIOS&&window.history.length>1)t.confirmDialog(e,"msg_back",(function(){history.back()}));else{var n=t.elFactory.createLocaleMsgBox(e),i=t.elFactory.createDialogEl(!1);i.appendChild(n),t.render(i)}},this.elFactory=new r.default,this.modalEl=document.getElementById(a.default.modalElSelector),this.resizeEvent=this.resizeModal()}return Object.defineProperty(e,"instance",{get:function(){return h||(h=new e),h},enumerable:!1,configurable:!0}),e.getModalTopRatio=function(){return o.Util.isMobileMode()?.15:.1},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyEvent=t.keyMap=void 0;var i,o=n(3),r=n(0),a=n(37),s=n(1),l=n(6),c=n(54);!function(e){e[e.ESC=27]="ESC",e[e.PAGEUP=33]="PAGEUP",e[e.PAGEDOWN=34]="PAGEDOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFTARROW=37]="LEFTARROW",e[e.UPARROW=38]="UPARROW",e[e.RIGHTARROW=39]="RIGHTARROW",e[e.DOWNARROW=40]="DOWNARROW",e[e.DELETE=46]="DELETE",e[e.Z=90]="Z",e[e.F=70]="F",e[e.F11=122]="F11"}(i=t.keyMap||(t.keyMap={}));var d=function(){var e=this;this.eventObserver=null,this.docInfo=null,this.maxPage=null,this.keypressCnt=0,this.stopKeyTimeout=null,this.scrollContentAreaEl=s.Browser.instance.isIOS?o(document):o("#contents"),this.pageInputEventKey=[i.END,i.HOME,i.LEFTARROW,i.RIGHTARROW],this.isOnePage=function(){return!(!r.Util.isHtmlSlideSkin(e.docInfo)||s.Browser.instance.isMobile)||!(!r.Util.isFullScreen()||!a.DetectZoom||100!==a.DetectZoom.getRatio())||void 0},this.searchCtrlFKeyEvent=function(t){if(t.keyCode!==i.F||!t.ctrlKey&&!t.metaKey);else{if(t.preventDefault(),t.stopPropagation(),r.Util.isFullScreen())return;l.default.isAnnotMode||r.Util.isActiveSearch()?(o("#search").hide(),o("#search-btn__img").removeClass("search-btn__img--on"),e.eventObserver.searchDisplay.notify(c.SEARCH_DISPLAY.HIDE)):(o("#search").show(),o("#search__input").focus(),e.eventObserver.searchDisplay.notify(c.SEARCH_DISPLAY.SHOW),o("#search-btn__img").addClass("search-btn__img--on"))}},this.sheetKeyEvent=function(t){e.markerKeyEvent(t),r.Util.isUseSearch(e.docInfo)&&e.searchCtrlFKeyEvent(t)},this.pageKeyEvent=function(t){if(t.keyCode!==i.F11&&t.keyCode!==i.ESC){r.Util.isUseSearch(e.docInfo)&&e.searchCtrlFKeyEvent(t);var n=t.target;"page__input"===n.id&&e.pageInputEventKey.indexOf(t.keyCode)>-1||(n.id.indexOf("page")>-1&&-1!==[i.PAGEUP,i.PAGEDOWN,i.UPARROW,i.DOWNARROW,i.LEFTARROW,i.RIGHTARROW].indexOf(t.keyCode)&&t.preventDefault(),e.markerKeyEvent(t),"thumbnailview-btn"!==n.id&&n.id.indexOf("thumb")>-1||(e.keypressCnt+=1,clearTimeout(e.stopKeyTimeout),e.keypressCnt>0&&(e.stopKeyTimeout=window.setTimeout((function(){var n=!0===e.isOnePage()?e.fullscreenGetPageNum(t.keyCode,e.keypressCnt):e.getPageNum(t.keyCode,e.keypressCnt);e.keypressCnt=0,-1!==n&&e.keyMovePage(n)}),20))))}},this.getPageNum=function(t,n){var o=e.docInfo.currentPage,r=-1;switch(t){case i.PAGEUP:var a=o-n;r=Math.max(a,0);break;case i.PAGEDOWN:var s=o+n;r=Math.min(s,e.maxPage-1);break;case i.UPARROW:e.scrollContentAreaEl.scrollTop(e.scrollContentAreaEl.scrollTop()-40);break;case i.LEFTARROW:e.scrollContentAreaEl.scrollLeft(e.scrollContentAreaEl.scrollLeft()-40);break;case i.DOWNARROW:e.scrollContentAreaEl.scrollTop(e.scrollContentAreaEl.scrollTop()+40);break;case i.RIGHTARROW:e.scrollContentAreaEl.scrollLeft(e.scrollContentAreaEl.scrollLeft()+40);break;case i.HOME:e.scrollContentAreaEl.scrollTop(0);break;case i.END:e.scrollContentAreaEl.scrollTop(e.scrollContentAreaEl.prop("scrollHeight"));break;default:r=-1}return r},this.fullscreenGetPageNum=function(t,n){var o=e.docInfo.currentPage,r=-1;switch(t){case i.PAGEUP:case i.UPARROW:case i.LEFTARROW:var a=o-n;r=Math.max(a,0);break;case i.PAGEDOWN:case i.DOWNARROW:case i.RIGHTARROW:var s=o+n;r=Math.min(s,e.maxPage-1);break;case i.HOME:r=0;break;case i.END:r=e.maxPage-1;break;default:r=-1}return r},this.keyMovePage=function(t){isNaN(t)||t<0||t>e.maxPage-1||1===e.maxPage?o("#page__input").val(e.docInfo.currentPage+1):e.eventObserver.page.notify({pageNum:t,isScroll:!1})},this.markerKeyEvent=function(t){l.default.isAnnotMode&&t.keyCode===i.Z&&(t.ctrlKey||window.macKeys.cmdKey)&&(t.shiftKey||window.macKeys.shiftKey?e.eventObserver.redoMarker.notify():e.eventObserver.undoMarker.notify())},this.eventBind=function(t){e.eventObserver=t,(r.Util.isConvImg(e.docInfo)||r.Util.isHtmlSlideSkin(e.docInfo)||r.Util.isHtmlImageSkin(e.docInfo))&&(o(window).on("keyup",(function(){e.keypressCnt=0})),o(window).on("keydown",(function(t){return r.Util.isCellSkin(e.docInfo)?e.sheetKeyEvent(t.originalEvent):e.pageKeyEvent(t.originalEvent)}))),o(window).on("keyup",(function(t){e.eventObserver.keyUp.notify(t)})),o(window).on("keydown",(function(t){e.eventObserver.keyPress.notify(t)}))},this.load=function(e,t){this.docInfo=e,r.Util.isCellSkin(e)||(this.maxPage=this.docInfo.status.pageNum),this.eventBind(t)}};t.KeyEvent=d},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Head=t.BGCOLOR_MODE=void 0;var r,a=n(54),s=n(38),l=n(0),c=n(17),d=n(3),u=n(26),h=n(32),f=n(16),p=n(108),m=n(162),g=n(1),v=n(19),b=n(6),y=n(51),E=n(30),I=n(107),S=n(33),w=n(62);!function(e){e[e.lightScreen=0]="lightScreen",e[e.darkScreen=1]="darkScreen"}(r=t.BGCOLOR_MODE||(t.BGCOLOR_MODE={}));var _=function(){function t(){var _=this;this.docInfo=null,this.eventObserver=null,this.dialogFactory=y.default.instance,this.viewMode=u.VIEW_MODE.desktop,this.pageInputWidth=24,this.headerIconWidth=l.Util.MaxMobileModeWidth/2,this.fileExtMap={xls:"cell-icon",xlsb:"cell-icon",xlsx:"cell-icon",csv:"cell-icon",nxls:"cell-icon",ppt:"slide-icon",pptx:"slide-icon",nppt:"slide-icon",doc:"word-icon",docx:"word-icon",ndoc:"word-icon",hwp2k:"hwp-icon",hwp97:"hwp-icon",hwx:"hwp-icon",hwpx:"hwp-icon",txt:"txt-icon",text:"txt-icon",hwpml:"hwp-icon",jpeg:"img-icon",jpg:"img-icon",png:"img-icon",tiff:"img-icon",gif:"img-icon",bmp:"img-icon",webp:"img-icon",jpeg2k:"img-icon",pdf:"pdf-icon",odt:"odt-icon",html:"html-icon",htm:"html-icon",xmldart:"html-icon",mht:"mht-icon",mhtml:"mht-icon",msg:"mht-icon",eml:"mht-icon",default:"nosupport-icon"},this.setMinWidthHeader=function(){document.getElementById("header").style.minWidth="400px",document.getElementById("wrap__header__container").style.minWidth="400px",document.getElementById("marker-header").style.minWidth="400px"},this.load=function(t,n){return i(_,void 0,e,(function(){return o(this,(function(e){switch(e.label){case 0:return this.docInfo=t,this.pageWidth=this.pageInputWidth+(String(this.docInfo.status.pageNum).length>2?5.5*(String(this.docInfo.status.pageNum).length-2):0)+"px",g.Browser.instance.isMobile||this.setMinWidthHeader(),[4,this.initEvent()];case 1:return e.sent(),this.jqPageInput=d("#page__input"),this.jqPageInput.val(1),this.jqPageInput.on("change",this.movePage),l.Util.bindEnterKey(document.getElementById("page__input"),this.movePage),this.setTotalPageWidth(),this.eventBind(n),l.Util.isMobileMode()&&(this.viewMode=u.VIEW_MODE.mobile),this.setTitle(),[2]}}))}))},this.eventBind=function(e){_.eventObserver=e,_.eventObserver.page.subscribe(_.focusPage),_.eventObserver.sheet.subscribe(_.moveSheet),_.eventObserver.resizeWindow.subscribe(_.resizeWindow),_.eventObserver.bgColor.subscribe(_.bgColor),_.eventObserver.orientationchange.subscribe(_.orientationchange),_.eventObserver.annotMode.subscribe(_.annotMode),_.subscribeMobileHeader(),_.mouseoverEventBind(),g.Browser.instance.isSupportVisualViewport()&&(_.eventObserver.startViewportScroll.subscribe(_.startViewportScroll),_.eventObserver.endViewportScroll.subscribe(_.endViewportScroll)),l.Util.isUseSearch(_.docInfo)&&(l.Util.bindClickOrTouchEvent(d("#search-prev"),"search-control--hover",_.searchTextNotify),l.Util.bindClickOrTouchEvent(d("#search-next"),"search-control--hover",_.searchTextNotify),l.Util.bindClickOrTouchEvent(d("#search-close"),"search-control--hover",_.searchClose)),_.headerIconWidth=document.getElementById("header-menu").clientWidth+document.getElementById("header-page").clientWidth,_.headerIconWidth>l.Util.MaxMobileModeWidth/2&&(_.setHeaderPagePosition(),window.addEventListener("resize",_.setHeaderPagePosition))},this.searchTextNotify=function(e){var t="search-next"===e.target.parentElement.id||"search-next"===e.target.id?a.SEARCH_TYPE.NEXT:a.SEARCH_TYPE.PREV;_.eventObserver.searchNext.notify(t)},this.setTotalPageWidth=function(){l.Util.isMobileMode()?String(_.docInfo.status.pageNum).length>5?(_.jqPageInput.css("width","60px"),d("#select-arrow").css("left","53px"),d("#page-scroll-blind").css("width","73px")):_.jqPageInput.css("width",""):_.jqPageInput.css("width",_.pageWidth)},this.subscribeMobileHeader=function(){if(void 0!==window.localSynap&&!1===window.localSynap.config.isShowHeader)return d(".wrap__header").addClass("wrap__header--hide"),d("#container").addClass("wrap__container--option-on"),void d("#thumbnail").addClass("wrap__thumbnail--option-on");void 0!==window.localSynap&&!1!==window.localSynap.config.headerAutoHide?_.eventObserver.mobileHeader.subscribe(_.mobileHeader):d("#contents").addClass("wrap__contents--option-show-header"),("cell"===_.docInfo.skinType||l.Util.isHtmlSkin(_.docInfo))&&l.Util.isMobileMode()&&_.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC)},this.initEvent=function(){return i(_,void 0,e,(function(){return o(this,(function(e){return this.setMetaGenerator(),l.Util.isHtmlSkin(this.docInfo)?"cell"===this.docInfo.skinType?(d("#backgroundcolor-btn").addClass("hide"),d("#mobile-bgcolor-btn").addClass("hide")):"slide"===this.docInfo.skinType&&(l.Util.useSingle(this.docInfo)||d("div").removeClass("cell"),g.Browser.instance.isMobile&&(d("#thumbnail").addClass("cell"),d("#thumbnailbar").addClass("cell"),d("#thumbnailview-btn").addClass("cell")),this.mobilePageAreaLoad(this.docInfo.status.pageNum)):("cell"!==this.docInfo.skinType&&(d("div").removeClass("cell"),this.mobilePageAreaLoad(this.docInfo.status.pageNum)),l.Util.isUseSearch(this.docInfo)&&this.searchTextLoad()),this.bindPrintBtn(),this.bindSnsBtn(),this.bindInfoBtn(),this.bindMoreBtn(),this.docInfo.downloadUrl&&this.downloadBtnLoad(this.docInfo.downloadUrl),g.Browser.instance.isMobile&&(this.initViewportContent(),this.adjustMobileDeviceViewport(),g.Browser.instance.isIOS&&this.bindWindowCloseBtnLoad()),l.Util.setVHVariable(),d(".wrap__menu").removeClass("hide"),this.bindBgcolorBtn(),this.hasSubMenu()||d("#more").hide(),l.Util.isDocslive()&&this.docInfo.cs===I.CS_TYPE.SERVER&&this.bindLaserBtn(),l.Util.isUseAnnotation(this.docInfo)&&(!l.Util.isCellSkin(this.docInfo)&&!l.Util.isHTMLFormat(this.docInfo)&&(f.default.permission.annotDownPdf&&this.exportPdfBtnLoad(),f.default.permission.annotSavePdf&&this.saveServerPdfBtnLoad()),!g.Browser.instance.isIE10Lower()&&f.default.permission.annotEdit&&(this.markerLoad(),this.bindMarkerDeleteBtn(),this.bindAnnotationList())),this.checkSubMenuBorder(),[2]}))}))},this.setMetaGenerator=function(){var e=n(286).version;e=l.Util.getServiceVersionString()+"."+e;var t=document.querySelector('meta[name="GENERATOR"]').getAttribute("content")+" "+e;document.querySelector('meta[name="GENERATOR"]').setAttribute("content",t)},this.checkSubMenuBorder=function(){var e=null,t=-1,n=document.getElementsByClassName("scroll-blind__more-border");Array.from(document.getElementsByClassName("scroll-blind__more-item")).forEach((function(i,o){i.classList.contains("hide")||(e=i,t=o,o<n.length&&l.Util.removeClass(n[o],"hide"))})),e&&t<n.length&&l.Util.addClass(n[t],"hide")},this.bindMarkerDeleteBtn=function(){var e=d("#marker-delete-btn"),t=document.getElementById("marker-delete-btn__img");e.on("click",(function(){l.Util.addClass(t,"marker-delete-btn__img--on"),_.dialogFactory.deleteMarkerDialog("msg_delete_marker",(function(){l.Util.removeClass(t,"marker-delete-btn__img--on")}),(function(){l.Util.removeClass(t,"marker-delete-btn__img--on")}))}))},this.bindAnnotationList=function(){var e=document.getElementById("annotation-list-btn");l.Util.bindClickEvent(e,(function(){l.Util.containClassName(e,"marker-menu--select")?(l.Util.removeClass(e,"marker-menu--select"),l.Util.addClass(document.getElementById("annotation-list"),"hide"),l.Util.removeClass(document.getElementById("contents"),"wrap__contents--annot-on")):(l.Util.addClass(e,"marker-menu--select"),l.Util.removeClass(document.getElementById("annotation-list"),"hide"),l.Util.addClass(document.getElementById("contents"),"wrap__contents--annot-on"));var t=l.Util.isMobileMode();t&&w.MemoContent.isShow()||p.default.STATUS_TOGGLE(),!t&&_.eventObserver.resizeContents.notify()}))},this.saveServerPdfBtnLoad=function(){var e=document.getElementById("server-pdf-btn__img"),t=function(){return i(_,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.eventObserver.saveServerPdf.notify()];case 1:return t.sent(),l.Util.removeClass(e,"server-pdf-btn__img--on"),[2]}}))}))},n=function(){l.Util.removeClass(e,"server-pdf-btn__img--on")},r=document.getElementById("server-pdf-btn");l.Util.removeClass(r,"hide"),l.Util.bindClickEvent(r,(function(){b.default.isAnnotMode&&_.eventObserver.saveAnnotation.notify(),l.Util.addClass(e,"server-pdf-btn__img--on"),_.dialogFactory.questionMessageDialog("msg_server_pdf_dialog","msg_submit","msg_cancel",t,n)}));var a=document.getElementById("mobile-server-pdf-btn");l.Util.removeClass(a,"hide"),a.innerText=c.LocaleMessage.getMessage("msg_server_pdf"),l.Util.bindClickOrTouchEvent(d("#mobile-server-pdf-btn"),"scroll-blind__more-item--hover",(function(){b.default.isAnnotMode&&_.eventObserver.saveAnnotation.notify(),l.Util.removeClass(document.getElementById("more-btn__img"),"more-btn__img--on"),_.hideMoreSubMemu(),l.Util.addClass(e,"server-pdf-btn__img--on"),_.dialogFactory.questionMessageDialog("msg_server_pdf_dialog","msg_submit","msg_cancel",t,n)}))},this.exportPdfBtnLoad=function(){var e=document.getElementById("export-pdf-btn"),t=document.getElementById("export-pdf-btn__img"),n=null;f.default.permission.annotView&&(n={id:"export-pdf-use-annotation",message:"msg_pdf_with_annotation",value:"1",checked:!0}),l.Util.removeClass(e,"hide");var r=function(e){return i(_,void 0,void 0,(function(){var n,i,r;return o(this,(function(o){switch(o.label){case 0:return n=l.Util.removeExtension(e,"pdf"),i=document.getElementById("export-pdf-use-annotation"),r=i&&i.checked?1:0,[4,this.eventObserver.exportPdf.notify({title:n,dispAnnot:r})];case 1:return o.sent(),l.Util.removeClass(t,"export-pdf-btn__img--on"),[2]}}))}))},a=function(){l.Util.removeClass(t,"export-pdf-btn__img--on")},s=_.docInfo.title;l.Util.bindClickEvent(e,(function(){b.default.isAnnotMode&&_.eventObserver.saveAnnotation.notify(),l.Util.addClass(t,"export-pdf-btn__img--on"),_.dialogFactory.downloadAsDialog(s,r,a,n)}));var u=document.getElementById("mobile-export-pdf-btn");l.Util.removeClass(u,"hide"),u.innerText=c.LocaleMessage.getMessage("msg_export_pdf"),l.Util.bindClickOrTouchEvent(d("#mobile-export-pdf-btn"),"scroll-blind__more-item--hover",(function(){b.default.isAnnotMode&&_.eventObserver.saveAnnotation.notify(),l.Util.removeClass(document.getElementById("more-btn__img"),"more-btn__img--on"),_.hideMoreSubMemu(),l.Util.addClass(t,"export-pdf-btn__img--on"),_.dialogFactory.downloadAsDialog(s,r,a,n)}))},this.markerLoad=function(){var e=document.getElementById("marker-btn");l.Util.removeClass(e,"hide"),l.Util.removeClass(document.getElementById("header-border"),"hide")},this.annotMode=function(e){var t=document.getElementById("contents"),n=d("#marker-header");if(e)_.annotModeOn(),l.Util.addClass(t,"wrap__contents--marker-mode"),g.Browser.instance.isMobile?t.style.top=v.ScaleEvent.getHeaderAreaHeightWithAnnot()*v.ScaleEvent.getBrowserScale()+"px":t.style.left="",n.removeClass("hide");else{if(_.annotModeOff(),l.Util.removeClass(t,"wrap__contents--marker-mode"),t.style.top="",!g.Browser.instance.isMobile){var i=document.getElementById("thumbnail");t.style.left=i.style.width}n.addClass("hide")}},this.annotModeOn=function(){l.Util.isActiveSearch()&&(d("#search").hide(),_.eventObserver.searchDisplay.notify(a.SEARCH_DISPLAY.HIDE));var e="menu__block--deactivate";if(l.Util.addClass(document.getElementById("sns-btn"),e),l.Util.addClass(document.getElementById("info-btn"),e),l.Util.addClass(document.getElementById("thumbnailview-btn"),e),l.Util.addClass(document.getElementById("download-btn"),e),l.Util.addClass(document.getElementById("search-btn"),e),l.Util.addClass(document.getElementById("backgroundcolor-btn"),e),l.Util.addClass(document.getElementById("presentation-btn"),e),l.Util.addClass(document.getElementById("fullscreen"),e),l.Util.addClass(document.getElementById("more-btn"),e),l.Util.addClass(document.getElementById("print-btn"),e),d("#sns-btn").prop("disabled",!0),d("#info-btn").prop("disabled",!0),d("#thumbnailview-btn").prop("disabled",!0),d("#download-btn").prop("disabled",!0),d("#search-btn").prop("disabled",!0),d("#search-btn").prop("disabled",!0),d("#backgroundcolor-btn").prop("disabled",!0),d("#presentation-btn").prop("disabled",!0),d("#fullscreen").prop("disabled",!0),d("#more-btn").prop("disabled",!0),d("#print-btn").prop("disabled",!0),d("#download-btn").click((function(e){e.preventDefault()})),l.Util.isDocslive()){l.Util.addClass(document.getElementById("laser-btn"),e),d("#laser-btn").prop("disabled",!0);var t=document.getElementById("laser-btn__img");l.Util.containClassName(t,"laser-btn__img--on")&&d("#laser-btn").trigger("click")}},this.annotModeOff=function(){var e="menu__block--deactivate";l.Util.removeClass(document.getElementById("sns-btn"),e),l.Util.removeClass(document.getElementById("info-btn"),e),l.Util.removeClass(document.getElementById("thumbnailview-btn"),e),l.Util.removeClass(document.getElementById("download-btn"),e),l.Util.removeClass(document.getElementById("search-btn"),e),l.Util.removeClass(document.getElementById("backgroundcolor-btn"),e),l.Util.removeClass(document.getElementById("presentation-btn"),e),l.Util.removeClass(document.getElementById("fullscreen"),e),l.Util.removeClass(document.getElementById("more-btn"),e),l.Util.removeClass(document.getElementById("print-btn"),e),d("#sns-btn").prop("disabled",!1),d("#info-btn").prop("disabled",!1),d("#thumbnailview-btn").prop("disabled",!1),d("#download-btn").prop("disabled",!1),d("#search-btn").prop("disabled",!1),d("#search-btn").prop("disabled",!1),d("#backgroundcolor-btn").prop("disabled",!1),d("#presentation-btn").prop("disabled",!1),d("#fullscreen").prop("disabled",!1),d("#more-btn").prop("disabled",!1),d("#print-btn").prop("disabled",!1),d("#download-btn").unbind("click"),h.Thumbnail.THUMB_STATUS===h.THUMB_FLAG.on&&l.Util.addClass(document.getElementById("thumbnail-btn"),"thumbnail-btn__img--on"),d("#search-btn__img").hasClass("search-btn__img--on")&&(d("#search").show(),_.eventObserver.searchDisplay.notify(a.SEARCH_DISPLAY.SHOW)),l.Util.isDocslive()&&(l.Util.removeClass(document.getElementById("laser-btn"),e),d("#laser-btn").prop("disabled",!1))},this.searchClose=function(){d("#search").hide(),d("#search-btn__img").removeClass("search-btn__img--on"),_.eventObserver.searchDisplay.notify(a.SEARCH_DISPLAY.HIDE)},this.searchTextLoad=function(){d("#search-btn").removeClass("hide");var e=d("#search"),t=function(){b.default.isAnnotMode||(l.Util.isActiveSearch()?_.searchClose():(e.show(),d("#search__input").focus(),_.eventObserver.searchDisplay.notify(a.SEARCH_DISPLAY.SHOW),d("#search-btn__img").addClass("search-btn__img--on")))};l.Util.bindClickEvent(document.getElementById("search-btn"),t);var n=document.getElementById("mobile-search-btn");n.innerText=c.LocaleMessage.getMessage("icon_search"),l.Util.removeClass(n,"hide"),l.Util.bindClickOrTouchEvent(d(n),"scroll-blind__more-item--hover",(function(){l.Util.removeClass(document.getElementById("more-btn__img"),"more-btn__img--on"),_.hideMoreSubMemu(),g.Browser.instance.isIOS&&v.ScaleEvent.disableiOSFocusScale(),t(),g.Browser.instance.isIOS&&v.ScaleEvent.enableiOSFocusScale()}))},this.hasSubMenu=function(){var e=!1;return d(".scroll-blind__more-item").each((function(t,n){"none"!==d(n).css("display")&&(e=!0)})),e},this.allowPrintPdfServer=function(){return!0===window.localSynap.config.isShowPdfPrint&&l.Util.isServer(_.docInfo)&&l.Util.isSupportedVer2022()&&"xmldart"!==_.docInfo.fileType},this.isShowPrintBtn=function(){var e=window.localSynap.config;if(g.Browser.instance.isMobile)return!1;if(!0!==e.isShowPrint&&!0!==e.isShowPdfPrint)return!1;if(!_.docInfo.enablePrint)return!1;var t=!0===e.isShowPrint&&l.Util.isConvImg(_.docInfo)&&("cell"!==_.docInfo.skinType||"cell"===_.docInfo.skinType&&!0===e.isShowPrintForCell),n=!0===e.isShowPrint&&l.Util.isConvHtml(_.docInfo)&&("word"===_.docInfo.skinType||"image"===_.docInfo.skinType||"pdf"===_.docInfo.skinType);return!!(t||n||_.allowPrintPdfServer())},this.createBlobAndPrint=function(e){var t=document.getElementById("iframepdf"),n=new window.Blob([e],{type:"application/pdf"}),i=window.URL.createObjectURL(n);t.contentWindow.location.replace(i),t.onload=function(){window.URL.revokeObjectURL(i),t.focus(),t.contentWindow.print()}},this.execPrint=function(){if(l.Util.isConvImg(_.docInfo)||l.Util.isConvHtml(_.docInfo)&&("pdf"===_.docInfo.skinType||"image"===_.docInfo.skinType))window.print();else if("word"===_.docInfo.skinType){var e=document.getElementById("innerWrap").contentWindow;e.focus(),e.print()}},this.questionIEtoEdge=function(){_.dialogFactory.questionMessageDialog("msg_print_to_edge","msg_yes","msg_no",(function(){return i(_,void 0,void 0,(function(){return o(this,(function(e){return window.location.replace("microsoft-edge:"+window.location.href),[2]}))}))}))},this.questionPrintWithServer=function(){if(g.Browser.instance.isIE)_.questionIEtoEdge();else{var e={id:"print-pdf-use-annotation",message:"msg_pdf_with_annotation",value:"1",checked:!0},t=function(){l.Util.removeClass(document.getElementById("print-btn__img"),"print-btn__img--on")};l.Util.isUseAnnotation(_.docInfo)&&f.default.permission.annotView?(l.Util.addClass(document.getElementById("print-btn__img"),"print-btn__img--on"),_.dialogFactory.questionMessageDialog("msg_pdf_print_dialog","print_menu","msg_cancel",(function(){return i(_,void 0,void 0,(function(){var e,n;return o(this,(function(i){return e=document.getElementById("print-pdf-use-annotation"),n=e&&e.checked?1:0,t(),this.execPrintWithServer(n),[2]}))}))}),t,e)):_.execPrintWithServer(0)}},this.execPrintWithServer=function(e){l.Util.showLoadingDimmed(!0);var t=document.getElementById("percent-message"),n=new window.XMLHttpRequest,i=0,o=0,r=null;n.responseType="arraybuffer",t.innerText="0%",n.addEventListener("error",(function(){null!=r&&clearInterval(r),l.Util.hideLoadingDimmed(),y.default.instance.confirmDialog("msg_print_pdf_failed")})),n.addEventListener("load",(function(){if(-1===[200,201].indexOf(n.status))return l.Util.hideLoadingDimmed(),void y.default.instance.confirmDialog("msg_print_pdf_failed");_.createBlobAndPrint(n.response)})),n.addEventListener("loadend",(function(){t.innerText="",l.Util.hideLoadingDimmed()})),n.addEventListener("readystatechange",(function(){n.readyState==n.HEADERS_RECEIVED&&(o=parseInt(n.getResponseHeader("Synap-File-Size")))})),n.addEventListener("progress",(function(e){null!=r&&clearInterval(r);var n=e.lengthComputable?e.total:o;if(n){var a=i+parseInt((e.loaded/n*(1-i/100)*100).toFixed(0));t.innerText=" "+a+"%"}}));var a=m.getPdfPrintUrl(_.docInfo,e);r=setInterval((function(){i<60&&(i+=1,t.innerText=i+"%")}),1e3),n.open("GET",a,!0),n.send()},this.bindPrintBtn=function(){_.isShowPrintBtn()&&(d("#mobile-print-btn").removeClass("hide"),d("#print-btn").removeClass("hide"),l.Util.bindClickEvent(document.getElementById("print-btn"),(function(){b.default.isAnnotMode||(_.allowPrintPdfServer()?_.questionPrintWithServer():(_.eventObserver.printbefore.notify(),_.execPrint()))})),d("#mobile-print-btn").on("click",(function(){_.allowPrintPdfServer()?_.questionPrintWithServer():(_.eventObserver.printbefore.notify(),window.print())})),l.Util.bindClickOrTouchEvent(d("#mobile-print-btn"),"scroll-blind__more-item--hover",(function(){_.hideMoreSubMemu()})),!0!==_.allowPrintPdfServer()&&d(window).on("afterprint",(function(){_.eventObserver.printafter.notify()})))},this.bindSnsBtn=function(){var e=window.localSynap.config;if(!0===e.isShowSns){if(void 0!==e.kakaoAPIKey){_.addScript("https://t1.kakaocdn.net/kakao_js_sdk/v1/kakao.min.js")}d("#mobile-sns-btn").removeClass("hide"),d("#sns-btn").removeClass("hide"),l.Util.bindClickEvent(document.getElementById("sns-btn"),(function(){b.default.isAnnotMode||(d("#sns-btn__img").addClass("sns-btn__img--on"),_.dialogFactory.snsDialog())})),d("#mobile-sns-btn").on("click",(function(){b.default.isAnnotMode||(d("#sns-btn__img").addClass("sns-btn__img--on"),_.dialogFactory.snsDialog())})),l.Util.bindClickOrTouchEvent(d("#mobile-sns-btn"),"scroll-blind__more-item--hover",(function(){_.hideMoreSubMemu()}))}},this.bindInfoBtn=function(){var e=window.localSynap.config;if(!1!==e.isShowInfo){var t=function(){return _.docInfo.metadata&&_.docInfo.metadata.length>0?_.docInfo.metadata:null},n=function(){return e.companyName?e.companyName:null};d("#mobile-info-btn").removeClass("hide"),d("#info-btn").removeClass("hide"),l.Util.bindClickEvent(document.getElementById("info-btn"),(function(){b.default.isAnnotMode||(d("#info-btn__img").addClass("info-btn__img--on"),_.dialogFactory.infoDialog(n(),t(),(function(){d("#info-btn__img").removeClass("info-btn__img--on")})))})),l.Util.bindClickOrTouchEvent(d("#mobile-info-btn"),"scroll-blind__more-item--hover",(function(){d("#info-btn__img").addClass("info-btn__img--on"),_.hideMoreSubMemu(),_.dialogFactory.infoDialog(n(),t(),(function(){d("#info-btn__img").removeClass("info-btn__img--on")}))}))}},this.hideMoreSubMemu=function(){d("#more-submenu").hide(),d("#more-btn__img").removeClass("more-btn__img--on")},this.bindMoreBtn=function(){var e=d("#more-submenu");l.Util.bindClickEvent(document.getElementById("more-btn"),(function(){b.default.isAnnotMode||(d("#more-submenu").is(":visible")?_.hideMoreSubMemu():(e.show(),d("#more-btn__img").addClass("more-btn__img--on")))})),d(document).on(l.Util.getClickEndEventName()+" keydown",(function(e){"more-btn"===e.target.id||e.target.parentElement&&"more-btn"===e.target.parentElement.id||"string"==typeof e.target.className&&e.target.className.indexOf("scroll-blind__more-item")>-1||_.hideMoreSubMemu()}))},this.downloadBtnLoad=function(e){d("#download-btn > a").attr("href",e),d("#download-btn").removeClass("hide"),l.Util.bindEnterKey(document.getElementById("download-btn"),(function(){location.href=e})),d("#mobile-download-btn").parent().attr("href",e),d("#mobile-download-btn").removeClass("hide"),l.Util.bindClickOrTouchEvent(d("#mobile-download-btn"),"scroll-blind__more-item--hover")},this.addLaserCursor=function(e){e.style.cursor="",l.Util.addClass(e,"cursor-laser-icon")},this.removeLaserCursor=function(e){e.style.cursor="pointer",l.Util.removeClass(e,"cursor-laser-icon")},this.laserStart=function(e){_.addLaserCursor(e.currentTarget)},this.laserEnd=function(e){_.removeLaserCursor(e.currentTarget)},this.laserMove=function(e){if("touch"===e.pointerType||0!==e.pressure){var t=e.currentTarget;""!=t.style.cursor&&"pen"!==e.pointerType&&"touch"!==e.pointerType&&_.addLaserCursor(t);var n=l.Util.isCellSkin(_.docInfo),i=l.Util.getIdxFromElmId(t.id,"markerlayer"),o=E.default.instance.getDocumentRatio(i,n),r={x:e.offsetX*o,y:e.offsetY*o};_.eventObserver.moveLaserCb.notify({type:0,content:{page:i,axis:r}})}},this.laserEventBind=function(e){e.addEventListener("pointerdown",_.laserStart),e.addEventListener("pointermove",_.laserMove),e.addEventListener("pointerup",_.laserEnd),e.style.zIndex="17",e.style.cursor="pointer",e.style.touchAction="none"},this.bindLaserBtn=function(){if(document.getElementById("laser-btn")){var e=document.getElementById("laser-btn"),t=document.getElementById("laser-btn__img");l.Util.removeClass(e,"hide");var n=l.Util.isCellSkin(_.docInfo),i=function(e){var t=0,i=0;n?i=(t=_.docInfo.currentSheet)+1:(t=0,i=_.docInfo.status.pageNum);for(var o=t;o<i;o++){var r=document.getElementById("markerlayer"+o);r||console.log("Not find markerlayer"+o),e?_.laserEventBind(r):(r.removeEventListener("pointerdown",_.laserStart),r.removeEventListener("pointermove",_.laserMove),r.removeEventListener("pointerup",_.laserEnd),r.style.zIndex="",r.style.touchAction="",_.removeLaserCursor(r))}};e.addEventListener("click",(function(){if(l.Util.containClassName(t,"laser-btn__img--on"))l.Util.removeClass(t,"laser-btn__img--on"),i(!1);else{if(b.default.isAnnotMode)return;l.Util.addClass(t,"laser-btn__img--on"),i(!0)}}))}},this.getHeaderCssName=function(e){var t=document.documentElement.clientWidth,n=document.documentElement.clientHeight,i=n>t?t:n,o=n>t?n:t,r=[400,600,800,1e3],a=[500,700,900,1100,1300],s=Math.round((i-r[0])/200),l=Math.round((o-a[0])/200);return s<0?s=0:s>r.length-1&&(s=r.length-1),l<0?l=0:l>a.length-1&&(l=a.length-1),["html-"+e+"-"+r[s]+"-P","html-"+e+"-"+a[l]+"-L"]},this.setHeaderCss=function(e){var t=_.getHeaderCssName(e);d(".wrap").addClass("html").addClass(t[0]).addClass(t[1]),d(".modal").addClass("html").addClass(t[0]).addClass(t[1])},this.getDocumentWidth=function(){var e=[500,650,800,1e3],t=_.docInfo.status.documentWidth?Math.ceil(_.docInfo.status.documentWidth*(96/72)):e[e.length-1],n=Math.ceil((t-e[0])/150);return n<0?n=0:n>e.length-1&&(n=e.length-1),t=e[n]},this.bindWindowCloseBtnLoad=function(){var e=d("#mobile-window-close-btn");e.removeClass("hide"),e.on(l.Util.getClickEventName(),(function(e){e.preventDefault(),window.close()})),e.html(c.LocaleMessage.getMessage("msg_window_close"))},this.initViewportContent=function(){l.Util.needDocumentFitCss(_.docInfo)?(v.ScaleEvent.setDocumentWidth(_.getDocumentWidth()),_.setHeaderCss(v.ScaleEvent.getDocumentWidth()),_.viewportContent="width="+v.ScaleEvent.getDocumentWidth()+", minimum-scale=0.3"):_.viewportContent=l.Util.getDefaultViewPortString()},this.adjustMobileDeviceViewport=function(){document.querySelector('meta[name="viewport"]').setAttribute("content",_.viewportContent)},this.bindBgcolorBtn=function(){var e=function(){b.default.isAnnotMode||(t.bgColorMode===r.lightScreen?(t.bgColorMode=r.darkScreen,"cell"===_.docInfo.skinType?d(".cell__piece").removeClass("img-loading-bright"):(d(".img-loading-bright").addClass("img-loading"),d(".img-loading").removeClass("img-loading-bright"))):(t.bgColorMode=r.lightScreen,"cell"===_.docInfo.skinType?d(".cell__piece").addClass("img-loading-bright"):(d(".img-loading").addClass("img-loading-bright"),d(".img-loading-bright").removeClass("img-loading"))),l.Util.isMobileMode()&&_.hideMoreSubMemu(),_.eventObserver.bgColor.notify(t.bgColorMode))};l.Util.bindClickEvent(document.getElementById("backgroundcolor-btn"),e),l.Util.bindClickOrTouchEvent(d("#mobile-bgcolor-btn"),"scroll-blind__more-item--hover",e)},this.bgColor=function(e){switch(e){case r.darkScreen:t.bgColorMode=r.darkScreen,d(document.body).removeClass("wrap__contents--bgcolor-light"),d("#contents").removeClass("wrap__contents--bgcolor-light"),d("#mobile-bgcolor-btn").html(c.LocaleMessage.getMessage("msg_light_backgroundcolor"));break;case r.lightScreen:t.bgColorMode=r.lightScreen,d(document.body).addClass("wrap__contents--bgcolor-light"),d("#contents").addClass("wrap__contents--bgcolor-light"),d("#mobile-bgcolor-btn").html(c.LocaleMessage.getMessage("msg_dark_backgroundcolor"))}},this.mobilePageAreaLoad=function(e){if(d("#total-page").html(String(e)),!l.Util.isTabletInCSS())if(g.Browser.instance.isIOS){var t=document.createElement("select");t.id="page__select",t.className="page__select";for(var n=1;n<=e;n++){var i=document.createElement("option");i.id="pagelist"+n,i.value=n,i.innerHTML=n,t.appendChild(i)}document.getElementById("header-page").appendChild(t),document.getElementById("select-arrow").addEventListener("click",(function(){document.getElementById("page__select").focus()})),document.getElementById("page__select").addEventListener("change",(function(){_.eventObserver.page.notify({pageNum:document.getElementById("page__select").selectedIndex,isScroll:!1}),_.hide3secHeaderAndThumb()}))}else{var o=d("#page-content"),r=function(){if(l.Util.isMobileMode()&&(o.toggle(),!o.is(":hidden"))){var e=l.Util.isHtmlSkin(_.docInfo)?l.Util.getHeadScale(".wrap__header__container"):1;d("#page-scroll-blind__list").scrollTop((d("#pagelist"+(_.docInfo.currentPage+1)).position().top-d("#pagelist1").position().top)/e),d(".page-scroll-blind__item").removeClass("page-scroll-blind--focus"),d("#pagelist"+(_.docInfo.currentPage+1)).addClass("page-scroll-blind--focus")}};l.Util.bindClickEvent(document.getElementById("select-arrow"),r),d("#page__input").on(l.Util.getClickEventName(),r),d(document).on("click",(function(e){"select-arrow"!==e.target.id&&"select-arrow-img"!==e.target.id&&"page__input"!==e.target.id&&o.hide()}));for(n=1;n<=e;n++)_.addPageSubmenuItem(n)}},this.addPageSubmenuItem=function(e){var t=d("<li/>",{id:"pagelist"+e,class:"page-scroll-blind__item","data-index":e,html:e});d(".page-scroll-blind__list").append(t),l.Util.bindClickOrTouchEvent(d("#pagelist"+e),"page-scroll-blind__item--hover",(function(e){_.movePage(e),_.hide3secHeaderAndThumb()}))},this.hide3secHeaderAndThumb=function(){h.Thumbnail.THUMB_STATUS===h.THUMB_FLAG.off&&(_.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC),_.eventObserver.mobileThumb.notify(s.ShowActionType.HIDE3SEC))},this.movePage=function(e){var t=typeof e.target.value,n=NaN;if("string"===t){/^[0-9]+$/.test(e.target.value)&&(n=parseInt(e.target.value))}else"number"===t&&(n=e.target.value);if(n-1!=_.docInfo.currentPage){n=0===e.currentTarget.id.indexOf("pagelist")?parseInt(e.currentTarget.getAttribute("data-index")):n;var i=_.docInfo.status.pageNum;isNaN(n)||n<=0||n>i?_.jqPageInput.val(_.docInfo.currentPage+1):_.eventObserver.page.notify({pageNum:n-1,isScroll:!1})}else _.jqPageInput.val(n)},this.focusPage=function(e){if(_.jqPageInput.val(e.pageNum+1),d("#page__input").attr("value",e.pageNum+1),!l.Util.isTabletInCSS())if(g.Browser.instance.isIOS)document.getElementById("page__select").options[e.pageNum].selected=!0;else if(!d("#page-content").is(":hidden")){var t=l.Util.isHtmlSkin(_.docInfo)?l.Util.getHeadScale(".wrap__header__container"):1;d("#page-scroll-blind__list").scrollTop((d("#pagelist"+(e.pageNum+1)).position().top-d("#pagelist1").position().top)/t),d(".page-scroll-blind__item").removeClass("page-scroll-blind--focus"),d("#pagelist"+(e.pageNum+1)).addClass("page-scroll-blind--focus")}},this.moveSheet=function(e){if(l.Util.isDocslive()&&_.docInfo.cs===I.CS_TYPE.SERVER&&!l.Util.isHtmlSkin(_.docInfo)&&l.Util.isUseAnnotation(_.docInfo)&&!S.ImageSheet.sheetLoadFail){var t=document.getElementById("laser-btn__img");if(l.Util.containClassName(t,"laser-btn__img--on")){var n=document.getElementById("markerlayer"+e.sheetIdx);n?_.laserEventBind(n):setTimeout((function(){_.moveSheet(e)}),100)}}},this.mobileHeader=function(e){clearTimeout(_.mobileHeaderTimer);var t=d(".wrap__header"),n=function(){t.removeClass("wrap__header--hide"),v.ScaleEvent.doScale(l.Util.isHtmlSkin(_.docInfo),l.Util.isUseAnnotation(_.docInfo))};if(e!==s.ShowActionType.SHOW){var i=function(){t.addClass("wrap__header--hide")};e===s.ShowActionType.HIDE?i():e!==s.ShowActionType.HIDE3SEC||b.default.isAnnotMode||(n(),_.mobileHeaderTimer=window.setTimeout((function(){!l.Util.isActiveSearch()&&i()}),3e3))}else n()},this.mobileHeaderHover=function(e){if(!b.default.isAnnotMode&&!l.Util.isActiveSearch())switch(e){case"mouseover":_.eventObserver.mobileHeader.notify(s.ShowActionType.SHOW);break;case"mouseleave":_.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC)}},this.mouseoverEventBind=function(){d(".wrap__header").on("mouseover.head",(function(){l.Util.isMobileMode()&&!l.Util.isFullScreen()&&"none"===d("#thumbnail").css("display")&&_.mobileHeaderHover("mouseover")})).on("mouseleave.head",(function(){l.Util.isMobileMode()&&!l.Util.isFullScreen()&&"none"===d("#thumbnail").css("display")&&_.mobileHeaderHover("mouseleave")}))},this.setTitle=function(){if(window.localSynap.config.isShowTitle){document.getElementById("header-title-text").textContent=_.docInfo.title,document.getElementById("header-title-text").title=_.docInfo.title;var e=_.fileExtMap[_.docInfo.fileType]?_.fileExtMap[_.docInfo.fileType]:_.fileExtMap[_.docInfo.default];document.getElementById("header-title-icon__img").className+=" "+e,"cell"===_.docInfo.skinType&&document.getElementById("container").clientWidth<330&&(document.getElementById("header-title-text").style.maxWidth="14%"),_.setTitleMaxWidth()}},this.setTitleMaxWidth=function(){if(l.Util.isTabletInCSS()){var e=20,t=["div.wrap__logo","div#header-title-icon","div#header-menu"];l.Util.isCellSkin(_.docInfo)||(t.push("div#header-page"),e+=30);var n=t.map((function(e){return d(e).outerWidth(!0)})).reduce((function(e,t){return e+t}),e);document.getElementById("header-title-text").style.maxWidth="calc(100% - "+n+"px)"}},this.orientationchange=function(){var e=!l.Util.needDocumentFitCss(_.docInfo);g.Browser.instance.isAndroid&&e&&_.initViewportContent(),_.adjustMobileDeviceViewport()},this.resizeWindow=function(){l.Util.isFullScreen()||(l.Util.setVHVariable(),l.Util.isMobileMode()||d("#page-content").removeAttr("style"),document.getElementById("container").clientWidth<330?document.getElementById("header-title-text").style.maxWidth="14%":l.Util.isTabletInCSS()||(document.getElementById("header-title-text").style.maxWidth=""),l.Util.isMobileMode()&&_.viewMode!==u.VIEW_MODE.mobile?(_.subscribeMobileHeader(),h.Thumbnail.THUMB_STATUS===h.THUMB_FLAG.off&&_.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC),_.viewMode=u.VIEW_MODE.mobile,_.setTotalPageWidth()):l.Util.isMobileMode()||_.viewMode===u.VIEW_MODE.desktop||(clearTimeout(_.mobileHeaderTimer),void 0!==window.localSynap&&!1!==window.localSynap.config.isShowHeader&&d(".wrap__header").removeClass("wrap__header--hide"),_.eventObserver.mobileHeader.unsubscribe(_.mobileHeader),d("#more-submenu").is(":visible")&&_.hideMoreSubMemu(),_.viewMode=u.VIEW_MODE.desktop,_.setTotalPageWidth()))},this.startViewportScroll=function(){b.default.isAnnotMode&&l.Util.addClass(document.getElementById("marker-header"),"hide"),l.Util.headerAutoHide()?l.Util.hasClass(document.getElementById("header"),"wrap__header--hide")||_.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE):l.Util.hasClass(document.getElementById("header"),"wrap__header--hide")||d(".wrap__header").addClass("wrap__header--hide")},this.endViewportScroll=function(e){if(b.default.isAnnotMode&&l.Util.removeClass(document.getElementById("marker-header"),"hide"),u.Page.updateFullscreenCloseBtn(_.docInfo),!l.Util.headerAutoHide())return d(".wrap__header").removeClass("wrap__header--hide"),void v.ScaleEvent.doScale(l.Util.isHtmlSkin(_.docInfo),l.Util.isUseAnnotation(_.docInfo));if(!e){var t=b.default.isAnnotMode||h.Thumbnail.THUMB_STATUS===h.THUMB_FLAG.on;_.eventObserver.mobileHeader.notify(t?s.ShowActionType.SHOW:s.ShowActionType.HIDE3SEC)}},this.setHeaderPagePosition=function(){var e=Math.round(document.documentElement.clientWidth/2/_.headerIconWidth*100);(!l.Util.isMobileMode()||l.Util.isTabletInCSS())&&e<100?document.getElementById("header-page").style.left=e/2+"%":document.getElementById("header-page").style.left=""}}return t.prototype.addScript=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,t.appendChild(n)},t.bgColorMode=r.darkScreen,t.callLaserClient=function(e,n){var i=n.content,o=i.page,r=i.axis,a=E.default.instance.getPageOrCurrentSheetRatio(o,!1),s=r.x*a,c=r.y*a,d=function(e){var t=document.getElementsByClassName("laser");Array.from(t).forEach((function(t){var n=l.Util.getIdxFromElmId(t.id,"laser_c");(e||o!=n)&&(t.style.visibility="hidden")}))};d(!1);var u=document.getElementById("laser_c"+o);if(!u){var h=e?document.getElementById("sheet"):document.getElementById("page-area"+o),f=document.createElement("div");f.id="laser_c"+o,f.className="laser";var p=document.createElement("div");p.className="laser2",f.appendChild(p);var m=document.createElement("div");m.className="laser3",p.appendChild(m),h.appendChild(f),u=f}var g=e?document.getElementById("cell-common"):document.getElementById("page"+o);u.style.visibility="visible",u.style.left=(g.offsetLeft+s-u.offsetWidth/2).toFixed(2)+"px",u.style.top=(c-u.offsetHeight/2).toFixed(2)+"px";clearTimeout(t.laserTimer),t.laserTimer=setTimeout((function(){d(!0)}),3e3)},t}();t.Head=_}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEARCH_DISPLAY=t.SEARCH_TYPE=void 0,function(e){e[e.NONE=0]="NONE",e[e.NEXT=1]="NEXT",e[e.PREV=2]="PREV"}(t.SEARCH_TYPE||(t.SEARCH_TYPE={})),function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE"}(t.SEARCH_DISPLAY||(t.SEARCH_DISPLAY={}))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.popUpPos=t.annotPos=t.getAnnotArea=t.enableEvent=t.disableEvent=void 0;var r=n(3),a=n(27),s=n(0),l=n(1),c=n(16),d=n(6),u=n(23),h=n(109),f=n(79),p=n(275),m=n(276),g=n(17),v=n(44),b=n(155),y=n(19),E=n(62),I=n(43),S=n(63),w=n(284),_=n(154);function T(e){var t=Array.prototype.slice.call(e);s.Util.addClasses(t,"disableEvent")}function x(e){var t=Array.prototype.slice.call(e);s.Util.removeClasses(t,"disableEvent")}t.disableEvent=T,t.enableEvent=x,t.getAnnotArea=function(e,t,n){var i=n?document.getElementById("cell-common"):document.getElementById("page"+t),o=n?document.getElementById("cell-common"):document.getElementById("page-area"+t),r=function(){return e?0:i.offsetLeft},a=function(){return e?0:o.offsetTop};return{left:r,right:function(){return r()+i.offsetWidth},top:a,bottom:function(){return a()+i.offsetHeight}}},t.annotPos=function(e,t,n,i,o,r,a,l){var c=o,d=r-e,u=a,h=l-t,f=n,p=i,m=n,g=i,v=function(){return s.Util.rangeVal(m,c,d)},b=function(){return s.Util.rangeVal(g,u,h)},y=function(){return f-v()},E=function(){return p-b()};return{getLeft:v,getTop:b,setPos:function(e,t){m-=e,g-=t},getMoveX:y,getMoveY:E,isMove:function(){return Math.abs(y())>5||Math.abs(E())>5}}},t.popUpPos=function(e,t,n,i,o,r){void 0===r&&(r=void 0);var a=s.Util.isCellSkin(i),d=a?0:document.getElementById("page-area"+o).offsetTop,u=document.getElementById("contents"),h=y.ScaleEvent.isSupportScale()&&!y.ScaleEvent.isDefaultBrowserScale(),f=s.Util.isMobileMode()&&l.Browser.instance.isIOS?Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop):u.scrollTop;if(void 0===r){r=function(){if(h){var t=s.Util.getInnerHeight(),n=e.obj.getBoundingClientRect(),i=n.top,o=n.height;l.Browser.instance.isIOS&&(i+=s.Util.getPageYOffset());var r=i+o;return i-s.Util.getPageYOffset()>=s.Util.getPageYOffset()+t-r}var a=u.offsetHeight,c=d+e.top-f;return c>=a-(c+e.height)}()}var p,m,g,v,b,E,I,S,w,_;return{isTopPos:r,left:(p=a?document.getElementById("sheet"):document.getElementById("page-area"+o),m=a?document.getElementById("cell-common"):document.getElementById("page"+o),g=s.Util.isMobileMode()&&l.Browser.instance.isIOS?document.scrollingElement.scrollLeft:u.scrollLeft,v=g+(h&&l.Browser.instance.isAndroid?s.Util.getPageXOffset():0),b=Math.min(p.clientWidth,s.Util.getInnerWidth()),E=Math.min(m.clientWidth,s.Util.getInnerWidth()),I=a||b-E<0?0:(b-E)/2,S=!h||l.Browser.instance.isAndroid&&a?e.left:e.obj.getBoundingClientRect().left+g,w=(h?0:I)+S+e.width/2-t/2,_=v+b,S+e.width<v||S>_?w:s.Util.rangeVal(w,v,_-t)),top:function(){var t=u.clientHeight,a=d+e.top,l=a+e.height,h=r?a-n:l+n;if(h<f||h-f>t)return f;var p=10*c.default.getAnnotRatio(o,s.Util.isCellSkin(i));return r?a-n-p:l+p}()}};var C=function(){function n(){var y=this;this.activeMarker=null,this.drawingTool=null,this.drawingTools={ink:null,square:null,memo:null,freetext:null,line:null,circle:null,arrowline:null},this.selectedType=void 0,this.annotCloseBtn=document.getElementById("annotation-close"),this.pencilBtn=document.getElementById("marker-pencil-btn"),this.squareBtn=document.getElementById("marker-square-btn"),this.memoBtn=document.getElementById("marker-memo-btn"),this.freetextBtn=document.getElementById("marker-freetext-btn"),this.shapesBtn=document.getElementById("marker-shapes-btn"),this.lineBtn=document.getElementById("marker-line-btn"),this.handBtn=document.getElementById("marker-hand-scroll-btn"),this.circleBtn=document.getElementById("marker-circle-btn"),this.arrowlineBtn=document.getElementById("marker-arrowline-btn"),this.cursorIcon="cursor-ie-icon",this.menuSelect="marker-menu--select",this.menuMoreProp="more-prop",this.subShapes=["square","line","circle","arrowline"],this.eraser=null,this.createDrawingTool=function(e){switch(e){case"square":y.drawingTools[e]=new h.DrawingSquare(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo));break;case"ink":y.drawingTools[e]=new f.DrawingInk(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo));break;case"memo":y.drawingTools[e]=new p.DrawingMemo(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo));break;case"freetext":y.drawingTools[e]=new m.DrawingFreetext(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo),y.marker.getAnnotationInfo);break;case"line":y.drawingTools[e]=new b.DrawingLine(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo),!1);break;case"circle":y.drawingTools[e]=new w.DrawingCircle(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo));break;case"arrowline":y.drawingTools[e]=new b.DrawingLine(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo),!0);break;default:y.drawingTools[e]=new f.DrawingInk(y.marker,y.eventObserver,y.markerAttr,y.saveDrawing,s.Util.isCellSkin(y.docInfo))}},this.getDrawingTool=function(e){return y.drawingTools[e]||y.createDrawingTool(e),y.drawingTools[e]},this.getCurMarkerSection=function(){return y.drawingTool&&y.drawingTool.getCurMarkerSection()},this.renderMarker=function(e,t,n){y.eraser&&S.DrawingEraser.isActive&&S.layerEventBind(y.eraser,n);var i=n.getElementsByClassName("marker-scale")[0],o=y.getDrawingTool(c.getAnnotType(t.annot)),r=d.default.createtMarkerId(e,t.id);document.getElementById(r)||y.createMarker(o,i,t.annot,e,t.id)},this.markerDragEventBind=function(e,n){var i=0,o=0,r=0,l=0,h=y.eventObserver,f=n.id,p=d.default.parseMarkerId(f),m=p.annotId,g=p.pageOrSheetIdx,v=s.Util.isCellSkin(y.docInfo),b=y.marker.getAnnotationInfo(g,m).annot,I=b&&c.getAnnotType(b),S=c.default.getAnnotRatio(g,v),w=t.getAnnotArea(!0,g,v),T=w.left,x=w.right,C=w.top,M=w.bottom,O=t.annotPos(parseFloat(b.w),parseFloat(b.h),parseFloat(b.l),parseFloat(b.t),T(),x()/S,C(),M()/S),B=0,A=!0;"square"!==I&&"freetext"!==I||(B=u.getHalfBorderSize(b.border)),e.call(a.drag().on("start",(function(){if(!E.MemoContent.isShow()){var e=y.marker.getAnnotationInfo(g,m).annot;r=a.event.x,l=a.event.y,O=t.annotPos(parseFloat(e.w),parseFloat(e.h),parseFloat(e.l),parseFloat(e.t),T(),x()/S,C(),M()/S),_.ResizingTool.hideControlPoint(n),A=s.Util.hasClass(document.getElementById("prop-submenu"),"hide"),h.dragAnnotStart.notify({elemId:f})}})).on("drag",(function(){if(!E.MemoContent.isShow()&&(i=r-a.event.x,o=l-a.event.y,r=a.event.x,l=a.event.y,O.setPos(i/S,o/S),O.isMove())){var e=O.getLeft()+B-u.DrawingTool.VIEWBOX_RANGE,t=O.getTop()+B-u.DrawingTool.VIEWBOX_RANGE;i&&(n.style.left=e+"px"),o&&(n.style.top=t+"px")}})).on("end",(function(){if(!E.MemoContent.isShow()){if(O.isMove()){var e=null,t=y.marker.getAnnotationInfo(g,m).annot;e="freetext"===I?{left:O.getLeft().toFixed(2),top:O.getTop().toFixed(2)}:{left:O.getLeft().toFixed(2),top:O.getTop().toFixed(2),path:y.getDrawingTool(I).moveMarker(t,O.getMoveX(),O.getMoveY())},y.eventObserver.modifyMarkerAttr.notify({elemId:f,attr:e})}else"freetext"===I&&(y.gotoInputModeForFreetext(),A=!0);h.dragAnnotEnd.notify({page:g,annotId:m,showPopup:A,showStyle:!A,ratio:S}),_.ResizingTool.showControlPoint(y.resizingTool,n,I,!1)}})).filter((function(e){return!("freetext"===I&&"true"!==n.lastElementChild.getAttribute("readonly"))})))},this.gotoInputModeForFreetext=function(){if(y.activeMarker instanceof HTMLDivElement&&y.activeMarker.lastElementChild){var e=y.activeMarker.lastElementChild;e.style.opacity="1",e.removeAttribute("readonly"),e.style.cursor="text",e.focus()}},this.markerInactive=function(){if(y.activeMarker){var e=d.default.parseMarkerId(y.activeMarker.id),t=e.pageOrSheetIdx,n=e.annotId,i=y.marker.getAnnotationInfo(t,n),o=i&&c.getAnnotType(i.annot);if(!(y.activeMarker instanceof HTMLDivElement&&"freetext"!==o)){var r=a.select(y.activeMarker);if(r.on(".drag",null),y.activeMarker instanceof HTMLDivElement&&"freetext"===o){var s=y.activeMarker.firstElementChild;r=a.select(s);var l=y.activeMarker.lastElementChild;l.setAttribute("readonly","true"),l.style.cursor="pointer"}r.classed("active",!1),r.on("mouseover",(function(){this.style.cursor="pointer"})),y.eventObserver.closeProp.notify(),y.styleMenu.setMarkerAttributes(y.markerAttr,y.hasFill()),y.hideShapeMenu(),_.ResizingTool.hideControlPoint(y.activeMarker),y.activeMarker=null}}},this.markerActiveEvent=function(e,t){if(y.activeMarker!==t){y.activeMarker=t;var n=d.default.parseMarkerId(y.activeMarker.id),i=n.pageOrSheetIdx,o=n.annotId,r=y.marker.getAnnotationInfo(i,o),s=r&&c.getAnnotType(r.annot);if(d.default.isAnnotMode&&"memo"!==s){_.ResizingTool.hasControlPoint(t)||_.ResizingTool.createControlPoint(t,s),_.ResizingTool.showControlPoint(y.resizingTool,t,s,!0),e.classed("active",!0),y.drawingTool=y.getDrawingTool(c.getAnnotType(r.annot)),y.selectedType=c.getAnnotType(r.annot);var l=y.drawingTool.getMarkerStyleAttr(r,c.default.DPI_RATIO);if(l.color=v.default.getRgbToColorType(l.color),l.innerColor&&(l.innerColor=v.default.getRgbToColorType(l.innerColor)),l.fontColor&&(l.fontColor=v.default.getRgbToColorType(l.fontColor)),y.styleMenu.setMarkerAttributes(l,y.hasFill()),e.on("mouseover",(function(){this.style.cursor="move"})),"freetext"===s){t.lastElementChild.style.cursor="move";var u=a.select(t);y.markerDragEventBind(u,t)}else y.markerDragEventBind(e,t)}}},this.markerInactiveEventBind=function(){var e=null;!l.Browser.instance.isMobile&&document.addEventListener("mousedown",(function(t){e=t.target}),!1),document.addEventListener(s.Util.getClickOrTouchEventName(),(function(t){var i=t.target,o="annotation-freetext"!==i.className&&e?e:i;e=null;if(!function(){for(var e in n.selectAnnotElm)if(s.Util.hasClassForEventTargetEl(o,e,n.selectAnnotElm[e]))return!0;return!1}()){if(o.id){var r=o.id;if("annotation-list-btn"===r||r.indexOf("annotation-memo")>-1)return;var a=o.className;if("string"==typeof a&&(a.indexOf("annotation-list-btn__img")>-1||a.indexOf("control-point")>-1))return}s.Util.hasClassForEventTargetEl(o,"prop-submenu",7)||y.eventObserver.unSelectAnnotation.notify()}}),!1)},this.createMarker=function(e,t,n,i,o){var r=d.default.createtMarkerId(i,o),a=e.createSvg(t,n,r);if("memo"!=c.getAnnotType(n)){if("freetext"!=c.getAnnotType(n)){var s=y.eventObserver;a.on("click",(function(){s.selectAnnotation.notify({page:i,annotId:o,showMemo:!1,showPopup:!0})})).on("mouseover",(function(){this.style.cursor="pointer"})).on("mouseout",(function(){this.style.cursor="auto"}))}}else a.remove()},this.disableScrollForMarkerDraw=function(){l.Browser.instance.isIOS12Lower()&&y.disableTouch(y.marker.MARKER_LAYER,y.marker.getPageIdxWhenInAnnotationMode())},this.disableTouch=function(e,t){if(void 0===t&&(t=0),l.Browser.instance.isMobile)for(var n=c.default.getAnnotLoadingRange(y.docInfo,t),i=n.startIdx,o=n.endIdx,r=i;r<o;r++){document.getElementById(""+e+r).addEventListener("touchmove",s.Util.disableEvent,s.Util.nonPassiveEventListenerOption)}},this.markerDrawEventBind=function(e){void 0===e&&(e=0);for(var t=c.default.getAnnotLoadingRange(y.docInfo,e),n=t.startIdx,i=t.endIdx,o=n;o<i;o++){var r=a.select(document.getElementById("marker-section"+o).getElementsByClassName("tmp-marker-svg")[0]);r.node()||(r=y.createTempSVG(document.getElementById("marker-section"+o))).node().addEventListener(s.Util.getClickStartEventName(),y.hideSubShapes),y.drawingTool.eventBind(r)}},this.setMarkerCursorInMarkerlayer=function(e){void 0===e&&(e=0);for(var t=c.default.getAnnotLoadingRange(y.docInfo,e),n=t.startIdx,i=t.endIdx,o=n;o<i;o++)s.Util.addClass(document.getElementById(""+y.marker.MARKER_LAYER+o),y.cursorIcon)},this.createTempSVG=function(e){return a.select("#"+e.id).append("svg").style("width",e.offsetWidth+"px").style("height",e.offsetHeight+"px").attr("class","tmp-marker-svg")},this.addAfterSave=function(e){var t=e.annot,n=y.getDrawingTool(c.getAnnotType(t.annot));if(n){var i=document.getElementById("marker-section"+e.page);if(i){var o=n.getCurMarkerSection();if(!0===e.rs.success){var a=s.Util.getParentElement(s.Util.getParentElement(i)).getElementsByClassName("marker-scale")[0];y.createMarker(n,a,t.annot,e.page,t.id)}for(var l=0,u=Array.prototype.slice.call(i.getElementsByClassName("tmp-marker-path"));l<u.length;l++){var h=u[l];r(h).remove()}(s.Util.isCellSkin(y.docInfo)||i===o)&&n.clear(),d.default.isDrawingMode||y.removeDrawingModeEvent(!0),!0===e.rs.success&&"freetext"==c.getAnnotType(t.annot)&&y.eventObserver.selectAnnotation.notify({page:e.page,annotId:t.id})}else s.Util.isCellSkin(y.docInfo)&&n.clear()}},this.callAddSave=function(e,t,n){var i=v.default.getTypeToHexColor(y.markerAttr.color),o="none"===v.default.getTypeToHexColor(y.markerAttr.innerColor)?"":v.default.getTypeToHexColor(y.markerAttr.innerColor),r=y.markerAttr.transparency,a=y.markerAttr.textAlign,s=y.markerAttr.fontSize,l=y.markerAttr.fontColor,c=y.drawingTool.createAnnotInfo(void 0,i,o,r.toString(),t,n,l,a,s),u={status:d.ANNOT_STATUS_TYPE.ADD,page:e,annot:c,afterFunc:y.addAfterSave,isUndoRedo:!1};y.eventObserver.saveAnnotationServer.notify(u)},this.hasSaveAnnot=function(){if(!y.drawingTool)return!1;var e=y.drawingTool.getCurMarkerSection();return!!e&&0!==e.getElementsByClassName("tmp-marker-path").length},this.drawMarkerInAnnotationlayer=function(){if(y.hasSaveAnnot()){var e=y.drawingTool.getCurMarkerSection(),t=e.getElementsByClassName("tmp-marker-path")[0],n=s.Util.getParentElement(s.Util.getParentElement(e)).getElementsByClassName("marker-scale")[0],i=s.Util.getParentElement(s.Util.getParentElement(e)).getElementsByClassName("annotationlayer")[0];n||(n=y.marker.appendMarkerScaleElm(i));var o=s.Util.getIdxFromElmId(i.id,"annotationlayer"),r=c.default.getAnnotRatio(o,s.Util.isCellSkin(y.docInfo));y.callAddSave(o,t,r)}},this.gotoDrawingMode=function(){r(".markerlayer").css("z-index",17),d.default.isDrawingMode&&null!==y.getCurMarkerSection()&&(y.eventObserver.editedAnnotation.notify(y.marker.getPageIdxWhenInAnnotationMode()),y.saveDrawing()),y.markerDrawEventBind(y.marker.getPageIdxWhenInAnnotationMode()),l.Browser.instance.isMobile||y.setMarkerCursorInMarkerlayer(y.marker.getPageIdxWhenInAnnotationMode()),d.default.isDrawingMode=!0},this.saveDrawing=function(){c.default.EDITED_ANNOTAION&&y.drawMarkerInAnnotationlayer()},this.removeDrawingModeEvent=function(e){void 0===e&&(e=!1),!e&&r(".tmp-marker-svg").children().length>0||(r(".tmp-marker-svg").remove(),y.drawingTool=null)},this.outDrawingMode=function(){r(".markerlayer").css("z-index",""),r("."+y.cursorIcon).removeClass(""+y.cursorIcon),y.saveDrawing(),y.removeDrawingModeEvent(),d.default.isDrawingMode=!1},this.chkDrawingModeEvent=function(e){d.default.isDrawingMode?(y.drawingTool.getCurMarkerSection()&&y.saveDrawing(),y.drawingTool=y.getDrawingTool(e),y.markerDrawEventBind(y.marker.getPageIdxWhenInAnnotationMode())):(y.drawingTool=y.getDrawingTool(e),y.gotoDrawingMode())},this.addMarkerBtnCssSelect=function(e){s.Util.addClass(document.getElementById(e),y.menuSelect);var t=document.getElementById(e.replace("btn","block"));t&&(document.getElementById(e).offsetWidth!==t.offsetWidth&&(t.style.width=document.getElementById(e).offsetWidth+"px"),s.Util.addClass(t,y.menuMoreProp))},this.removeMarkerBtnCssSelect=function(e){s.Util.removeClass(document.getElementById(e),y.menuSelect);var t=e.replace("btn","block");s.Util.removeClass(document.getElementById(t),y.menuMoreProp)},this.setMarkerMenuSelect=function(e){var t=["select-annotation-btn","marker-pencil-btn","marker-shapes-btn","marker-memo-btn","marker-hand-scroll-btn","marker-freetext-btn"];for(var n in t){var i=t[n];y.removeMarkerBtnCssSelect(i)}y.eraser&&y.eraser.eventUnBind(),y.hideSubShapes(),y.addMarkerBtnCssSelect("marker-"+e+"-btn")},this.setMarkerSubShapesItemSelect=function(e){s.Util.addClass(y.shapesBtn,y.menuSelect);for(var t=document.getElementById("marker-menu__sub-shapes").children,n=0;n<t.length;++n){var i=t[n];y.removeMarkerBtnCssSelect(i.id)}y.addMarkerBtnCssSelect("marker-"+e+"-btn");var o=document.getElementById(y.shapesBtn.id+"__img");y.subShapes.forEach((function(e){o.classList.remove("marker-"+e+"-btn__img")})),o.classList.add("marker-"+e+"-btn__img")},this.markerTypeBtnClickEvent=function(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var i=document.getElementById("marker-"+e+"-btn");if(s.Util.hasClass(i,y.menuSelect))y.selectedType=e,n&&n(y.markerAttr,y.hasFill(),i);else{if(t&&t(e),y.eventObserver.closeProp.notify(),d.default.isMarkerLoading)return;var o="pencil"===e?"ink":e;y.chkDrawingModeEvent(o)}},this.markerShapesBtnEventBind=function(){s.Util.bindClickEvent(y.shapesBtn,(function(){var e=document.getElementById("marker-menu__sub-shapes");if(e.classList.contains("hide")&&y.setMarkerMenuSelect("shapes"),!e.classList.toggle("hide")){var t=document.getElementById(y.shapesBtn.id+"__img");y.subShapes.some((function(e){if(t.classList.contains("marker-"+e+"-btn__img"))return document.getElementById("marker-"+e+"-btn").click(),!0}))}}))},this.markerLineBtnEventBind=function(){s.Util.bindClickEvent(y.lineBtn,(function(){y.markerTypeBtnClickEvent("line",y.setMarkerSubShapesItemSelect,y.styleMenu.toggleStyleMenu)}))},this.markerSquareBtnEventBind=function(){s.Util.bindClickEvent(y.squareBtn,(function(){y.markerTypeBtnClickEvent("square",y.setMarkerSubShapesItemSelect,y.styleMenu.toggleStyleMenu)}))},this.markerPencilBtnEventBind=function(){s.Util.bindClickEvent(y.pencilBtn,(function(){y.markerTypeBtnClickEvent("pencil",y.setMarkerMenuSelect,y.styleMenu.toggleStyleMenu)}))},this.markerMemoBtnEventBind=function(){s.Util.bindClickEvent(y.memoBtn,(function(){y.markerTypeBtnClickEvent("memo",y.setMarkerMenuSelect)}))},this.markerFreetextBtnEventBind=function(){s.Util.bindClickEvent(y.freetextBtn,(function(){y.markerTypeBtnClickEvent("freetext",y.setMarkerMenuSelect,y.styleMenu.toggleStyleMenu)}))},this.markerCircleEventBind=function(){s.Util.bindClickEvent(y.circleBtn,(function(){y.markerTypeBtnClickEvent("circle",y.setMarkerSubShapesItemSelect,y.styleMenu.toggleStyleMenu)}))},this.markerArrowLineEventBind=function(){s.Util.bindClickEvent(y.arrowlineBtn,(function(){y.markerTypeBtnClickEvent("arrowline",y.setMarkerSubShapesItemSelect,y.styleMenu.toggleStyleMenu)}))},this.selectAnnot=function(){y.clickSelectBtn(),!d.default.isMarkerLoading&&y.outDrawingMode()},this.clickSelectBtn=function(){s.Util.addClass(document.getElementById("select-annotation-btn"),y.menuSelect),y.removeMarkerBtnCssSelect(y.pencilBtn.id),y.removeMarkerBtnCssSelect(y.freetextBtn.id),s.Util.removeClass(y.shapesBtn,y.menuSelect),s.Util.removeClass(y.memoBtn,y.menuSelect),s.Util.removeClass(y.handBtn,y.menuSelect),s.Util.removeClass(y.freetextBtn,y.menuSelect),y.eraser&&y.eraser.eventUnBind(),y.hideSubShapes(),y.disableScrollMode()},this.clickHandBtn=function(){s.Util.addClass(y.handBtn,y.menuSelect),y.removeMarkerBtnCssSelect(y.pencilBtn.id),s.Util.removeClass(y.shapesBtn,y.menuSelect),s.Util.removeClass(y.memoBtn,y.menuSelect),s.Util.removeClass(document.getElementById("select-annotation-btn"),y.menuSelect),y.eraser&&y.eraser.eventUnBind(),y.hideSubShapes()},this.hideShapeMenu=function(){(function(){try{var e=window.event.target.id;if(e&&(e.indexOf("marker-pencil")>-1||e.indexOf("marker-shapes")>-1||e.indexOf("marker-memo")>-1||e.indexOf("marker-freetext")>-1||e.indexOf("marker-hand-scroll-btn")>-1||e.indexOf("marker-eraser-btn")>-1))return!0}catch(e){console.log("event or target id undefined.")}return!1})()||y.clickSelectBtn()},this.hideSubShapes=function(){var e=document.getElementById("marker-menu__sub-shapes");s.Util.addClass(e,"hide"),Array.from(e.children).forEach((function(e){e.classList.remove(y.menuSelect),document.getElementById(""+e.id.replace("btn","block")).classList.remove(y.menuMoreProp)}))},this.markerSelectEvent=function(){y.hideShapeMenu(),y.hideSubShapes(),d.default.isMarkerLoading||(y.outDrawingMode(),y.disableScrollMode())},this.markerSelectEventBind=function(){var e=document.getElementById("select-annotation-btn");s.Util.removeClass(e,"hide"),s.Util.bindClickEvent(e,y.markerSelectEvent)},this.markerHandEventBind=function(){var e=y.handBtn;l.Browser.instance.isMobile?s.Util.bindClickEvent(e,(function(){y.clickHandBtn(),y.hideSubShapes(),d.default.isMarkerLoading||(y.outDrawingMode(),y.enableScrollMode())})):s.Util.addClass(e,"hide")},this.enableScrollMode=function(){d.default.isScrollMode=!0,l.Browser.instance.isMobile||s.Util.addClass(document.getElementById("contents-area"),"cursor-hand-icon"),T(document.getElementsByClassName("marker-scale")),T(document.getElementsByClassName("textLayer"))},this.disableScrollMode=function(){d.default.isScrollMode=!1,l.Browser.instance.isMobile||s.Util.removeClass(document.getElementById("contents-area"),"cursor-hand-icon"),x(document.getElementsByClassName("marker-scale")),x(document.getElementsByClassName("textLayer"))},this.handleMarkerActive=function(e){if(y.markerInactive(),void 0!==e){var t=d.default.createtMarkerId(e.page,e.annotId),n=a.select("svg#"+t),i=y.marker.getAnnotationInfo(e.page,e.annotId).annot.type,o=null;if("memo"==i)o=document.getElementById(I.MemoIcon.getMemoId(e.page,e.annotId));else if("freetext"==i){var r=(o=document.getElementById(d.default.createtMarkerId(e.page,e.annotId))).firstElementChild;n=a.select(r)}else o=n.node();y.markerActiveEvent(n,o)}},this.modifyMarkerAttr=function(e){var t=e.elemId,n=e.attr;if(t&&n){n.author&&(c.default.isAbleToEditAuthor()?y.markerAttr.author=n.author:delete n.author);var i=d.default.parseMarkerId(t),o=y.marker.getAnnotationInfo(i.pageOrSheetIdx,i.annotId),s=r.extend(!0,{},o),l=y.getDrawingTool(c.getAnnotType(o.annot));s=l.modifyAnnotInfo(s,n);var u={status:d.ANNOT_STATUS_TYPE.MODIFY,page:i.pageOrSheetIdx,annot:s,afterFunc:function(){var e="freetext"===c.getAnnotType(o.annot)?a.select("div#"+t):a.select("svg#"+t);e._groups[0][0]&&l.redrawAttr(e.node(),s)},isUndoRedo:!1};y.eventObserver.saveAnnotationServer.notify(u)}},this.markerStyleChangeEvent=function(e){var t,n,i,o,r=e.oldValue,a=e.newValue,s=e.attrName,l=e.setSelectedStyle;if(null!==y.getCurMarkerSection()&&y.saveDrawing(),l(),r!=a&&y.activeMarker){var u=void 0;u="thickness"===s?c.default.thicknessPxToAnnotDPI(Number(a)):"color"===s||"innerColor"===s?v.default.getTypeToHexColor(a):a;(t=d.default.parseMarkerId(y.activeMarker.id),n=t.annotId,i=t.pageOrSheetIdx,o=c.getAnnotType(y.marker.getAnnotationInfo(i,n).annot),y.getDrawingTool(o)).redrawAttrEl(y.activeMarker,""+s,""+u)}else y.markerAttr[s]=a},this.windowLeaveEvent=function(){var e=y.hasSaveAnnot;window.addEventListener("beforeunload",(function(t){e()&&(t.preventDefault(),t.returnValue=g.LocaleMessage.getMessage("leave_window_annot"))}))},this.applyMarkerAttr=function(e,t){void 0===t&&(t={});for(var n=0,i=Object.keys(t);n<i.length;n++){var o=i[n],r=t[o];"color"===o||"innerColor"===o||"fontColor"===o?"color"===o&&"type1"===r||!c.default.isValidColorType(r)||(e[o]=r):"thickness"===o?c.default.isValidThickness(r)&&(e[o]=r):"transparency"===o?c.default.isValidTransparency(r)&&(e[o]=r):"fontSize"===o?c.default.isValidFontSize(r)&&(e[o]=r):"textAlign"===o&&c.default.isValidTextAlign(r)&&(e[o]=r)}},this.initMarkerAttr=function(){var e={color:"type2",innerColor:"type1",thickness:3*c.default.DPI_RATIO,transparency:.5,author:"Guest",fontColor:"type12",textAlign:"left",fontSize:"12"},t=window.localSynap.config.markerStyle;t&&(t.transparency=(100-Number(t.transparency))/100,t.thickness=Number(t.thickness)*c.default.SERVER_DPI/96,this.applyMarkerAttr(e,t)),this.markerAttr=e},this.eventBind=function(e){y.markerInactiveEventBind(),y.markerShapesBtnEventBind(),y.markerLineBtnEventBind(),y.markerSquareBtnEventBind(),y.markerPencilBtnEventBind(),y.markerMemoBtnEventBind(),y.markerFreetextBtnEventBind(),y.markerSelectEventBind(),y.markerHandEventBind(),y.markerCircleEventBind(),y.markerArrowLineEventBind(),y.windowLeaveEvent(),y.eventObserver=e,y.eventObserver.selectAnnotation.subscribe(y.handleMarkerActive),y.eventObserver.selectAnnotation.subscribe(y.selectAnnot),y.eventObserver.unSelectAnnotation.subscribe(y.markerInactive),y.eventObserver.modifyMarkerAttr.subscribe(y.modifyMarkerAttr),y.eventObserver.changeMarkerStyle.subscribe(y.markerStyleChangeEvent),y.eventObserver.saveAnnotation.subscribe(y.saveDrawing)},this.load=function(t,n,r){return i(y,void 0,e,(function(){var e,i=this;return o(this,(function(o){return e=s.Util.isCellSkin(t),this.docInfo=t,this.marker=r,this.initMarkerAttr(),null!=c.default.loginId&&(this.markerAttr.author=c.default.loginId),this.styleMenu=new v.default(t,n,this.markerAttr),this.resizingTool=new _.ResizingTool(n,e),this.eventBind(n),l.Browser.instance.isIE||(this.eraser=new S.DrawingEraser(document.getElementById("marker-eraser-btn"),r,n,e),this.eraser.eventBind((function(){s.Util.removeClass(document.getElementById("select-annotation-btn"),i.menuSelect),i.removeMarkerBtnCssSelect(i.pencilBtn.id),s.Util.removeClass(i.shapesBtn,i.menuSelect),s.Util.removeClass(i.freetextBtn,i.menuSelect),s.Util.removeClass(i.memoBtn,i.menuSelect),s.Util.removeClass(i.handBtn,i.menuSelect),i.hideSubShapes(),i.outDrawingMode()}))),[2]}))}))}}return n.prototype.hasFill=function(){return"square"===this.selectedType||"circle"===this.selectedType||"freetext"===this.selectedType},n.selectAnnotElm={"annot-page-li":6,"memo-icon":1,"marker-svg":2,"annotation-popup":4,freetext:1,"annotation-freetext":2},n}();t.default=C}).call(this,n(4))},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DPI=void 0;var i=n(0),o=function(){function e(t){var n,o=this;this.ZOOM_TO_CHANGE_DPI=150,this.initDPI=function(){o.dpi=o.ORIGINAL_DPI,o.ratio=1},this.getDPI=function(){return o.dpi},this.isEqualDPI=function(e){return o.dpi==i.Util.getParameterFromURL(e).dpi},this.isHighDPI=function(){return o.dpi==o.HIGH_DPI},this.changeDPI=function(e){if(o.ORIGINAL_DPI==o.HIGH_DPI)return!1;var t=o.dpi;if(o.dpi!=o.HIGH_DPI&&e>=o.ZOOM_TO_CHANGE_DPI)t=o.HIGH_DPI,o.ratio=o.HIGH_DPI_RATIO;else{if(!(o.dpi==o.HIGH_DPI&&e<o.ZOOM_TO_CHANGE_DPI))return!1;t=o.ORIGINAL_DPI,o.ratio=1}return o.dpi=t,!0},this.hasHighDPIRatio=function(){return null!=o.HIGH_DPI_RATIO},this.setHighDPIRatio=function(e,t){o.HIGH_DPI_RATIO=parseFloat((t/e).toFixed(2))},this.getNewPath=function(e){var t=o.getParam(e);return i.Util.getThumbPath(o.docInfo,e.idx,o.dpi,t)},this.ORIGINAL_DPI=null!==(n=t.dpi)&&void 0!==n?n:i.Util.isServer(t)?e.normalDPI:96,this.initDPI(),this.docInfo=t;var r=Number(this.ORIGINAL_DPI),a=!isNaN(r)&&(r>96||r>=e.HIGH_SERVER_DPI);"H"===this.ORIGINAL_DPI||a?(this.HIGH_DPI=this.ORIGINAL_DPI,this.HIGH_DPI_RATIO=1):(this.HIGH_DPI="H",this.HIGH_DPI_RATIO=null)}return e.thumbDPI="L",e.normalDPI="M",e.highDPI="H",e.SERVER_DPI_LIST=[72,96,120,150,300],e.isValidDPI=function(t){return!!t&&(t!==e.normalDPI&&(t===e.thumbDPI||t===e.highDPI||!isNaN(t)))},e.initDPIFromServer=function(t){e.ORIGINAL_SERVER_DPI=t.serverDpi,e.HIGH_SERVER_DPI=e.ORIGINAL_SERVER_DPI;for(var n=0,i=e.SERVER_DPI_LIST;n<i.length;n++){var o=i[n];if(e.ORIGINAL_SERVER_DPI<o){e.HIGH_SERVER_DPI=o;break}}},e.getDPINumFromServer=function(t){return t===e.thumbDPI?18:t===e.normalDPI?e.ORIGINAL_SERVER_DPI:t===e.highDPI?e.HIGH_SERVER_DPI:-1},e.getServerDPIBasedRatio=function(t){var n=t.dpi;if(void 0===n)return"1";var i=isNaN(n)?e.getDPINumFromServer(n):n,o=e.ORIGINAL_SERVER_DPI;return void 0===o||i==o?"1":(i/o).toFixed(2)},e}();t.DPI=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoContent=void 0;var i=n(1),o=n(52),r=n(19),a=n(0),s=n(16),l=n(108),c=n(6),d=function(){function e(t){var n=this;this.memoCharLimit=512,this.contentWidth=300,this.contentHeight=200,this.cursorMoveKey=[o.keyMap.PAGEUP,o.keyMap.PAGEDOWN,o.keyMap.END,o.keyMap.HOME,o.keyMap.UPARROW,o.keyMap.DOWNARROW,o.keyMap.LEFTARROW,o.keyMap.RIGHTARROW],this.memoEl=document.getElementById("annotation-memo"),this.contentsEl=document.getElementById("annotation-memo__content"),this.backdropEl=document.getElementById("annotation-memo__backdrop"),this.highlightsEl=document.getElementById("annotation-memo__highlights"),this.authorInputEl=document.getElementById("annotation-memo__author-input"),this.saveMemo=null,this.focusContent=function(e,t,i){c.annotScrollMove(e.id,t,i),n.contentsEl.focus()},this.getPosition=function(e,t,o){var c=o?document.getElementById("cell-common"):document.getElementById("page-area"+t),d=o?document.getElementById("cell-common"):document.getElementById("page"+t),u=d.offsetLeft,h=d.offsetWidth,f=r.ScaleEvent.getBrowserScale(),p=c.offsetLeft,m=c.offsetTop,g=e.offsetLeft,v=e.offsetTop,b=e.offsetWidth,y=e.offsetHeight,E=n.contentWidth*f,I=n.contentHeight*f,S=s.default.getAnnotRatio(t,o),w=(v+y)*S+m,_=(g+b/2)*S+p+u-E/2,T=w+I,x=_+E,C=c.getBoundingClientRect(),M=C.width,O=C.left,B=document.getElementById("contents"),A=B.scrollTop,k=B.clientHeight,P=B.clientWidth,U=B.offsetWidth,L=function(){if(r.ScaleEvent.isSupportScale()){var e=a.Util.getPageXOffset(),t=a.Util.getPageXOffset()+a.Util.getInnerWidth();if(i.Browser.instance.isAndroid)e+=Math.abs(O),(t+=Math.abs(O))>Math.max(M,h)&&(t-=U-P);return[e,t]}return[Math.abs(O)-l.default.getAnnotListWidth(),Math.abs(O)+P]}(),N=L[0],R=L[1];_<N?_=N:x>R&&(_=Math.max(0,R-E));var F=0;return T>(F=i.Browser.instance.isIOS?Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)+window.innerHeight:A+k)&&(w=F-I),{top:w,left:_}},this.setPosition=function(e,t,i){var o=n.getPosition(e,t,i);n.memoEl.style.left=o.left+"px",n.memoEl.style.top=o.top+"px"},this.show=function(e,t,i,o,d){if(c.default.isAnnotMode?(n.enableEdit(),!s.default.isAbleToEditAuthor()&&n.disableEditAuthor()):n.disableEdit(),n.contentsEl.value=e.contents&&e.contents.text?e.contents.text:"",n.authorInputEl.value=e.contents&&e.contents.t?e.contents.t:"",n.authorInputEl.maxLength=128,n.contentsEl.setAttribute("data-memo-id",t.id),n.setPosition(t,i,o),n.showMemoContentCnt(),c.default.isAnnotMode&&l.default.searchText){var u=n.applyHighlights(n.contentsEl.value,l.default.searchText);n.highlightsEl.innerHTML=u}else n.clearHighlights();a.Util.removeClass(n.memoEl,"annotation-memo--hide"),r.ScaleEvent.scale(n.memoEl,"left top"),c.default.isAnnotMode&&r.ScaleEvent.disableiOSFocusScale(),d&&n.focusContent(t,i,o),n.backdropEl.scrollTop=n.contentsEl.scrollTop},this.hide=function(t){e.isShow()&&(c.default.isAnnotMode&&r.ScaleEvent.enableiOSFocusScale(),t&&n.saveMemo(),n.contentsEl.value="",n.authorInputEl.value="",n.contentsEl.removeAttribute("data-memo-id"),a.Util.addClass(n.memoEl,"annotation-memo--hide"),n.hideAuthorEdit())},this.enableEdit=function(){a.Util.removeClass(document.getElementById("annotation-memo__delete-btn"),"hide"),a.Util.removeClass(document.getElementById("annotation-memo__header"),"disable-pointer"),a.Util.removeClass(document.getElementById("annotation-memo__author-icon"),"disable-pointer"),a.Util.removeClass(n.contentsEl,"disable-pointer"),a.Util.removeClass(document.getElementById("annotation-memo__footer"),"disable-pointer"),a.Util.removeClass(n.authorInputEl,"disable-pointer"),n.contentsEl.readOnly=!1,n.authorInputEl.readOnly=!1},this.disableEdit=function(){a.Util.addClass(document.getElementById("annotation-memo__delete-btn"),"hide"),a.Util.addClass(document.getElementById("annotation-memo__header"),"disable-pointer"),a.Util.addClass(n.contentsEl,"disable-pointer"),a.Util.addClass(document.getElementById("annotation-memo__footer"),"disable-pointer"),n.contentsEl.readOnly=!0,n.disableEditAuthor()},this.disableEditAuthor=function(){a.Util.addClass(document.getElementById("annotation-memo__author-icon"),"disable-pointer"),a.Util.addClass(n.authorInputEl,"disable-pointer"),n.authorInputEl.readOnly=!0},this.showMemoContentCnt=function(e,t){void 0===e&&(e=0),void 0===t&&(t="");var o=n.contentsEl.value,r=o.length+e>-1?o.length+e:0,s=document.getElementById("annotation-memo__char-cnt");if(i.Browser.instance.isIOS){var l=o.split(/\r\n|\r|\n/g).length-1+(t.split(/\r\n|\r|\n/g).length-1);n.contentsEl.setAttribute("maxlength",(n.memoCharLimit+l).toString())}r>=n.memoCharLimit?(a.Util.addClass(s,"annotation-memo__char-cnt--limit"),r=n.memoCharLimit):a.Util.removeClass(s,"annotation-memo__char-cnt--limit"),s.innerText=r+" / "+n.memoCharLimit},this.pasteMemoContentCntEvent=function(e){try{var t=(e.clipboardData||window.clipboardData).getData("text");n.showMemoContentCnt(t.length,t)}catch(e){console.log("This browser is not support clipboardData")}},this.cutMemoContentCntEvent=function(){try{var e=window.getSelection().toString();n.showMemoContentCnt(-e.length,e)}catch(e){console.log("This browser is not support selection object")}},this.hideAuthorEdit=function(){var e=document.getElementById("annotation-memo__author-icon"),t=document.getElementById("annotation-memo__author-label");a.Util.removeClass(e,"annotation-memo__author-icon--edit"),a.Util.removeClass(t,"annotation-memo__author-label--edit"),a.Util.removeClass(n.authorInputEl,"annotation-memo__author-input--edit")},this.showAuthorEdit=function(){var e=document.getElementById("annotation-memo__author-icon"),t=document.getElementById("annotation-memo__author-label");a.Util.addClass(e,"annotation-memo__author-icon--edit"),a.Util.addClass(t,"annotation-memo__author-label--edit"),a.Util.addClass(n.authorInputEl,"annotation-memo__author-input--edit"),n.authorInputEl.focus()},this.getContentElem=function(){return n.contentsEl},a.Util.disableKeyEventForPageMove(this.memoEl);var d=document.getElementById("annotation-memo__author");d.addEventListener("click",(function(){c.default.isAnnotMode&&n.showAuthorEdit()})),d.addEventListener("focusout",(function(e){e.relatedTarget instanceof HTMLElement&&a.Util.hasClassForEventTargetEl(e.relatedTarget,"annotation-memo__author")||n.hideAuthorEdit()})),this.contentsEl.addEventListener("keyup",(function(e){-1===n.cursorMoveKey.indexOf(e.keyCode)&&n.clearHighlights(),n.showMemoContentCnt()})),this.contentsEl.addEventListener("paste",this.pasteMemoContentCntEvent),this.contentsEl.addEventListener("cut",this.cutMemoContentCntEvent),this.contentsEl.addEventListener("input",(function(){n.contentsEl.value.length>n.contentsEl.maxLength&&(n.contentsEl.value=n.contentsEl.value.slice(0,n.contentsEl.maxLength))})),this.contentsEl.addEventListener("scroll",(function(){n.backdropEl.scrollTop=n.contentsEl.scrollTop})),this.saveMemo=t}return e.prototype.applyHighlights=function(e,t){return e.replace(/\n$/g,"\n\n").replace(new RegExp(t,"gi"),"<mark>$&</mark>")},e.prototype.clearHighlights=function(){this.highlightsEl.innerHTML.length>0&&(this.highlightsEl.innerHTML="")},e.isShow=function(){return!a.Util.hasClass(document.getElementById("annotation-memo"),"annotation-memo--hide")},e}();t.MemoContent=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingEraser=t.layerEventBind=void 0;var i=n(0),o=n(16),r=n(55),a=n(79),s=n(23),l=n(6),c=n(3),d=n(1),u=n(277),h=n(43);t.layerEventBind=function(e,t){e.addEventListener(t)};var f=function(){var e=this;this.list=[],this.push=function(t){e.list.push(t)},this.pop=function(){return e.list.shift()},this.empty=function(){return 0===e.list.length},this.front=function(){return e.list.length>0?e.list[0]:null}},p=function(){function e(t,n,p,m){var g=this;this.elem=null,this.marker=null,this.eventObserver=null,this.isCell=!1,this.updateQueue=null,this.eraseUpdate=function(){if(!g.updateQueue.empty()){var e=g.updateQueue.pop();if(g.updateQueue.front()!==e){var t,n=document.getElementById(e),i=l.default.parseMarkerId(e),r=g.marker.getAnnotationInfo(i.pageOrSheetIdx,i.annotId),d=c.extend(!0,{},r),u=l.ANNOT_STATUS_TYPE.DELETE;if("ink"==o.getAnnotType(d.annot)){for(var f=d.annot,p="",m=0;m<n.children.length;m++)p+=n.children[m].getAttribute("d");(u=p.length?l.ANNOT_STATUS_TYPE.MODIFY:l.ANNOT_STATUS_TYPE.DELETE)==l.ANNOT_STATUS_TYPE.MODIFY&&(f.path.text=p,t=a.getInkSize(f.path.text,parseFloat(f.path.w),1),f.l=t.left,f.t=t.top,f.w=t.width,f.h=t.height)}var v={status:u,page:i.pageOrSheetIdx,annot:d,afterFunc:function(){if(u===l.ANNOT_STATUS_TYPE.MODIFY){var e=s.getViewBox(t.left,t.top,t.width,t.height,null);n.setAttribute("viewBox",e.left+" "+e.top+" "+e.width+" "+e.height),n.style.left=e.left+"px",n.style.top=e.top+"px",n.style.width=e.width+"px",n.style.height=e.height+"px";var o=h.MemoIcon.getMemoId(i.pageOrSheetIdx,i.annotId),r=document.getElementById(o);if(r){var a=h.MemoIcon.getPosition(d.annot,i.pageOrSheetIdx,g.isCell),c=a.top,f=a.left;r.style.left=f+"px",r.style.top=c+"px"}}},isUndoRedo:!1};g.eventObserver.saveAnnotationServer.notify(v)}}},this.eraseAddItem=function(t,n){g.updateQueue.push(t),n.remove(),setTimeout(g.eraseUpdate,e.updateTime)},this.eraseAnnot=function(t,n,r){var a=t,s=o.default.getAnnotRatio(i.Util.getIdxFromElmId(t.id,"annotationlayer"),n),l=function(t,n){return function(t,n){var i=e.eraserSize/2,o=function(t){return{type:"rect",value:{x:t.x-i,y:t.y-i,width:e.eraserSize,height:e.eraserSize}}}(n);return u.intersect(u.shape(t.tagName,function(){if("rect"===t.tagName)return{x:parseFloat(t.getAttribute("x")),y:parseFloat(t.getAttribute("y")),width:parseFloat(t.getAttribute("width")),height:parseFloat(t.getAttribute("height"))};if("path"===t.tagName){var e=t.getAttribute("d"),n=e.trim().split(" ");return 6===n.length&&n[1]===n[4]&&n[2]&&n[5]&&(e="M "+n[1]+" "+n[2]+" L "+(parseFloat(n[4])+1)+" "+(parseFloat(n[5])+2)),{d:e}}return"ellipse"===t.tagName?{cx:parseFloat(t.getAttribute("cx")),cy:parseFloat(t.getAttribute("cy")),rx:parseFloat(t.getAttribute("rx")),ry:parseFloat(t.getAttribute("ry"))}:{}}()),u.shape(o.type,o.value))}(n,t).points.length>0||function(e,t){var n=e.tagName;return("rect"===n||"ellipse"===n)&&e.isPointInFill(t)}(n,t)},c=function(e){var t=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,n=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,o=a.getElementsByClassName("marker-scale");if(o.length){var c=o[0].children;Array.from(c).forEach((function(e){var o=e,a=i.Util.containClassName(e,"freetext");if(a&&(o=e.firstElementChild),o instanceof SVGSVGElement){var c=function(e,t,n){var i=n.createSVGPoint();i.x=e,i.y=t;var o=i.matrixTransform(n.getScreenCTM().inverse());return(d.Browser.instance.isIOS||d.Browser.instance.isSafari||d.Browser.instance.isFirefox)&&(o.x=o.x/s,o.y=o.y/s),o}(t,n,o),u=e.id;Array.from(o.children).forEach((function(t){l(c,t)&&(a&&(e.lastElementChild.style.visibility="hidden"),r(u,t))}))}}))}};a.addEventListener(i.Util.getMoveEventName(),c);var h=function(){a.removeEventListener("mouseleave",f),a.removeEventListener(i.Util.getMoveEventName(),c)},f=function(){a.removeEventListener(i.Util.getClickEndEventName(),h),a.removeEventListener(i.Util.getMoveEventName(),c)};a.addEventListener(i.Util.getClickEndEventName(),h,{once:!0}),a.addEventListener("mouseleave",f,{once:!0})},this.erase=function(e){d.Browser.instance.isMobile&&e.preventDefault(),g.eraseAnnot(e.target,g.isCell,g.eraseAddItem)},this.addEventListener=function(e){i.Util.addClass(e,"cursor-eraser-icon"),e.addEventListener(i.Util.getClickStartEventName(),g.erase)},this.removeEventListener=function(e){i.Util.removeClass(e,"cursor-eraser-icon"),e.removeEventListener(i.Util.getClickStartEventName(),g.erase)},this.eventBind=function(t){i.Util.bindClickEvent(g.elem,(function(){t(),i.Util.addClass(g.elem,"marker-menu--select"),e.isActive=!0,r.disableEvent(document.getElementsByClassName("marker-scale")),r.disableEvent(document.getElementsByClassName("textLayer"));for(var n=document.getElementsByClassName("annotationlayer"),o=0;o<n.length;o++)g.addEventListener(n[o])}))},this.eventUnBind=function(){i.Util.removeClass(g.elem,"marker-menu--select"),e.isActive=!1,r.enableEvent(document.getElementsByClassName("marker-scale")),r.enableEvent(document.getElementsByClassName("textLayer"));for(var t=document.getElementsByClassName("annotationlayer"),n=0;n<t.length;n++)g.removeEventListener(t[n])},this.elem=t,i.Util.removeClass(this.elem,"hide"),this.marker=n,this.eventObserver=p,this.isCell=m,this.updateQueue=new f}return e.isActive=!1,e.eraserSize=14,e.updateTime=100,e}();t.DrawingEraser=p},,function(e,t,n){"use strict";(function(e,n){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayer=void 0;var r=function(){function e(e,t){this.docInfo=null,this.eventObserver=null,this.docInfo=e,this.eventObserver=t}return e.hasLocalStorage=function(){try{var e="has_Synap_LocalStorage_Test_Key";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}},e.getStorageId=function(e){return"synap_"+e},e.getLocalStorageText=function(t){var n=null;return(n=e.hasLocalStorage()?JSON.parse(localStorage.getItem(e.getStorageId(t))):e.loadedText)||(n={}),n},e.getLayerId=function(e){return"textLayer"+e},e.loadedText=null,e.setLocalStorageText=function(t,r){return i(void 0,void 0,void 0,(function(){var i;return o(this,(function(o){return i=n(e.getLocalStorageText(t),r),e.hasLocalStorage()?localStorage.setItem(e.getStorageId(t),JSON.stringify(i)):e.loadedText=i,[2]}))}))},e}();t.TextLayer=r}).call(this,n(4),n(77))},,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.MobileEvent=t.TOUCH_DISTANCE=t.EVENT_INTERVAL=t.VK_MODE=t.SWIPE_DIRECTION=void 0;var r,a,s,l,c=n(0),d=n(1),u=n(19),h=n(26),f=n(3),p=n(6),m=n(38),g=n(32);!function(e){e[e.UP=0]="UP",e[e.RIGHT=1]="RIGHT",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT"}(r=t.SWIPE_DIRECTION||(t.SWIPE_DIRECTION={})),function(e){e[e.active=0]="active",e[e.changeStatus=1]="changeStatus",e[e.deactive=2]="deactive"}(a=t.VK_MODE||(t.VK_MODE={})),function(e){e[e.SINGLE_TAP_INTERVAL=550]="SINGLE_TAP_INTERVAL",e[e.DOUBLE_TAP_INTERVAL=500]="DOUBLE_TAP_INTERVAL",e[e.SWIPE_INTERVAL=3e3]="SWIPE_INTERVAL",e[e.MULTI_TOUCH_INTERVAL=100]="MULTI_TOUCH_INTERVAL"}(s=t.EVENT_INTERVAL||(t.EVENT_INTERVAL={})),function(e){e[e.MOVE=5]="MOVE",e[e.DOUBLETAB=30]="DOUBLETAB",e[e.SWIPE=50]="SWIPE"}(l=t.TOUCH_DISTANCE||(t.TOUCH_DISTANCE={}));var v=function(){function t(){var n=this;this.docInfo=null,this.eventObserver=null,this.isGenTouchStart=!1,this.isGenTouchMove=!1,this.isGenMultiTouch=!1,this.touchInfo={type:null,x:-1,y:-1,time:0},this.doubleTapThreshold=l.DOUBLETAB,this.doubleTapInterval=s.DOUBLE_TAP_INTERVAL,this.singleTapInterval=s.SINGLE_TAP_INTERVAL,this.swipeThreshold=l.SWIPE,this.swipeInterval=s.SWIPE_INTERVAL,this.multiTouchInterval=s.MULTI_TOUCH_INTERVAL,this.ticking=!1,this.ticknum=0,this.DelayTickCount=20,this.stopScroll=!1,this.objThumbnail=document.getElementById("thumbnail"),this.objAnnotation=document.getElementById("annotation-list"),this.onTouchStart=function(e){p.default.isDrawingMode||(e.targetTouches.length>=2?n.isGenMultiTouch=!0:(n.isGenTouchStart=!0,n.startX=e.changedTouches[0].pageX,n.startY=e.changedTouches[0].pageY,n.startTime=e.timeStamp))},this.onTouchMove=function(e){p.default.isDrawingMode||(!n.isGenTouchStart||e.targetTouches.length>=2?n.isGenMultiTouch=!0:u.ScaleEvent.saveViewportStatus())},this.isTouchMove=function(e){return Math.abs(n.startX-e.changedTouches[0].pageX)>l.MOVE||Math.abs(n.startY-e.changedTouches[0].pageY)>l.MOVE},this.onTouchEnd=function(e){if(!p.default.isDrawingMode){if(n.isGenTouchMove=n.isTouchMove(e),u.ScaleEvent.saveViewportStatus(),n.isGenMultiTouch)return clearTimeout(n.multiTouchTimer),void(n.multiTouchTimer=setTimeout((function(){n.isGenMultiTouch=!1}),n.multiTouchInterval));n.isSwipeEvent(e)?"cell"!==n.docInfo.skinType&&c.Util.isFullScreen()&&h.Page.RESIZE_OBJ.type===h.RESIZE_TYPE.PageFit&&!c.Util.isHtmlWordSkin(n.docInfo)&&n.swipeEvent(e):n.isDoubleTapEvent(e)?n.doubleTapEvent(e):n.isSingleTapEvent()?n.singleTapEvent(e):n.touchInfo.type=null,n.isGenTouchStart=!1,n.isGenTouchMove=!1}},this.isSingleTapEvent=function(){return!n.touchInfo.type&&n.isGenTouchStart&&!n.isGenTouchMove&&!p.default.isAnnotMode},this.singleTapEvent=function(e){n.touchInfo.type="tap",n.touchInfo.x=e.changedTouches[0].pageX,n.touchInfo.y=e.changedTouches[0].pageY,n.touchInfo.time=e.timeStamp,n.singleTapTimer=setTimeout((function(){n.touchInfo.type=null,c.Util.isFullScreen()?n.eventObserver.fullscreenSingleTap.notify():n.eventObserver.singleTap.notify()}),n.singleTapInterval)},this.isDoubleTapEvent=function(e){return"tap"===n.touchInfo.type&&n.isGenTouchStart&&!n.isGenTouchMove&&e.timeStamp-n.touchInfo.time<=n.doubleTapInterval&&Math.abs(n.touchInfo.x-e.changedTouches[0].pageX)<=n.doubleTapThreshold&&Math.abs(n.touchInfo.y-e.changedTouches[0].pageY)<=n.doubleTapThreshold},this.doubleTapEvent=function(e){clearTimeout(n.singleTapTimer),n.touchInfo.type=null,n.eventObserver.doubleTap.notify(e),e.preventDefault(),e.stopImmediatePropagation()},this.isSwipeEvent=function(e){return!1!==(!n.touchInfo.type&&n.isGenTouchStart&&e.timeStamp-n.startTime<=n.swipeInterval)&&(n.distX=e.changedTouches[0].pageX-n.startX,n.distY=e.changedTouches[0].pageY-n.startY,n.dist=Math.sqrt(Math.pow(n.distX,2)+Math.pow(n.distY,2)),n.dist>=n.swipeThreshold)},this.swipeEvent=function(e){var t,i=180*Math.atan2(-n.distY,n.distX)/Math.PI;i>=45&&i<=135?t=r.UP:i<45&&i>-45?t=r.RIGHT:i<=-45&&i>=-135?t=r.DOWN:(i<-135&&i>=-180||i>135&&i<=180)&&(t=r.LEFT),n.eventObserver.swipe.notify(t),e.preventDefault(),e.stopImmediatePropagation()},this.scrollMove=function(e){if(u.ScaleEvent.isChangePageOffset())u.ScaleEvent.isChangePageOffset()&&n.eventObserver.startViewportScroll.notify(),n.ticknum=0;else{if(n.ticknum>n.DelayTickCount)return n.eventObserver.endViewportScroll.notify(e),u.ScaleEvent.saveViewportStatus(),void window.requestAnimationFrame((function(){n.ticknum=0,n.ticking=!1}));n.ticknum=n.ticknum+1}u.ScaleEvent.saveViewportStatus(),window.requestAnimationFrame((function(){n.scrollMove(e)}))},this.viewportScroll=function(){if(!n.ticking){var e=!1;!p.default.isAnnotMode&&c.Util.hasClass(document.getElementById("header"),"wrap__header--hide")&&g.Thumbnail.THUMB_STATUS===g.THUMB_FLAG.off&&(e=!0),n.ticking=!0,n.ticknum=0,u.ScaleEvent.isChangePageOffset()&&n.eventObserver.startViewportScroll.notify(),window.requestAnimationFrame((function(){n.scrollMove(e)}))}},this.thumbnailScrollStart=function(e){u.ScaleEvent.isDefaultBrowserScale()||(n.startX=e.changedTouches[0].pageX,n.startY=e.changedTouches[0].pageY,n.stopScroll=!1)},this.baseScrollMove=function(e,t){if(!u.ScaleEvent.isDefaultBrowserScale()){if(n.stopScroll)return e.preventDefault(),void e.stopPropagation();var i=t.scrollTop,o=t.scrollHeight,r=i<1&&n.startY<e.changedTouches[0].pageY,a=o-f(window).height()<=i&&n.startY>e.changedTouches[0].pageY;(r||a)&&(n.stopScroll=!1,e.preventDefault(),e.stopPropagation())}},this.thumbnailScrollMove=function(e){n.baseScrollMove(e,n.objThumbnail)},this.annotationScrollMove=function(e){n.baseScrollMove(e,n.objAnnotation)},this.disableScrollEvent=function(){n.eventObserver.mobileHeader.notify(m.ShowActionType.SHOW),u.ScaleEvent.disableScrollEvent()},this.enableScrollEvent=function(){p.default.isAnnotMode||n.eventObserver.mobileHeader.notify(m.ShowActionType.HIDE3SEC),u.ScaleEvent.enableScrollEvent()},this.disallowEvent=function(e){var t=e.target;return t.id.indexOf("pagelist")>-1||t.id.indexOf("mobileTablist")>-1||t.id.indexOf("more-submenu")>-1||c.Util.hasClassForEventTargetEl(t,"metabox",6)||c.Util.hasClassForEventTargetEl(t,"more-content",6)||(e.preventDefault(),e.stopPropagation()),!1},this.eventBind=function(){var e="cell"===n.docInfo.skinType?"contents":"contents-area",i=document.getElementById(e),o={passive:!d.Browser.instance.isIOS&&!u.ScaleEvent.isSupportScale()};if(i.addEventListener("touchstart",n.onTouchStart,o),i.addEventListener("touchmove",n.onTouchMove,o),i.addEventListener("touchend",n.onTouchEnd,o),d.Browser.instance.isSupportVisualViewport()&&window.visualViewport.addEventListener("scroll",n.viewportScroll,o),document.getElementById("modal").addEventListener("touchmove",n.disallowEvent,o),document.getElementById("loading-dimmed").addEventListener("touchmove",n.disallowEvent,o),!c.Util.isHtmlWordSkin(n.docInfo)&&d.Browser.instance.isIOS){var r="cell"!==n.docInfo.skinType?"page__input":"header-tablist__input",s="cell"!==n.docInfo.skinType?"select-arrow":"cell-select-arrow",l="cell"!==n.docInfo.skinType?"page__input":"header-tablist__select";document.getElementById(r).addEventListener("touchstart",n.disableScrollEvent,o),document.getElementById(s).addEventListener("touchstart",n.disableScrollEvent,o);var h=document.getElementById(l);h&&h.addEventListener("blur",n.enableScrollEvent,o);var p=document.getElementById("annotation-list__search__input");p.addEventListener("touchstart",n.disableScrollEvent,o),p.addEventListener("blur",n.enableScrollEvent,o)}if(d.Browser.instance.isAndroid){var m=document.getElementById("wrap__index");m.addEventListener("touchstart",n.thumbnailScrollStart,o),m.addEventListener("touchmove",n.thumbnailScrollMove,o);var g=document.getElementById("annotation-list");g.addEventListener("touchstart",n.thumbnailScrollStart,o),g.addEventListener("touchmove",n.annotationScrollMove,o),document.getElementById("header").addEventListener("touchmove",n.disallowEvent,o),document.getElementById("marker-header").addEventListener("touchmove",n.disallowEvent,o);var v=null;f(document.body).on("focus","textarea, input",(function(){clearTimeout(v),t.virtualKeyboardMode=a.changeStatus,v=setTimeout((function(){t.virtualKeyboardMode=a.active}),500)})).on("blur","textarea, input",(function(){t.virtualKeyboardMode=a.changeStatus,v=setTimeout((function(){t.virtualKeyboardMode=a.deactive}),500)}))}d.Browser.instance.isMobile&&f(window).on("orientationchange",(function(e){n.eventObserver.orientationchange.notify(e)}))},this.preventCopyForIos=function(){c.Util.addClass(document.getElementById("wrap"),"notAllowCopyForIOS"),d.Browser.instance.version>=9&&d.Browser.instance.version<13&&document.body.addEventListener("touchforcechange",n.preventTouchFor3DTouchIos,!1)},this.enableCopyForIos=function(){c.Util.removeClass(document.getElementById("wrap"),"notAllowCopyForIOS"),d.Browser.instance.version>=9&&d.Browser.instance.version<13&&document.body.removeEventListener("touchforcechange",n.preventTouchFor3DTouchIos,!1)},this.preventTouchFor3DTouchIos=function(e){e.changedTouches[0].force>=.1&&e.preventDefault()},this.annotMode=function(e){e?n.preventCopyForIos():n.enableCopyForIos()},this.load=function(t,r){return i(n,void 0,e,(function(){return o(this,(function(e){return this.docInfo=t,this.eventObserver=r,this.eventBind(),d.Browser.instance.isIOS&&(c.Util.allowCopy()?this.eventObserver.annotMode.subscribe(this.annotMode):this.preventCopyForIos()),[2]}))}))}}return t.virtualKeyboardMode=a.deactive,t}();t.MobileEvent=v}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingInk=t.getInkSize=void 0;var r,a=n(27),s=n(6),l=n(23),c=n(1),d=n(0),u=n(44),h=n(30),f=n(43),p=n(154);function m(e,t){var n=e,i=n.split("M").join("M ");n.indexOf("C")>-1&&(i=i.split("C").join(" C ")),n.indexOf("L")>-1&&(i=i.split("L").join(" L "));for(var o="",r=0,a=(i=i.split(",").join(" ")).trim().split(" ");r<a.length;r++){var s=a[r],l=parseFloat(parseFloat(s).toFixed(2));isNaN(l)||(s=(l/t).toFixed(2)),o+=s+" "}return o}function g(e,t,n){for(var i=[],o=[],r=!0,a=0,s=m(e,n).trim().split(" ");a<s.length;a++){var c=s[a],d=parseFloat(c);isNaN(d)||(r?(r=!1,i.push(d)):(r=!0,o.push(d)))}var u=Math.min.apply(null,i),h=Math.max.apply(null,i),f=Math.min.apply(null,o),p=Math.max.apply(null,o),g=t/n;return l.getAnnotSizeWithStroke(u,f,h-u,p-f,g)}!function(e){e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.MOVE_AND_STYLE=2]="MOVE_AND_STYLE"}(r||(r={})),t.getInkSize=g;var v=function(t){function n(n,i,o,v,b){var y=t.call(this,n,i,o,v,b)||this;return y.tempPath=null,y.reducePathRange=3,y.line=a.line().curve(a.curveCardinal).x((function(e){return e.x})).y((function(e){return e.y})),y.markerPath="",y.markerDrawTmp=function(e,t){var n=event;n.touches&&n.touches.length>1||(c.Browser.instance.isMobile?(t||2===y.reducePathRange)&&(y.reducePathRange=0,y._drawMarkerInTemp(a.mouse(e))):(t||3===y.reducePathRange)&&(y.reducePathRange=0,y._drawMarkerInTemp(a.mouse(e))),y.reducePathRange++)},y._drawMarkerInTemp=function(e){if(null!=y.newSvg){var t=y.line;y.tempPath.push({x:e[0],y:e[1]}),y.newSvg.attr("d",(function(e){return t(e)}))}},y.markerListen=function(e,t){var n=event;if(!(n.touches&&n.touches.length>1)){var i=e,o=d.Util.getParentElement(i._groups[0][0]).id,r=d.Util.getIdxFromElmId(o,"marker-section");s.default.isDrawingMode=!0,y.tempPath=[],y.newSvg=e.append("path").data([y.tempPath]).style("stroke",l.DrawingTool.hexToRgb(u.default.getTypeToHexColor(y.attr.color))).style("stroke-width",y.attr.thickness*h.default.instance.getRatioByOriginSize(r,y.isCell)).style("opacity",y.attr.transparency).style("fill","none").attr("d",y.line).attr("class","tmp-marker-path").attr("id","tmp-marker-path"),y.markerDrawTmp(t,!0),y.markerDrawBind(e,y.markerEnd,(function(){y.markerDrawTmp(t,!1)}))}},y.correctPath=function(e){var t=e;if(null!==e&&e.indexOf("Z")>-1){var n=e.replace("Z","").replace("M","");t="M"+n+"L"+n}return t},y.markerEnd=function(e,t){if(s.default.isDrawingMode){var n=event;if((!n.touches||0===n.touches.length)&&null!=y.tempPath&&0!==y.tempPath.length){e.on("mousemove",null),e.on("pointermove",null),e.on("touchmove",null);var i=d.Util.getTmpPathElem(t);if(i){var o=i.getAttribute("d");if(""!==o){d.Util.isDocslive()||y.getCurMarkerSection()&&y.getCurMarkerSection()!=d.Util.getParentElement(t)&&(y.funcSaveDrawing(),y.markerPath="");var r=y.correctPath(o);a.select(i).attr("d",r),y.tempPath=[],y.markerPath+=r+" ",y.curMarkerSection=d.Util.getParentElement(t),y.eventObserver.editedAnnotation.notify(y.marker.getPageIdxWhenInAnnotationMode()),d.Util.isDocslive()&&y.funcSaveDrawing()}}}}},y.markerEventBind=function(e,t){var n=y.markerListen,i=y.markerEnd;e.on(d.Util.getClickStartEventName(),(function(){t()&&n(e,this)})),e.on(d.Util.getClickEndEventName(),(function(){i(e,this)})),c.Browser.instance.isMobile||e.on("mouseleave pointerleave",(function(){i(e,this)}))},y.getAnnotSize=function(e,t){return g(y.markerPath,parseFloat(e.style.strokeWidth),t)},y.createSvg=function(e,t,n){for(var i=t,o=l.getViewBox(i.l,i.t,i.w,i.h,null),r=o.left,s=o.top,c=o.width,d=o.height,u=a.select(e).append("svg").attr("id",n).attr("class","marker-svg").attr("viewBox",r+" "+s+" "+c+" "+d).attr("focusable","false").style("left",r+"px").style("width",c+"px").style("top",s+"px").style("height",d+"px").style("stroke",l.DrawingTool.hexToRgb(l.getAnnotInfoColor(i.c))).style("stroke-width",l.getAnnotInfoStrokeWidth(i.path)).style("opacity",l.getAnnotInfoAlpha(i.a)),h=l.getPathList(l.getAnnotInfoPathText(i.path)),f=0;f<h.length;f++)u.append("path").attr("class","marker-svg__path").attr("d",""+h[f]);return u},y.createAnnotInfo=function(e,t,n,i,o,r){var a=y.createAnnotBaseInfo(e,t,i,o,r),s=(parseFloat(o.style.strokeWidth)/r).toFixed(2),l=m(y.markerPath,r),c=a.annot;return c.type="ink",c.path={w:s,text:l},a},y.setAnnotInfoThickness=function(e,t){var n=e.annot;n.path||(n.path={w:"",text:""}),n.path.w=t.toString();var i=g(n.path.text,Number(t),1);e.annot.l=i.left,e.annot.t=i.top,e.annot.w=i.width,e.annot.h=i.height},y.setAnnotInfoPath=function(e,t){var n=e.annot;n.path||(n.path={w:"",text:""}),n.path.text=t},y.redrawPath=function(t,n){var i=new Set;l.getPathList(n).forEach((function(e){i.add(e)}));for(var o=new e,s=d.Util.getChildren(t),c=0;c<s.length;c++)o.set(s[c].getAttribute("d"),s[c]);switch(i.size>o.size?r.ADD:i.size<o.size?r.REMOVE:r.MOVE_AND_STYLE){case r.ADD:var u=a.select(t);i.forEach((function(e){o.has(e)||u.append("path").attr("class","marker-svg__path").attr("d",""+e)}));break;case r.REMOVE:o.forEach((function(e,t){i.has(t)||d.Util.removeElem(e)}));break;case r.MOVE_AND_STYLE:var h=0;i.forEach((function(e){s[h++].setAttribute("d",e)}))}},y.redrawAttr=function(e,t){var n=t.annot;y.redrawMoveAttr(e,t);var i={};i.color=l.getAnnotInfoColor(n.c),i.thickness=l.getAnnotInfoStrokeWidth(n.path),i.transparency=l.getAnnotInfoAlpha(n.a),y.redrawPath(e,n.path.text),y.setSvgStyle(e,i)},y.redrawAttrEl=function(e,t,n){if("thickness"===t){for(var i=d.Util.getChildren(e),o="",r=0;r<i.length;r++)o+=i[r].getAttribute("d");var s=g(o,Number(n),1),c=l.getViewBox(s.left,s.top,s.width,s.height,null),u=c.left,h=c.top,m=c.width,v=c.height;a.select(e).attr("viewBox",u+" "+h+" "+m+" "+v).style("left",u+"px").style("top",h+"px").style("width",m+"px").style("height",v+"px"),f.MemoIcon.rePositionDependentMemo(e.id,parseFloat(h),parseFloat(u),parseFloat(s.height)),p.ResizingTool.updateControlPoint(e,"ink")}var b={};b[""+t]=n,y.setSvgStyle(e,b)},y.getMarkerStyleAttr=function(e,t){var n=e.annot,i=l.getAnnotInfoColor(n.c),o=l.getAnnotInfoStrokeWidth(n.path),r=l.getAnnotInfoAlpha(n.a);return{color:i,thickness:parseFloat(o)*t,transparency:parseFloat(r)}},y.clear=function(){y.newSvg=null,y.curMarkerSection=null,y.markerPath=""},y.moveMarker=function(e,t,n){var i=e.path.text;if(!i)return null;for(var o="",r=!0,a=0,s=i.trim().split(" ");a<s.length;a++){var l=s[a],c=parseFloat(l);if(!isNaN(c)){var d=r?t:n;r=!r,l=(c-d).toFixed(2)}l.length&&(o+=l+" ")}return o},y}return o(n,t),n}(l.DrawingTool);t.DrawingInk=v}).call(this,n(41))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Controlbar=t.ZOOM_TYPE=void 0;var i=n(0),o=n(3),r=n(33),a=n(6);!function(e){e[e.ZoomIn=0]="ZoomIn",e[e.ZoomOut=1]="ZoomOut",e[e.OriginSize=2]="OriginSize",e[e.PrintA4=3]="PrintA4"}(t.ZOOM_TYPE||(t.ZOOM_TYPE={}));var s=function(){function e(){var e=this;this.docInfo=null,this.eventObserver=null,this.controlbarId=null,this.fadeControlbar=function(){if(i.Util.isMobileMode()||i.Util.isFullScreen()||a.default.isAnnotMode||r.ImageSheet.sheetLoadFail)e.jsContents.off("mousemove"),e.jqControlbar.off("mousemove"),e.jqControlbar.hide();else{var t,n=function(n){clearTimeout(t),e.jqControlbar.stop(!0,!0).show();var i=n.target;(!i.parentElement||i.id!==e.controlbarId&&i.parentElement.id!==e.controlbarId)&&(t=setTimeout((function(){e.jqControlbar.fadeOut(1e3)}),e.controlbarFadeoutTimeout))};e.jsContents.on("mousemove",(function(e){return n(e)})),e.jqControlbar.on("mousemove",(function(e){return n(e)})),e.moveControlbar()}},this.moveControlbar=function(){if(!i.Util.isMobileMode()){!function(){if(void 0===window.localSynap.config.controllbarPosition||0==Object.keys(window.localSynap.config.controllbarPosition).length)e.jqControlbar.css("left",0),e.jqControlbar.css("left",o("#thumbnail").outerWidth()+o("#contents").width()/2-o("#"+e.controlbarId).outerWidth()/2);else{var t=!!window.localSynap.config.controllbarPosition.left,n=!!window.localSynap.config.controllbarPosition.right;t&&!n?e.jqControlbar.css({left:o("#thumbnail").outerWidth()+Number(window.localSynap.config.controllbarPosition.left.replace("px",""))}):!t&&n?e.jqControlbar.css({right:document.getElementById("contents").offsetWidth-document.getElementById("contents").clientWidth+Number(window.localSynap.config.controllbarPosition.right.replace("px",""))}):(e.jqControlbar.css("left",0),e.jqControlbar.css("left",o("#thumbnail").outerWidth()+o("#contents").width()/2-o("#"+e.controlbarId).outerWidth()/2));var i=!!window.localSynap.config.controllbarPosition.bottom,r=!!window.localSynap.config.controllbarPosition.top;i&&!r?e.jqControlbar.css({bottom:window.localSynap.config.controllbarPosition.bottom}):!i&&r&&e.jqControlbar.css({top:window.localSynap.config.controllbarPosition.top,bottom:"auto"})}}()}},this.resizeWindow=function(){setTimeout((function(){e.fadeControlbar()}),150)},this.fullscreen=function(){e.fadeControlbar()},this.annotMode=function(){e.fadeControlbar()},this.sheetMove=function(){r.ImageSheet.sheetLoadFail&&e.sheetFail(),e.fadeControlbar()},this.sheetFail=function(){e.jsContents.off("mousemove"),e.jqControlbar.hide()},this.eventBind=function(t){e.eventObserver=t,e.eventObserver.resizeWindow.subscribe(e.resizeWindow),e.eventObserver.fullScreen.subscribe(e.fullscreen),e.eventObserver.resizeContents.subscribe(e.moveControlbar),e.eventObserver.sheet.subscribe(e.sheetMove),e.eventObserver.annotMode.subscribe(e.annotMode),e.fadeControlbar()},this.load=function(t,n){e.docInfo=t,e.controlbarId="cell"===e.docInfo.skinType?"cell-controlbar":"page-controlbar",e.jqControlbar=o("#"+e.controlbarId);var a=window.localSynap.config.controllbarFadeoutTimeout;if(a&&(e.controlbarFadeoutTimeout=a),i.Util.isHtmlSkin(e.docInfo)&&e.hideControlbarBtn(),e.eventBind(n),"page-controlbar"===e.controlbarId){var s=e.jqControlbar.width();e.jqControlbar.css("min-width",s)}r.ImageSheet.sheetLoadFail&&e.sheetFail()},this.hideControlbarBtn=function(){o(".controlbar__seperator").hide(),o("#cell-zoomout").hide(),o("#cell-zoomin").hide(),o("#page-zoomout").hide(),o("#page-zoomin").hide(),o("#page-originsize").hide(),o("#page-pagewidthfit").hide(),o("#page-pagefit").hide(),o("#page-rotate").hide(),i.Util.addClass(document.getElementById("page-hand-scroll"),"hide"),i.Util.addClass(document.getElementById("cell-hand-scroll"),"hide")},this.jsContents=void 0===window.localSynap.config.controllbarPosition||0==Object.keys(window.localSynap.config.controllbarPosition).length?o("#contents"):o("#contents, #header"),this.controlbarFadeoutTimeout=3e3}return e.ZOOM_LIST=[25,50,100,150,200],e}();t.Controlbar=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MouseScroll=void 0;var i=n(63),o=n(6),r=n(1),a=n(0),s=function(){function e(){var e=this;this.desktopElem=null,this.mobileElem=null,this.active=!1,this.mouseOut=function(){e.active||(e.desktopElem&&a.Util.removeClass(e.desktopElem.elem,e.desktopElem.selector),e.mobileElem&&a.Util.removeClass(e.mobileElem.elem,e.mobileElem.selector))},this.toggle=function(){e.active=!e.active;var t=document.getElementById("mobile-controlbar-hand-scroll__btn").firstElementChild;e.active?(e.desktopElem&&a.Util.addClass(e.desktopElem.elem,e.desktopElem.selector),e.mobileElem&&(a.Util.addClass(e.mobileElem.elem,e.mobileElem.selector),a.Util.addClass(t,"mobile-controlbar-floating__btn__hand-scroll-img--on")),e.enableHandScroll()):(e.desktopElem&&a.Util.removeClass(e.desktopElem.elem,e.desktopElem.selector),e.mobileElem&&(a.Util.removeClass(e.mobileElem.elem,e.mobileElem.selector),a.Util.removeClass(t,"mobile-controlbar-floating__btn__hand-scroll-img--on")),e.disableHandScroll())}}return Object.defineProperty(e,"instance",{get:function(){return this.mouseScroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return this.active},enumerable:!1,configurable:!0}),e.prototype.bindDesktopControlbar=function(e){return this.desktopElem=e,this.toggle},e.prototype.bindMobileControlbar=function(e){return this.mobileElem=e,this.toggle},e.prototype.enableHandScroll=function(){document.getElementById("contents").style.cursor="grab",document.getElementById("contents").addEventListener(a.Util.getClickStartEventName(),this.handScroll)},e.prototype.disableHandScroll=function(){document.getElementById("contents").style.cursor="",document.getElementById("contents").removeEventListener(a.Util.getClickStartEventName(),this.handScroll)},e.prototype.handScroll=function(e){if(n=document.getElementsByClassName("active").length>0,s=e.target instanceof HTMLElement&&(null===(t=e.target.className)||void 0===t?void 0:t.indexOf("memo-icon"))>-1&&o.default.isAnnotMode,l=document.getElementsByClassName("memo-icon--on").length>0,c=a.Util.isFullScreen(),!(o.default.isDrawingMode||i.DrawingEraser.isActive||n||s||l||c)){var t,n,s,l,c,d=document.getElementById("contents"),u=e.clientX,h=e.clientY,f=d.scrollLeft,p=d.scrollTop,m=function(e){return e>20?2:e>15?1.8:e>10?1.5:e>5?1.2:1},g=function(e){var t=e.clientX-u,n=e.clientY-h;u=e.clientX,h=e.clientY,f-=t*m(Math.abs(t)),p-=n*m(Math.abs(n)),r.Browser.instance.isIE?(d.scrollLeft=f,d.scrollTop=p):d.scrollTo({left:f,top:p})};d.style.cursor="grabbing",d.addEventListener(a.Util.getMoveEventName(),g),a.Util.addEventListenerOnce(d,a.Util.getClickEndEventName(),(function(){d.style.cursor="grab",d.removeEventListener(a.Util.getMoveEventName(),g)})),a.Util.addEventListenerOnce(d,"mouseleave",(function(){d.style.cursor="grab",d.removeEventListener(a.Util.getMoveEventName(),g)}))}},e.mouseScroll=new e,e}();t.MouseScroll=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextSearch=void 0;var i=n(3),o=n(32),r=n(0),a=n(112),s=n(54),l=n(161),c=function(){function e(t,n){var o=this;this.docInfo=null,this.eventObserver=null,this.searchInput=null,this.searchEvent=function(){var t=i("#search__label"),n=null;o.searchInput.addEventListener("keydown",(function(e){clearTimeout(n),t.is(":visible")&&t.hide(),n=setTimeout((function(){"Enter"===e.key&&o.clearSearchResult()}),10)}));o.searchInput.addEventListener("input",(function(){t.is(":visible")&&t.hide(),o.searchInput.value.length>50&&(l.DialogFactory.instance.confirmDialog("input_limit_searchword","msg_submit",(function(){o.searchInput.focus(),l.DialogFactory.instance.remove()})),o.searchInput.value=o.searchInput.value.slice(0,50))})),o.searchInput.addEventListener("focus",(function(){i("#search__input").hasClass("search__input--notfound")&&(i("#search__input").removeClass("search__input--notfound"),i("#search__input").val("")),t.is(":visible")&&t.hide(),e.isSearching||(o.searchMoveBtnEnable("search-next"),o.searchMoveBtnEnable("search-prev"))})),o.searchInput.addEventListener("focusout",(function(){""==o.searchInput.value&&t.show()})),r.Util.disableKeyEventForPageMove(o.searchInput)},this.searchDisplay=function(e){e!=s.SEARCH_DISPLAY.HIDE?o.searchResultShow():o.searchResultHide()},this.searchMoveBtnDisable=function(e,t,n){void 0===n&&(n=!1),i("#"+e+"__img").addClass(e+"--disable"),i("#"+e).removeClass("search-control--hover"),i("#"+e).prop("disabled",!0),n?l.DialogFactory.instance.confirmDialog("empty-searchword"):t==s.SEARCH_TYPE.PREV?l.DialogFactory.instance.confirmDialog("none_prev_search"):l.DialogFactory.instance.confirmDialog("none_next_search")},this.searchMoveBtnEnable=function(e){i("#"+e+"__img").removeClass(e+"--disable"),i("#"+e).prop("disabled",!1)},this.disableMoveBtnDuringSearch=function(){["search-next","search-prev"].forEach((function(e){i("#"+e+"__img").addClass(e+"--disable"),i("#"+e).prop("disabled",!0)}))},this.enableMoveBtnAfterSearch=function(){["search-next","search-prev"].forEach((function(e){o.searchMoveBtnEnable(e)}))},this.docInfo=t,this.eventObserver=n,this.searchInput=document.getElementById("search__input"),this.searchEvent()}return e.prototype.loadSpinner=function(){if(!(document.getElementsByClassName("loading_spinner").length>0)){var e={lines:11,length:0,width:12,radius:30,scale:1.25,corners:.5,color:"#435c85",opacity:.25,rotate:0,direction:1,speed:1,trail:65,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:r.Util.isMobileMode()||o.Thumbnail.THUMB_STATUS==o.THUMB_FLAG.off?"50%":i("#thumbnail").outerWidth()+i("#contents").width()/2+"px",shadow:!1,hwaccel:!1,position:"fixed"},t=document.createElement("div");t.setAttribute("class","inner loading_spinner "),document.getElementById("contents").appendChild(t),new a(e).spin(t)}},e.prototype.removeSpinner=function(){setTimeout((function(){i(".loading_spinner").remove()}),50)},e.isSearching=!1,e.cachedSearchCount=0,e}();t.TextSearch=c},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Init=t.CS_TYPE=t.PRODUCT_TYPE=t.CONV_TYPE=t.__SERVICE_VERSION__=t.__SERVICE_TYPE__=void 0;var r=n(16),a=n(0),s=n(1),l=n(17),c=n(299),d=n(300),u=n(165),h=n(33),f=n(301),p=n(53),m=n(164),g=n(52),v=n(78),b=n(302),y=n(80),E=n(303),I=n(113),S=n(170),w=n(54),_=n(3),T=n(51);n(307);var x=n(308),C=n(61);t.__SERVICE_TYPE__="viewer";var M,O,B;t.__SERVICE_VERSION__="v2019",function(e){e[e.HTML=0]="HTML",e[e.IMAGE=1]="IMAGE"}(M=t.CONV_TYPE||(t.CONV_TYPE={})),function(e){e[e.SERVER=0]="SERVER",e[e.MODULE=1]="MODULE"}(O=t.PRODUCT_TYPE||(t.PRODUCT_TYPE={})),function(e){e.SERVER="S",e.CLIENT="C"}(B=t.CS_TYPE||(t.CS_TYPE={}));var A=function(t){var n=this;this.docInfo={properties:{}},this.passTryCnt=0,this.skinType={xls:"cell",xlsx:"cell",xlsb:"cell",csv:"cell",nxls:"cell",ppt:"slide",pptx:"slide",nppt:"slide",doc:"word",docx:"word",ndoc:"word",hwp2k:"word",hwp97:"word",hwx:"word",hwpx:"word",txt:"word",text:"word",hwpml:"word",jpeg:"image",jpg:"image",png:"image",tiff:"image",gif:"image",bmp:"image",webp:"image",jpeg2k:"image",mhtml:"image",html:"image",msg:"image",eml:"image",pdf:"pdf",odt:"word",xmldart:"word"},this.defaultConfig={ZOOM_LIST:[],isShowTitle:!1,isShowHeader:!0,headerAutoHide:!0,isShowInfo:!0,companyName:"",preventPrint:!1,isShowPrint:!1,isShowPrintForCell:!1,isShowPdfPrint:!1,allowCopy:!0,sheetMinSize:[],extraParam:{},extraHeader:{},loadErrorHandler:function(e){return""},contextPath:"/SynapDocViewServer",showThumbnail:!1,showThumbnailMobile:!1,isShowSns:!1,kakaoAPIKey:"",controllbarFadeoutTimeout:3e3,controllbarPosition:{},loadingPageFitType:0,loadingPageFitTypeForMobile:0,thumbnailExt:"",search:!1,useAnnotation:!1,removeContentsAreaTooltip:!0,rotatePdf:!1,fixedPageFit:!1,loadingRangeType:0,markerStyle:{}},this.doAfterGetStatusForIMAGEServer=function(e,t){var i={properties:{}};return i.jobId=n.id,i.contextPath=n.contextPath,i.title=e.fileName,i.downloadUrl=e.downloadUrl,i.status=e,i.serverDpi=e.dpi,i.dpi=C.DPI.isValidDPI(t.dpi)?t.dpi:i.serverDpi,n.setCommonDocInfo(i,e),i.productType=O.SERVER,i.metadata=e.metadata,i},this.doAfterGetStatusForHTMLServer=function(e,t){return i(n,void 0,void 0,(function(){var n,i,r;return o(this,(function(o){switch(o.label){case 0:return 0!==e.htmlErrCode?[2,this.doAfterGetStatusForIMAGEServer(e,t)]:(n=this.contextPath+"/xml/"+this.id,[4,a.Util.getXml(n)]);case 1:return i=o.sent(),(r=this.doAfterGetStatusForHTML(i)).contextPath=this.contextPath,r.resultPath=this.contextPath+"/result/"+r.status.resultFileName,r.title=e.fileName,r.downloadUrl=e.downloadUrl,r.productType=O.SERVER,[2,r]}}))}))},this.setCommonDocInfo=function(e,t){null===t.format?e.fileType="docx":e.fileType=t.format.toLowerCase();var i=e.fileType;e.skinType=n.skinType[i],"cell"!==e.skinType?e.currentPage=0:e.currentSheet=0},this.doAfterGetStatusForHTML=function(e){var t={properties:{}};if(t.jobId=n.id,t.resultPath=n.contextPath,t.title=e.index.doc_title?e.index.doc_title:n.id,t.downloadUrl=e.index.downUrl,e.format=e.index.file_type,t.status={convertType:M.HTML,single:"true"===e.index.use_single_page,fileName:e.index.file_name,format:e.index.file_type,htmlConverting:!0,htmlDone:!0,pageNum:0,imgDone:!1,resultFileName:e.index.file_name,width:e.index.width,height:e.index.height},n.setCommonDocInfo(t,e),"cell"===t.skinType||"csv"===t.skinType?t.status.pageNum=parseInt(e.index.sheet_cnt):"slide"===t.skinType?t.status.pageNum=parseInt(e.index.slide_cnt):"pdf"===t.skinType?(t.status.startPageNum=1,t.status.pageNum=parseInt(e.index.pdf_cnt),1===window.localSynap.config.loadingRangeType&&(e.index.startPage&&(t.status.startPageNum=parseInt(e.index.startPage)),e.index.endPage&&(t.status.pageNum=parseInt(e.index.endPage)-t.status.startPageNum+1))):"image"===t.skinType?t.status.pageNum=parseInt(e.index.image_cnt):"word"===t.skinType&&(t.status.documentWidth=parseInt(e.index.width)),t.productType=O.MODULE,e.index.metadata_list){var i=0,o=[];_.each(e.index.metadata_list.metadata,(function(e,t){if(t.name){var n=[];n[0]=JSON.parse(t.name),n[1]={content:t.content},o[i]=n,i++}})),t.metadata=o}return t},this.sendPassword=function(t){return i(n,void 0,e,(function(){var e,n;return o(this,(function(i){switch(i.label){case 0:if(""===t)return T.default.instance.passwordDialog("msg_input_password",this.sendPassword,this.cancelPassword),[2];T.default.instance.remove(),_("#contents").addClass("img-loading"),this.passTryCnt+=1,e=this.contextPath+"/passcode/"+this.id,(n={}).param={passcode:t},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,a.Util.postJson(e,n)];case 2:return i.sent(),_("#contents").removeClass("img-loading"),[4,this.load()];case 3:return i.sent(),[3,5];case 4:return i.sent(),_("#contents").removeClass("img-loading"),T.default.instance.openDocErrorDialog("help.erro_code.errorcode.255.desc1"),[3,5];case 5:return[2]}}))}))},this.cancelPassword=function(){T.default.instance.refreshDialog()},this.passwordProcess=function(){n.passTryCnt>0?T.default.instance.passwordDialog("msg_input_retry",n.sendPassword,n.cancelPassword):T.default.instance.passwordDialog(null,n.sendPassword,n.cancelPassword)},this.getArchiveFileList=function(){return i(n,void 0,e,(function(){var e;return o(this,(function(t){switch(t.label){case 0:e=this.contextPath+"/archiveFileList/"+this.id,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.Util.postJson(e)];case 2:return[2,t.sent()];case 3:return t.sent(),_("#contents").removeClass("img-loading"),T.default.instance.openDocErrorDialog("msg_archiveFile_convFail"),[2,null];case 4:return[2]}}))}))},this.zipProcess=function(e){return i(n,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.getArchiveFileList()];case 1:return(t=n.sent())&&(_("#contents").removeClass("img-loading"),new S.FileExplorer(t,this.docInfo.title,this.contextPath,this.id,this.docInfo.status.convertType,e).archiveFileViewDialog()),[2]}}))}))},this.errProcess=function(e,t){var i="";if(3!==e){if(2===e)i="help.erro_code.errorcode.2.desc1";else if(4===e)i="help.erro_code.errorcode.4.desc1";else if(9===e)i="help.erro_code.errorcode.3.desc1";else{if(21===e)return void n.zipProcess(t);if(22===e)i="help.error_code.errorcode.22.desc1";else if(101===e)i="help.erro_code.errorcode.101.desc1";else if(134===e||148===e)i="help.erro_code.errorcode.134.desc1";else if(254===e)i="help.erro_code.errorcode.254.desc1";else if(255===e)i="help.erro_code.errorcode.255.desc1";else{if(!window.localSynap||"function"!=typeof window.localSynap.loadErrorHandler)return void(location.href=a.Util.getUrlWithExtraParam(n.contextPath+"/exception?convLocale="+t));i=window.localSynap.loadErrorHandler(e)}}T.default.instance.openDocErrorDialog(i)}else n.passwordProcess()},this.initConfig=function(){for(var e in window.localSynap||(window.localSynap={}),window.localSynap.config||(window.localSynap.config={}),n.defaultConfig)void 0===window.localSynap.config[e]&&(window.localSynap.config[e]=n.defaultConfig[e])},this.initService=function(e){a.Util.setServiceVersion("v2019"),a.Util.setServiceType("viewer"),a.Util.isDocslive()?n.docInfo.cs=void 0!==e.cs&&e.cs.toUpperCase()===B.SERVER?B.SERVER:B.CLIENT:n.docInfo.cs=""},this.initUserInfo=function(){n.userInfo={login:!1,annotView:!1,annotEdit:!1,annotDownPdf:!1,annotSavePdf:!1,enablePrint:!a.Util.isServer(n.docInfo)||a.Util.isServer(n.docInfo)&&!a.Util.isSupportedVer2022()}},this.localSynapSetting=function(){var e=window.localSynap;e.getCurrentPage=function(){return a.Util.isCellSkin(n.docInfo)?n.docInfo.currentSheet+1:n.docInfo.currentPage+1},e.moveNext=function(){var t=e.getCurrentPage()-1;t<n.docInfo.status.pageNum-1&&(a.Util.isCellSkin(n.docInfo)?n.eventObserver.sheet.notify({sheetIdx:t+1}):n.eventObserver.page.notify({pageNum:t+1,isScroll:!1}))},e.movePrev=function(){var t=e.getCurrentPage()-1;t>0&&(a.Util.isCellSkin(n.docInfo)?n.eventObserver.sheet.notify({sheetIdx:t-1}):n.eventObserver.page.notify({pageNum:t-1,isScroll:!1}))},e.movePage=function(e){e>0&&e<=n.docInfo.status.pageNum&&(a.Util.isCellSkin(n.docInfo)?n.eventObserver.sheet.notify({sheetIdx:e-1}):n.eventObserver.page.notify({pageNum:e-1,isScroll:!1}))},e.search=function(e,t){var i=function(){e.length<=0||(_("#search-btn").trigger("click"),_("#search__input").val(e),n.eventObserver.searchNext.notify(w.SEARCH_TYPE.NEXT))},o=Number(t);o&&o>0&&o<=n.docInfo.status.pageNum?a.Util.isCellSkin(n.docInfo)?n.eventObserver.sheet.notify({sheetIdx:o-1}):n.eventObserver.page.notify({pageNum:o-1,isScroll:!1,callback:i}):i()},e.getPageSize=function(){return n.docInfo.status.pageNum},e.applyAnnot=function(e){n.eventObserver.applyAnnot.notify(e)},e.laser=function(e){p.Head.callLaserClient(a.Util.isCellSkin(n.docInfo),e)}},this.movePage=function(){window.localSynap.onMovePage&&a.Util.isFunction(window.localSynap.onMovePage)&&window.localSynap.onMovePage()},this.scroll=function(e){window.localSynap.onScroll&&a.Util.isFunction(window.localSynap.onScroll)&&window.localSynap.onScroll(e)},this.keyPress=function(e){window.localSynap.onKeyDown&&a.Util.isFunction(window.localSynap.onKeyDown)&&window.localSynap.onKeyDown(e)},this.saveAnnot=function(e){window.localSynap.onSaveAnnot&&a.Util.isFunction(window.localSynap.onSaveAnnot)&&window.localSynap.onSaveAnnot(e)},this.keyUp=function(e){window.localSynap.onKeyUp&&a.Util.isFunction(window.localSynap.onKeyUp)&&window.localSynap.onKeyUp(e)},this.moveLaser=function(e){window.localSynap.onMoveLaser&&a.Util.isFunction(window.localSynap.onMoveLaser)&&window.localSynap.onMoveLaser(e)},this.loadDocument=function(){var e=a.Util.isConvHtml(n.docInfo)&&("word"===n.docInfo.skinType||"cell"===n.docInfo.skinType||"slide"===n.docInfo.skinType);window.localSynap.onLoadBody&&a.Util.isFunction(window.localSynap.onLoadBody)&&!e&&window.localSynap.onLoadBody()},this.optionSettings=function(){var e=window.localSynap.config;e.ZOOM_LIST&&0!==e.ZOOM_LIST.length&&(y.Controlbar.ZOOM_LIST=e.ZOOM_LIST),e.preventPrint&&_("body").addClass("layout")},this.getConvLocale=function(e){return void 0===e.convLocale?"ko":e.convLocale},this.getAnnotToken=function(e){return void 0===e.annotToken?"":e.annotToken},this.isModuleType=function(e){return void 0===e.key},this.getContextPath=function(e){var t,i=n.isModuleType(e)?e.rs:e.contextPath;return!i&&void 0!==window.localSynap&&window.localSynap.config.contextPath&&(i=window.localSynap.config.contextPath.trim()),(t=i)&&t.length>1&&"/"===t[t.length-1]?i.substring(0,i.length-1):i},this.getInfoURL=function(e){return e.imageConverting?n.contextPath+"/status/"+e.key+".js":n.isModuleType(e)?n.getContextPath(e)+"/"+n.id+".xml":n.contextPath+"/status/"+e.key},this.getUserInfoFromServer=function(){return i(n,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e=this.docInfo.contextPath+"/user?"+a.Util.setAnnotQueryString(this.docInfo)+"&key="+this.docInfo.jobId,[4,a.Util.getJson(e)];case 1:return(t=n.sent()).success&&(this.userInfo=t.data),[2]}}))}))},this.load=function(){return i(n,void 0,e,(function(){var e,t,n,i,S,w,_,M,B,A,k,P,U,L,N,R;return o(this,(function(o){switch(o.label){case 0:return!(null===(R=null===window||void 0===window?void 0:window.CSS)||void 0===R?void 0:R.supports("selector(:focus-visible)"))&&a.Util.eventBindFocusOutline(),e=a.Util.getParameter(),this.id=this.isModuleType(e)?e.fn:e.key,this.contextPath=this.getContextPath(e),[4,l.LocaleMessage.setLocale(this.getConvLocale(e))];case 1:t=o.sent(),document.documentElement.setAttribute("lang",t),document.title=l.LocaleMessage.getMessage("view_title"),l.LocaleMessage.setLocaleMessage(),this.initConfig(),n=this.getInfoURL(e),i=!0,o.label=2;case 2:if(!i)return[3,16];o.label=3;case 3:return o.trys.push([3,14,,15]),this.isModuleType(e)?[4,a.Util.getXml(n)]:[3,5];case 4:return w=o.sent(),[3,7];case 5:return[4,a.Util.getJson(n)];case 6:w=o.sent(),o.label=7;case 7:return(S=w).imgDone?(this.docInfo=this.doAfterGetStatusForIMAGEServer(S,e),this.docInfo.status.imageConverting=!!e.imageConverting,this.docInfo.status.imageConverting&&(this.docInfo.productType=O.MODULE),this.docInfo.annotToken=this.getAnnotToken(e),i=!1,[3,13]):[3,8];case 8:return S.htmlDone?(_=this,[4,this.doAfterGetStatusForHTMLServer(S,e)]):[3,10];case 9:return _.docInfo=o.sent(),this.docInfo.annotToken=this.getAnnotToken(e),i=!1,[3,13];case 10:return S.index?(this.docInfo=this.doAfterGetStatusForHTML(S),i=!1,[3,13]):[3,11];case 11:return[4,a.Util.sleep(1e3)];case 12:o.sent(),o.label=13;case 13:return[3,15];case 14:return"403"===(M=o.sent()).message||"404"===M.message?T.default.instance.openDocErrorDialog("msg_exception_url_access_failed"):T.default.instance.openDocErrorDialog("help.erro_code.errorcode.255.desc1"),[2,!1];case 15:return[3,2];case 16:return this.docInfo.status.imgDone&&this.docInfo.status.imgErrCode>0?(this.errProcess(this.docInfo.status.imgErrCode,t),[2,!1]):this.docInfo.status.htmlDone&&this.docInfo.status.htmlErrCode>0?(this.errProcess(this.docInfo.status.htmlErrCode,t),[2,!1]):(s.Browser.instance.isIE||s.Browser.instance.isIOS13Lower())&&"webp"===this.docInfo.fileType?(T.default.instance.openDocErrorDialog("msg_browser_not_support_format"),[2,!1]):(this.initService(e),this.initUserInfo(),a.Util.isServer(this.docInfo)?[4,this.getUserInfoFromServer()]:[3,18]);case 17:o.sent(),o.label=18;case 18:return this.docInfo.enablePrint=this.userInfo.enablePrint,B=[],a.Util.isHtmlSkin(this.docInfo)?("word"===this.docInfo.skinType||a.Util.useSingle(this.docInfo)?B=[new p.Head,new E.Word,new m.Presentation,new g.KeyEvent,new v.MobileEvent,new b.WindowEvent]:"cell"===this.docInfo.skinType?B=[new f.HtmlSheet,new p.Head,new m.Presentation,new g.KeyEvent,new v.MobileEvent,new b.WindowEvent,new y.Controlbar]:"slide"===this.docInfo.skinType&&(B=s.Browser.instance.isMobile?[new p.Head,new I.Slide,new m.Presentation,new g.KeyEvent,new v.MobileEvent,new b.WindowEvent,new y.Controlbar]:[new p.Head,new d.default,new I.Slide,new m.Presentation,new g.KeyEvent,new v.MobileEvent,new b.WindowEvent,new y.Controlbar]),[3,22]):[3,19];case 19:return A=new r.default(this.userInfo),a.Util.isServer(this.docInfo)?(C.DPI.initDPIFromServer(this.docInfo),a.Util.isUseAnnotation(this.docInfo)?[4,A.getAnnotationInfosAllPagesFromServer(this.docInfo)]:[3,21]):[3,21];case 20:o.sent(),o.label=21;case 21:B="cell"===this.docInfo.skinType?[new h.ImageSheet,new p.Head,new m.Presentation,new g.KeyEvent,new v.MobileEvent,new b.WindowEvent,new y.Controlbar,new x.MobileControlbar,A]:[new p.Head,new u.ImagePage,new c.default,new m.Presentation,new g.KeyEvent,new v.MobileEvent,new b.WindowEvent,new y.Controlbar,new x.MobileControlbar,A],o.label=22;case 22:k=0,P=B,o.label=23;case 23:return k<P.length?(U=P[k]).constructor.name!==h.ImageSheet.name&&U.constructor.name!==u.ImagePage.name&&U.constructor.name!==r.default.name?[3,25]:[4,U.load(this.docInfo,this.eventObserver)]:[3,27];case 24:return o.sent(),[3,26];case 25:U.load(this.docInfo,this.eventObserver),o.label=26;case 26:return k++,[3,23];case 27:return this.eventObserver.initLoadAfter.notify(),a.Util.isHtmlSkin(this.docInfo)||"cell"===this.docInfo.skinType||(L=this.eventObserver.resizeWindow.observers,N=L[1],L.splice(1,1),L.splice(2,0,N)),this.localSynapSetting(),a.Util.isCellSkin(this.docInfo)?this.eventObserver.sheet.subscribe(this.movePage):this.eventObserver.page.subscribe(this.movePage),this.eventObserver.scroll.subscribe(this.scroll),this.eventObserver.keyPress.subscribe(this.keyPress),this.eventObserver.keyUp.subscribe(this.keyUp),a.Util.isDocslive()&&(this.eventObserver.saveAnnotCb.subscribe(this.saveAnnot),this.eventObserver.moveLaserCb.subscribe(this.moveLaser)),this.optionSettings(),this.loadDocument(),[2,!0]}}))}))},this.eventObserver=t};t.Init=A}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ANNOTLIST_FLAG=void 0;var i,o=n(0),r=n(16),a=n(17),s=n(6),l=n(23),c=n(1),d=n(43),u=n(19),h=n(161);!function(e){e[e.ON=0]="ON",e[e.OFF=1]="OFF"}(i=t.ANNOTLIST_FLAG||(t.ANNOTLIST_FLAG={}));var f=function(){function e(){var t=this;this.eventObserver=null,this.docInfo=null,this.statusBeforeMemo=i.OFF,this.funcgetAnnotationInfos=null,this.pageOrSheetStr=void 0,this.annotList_id="annotation-list",this.annotListItems_id="annotation-list__items",this.searchInputDiv_id="annotation-list__search",this.searchInput_id="annotation-list__search__input",this.searchResult_id="annotation-list__search-result",this.searchResultCnt_id="annotation-list__search-result__cnt",this.searchBtn_id="annotation-list__search_btn",this.annotListEl=document.getElementById(this.annotList_id),this.searchInputDiv=document.getElementById(this.searchInputDiv_id),this.annotListItemsEl=document.getElementById(this.annotListItems_id),this.searchInputEl=document.getElementById(this.searchInput_id),this.searchResultEl=document.getElementById(this.searchResult_id),this.searchResultCntEl=document.getElementById(this.searchResultCnt_id),this.annotListBtn=document.getElementById(this.annotList_id+"-btn"),this.menuSelect="marker-menu--select",this.activeClassName="annot-page-li-active",this.getAnnotPageId=function(e){return"annot-page"+e},this.getAnnotArrowBtnId=function(e){return"annot-page"+e+"-btn"},this.getAnnotPageUlId=function(e){return"annot-page"+e+"-ul"},this.getMarkerListId=function(e,t){return"annotli-"+e+"-"+t},this.getColorId=function(e,t){return"color-"+e+"-"+t},this.getAuthorId=function(e,t){return"author-"+e+"-"+t},this.getDateId=function(e,t){return"date-"+e+"-"+t},this.getNoteBtnId=function(e,t){return"noteBtn-"+e+"-"+t},this.getDelBtnId=function(e,t){return"delBtn-"+e+"-"+t},this.annotationListIsOn=function(){return!o.Util.containClassName(t.annotListEl,"hide")},this.annotListOn=function(n){void 0===n&&(n=!0),o.Util.removeClass(t.annotListEl,"hide"),o.Util.addClass(t.annotListBtn,t.menuSelect),n&&(e.STATUS=i.ON)},this.annotListOff=function(n){void 0===n&&(n=!0),o.Util.addClass(t.annotListEl,"hide"),o.Util.removeClass(t.annotListBtn,t.menuSelect),n&&(e.STATUS=i.OFF)},this.setColor=function(e,t){e.style.backgroundColor=l.DrawingTool.hexToRgb(l.getAnnotInfoColor(t))},this.setAuthor=function(e,n,i){document.getElementById(t.getAuthorId(e,n)).value=i&&i.t?i.t:""},this.setNoteIcon=function(e,n,i){var r,a="marker-memo-btn__img--list",s=t.getMarkerListId(e,n);i&&i.text&&i.text.length>0?(r=document.getElementById(s).getElementsByClassName(""+a)).length>0&&(o.Util.addClass(r.item(0),a+"--set"),o.Util.removeClass(r.item(0),""+a)):(r=document.getElementById(s).getElementsByClassName(a+"--set")).length>0&&(o.Util.addClass(r.item(0),""+a),o.Util.removeClass(r.item(0),a+"--set"))},this.createPageEl=function(e,n){var i=parseInt(e),r=document.createElement("div");r.id=t.getAnnotArrowBtnId(i),r.className="annot-page-btn annot-list-btn__img",o.Util.setTabIndex(r,t.annotListBtn.tabIndex),r.title=a.LocaleMessage.getMessage("annot-list-off");var s=document.createElement("div");s.className="annot-page-totalNum",s.innerText=String(n);var l=document.createElement("span");l.innerText=t.pageOrSheetStr+" "+(i+1).toString();var c=document.createElement("div");return c.className="annot-page-nav",c.appendChild(r),c.appendChild(l),c.appendChild(s),o.Util.bindClickEvent(c,(function(){o.Util.containClassName(document.getElementById(t.getAnnotPageUlId(i)),"hide")?(o.Util.removeClass(document.getElementById(t.getAnnotPageUlId(i)),"hide"),o.Util.removeClass(document.getElementById(t.getAnnotArrowBtnId(i)),"annot-list-btn__img--off"),r.title=a.LocaleMessage.getMessage("annot-list-off")):(o.Util.addClass(document.getElementById(t.getAnnotPageUlId(i)),"hide"),o.Util.addClass(document.getElementById(t.getAnnotArrowBtnId(i)),"annot-list-btn__img--off"),r.title=a.LocaleMessage.getMessage("annot-list-on"))})),c},this.getLocalMessage=function(e){return"ink"===e&&(e="pen"),a.LocaleMessage.getMessage(e)},this.toggleEditMode=function(e){var t=document.getElementById(e);return!!t&&(o.Util.containClassName(t,"annot-page-li-info-authorInput--readonly")?(o.Util.removeClass(t,"annot-page-li-info-authorInput--readonly"),t.readOnly=!1,t.focus()):(o.Util.addClass(t,"annot-page-li-info-authorInput--readonly"),t.readOnly=!0,c.Browser.instance.isIE&&(t.setSelectionRange(0,0),t.blur())),t.readOnly)},this.modifyAuthor=function(e){var n=document.getElementById(e);if(!n)return!1;var i=r.default.parseTextId(e),o=r.default.getAnnotData(t.funcgetAnnotationInfos(),i.pageNum,i.idx),a=o.annot.contents&&o.annot.contents.t?o.annot.contents.t:"";if(a===n.value)return!0;var s={author:a=n.value};return t.eventObserver.modifyMarkerAttr.notify({elemId:e,attr:s}),!0},this.getTimeStr=function(e){if(!e||!e.d)return"";var t=e.d;return t.substr(2,4)+"/"+t.substr(6,2)+"/"+t.substr(8,2)+" "+t.substr(10,2)+":"+t.substr(12,2)+":"+t.substr(14,2)},this.createAnnotInfo=function(e,n,i){var s=document.createElement("div");s.className="tb";var l=document.createElement("div");l.className="tc annot-page-li-info-color",l.id=t.getColorId(n,i),t.setColor(l,e.c);var c=document.createElement("div");c.className="tc annot-page-li-info-type",c.innerText=t.getLocalMessage(r.getAnnotType(e));var d=document.createElement("div");d.appendChild(l),d.appendChild(c),s.appendChild(d);var u=e.contents&&e.contents.t?e.contents.t:"",h=t.getAuthorId(n,i),f=document.createElement("input");f.className="annot-page-li-info-authorInput annot-page-li-info-authorInput--readonly",f.type="text",f.id=h,f.value=u,f.maxLength=128,f.readOnly=!0,f.title=a.LocaleMessage.getMessage("author"),f.tabIndex=-1;var p=document.createElement("label");p.className="hide",p.setAttribute("for",h),p.innerText=a.LocaleMessage.getMessage("author"),f.addEventListener("keydown",(function(e){13==e.keyCode&&f.blur()})),f.addEventListener("blur",(function(e){var n=e.target;!n.readOnly&&t.modifyAuthor(n.id)&&t.toggleEditMode(n.id)})),o.Util.disableKeyEventForPageMove(f);var m=document.createElement("div");m.className="tc annot-page-li-info-author",m.appendChild(p);var g=function(){if(r.default.isAbleToEditAuthor()){var e=document.createElement("div");return e.className="author-modify-btn__img annot-page-li-info-authorEditBtn",e.title=a.LocaleMessage.getMessage("icon_author_edit"),e}}();g&&m.appendChild(g),m.appendChild(f);var v=document.createElement("div");if(v.className="annot-page-li-info-left annot-page-li-info-authorDiv",v.appendChild(m),s.appendChild(v),e.contents){var b=document.createElement("div");b.id=t.getDateId(n,i),b.className="annot-page-li-info-left",b.innerText=t.getTimeStr(e.contents),s.appendChild(b)}var y=document.createElement("div");return y.className="annot-page-li-info",y.appendChild(s),y},this.createAnnotBtnGroup=function(e,n){var i=document.createElement("div");e.contents&&e.contents.text&&e.contents.text.length>0?i.className="marker-memo-btn__img--list--set":i.className="marker-memo-btn__img--list";var r=s.default.parseMarkerId(n);i.title=a.LocaleMessage.getMessage("icon_memo");var l=document.createElement("div");l.id=t.getNoteBtnId(r.pageOrSheetIdx,r.annotId),l.className="annot-page-li-btnGroup-btn",l.title=a.LocaleMessage.getMessage("icon_memo"),l.addEventListener("click",(function(){t.selectAnnotListItem(String(r.pageOrSheetIdx),n,(function(){t.eventObserver.newMemo.notify({pageOrSheetIdx:r.pageOrSheetIdx,annotId:r.annotId})}))}),!1),l.appendChild(i);var c=document.createElement("div");c.className="marker-delete-btn__img marker-delete-btn",c.title=a.LocaleMessage.getMessage("icon_delete");var d=document.createElement("div");d.id=t.getDelBtnId(r.pageOrSheetIdx,r.annotId),d.className="annot-page-li-btnGroup-btn marker-delete-btn",d.title=a.LocaleMessage.getMessage("icon_delete"),d.addEventListener("click",(function(e){var n=e.target,i=n.id?n.id:o.Util.getParentElement(n).id;t.eventObserver.deleteMarker.notify(i)}),!1),d.appendChild(c);var u=document.createElement("div");return u.className="annot-page-li-btnGroup","freetext"===e.type&&(l.style.visibility="hidden"),u.appendChild(l),u.appendChild(d),u},this.removeSelectActive=function(){var e=document.getElementsByClassName(t.activeClassName);0!==e.length&&o.Util.removeClass(e.item(0),t.activeClassName)},this.selectAnnotation=function(e){if(t.removeSelectActive(),s.default.isAnnotMode&&e){var n=document.getElementById(t.getMarkerListId(e.page,e.annotId));if(n){if(t.annotationListIsOn()){var i=n.offsetTop+n.offsetHeight,r=t.annotListEl.scrollTop+t.annotListEl.offsetHeight,a=n.offsetTop<t.annotListEl.scrollTop?n.offsetTop-4:i<r?0:i+4-t.annotListEl.offsetHeight;a>0&&(t.annotListEl.scrollTop=a)}o.Util.addClass(n,t.activeClassName)}}},this.selectAnnotListItem=function(e,n,i){var r=o.Util.isCellSkin(t.docInfo),a=Number(e),l=function(){s.annotScrollMove(document.getElementById(n).getAttribute("data-id"),a,r),i()};(r?t.docInfo.currentSheet:t.docInfo.currentPage)!=a?r?t.eventObserver.sheet.notify({sheetIdx:a,afterFunc:l}):t.eventObserver.page.notify({pageNum:a,isScroll:!1,afterFunc:l}):l()},this.createAnnotElement=function(t,n){var i=this,a=document.createElement("li");a.className="annot-page-li";var l=this.getMarkerListId(n,t.id);a.id=l;a.setAttribute("data-id",function(e){return"memo"===r.getAnnotType(e.annot)?d.MemoIcon.getMemoId(n,e.id):s.default.createtMarkerId(Number(n),e.id)}(t));var c=t.annot;return o.Util.bindClickEvent(a,(function(e){var r=e.target;if(!o.Util.hasClassForEventTargetEl(r,"annot-page-li-btnGroup-btn",2)){var a="";if(o.Util.hasClassForEventTargetEl(r,"annot-page-li-info-authorEditBtn",2)){var s=e.target;a=s.nextElementSibling.id}i.selectAnnotListItem(n,l,(function(){if(i.eventObserver.selectAnnotation.notify({page:n,annotId:t.id,showMemo:!1,showPopup:!0}),a){o.Util.syncTimer((function(){i.toggleEditMode(a)&&i.modifyAuthor(a)}),100)}}))}}),!1),a.appendChild(this.createAnnotInfo(c,n,t.id)),a.appendChild(this.createAnnotBtnGroup(c,l)),o.Util.setTabIndex(a,this.annotListBtn.tabIndex),a.title=this.getLocalMessage(r.getAnnotType(c)),e.searchText&&!this.filterNoteWithSearch(c)&&o.Util.addClass(a,"hide"),a},this.createAnnotationList=function(e,n){var i=t.getAnnotPageUlId(parseInt(e)),o=document.getElementById(i);return o||((o=document.createElement("ul")).id=i,o.className="annot-page-ul"),n&&n.forEach((function(n){o.appendChild(t.createAnnotElement(n,e))})),o},this.createAnnotPage=function(e,n,i,o){var r=document.createElement("div");r.id=t.getAnnotPageId(parseInt(n)),r.className="annot-page",r.appendChild(t.createPageEl(n,o)),r.appendChild(t.createAnnotationList(n,i)),e.appendChild(r)},this.renderAnnotationList=function(){for(;t.annotListItemsEl.hasChildNodes();)t.annotListItemsEl.removeChild(t.annotListItemsEl.firstChild);for(var n=document.createDocumentFragment(),i=t.funcgetAnnotationInfos(),o=0,a=0,s=Object.keys(i);a<s.length;a++){var l=s[a],c=r.default.getAnnotInfoPerPage(i,parseInt(l));if(c){var d=c.length;0!=d&&(e.searchText?o+=t.notesToRender(c).length:o+=c.length,t.createAnnotPage(n,l,c,d))}}e.searchText?(t.showSearchResult(),t.searchResultCntEl.innerText=o.toString(10)):t.hideSearchResult(),n.hasChildNodes()?t.showSearchInput():(t.noneAnnotPage(n),t.hideSearchInput()),t.annotListItemsEl.appendChild(n)},this.loadAnnotList=function(){t.setTabIndex(),t.renderAnnotationList()},this.findBeforeElement=function(e){for(var n=parseInt(e)-1,i=null;n>=0;){var o=t.getAnnotPageId(n);if(i=document.getElementById(o))return i.nextSibling;n-=1}},this.addAnnotByDate=function(e,n,i){for(var o=n.lastElementChild.childNodes,a=t.createAnnotElement(e,i),l=o.length-1;l>=0;--l){var c=o.item(l),d=s.default.parseMarkerId(c.id),u=d.pageOrSheetIdx,h=d.annotId,f=r.default.getAnnotData(t.funcgetAnnotationInfos(),u,h);if(new Date(f.annot.contents&&f.annot.contents.d?parseInt(f.annot.contents.d.substr(2)):99999999999999)<=new Date(e.annot.contents&&e.annot.contents.d?parseInt(e.annot.contents.d.substr(2)):99999999999999))return void c.parentNode.insertBefore(a,c.nextSibling)}n.lastElementChild.insertBefore(a,n.lastElementChild.firstChild)},this.addAnnotList=function(e,n){var i=document.getElementById("annot-page-no");o.Util.removeElem(i),t.showSearchInput(),t.filterNote(e.annot)&&(t.searchResultCntEl.innerText=String(Number(t.searchResultCntEl.innerText)+1));var r=t.getAnnotPageId(parseInt(n)),a=document.getElementById(r);if(a){t.addAnnotByDate(e,a,n);var s=a.getElementsByClassName("annot-page-totalNum")[0],l=parseInt(s.innerText)+1;s.innerText=l.toString()}else{var c=document.createDocumentFragment();if(t.createAnnotPage(c,n,[e],1),c.hasChildNodes()){var d=t.findBeforeElement(n);if(d)d.parentNode.insertBefore(c,d);else{var u=document.getElementById(t.annotListItems_id);void 0!==d?u.appendChild(c):u.insertBefore(c,u.firstChild)}}}},this.modifyAnnotList=function(e,n){var i=parseInt(n),r=t.getAnnotPageId(i);if(document.getElementById(r)){var a=document.getElementById(t.getColorId(i,e.id));if(t.setColor(a,e.annot.c),t.setAuthor(i,e.id,e.annot.contents),t.setNoteIcon(i,e.id,e.annot.contents),!o.Util.hasClass(t.searchResultEl,"hide")){var s=document.getElementById(t.getMarkerListId(Number(n),e.id));t.filterNote(e.annot)?o.Util.hasClass(s,"hide")&&(o.Util.removeClass(s,"hide"),t.searchResultCntEl.innerText=String(Number(t.searchResultCntEl.innerText)+1)):o.Util.hasClass(s,"hide")||(o.Util.addClass(s,"hide"),t.searchResultCntEl.innerText=String(Number(t.searchResultCntEl.innerText)-1))}}},this.noneAnnotPage=function(e){var t=document.createElement("div");t.id="annot-page-no",t.className="annot-page";var n=document.createElement("div");n.className="annot-page-nav";var i=document.createElement("span");i.id="annot-no-msg",i.innerText=a.LocaleMessage.getMessage("annot-no-msg"),n.appendChild(i),t.appendChild(n),e.appendChild(t)},this.deleteAnnotList=function(e,n){var i=parseInt(n),r=t.getAnnotPageId(i),a=document.getElementById(r);if(a){var s=t.getMarkerListId(i,e.id),l=document.getElementById(s);o.Util.removeElem(l);var c=t.getAnnotPageUlId(i),d=document.getElementById(c);if(d){t.filterNote(e.annot)&&(t.searchResultCntEl.innerText=String(Number(t.searchResultCntEl.innerText)-1));var u=d.getElementsByTagName("li").length;if(0!==u){var h=a.getElementsByClassName("annot-page-totalNum");h.length>0&&(h[0].innerText=String(u))}else{o.Util.removeElem(a);var f=document.getElementById("annotation-list");if(0===f.getElementsByClassName("annot-page").length){var p=document.createDocumentFragment();t.noneAnnotPage(p),f.appendChild(p),t.hideSearchInput()}}}}},this.updateAnnotList=function(e){e.status===s.ANNOT_STATUS_TYPE.ADD?t.addAnnotList(e.annot,e.page.toString()):e.status===s.ANNOT_STATUS_TYPE.MODIFY?t.modifyAnnotList(e.annot,e.page.toString()):e.status===s.ANNOT_STATUS_TYPE.DELETE&&t.deleteAnnotList(e.annot,e.page.toString())},this.annotMode=function(){if(e.STATUS==i.ON){t.annotListOff(!0);var n=document.getElementById("contents");o.Util.removeClass(n,"wrap__contents--annot-on")}t.eventObserver.resizeContents.notify()},this.hideAnnotListInMobile=function(n){n?(t.statusBeforeMemo=e.STATUS,t.annotListOff(!1)):(t.statusBeforeMemo==i.ON&&t.annotListOn(!1),t.statusBeforeMemo=i.OFF)},this.resizeWindow=function(){if(o.Util.isMobileMode()||e.STATUS!=i.ON||t.annotationListIsOn()){if(o.Util.isMobileMode()){var n=u.ScaleEvent.getBrowserScale();u.ScaleEvent._doScaleSkinThumbsAndAnnot(o.Util.isUseAnnotation(t.docInfo),n)}}else t.annotListOn(!1)},this.startViewportScroll=function(){s.default.isAnnotMode&&e.STATUS===i.ON&&o.Util.addClass(document.getElementById("annotation-list"),"hide")},this.endViewportScroll=function(){s.default.isAnnotMode&&e.STATUS===i.ON&&o.Util.removeClass(document.getElementById("annotation-list"),"hide")},this.eventBind=function(e){t.eventObserver=e,t.eventObserver.annotMode.subscribe(t.annotMode),t.eventObserver.updateAnnotList.subscribe(t.updateAnnotList),t.eventObserver.hideAnnotListInMobile.subscribe(t.hideAnnotListInMobile),t.eventObserver.selectAnnotation.subscribe(t.selectAnnotation),t.eventObserver.unSelectAnnotation.subscribe(t.removeSelectActive),t.eventObserver.resizeWindow.subscribe(t.resizeWindow),c.Browser.instance.isSupportVisualViewport()&&(t.eventObserver.startViewportScroll.subscribe(t.startViewportScroll),t.eventObserver.endViewportScroll.subscribe(t.endViewportScroll)),t.searchEvent()},this.setTabIndex=function(){o.Util.setTabIndex(t.searchInputEl,t.annotListBtn.tabIndex),o.Util.setTabIndex(document.getElementById(t.searchBtn_id),t.annotListBtn.tabIndex)},this.load=function(e,n,i){t.docInfo=e,t.eventBind(n),t.funcgetAnnotationInfos=i,t.pageOrSheetStr=o.Util.isCellSkin(e)?a.LocaleMessage.getMessage("sheet"):a.LocaleMessage.getMessage("page")}}return e.prototype.showSearchInput=function(){o.Util.hasClass(this.searchInputDiv,"hide")&&o.Util.removeClass(this.searchInputDiv,"hide")},e.prototype.hideSearchInput=function(){o.Util.hasClass(this.searchInputDiv,"hide")||o.Util.addClass(this.searchInputDiv,"hide")},e.prototype.showSearchResult=function(){o.Util.hasClass(this.searchResultEl,"hide")&&(o.Util.removeClass(this.searchResultEl,"hide"),o.Util.addClass(this.searchInputDiv,"annotation-list__search--result"))},e.prototype.hideSearchResult=function(){o.Util.hasClass(this.searchResultEl,"hide")||(o.Util.addClass(this.searchResultEl,"hide"),o.Util.removeClass(this.searchInputDiv,"annotation-list__search--result"))},e.prototype.filterNoteWithSearch=function(t){var n;return"freetext"!==t.type&&(null===(n=t.contents.text)||void 0===n?void 0:n.toLowerCase().indexOf(e.searchText))>=0},e.prototype.filterNote=function(t){return e.searchText&&this.filterNoteWithSearch(t)},e.prototype.notesToRender=function(e){var t=this;return e.filter((function(e){return t.filterNote(e.annot)}))},e.prototype.searchAnnot=function(){var t;e.searchText=null===(t=this.searchInputEl.value)||void 0===t?void 0:t.toLocaleLowerCase(),this.renderAnnotationList()},e.prototype.searchEvent=function(){o.Util.disableKeyEventForPageMove(this.searchInputEl),o.Util.bindEnterKey(this.searchInputEl,this.searchAnnot.bind(this)),document.getElementById(this.searchBtn_id).addEventListener(o.Util.getClickOrTouchEventName(),this.searchAnnot.bind(this)),this.bindSearchMaxLength()},e.prototype.bindSearchMaxLength=function(){this.searchInputEl.addEventListener("input",(function(){var t=this;this.value.length<e.DEFAULT_SEARCH_LENGTH||(h.DialogFactory.instance.confirmDialog("input_limit_searchword","msg_submit",(function(){t.focus(),h.DialogFactory.instance.remove()})),this.value=this.value.slice(0,e.DEFAULT_SEARCH_LENGTH))}))},e.STATUS=i.OFF,e.searchText="",e.DEFAULT_SEARCH_LENGTH=50,e.STATUS_TOGGLE=function(){e.STATUS==i.OFF?e.STATUS=i.ON:e.STATUS=i.OFF},e.getAnnotListWidth=function(){var e=document.getElementById("annotation-list").getBoundingClientRect().width;return o.Util.isMobileMode()?0:e},e}();t.default=f},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingSquare=t.getRectAttribute=t.createRectSvg=void 0;var r=n(27),a=n(0),s=n(23),l=n(44),c=n(153),d=n(30);function u(e,t){var n=t,i=s.getViewBox(n.l,n.t,n.w,n.h,n.border),o=i.left,a=i.top,l=i.width,c=i.height,d=r.select(e).append("svg").attr("class","marker-svg").attr("viewBox",o+" "+a+" "+l+" "+c).style("left",o+"px").style("top",a+"px").style("width",l+"px").style("height",c+"px").attr("focusable","false"),u=s.getAnnotInfoStrokeWidth(n.border),f=h(n.l,n.t,n.w,n.h,u);return d.append("rect").attr("class","marker-svg__path").attr("x",""+f.x).attr("y",""+f.y).attr("width",""+f.width).attr("height",""+f.height).style("stroke",s.DrawingTool.hexToRgb(s.getAnnotInfoColor(n.c))).style("stroke-width",u).style("opacity",s.getAnnotInfoAlpha(n.a)).style("fill",s.DrawingTool.hexToRgb(s.getAnnotInfoInnerColor(n.ic))),d}function h(e,t,n,i,o){var r=Number(o);return{x:Number(e)+r,width:Number(n)-2*r,y:Number(t)+r,height:Number(i)-2*r}}t.createRectSvg=u,t.getRectAttribute=h;var f=function(e){function t(t,n,i,o,c){var f=e.call(this,t,n,i,o,c)||this;return f.markerStart=function(e,t){var n=event;if(!(n.touches&&n.touches.length>1)){var i=a.Util.getParentElement(e.node()).id,o=a.Util.getIdxFromElmId(i,"marker-section"),c=r.mouse(t),u=l.default.getTypeToHexColor(f.attr.innerColor);f.newSvg=e.append("rect").style("stroke",s.DrawingTool.hexToRgb(l.default.getTypeToHexColor(f.attr.color))).style("stroke-width",f.attr.thickness*d.default.instance.getRatioByOriginSize(o,f.isCell)).style("opacity",f.attr.transparency).style("fill","none"===u?"none":s.DrawingTool.hexToRgb(u)).attr("x",c[0]).attr("y",c[1]).attr("width",0).attr("height",0).attr("class","tmp-marker-path").attr("id","tmp-marker-path"),f.markerDrawBind(e,f.markerEnd,(function(){f.markerDrawTmp(t,c[0],c[1])}))}},f.markerDrawTmp=function(e,t,n){var i=r.mouse(e),o=Math.max(0,Math.abs(i[0]-t)),a=Math.max(0,Math.abs(i[1]-n));i[0]-t>=0&&i[1]-n>=0?f.newSvg.attr("width",o).attr("height",a):i[0]-t>=0&&i[1]-n<0?f.newSvg.attr("y",i[1]).attr("width",o).attr("height",a):i[0]-t<0&&i[1]-n>=0?f.newSvg.attr("x",i[0]).attr("width",o).attr("height",a):i[0]-t<0&&i[1]-n<0&&f.newSvg.attr("x",i[0]).attr("y",i[1]).attr("width",o).attr("height",a)},f.createSvg=function(e,t,n){return u(e,t).attr("id",n)},f.createAnnotInfo=function(e,t,n,i,o,r){var a=(parseFloat(o.style.strokeWidth)/r).toFixed(2),s=f.createAnnotBaseInfo(e,t,i,o,r),l=s.annot;return l.type="square",l.border={w:a},l.ic=n,s},f.redrawRectSvg=function(e,t){var n=t.annot,i=h(n.l,n.t,n.w,n.h,s.getAnnotInfoStrokeWidth(n.border));r.select(e).select("rect").attr("x",""+i.x).attr("y",""+i.y).attr("width",""+i.width).attr("height",""+i.height);var o=f.getFillshapeAttr(t);f.setSvgStyle(r.select(e).select("rect").node(),o)},f.redrawMoveAttr=function(e,t){var n=t.annot,i=s.getViewBox(n.l,n.t,n.w,n.h,n.border),o=i.left,a=i.top,l=i.width,c=i.height;r.select(e).attr("viewBox",o+" "+a+" "+l+" "+c).style("left",o+"px").style("top",a+"px").style("width",l+"px").style("height",c+"px")},f.redrawAttr=function(e,t){f.redrawMoveAttr(e,t),f.redrawRectSvg(e,t)},f.redrawAttrEl=function(e,t,n){var i={};i[""+t]=n;var o=r.select(e).select("rect");"thickness"===t&&f.setRectThickness(o,n),f.setSvgStyle(o.node(),i)},f.setRectThickness=function(e,t){var n=Number(t)-parseFloat(e.style("stroke-width"));e.attr("x",""+(Number(e.attr("x"))+n/2)).attr("y",""+(Number(e.attr("y"))+n/2)).attr("width",""+(Number(e.attr("width"))-n)).attr("height",""+(Number(e.attr("height"))-n))},f.getPosition=function(e){var t=e.getBBox();return{left:0===t.width&&0===t.x?parseInt(e.getAttribute("x")):t.x,top:0===t.height&&0===t.y?parseInt(e.getAttribute("y")):t.y}},f.getAnnotSizeWithStroke=function(e,t){return s.getAnnotSizeWithStroke(e.left,e.top,e.width,e.height,2*t)},f.setAnnotInfoThickness=function(e,t){var n=e.annot;n.border||(n.border={w:"",s:"",d:""});var i=Number(n.border.w)-t;n.border.w=t.toString(),n.l=""+(Number(n.l)+i/2),n.t=""+(Number(n.t)+i/2),n.w=""+(Number(n.w)-i),n.h=""+(Number(n.h)-i)},f}return o(t,e),t}(c.DrawingFillShape);t.DrawingSquare=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BUTTON_COLOR=void 0,function(e){e.BLACK="black",e.WHITE="white"}(t.BUTTON_COLOR||(t.BUTTON_COLOR={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.modalElSelector="modal",e.dialogWrapperElSelector="modal__dialog",e.dialogElSelector="dialog",e.dimmedElSelector="modal__dimmed",e}();t.default=i},function(e,t,n){e.exports=function(){"use strict";function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var o=["opacity",t,~~(100*e),n,i].join("-"),r=.01+n/i*100,a=Math.max(1-(1-e)/t*(100-r),e),s=l.substring(0,l.indexOf("Animation")).toLowerCase(),d=s&&"-"+s+"-"||"";return u[o]||(c.insertRule("@"+d+"keyframes "+o+"{0%{opacity:"+a+"}"+r+"%{opacity:"+e+"}"+(r+.01)+"%{opacity:1}"+(r+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",c.cssRules.length),u[o]=1),o}function i(e,t){var n,i,o=e.style;if(void 0!==o[t=t.charAt(0).toUpperCase()+t.slice(1)])return t;for(i=0;i<d.length;i++)if(void 0!==o[n=d[i]+t])return n}function o(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function a(e,t){return"string"==typeof e?e:e[t%e.length]}function s(e){this.opts=r(e||{},s.defaults,h)}var l,c,d=["webkit","Moz","ms","O"],u={},h={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(s.defaults={},r(s.prototype,{spin:function(t){this.stop();var n=this,i=n.opts,r=n.el=e(null,{className:i.className});if(o(r,{position:i.position,width:0,zIndex:i.zIndex,left:i.left,top:i.top}),t&&t.insertBefore(r,t.firstChild||null),r.setAttribute("role","progressbar"),n.lines(r,n.opts),!l){var a,s=0,c=(i.lines-1)*(1-i.direction)/2,d=i.fps,u=d/i.speed,h=(1-i.opacity)/(u*i.trail/100),f=u/i.lines;!function e(){s++;for(var t=0;t<i.lines;t++)a=Math.max(1-(s+(i.lines-t)*f)%u*h,i.opacity),n.opacity(r,t*i.direction+c,a,i);n.timeout=n.el&&setTimeout(e,~~(1e3/d))}()}return n},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,r){function s(t,n){return o(e(),{position:"absolute",width:r.scale*(r.length+r.width)+"px",height:r.scale*r.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*d+r.rotate)+"deg) translate("+r.scale*r.radius+"px,0)",borderRadius:(r.corners*r.scale*r.width>>1)+"px"})}for(var c,d=0,u=(r.lines-1)*(1-r.direction)/2;d<r.lines;d++)c=o(e(),{position:"absolute",top:1+~(r.scale*r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:l&&n(r.opacity,r.trail,u+d*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&t(c,o(s("#000","0 0 4px #000"),{top:"2px"})),t(i,t(c,s(a(r.color,d),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),"undefined"!=typeof document){c=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}();var f=o(e("group"),{behavior:"url(#default#VML)"});!i(f,"transform")&&f.adj?function(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}c.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(e,i){function r(){return o(n("group",{coordsize:d+" "+d,coordorigin:-c+" "+-c}),{width:d,height:d})}function s(e,s,l){t(h,t(o(r(),{rotation:360/i.lines*e+"deg",left:~~s}),t(o(n("roundrect",{arcsize:i.corners}),{width:c,height:i.scale*i.width,left:i.scale*i.radius,top:-i.scale*i.width>>1,filter:l}),n("fill",{color:a(i.color,e),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,c=i.scale*(i.length+i.width),d=2*i.scale*c,u=-(i.width+i.length)*i.scale*2+"px",h=o(r(),{position:"absolute",top:u,left:u});if(i.shadow)for(l=1;l<=i.lines;l++)s(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)s(l);return t(e,h)},s.prototype.opacity=function(e,t,n,i){var o=e.firstChild;i=i.shadow&&i.lines||0,o&&t+i<o.childNodes.length&&(o=(o=(o=o.childNodes[t+i])&&o.firstChild)&&o.firstChild)&&(o.opacity=n)}}():l=i(f,"animation")}return s}()},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Slide=void 0;var s=n(1),l=n(0),c=n(3),d=n(304),u=n(305),h=n(53),f=n(26),p=function(e){function t(){var n=e.call(this)||this;return n.initPageNum=5,n.SlidePageFitAction=new u.SlidePageFit,n.SlidePageScrollFitAction=new d.SlidePageScrollFit,n.loadTimeout=null,n.getDimensionHtml=function(e){return r(n,void 0,void 0,(function(){var n,i,o;return a(this,(function(r){switch(r.label){case 0:return n=e.resultPath+"/"+e.status.fileName+".xml",i=[],[4,l.Util.getXml(n)];case 1:return o=r.sent(),t.SLIDE_INFO.start=parseInt(o.index.startPage),t.SLIDE_INFO.end=parseInt(o.index.endPage),t.SLIDE_INFO.total=parseInt(o.index.slide_cnt),1===t.SLIDE_INFO.total?(i[0]=[],i[0].index=parseInt(o.index.slide_list.slide.id)-1,i[0].path=o.index.slide_list.slide.path_xhtml,i[0].width=o.index.width,i[0].height=o.index.height,t.SLIDE_LIST[0]={path:o.index.slide_list.slide.path_xhtml},[2,i]):(c.each(o.index.slide_list.slide,(function(e,n){var r=parseInt(n.id)-1,a={index:r,width:o.index.width,height:o.index.height};i[e]=a,t.SLIDE_LIST[r]={path:n.path_xhtml}})),[2,i])}}))}))},n.createContentDivInMobile=function(e){return r(n,void 0,void 0,(function(){var n,i,o,r,s,d,u;return a(this,(function(a){for(n=document.createDocumentFragment(),i=0,o=e;i<o.length;i++)r=o[i],t.ORIGIN_SIZE[r.index]={width:r.width,height:r.height},(s=document.createElement("iframe")).id="page"+r.index,s.name=r.index,l.Util.removeContentsAreaTooltip()||(s.title="page"+(r.index+1)),s.scrolling="no",s.frameBorder="no",(d=document.createElement("div")).id="page-alpha"+r.index,d.className="thumb-slide-alpha",r.index<this.initPageNum&&this.onLoadImg(s,r.index),(u=document.createElement("div")).id="page-area"+r.index,u.className="contents-page",u.appendChild(s),u.appendChild(d),n.appendChild(u);return c("#contents-area").append(n),t.ORIGIN_MARGIN={marginTop:parseInt(c(".contents-page").css("margin-top")),marginBottom:parseInt(c(".contents-page").css("margin-bottom"))},c("#page-area0").addClass("contents-page--start"),c("#page-area"+(t.SLIDE_INFO.total-1)).addClass("contents-page--end"),this.pageResizeAction.resizePage(1,null,0,this.initPageNum),[2]}))}))},n.iframeEventBindInDesktop=function(){return r(n,void 0,void 0,(function(){return a(this,(function(e){return c("#page0").on("load",(function(){c(this).contents().on("mousewheel DOMMouseScroll",(function(e){!0!==e.ctrlKey&&(clearTimeout(t.wheelStopHandler),t.wheelStopHandler=setTimeout((function(){t.mousewheelInDesktop(e)}),300))}));var e=document.getElementById("contents-area"),n=document.getElementById("page0"),i=function(e){if(l.Util.isFullScreen())return e.preventDefault(),!1};n.contentDocument.addEventListener("contextmenu",i),n.contentDocument.addEventListener("contextmenu.fullscreen",i);n.contentDocument.addEventListener("mousemove",l.Util.getMouseHandlerDispatch(e)),n.contentDocument.addEventListener("mousedown",l.Util.getMouseHandlerDispatch(e,(function(){return l.Util.isFullScreen()}))),n.contentDocument.addEventListener("mouseup",l.Util.getMouseHandlerDispatch(e)),n.contentDocument.addEventListener("click",l.Util.getMouseHandlerDispatch(e)),c(this).contents().on("keydown keyup",(function(e){c("#contents-area").trigger(e)}))})),[2]}))}))},n.createContentDivInDesktop=function(e){return r(n,void 0,void 0,(function(){var n,i,o,r,s,l;return a(this,(function(a){for(n=document.createDocumentFragment(),i=0,o=e;i<o.length;i++)r=o[i],t.ORIGIN_SIZE[r.index]={width:r.width,height:r.height};return(s=document.createElement("div")).id="page-area0",(l=document.createElement("iframe")).id="page0",l.name="0",l.title="content",l.scrolling="no",l.frameBorder="no",this.onLoadImg(l,0),s.appendChild(l),n.appendChild(s),c("#contents-area").append(n),this.iframeEventBindInDesktop(),[2]}))}))},n.createContentDiv=function(e){return r(n,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return t=null,[4,this.getDimensionHtml(e)];case 1:return t=n.sent(),s.Browser.instance.isMobile?[4,this.createContentDivInMobile(t)]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,this.createContentDivInDesktop(t)];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},n.getPageElem=function(e){return document.getElementById("page"+e)},n.loadPageImg=function(e){if(s.Browser.instance.isMobile){var t=n.getDefaultLoadingCnt(),i=e-t<0?0:e-t,o=e+t>n.docInfo.status.pageNum?n.docInfo.status.pageNum:e+t;null!=n.loadTimeout&&clearTimeout(n.loadTimeout),n.loadTimeout=window.setTimeout((function(){for(var e=0;e<i;e++){-1===(t=n.getPageElem(e)).contentWindow.location.href.indexOf("about:blank")&&t.contentWindow.location.replace("about:blank")}for(e=i;e<o;e++){0===(t=n.getPageElem(e)).contentWindow.location.href.indexOf("about:blank")&&n.onLoadImg(t,e)}for(e=o+1;e<n.docInfo.status.pageNum;e++){var t;-1===(t=n.getPageElem(e)).contentWindow.location.href.indexOf("about:blank")&&t.contentWindow.location.replace("about:blank")}}),200)}else{var r=n.getPageElem(0);n.onLoadImg(r,e)}},n.checkResizeControlBar=function(){},n.bindControlbarEvent=function(){l.Util.bindClickOrTouchEvent(c("#page-prev"),"controlbar-prev--hover",n.moveBackPage),l.Util.bindClickOrTouchEvent(c("#page-next"),"controlbar-next--hover",n.moveNextPage),n.checkMoveControlbar()},n.onLoadImg=function(e,i){l.Util.isFullScreen()?e.className=" contents-page__img img-loading-black":e.className=h.Head.bgColorMode===h.BGCOLOR_MODE.darkScreen?" contents-page__img img-loading":" contents-page__img img-loading-bright",e.src=""+l.Util.getResultPath(n.docInfo,t.SLIDE_LIST[i].path)},n.isFitAction=function(){return n.pageResizeAction===n.SlidePageScrollFitAction},n.setFitAction=function(){n.preResizeObj=f.Page.RESIZE_OBJ,n.prePageAction=n.pageResizeAction,s.Browser.instance.isMobile?(f.Page.RESIZE_OBJ={type:f.RESIZE_TYPE.PageFit,percent:0},n.pageResizeAction=n.SlidePageScrollFitAction):(f.Page.RESIZE_OBJ={type:f.RESIZE_TYPE.SlidePageFit,percent:0},n.pageResizeAction=n.SlidePageFitAction)},n.getRotateMap=function(){return null},n._innerResizeWindow=function(){c(".contents-page").removeAttr("style"),f.Page.ORIGIN_MARGIN={marginTop:parseInt(c(".contents-page").css("margin-top")),marginBottom:parseInt(c(".contents-page").css("margin-bottom"))},n.pageResizeAction.resizePage(1,null)},n.fullscreenAfterEvent=function(){s.Browser.instance.isIE&&11===s.Browser.instance.version&&n.resizeWindow()},n.pageMouseEventBind=function(){c("#contents-area").on("mousewheel DOMMouseScroll",(function(e){!0!==e.ctrlKey&&(clearTimeout(t.wheelStopHandler),t.wheelStopHandler=setTimeout((function(){t.mousewheelInDesktop(e)}),300))}))},n.eventBind=function(e){n.eventObserver=e,n.eventObserver.page.subscribe(n.focusPage),n.eventObserver.resizeWindow.subscribe(n.resizeWindow),n.eventObserver.fullScreen.subscribe(n.fullScreen),n.eventObserver.singleTap.subscribe(n.singleTap),n.eventObserver.orientationchange.subscribe(n.orientationchange),n.eventObserver.moveBtn.subscribe(n.checkMoveControlbar),s.Browser.instance.isMobile?n.scrollEventBind():n.pageMouseEventBind(),n.mouseEventBind()},n.setTabIndex=function(){var e=l.Util.setTabIndexList();l.Util.setTabIndex(document.getElementById("page-area0"),e)},n.load=function(t,i){return r(n,void 0,void 0,(function(){var n=this;return a(this,(function(o){switch(o.label){case 0:return e.prototype.load.call(this,t,i),s.Browser.instance.isMobile?this.pageResizeAction=this.SlidePageScrollFitAction:this.pageResizeAction=this.SlidePageFitAction,this.bindControlbarEvent(),[4,this.createContentDiv(this.docInfo)];case 1:return o.sent(),this.setTabIndex(),this.eventBind(i),this.eventObserver.resizeContents.notify(),this.resizeWindow(),this.docInfo.status.pageNum>this.initPageNum&&setTimeout((function(){n.pageResizeAction.resizePage(1,null,n.initPageNum,n.docInfo.status.pageNum-n.initPageNum)}),30),[2]}}))}))},n.setDefaultLoadingCnt(3),n}return o(t,e),t.SLIDE_LIST=[],t.SLIDE_INFO={start:0,end:0,total:0},t.mousewheelInDesktop=function(e){(e.originalEvent.deltaY||-e.originalEvent.wheelDelta)<0?window.localSynap.movePrev():window.localSynap.moveNext()},t}(f.Page);t.Slide=p}).call(this,n(4))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingFillShape=void 0;var r=n(1),a=n(0),s=n(23),l=function(e){function t(t,n,i,o,l){var c=e.call(this,t,n,i,o,l)||this;return c.markerEventBind=function(e,t){var n=c.markerStart,i=c.markerEnd;e.on(a.Util.getClickStartEventName(),(function(){t()&&n(e,this)})),e.on(a.Util.getClickEndEventName(),(function(){i(e,this)})),r.Browser.instance.isMobile||e.on("mouseleave pointerleave",(function(){i(e,this)}))},c.markerEnd=function(e,t){e.on(a.Util.getMoveEventName(),null),c.curMarkerSection=a.Util.getParentElement(t),c.newSvg&&(c.eventObserver.editedAnnotation.notify(c.marker.getPageIdxWhenInAnnotationMode()),c.funcSaveDrawing())},c.getReNewValue=function(e,t,n,i,o){return{left:e/o,width:n/o,top:t/o,height:i/o}},c.getAnnotSize=function(e,t){var n=e.getBBox(),i=c.getPosition(e),o=i.left,r=i.top,s=0===n.width?120:n.width,l=0===n.height?50:n.height,d=c.getReNewValue(o,r,s,l,t);c.applyValidRect(d,a.Util.getParentElement(e),t);var u=parseFloat(e.style.strokeWidth)/t;return c.getAnnotSizeWithStroke(d,u)},c.applyValidRect=function(e,t,n){var i=parseFloat(t.style.width)/n,o=parseFloat(t.style.height)/n;e.left=e.left+e.width>i?i-e.width:e.left,e.top=e.top+e.height>o?o-e.height:e.top},c.setAnnotInfoThickness=function(e,t){var n=e.annot;n.border||(n.border={w:"",s:"",d:""}),n.border.w=t.toString()},c.getFillshapeAttr=function(e){var t=e.annot,n={};return n.color=s.getAnnotInfoColor(t.c),n.thickness=s.getAnnotInfoStrokeWidth(t.border),n.transparency=s.getAnnotInfoAlpha(t.a),n.innerColor=s.getAnnotInfoInnerColor(t.ic),n},c.getMarkerStyleAttr=function(e,t){var n=e.annot,i=s.getAnnotInfoColor(n.c),o=s.getAnnotInfoAlpha(n.a),r=s.getAnnotInfoStrokeWidth(n.border);return{color:i,innerColor:s.getAnnotInfoInnerColor(n.ic),thickness:parseFloat(r)*t,transparency:parseFloat(o)}},c.setAnnotInfoInnerColor=function(e,t){var n=e.annot;n.ic="none"!==t?t:""},c.setAnnotInfoPath=function(e,t){},c}return o(t,e),t}(s.DrawingTool);t.DrawingFillShape=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizingTool=void 0;var i,o,r=n(27),a=n(0),s=n(1),l=n(23),c=n(155),d=n(6),u=n(16),h=n(79),f=n(62);function p(e){switch(e){case o.NORTH_WEST_SOUTH_EAST:return"nwse-resize";case o.NORTH_EAST_SOUTH_WEST:return"nesw-resize";case o.NORTH_SOUTH:return"ns-resize";case o.EAST_WEST:return"ew-resize";case o.NONE:default:return""}}function m(e,t){if(!v(t))return function(e){switch(e.slice(-2)){case"lt":case"rb":return o.NORTH_WEST_SOUTH_EAST;case"-t":case"-b":return o.NORTH_SOUTH;case"rt":case"lb":return o.NORTH_EAST_SOUTH_WEST;case"-r":case"-l":return o.EAST_WEST;case"st":case"ed":default:return o.NONE}}(e);var n=document.getElementById(e),i=null;i="st"===e.slice(-2)?document.getElementById("control-point-ed"):document.getElementById("control-point-st");var r=parseFloat(n.style.left),a=parseFloat(n.style.top),s=parseFloat(i.style.left),l=parseFloat(i.style.top);return r===s?o.NORTH_SOUTH:a===l?o.EAST_WEST:r<s&&a<l||r>s&&a>l?o.NORTH_WEST_SOUTH_EAST:o.NORTH_EAST_SOUTH_WEST}function g(e,t){var n=r.mouse(e);return(s.Browser.instance.isIOS||s.Browser.instance.isSafari||s.Browser.instance.isFirefox)&&(n[0]/=t,n[1]/=t),{x:parseFloat(n[0].toFixed(2)),y:parseFloat(n[1].toFixed(2))}}function v(e){return"arrowline"===e||"line"===e}function b(e,t){var n="";if(v(t))switch(e){case 0:n="st";break;case 1:n="ed"}else switch(e){case 0:n="lt";break;case 1:n="t";break;case 2:n="rt";break;case 3:n="r";break;case 4:n="rb";break;case 5:n="b";break;case 6:n="lb";break;case 7:n="l"}return"control-point-"+n}!function(e){e[e.NONE=0]="NONE",e[e.RIGHT=1]="RIGHT",e[e.LEFT=2]="LEFT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.TOP_RIGHT=5]="TOP_RIGHT",e[e.BOTTOM_RIGHT=6]="BOTTOM_RIGHT",e[e.TOP_LEFT=7]="TOP_LEFT",e[e.BOTTOM_LEFT=8]="BOTTOM_LEFT",e[e.START=9]="START",e[e.END=10]="END"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.EAST_WEST=1]="EAST_WEST",e[e.NORTH_SOUTH=2]="NORTH_SOUTH",e[e.NORTH_EAST_SOUTH_WEST=3]="NORTH_EAST_SOUTH_WEST",e[e.NORTH_WEST_SOUTH_EAST=4]="NORTH_WEST_SOUTH_EAST"}(o||(o={}));var y=function(){function e(t,n){var o=this;this.eventObserver=null,this.pathSplitRegex=null,this.annotType="",this.isResizing=!1,this.isCell=!1,this.mouseStartPosition=i.NONE,this.resizedPathStr="",this.markerIdInfo=null,this.annotRatio=0,this.strokeWidth=0,this.mouseStartPoint={x:0,y:0},this.originShapeInfo={left:0,top:0,width:0,height:0,path:""},this.originMarkerInfo={left:0,top:0,width:0,height:0},this.maximumChange={left:0,right:0,top:0,bottom:0},this.resizeMoveBind=function(e,t){r.event.pointerId&&e.node().setPointerCapture(r.event.pointerId),"mousedown"===r.event.type?e.on("mousemove",(function(){o.resizeMove(e,t)})):"pointerdown"===r.event.type?e.on("pointermove",(function(){o.resizeMove(e,t)})):e.on("touchmove",(function(){r.event.preventDefault();var n=parseFloat(e.node().style.width),i=parseFloat(e.node().style.height),a=r.touches(e.node())[0];a[0]<0||a[0]>n||a[1]<0||a[1]>i?o.resizeEnd(e,t):o.resizeMove(e,t)}))},this.resizeStart=function(e,t){var n;(null===(n=event.touches)||void 0===n?void 0:n.length)>1||o.mouseStartPosition!==i.NONE&&(o.eventObserver.dragAnnotStart.notify({elemId:t.id}),e.style("cursor","crosshair"),o.originMarkerInfo={left:parseFloat(t.style.left),top:parseFloat(t.style.top),width:parseFloat(t.style.width),height:parseFloat(t.style.height)},o.setOriginShapeInfo(t),o.setMaximumChange(),o.resizeMoveBind(e,t),e.on(a.Util.getClickEndEventName(),(function(){return o.resizeEnd(e,t)})))},this.resizeMove=function(t,n){var r;if(!((null===(r=event.touches)||void 0===r?void 0:r.length)>1)){o.isResizing=!0,o.annotRatio=u.default.getAnnotRatio(o.markerIdInfo.pageOrSheetIdx,o.isCell);var a=null;a="freetext"===o.annotType&&n.firstElementChild?g(n.firstElementChild,o.annotRatio):g(n,o.annotRatio),a=o.limitCursorArea(a,t.node());var s=o.limitMouseChange({x:a.x-o.mouseStartPoint.x,y:a.y-o.mouseStartPoint.y}),c=s.x,d=s.y,h={x:o.originShapeInfo.left,y:o.originShapeInfo.top},f={x:o.originShapeInfo.left,y:o.originShapeInfo.top};switch(o.mouseStartPosition){case i.LEFT:case i.BOTTOM_LEFT:f.x=o.originShapeInfo.left+c;break;case i.TOP_RIGHT:case i.TOP:f.y=o.originShapeInfo.top+d;break;case i.TOP_LEFT:f.x=o.originShapeInfo.left+c,f.y=o.originShapeInfo.top+d}var p=o.calcResizedSvgInfo({x:c,y:d});if(v(o.annotType)||n.style.left!==p.left+"px"||n.style.top!==p.top+"px"||n.style.width!==p.width+"px"||n.style.height!==p.height+"px"){var m=o.calcResizeRatio(o.originShapeInfo,c,d);if(v(o.annotType)){o.resizeLine(n,a);var b=n.firstElementChild.getBBox(),y={w:o.strokeWidth.toString()},E=l.getHalfBorderSize(y),I=b.x-E-l.DrawingTool.VIEWBOX_RANGE,S=b.y-E-l.DrawingTool.VIEWBOX_RANGE,w=b.width+2*(E+l.DrawingTool.VIEWBOX_RANGE),_=b.height+2*(E+l.DrawingTool.VIEWBOX_RANGE);p.left=Math.round(I),p.top=Math.round(S),p.width=Math.round(w),p.height=Math.round(_)}else"ink"===o.annotType?o.resizeInk(n,h,f,m):"square"===o.annotType||"circle"===o.annotType?o.resizeShape(n,f,m):"freetext"===o.annotType&&o.resizeFreetext(n,f,m);if(n.style.left=p.left+"px",n.style.top=p.top+"px",n.style.width=p.width+"px",n.style.height=p.height+"px","freetext"===o.annotType){var T=n.firstElementChild;T.setAttribute("viewBox",p.left+" "+p.top+" "+p.width+" "+p.height),T.style.width=p.width+"px",T.style.height=p.height+"px"}else n.setAttribute("viewBox",p.left+" "+p.top+" "+p.width+" "+p.height);e.updateControlPoint(n,o.annotType)}}},this.resizeEnd=function(e,t){var n;if(!((null===(n=event.touches)||void 0===n?void 0:n.length)>1)&&(r.event.pointerId&&e.node().releasePointerCapture(r.event.pointerId),e.on(a.Util.getMoveEventName(),null),e.on(a.Util.getClickEndEventName(),null),e.style("cursor",""),o.eventObserver.dragAnnotEnd.notify({page:o.markerIdInfo.pageOrSheetIdx,annotId:o.markerIdInfo.annotId,showPopup:!0,ratio:o.annotRatio}),o.isResizing)){o.isResizing=!1;var i=0;if("square"===o.annotType||"freetext"===o.annotType){var s={w:o.strokeWidth.toString()};i=l.getHalfBorderSize(s)}var c={left:(parseFloat(t.style.left)-i+l.DrawingTool.VIEWBOX_RANGE).toFixed(2),top:(parseFloat(t.style.top)-i+l.DrawingTool.VIEWBOX_RANGE).toFixed(2),width:(parseFloat(t.style.width)+2*(i-l.DrawingTool.VIEWBOX_RANGE)).toFixed(2),height:(parseFloat(t.style.height)+2*(i-l.DrawingTool.VIEWBOX_RANGE)).toFixed(2),path:o.resizedPathStr};o.eventObserver.modifyMarkerAttr.notify({elemId:t.id,attr:c})}},this.eventObserver=t,this.isCell=n,this.pathSplitRegex=new RegExp(/([A-Z][^A-Z]+)/g)}return e.prototype.init=function(){this.annotType="",this.isResizing=!1,this.mouseStartPosition=i.NONE,this.resizedPathStr="",this.markerIdInfo=null,this.annotRatio=0,this.strokeWidth=0,this.mouseStartPoint={x:0,y:0},this.originShapeInfo={left:0,top:0,width:0,height:0,path:""},this.originMarkerInfo={left:0,top:0,width:0,height:0},this.maximumChange={left:0,right:0,top:0,bottom:0}},e.hasControlPoint=function(e){return a.Util.getParentElement(e).getElementsByClassName("control-point").length},e.createControlPoint=function(t,n){if(!e.isSingleDot(t,n))for(var i=a.Util.getParentElement(t),o=v(n)?2:8,r=0;r<o;++r){var s=document.createElement("div");i.appendChild(s),s.setAttribute("class","control-point");var l=b(r,n);s.setAttribute("id",l),s.style.display="none"}},e.toggleControlPointMode=function(t,n){if(e.hasControlPoint(t)){var i=a.Util.getParentElement(t),o=v(n);2==i.getElementsByClassName("control-point").length&&o||(8!=i.getElementsByClassName("control-point").length||o)&&(e.removeControlPoint(t),e.createControlPoint(t,n))}},e.showControlPoint=function(t,n,o,s){if(e.hasControlPoint(n)&&!e.isSingleDot(n,o)){var l=a.Util.getParentElement(n).getElementsByClassName("control-point");e.toggleControlPointMode(n,o),e.updateControlPoint(n,o);for(var c=function(e){var c=l.item(e);if(c.style.display="",s){var d=c.getAttribute("id");r.select(c).on(a.Util.getClickStartEventName(),(function(){return t.resizeBind(n,function(e){switch(e.slice(-2)){case"lt":return i.TOP_LEFT;case"-t":return i.TOP;case"rt":return i.TOP_RIGHT;case"-r":return i.RIGHT;case"rb":return i.BOTTOM_RIGHT;case"-b":return i.BOTTOM;case"lb":return i.BOTTOM_LEFT;case"-l":return i.LEFT;case"st":return i.START;case"ed":return i.END;default:return i.NONE}}(d),o)}))}},d=0;d<l.length;++d)c(d)}},e.hideControlPoint=function(t){if(e.hasControlPoint(t))for(var n=a.Util.getParentElement(t).getElementsByClassName("control-point"),i=0;i<n.length;++i){n.item(i).style.display="none"}},e.removeControlPoint=function(t){if(e.hasControlPoint(t))for(var n=a.Util.getParentElement(t).getElementsByClassName("control-point");n.length>0;)r.select(n[0]).on(a.Util.getClickStartEventName(),null),a.Util.removeElem(n[0])},e.updateControlPoint=function(e,t){var n=a.Util.getParentElement(e).getElementsByClassName("control-point"),i=null,o=null;v(t)?o=function(e,t){var n={st:{x:0,y:0},ed:{x:0,y:0}};if(!v(t))return n;var i=e.firstElementChild.getAttribute("d").split(" ");return n.st={x:parseFloat(i[1]),y:parseFloat(i[2])},n.ed={x:parseFloat(i[4]),y:parseFloat(i[5])},n}(e,t):i={left:parseFloat(e.style.left),top:parseFloat(e.style.top),width:parseFloat(e.style.width),height:parseFloat(e.style.height)};for(var r=0;r<n.length;++r){var s={x:0,y:0};switch((l=n.item(r)).getAttribute("id").slice(-2)){case"lt":s.x=i.left,s.y=i.top;break;case"-t":s.x=i.left+i.width/2,s.y=i.top;break;case"rt":s.x=i.left+i.width,s.y=i.top;break;case"-r":s.x=i.left+i.width,s.y=i.top+i.height/2;break;case"rb":s.x=i.left+i.width,s.y=i.top+i.height;break;case"-b":s.x=i.left+i.width/2,s.y=i.top+i.height;break;case"lb":s.x=i.left,s.y=i.top+i.height;break;case"-l":s.x=i.left,s.y=i.top+i.height/2;break;case"st":s.x=o.st.x,s.y=o.st.y;break;case"ed":s.x=o.ed.x,s.y=o.ed.y}l.style.left=s.x-6+"px",l.style.top=s.y-6+"px"}for(r=0;r<n.length;++r){var l,c=(l=n.item(r)).getAttribute("id");l.style.cursor=p(m(c,t))}},e.prototype.resizeBind=function(e,t,n){if("memo"!==n&&!this.isResizing&&!f.MemoContent.isShow()&&(this.init(),this.mouseStartPosition=t,this.mouseStartPosition!==i.NONE)){this.annotType=n,this.markerIdInfo=d.default.parseMarkerId(e.id),this.annotRatio=u.default.getAnnotRatio(this.markerIdInfo.pageOrSheetIdx,this.isCell),this.strokeWidth="freetext"===n?parseInt(getComputedStyle(e.firstElementChild.firstElementChild).strokeWidth):parseInt(getComputedStyle(e.firstElementChild).strokeWidth);var o=r.select("div#annotationlayer"+d.default.parseMarkerId(e.id).pageOrSheetIdx);this.mouseStartPoint={x:parseFloat((r.mouse(o.node())[0]/this.annotRatio).toFixed(2)),y:parseFloat((r.mouse(o.node())[1]/this.annotRatio).toFixed(2))},this.resizeStart(o,e)}},e.prototype.setOriginShapeInfo=function(e){this.originShapeInfo=function(e,t){if("ink"===t){var n="";e.childNodes.forEach((function(e){n+=e.getAttribute("d")}));var i=h.getInkSize(n,0,1),o=i.left,r=i.top,a=i.width,s=i.height;return{left:parseFloat(o),top:parseFloat(r),width:Math.max(parseFloat(a),1),height:Math.max(parseFloat(s),1),path:n}}if(v(t)){var l=e.firstElementChild.getAttribute("d"),c=l.split(" ");c.length=6;var d=c.join(" "),u=h.getInkSize(d,0,1);o=u.left,r=u.top,a=u.width,s=u.height;return{left:parseFloat(o),top:parseFloat(r),width:parseFloat(a),height:parseFloat(s),path:l}}if("circle"===t){var f=e.firstElementChild;return{left:parseFloat(f.getAttribute("cx")),top:parseFloat(f.getAttribute("cy")),width:parseFloat(f.getAttribute("rx")),height:parseFloat(f.getAttribute("ry"))}}if("freetext"===t){var p=e.firstElementChild.firstElementChild;return{left:parseFloat(p.getAttribute("x")),top:parseFloat(p.getAttribute("y")),width:parseFloat(p.getAttribute("width")),height:parseFloat(p.getAttribute("height"))}}var m=e.firstElementChild;return{left:parseFloat(m.getAttribute("x")),top:parseFloat(m.getAttribute("y")),width:parseFloat(m.getAttribute("width")),height:parseFloat(m.getAttribute("height"))}}(e,this.annotType)},e.prototype.calcResizeRatio=function(e,t,n){switch(this.mouseStartPosition){case i.TOP:case i.TOP_RIGHT:n*=-1;break;case i.LEFT:case i.BOTTOM_LEFT:t*=-1;break;case i.TOP_LEFT:t*=-1,n*=-1}"circle"===this.annotType&&(t/=2,n/=2);var o=Math.abs((t+e.width)/e.width),r=Math.abs((n+e.height)/e.height);switch(this.mouseStartPosition){case i.TOP:case i.BOTTOM:o=1;break;case i.RIGHT:case i.LEFT:r=1}return{width:o,height:r}},e.prototype.getSplitPath=function(e){var t=[],n=e||this.originShapeInfo.path;if(String.prototype.matchAll)t=Array.from(n.matchAll(this.pathSplitRegex));else for(var i="";null!==(i=this.pathSplitRegex.exec(n));)t.push(i);return t},e.prototype.resizeLine=function(e,t){var n=this.getSplitPath(),o=n[0][0].split(" "),r=parseFloat(o[1]),a=parseFloat(o[2]);this.mouseStartPosition===i.START&&(r=t.x,a=t.y);var s=n[1][0].split(" "),l=parseFloat(s[1]),d=parseFloat(s[2]);if(this.mouseStartPosition===i.END&&(l=t.x,d=t.y),"arrowline"===this.annotType){var u=c.getArrowString(r,a,l,d,parseFloat(getComputedStyle(e).strokeWidth));this.resizedPathStr="M "+r+" "+a+" L "+l+" "+d+" "+u}else this.resizedPathStr="M "+r+" "+a+" L "+l+" "+d;e.firstElementChild.setAttribute("d",this.resizedPathStr)},e.prototype.resizeInk=function(e,t,n,i){var o=this,r="",a=0,s=l.getPathList(this.originShapeInfo.path);e.childNodes.forEach((function(e){r+=o.resizePath(e,s[a],t,n,i),a++})),this.resizedPathStr=r},e.prototype.calcResizedSvgInfo=function(e){var t=this.originMarkerInfo.left,n=this.originMarkerInfo.top,o=this.originMarkerInfo.width,r=this.originMarkerInfo.height;switch(this.mouseStartPosition){case i.LEFT:case i.TOP_LEFT:case i.BOTTOM_LEFT:o-=e.x;break;case i.RIGHT:case i.TOP_RIGHT:case i.BOTTOM_RIGHT:o+=e.x}switch(this.mouseStartPosition){case i.TOP:case i.TOP_LEFT:case i.TOP_RIGHT:r-=e.y;break;case i.BOTTOM:case i.BOTTOM_LEFT:case i.BOTTOM_RIGHT:r+=e.y}switch(this.mouseStartPosition){case i.TOP:case i.TOP_RIGHT:n+=e.y;break;case i.LEFT:case i.BOTTOM_LEFT:t+=e.x;break;case i.TOP_LEFT:t+=e.x,n+=e.y}return{left:Math.round(t),top:Math.round(n),width:Math.round(o),height:Math.round(r)}},e.prototype.setMaximumChange=function(){if(!v(this.annotType)){var e=this.originShapeInfo.width,t=this.originShapeInfo.height;"circle"===this.annotType&&(e*=2,t*=2);this.maximumChange.left=e-this.strokeWidth-1,this.maximumChange.right=-1*this.maximumChange.left,this.maximumChange.top=t-this.strokeWidth-1,this.maximumChange.bottom=-1*this.maximumChange.top}},e.prototype.limitCursorArea=function(e,t){var n=e;return n.x=Math.max(0,n.x),n.y=Math.max(0,n.y),n.x=Math.min(parseFloat(t.style.width)/this.annotRatio,n.x),n.y=Math.min(parseFloat(t.style.height)/this.annotRatio,n.y),n},e.prototype.limitMouseChange=function(e){if(v(this.annotType))return e;var t=e;switch(this.mouseStartPosition){case i.LEFT:case i.TOP_LEFT:case i.BOTTOM_LEFT:t.x=Math.min(t.x,this.maximumChange.left);break;case i.RIGHT:case i.TOP_RIGHT:case i.BOTTOM_RIGHT:t.x=Math.max(t.x,this.maximumChange.right)}switch(this.mouseStartPosition){case i.TOP:case i.TOP_RIGHT:case i.TOP_LEFT:t.y=Math.min(t.y,this.maximumChange.top);break;case i.BOTTOM:case i.BOTTOM_LEFT:case i.BOTTOM_RIGHT:t.y=Math.max(t.y,this.maximumChange.bottom)}return t},e.prototype.calcNewPathPoint=function(e,t,n,i){return((e-t)*i+n).toFixed(2)},e.prototype.resizePathSegment=function(e,t,n,i){var o=e.split(" ");switch(o[0]){case"C":return o[0]+" "+this.calcNewPathPoint(parseFloat(o[1]),t.x,n.x,i.width)+" "+this.calcNewPathPoint(parseFloat(o[2]),t.y,n.y,i.height)+" "+this.calcNewPathPoint(parseFloat(o[3]),t.x,n.x,i.width)+" "+this.calcNewPathPoint(parseFloat(o[4]),t.y,n.y,i.height)+" "+this.calcNewPathPoint(parseFloat(o[5]),t.x,n.x,i.width)+" "+this.calcNewPathPoint(parseFloat(o[6]),t.y,n.y,i.height)+" ";case"L":case"M":return o[0]+" "+this.calcNewPathPoint(parseFloat(o[1]),t.x,n.x,i.width)+" "+this.calcNewPathPoint(parseFloat(o[2]),t.y,n.y,i.height)+" ";default:return""}},e.prototype.resizePath=function(e,t,n,i,o){var r=this,a=this.getSplitPath(t),s="";return a.forEach((function(e){return s+=r.resizePathSegment(e[0],n,i,o)})),e.setAttribute("d",s),s},e.prototype.resizeShape=function(e,t,n){var i=t.x,o=t.y,r=this.originShapeInfo.width*n.width,a=this.originShapeInfo.height*n.height;"circle"===this.annotType&&(r=this.originShapeInfo.width*n.width,a=this.originShapeInfo.height*n.height,i=t.x-this.originShapeInfo.width+r,o=t.y-this.originShapeInfo.height+a);var s=e.firstElementChild;"circle"===this.annotType?(s.setAttribute("cx",i.toFixed(2)),s.setAttribute("cy",o.toFixed(2)),s.setAttribute("rx",r.toFixed(2)),s.setAttribute("ry",a.toFixed(2))):(s.setAttribute("x",i.toFixed(2)),s.setAttribute("y",o.toFixed(2)),s.setAttribute("width",r.toFixed(2)),s.setAttribute("height",a.toFixed(2)))},e.prototype.resizeFreetext=function(e,t,n){var i=e.firstElementChild,o=e.lastElementChild;this.resizeShape(i,t,n),o.style.width=this.originShapeInfo.width*n.width-this.strokeWidth-2+"px",o.style.height=this.originShapeInfo.height*n.height-this.strokeWidth-2+"px"},e.isSingleDot=function(e,t){if("ink"!==t||1!==e.getElementsByTagName("path").length)return!1;var n=e.firstElementChild.getAttribute("d").trim().split(" ").filter((function(e){return""!=e}));return 6===n.length&&(n[1]===n[4]&&n[2]===n[5])},e}();t.ResizingTool=y},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingLine=t.getArrowString=void 0;var r=n(27),a=n(1),s=n(0),l=n(23),c=n(44),d=n(79),u=n(30),h=n(274),f=n(43);function p(e,t,n,i,o,r){void 0===r&&(r=1);var a=12*o*r,s=function(e){return{x:a*Math.cos(e)+n,y:a*Math.sin(e)+i}},l=h.MathUtil.getDegree(e,t,n,i),c=s(h.MathUtil.degreeToRadian(l+180+30)),d=c.x,u=c.y,f=s(h.MathUtil.degreeToRadian(l+180-30)),p=f.x,m=f.y;return"M "+d.toFixed(2)+" "+u.toFixed(2)+" L "+n.toFixed(2)+" "+i.toFixed(2)+" L "+p.toFixed(2)+" "+m.toFixed(2)}function m(e,t){var n=l.getPathList(e),i=n[0].split(" ").filter((function(e){return e.length>0})).slice(1,3),o=n[0].split(" ").filter((function(e){return e.length>0})).slice(4,6),r=n[0];return n[1]&&(r+=p(Number(i[0]),Number(i[1]),Number(o[0]),Number(o[1]),t)),n[2]&&(r+=p(Number(o[0]),Number(o[1]),Number(i[0]),Number(i[1]),t)),r}t.getArrowString=p;var g=function(e){function t(t,n,i,o,h,g){var v=e.call(this,t,n,i,o,h)||this;return v.isArrow=!1,v.tempPath=[],v.markerEventBind=function(e,t){var n=v.markerStart,i=v.markerEnd;e.on(s.Util.getClickStartEventName(),(function(){t()&&n(e,this)})),e.on(s.Util.getClickEndEventName(),(function(){i(e,this)})),a.Browser.instance.isMobile||e.on("mouseleave pointerleave",(function(){i(e,this)}))},v.markerStart=function(e,t){var n=event;if(!(n.touches&&n.touches.length>1)){var i=s.Util.getParentElement(e.node()).id,o=s.Util.getIdxFromElmId(i,"marker-section"),a=u.default.instance.getRatioByOriginSize(o,v.isCell);v.newSvg=e.append("path").data([v.tempPath]).style("stroke",l.DrawingTool.hexToRgb(c.default.getTypeToHexColor(v.attr.color))).style("stroke-width",v.attr.thickness*a).style("opacity",v.attr.transparency).style("fill","transparent").attr("class","tmp-marker-path").attr("id","tmp-marker-path");var d=r.mouse(t),h=d[0],f=d[1];v.tempPath[0]=[h,f],v.markerDrawTmp(t,h,f,a),v.markerDrawBind(e,v.markerEnd,(function(){v.markerDrawTmp(t,h,f,a)}))}},v.markerDrawTmp=function(e,t,n,i){var o=r.mouse(e),a=o[0],s=o[1];if(v.tempPath[1]=[a,s],v.isArrow){var l=p(t,n,a,s,v.attr.thickness,i);v.newSvg.attr("d","M "+t+" "+n+" L "+a+" "+s+" "+l)}else v.newSvg.attr("d",r.line().x((function(e){return e[0]})).y((function(e){return e[1]})))},v.markerEnd=function(e,t){e.on(s.Util.getMoveEventName(),null),v.tempPath=[],v.curMarkerSection=s.Util.getParentElement(t),v.newSvg&&(v.eventObserver.editedAnnotation.notify(v.marker.getPageIdxWhenInAnnotationMode()),v.funcSaveDrawing())},v.getAnnotSize=function(e,t){var n=e.getBBox(),i=n.x,o=n.y,r={left:i/t,width:n.width/t,top:o/t,height:n.height/t},a=parseFloat(e.style.strokeWidth)/t;return l.getAnnotSizeWithStroke(r.left,r.top,r.width,r.height,a)},v.createSvg=function(e,t,n){var i=t,o=l.getViewBox(i.l,i.t,i.w,i.h,null),a=o.left,s=o.top,c=o.width,d=o.height,u=r.select(e).append("svg").attr("id",n).attr("class","marker-svg").attr("viewBox",a+" "+s+" "+c+" "+d).attr("focusable","false").style("left",a+"px").style("width",c+"px").style("top",s+"px").style("height",d+"px").style("stroke",l.DrawingTool.hexToRgb(l.getAnnotInfoColor(i.c))).style("stroke-width",l.getAnnotInfoStrokeWidth(i.path)).style("opacity",l.getAnnotInfoAlpha(i.a));return u.append("path").attr("class","marker-svg__path").attr("d",l.getAnnotInfoPathText(i.path)),u},v.getReNewValue=function(e,t){var n=e,i=n.split("M").join("M ");n.indexOf("C")>-1&&(i=i.split("C").join(" C ")),n.indexOf("L")>-1&&(i=i.split("L").join(" L "));for(var o="",r=0,a=(i=i.split(",").join(" ")).trim().split(" ");r<a.length;r++){var s=a[r],l=parseFloat(parseFloat(s).toFixed(2));isNaN(l)||(s=(l/t).toFixed(2)),o+=s+" "}return o.replace(/\s\s/g," ")},v.createAnnotInfo=function(e,t,n,i,o,r){var a=(parseFloat(o.style.strokeWidth)/r).toFixed(2),s=v.createAnnotBaseInfo(e,t,i,o,r),l=v.getReNewValue(o.getAttribute("d"),r),c=s.annot;return c.type="line",v.isArrow&&(c.le={head:"none",tail:"openarrow"}),c.path={w:a,text:l},s},v.setAnnotInfoThickness=function(e,t){var n=e.annot;if(n.path||(n.path={w:"",text:""}),n.path.w=t.toString(),n.path.text){var i=m(n.path.text,t);n.path.text=i;var o=d.getInkSize(i,Number(t),1);e.annot.l=o.left,e.annot.t=o.top,e.annot.w=o.width,e.annot.h=o.height}},v.setAnnotInfoPath=function(e,t){var n=e.annot;n.path||(n.path={w:"",text:""}),n.path.text=t},v.redrawAttr=function(e,t){var n=t.annot;v.redrawMoveAttr(e,t),r.select(e).select("path").attr("d",n.path.text);var i={};i.color=l.getAnnotInfoColor(n.c),i.thickness=l.getAnnotInfoStrokeWidth(n.path),i.transparency=l.getAnnotInfoAlpha(n.a),v.setSvgStyle(e,i)},v.redrawAttrEl=function(e,t,n){if("thickness"===t){var i=m(r.select(e).select("path").attr("d"),Number(n)),o=d.getInkSize(i,Number(n),1),a=l.getViewBox(o.left,o.top,o.width,o.height,null),s=a.left,c=a.top,u=a.width,h=a.height;r.select(e).attr("viewBox",s+" "+c+" "+u+" "+h).style("left",s+"px").style("top",c+"px").style("width",u+"px").style("height",h+"px").select("path").attr("d",i),f.MemoIcon.rePositionDependentMemo(e.id,parseFloat(c),parseFloat(s),parseFloat(o.height))}var p={};p[""+t]=n,v.setSvgStyle(e,p)},v.getMarkerStyleAttr=function(e,t){var n=e.annot,i=l.getAnnotInfoColor(n.c),o=l.getAnnotInfoStrokeWidth(n.path),r=l.getAnnotInfoAlpha(n.a);return{color:i,thickness:parseFloat(o)*t,transparency:parseFloat(r)}},v.moveMarker=function(e,t,n){var i=e.path.text;if(!i)return null;for(var o="",r=!0,a=0,s=i.trim().split(" ");a<s.length;a++){var l=s[a],c=parseFloat(l);if(!isNaN(c)){var d=r?t:n;r=!r,l=(c-d).toFixed(2)}l.length&&(o+=l+" ")}return o},v.isArrow=g,v}return o(t,e),t}(l.DrawingTool);t.DrawingLine=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Freetext=t.setFreetextDivBoundingRect=t.setFreetextAreaBoundingRect=void 0;var i=n(16),o=n(6),r=n(27),a=n(3),s=n(23),l=n(55),c=n(109),d=n(0),u=n(17);function h(e,t){var n=parseFloat(s.getAnnotInfoStrokeWidth(t.border)),i=c.getRectAttribute(t.l,t.t,t.w,t.h,n.toString()),o=s.DrawingTool.VIEWBOX_RANGE+1.5*n+1;e.style.left=o-n/2+"px",e.style.top=o-n/2+"px",e.style.width=i.width-n-2+"px",e.style.height=i.height-n-2+"px"}function f(e,t){var n=s.getViewBox(t.l,t.t,t.w,t.h,t.border);e.style.left=n.left+"px",e.style.top=n.top+"px",e.style.width=n.width+"px",e.style.height=n.height+"px"}t.setFreetextAreaBoundingRect=h,t.setFreetextDivBoundingRect=f;var p=function(){function e(e,t,n,i,l,p){var m=this;this.eventObserver=null,this.freetextDivEl=null,this.svgSelection=null,this.freetextTextAreaEl=null,this.funcgetAnnotInfos=null,this.annotId=0,this.pageOrSheetIdx=0,this.setSvgPosition=function(){this.svgSelection.style("left","0px").style("top","0px")},this.click=function(e){o.default.isScrollMode||m.svgSelection.classed("active")||(e.preventDefault(),m.eventObserver.selectAnnotation.notify({page:m.pageOrSheetIdx,annotId:m.annotId,showMemo:!1,showPopup:!0}))},this.createFreetextDivEl=function(e){var t=document.createElement("div");return t.id=o.default.createtMarkerId(m.pageOrSheetIdx,m.annotId),t.className="freetext",t.style.position="absolute",f(t,e),t},this.createTextAreaEl=function(e){var t=document.createElement("textarea");return d.Util.addClass(t,"annotaion-freetext"),m.getTextAreaStyle(e),m.setContentsIfEmpty(e),h(t,e),r.select(t).attr("class","annotation-freetext").attr("spellcheck","false").attr("readonly","true").attr("placeholder",""+u.LocaleMessage.getMessage("freetext_placeholder_msg")).style("text-align",""+e.ds.align).style("font-weight",""+e.ds.weight).style("font-size",e.ds.size+"pt").style("font-style",""+e.ds.style).style("font-family",""+e.ds.font).style("opacity",""+e.a).style("color",s.DrawingTool.hexToRgb(e.ds.c)),t.value=e.contents.text,d.Util.disableKeyEventForPageMove(t),t},this.getTextAreaStyle=function(e){e.rc&&1==e.rc.length&&(e.ds.align=e.rc[0].align,e.ds.size=e.rc[0].size,e.ds.font=e.rc[0].font,e.ds.style=e.rc[0].style,e.ds.c=e.rc[0].c)},this.saveFreetext=function(){var e=o.default.createtMarkerId(m.pageOrSheetIdx,m.annotId),t={text:m.freetextTextAreaEl.value},n=m.funcgetAnnotInfos(m.pageOrSheetIdx,m.annotId);n&&(m.freetextTextAreaEl.style.opacity=n.annot.a,(n.annot.contents?a.extend(!0,{},n.annot.contents):{t:"",d:"",text:""}).text!==t.text&&(m.eventObserver.editedAnnotation.notify(m.pageOrSheetIdx),m.eventObserver.modifyMarkerAttr.notify({elemId:e,attr:t})))},this.removeMemuMoreProp=function(){var e=document.getElementById("marker-freetext-block");d.Util.removeClass(e,"more-prop")},this.setContentsIfEmpty=function(e){if(""===e.contents.text){for(var t="",n=0;n<e.rc.length;++n)t+=e.rc[n].contents;e.contents.text=t}},this.delete=function(){d.Util.deleteObj(m)};var g=o.default.parseMarkerId(n);this.eventObserver=e,this.annotId=g.annotId,this.pageOrSheetIdx=g.pageOrSheetIdx,this.funcgetAnnotInfos=p,this.svgSelection=c.createRectSvg(l,t),this.setSvgPosition(),this.removeMemuMoreProp(),this.freetextDivEl=this.createFreetextDivEl(t),this.freetextDivEl.appendChild(this.svgSelection.node()),this.freetextTextAreaEl=this.createTextAreaEl(t),this.freetextDivEl.appendChild(this.freetextTextAreaEl),l.appendChild(this.freetextDivEl),this.eventBind()}return e.prototype.eventBind=function(){var e=this;this.freetextTextAreaEl.addEventListener("focusout",(function(t){e.saveFreetext();var n=t.target;window.getSelection&&window.getSelection().removeAllRanges(),null==n.getAttribute("readonly")&&(n.setAttribute("readonly","true"),n.style.cursor="move")})),this.freetextDivEl.addEventListener(d.Util.getClickOrTouchEventName(),this.click)},e.updateTextArea=function(e,t){var n=document.getElementById(o.default.createtMarkerId(e,t.id)).getElementsByClassName("annotation-freetext")[0],i=t.annot;null!=n&&(n.value=i.contents.text,n.style.textAlign=i.ds.align,n.style.color=""+s.DrawingTool.hexToRgb(i.ds.c),n.style.fontSize=i.ds.size+"pt",n.style.opacity=i.a)},e.getPosition=function(e,t,n){var o=parseFloat(e.t),r=parseFloat(e.l),a=l.getAnnotArea(!0,t,n),s=a.left,c=a.right,d=a.top,u=a.bottom,h=i.default.getAnnotRatio(t,n),f=l.annotPos(parseFloat(e.w),parseFloat(e.h),r,o,s(),c()/h,d(),u()/h);return{top:f.getTop(),left:f.getLeft()}},e}();t.Freetext=p},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(51);Object.defineProperty(t,"DialogFactory",{enumerable:!0,get:function(){return i.default}})},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPdfPrintUrl=t.getPdfDownUrl=t.redirectUserGateway=t.uploadPdf=t.modifyAnnot=t.removeAnnot=t.addAnnot=t.getAnnotList=void 0;var r=n(0);function a(e){return e.contextPath+"/annotations/"+e.jobId}t.getAnnotList=function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,r.Util.getJson(a(e)+"?"+r.Util.setAnnotQueryString(e))];case 1:return[2,t.sent()]}}))}))},t.addAnnot=function(e,t){return r.Util.postJsonAjax(a(e)+"/add?"+r.Util.setAnnotQueryString(e),t)},t.removeAnnot=function(e,t){return i(void 0,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,r.Util.getJson(a(e)+"/remove/"+t+"?"+r.Util.setAnnotQueryString(e))];case 1:return[2,n.sent()]}}))}))},t.modifyAnnot=function(e,t,n){return r.Util.postJsonAjax(a(e)+"/modify/"+t+"?"+r.Util.setAnnotQueryString(e),n)},t.uploadPdf=function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,r.Util.getJson(a(e)+"/upload?"+r.Util.setAnnotQueryString(e))];case 1:return[2,t.sent()]}}))}))},t.redirectUserGateway=function(e,t){var n=e+"/userGateway.cmd?returnUrl="+encodeURIComponent(t);window.open(r.Util.getUrlWithExtraParam(n),"_self")},t.getPdfDownUrl=function(e,t,n){var i=a(e)+"/export?filename="+t+"&dispAnnot="+n+"&"+r.Util.setAnnotQueryString(e);return r.Util.getUrlWithExtraParam(i)},t.getPdfPrintUrl=function(e,t){var n=e.contextPath;!n&&r.Util.isConvHtml(e)&&void 0!==window.localSynap&&window.localSynap.config.contextPath&&(n=window.localSynap.config.contextPath.trim());var i=r.Util.setExtraParam("filename="+e.jobId+".pdf&printable=true&dispAnnot="+t+"&"+r.Util.setAnnotQueryString(e));return n+"/annotations/"+e.jobId+"/export?"+i}}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Sheet=void 0;var r=n(1),a=n(0),s=n(38),l=n(3),c=n(53),d=n(6),u=n(19),h=function(){var t=this;this.docInfo=null,this.eventObserver=null,this.defaultSheetTabWidth=115,this.sheetTabWidth=60,this.maxPage=null,this.showSheetTabIdx=0,this.startTabIdx=0,this.endTabIdx=null,this.sheetTabEventBind=function(){l(document).on("click",(function(e){l("#tablist-popup").has(e.target).length||"tabmore"===e.target.id||e.target.parentElement&&"tabmore"===e.target.parentElement.id||l("#tablist-popup").hide(),"header-tablist__input"!==e.target.id&&"cell-select-arrow-img"!==e.target.id&&"cell-select-arrow"!==e.target.id&&l("#tab-content").hide()})),a.Util.bindClickOrTouchEvent(l("#tabmore"),"tabmore--hover",t.sheetTabPopup),a.Util.bindClickOrTouchEvent(l("#sheet-prev"),"sheet-move--hover",t.moveSheetTab),a.Util.bindClickOrTouchEvent(l("#sheet-next"),"sheet-move--hover",t.moveSheetTab);for(var e=r.Browser.instance.isIOS&&!a.Util.isTabletInCSS(),n=0;n<t.maxPage;n++)a.Util.bindClickEvent(document.getElementById("sheet"+n),t.moveSheetEvent),a.Util.bindClickEvent(document.getElementById("tablist"+n),t.moveSheetEvent),!e&&a.Util.bindClickOrTouchEvent(l("#mobileTablist"+n),"tab-scroll-blind__li--hover",(function(e){t.moveSheetEvent(e),t.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC)}));if(e)l("#header-tablist__input, #cell-select-arrow").on("click",(function(){document.getElementById("header-tablist__select").focus()})),document.getElementById("header-tablist__select").addEventListener("change",(function(){t.eventObserver.sheet.notify({sheetIdx:document.getElementById("header-tablist__select").selectedIndex}),t.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC)}));else{var i=function(){if(l("#tab-content").toggle(),!l("#tab-content").is(":hidden")){var e=a.Util.isHtmlSkin(t.docInfo)?a.Util.getHeadScale(".wrap__header__container"):1;l("#tab-scroll-blind__ul").scrollTop((l("#mobileTablist"+t.docInfo.currentSheet).position().top-l("#mobileTablist0").position().top)/e),l(".tab-scroll-blind__li").removeClass("tab-scroll-blind--focus"),l("#mobileTablist"+t.docInfo.currentSheet).addClass("tab-scroll-blind--focus")}};a.Util.bindClickEvent(document.getElementById("header-tablist__input"),i),l("#cell-select-arrow").on("click",i)}a.Util.isTabletInCSS()&&r.Browser.instance.isSupportVisualViewport()&&(t.eventObserver.startViewportScroll.subscribe(t.startViewportScroll),t.eventObserver.endViewportScroll.subscribe(t.endViewportScroll),t.eventObserver.resizeWindow.subscribe(t.scaleSheetTabPostion))},this.startViewportScroll=function(){a.Util.isFullScreen()||(a.Util.addClass(document.getElementById("footer"),"hide"),a.Util.addClass(document.getElementById("tablist-popup"),"hide"))},this.endViewportScroll=function(){t.scaleSheetTabPostion(),a.Util.isFullScreen()||a.Util.removeClass(document.getElementById("footer"),"hide")},this.scaleSheetTabPostion=function(){u.ScaleEvent.scaleWithPosition(document.getElementById("footer"),u.TransformOriginType.LEFT_BOTTOM,0,40*u.ScaleEvent.getBrowserScale());var e=30*Math.min(t.maxPage,6)+20+2+40;u.ScaleEvent.scaleWithPosition(document.getElementById("tablist-popup"),u.TransformOriginType.LEFT_BOTTOM,23*u.ScaleEvent.getBrowserScale(),e*u.ScaleEvent.getBrowserScale())},this.createSheetTab=function(n){return i(t,void 0,e,(function(){var e,t,i,s,c,d,u,h,f,p,m,g;return o(this,(function(o){switch(o.label){case 0:e=document.createDocumentFragment(),t=document.createDocumentFragment(),(i=document.createElement("ul")).id="tablist-popup__ul",i.className="tablist-popup__ul",s=r.Browser.instance.isIOS,g=0,o.label=1;case 1:return g<this.maxPage?[4,this.getTitle(n.contextPath,n.status.id,g)]:[3,4];case 2:c=o.sent(),""===(d=c)&&(d="Sheet "+(g+1)),(u=document.createElement("div")).id="sheet"+g,u.className="sheet-list__sheet-tab",a.Util.removeContentsAreaTooltip()||(u.title=d),u.textContent=d,u.setAttribute("data-index",g.toString()),e.appendChild(u),(h=document.createElement("li")).id="tablist"+g,h.className="tablist-popup__li",a.Util.removeContentsAreaTooltip()||(h.title=d),h.textContent=d,h.setAttribute("data-index",g.toString()),i.appendChild(h),s?((f=document.createElement("option")).id="mobileTablist"+g,f.value=g,f.innerHTML=d,t.appendChild(f)):((p=document.createElement("li")).id="mobileTablist"+g,p.className="tab-scroll-blind__li",a.Util.removeContentsAreaTooltip()||(p.title=d),p.textContent=d,p.setAttribute("data-index",g.toString()),t.appendChild(p)),o.label=3;case 3:return g++,[3,1];case 4:for(document.getElementById("sheet-list").appendChild(e),document.getElementById("sheet-content").appendChild(i),s?((m=document.createElement("select")).id="header-tablist__select",m.className="header-tablist__select",m.appendChild(t),document.getElementById("header-tablist").appendChild(m)):document.getElementById("tab-scroll-blind__ul").appendChild(t),this.updateShowSheetTabIdx(),g=0;g<this.maxPage;g++)g>=this.showSheetTabIdx&&l("#sheet"+g).hide();return this.endTabIdx=this.showSheetTabIdx,[2]}}))}))},this.updateShowSheetTabIdx=function(){t.showSheetTabIdx=t.calcUpdateTabIdx(),t.endTabIdx=t.showSheetTabIdx},this.sheetTabPopup=function(){l("#tablist-popup").toggle(),l("#sheet-arrow").css("top",l("#sheet-content").height()+20),l("#sheet-content").is(":hidden")||(l("#tablist-popup__ul").scrollTop(l("#tablist"+t.docInfo.currentSheet).position().top-l("#tablist0").position().top),l(".tablist-popup__li").removeClass("tablist-popup--focus"),l("#tablist"+t.docInfo.currentSheet).addClass("tablist-popup--focus"))},this.moveSheetEvent=function(e){var n=parseInt(e.currentTarget.getAttribute("data-index"));t.eventObserver.sheet.notify({sheetIdx:n})},this.moveSheet=function(n){return i(t,void 0,e,(function(){return o(this,(function(e){switch(e.label){case 0:return this.validCheckSheet(n.sheetIdx)&&this.docInfo.currentSheet!==n.sheetIdx?[4,this.loadSheet(n.sheetIdx)]:[2];case 1:return e.sent(),this.sheetTabActive(n.sheetIdx),this.eventObserver.moveBtn.notify(),[2]}}))}))},this.validCheckSheet=function(e){if(e<0||e>=t.maxPage)return!1;if(!l("#sheet"+e).is(":visible")){if(e>=t.startTabIdx){for(var n=e-t.showSheetTabIdx,i=0;i<=n;i++)l("#sheet"+(i+t.showSheetTabIdx)).show(),l("#sheet"+i).hide();t.startTabIdx=n+1,t.endTabIdx=n+t.showSheetTabIdx}else{for(i=e;i<t.docInfo.currentSheet;i++)l("#sheet"+i).is(":visible")||l("#sheet"+i).show();var o=e+t.showSheetTabIdx;for(i=o;i<t.maxPage;i++)l("#sheet"+i).is(":visible")&&l("#sheet"+i).hide();t.startTabIdx=e,t.endTabIdx=o}l("#sheet"+e).show()}return!0},this.moveSheetTab=function(e){var n;n="sheet-next"===e.target.parentElement.id||"sheet-next"===e.target.id?t.docInfo.currentSheet+1:t.docInfo.currentSheet-1,t.eventObserver.sheet.notify({sheetIdx:n})},this.sheetTabActive=function(e){l(".sheet-list__sheet-tab").removeClass("sheet-list__sheet-tab--on"),l("#sheet"+e).addClass("sheet-list__sheet-tab--on"),document.getElementById("header-tablist__input").textContent=l("#mobileTablist"+e).text(),r.Browser.instance.isIOS&&l("#header-tablist__select option:eq("+e+")").prop("selected",!0),l("#tablist-popup").hide()},this.loadSheetTab=function(n){return i(t,void 0,e,(function(){var e=this;return o(this,(function(t){switch(t.label){case 0:return[4,this.createSheetTab(this.docInfo)];case 1:return t.sent(),l("#container").addClass("wrap__container--cell"),l("#footer").addClass("wrap__footer--cell"),this.showSheetTabIdx<this.maxPage&&l(".sheet-move").css("display","inline-block"),document.getElementById("header-tablist__input").textContent=l("#sheet0").text(),l("#header-tablist").addClass("cell-mobile"),l("#sheet"+n).addClass("sheet-list__sheet-tab--on"),this.sheetTabEventBind(),a.Util.isTabletInCSS()&&r.Browser.instance.isSupportVisualViewport()&&setTimeout((function(){e.scaleSheetTabPostion()}),500),[2]}}))}))},this.checkMoveControlbar=function(){0===t.docInfo.currentSheet?(l("#cell-first").removeClass("controlbar--enable"),l("#cell-first").removeClass("controlbar-first--hover"),l("#cell-first").prop("disabled",!0),l("#cell-prev").removeClass("controlbar--enable"),l("#cell-prev").removeClass("controlbar-prev--hover"),l("#cell-prev").prop("disabled",!0),l("#mobile-controlbar-prev__btn").addClass("mobile-controlbar-floating__btn--disabled"),l("#mobile-controlbar-prev__btn").prop("disabled",!0)):(l("#cell-first").addClass("controlbar--enable"),l("#cell-first").prop("disabled",!1),l("#cell-prev").addClass("controlbar--enable"),l("#cell-prev").prop("disabled",!1),l("#mobile-controlbar-prev__btn").removeClass("mobile-controlbar-floating__btn--disabled"),l("#mobile-controlbar-prev__btn").prop("disabled",!1)),t.docInfo.currentSheet===t.maxPage-1?(l("#cell-end").removeClass("controlbar--enable"),l("#cell-end").removeClass("controlbar-end--hover"),l("#cell-end").prop("disabled",!0),l("#cell-next").removeClass("controlbar--enable"),l("#cell-next").removeClass("controlbar-next--hover"),l("#cell-next").prop("disabled",!0),l("#mobile-controlbar-next__btn").addClass("mobile-controlbar-floating__btn--disabled"),l("#mobile-controlbar-next__btn").prop("disabled",!0)):(l("#cell-end").addClass("controlbar--enable"),l("#cell-end").prop("disabled",!1),l("#cell-next").addClass("controlbar--enable"),l("#cell-next").prop("disabled",!1),l("#mobile-controlbar-next__btn").removeClass("mobile-controlbar-floating__btn--disabled"),l("#mobile-controlbar-next__btn").prop("disabled",!1))},this.fullScreen=function(e){"cell"===e.skinType&&(e.isFullScreen?(l(document.body).addClass("wrap__contents--cell-fullscreen"),e.isSupport||(l(".wrap__header").addClass("wrap__header--presentation"),l(".wrap__footer").addClass("wrap__footer--presentation")),l("#container").addClass("wrap__container--presentation"),l("#container").removeClass("wrap__container--cell"),l("#contents").addClass("wrap__contents--cell-fullscreen")):(l(document.body).removeClass("wrap__contents--cell-fullscreen"),t.eventObserver.bgColor.notify(c.Head.bgColorMode),e.isSupport||(l(".wrap__header").removeClass("wrap__header--presentation"),l(".wrap__footer").removeClass("wrap__footer--presentation")),l("#container").removeClass("wrap__container--presentation"),l("#container").addClass("wrap__container--cell"),l("#contents").removeClass("wrap__contents--cell-fullscreen"),a.Util.isMobileMode()&&t.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC)))},this.calcUpdateTabIdx=function(){var e=document.body.clientWidth;return Math.floor((e-t.defaultSheetTabWidth)/t.sheetTabWidth)},this.sheetTabResize=function(){var e=t.calcUpdateTabIdx();if(e>=t.maxPage)return l(".sheet-move").hide(),l(".sheet-list__sheet-tab").removeAttr("style"),t.showSheetTabIdx=t.maxPage,void(t.startTabIdx=0);if(e!==t.showSheetTabIdx){if(l(".sheet-move").css("display","inline-block"),e>t.showSheetTabIdx){var n=t.startTabIdx+e;if(t.maxPage>=n)for(var i=t.startTabIdx;i<n;i++)l("#sheet"+i).show();else{for(r=(r=t.startTabIdx-n)-t.maxPage<0?r+t.maxPage:r-t.maxPage,i=t.startTabIdx;i>=r;i--)l("#sheet"+i).show();t.startTabIdx=r}}else if(e<t.showSheetTabIdx){var o=t.startTabIdx+e-1;if(t.docInfo.currentSheet>=o){var r;for(i=r=t.showSheetTabIdx-e+t.startTabIdx-1;i>=0;i--)l("#sheet"+i).hide();t.startTabIdx=r}else{var a=t.startTabIdx+e;for(i=a;i<=t.maxPage;i++)l("#sheet"+i).hide();t.endTabIdx=a}}t.showSheetTabIdx=e}},this.toggleMobileHeader=function(){d.default.isAnnotMode||a.Util.isMobileMode()&&!a.Util.isFullScreen()&&("none"===l(".wrap__header").css("display")?t.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC):t.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE))}};t.Sheet=h}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Presentation=void 0;var r=n(287),a=n(288),s=n(3),l=n(0),c=n(37),d=n(26),u=n(78),h=n(1),f=n(52),p=n(6),m=n(19),g=n(81),v=function(){function e(){var t=this;this.docInfo=null,this.eventObserver=null,this.maxPage=null,this.scrollContentAreaEl=h.Browser.instance.isIOS?s(document):s("#contents"),this.isSupport=!1,this.isPage=!0,this.isSheet=!1,this.isClickedFullscreenCloseBtn=!1,this.supportFullscreen=new a.SupportFullscreen,this.notSupportFullscreen=new r.NotSupportFullscreen,this.fullScreenChangeEvent=function(){["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach((function(e){return document.addEventListener(e,(function(){if(!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){var e=t.isSupport;t.isSupport=!1,t.isClickedFullscreenCloseBtn||t.fullScreenCloseBtnEvent(),t.isSupport=e,t.isClickedFullscreenCloseBtn=!1}}),!1)}))},this.isFullScreenSupport=function(){return!(l.Util.isHtmlSkin(t.docInfo)&&h.Browser.instance.isMobile)},this.fullScreenBtnEvent=function(e){if(!p.default.isAnnotMode){document.getElementById("contents").style.top="0",s(".fullscreen-close").show();var n=h.Browser.instance;n.isMobile&&t.isPage||l.Util.isHtmlWordSkin(t.docInfo)||(s(".fullscreen-move").show(),t.pageScrollEventBind(),t.checkFullscreenMoveBtn()),t.isFullScreenSupport()&&"keydown"===e.type&&n.isIE&&11===n.version&&(t.isSupport=!1),t.isPage&&!l.Util.isHtmlWordSkin(t.docInfo)&&(!n.isMobile&&t.pageMouseEventBind(),!t.isSupport&&t.changePageDocScrollStyle(),n.isIOS&&t.iosMobileEventBind()),t.beforeFullscreen(),t.presentationActions.fullscreenON(t.docInfo.skinType,t.isSupport);var i=t.scrollContentAreaEl.scrollTop(),o=t.scrollContentAreaEl.scrollLeft();"cell"===t.docInfo.skinType&&(document.getElementById("contents-area").focus(),t.scrollContentAreaEl.scrollTop(i),t.scrollContentAreaEl.scrollLeft(o))}},this.fullScreenCloseBtnEvent=function(){return i(t,void 0,void 0,(function(){var t,n,i;return o(this,(function(o){switch(o.label){case 0:return e.doingFullScreenCloseEvent=!0,this.afterFullscreen(),s(".fullscreen-close").removeAttr("style"),(t=h.Browser.instance).isMobile&&this.isPage||(s(".fullscreen-move").removeAttr("style"),this.pageScrollEventUnbind()),!t.isIOS&&s("#contents").css({"overflow-x":"","overflow-y":"","-ms-overflow-x":"","-ms-overflow-y":""}),this.isPage&&(!t.isMobile&&this.pageMouseEventUnbind(),t.isIOS&&this.iosMobileEventUnbind()),n=this.scrollContentAreaEl.scrollTop(),i=this.scrollContentAreaEl.scrollLeft(),[4,this.presentationActions.fullscreenOFF(this.docInfo.skinType,this.isSupport)];case 1:return o.sent(),"cell"===this.docInfo.skinType&&(document.getElementById("contents-area").focus(),this.scrollContentAreaEl.scrollTop(n),this.scrollContentAreaEl.scrollLeft(i)),e.doingFullScreenCloseEvent=!1,m.ScaleEvent.doScaleSkinContents(m.ScaleEvent.getBrowserScale()),[2]}}))}))},this.fullScreenEventBind=function(){l.Util.bindClickEvent(document.getElementById("presentation-btn"),t.fullScreenBtnEvent,!0),t.fullScreenChangeEvent(),l.Util.bindClickEvent(document.getElementById("fullscreen"),t.fullScreenBtnEvent,!0);s(".fullscreen-close").on(l.Util.getClickOrTouchEventName(),(function(e){t.isClickedFullscreenCloseBtn=!0,t.fullScreenCloseBtnEvent(),e.preventDefault()})),l.Util.bindEnterKey(document.getElementById("fullscreen-close")),t.isActiveFullscreenMoveBtn()&&(l.Util.bindClickOrTouchEvent(s("#fullscreen-prev"),"fullscreen-prev--hover",(function(){if("cell"===t.docInfo.skinType)t.eventObserver.sheet.notify({sheetIdx:t.docInfo.currentSheet-1});else{if(0===t.docInfo.currentPage)return;t.eventObserver.page.notify({pageNum:t.docInfo.currentPage-1,isScroll:!1})}})),l.Util.bindClickOrTouchEvent(s("#fullscreen-next"),"fullscreen-next--hover",(function(){if("cell"===t.docInfo.skinType)t.eventObserver.sheet.notify({sheetIdx:t.docInfo.currentSheet+1});else{if(t.docInfo.currentPage===t.docInfo.status.pageNum-1)return;t.eventObserver.page.notify({pageNum:t.docInfo.currentPage+1,isScroll:!1})}}))),s(window).on("keydown",(function(e){return t.fullScreenKeyDownEvent(e.originalEvent)}))},this.fullScreenKeyDownEvent=function(e){e.keyCode===f.keyMap.F11&&(e.preventDefault(),e.stopPropagation(),l.Util.isFullScreen()?(t.isClickedFullscreenCloseBtn=!0,t.fullScreenCloseBtnEvent()):t.fullScreenBtnEvent(e)),e.keyCode===f.keyMap.ESC&&l.Util.isFullScreen()&&(e.preventDefault(),e.stopPropagation(),t.fullScreenCloseBtnEvent())},this.checkFullscreenMoveBtn=function(){var e="cell"===t.docInfo.skinType?t.docInfo.currentSheet:t.docInfo.currentPage,n=s("#fullscreen-prev");0===e?(n.removeClass("fullscreen-prev--enable"),n.removeClass("fullscreen-prev--hover"),n.prop("disabled",!0)):(n.addClass("fullscreen-prev--enable"),n.prop("disabled",!1));var i=s("#fullscreen-next");e===t.docInfo.status.pageNum-1?(i.removeClass("fullscreen-next--enable"),i.removeClass("fullscreen-next--hover"),i.prop("disabled",!0)):(i.addClass("fullscreen-next--enable"),i.prop("disabled",!1))},this.isActiveFullscreenMoveBtn=function(){return!(h.Browser.instance.isMobile&&"cell"!==t.docInfo.skinType||l.Util.isHtmlWordSkin(t.docInfo)||l.Util.useSingle(t.docInfo))},this.pageMouseEventBind=function(){document.oncontextmenu=function(){return!1};var e=s("#contents-area");e.on("mousedown.fullscreen",(function(e){if(l.Util.isHtmlSlideSkin(t.docInfo)||l.Util.fixedPageFit()||!c.DetectZoom||100===c.DetectZoom.getRatio()){var n=-1;if(e&&e instanceof Object&&void 0!==e.button?n=e.button:window.event&&void 0!==window.event.button&&(n=window.event.button),0===n||2===n){var i=-1;switch(n){case 0:i=t.docInfo.currentPage+1;break;case 2:i=t.docInfo.currentPage-1}t.movePage(i)}}})),l.Util.isHtmlSlideSkin(t.docInfo)||e.on("wheel.fullscreen",(function(e){if(l.Util.fixedPageFit()||!c.DetectZoom||100===c.DetectZoom.getRatio()){var n=-1;e.originalEvent.ctrlKey||(n=e.originalEvent.deltaY<0?t.docInfo.currentPage-1:t.docInfo.currentPage+1),t.movePage(n)}}))},this.pageMouseEventUnbind=function(){l.Util.allowCopy()&&(document.oncontextmenu=function(){return!0});var e=s("#contents-area");e.off("mousedown.fullscreen"),e.off("wheel.fullscreen"),e.off("scroll.fullscreen")},this.pageScrollEventBind=function(){var e;"cell"!==t.docInfo.skinType&&t.scrollContentAreaEl.on("scroll.fullscreen",(function(){l.Util.isFullScreen()&&(clearTimeout(e),e=setTimeout(t.checkFullscreenMoveBtn,80))}))},this.pageScrollEventUnbind=function(){t.scrollContentAreaEl.off("scroll.fullscreen")},this.movePage=function(e){isNaN(e)||e<0||e>t.maxPage-1||t.eventObserver.page.notify({pageNum:e,isScroll:!1})},this.resizeWindow=function(){(!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled)&&!h.Browser.instance.isEdge?!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement):l.Util.isFullScreen())&&t.changePageDocScrollStyle(),d.Page.updateFullscreenCloseBtn(t.docInfo)},this.changePageDocScrollStyle=function(){if("cell"!==t.docInfo.skinType&&!l.Util.isHtmlWordSkin(t.docInfo))return!h.Browser.instance.isMobile&&(l.Util.fixedPageFit()||void 0===c.DetectZoom||100===c.DetectZoom.getRatio())||h.Browser.instance.isMobile&&d.Page.RESIZE_OBJ.type===d.RESIZE_TYPE.PageFit?(!h.Browser.instance.isIOS&&s("#contents").css({"overflow-y":"hidden","overflow-x":"auto"}),void t.movePage(t.docInfo.currentPage)):void(h.Browser.instance.isIOS||!h.Browser.instance.isMobile&&l.Util.isHtmlSlideSkin(t.docInfo)||(s("#contents").css({"overflow-y":"auto","overflow-x":"auto"}),s(".contents-page > img").css("overflow-x","scroll")))},this.doubleTap=function(){l.Util.isFullScreen()&&"cell"!==t.docInfo.skinType&&(h.Browser.instance.isIOS||d.Page.RESIZE_OBJ.type!==d.RESIZE_TYPE.PageFit||t.scrollContentAreaEl.scrollTop(document.getElementById("page-area"+t.docInfo.currentPage).offsetTop),t.changePageDocScrollStyle())},this.swipe=function(e){switch(e){case u.SWIPE_DIRECTION.LEFT:case u.SWIPE_DIRECTION.UP:t.movePage(t.docInfo.currentPage+1);break;case u.SWIPE_DIRECTION.RIGHT:case u.SWIPE_DIRECTION.DOWN:t.movePage(t.docInfo.currentPage-1)}},this.fullscreenSingleTap=function(){"cell"===t.docInfo.skinType?t.eventObserver.sheet.notify({sheetIdx:t.docInfo.currentSheet+1}):t.movePage(t.docInfo.currentPage+1)},this.iosMobileEventBind=function(){document.documentElement.addEventListener("touchmove",t.iosTouchMoveEvent,l.Util.nonPassiveEventListenerOption)},this.iosMobileEventUnbind=function(){document.documentElement.removeEventListener("touchmove",t.iosTouchMoveEvent,l.Util.nonPassiveEventListenerOption)},this.iosTouchMoveEvent=function(e){d.Page.RESIZE_OBJ.type===d.RESIZE_TYPE.PageFit&&e.preventDefault()},this.beforeFullscreen=function(){if(t.isSupport&&!l.Util.isCellSkin(t.docInfo)&&l.Util.isConvImg(t.docInfo)){var e=document.documentElement.clientHeight;document.getElementById("contents-area").style.paddingBottom=e+"px"}g.MouseScroll.instance.isActive&&(document.getElementById("contents").style.cursor="")},this.afterFullscreen=function(){document.getElementById("contents-area").style.paddingBottom="",g.MouseScroll.instance.isActive&&(document.getElementById("contents").style.cursor="grab")},this.eventBind=function(e){t.eventObserver=e,t.eventObserver.resizeWindow.subscribe(t.resizeWindow),t.eventObserver.doubleTap.subscribe(t.doubleTap),t.eventObserver.swipe.subscribe(t.swipe),t.eventObserver.fullscreenSingleTap.subscribe(t.fullscreenSingleTap),t.eventObserver.moveBtn.subscribe(t.checkFullscreenMoveBtn),t.fullScreenEventBind(),t.presentationActions.eventBind(t.eventObserver)},this.load=function(e,n){t.docInfo=e,t.maxPage=t.docInfo.status.pageNum;var i=h.Browser.instance;(i.isChrome||i.isFirefox||i.isSafari||i.isAndroid||i.isEdge||i.isIE&&11===i.version)&&t.isFullScreenSupport()?(t.isSupport=!0,t.presentationActions=t.supportFullscreen):t.presentationActions=t.notSupportFullscreen,"cell"===t.docInfo.skinType&&(t.isPage=!1,t.isSheet=!0),t.eventBind(n)}}return e.doingFullScreenCloseEvent=!1,e}();t.Presentation=v}).call(this,n(4))},function(e,t,n){"use strict";(function(e,i){var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ImagePage=void 0;var l=n(1),c=n(0),d=n(3),u=n(80),h=n(291),f=n(292),p=n(293),m=n(53),g=n(26),v=n(6),b=n(294),y=n(81),E=function(t){function n(){var o=t.call(this)||this;return o.rotateMap=new i,o.pageFitAction=new h.PageFit,o.pageWidthFitAction=new f.PageWidthFit,o.pageZoomAction=new p.PageZoom,o.dpiPage=null,o.setOriginMargin=function(){var e=g.Page.ORIGIN_SIZE[0].height?1141/g.Page.ORIGIN_SIZE[0].height:1;g.Page.ORIGIN_MARGIN={marginTop:parseInt(d(".contents-page").css("margin-top"))/e,marginBottom:parseInt(d(".contents-page").css("margin-bottom"))/e}},o.getDimensionImg=function(t,n,i,r){return a(o,void 0,e,(function(){var e,o,a;return s(this,(function(s){switch(s.label){case 0:return n=void 0!==n?n:0,e=t.contextPath+"/dimension/"+t.status.id+"/"+n+"-"+i+"?dpi="+r,this.docInfo.status.imageConverting&&(e=t.contextPath+"/dimension/"+n+"-"+i+".js?dpi="+r),o=[],[4,c.Util.getJson(e)];case 1:return a=s.sent(),d.each(a,(function(e,t){var n={index:t.p,width:t.w,height:t.h,origin_width:t.w_o,origin_height:t.h_o};o[t.p]=n})),[2,o]}}))}))},o.getDimensionHtml=function(e){return a(o,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return t=e.resultPath+"/"+e.status.fileName+".xml",[4,c.Util.getXml(t)];case 1:return n=i.sent(),"image"===e.skinType?[2,c.Util.getDimensionHtmlForImage(n)]:[2,c.Util.getDimensionHtmlForPDF(n)]}}))}))},o.createContentDiv=function(e){return a(o,void 0,void 0,(function(){var t,i,o,r,a,l,u;return s(this,(function(s){switch(s.label){case 0:return t=null,c.Util.isConvHtml(this.docInfo)?[4,this.getDimensionHtml(e)]:[3,2];case 1:return t=s.sent(),[3,4];case 2:return[4,this.getDimensionImg(e,0,e.status.pageNum,this.dpiPage.ORIGINAL_DPI)];case 3:t=s.sent(),this.fitSmallImage(t),s.label=4;case 4:for(i=document.createDocumentFragment(),o=0,r=t;o<r.length;o++)a=r[o],g.Page.ORIGIN_SIZE[a.index]={width:a.width,height:a.height,origin_width:a.origin_width,origin_height:a.origin_height},(l=document.createElement("img")).className="contents-page__img img-loading",l.src=this.transparentImg,l.alt="page "+a.index,c.Util.isConvHtml(this.docInfo)&&(g.Page.ORIGIN_SIZE[a.index].path=a.path),a.index<n.initPageNum&&this.onLoadImg(l,a.index),(u=document.createElement("div")).id="page-area"+a.index,u.className="contents-page",l.id="page"+a.index,c.Util.removeContentsAreaTooltip()||(l.title="page"+(a.index+1)),l.setAttribute("data-index",a.index.toString()),u.appendChild(l),i.appendChild(u);return d("#contents-area").append(i),this.setOriginMargin(),d("#page-area0").addClass("contents-page--start"),d("#page-area"+(this.docInfo.status.pageNum-1)).addClass("contents-page--end"),this.pageResizeAction.resizePage(g.Page.RESIZE_OBJ.percent,this.rotateMap,0,n.initPageNum),this.checkResizeControlBar(),[2]}}))}))},o._zoomCalculation=function(e,t){for(var n=Number(document.getElementById("page0").style.width.replace("px","")),i=g.Page.RESIZE_OBJ.percent,r=l.Browser.instance.isMobile||100===o.curZoomFactor?1:o.curZoomFactor/100,a=0,s=e;a<s.length;a++){var c=s[a],d=c/100*g.Page.ORIGIN_SIZE[0].width*r;if(t(d,n)&&!(Math.abs(d-n)<1)){i=c;break}}return i},o._zoomCalculationForPrint=function(){var e=l.Browser.instance.isMobile||100===o.curZoomFactor?1:o.curZoomFactor/100;return 794/(g.Page.ORIGIN_SIZE[0].width*e)*100},o.zoomPage=function(e){var t=null;switch(e){case u.ZOOM_TYPE.ZoomOut:t=o._zoomCalculation(u.Controlbar.ZOOM_LIST.slice().reverse(),(function(e,t){return e<t}));break;case u.ZOOM_TYPE.ZoomIn:t=o._zoomCalculation(u.Controlbar.ZOOM_LIST,(function(e,t){return e>t}));break;case u.ZOOM_TYPE.OriginSize:t=100;break;case u.ZOOM_TYPE.PrintA4:t=o._zoomCalculationForPrint()}t!==g.Page.RESIZE_OBJ.percent&&(g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageZoom,percent:t},o.changeDPIContentDiv(o.docInfo.currentPage),o.pageResizeAction=o.pageZoomAction,o.pageResizeAction.resizePage(t,o.rotateMap),o.eventObserver.resizePage.notify(),o.checkResizeControlBar(),o.lastTop=null)},o.changeDPIContentDiv=function(e){return a(o,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return c.Util.isServer(this.docInfo)&&c.Util.isConvImg(this.docInfo)?this.dpiPage.hasHighDPIRatio()?[3,2]:[4,this.getDimensionImg(this.docInfo,0,1,this.dpiPage.HIGH_DPI)]:[2];case 1:t=n.sent(),this.dpiPage.setHighDPIRatio(g.Page.ORIGIN_SIZE[0].width,t[0].width),n.label=2;case 2:return this.dpiPage.changeDPI(g.Page.RESIZE_OBJ.percent)?(this.loadPageImg(e),[2]):[2]}}))}))},o.loadPageImg=function(e){for(var t=o.getDefaultLoadingCnt(),n=e-t<0?e:e-t,i=e+t>o.docInfo.status.pageNum?o.docInfo.status.pageNum:e+t,r=o.getLoadingClassSelector(),a=n;a<i;a++){var s=document.getElementById("page"+a);if(s.className.indexOf(r)>-1)o.onLoadImg(s,a);else if(c.Util.isServer(o.docInfo)&&c.Util.isConvImg(o.docInfo)){if(o.dpiPage.isEqualDPI(s.src))continue;var l={idx:a,width:g.Page.ORIGIN_SIZE[e].width,height:g.Page.ORIGIN_SIZE[e].height};s.src=o.dpiPage.getNewPath(l)}}},o.getLoadingClassSelector=function(){return m.Head.bgColorMode===m.BGCOLOR_MODE.lightScreen?"img-loading-bright":"img-loading"},o.rotatePage=function(){var e=o.docInfo.currentPage,t=o.rotateMap.get(e);o.rotateMap.set(e,void 0===t?90:(t+90)%360);var n=o.rotateMap.get(e);d("#page"+e).removeClass("transform0 transform90 transform180 transform270"),d("#page"+e).css({margin:"",marginTop:"",marginBottom:""}),d("#page"+e).addClass("transform"+n),o.pageResizeAction.resizePage(g.Page.RESIZE_OBJ.percent,o.rotateMap,e,1),o.checkResizeControlBar(),o.lastTop=null},o.rotateEvent=function(){c.Util.bindClickOrTouchEvent(d("#page-rotate"),"controlbar-rotate--hover",(function(){o.rotatePage(),g.Page.RESIZE_OBJ.type===g.RESIZE_TYPE.PageFit&&o.scrollContentAreaEl.scrollTop(g.Page.getPageScrollTop(o.docInfo.currentPage))}))},o.checkResizeControlBar=function(){var e=g.Page.RESIZE_OBJ.percent;g.Page.RESIZE_OBJ.type!==g.RESIZE_TYPE.PageFit&&g.Page.RESIZE_OBJ.type!==g.RESIZE_TYPE.PageWidthFit||(e=Number(document.getElementById("page0").style.width.replace("px",""))/g.Page.ORIGIN_SIZE[0].width*100);e<=u.Controlbar.ZOOM_LIST[0]?(d("#page-zoomout").removeClass("controlbar--enable"),d("#page-zoomout").removeClass("controlbar-zoomout--hover"),d("#page-zoomout").prop("disabled",!0),d("#mobile-controlbar-zoomout__btn").addClass("mobile-controlbar-floating__btn--disabled"),d("#mobile-controlbar-zoomout__btn").prop("disabled",!0)):(d("#page-zoomout").addClass("controlbar--enable"),d("#page-zoomout").prop("disabled",!1),d("#mobile-controlbar-zoomout__btn").removeClass("mobile-controlbar-floating__btn--disabled"),d("#mobile-controlbar-zoomout__btn").prop("disabled",!1)),e>=u.Controlbar.ZOOM_LIST[u.Controlbar.ZOOM_LIST.length-1]?(d("#page-zoomin").removeClass("controlbar--enable"),d("#page-zoomin").removeClass("controlbar-zoomin--hover"),d("#page-zoomin").prop("disabled",!0),d("#mobile-controlbar-zoomin__btn").addClass("mobile-controlbar-floating__btn--disabled"),d("#mobile-controlbar-zoomin__btn").prop("disabled",!0)):(d("#page-zoomin").addClass("controlbar--enable"),d("#page-zoomin").prop("disabled",!1),d("#mobile-controlbar-zoomin__btn").removeClass("mobile-controlbar-floating__btn--disabled"),d("#mobile-controlbar-zoomin__btn").prop("disabled",!1)),g.Page.RESIZE_OBJ.type!==g.RESIZE_TYPE.PageFit&&g.Page.RESIZE_OBJ.type!==g.RESIZE_TYPE.PageWidthFit&&100===e?(d("#page-originsize").addClass("controlbar-originsize--hover"),d("#page-originsize").prop("disabled",!0)):(d("#page-originsize").removeClass("controlbar-originsize--hover"),d("#page-originsize").prop("disabled",!1)),g.Page.RESIZE_OBJ.type===g.RESIZE_TYPE.PageFit?(d("#page-pagefit").addClass("controlbar-pagefit--hover"),d("#page-pagefit").prop("disabled",!0)):(d("#page-pagefit").removeClass("controlbar-pagefit--hover"),d("#page-pagefit").prop("disabled",!1)),g.Page.RESIZE_OBJ.type===g.RESIZE_TYPE.PageWidthFit?(d("#page-pagewidthfit").addClass("controlbar-pagewidthfit--hover"),d("#page-pagewidthfit").prop("disabled",!0)):(d("#page-pagewidthfit").removeClass("controlbar-pagewidthfit--hover"),d("#page-pagewidthfit").prop("disabled",!1))},o.bindControlbarEvent=function(){c.Util.bindClickOrTouchEvent(d("#page-pagefit"),"controlbar-pagefit--hover",(function(){g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageFit,percent:0},o.changeDPIContentDiv(o.docInfo.currentPage),o.pageResizeAction=o.pageFitAction,o.pageResizeAction.resizePage(0,o.rotateMap),o.checkResizeControlBar(),o.lastTop=null,o.scrollContentAreaEl.scrollTop(g.Page.getPageScrollTop(o.docInfo.currentPage)),o.eventObserver.resizePage.notify()}),(function(){o.checkResizeControlBar()})),c.Util.bindClickOrTouchEvent(d("#page-pagewidthfit"),"controlbar-pagewidthfit--hover",(function(){g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageWidthFit,percent:0},o.changeDPIContentDiv(o.docInfo.currentPage),o.pageResizeAction=o.pageWidthFitAction,o.pageResizeAction.resizePage(0,o.rotateMap),o.checkResizeControlBar(),o.lastTop=null,o.eventObserver.resizePage.notify()}),(function(){o.checkResizeControlBar()})),c.Util.bindClickOrTouchEvent(d("#page-originsize"),"controlbar-originsize--hover",(function(){o.zoomPage(u.ZOOM_TYPE.OriginSize)}),(function(){o.checkResizeControlBar()})),c.Util.bindClickOrTouchEvent(d("#page-zoomout"),"controlbar-zoomout--hover",(function(){o.zoomPage(u.ZOOM_TYPE.ZoomOut)})),c.Util.bindClickOrTouchEvent(d("#page-zoomin"),"controlbar-zoomin--hover",(function(){o.zoomPage(u.ZOOM_TYPE.ZoomIn)})),c.Util.bindClickOrTouchEvent(d("#page-prev"),"controlbar-prev--hover",o.moveBackPage),c.Util.bindClickOrTouchEvent(d("#page-next"),"controlbar-next--hover",o.moveNextPage),c.Util.bindClickOrTouchEvent(d("#page-hand-scroll"),"controlbar-hand-scroll--hover",y.MouseScroll.instance.bindDesktopControlbar({elem:document.getElementById("page-hand-scroll"),selector:"controlbar-hand-scroll--hover"}),y.MouseScroll.instance.mouseOut),o.checkMoveControlbar(),(c.Util.rotateImage(o.docInfo)||c.Util.rotatePdf(o.docInfo))&&(d("#page-docfit").removeClass("controlbar__end-block").addClass("controlbar__block"),d("#rotate-seperator").removeClass("controlbar--hide"),d("#page-rotate").removeClass("controlbar--hide"),o.rotateEvent())},o.onLoadImg=function(e,t){var n=new Image;if(c.Util.isConvHtml(o.docInfo))n.src=""+c.Util.getResultPath(o.docInfo,g.Page.ORIGIN_SIZE[t].path);else{var i={idx:t,imgEl:n,width:g.Page.ORIGIN_SIZE[t].width,height:g.Page.ORIGIN_SIZE[t].height};n.src=o.dpiPage.getNewPath(i)}n.onload=function(){c.Util.removeClass(e.parentElement,o.getLoadingClassSelector()),e.className="contents-page__img";var n=document.getElementById("annotationlayer"+t);n&&c.Util.removeClass(n,"annotationlayer--hide")},e.removeEventListener("click",o.retry),n.onerror=function(){c.Util.removeClass(e.parentElement,o.getLoadingClassSelector()),e.src=o.transparentImg,e.className+=" img-retry contents-page__img--error",e.addEventListener("click",o.retry)},e.src=n.src},o.retry=function(e){var t=parseInt(e.target.getAttribute("data-index")),n=document.getElementById("page"+t);c.Util.addClass(n.parentElement,o.getLoadingClassSelector()),o.onLoadImg(n,t)},o.isFitAction=function(){return o.pageResizeAction===o.pageFitAction},o.setFitAction=function(){o.preResizeObj=g.Page.RESIZE_OBJ,o.prePageAction=o.pageResizeAction,g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageFit,percent:0},o.pageResizeAction=o.pageFitAction},o.getRotateMap=function(){return o.rotateMap},o._innerResizeWindow=function(){d(".contents-page").removeAttr("style"),o.setOriginMargin(),o.pageResizeAction.resizePage(g.Page.RESIZE_OBJ.percent,o.rotateMap)},o.doubleTap=function(){return a(o,void 0,void 0,(function(){var e,t=this;return s(this,(function(n){switch(n.label){case 0:return l.Browser.instance.isIOS&&c.Util.isFullScreen()&&g.Page.RESIZE_OBJ.type!==g.RESIZE_TYPE.PageFit&&document.body.clientWidth/window.innerWidth*100!=100||v.default.isAnnotMode?[2]:(g.Page.RESIZE_OBJ.type===g.RESIZE_TYPE.PageFit?(g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageWidthFit,percent:0},this.pageResizeAction=this.pageWidthFitAction):(g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageFit,percent:0},this.pageResizeAction=this.pageFitAction),l.Browser.instance.isIOS?(e=this.docInfo.currentPage,d("#contents-area").css("visibility","hidden"),d("#wrap__index").css("visibility","hidden"),d("#page__input").css("color","#333333"),this.scrollContentAreaEl.scrollTop(g.Page.getPageScrollTop("0")),[4,c.Util.syncTimer((function(){return t.pageResizeAction.resizePage(0,t.rotateMap)}),200)]):[3,3]);case 1:return n.sent(),this.eventObserver.page.notify({pageNum:e,isScroll:!1}),[4,c.Util.syncTimer((function(){d("#contents-area").css("visibility",""),d("#wrap__index").css("visibility",""),d("#page__input").css("color","")}),100)];case 2:return n.sent(),this.checkResizeControlBar(),this.lastTop=null,[3,4];case 3:this.pageResizeAction.resizePage(0,this.rotateMap),this.checkResizeControlBar(),this.lastTop=null,n.label=4;case 4:return this.eventObserver.resizePage.notify(),[2]}}))}))},o.fullscreenAfterEvent=function(){},o.printBeforeEvent=function(){o.setFitAction(),o.zoomPage(u.ZOOM_TYPE.PrintA4),o.eventObserver.resizePage.notify()},o.printAfterEvent=function(){g.Page.RESIZE_OBJ=o.preResizeObj,o.pageResizeAction=o.prePageAction,o.pageResizeAction.resizePage(g.Page.RESIZE_OBJ.percent,o.rotateMap),o.checkResizeControlBar(),o.eventObserver.resizePage.notify()},o.eventBind=function(e){o.eventObserver=e,o.eventObserver.page.subscribe(o.focusPage),o.eventObserver.resizeWindow.subscribe(o.resizeWindow),o.eventObserver.fullScreen.subscribe(o.fullScreen),o.eventObserver.singleTap.subscribe(o.singleTap),o.eventObserver.doubleTap.subscribe(o.doubleTap),o.eventObserver.orientationchange.subscribe(o.orientationchange),o.eventObserver.moveBtn.subscribe(o.checkMoveControlbar),o.eventObserver.annotMode.subscribe(o.annotMode),o.eventObserver.printbefore.subscribe(o.printBeforeEvent),o.eventObserver.printafter.subscribe(o.printAfterEvent),o.eventObserver.zoom.subscribe(o.zoomPage),o.docInfo.status.pageNum>n.initPageNum&&o.eventObserver.initLoadAfter.subscribe((function(){o.pageResizeAction.resizePage(g.Page.RESIZE_OBJ.percent,o.rotateMap,n.initPageNum,o.docInfo.status.pageNum-n.initPageNum)})),o.scrollEventBind(),o.mouseEventBind()},o.setTabIndex=function(){for(var e=c.Util.setTabIndexList(),t=document.getElementById("select-arrow").tabIndex,n=0;n<o.docInfo.status.pageNum;n++)c.Util.setTabIndex(document.getElementById("pagelist"+(n+1)),t),c.Util.setTabIndex(document.getElementById("page-area"+n),e)},o.setFitConfig=function(){switch(l.Browser.instance.isMobile?window.localSynap.config.loadingPageFitTypeForMobile:window.localSynap.config.loadingPageFitType){case 1:g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageWidthFit,percent:0},o.pageResizeAction=o.pageWidthFitAction;break;case 2:g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageZoom,percent:100},o.pageResizeAction=o.pageZoomAction;break;case 0:default:g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageFit,percent:0},o.pageResizeAction=o.pageFitAction}},o.fitSmallImage=function(e){var t;if(!l.Browser.instance.isMobile&&!c.Util.isConvHtml(o.docInfo)&&"image"===o.docInfo.skinType){var n=100!==o.curZoomFactor?o.curZoomFactor/100:1,i=l.Browser.instance.isIOS&&c.Util.isFullScreen()?window.innerHeight:d("#contents").height(),r=[d("#contents").width(),i],a=o.pageResizeAction.getResizeResult(!1,e[0].width,e[0].height,r),s=a[0],u=a[1];s=(t=[s*n,u*n])[0],u=t[1],"tiff"!==o.docInfo.fileType&&e[0].width<s&&e[0].height<u&&(g.Page.RESIZE_OBJ={type:g.RESIZE_TYPE.PageZoom,percent:100},o.pageResizeAction=o.pageZoomAction)}},o.load=function(e,n){return a(o,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return t.prototype.load.call(this,e,n),this.bindControlbarEvent(),this.setFitConfig(),this.dpiPage=new b.DPIPage(e),[4,this.createContentDiv(this.docInfo)];case 1:return i.sent(),this.setTabIndex(),this.eventBind(n),this.eventObserver.resizeContents.notify(),[2]}}))}))},o.setDefaultLoadingCnt(5),o}return r(n,t),n.initPageNum=5,n}(g.Page);t.ImagePage=E}).call(this,n(4),n(41))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinkLayer=t.convertSheetLinkCoordinate=void 0;var r=n(3),a=n(1),s=n(0),l=n(30),c=n(16),d=n(33),u=n(167),h=n(65);function f(e,t,n){var i=[];for(var o in e){var r=e[o]["@attributes"],a=r.l,s=r.t;e[o]["@attributes"].l=parseFloat(a)+t,e[o]["@attributes"].t=parseFloat(s)+n,i.push(e[o])}return i}t.convertSheetLinkCoordinate=f;var p=function(){function e(){var t=this;this.docInfo=null,this.eventObserver=null,this.parseLinkInfo=function(e){var t=e["@attributes"],n=t.l,i=t.t,o=t.w,r=t.h;return{target:e.target,page:e.page,left:parseFloat(n),top:parseFloat(i),width:parseFloat(o),height:parseFloat(r)}},this.movePage=function(e){var n=parseInt(e.currentTarget.getAttribute("data-index"))-1;if((s.Util.isCellSkin(t.docInfo)?t.docInfo.currentSheet:t.docInfo.currentPage)!==n){var i=t.docInfo.status.pageNum;isNaN(n)||n<0||n>i||(s.Util.isCellSkin(t.docInfo)?t.eventObserver.sheet.notify({sheetIdx:n}):t.eventObserver.page.notify({pageNum:n,isScroll:!1}))}},this.createLinkSvg=function(e,n,c,d){return i(t,void 0,void 0,(function(){var t,i,u,h,f,p,m,g,v,b,y,E,I,S,w=this;return o(this,(function(o){if(t=l.default.instance.getPageOrCurrentSheetRatio(n,s.Util.isCellSkin(this.docInfo)),!(i=document.getElementById("annotationlayer"+n)))return this.docInfo.currentSheet===n&&setTimeout((function(){w.createLinkSvg(e,n,c,d)}),100),[2];if(a.Browser.instance.isMobile&&(i.oncontextmenu=function(){return!1}),(u=document.getElementById("linksLayer"+n))||((u=document.createElement("div")).id="linksLayer"+n,i.appendChild(u)),h=s.Util.isCellSkin(this.docInfo)?"linkLayer"+n+"-"+c+"-"+d:"linkLayer"+n,f=document.getElementById(h))return[2];for((f=document.createElement("div")).id=h,p=0;p<e.link.length;p++)m=this.parseLinkInfo(e.link[p]),g=m.target,v=m.page,b=m.left,y=m.top,E=m.width,I=m.height,(S=g?document.createElement("a"):document.createElement("div")).className="link",S.style.cssText="left:"+b*t+"px;top:"+y*t+"px;width:"+E*t+"px;height:"+I*t+"px",s.Util.setTabIndex(S,0),void 0!==g?(S.setAttribute("href",g),S.setAttribute("title",g),S.setAttribute("target","_blank")):void 0!==v&&(S.setAttribute("data-index",v),s.Util.bindClickEvent(S,this.movePage)),f.appendChild(S);return u.appendChild(f),r("#page-area"+n).append(i),[2]}))}))},this.setTextObj=function(e){return i(t,void 0,void 0,(function(){var t,n;return o(this,(function(i){switch(i.label){case 0:return[4,c.default.getXml(this.docInfo,e,this.docInfo.dpi)];case 1:return t=i.sent(),null==(n=t.result)&&(n=""),this.textObj[e]={"@attributes":t.page,link:t.link,text:t.text,allText:n},[2]}}))}))},this._loadTextXml=function(n){return i(t,void 0,void 0,(function(){var t;return o(this,(function(i){switch(i.label){case 0:return null!=this.textObj&&null!=this.textObj[n]?[3,2]:[4,this.setTextObj(n)];case 1:i.sent(),i.label=2;case 2:return this.textObj[n].link.length&&(document.getElementById(""+e.getLinkId(n,0))?(t=document.getElementById("annotationlayer"+n),this.updateLinkPosition(t,n)):this.createLinkSvg(this.textObj[n],n,1,1)),[2]}}))}))},this.loadTextXml=function(e){return i(t,void 0,void 0,(function(){var t,n;return o(this,(function(i){switch(i.label){case 0:return t=c.default.getAnnotLoadingRange(this.docInfo,e),[4,this._loadTextXml(e)];case 1:for(i.sent(),n=t.startIdx;n<t.endIdx;n++)e!==n&&this._loadTextXml(n);return[2]}}))}))},this.sheetChangeTile=function(e){return i(t,void 0,void 0,(function(){var t,n,i,r,a,l,d,p;return o(this,(function(o){switch(o.label){case 0:return t=this.docInfo.currentSheet,n=t+"_"+e.x+"_"+e.y,null!=this.textObj[n]?[3,2]:(i=document.getElementById("linksLayer"+t),[4,c.default.getSheetTileXml(this.docInfo,t,this.docInfo.dpi,e.x,e.y,e.w,e.h)]);case 1:r=o.sent(),(a=r.result)||(a=""),void 0!==this.textObj[n]&&void 0!==i||(this.textObj[n]={"@attributes":r.page,link:[],cells:null,allText:a.toLowerCase()}),l=f(r.link,e.x,e.y),this.textObj[n].link=l,s.Util.isUseSearch(this.docInfo)&&r.cells&&(d=u.convertSheetCellCoordinate(r.cells,e.x,e.y),this.textObj[n].cells=d),p=h.TextLayer.getLocalStorageText(this.docInfo.jobId),s.Util.isUseSearch(this.docInfo)&&!p[n]&&(p[n]=this.textObj[n].allText.toLowerCase(),h.TextLayer.setLocalStorageText(this.docInfo.jobId,p)),o.label=2;case 2:return this.createLinkSvg(this.textObj[n],t,e.x,e.y),[2]}}))}))},this.focusPage=function(e){return i(t,void 0,void 0,(function(){return o(this,(function(t){return this.loadTextXml(e.pageNum),[2]}))}))},this.fullScreen=function(e){e.isFullScreen?r(".link").addClass("link--hide"):r(".link").removeClass("link--hide")},this.getLinkInfoArr=function(e){if(s.Util.isCellSkin(t.docInfo)){var n=Object.keys(t.textObj);n=n.filter((function(t){return t.startsWith(e+"_")}));for(var i=[],o=0;o<n.length;o++)i=i.concat(t.textObj[n[o]].link);return i}return t.textObj[e].link},this.updateLinkPosition=function(e,n){var i=Array.prototype.slice.call(e.getElementsByClassName("link"));if(0!==i.length){var o=l.default.instance.getPageOrCurrentSheetRatio(n,s.Util.isCellSkin(t.docInfo)),r=t.getLinkInfoArr(n);if(s.Util.toFixedNumber(i[0].style.width,2)!==s.Util.toFixedNumber(r[0]["@attributes"].w*o,2))for(var a in i){var c=r[a]["@attributes"],d=c.l,u=c.t,h=c.w,f=c.h;i[a].style.cssText="left:"+d*o+"px;top:"+u*o+"px;width:"+h*o+"px;height:"+f*o+"px"}}},this.loadFirstSheet=function(){return i(t,void 0,void 0,(function(){var e,t,n,i,r,a,s,l,c;return o(this,(function(o){switch(o.label){case 0:e=d.ImageSheet.getEndRowCol(),t=e.endRow,n=e.endCol,i=0,o.label=1;case 1:if(!(i<=t))return[3,6];r=0,o.label=2;case 2:return r<=n?(a=d.ImageSheet.getSheetSize(i,r),s=a.sheetWidth,l=a.sheetHeight,c={x:1+d.ImageSheet.defaultCellWidth*r,y:1+d.ImageSheet.defaultCellHeight*i,w:s,h:l},[4,this.sheetChangeTile(c)]):[3,5];case 3:o.sent(),o.label=4;case 4:return r++,[3,2];case 5:return i++,[3,1];case 6:return[2]}}))}))},this.eventBind=function(e){t.eventObserver=e,t.eventObserver.sheetChangeTile.subscribe(t.sheetChangeTile),t.eventObserver.page.subscribe(t.focusPage),t.eventObserver.fullScreen.subscribe(t.fullScreen)},this.load=function(e,n,r){return i(t,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.docInfo=e,this.textObj=n,this.eventBind(r),s.Util.isCellSkin(this.docInfo)?[3,2]:[4,this.loadTextXml(this.docInfo.currentPage)];case 1:return t.sent(),[3,4];case 2:return[4,this.loadFirstSheet()];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}}return e.getLinkId=function(e,t){return"link-"+e+"-"+t},e}();t.LinkLayer=p}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CellTextLayer=t.convertSheetCellCoordinate=void 0;var s=n(65),l=n(33),c=n(1),d=n(0),u=n(63),h=n(6),f=n(16),p=n(166),m=n(297),g=n(30),v=n(82);function b(e,t,n){var i={};return e.sort((function(e,t){return Number(e["@attributes"].t)===Number(t["@attributes"].t)?Number(e["@attributes"].l)-Number(t["@attributes"].l):Number(e["@attributes"].t)-Number(t["@attributes"].t)})),e.forEach((function(e){for(var o=Math.ceil(Number(e["@attributes"].l)+t)+"_"+Math.ceil(Number(e["@attributes"].t)+n),r=0;r<e.text.length;r++)e.text[r]["@attributes"].l=""+(Number(e.text[r]["@attributes"].l)+t),e.text[r]["@attributes"].t=""+(Number(e.text[r]["@attributes"].t)+n);e.allText=e.allText.toLowerCase(),i[o]=e})),i}function y(e,t){var n=l.ImageSheet.getSheetSize(e,t),i=n.sheetWidth,o=n.sheetHeight;return{x:1+l.ImageSheet.defaultCellWidth*t,y:1+l.ImageSheet.defaultCellHeight*e,w:i,h:o}}t.convertSheetCellCoordinate=b;var E=function(t){function n(e,n,i){var o=t.call(this,e,n)||this;return o.textObj=null,o.completedTile={},o.updatedTile=function(e){return o.completedTile[e]},o.setTextObj=function(e,t){return r(o,void 0,void 0,(function(){var n,i,o,r;return a(this,(function(a){switch(a.label){case 0:return[4,f.default.getSheetTileXml(this.docInfo,e,this.docInfo.dpi,t.x,t.y,t.w,t.h)];case 1:return n=a.sent(),(i=n.result)||(i=""),o=p.convertSheetLinkCoordinate(n.link,t.x,t.y),r=n.cells?b(n.cells,t.x,t.y):null,this.textObj[e+"_"+t.x+"_"+t.y]={"@attributes":n.page,cells:r,link:o,allText:i.toLowerCase()},[2]}}))}))},o.setTextObjectAndLocalStorage=function(e,t,n){return r(o,void 0,void 0,(function(){var i;return a(this,(function(o){switch(o.label){case 0:return i=e+"_"+t.x+"_"+t.y,null!=this.textObj[i]?[3,2]:[4,this.setTextObj(e,t)];case 1:o.sent(),o.label=2;case 2:return n[i]||(n[i]=this.textObj[i].allText.toLowerCase(),s.TextLayer.setLocalStorageText(this.docInfo.jobId,n)),[2]}}))}))},o.updateTileText=function(e,t,n){return r(o,void 0,void 0,(function(){var i,o,r,s,c,d,u,h,f,p,m,g,v,b,E,I,S=this;return a(this,(function(a){switch(a.label){case 0:return i=e+"_"+t+"_"+n,this.textObj[i]?[3,2]:[4,this.loadTextXml({x:t,y:n,w:l.ImageSheet.defaultCellWidth,h:l.ImageSheet.defaultCellHeight})];case 1:a.sent(),a.label=2;case 2:if(this.completedTile[i]||!this.textObj[i].cells)return this.completedTile[i]=!0,[2];o=(n-1)/l.ImageSheet.defaultCellHeight,r=(t-1)/l.ImageSheet.defaultCellWidth,s=o-1>-1?o-1:0,c=r-1>-1?r-1:0,d=o+1<l.ImageSheet.maxRow?o+1:l.ImageSheet.maxRow-1,u=r+1<l.ImageSheet.maxCol?r+1:l.ImageSheet.maxCol-1,h=[],f=s,a.label=3;case 3:if(!(f<=d))return[3,9];p=c,a.label=4;case 4:return p<=u?f==o&&p==r?[3,7]:(m=y(f,p),g=e+"_"+m.x+"_"+m.y,this.textObj[g]?[3,6]:[4,this.loadTextXml(m)]):[3,8];case 5:a.sent(),a.label=6;case 6:h.push(g),a.label=7;case 7:return p++,[3,4];case 8:return f++,[3,3];case 9:for(v=this.textObj[i].cells,b=Object.keys(v),h.forEach((function(e){var t=S.textObj[e].cells;if(t)for(var n=function(e){if(!t[b[e]])return"continue";var n=v[b[e]],i=t[b[e]].text.concat(n.text);i.sort((function(e,t){return Number(e["@attributes"].t)===Number(t["@attributes"].t)?Number(e["@attributes"].l)-Number(t["@attributes"].l):Number(e["@attributes"].t)-Number(t["@attributes"].t)}));var o=[],r="";i.forEach((function(e){o.some((function(t){if(t["@attributes"].t===e["@attributes"].t&&t["@attributes"].l===e["@attributes"].l)return!0}))||(o.push(e),r+=e.text)})),v[b[e]].text=o,v[b[e]].allText=r.toLowerCase()},i=0;i<b.length;i++)n(i)})),E="",I=0;I<b.length;I++)E+=v[b[I]].allText+"\n";return this.textObj[i].allText=E,this.completedTile[i]=!0,[2]}}))}))},o.loadTextXml=function(e){return r(o,void 0,void 0,(function(){var t,n,i,o,r=this;return a(this,(function(a){switch(a.label){case 0:return document.getElementById("annotationlayer"+this.docInfo.currentSheet)?(t=this.docInfo.currentSheet,n=s.TextLayer.getLocalStorageText(this.docInfo.jobId),[4,this.setTextObjectAndLocalStorage(t,e,n)]):(setTimeout((function(){r.loadTextXml(e)}),100),[2]);case 1:return a.sent(),i=t+"_"+e.x+"_"+e.y,this.textObj[i]?(o=document.getElementById(s.TextLayer.getLayerId(t)))?[3,3]:[4,this.createTextDiv(t)]:[3,4];case 2:a.sent(),a.label=3;case 3:this.updatePosition(o,i),a.label=4;case 4:return[2]}}))}))},o.firstLoadTextXml=function(){return r(o,void 0,void 0,(function(){var e,t,n,i,o,r=this;return a(this,(function(a){switch(a.label){case 0:return document.getElementById("annotationlayer"+this.docInfo.currentSheet)?document.getElementById(s.TextLayer.getLayerId(this.docInfo.currentSheet))?[3,2]:[4,this.createTextDiv(this.docInfo.currentSheet)]:(setTimeout((function(){r.firstLoadTextXml()}),100),[2]);case 1:a.sent(),a.label=2;case 2:0,e=0,t=1<l.ImageSheet.maxRow?1:l.ImageSheet.maxRow-1,n=e+1<l.ImageSheet.maxCol?e+1:l.ImageSheet.maxCol-1,i=0,a.label=3;case 3:if(!(i<=t))return[3,8];o=e,a.label=4;case 4:return o<=n?[4,this.loadTextXml(y(i,o))]:[3,7];case 5:a.sent(),a.label=6;case 6:return o++,[3,4];case 7:return i++,[3,3];case 8:return this.updateTileText(0,1,1),[2]}}))}))},o.getCellInfo=function(e,t){var n=o.textObj[e].cells;if(!n)return[];for(var i=[],r=Object.keys(n),a=0;a<r.length;a++)if(n[r[a]].allText.indexOf(t)>-1){var s=r[a],l=n[r[a]]["@attributes"].w,c=n[r[a]]["@attributes"].h;i.push(e+"_"+s+"_"+l+"_"+c)}return i},o.getCellText=function(e,t,n){return o.textObj[e].cells[t+"_"+n].allText},o.fullScreen=function(e){var t=document.getElementById("cell-focus-rect");e.isFullScreen?(f.default.isFullScreen=!0,v.TextSearch.isSearching=!1,t&&t.setAttribute("display","none")):(d.Util.isActiveSearch()&&t&&t.setAttribute("display","block"),f.default.isFullScreen=!1)},o.eventBind=function(){o.eventObserver.sheetChangeTile.subscribe(o.loadTextXml),o.eventObserver.fullScreen.subscribe(o.fullScreen)},o.textObj=i,o.eventBind(),o}return o(n,t),n.prototype.createTextDiv=function(e){return r(this,void 0,void 0,(function(){var t,n;return a(this,(function(i){return(t=document.getElementById("annotationlayer"+e))?(c.Browser.instance.isMobile&&(t.oncontextmenu=function(){return!1}),(n=document.createElement("div")).id=s.TextLayer.getLayerId(e),n.className="textLayer",(h.default.isScrollMode||u.DrawingEraser.isActive)&&d.Util.addClass(n,"disableEvent"),t.appendChild(n),[2]):[2]}))}))},n.prototype.updatePosition=function(e,t){var n=g.default.instance.getPageOrCurrentSheetRatio(parseInt(t),!0),i=document.getElementById("cell-focus-rect");if(i){var o=i.getAttribute("data").split("_"),r=(parseFloat(o[0])*n).toFixed(0),a=(parseFloat(o[1])*n).toFixed(0),s=(parseFloat(o[2])*n).toFixed(0),l=(parseFloat(o[3])*n).toFixed(0);i.style.cssText="left: "+r+"px; top: "+a+"px; width: "+s+"px; height: "+l+"px;",i.setAttribute("viewBox",r+" "+a+" "+s+" "+l);var c=document.getElementsByClassName("cell-search-rect")[0];c.setAttribute("x",""+r),c.setAttribute("y",""+a),c.setAttribute("width",""+s),c.setAttribute("height",""+l),c.style.strokeWidth=(m.DEFAULT_STROKE_WIDTH*n).toFixed(0)}},n.prototype.load=function(){return r(this,void 0,e,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.firstLoadTextXml()];case 1:return e.sent(),new m.CellTextSearch(this.docInfo,this.eventObserver,this),[2]}}))}))},n}(s.TextLayer);t.CellTextLayer=E}).call(this,n(4))},function(e,t,n){!function(n){"use strict";function i(e,t){var n=[];if(!i.isDefined(e)&&!i.isDefined(e))return n;if(i.isNumber(t)&&(t=""+t),i.isNumber(e)&&(e=""+e),!i.isString(e)&&!i.isArray(e))return n;if(!i.isString(t)&&!i.isArray(t))return n;for(var o=0,r=0,a=i.table(t);o+r<e.length;)t[r]===e[o+r]?(r===t.length-1&&n.push(o),r+=1):a[r]>-1?(o=o+r-a[r],r=a[r]):(r=0,o+=1);return n}i.table=function(e){var t=[],n=2,i=0;for(t[0]=-1,t[1]=0;n<e.length;)e[n-1]===e[i]?(i+=1,t[n]=i,n+=1):i>0?i=t[i]:(t[n]=0,n+=1);return t},i.isArray=function(e){return Array.isArray(e)},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isDefined=function(e){return!(void 0===e||null===typeof e)},i.isNumber=function(e){return!isNaN(e)},e.exports&&(t=e.exports=i),t.kmp=i}()},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WordTextLayer=void 0;var s=n(3),l=n(65),c=n(16),d=n(0),u=n(26),h=n(30),f=n(1),p=n(6),m=n(63),g=n(298),v=n(82);function b(e){var t=e["@attributes"],n=t.l,i=t.t,o=t.w,r=t.h;return{text:e.text,left:parseFloat(n),top:parseFloat(i),width:parseFloat(o),height:parseFloat(r)}}var y=function(t){function n(e,i,o){var g=t.call(this,e,i)||this;return g.textObj=null,g.setTextObj=function(e){return r(g,void 0,void 0,(function(){var t,n;return a(this,(function(i){switch(i.label){case 0:return[4,c.default.getXml(this.docInfo,e,this.docInfo.dpi)];case 1:return t=i.sent(),null==(n=t.result)&&(n=""),this.textObj[e]={"@attributes":t.page,text:t.text,link:t.link,allText:n},[2]}}))}))},g.setTextObjectAndLocalStorage=function(e,t){return r(g,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return null!=this.textObj[e]?[3,2]:[4,this.setTextObj(e)];case 1:n.sent(),n.label=2;case 2:return t[e]||(t[e.toString()]=this.textObj[e].allText.toLowerCase(),l.TextLayer.setLocalStorageText(this.docInfo.jobId,t)),[2]}}))}))},g.setCorrectValueToTextObjEl=function(e,t){var n=function(e){return!!e&&!/[,._]/.test(e.text)&&!!e.height},i=b(e.text[t]),o=i.left,r=i.width,a=i.top,s=i.height,l=i.text;if(s)if(r){if(/[\s]/.test(l)){c=t>0?b(e.text[t-1]):null,d=t+1<e.text.length?b(e.text[t+1]):null;n(c)&&c.left<o?o=c.left+c.width:n(d)&&o<d.left&&(o=d.left-d.width),e.text[t]["@attributes"].l=o.toString()}}else e.text[t]["@attributes"].w=(s/3).toString();else{var c=t>0?b(e.text[t-1]):null,d=t+1<e.text.length?b(e.text[t+1]):null;n(c)&&c.left<o?((s=a-c.top)<=0&&(s=c.height),a=c.top,o=c.left+c.width):n(d)&&o<d.left?((s=a-d.top)<=0&&(s=d.height),a=d.top,o=d.left-d.width):(s=5,a-=2/3*5),r=s/3,e.text[t]["@attributes"].h=s.toString(),e.text[t]["@attributes"].w=r.toString(),e.text[t]["@attributes"].t=a.toString(),e.text[t]["@attributes"].l=o.toString()}},g.createTextDiv=function(e,t){return r(g,void 0,void 0,(function(){var i,o,r,s,c,u,g,v,y,E,I;return a(this,(function(a){for(i=h.default.instance.getPageOrCurrentSheetRatio(t,!1),o=document.getElementById("annotationlayer"+t),f.Browser.instance.isMobile&&(o.oncontextmenu=function(){return!1}),document.getElementById("startOfContent"+t)||((r=document.createElement("div")).id="startOfContent"+t,r.className="startOfContent",o.appendChild(r)),(s=document.createElement("div")).id=l.TextLayer.getLayerId(t),s.className="textLayer",(p.default.isScrollMode||m.DrawingEraser.isActive)&&d.Util.addClass(s,"disableEvent"),c=0;c<e.text.length;c++)this.setCorrectValueToTextObjEl(e,c),u=b(e.text[c]),g=u.text,v=u.left,y=u.top,E=u.height,(I=document.createElement("span")).id=n.getTextId(t,c),I.className=d.Util.allowCopy()?"text":"text text--disable-copy",I.textContent=g,I.style.cssText="left:"+v*i+"px;top:"+y*i+"px;font-size:"+E*i+"px;line-height:"+E*i+"px",I.setAttribute("data-char",g),I.setAttribute("data-hl-order","[]"),s.appendChild(I);return o.firstChild?o.insertBefore(s,o.firstChild):o.appendChild(s),[2]}))}))},g.loadTextXml=function(e){return r(g,void 0,void 0,(function(){var t,n,i,o=this;return a(this,(function(s){switch(s.label){case 0:return t=function(e){return r(o,void 0,void 0,(function(){var t,n;return a(this,(function(i){switch(i.label){case 0:return t=l.TextLayer.getLocalStorageText(this.docInfo.jobId),[4,this.setTextObjectAndLocalStorage(e,t)];case 1:return i.sent(),d.Util.removeContentsAreaTooltip()||(document.getElementById("page-area"+e).title=t[e]),this.textObj[e].text.length&&(document.getElementById(l.TextLayer.getLayerId(e))?(n=document.getElementById("annotationlayer"+e),this.updatePosition(n,e)):this.createTextDiv(this.textObj[e],e)),[2]}}))}))},n=c.default.getAnnotLoadingRange(this.docInfo,e),[4,t(e)];case 1:for(s.sent(),i=n.startIdx;i<n.endIdx;i++)e!==i&&t(i);return[2]}}))}))},g.fullScreen=function(e){e.isFullScreen?(c.default.isFullScreen=!0,s(".text").addClass("text--hide"),v.TextSearch.isSearching=!1):window.setTimeout((function(){return r(g,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return c.default.isFullScreen=!1,d.Util.isActiveSearch()?[4,this.loadTextXml(this.docInfo.currentPage)]:[3,2];case 1:e.sent(),this.eventObserver.searchText.notify(this.docInfo.currentPage),s(".text").removeClass("text--hide"),e.label=2;case 2:return[2]}}))}))}),u.Page.IOS_WAITTIME_FOR_PREVENT_RELOAD)},g.textObj=o,g.eventBind(),g}return o(n,t),n.getTextId=function(e,t){return"text-"+e+"-"+t},n.prototype.updatePosition=function(e,t){var n=Array.prototype.slice.call(e.getElementsByClassName("text"));if(0!==n.length){var i=h.default.instance.getPageOrCurrentSheetRatio(t,!1),o=Math.round(100*parseFloat(n[0].style.left))/100,r=parseFloat(this.textObj[t].text[0]["@attributes"].l);if(o!==Math.round(r*i*100)/100)for(var a in n){var s=this.textObj[t].text[a]["@attributes"],l=s.l,c=s.t,d=s.h,u=n[a],p=getComputedStyle(u).getPropertyValue("--var-th-color");!f.Browser.instance.isIE&&p?u.style.cssText="left:"+l*i+"px;top:"+c*i+"px;font-size:"+d*i+"px;line-height:"+d*i+"px;--var-th-color: "+p+";":u.style.cssText="left:"+l*i+"px;top:"+c*i+"px;font-size:"+d*i+"px;line-height:"+d*i+"px"}}},n.prototype.eventBind=function(){this.eventObserver.fullScreen.subscribe(this.fullScreen)},n.prototype.load=function(){return r(this,void 0,e,(function(){var e,t,n,i;return a(this,(function(o){switch(o.label){case 0:return[4,this.loadTextXml(this.docInfo.currentPage)];case 1:if(o.sent(),l.TextLayer.hasLocalStorage()&&(e=l.TextLayer.getLocalStorageText(this.docInfo.jobId),0==Object.keys(e).length))for(t=/^synap_/,n=Object.keys(localStorage),i=0;i<n.length;i++)t.test(n[i])&&localStorage.removeItem(n[i]);return new g.WordTextSearch(this.docInfo,this.eventObserver,this),[2]}}))}))},n}(l.TextLayer);t.WordTextLayer=y}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileExplorer=t.SORTING_STATUS=t.SORTING_FIELD=void 0;var r,a,s=n(3),l=n(0),c=n(306),d=n(1),u=n(26),h=n(17),f=n(112);!function(e){e.FILENAME="fileName",e.FILETYPE="fileType",e.FILESIZE="fileSize",e.NULL="null"}(r=t.SORTING_FIELD||(t.SORTING_FIELD={})),function(e){e[e.ASEC=0]="ASEC",e[e.DESC=1]="DESC",e[e.NULL=2]="NULL"}(a=t.SORTING_STATUS||(t.SORTING_STATUS={}));var p=function(t,n,p,m,g,v){var b=this;if(this.pathList=[],this.currentPathListIdx=0,this.selectedFilePath=null,this.selectedFileName=null,this.totalPathWidth=parseInt(window.getComputedStyle(document.getElementById("fileExplorer-path__filePath")).width),this.maxFileNamePx=94,this.viewMode=u.VIEW_MODE.desktop,this.childFolderList=[],this.childFileList=[],this.fileExtMap={},this.tabIndexList=["fileExplorer-header__closeBtn","fileExplorer-path__prevBtn","fileExplorer-path__nextBtn","fileExplorer-fileTree-sort__div-fileName","fileExplorer-fileTree-sort__div-fileType","fileExplorer-fileTree-sort__div-fileSize","fileExplorer-viewerBtn"],this.tabIdx=0,this.createFileExplorer=function(){var e;b.pathList.push(b.currentTree),document.getElementById("archiveFileName").textContent=""+b.fileTree.fileName,document.getElementById("archiveFileName").title=""+b.fileTree.fileName,b.createCurrentPath(b.pathList),e=b.devideToFolderAndFileList(b.fileTree.children),b.childFolderList=e[0],b.childFileList=e[1],b.currentTree.childSort.sortingStatus=a.ASEC,b.currentTree.childSort.sortingField=r.FILENAME,b.fileTreeSort(),b.setFileTreeSortArrow(),b.currentTree.children=[],b.currentTree.children=b.childFolderList.concat(b.childFileList),b.jqFileTreeFolderList.append(b.createFileTreeList(b.childFolderList)),b.jqFileTreeFileList.append(b.createFileTreeList(b.childFileList)),b.jqFolderTree.append(b.createFolderTreeList([b.fileTree]));var t=document.getElementsByClassName("fileExplorer-folderTree-div")[0];s(t).append(b.createFolderTreeList(b.childFolderList)),t.getElementsByClassName("fileExplorer-folderTree-div__name")[0].className+=" fileExplorer-folderTree-div__name--selected",b.allCountElm.textContent=""+b.fileTree.children.length},this.createCurrentPath=function(e){var t=s(".fileExplorer-path__filePath");t.empty();var n=0;n-=10;for(var i=0,o=b.currentPathListIdx;o>=0;o--){var r=s("<div/>",{class:"fileExplorer-path__filePath-name",id:"filePath"+i,text:e[o].fileName,title:e[o].fileName,"data-index":o});t.children().length>0?s(r).insertBefore("#arrow"+(i-1)):t.append(r);var a=Math.ceil(document.getElementById("filePath"+i).offsetWidth);if((n+=(a=a>b.maxFileNamePx?b.maxFileNamePx:a)+10)>b.totalPathWidth){s("#filePath"+i).remove(),s("#arrow"+(i-1)).remove();break}if(0!==o){var l=s("<div/>",{class:"fileExplorer-path__filePath-arrow",id:"arrow"+i});s(l).insertBefore("#filePath"+i)}i+=1}0===b.currentPathListIdx?b.jqPrevBtn.addClass("fileExplorer-path__prevBtn--deactivate"):b.jqPrevBtn.removeClass("fileExplorer-path__prevBtn--deactivate"),b.currentPathListIdx===b.pathList.length-1?b.jqNextBtn.addClass("fileExplorer-path__nextBtn--deactivate"):b.jqNextBtn.removeClass("fileExplorer-path__nextBtn--deactivate")},this.createFileTreeList=function(e){for(var t=document.createDocumentFragment(),n=function(e){var n=document.createElement("div");n.className="fileExplorer-fileTree-list__div",n.tabIndex=b.tabIdx;var i=document.createElement("div");i.className="fileExplorer-fileTree-list__div-icon";var o=void 0;o=e.directory?"fileExplorer-folder-icon":b.fileExtMap[e.fileType]?b.fileExtMap[e.fileType]:b.fileExtMap.default,i.className=i.className+" "+o;var r=document.createElement("div");r.className="fileExplorer-fileTree-list__div-name",r.textContent=e.fileName,r.title=e.fileName,l.Util.bindClickEvent(n,(function(t){if(!e.directory){s(".fileExplorer-fileTree-list__div--selected").removeClass("fileExplorer-fileTree-list__div--selected");var n=t.target.parentElement.className.indexOf("fileExplorer-fileTree-fileList")>-1?t.target:t.target.parentElement;n.className+=" fileExplorer-fileTree-list__div--selected",b.selectedFilePath=n.getElementsByClassName("fileExplorer-fileTree-list__div-path")[0].textContent,b.selectedFileName=n.getElementsByClassName("fileExplorer-fileTree-list__div-name")[0].title}}));var a=document.createElement("div");a.className="fileExplorer-fileTree-list__div-size",a.textContent="("+l.Util.getSize(e.fileSize,e.directory)+")";var c=document.createElement("div");c.className="fileExplorer-fileTree-list__div-path",c.textContent=e.filePath,n.appendChild(i),n.appendChild(r),n.appendChild(a),n.appendChild(c),t.appendChild(n)},i=0,o=e;i<o.length;i++)n(o[i]);return t},this.createFolderTreeList=function(e){var t=document.createDocumentFragment(),n=document.createElement("div");n.className="group";for(var i=0,o=e;i<o.length;i++){var r=o[i],a=document.createElement("div");a.className="fileExplorer-folderTree-div";var s=document.createElement("div");s.className="fileExplorer-folderTreeLine-div",s.id=r.filePath;var c=document.createElement("div");c.className="fileExplorer-folderTree-div__arrow fileExplorer-folderTree-div__arrow--hidden";for(var d=0,u=r.children;d<u.length;d++)if(!0===u[d].directory){c.className=" fileExplorer-folderTree-div__arrow",c.title=h.LocaleMessage.getMessage("fileExplore-arrow-up"),c.tabIndex=b.tabIdx;break}var f=function(e){var t=e.target;if(t.className.indexOf("fileExplorer-folderTree-div__arrow")>-1){if(b.folderTreeArrowClick(t),0!==t.parentElement.parentElement.getElementsByClassName("group").length)return;if("fileExplorer-folderTree-div__arrow"===t.className)return}var n=t.className.indexOf("fileExplorer-folderTreeLine-div")<=-1?t.parentElement:t;if(!(n.className.indexOf("fileExplorer-folderTreeLine-div")<=-1)){var i=b.getCurrentPathTree(n.id,b.fileTree.children);b.currentTree=i,b.pushCurrentTree(b.currentTree),b.updateTree()}},p=document.createElement("div");p.className="fileExplorer-folderTree-div__folder 'fileExplorer-folder-icon'";var m=document.createElement("div");m.className="fileExplorer-folderTree-div__name",m.textContent=r.fileName,m.title=r.fileName,m.tabIndex=b.tabIdx,l.Util.bindClickEvent(p,f),l.Util.bindClickEvent(m,f),l.Util.bindClickEvent(c,f),s.appendChild(c),s.appendChild(p),s.appendChild(m),a.appendChild(s),n.appendChild(a),t.appendChild(n)}return t},this.updateTree=function(){var e;b.selectedFilePath=null,b.allCountElm.textContent=""+b.currentTree.children.length,s(".fileExplorer-folderTree-div__name--selected").removeClass("fileExplorer-folderTree-div__name--selected"),e=b.devideToFolderAndFileList(b.currentTree.children),b.childFolderList=e[0],b.childFileList=e[1];var t=document.getElementById(b.currentTree.filePath);0===t.parentElement.getElementsByClassName("fileExplorer-folderTree-div").length&&(t.parentElement.appendChild(b.createFolderTreeList(b.childFolderList)),t.getElementsByClassName("fileExplorer-folderTree-div__arrow")[0].className+=" folderExplorer-arrow-down");for(var n=null===t.parentElement.getElementsByClassName("group").item(0)?t.parentElement:t.parentElement.getElementsByClassName("group").item(0),i=[];"fileExplorer-folderTree"!==n.id;)"none"===n.style.display&&i.push(n),n=n.parentElement;if(i)for(var o=0,c=i;o<c.length;o++){var d=c[o];d.parentElement.getElementsByClassName("fileExplorer-folderTreeLine-div").item(0).getElementsByClassName("fileExplorer-folderTree-div__arrow").item(0).className+=" folderExplorer-arrow-down",s(d).show()}var u=t.getElementsByClassName("fileExplorer-folderTree-div__name")[0];s(u).hasClass("fileExplorer-folderTree-div__name--selected")||(u.className+=" fileExplorer-folderTree-div__name--selected"),b.currentTree.childSort.sortingStatus===a.NULL&&(b.currentTree.childSort.sortingField=r.FILENAME,b.currentTree.childSort.sortingStatus=a.ASEC,b.fileTreeSort(),b.currentTree.children=[],b.currentTree.children=b.childFolderList.concat(b.childFileList)),b.setFileTreeSortArrow(),b.jqFileTreeFolderList.empty(),b.jqFileTreeFileList.empty(),b.jqFileTreeFolderList.append(b.createFileTreeList(b.childFolderList)),b.jqFileTreeFileList.append(b.createFileTreeList(b.childFileList)),b.createCurrentPath(b.pathList),l.Util.isMobileMode()&&b.setArchiveFileNameWidth()},this.filePathPrevBtnEventBind=function(){l.Util.bindClickOrTouchEvent(s(".fileExplorer-path__prevBtn"),"fileExplorer-path__prevBtn--hover",(function(e){e.target.classList.contains("fileExplorer-path__prevBtn--deactivate")||b.currentPathListIdx>0&&(b.currentPathListIdx-=1,b.currentTree=b.pathList[b.currentPathListIdx],b.updateTree())}),(function(e){s(e.target).removeClass("fileExplorer-path__prevBtn--hover")}),(function(e){e.target.classList.contains("fileExplorer-path__prevBtn--deactivate")||s(e.target).addClass("fileExplorer-path__prevBtn--hover")}))},this.filePathNextBtnEventBind=function(){l.Util.bindClickOrTouchEvent(s(".fileExplorer-path__nextBtn"),"fileExplorer-path__nextBtn--hover",(function(e){e.target.classList.contains("fileExplorer-path__nextBtn--deactivate")||b.currentPathListIdx<b.pathList.length-1&&(b.currentPathListIdx+=1,b.currentTree=b.pathList[b.currentPathListIdx],b.updateTree())}),(function(e){s(e.target).removeClass("fileExplorer-path__nextBtn--hover")}),(function(e){e.target.classList.contains("fileExplorer-path__nextBtn--deactivate")||s(e.target).addClass("fileExplorer-path__nextBtn--hover")}))},this.filePathEventBind=function(){s(".fileExplorer-path__filePath").on(d.Browser.instance.isMobile?"touchstart":"mouseover",(function(e){e.target.className.indexOf("fileExplorer-path__filePath-name")>-1&&s(e.target).addClass("fileExplorer-path__filePath-name--hover")})).on(d.Browser.instance.isMobile?"touchend click":"mouseout click",(function(e){"touchend"!==e.type&&"mouseout"!==e.type||e.target.className.indexOf("fileExplorer-path__filePath-name")>-1&&s(e.target).removeClass("fileExplorer-path__filePath-name--hover"),"click"===e.type&&(b.currentPathListIdx=parseInt(e.target.getAttribute("data-index")),b.currentTree=b.pathList[b.currentPathListIdx],b.updateTree())}))},this.fileTreeSortDivEventBind=function(){l.Util.bindClickOrTouchEvent(b.jqFileTreeSortDiv,"fileExplorer-fileTree-sort__div--hover",(function(e){b.fileTreeSortDivClick(e)}),(function(){s(".fileExplorer-fileTree-sort__div--hover").removeClass("fileExplorer-fileTree-sort__div--hover")}),(function(e){var t=e.target.className.indexOf("fileExplorer-fileTree-sort__div-arrow")>-1||e.target.className.indexOf("fileExplorer-fileTree-sort__div-type")>-1?e.target.parentElement:e.target.className.indexOf("fileExplorer-fileTree-sort__div")>-1?e.target:null;t.className.indexOf("fileExplorer-fileTree-sort__div")>-1&&(t.className+=" fileExplorer-fileTree-sort__div--hover")}))},this.fileTreeSortDivClick=function(e){var t=e.target.className.indexOf("fileExplorer-fileTree-sort__div-arrow")>-1||e.target.className.indexOf("fileExplorer-fileTree-sort__div-type")>-1?e.target.parentElement:e.target.className.indexOf("fileExplorer-fileTree-sort__div")>-1?e.target:null;if(null!==t){var n=null;if("fileExplorer-fileTree-sort__div-fileName"===t.id)n=r.FILENAME;else if("fileExplorer-fileTree-sort__div-fileType"===t.id)n=r.FILETYPE;else{if("fileExplorer-fileTree-sort__div-fileSize"!==t.id)return;n=r.FILESIZE}b.currentTree.childSort.sortingField!==n?b.currentTree.childSort.sortingStatus=a.ASEC:b.currentTree.childSort.sortingStatus=b.currentTree.childSort.sortingStatus===a.ASEC?a.DESC:a.ASEC,b.currentTree.childSort.sortingField=n,b.fileTreeSort(),b.setFileTreeSortArrow(),b.currentTree.children=[],b.currentTree.children=b.childFolderList.concat(b.childFileList),b.jqFileTreeFolderList.empty(),b.jqFileTreeFileList.empty(),b.jqFileTreeFolderList.append(b.createFileTreeList(b.childFolderList)),b.jqFileTreeFileList.append(b.createFileTreeList(b.childFileList)),l.Util.isMobileMode()&&b.setArchiveFileNameWidth()}},this.fileTreeSort=function(){var e=b.currentTree.childSort.sortingField;switch(b.currentTree.childSort.sortingStatus){case a.ASEC:b.childFileList.sort((function(t,n){return t[e]<n[e]?-1:t[e]==n[e]?0:1})),b.childFolderList.sort((function(t,n){return t[e]<n[e]?-1:t[e]==n[e]?0:1}));break;case a.DESC:b.childFileList.sort((function(t,n){return n[e]<t[e]?-1:n[e]==t[e]?0:1})),b.childFolderList.sort((function(t,n){return n[e]<t[e]?-1:n[e]==t[e]?0:1}))}},this.setFileTreeSortArrow=function(){s(".fileExplorer-fileTree-sort__div-arrow").css("display","none"),s(".fileTree-sort__div-arrow-down").removeClass("fileTree-sort__div-arrow-down");var e=null;switch(b.currentTree.childSort.sortingField){case r.FILENAME:e=document.getElementById("fileExplorer-fileTree-sort__div-fileName-arrow");break;case r.FILETYPE:e=document.getElementById("fileExplorer-fileTree-sort__div-fileType-arrow");break;case r.FILESIZE:e=document.getElementById("fileExplorer-fileTree-sort__div-fileSize-arrow")}switch(b.currentTree.childSort.sortingStatus){case a.ASEC:e.className="fileExplorer-fileTree-sort__div-arrow";break;case a.DESC:e.className+=" fileTree-sort__div-arrow-down"}e.style.display="inline-block"},this.fileTreeFolderListEventBind=function(){var e=0;b.jqFileTreeFolderList.on("click",(function(t){var n=(new Date).getTime();e+250>n&&b.fileTreeFolderListDoubleClick(t),e=n}))},this.fileTreeFolderListDoubleClick=function(e){var t=e.target.parentElement.className.indexOf("fileExplorer-fileTree-folderList")>-1?e.target:e.target.parentElement,n=b.getCurrentPathTree(t.getElementsByClassName("fileExplorer-fileTree-list__div-path")[0].textContent,b.currentTree.children);b.currentTree=n,b.pushCurrentTree(b.currentTree),b.updateTree()},this.pushCurrentTree=function(e){for(var t=b.pathList.length,n=t-1;n>=0;n--){if(null===e.parent&&e===b.pathList[n])return void(b.currentPathListIdx=n);if(b.pathList[n]===e.parent){if(e===b.pathList[n+1])return void(b.currentPathListIdx=n+1);for(var i=n+1;i<t;i++)b.pathList.pop();return b.pathList.push(e),void(b.currentPathListIdx=b.pathList.length-1)}}b.pathList=[],b.currentPathListIdx=-1;for(var o=e;null!==o;)b.pathList.unshift(o),b.currentPathListIdx+=1,o=o.parent},this.folderTreeArrowClick=function(e){e.className.indexOf("folderExplorer-arrow-down")>-1?(e.className="fileExplorer-folderTree-div__arrow",s(e.parentElement.parentElement.getElementsByClassName("group").item(0)).hide(),e.title=h.LocaleMessage.getMessage("fileExplore-arrow-up")):(e.className+=" folderExplorer-arrow-down",s(e.parentElement.parentElement.getElementsByClassName("group").item(0)).show(),e.title=h.LocaleMessage.getMessage("fileExplore-arrow-down"))},this.loadSpinner=function(){var e=document.createElement("div");e.setAttribute("class","inner loading_spinner "),document.getElementById("modal").appendChild(e),new f({lines:11,length:0,width:12,radius:30,scale:1.25,corners:.5,color:"#435c85",opacity:.25,rotate:0,direction:1,speed:1,trail:65,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"}).spin(e)},this.removeSpinner=function(){setTimeout((function(){s(".loading_spinner").remove()}),50)},this.viewFile=function(){return i(b,void 0,e,(function(){var e,t,n,i;return o(this,(function(o){switch(o.label){case 0:return e=this.contextPath+"/viewArchiveFile/"+this.docId,(t={}).param={filePath:this.selectedFilePath,convertType:this.convertType,convertLocale:this.convLocale,title:this.selectedFileName},this.loadSpinner(),n=null,[4,l.Util.ajaxCall(e,"POST",t)];case 1:return n=o.sent(),i=n?l.Util.getUrlWithExtraParam(this.contextPath+"/view/"+JSON.parse(n).key):l.Util.getUrlWithExtraParam(this.contextPath+"/exception?convLocale="+this.convLocale),this.removeSpinner(),window.open(i)||(window.location.href=i),[2]}}))}))},this.viewFileEventBind=function(){l.Util.bindClickEvent(document.getElementById("fileExplorer-viewerBtn"),(function(){b.selectedFilePath&&b.viewFile()}))},this.setFileTreeHeight=function(){s(".fileExplorer").css("height",s("#wrap").height()-parseInt(s(".modal__fileExplorer").css("padding-top")));var e=s(".fileExplorer").outerHeight(!0)-s(".fileExplorer-header").outerHeight(!0)-s(".fileExplorer-path").outerHeight(!0)-s(".fileExplorer-viewerBtn").outerHeight(!0);s(".fileExplorer-fileTree").css("height",e),s(".fileExplorer-fileTree-list").css("height",e-s(".fileExplorer-fileTree-sort").outerHeight(!0))},this.setFilePathWidth=function(){var e=s(".fileExplorer").outerWidth(!0)-2*s(".fileExplorer-path__prevBtn").outerWidth(!0)-28;s(".fileExplorer-path__filePath").css("width",e),b.totalPathWidth=e},this.setSortDivWidth=function(){var e=s(".fileExplorer-tree").outerWidth(!0)/3-parseInt(s(".fileExplorer-fileTree-sort__div").css("padding-left"))-parseInt(s(".fileExplorer-fileTree-sort__div").css("padding-right"))-parseInt(s(".fileExplorer-fileTree-sort__div").css("border-right-width"));s(".fileExplorer-fileTree-sort__div").css("width",e)},this.setArchiveFileHeaderWidth=function(){var e=s(".fileExplorer-header").outerWidth(!0)-parseInt(s(".fileExplorer-header").css("padding-right"))-parseInt(s(".fileExplorer-header").css("padding-left"))-parseInt(s(".fileExplorer-header__archiveFileName").css("padding-left"))-parseInt(s(".fileExplorer-header__archiveFileName").css("padding-right"))-s(".fileExplorer-header__closeBtn").outerWidth(!0);s(".fileExplorer-header__archiveFileName").css("width",e)},this.setArchiveFileNameWidth=function(){var e=s(".fileExplorer-tree").outerWidth()-s(".fileExplorer-fileTree-list__div-icon").outerWidth()-parseInt(s(".fileExplorer-fileTree-list__div").css("padding-left"))-parseInt(s(".fileExplorer-fileTree-list__div").css("padding-right"))-parseInt(s(".fileExplorer-fileTree-list__div-icon").css("margin-right"))-parseInt(s(".fileExplorer-fileTree-list__div-name").css("margin-right"))-68;s(".fileExplorer-fileTree-list__div-name").css("max-width",e)},this.resizeEvent=function(){l.Util.isMobileMode()&&b.viewMode!==u.VIEW_MODE.mobile?b.viewMode=u.VIEW_MODE.mobile:l.Util.isMobileMode()||b.viewMode===u.VIEW_MODE.desktop||(b.viewMode=u.VIEW_MODE.desktop,s(".fileExplorer").css("height",""),s(".fileExplorer-fileTree").css("height",""),s(".fileExplorer-fileTree-list").css("height",""),s(".fileExplorer-path__filePath").css("width",""),s(".fileExplorer-fileTree-sort__div").css("width",""),s(".fileExplorer-header__archiveFileName").css("width",""),s(".fileExplorer-fileTree-list__div-name").css("max-width",""),b.totalPathWidth=413),l.Util.isMobileMode()&&(b.setFileTreeHeight(),b.setFilePathWidth(),b.setSortDivWidth(),b.setArchiveFileHeaderWidth(),b.setArchiveFileNameWidth()),b.createCurrentPath(b.pathList)},this.resizeEventBind=function(){var e;s(window).on("resize",(function(){clearTimeout(e),e=setTimeout(b.resizeEvent,20)}))},this.closeEventBind=function(){l.Util.bindClickEvent(document.getElementById("fileExplorer-header__closeBtn"),(function(){self.close()}))},this.devideToFolderAndFileList=function(e){for(var t=[],n=[],i=0,o=e;i<o.length;i++){var r=o[i];!0===r.directory?t.push(l.Util.clone(r)):n.push(l.Util.clone(r))}return[t,n]},this.getCurrentPathTree=function(e,t){for(var n=e.replace(/^\/|\/$/g,"").split("/"),i=t,o=null,r=0;r<n.length;r++)for(var a=0;a<i.length;a++)if(i[a].fileName===n[r]){o=i[a],i=i[a].children;break}return null===o?b.fileTree:o},this.preventDragSelect=function(){b.jqFileExplorer.on("dragstart",(function(){return!1})),b.jqFileExplorer.on("selectstart",(function(){return!1}))},this.eventBind=function(){b.filePathEventBind(),b.fileTreeFolderListEventBind(),b.preventDragSelect(),b.viewFileEventBind(),b.resizeEventBind(),b.closeEventBind(),b.filePathPrevBtnEventBind(),b.filePathNextBtnEventBind(),b.fileTreeSortDivEventBind()},this.archiveFileViewDialog=function(){b.eventBind(),b.jqFileExplorer.show(),b.jqModal.show(),l.Util.isMobileMode()&&(b.setFileTreeHeight(),b.setFilePathWidth(),b.setSortDivWidth(),b.setArchiveFileHeaderWidth(),b.setArchiveFileNameWidth()),d.Browser.instance.isMobile&&s(".fileExplorer-header__closeBtn").hide()},this.hasChildDirectory=function(){return b.currentTree.children.reduce((function(e,t){return!(e||!t.directory)||e}),!1)},this.contextPath=p,this.docId=m,this.convertType=g,this.convLocale=v,this.fileTree=new c.ZipTree(t,n).getZipTree(),this.currentTree=this.fileTree,this.jqModal=s(".modal"),this.jqFileExplorer=s(".fileExplorer"),this.jqFolderTree=s("#fileExplorer-folderTree"),this.jqFileTree=s(".fileExplorer-fileTree"),this.jqFileTreeFolderList=s(".fileExplorer-fileTree-folderList"),this.jqFileTreeFileList=s(".fileExplorer-fileTree-fileList"),this.jqFileTreeFolderAndFileList=s(".fileExplorer-fileTree-folderList, .fileExplorer-fileTree-fileList"),this.allCountElm=document.getElementById("fileExplorer-allCount__num"),this.jqPrevBtn=s(".fileExplorer-path__prevBtn"),this.jqNextBtn=s(".fileExplorer-path__nextBtn"),this.jqFileTreeSort=s(".fileExplorer-fileTree-sort"),this.jqFileTreeSortDiv=s(".fileExplorer-fileTree-sort__div"),this.fileExtMap.xls="fileExplorer-cell-icon",this.fileExtMap.xlsb="fileExplorer-cell-icon",this.fileExtMap.xlsx="fileExplorer-cell-icon",this.fileExtMap.csv="fileExplorer-cell-icon",this.fileExtMap.nxls="fileExplorer-cell-icon",this.fileExtMap.ppt="fileExplorer-slide-icon",this.fileExtMap.pptx="fileExplorer-slide-icon",this.fileExtMap.nppt="fileExplorer-slide-icon",this.fileExtMap.doc="fileExplorer-word-icon",this.fileExtMap.docx="fileExplorer-word-icon",this.fileExtMap.ndoc="fileExplorer-word-icon",this.fileExtMap.hwp="fileExplorer-hwp-icon",this.fileExtMap.hml="fileExplorer-hwp-icon",this.fileExtMap.hwx="fileExplorer-hwp-icon",this.fileExtMap.hwpx="fileExplorer-hwp-icon",this.fileExtMap.odt="fileExplorer-odt-icon",this.fileExtMap.pdf="fileExplorer-pdf-icon",this.fileExtMap.bmp="fileExplorer-img-icon",this.fileExtMap.gif="fileExplorer-img-icon",this.fileExtMap.jpg="fileExplorer-img-icon",this.fileExtMap.jpeg="fileExplorer-img-icon",this.fileExtMap.png="fileExplorer-img-icon",this.fileExtMap.pbm="fileExplorer-img-icon",this.fileExtMap.tif="fileExplorer-img-icon",this.fileExtMap.tiff="fileExplorer-img-icon",this.fileExtMap.webp="fileExplorer-img-icon",this.fileExtMap.jp2="fileExplorer-img-icon",this.fileExtMap.j2c="fileExplorer-img-icon",this.fileExtMap.j2k="fileExplorer-img-icon",this.fileExtMap.jpc="fileExplorer-img-icon",this.fileExtMap.txt="fileExplorer-txt-icon",this.fileExtMap.htm="fileExplorer-html-icon",this.fileExtMap.html="fileExplorer-html-icon",this.fileExtMap.xmldart="fileExplorer-html-icon",this.fileExtMap.xml="fileExplorer-txt-icon",this.fileExtMap.mht="fileExplorer-mht-icon",this.fileExtMap.mhtml="fileExplorer-mht-icon",this.fileExtMap.zip="fileExplorer-zip-icon",this.fileExtMap.default="fileExplorer-nosupport-icon",this.tabIdx=l.Util.setTabIndexList(this.tabIndexList,1,!0),this.createFileExplorer(),this.hasChildDirectory()&&(document.getElementsByClassName("fileExplorer-folderTree-div__arrow")[0].className="fileExplorer-folderTree-div__arrow folderExplorer-arrow-down",document.getElementsByClassName("fileExplorer-folderTree-div__arrow")[0].title=h.LocaleMessage.getMessage("fileExplore-arrow-down"),document.getElementsByClassName("fileExplorer-folderTree-div__arrow")[0].tabIndex=this.tabIdx),l.Util.isMobileMode()){var y=function(){document.querySelector('meta[name="viewport"]').setAttribute("content",l.Util.getDefaultViewPortString())};window.addEventListener("orientationchange",y),y()}};t.FileExplorer=p}).call(this,n(4))},,function(e,t,n){n(173),n(312),n(327),n(331),n(333),e.exports=n(335)},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=n(107),s=n(310),l=n(1),c={page:new s.Observable,sheet:new s.Observable,resizeWindow:new s.Observable,resizePage:new s.Observable,resizeContents:new s.Observable,fullScreen:new s.Observable,mobileHeader:new s.Observable,mobileHeaderHover:new s.Observable,mobileThumb:new s.Observable,scroll:new s.Observable,singleTap:new s.Observable,fullscreenSingleTap:new s.Observable,doubleTap:new s.Observable,swipe:new s.Observable,bgColor:new s.Observable,moveBtn:new s.Observable,orientationchange:new s.Observable,printbefore:new s.Observable,printafter:new s.Observable,saveAnnotationServer:new s.Observable,updateAnnotList:new s.Observable,hideAnnotListInMobile:new s.Observable,exportPdf:new s.Observable,saveServerPdf:new s.Observable,editedAnnotation:new s.Observable,loadAnnotation:new s.Observable,reRenderAnnotation:new s.Observable,modifyMarkerAttr:new s.Observable,searchNext:new s.Observable,searchText:new s.Observable,searchDisplay:new s.Observable,sheetFail:new s.Observable,sheetChangeTile:new s.Observable,annotMode:new s.Observable,undoMarker:new s.Observable,redoMarker:new s.Observable,afterUndoRedoSheet:new s.Observable,selectAnnotation:new s.Observable,unSelectAnnotation:new s.Observable,dragAnnotStart:new s.Observable,dragAnnotEnd:new s.Observable,newMemo:new s.Observable,deleteMarker:new s.Observable,showProp:new s.Observable,closeProp:new s.Observable,changeMarkerStyle:new s.Observable,keyPress:new s.Observable,keyUp:new s.Observable,saveAnnotCb:new s.Observable,applyAnnot:new s.Observable,moveLaserCb:new s.Observable,zoom:new s.Observable,saveAnnotation:new s.Observable,startViewportScroll:new s.Observable,endViewportScroll:new s.Observable,initLoadAfter:new s.Observable},d=function(){var e,t,n,i,o,r,a,s;NodeList.prototype.forEach||(NodeList.prototype.forEach=Array.prototype.forEach),String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(void 0!==t?t:" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),i=n.length>>>0,o=arguments[1],r=0;r<i;r++)if(t=n[r],e.call(o,t,r,n))return r;return-1},enumerable:!1,configurable:!1,writable:!1}),Array.from||(Array.from=(e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=Math.pow(2,53)-1,i=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),n)},function(e){var n=this,o=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,a=arguments.length>1?arguments[1]:void 0;if(void 0!==a){if(!t(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(r=arguments[2])}for(var s,l=i(o.length),c=t(n)?Object(new n(l)):new Array(l),d=0;d<l;)s=o[d],c[d]=a?void 0===r?a(s,d):a.call(r,s,d):s,d+=1;return c.length=l,c})),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var r=t[o];if(e.call(i,r,o,t))return r;o++}},configurable:!0,writable:!0}),Object.keys||(Object.keys=(o=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),s=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("function"!=typeof e&&("object"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t,n,i=[];for(t in e)o.call(e,t)&&i.push(t);if(r)for(n=0;n<s;n++)o.call(e,a[n])&&i.push(a[n]);return i}))};r((function(){return i(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return d(),function(){var e=window.macKeys={cmdKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1,reset:function(){this.cmdKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.altKey=!1}};if(l.Browser.instance.isMac){var t=l.Browser.instance,n=t.isChrome,i=t.isSafari,o=t.isFirefox,r=t.isOpera,a=n||i;window.onkeydown=function(t){var n=t.keyCode;(a||r)&&(91===n||93===n)||o&&224===n?e.cmdKey=!0:16===n?e.shiftKey=!0:17===n?e.ctrlKey=!0:18===n&&(e.altKey=!0)},window.onkeyup=function(t){var n=t.keyCode;(a||r)&&(91===n||93===n)||o&&224===n?e.cmdKey=!1:16===n?e.shiftKey=!1:17===n?e.ctrlKey=!1:18===n&&(e.altKey=!1)},window.onblur=function(){e.reset()}}}(),[4,new a.Init(c).load()];case 1:return e.sent(),window.localSynap.complete="complete",[2]}}))}))}))}).call(this,n(4))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThumbnailMobile=void 0;var i=n(3),o=n(0),r=n(17),a=n(38),s=n(32),l=n(1),c=n(6),d=n(19),u=function(e){var t=this;this.isThumbnailButton=null,this.eventObserver=null,this.protectedObj=null,this.eventBind=function(e,n){t.docInfo=n,l.Browser.instance.isMobile&&(i("#web-thumbnailbar").addClass("thumbnailbar--touch-expand"),i("#mobile-thumbnailbar").addClass("thumbnailbar--touch-expand")),t.eventObserver=e,t.eventObserver.mobileThumb.subscribe(t.mobileThumb),t.mouseoverEventBind(),l.Browser.instance.isMobile&&t.eventObserver.resizeWindow.subscribe(t.resizeWindow),l.Browser.instance.isSupportVisualViewport()&&(t.eventObserver.startViewportScroll.subscribe(t.startViewportScroll),t.eventObserver.endViewportScroll.subscribe(t.endViewportScroll))},this.toggleAction=function(){s.Thumbnail.THUMB_STATUS===s.THUMB_FLAG.off?(s.Thumbnail.THUMB_STATUS=s.THUMB_FLAG.on,t.showThumb(),t.actionMobileThumbBtn(a.ShowActionType.SHOW),t.eventObserver.mobileHeader.notify(a.ShowActionType.SHOW)):(s.Thumbnail.THUMB_STATUS=s.THUMB_FLAG.off,t.hideThumb(),t.actionMobileThumbBtn(a.ShowActionType.HIDE3SEC),t.eventObserver.mobileHeader.notify(a.ShowActionType.HIDE3SEC)),d.ScaleEvent._doScaleSkinThumbnail()},this.initThumb=function(){null===t.isThumbnailButton&&(t.isThumbnailButton=t.jqThumbnailButton.is(":visible")),i("#mobile-thumbnailbar").removeClass("mobile-thumbnailbar__img--close"),t.jqThumbnail.css("display",""),t.jqThumbnailBar.removeClass("wrap__thumbnailbar--mobile-on"),document.getElementById("mobile-thumbnailbar").title=r.LocaleMessage.getMessage("icon_thumbnail_close"),t.isThumbnailButton&&t.jqThumbnailButton.removeClass("thumbnail-btn__img--on")},this.showThumb=function(){t.jqThumbnail.show(),i("#mobile-thumbnailbar").addClass("mobile-thumbnailbar__img--close"),t.jqThumbnailBar.addClass("wrap__thumbnailbar--mobile-on"),t.isThumbnailButton&&t.jqThumbnailButton.addClass("thumbnail-btn__img--on")},this.hideThumb=function(){t.initThumb(),document.getElementById("mobile-thumbnailbar").title=r.LocaleMessage.getMessage("icon_thumbnail_open")},this.changeMode=function(e){s.Thumbnail.THUMB_STATUS===s.THUMB_FLAG.on?(t.showThumb(),t.actionMobileThumbBtn(a.ShowActionType.SHOW),t.eventObserver.mobileHeader.notify(a.ShowActionType.SHOW)):(t.hideThumb(),t.actionMobileThumbBtn(a.ShowActionType.HIDE3SEC),t.eventObserver.mobileHeader.notify(a.ShowActionType.HIDE3SEC)),t.eventObserver.page.notify({pageNum:e,isScroll:!1}),setTimeout((function(){document.getElementById("thumbnail").scrollTop=document.getElementById("thumb-content"+e).offsetTop-1}),150)},this.resizeWindow=function(){d.ScaleEvent._doScaleSkinThumbnail()},this.mobileThumb=function(e){switch(e){case a.ShowActionType.SHOW:t.jqThumbnail.show(),t.actionMobileThumbBtn(a.ShowActionType.SHOW);break;case a.ShowActionType.HIDE3SEC:case a.ShowActionType.HIDE:t.jqThumbnail.css("display",""),t.actionMobileThumbBtn(e)}},this.mouseoverEventBind=function(){i(".wrap__header").on("mouseover.head",(function(){o.Util.isMobileMode()&&!o.Util.isFullScreen()&&"none"===t.jqThumbnail.css("display")&&t.mobileHeaderHover("mouseover")})).on("mouseleave.head",(function(){o.Util.isMobileMode()&&!o.Util.isFullScreen()&&"none"===t.jqThumbnail.css("display")&&t.mobileHeaderHover("mouseleave")}))},this.mobileHeaderHover=function(e){if(!o.Util.isFullScreen()&&"none"===t.jqThumbnail.css("display"))switch(e){case"mouseover":s.Thumbnail.THUMB_STATUS=s.THUMB_FLAG.off,t.hideThumb(),t.actionMobileThumbBtn(a.ShowActionType.SHOW);break;case"mouseleave":t.actionMobileThumbBtn(a.ShowActionType.HIDE3SEC)}},this.actionMobileThumbBtn=function(e){switch(clearTimeout(t.protectedObj.timer),e){case a.ShowActionType.SHOW:t.jqThumbnailBar.show();break;case a.ShowActionType.HIDE:t.jqThumbnailBar.hide();break;case a.ShowActionType.HIDE3SEC:t.jqThumbnailBar.show(),t.protectedObj.timer=window.setTimeout((function(){t.jqThumbnailBar.hide()}),3e3)}},this.startViewportScroll=function(){t.eventObserver.mobileThumb.notify(a.ShowActionType.HIDE)},this.endViewportScroll=function(e){if(!e){var n=c.default.isAnnotMode||s.Thumbnail.THUMB_STATUS===s.THUMB_FLAG.on;t.eventObserver.mobileThumb.notify(n?a.ShowActionType.SHOW:a.ShowActionType.HIDE3SEC)}},this.protectedObj=e,this.jqThumbnail=i("#thumbnail"),this.jqThumbnailButton=i("#thumbnail-btn"),this.jqThumbnailBar=i("#thumbnailbar")};t.ThumbnailMobile=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThumbnailDesktop=void 0;var i=n(3),o=n(17),r=n(32),a=function(e){var t=this;this.eventObserver=null,this.protectedObj=null,this.eventBind=function(e){t.eventObserver=e,i("#web-thumbnailbar").on("dragstart",(function(){return!1}))},this.toggleAction=function(){r.Thumbnail.THUMB_STATUS===r.THUMB_FLAG.off?(r.Thumbnail.THUMB_STATUS=r.THUMB_FLAG.on,t.showThumb()):(r.Thumbnail.THUMB_STATUS=r.THUMB_FLAG.off,t.hideThumb()),t.eventObserver.resizeContents.notify(),t.eventObserver.resizeWindow.notify()},this.initThumb=function(){t.jqThumbnailButton.removeClass("thumbnail-btn__img--on"),document.getElementById("thumbnailview-btn").title=o.LocaleMessage.getMessage("icon_thumbnail_open"),document.getElementById("thumbnail-btn").title=o.LocaleMessage.getMessage("icon_thumbnail_open"),t.jqThumbnail.removeClass("wrap__thumbnail--on"),t.jqThumbnailBar.removeClass("wrap__thumbnailbar--on"),t.jqContents.removeClass("wrap__contents--thumb-on"),t.jqThumbnail.css({width:"","overflow-y":""}),t.jqThumbnailBar.css("left",""),t.jqContents.css("left","")},this.showThumb=function(){t.jqThumbnailButton.addClass("thumbnail-btn__img--on"),t.jqThumbnail.css("overflow-y","scroll"),t.jqThumbnail.addClass("wrap__thumbnail--on"),t.jqThumbnailBar.addClass("wrap__thumbnailbar--on"),t.jqContents.addClass("wrap__contents--thumb-on"),document.getElementById("thumbnailview-btn").title=o.LocaleMessage.getMessage("icon_thumbnail_close"),document.getElementById("thumbnail-btn").title=o.LocaleMessage.getMessage("icon_thumbnail_close")},this.hideThumb=function(){t.initThumb()},this.changeMode=function(e){clearTimeout(t.protectedObj.timer),t.jqThumbnail.css("display",""),t.jqThumbnailBar.show(),r.Thumbnail.THUMB_STATUS===r.THUMB_FLAG.on?t.showThumb():t.hideThumb(),t.eventObserver.page.notify({pageNum:e,isScroll:!1}),setTimeout((function(){document.getElementById("thumbnail").scrollTop=document.getElementById("thumb-content"+e).offsetTop-1}),150)},this.protectedObj=e,this.jqThumbnail=i("#thumbnail"),this.jqThumbnailButton=i("#thumbnail-btn"),this.jqThumbnailBar=i("#thumbnailbar"),this.jqContents=i("#contents")};t.ThumbnailDesktop=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtil=void 0;var i=function(){function e(){}return e.getDegree=function(e,t,n,i){var o=n-e,r=i-t;return Math.atan2(r,o)*(180/Math.PI)},e.degreeToRadian=function(e){return e*(Math.PI/180)},e}();t.MathUtil=i},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingMemo=void 0;var r=n(27),a=n(23),s=n(6),l=n(0),c=function(e){function t(t,n,i,o,c){var d=e.call(this,t,n,i,o,c)||this;return d.markerEventBind=function(e){var t=d.markerClick;e.on("click",(function(){t(e,this),r.event.stopPropagation()}))},d.markerClick=function(e,t){var n=r.mouse(t);d.newSvg=e.append("rect").attr("x",n[0]).attr("y",n[1]).attr("class","tmp-marker-path").attr("id","tmp-marker-path"),d.curMarkerSection=l.Util.getParentElement(t),d.eventObserver.editedAnnotation.notify(d.marker.getPageIdxWhenInAnnotationMode()),d.funcSaveDrawing()},d.getAnnotSize=function(e,t){var n={left:Number(e.getAttribute("x"))/t,top:Number(e.getAttribute("y"))/t};return{left:n.left.toFixed(2),width:"20",top:n.top.toFixed(2),height:"20"}},d.createSvg=function(e,t,n){var i=t,o=a.getViewBox(i.l,i.t,i.w,i.h,null),l=o.left,c=o.top,u=o.width,h=o.height,f=r.select(e).append("svg").attr("id",n).attr("class","marker-svg").attr("viewBox",l+" "+c+" "+u+" "+h).style("left",l+"px").style("width",u+"px").style("top",c+"px").style("height",h+"px").attr("focusable","false");f.append("rect");var p=s.default.parseMarkerId(n),m=p.pageOrSheetIdx,g=p.annotId;return d.eventObserver.newMemo.notify({pageOrSheetIdx:m,annotId:g}),f},d.createAnnotInfo=function(e,t,n,i,o,r){var a=d.createAnnotBaseInfo(e,"fff68f","1.0",o,r),s=a.annot;return s.type="memo",s.icon="Note",a},d.redrawAttr=function(e,t){var n=document.getElementById("annotation-memo");l.Util.containClassName(n,"annotation-memo--hide")||(document.getElementById("annotation-memo__author-input").value=t.annot.contents&&t.annot.contents.t?t.annot.contents.t:"")},d.setAnnotInfoThickness=function(e,t){},d.setAnnotInfoPath=function(e,t){},d}return o(t,e),t}(a.DrawingTool);t.DrawingMemo=c},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingFreetext=void 0;var r=n(27),a=n(6),s=n(23),l=n(44),c=n(156),d=function(e){function t(t,n,i,o,d,u){var h=e.call(this,t,n,i,o,d)||this;return h.getAnnotInfos=null,h.createSvg=function(e,t,n){var i=new c.Freetext(h.eventObserver,t,n,h.isCell,e,h.getAnnotInfos);return a.default.annotObjectMap.set(n,i),null},h.createAnnotInfo=function(e,t,n,i,o,r,a,s,c){var d=(parseFloat(o.style.strokeWidth)/r).toFixed(2),u=h.createAnnotBaseInfo(e,t,i,o,r),f=u.annot,p={align:s,style:"normal",size:c,weight:"normal",font:"Helvetica",c:l.default.getTypeToHexColor(a)};f.type="freetext",f.contents.text="",f.border={w:d},f.ic=n;var m={contents:"",align:s,style:"normal",size:c,weight:"normal",font:"Helvetica",c:l.default.getTypeToHexColor(a)};return f.ds=p,f.rc=[m],u},h.redrawMoveAttr=function(e,t){var n=t.annot,i=s.getViewBox(n.l,n.t,n.w,n.h,n.border),o=i.left,a=i.top,l=i.width,c=i.height;r.select(e).attr("viewBox",o+" "+a+" "+l+" "+c).style("width",l+"px").style("height",c+"px")},h.redrawAttr=function(e,t){var n=e,i=r.select(n.getElementsByClassName("marker-svg")[0]).node();h.redrawMoveAttr(i,t),h.redrawRectSvg(i,t);var o=n.getElementsByClassName("annotation-freetext")[0],a=t.annot;c.setFreetextDivBoundingRect(n,a),c.setFreetextAreaBoundingRect(o,a)},h.redrawAttrEl=function(e,t,n){var i={};i[""+t]=n;var o=r.select(e).select("rect"),a=r.select(e).select("textarea");if("thickness"===t)h.setRectThickness(o,n),h.setTextAreaSizeWithThickness(o,a,n);else if("transparency"===t)a.style("opacity",""+n);else if("textAlign"===t)a.style("text-align",""+n);else if("fontSize"==t)a.style("font-size",n+"pt");else if("fontColor"==t){var c=l.default.getTypeToHexColor(""+n);a.style("color",""+s.DrawingTool.hexToRgb(c))}h.setSvgStyle(o.node(),i)},h.setTextAreaSizeWithThickness=function(e,t,n){var i=Number(n)-parseFloat(e.style("stroke-width"));t.style("left",Number(t.style("left").replace("px",""))+i+"px").style("top",Number(t.style("top").replace("px",""))+i+"px").style("width",Number(t.style("width").replace("px",""))-2*i+"px").style("height",Number(t.style("height").replace("px",""))-2*i+"px")},h.getMarkerStyleAttr=function(e,t){var n=e.annot,i=s.getAnnotInfoColor(n.c),o=s.getAnnotInfoAlpha(n.a),r=s.getAnnotInfoStrokeWidth(n.border),a=s.getAnnotInfoInnerColor(n.ic),l=s.getAnnotInfoTextAlign(n.ds.align),c=s.getAnnotInfoFontSize(n.ds.size),d=s.getAnnotInfoFontColor(n.ds.c);return{color:i,innerColor:a,thickness:parseFloat(r)*t,transparency:parseFloat(o),textAlign:l,fontSize:c,fontColor:d}},h.getAnnotInfos=u,h}return o(t,e),t}(n(109).DrawingSquare);t.DrawingFreetext=d},,,,,,,,function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingCircle=void 0;var r=n(27),a=n(0),s=n(30),l=n(23),c=n(44),d=function(e){function t(t,n,i,o,d){var u=e.call(this,t,n,i,o,d)||this;return u.markerStart=function(e,t){var n=event;if(!(n.touches&&n.touches.length>1)){var i=a.Util.getParentElement(e.node()).id,o=a.Util.getIdxFromElmId(i,"marker-section"),d=r.mouse(t),h=c.default.getTypeToHexColor(u.attr.innerColor);u.newSvg=e.append("ellipse").style("stroke",l.DrawingTool.hexToRgb(c.default.getTypeToHexColor(u.attr.color))).style("stroke-width",u.attr.thickness*s.default.instance.getRatioByOriginSize(o,u.isCell)).style("opacity",u.attr.transparency).style("fill","none"===h?"none":l.DrawingTool.hexToRgb(h)).attr("cx",d[0]).attr("cy",d[1]).attr("rx",0).attr("ry",0).attr("class","tmp-marker-path").attr("id","tmp-marker-path"),u.markerDrawBind(e,u.markerEnd,(function(){u.markerDrawTmp(t,d[0],d[1])}))}},u.markerDrawTmp=function(e,t,n){var i=r.mouse(e),o=Math.max(0,Math.abs(i[0]-t)),a=Math.max(0,Math.abs(i[1]-n));i[0]-t>=0&&i[1]-n>=0?u.newSvg.attr("cx",t+o/2).attr("cy",n+a/2).attr("rx",o/2).attr("ry",a/2):i[0]-t>=0&&i[1]-n<0?u.newSvg.attr("cx",t+o/2).attr("cy",n-a/2).attr("rx",o/2).attr("ry",a/2):i[0]-t<0&&i[1]-n>=0?u.newSvg.attr("cx",t-o/2).attr("cy",n+a/2).attr("rx",o/2).attr("ry",a/2):i[0]-t<0&&i[1]-n<0&&u.newSvg.attr("cx",t-o/2).attr("cy",n-a/2).attr("rx",o/2).attr("ry",a/2)},u.createSvg=function(e,t,n){var i=t,o=l.getViewBox(i.l,i.t,i.w,i.h,null),a=o.left,s=o.top,c=o.width,d=o.height,h=r.select(e).append("svg").attr("id",n).attr("class","marker-svg").attr("viewBox",a+" "+s+" "+c+" "+d).style("left",a+"px").style("width",c+"px").style("top",s+"px").style("height",d+"px").attr("focusable","false"),f=l.getAnnotInfoStrokeWidth(i.border),p=u.getCircleAttribute(i.l,i.t,i.w,i.h,f),m=p.cx,g=p.cy,v=p.rx,b=p.ry;return h.append("ellipse").attr("class","marker-svg__path").attr("cx",m).attr("cy",g).attr("rx",v).attr("ry",b).style("stroke",l.DrawingTool.hexToRgb(l.getAnnotInfoColor(i.c))).style("stroke-width",f).style("opacity",l.getAnnotInfoAlpha(i.a)).style("fill",l.DrawingTool.hexToRgb(l.getAnnotInfoInnerColor(i.ic))),h},u.createAnnotInfo=function(e,t,n,i,o,r){var a=(parseFloat(o.style.strokeWidth)/r).toFixed(2),s=u.createAnnotBaseInfo(e,t,i,o,r),l=s.annot;return l.type="circle",l.border={w:a},l.ic=n,s},u.redrawAttr=function(e,t){var n=t.annot;u.redrawMoveAttr(e,t);var i=u.getFillshapeAttr(t),o=u.getCircleAttribute(n.l,n.t,n.w,n.h,l.getAnnotInfoStrokeWidth(n.border)),a=o.cx,s=o.cy,c=o.rx,d=o.ry;r.select(e).select("ellipse").attr("cx",a).attr("cy",s).attr("rx",c).attr("ry",d),u.setSvgStyle(r.select(e).select("ellipse").node(),i)},u.redrawAttrEl=function(e,t,n){var i={};i[""+t]=n;var o=r.select(e).select("ellipse");if("thickness"===t){var a=(Number(n)-parseFloat(o.style("stroke-width")))/2;o.attr("rx",""+(Number(o.attr("rx"))-a)).attr("ry",""+(Number(o.attr("ry"))-a))}u.setSvgStyle(o.node(),i)},u.getPosition=function(e){var t=e.getBBox();return{left:0===t.width&&0===t.x?parseInt(e.getAttribute("cx")):t.x,top:0===t.height&&0===t.y?parseInt(e.getAttribute("cy")):t.y}},u.getAnnotSizeWithStroke=function(e,t){return l.getAnnotSizeWithStroke(e.left,e.top,e.width,e.height,t)},u.getCircleAttribute=function(e,t,n,i,o){var r=Number(o),a=(Number(n)-r)/2,s=(Number(i)-r)/2;return{cx:Number(e)+r/2+a,cy:Number(t)+r/2+s,rx:a,ry:s}},u}return o(t,e),t}(n(153).DrawingFillShape);t.DrawingCircle=d},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DPISheet=void 0;var r=n(61),a=n(33),s=function(e){function t(t){var n=e.call(this,t)||this;return n.load=function(e){e.sheet.subscribe(n.initDPI)},n.getParam=function(e){var t={};return t.x=Math.round(e.colIdx*a.ImageSheet.defaultCellWidth*n.ratio+1),t.y=Math.round(e.rowIdx*a.ImageSheet.defaultCellHeight*n.ratio+1),t.w=Math.round(e.width*n.ratio),t.h=Math.round(e.height*n.ratio),t},n}return o(t,e),t}(r.DPI);t.DPISheet=s},function(e){e.exports=JSON.parse('{"name":"SynapDocumentViewer","version":"23.4.0","main":"index.js","scripts":{"build":"npm run clean && webpack --mode development --viewer_version v2022 && rimraf css/config.css","build:prod":"npm run clean && webpack --mode production --viewer_version v2022 && rimraf css/config.css","hbuild":"npm run clean && webpack --mode development --viewer_version v2022","hbuild:prod":"npm run clean && webpack --mode production --viewer_version v2022","docslive":"npm run clean && webpack --mode development --viewer_version v2022","docslive:prod":"npm run clean && webpack --mode production --viewer_version v2022","build2019":"npm run clean && webpack --mode development --viewer_version v2019 && rimraf css/config.css","build2019:prod":"npm run clean && webpack --mode production --viewer_version v2019 && rimraf css/config.css","hbuild2019":"npm run clean && webpack --mode development --viewer_version v2019","hbuild2019:prod":"npm run clean && webpack --mode production --viewer_version v2019","docslive2019":"npm run clean && webpack --mode development --viewer_version v2019","docslive2019:prod":"npm run clean && webpack --mode production --viewer_version v2019","dev":"webpack-dev-server --open google-chrome","watch":"webpack --watch --mode development","test":"karma start ./karma.conf.js","clean":"rimraf js/lib.* && rimraf js/newviewer.* && rimraf css/style.* && rimraf css/mobile.* && rimraf css/htmlmobile.* && rimraf images"},"author":"","license":"UNLICENSED","devDependencies":{"@types/node":"18.11.9","@types/d3":"5.16.4","@types/jquery":"3.5.16","@types/mocha":"5.2.7","cache-loader":"1.2.5","classlist-polyfill":"1.2.0","css-loader":"3.6.0","extract-loader":"3.2.0","extract-text-webpack-plugin":"4.0.0-beta.0","file-loader":"3.0.1","fork-ts-checker-webpack-plugin":"1.6.0","happypack":"5.0.1","html-webpack-plugin":"4.5.2","karma":"4.4.1","karma-chrome-launcher":"2.2.0","karma-firefox-launcher":"1.3.0","karma-ie-launcher":"1.0.0","karma-mocha":"1.3.0","karma-typescript":"4.1.1","karma-webpack":"4.0.2","mocha":"5.2.0","node-sass":"4.14.1","optimize-css-assets-webpack-plugin":"5.0.8","resolve-url-loader":"3.1.5","sass-loader":"7.3.1","style-loader":"0.23.1","svg-intersections":"0.4.0","thread-loader":"1.2.0","ts-loader":"3.5.0","typescript":"3.9.10","webpack":"4.46.0","webpack-cli":"3.3.12","webpack-dev-server":"3.11.3","webpack-spritesmith":"1.1.0"},"dependencies":{"core-js":"3.26.1","d3":"5.16.0","jquery":"3.6.3"}}')},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.NotSupportFullscreen=void 0;var r=n(3),a=n(0),s=function(){var e=this;this.eventObserver=null,this.eventBind=function(t){e.eventObserver=t},this.fullscreenON=function(t,n){void 0===n&&(n=!1),r("#wrap").addClass("fullscreen-hidden"),setTimeout((function(){e.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!0,isSupport:n}),r("#wrap").removeClass("fullscreen-hidden")}),100)},this.fullscreenOFF=function(t,n){return void 0===n&&(n=!1),i(e,void 0,void 0,(function(){var e=this;return o(this,(function(i){switch(i.label){case 0:return[4,a.Util.syncTimer((function(){e.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!1,isSupport:n})}),100)];case 1:return i.sent(),[2]}}))}))}};t.NotSupportFullscreen=s}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SupportFullscreen=void 0;var r=n(1),a=n(0),s=n(3),l=function(){var e=this;this.eventObserver=null,this.isNotSupport=!1,this.eventBind=function(t){e.eventObserver=t},this.fullscreenON=function(t,n){void 0===n&&(n=!0);var i=function(){var i=s("#container")[0],o=i.requestFullscreen||i.mozRequestFullScreen||i.webkitRequestFullScreen||i.msRequestFullscreen;if(o){var a=function(){o.call(i),setTimeout((function(){e.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!0,isSupport:n}),s("#wrap").removeClass("fullscreen-hidden")}),100)};if(r.Browser.instance.isIE||r.Browser.instance.isSafari)a();else try{o.call(i).then((function(){setTimeout((function(){e.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!0,isSupport:n}),s("#wrap").removeClass("fullscreen-hidden")}),100)})).catch((function(){e.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!0,isSupport:!1,error:!0}),s("#wrap").removeClass("fullscreen-hidden"),e.isNotSupport=!0}))}catch(e){a()}}};s("#wrap").addClass("fullscreen-hidden"),r.Browser.instance.isChrome?setTimeout((function(){i()}),5):i()},this.fullscreenOFF=function(t,n){return void 0===n&&(n=!0),i(e,void 0,void 0,(function(){var e,i,s,l=this;return o(this,(function(o){switch(o.label){case 0:return this.isNotSupport?(this.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!1,isSupport:!1}),this.isNotSupport=!1,[2]):(e=top.document,i=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen,s=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement,i&&s&&(i.call(e),r.Browser.instance.isSafari&&i.call(e)),[4,a.Util.syncTimer((function(){l.eventObserver.fullScreen.notify({skinType:t,isFullScreen:!1,isSupport:n})}),100)]);case 1:return o.sent(),[2]}}))}))}};t.SupportFullscreen=l}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(16),r=n(3),a=n(6),s=n(55),l=n(19),c=function(){var e=this;this.docInfo=null,this.eventObserver=null,this.activeAnnotation={elem:null,info:null},this.funcgetAnnotationInfos=null,this.popupWidth=function(){return"freetext"==e.activeAnnotation.elem.className?i.Util.isMobileMode()?82:72:i.Util.isMobileMode()?122:107},this.popupHeight=function(){return i.Util.isMobileMode()?42:37},this.saveForStyleMenu={isTop:void 0,ratio:void 0},this.popupDistance=5,this.popupElem=document.getElementById("annotation-popup"),this.annotationPopupBtnClassSelector="annotation-popup__item",this.annotationColorPickerClassSelector="annotation-color-picker__item",this.memoDeleteDialogClassSelector="dialog",this.memoDeleteDialogModalClassSelector="modal",this.markeClassSelector="marker-svg",this.annotListClassSelector="annot-page-li-active",this.memoIconClassSelector="memo-icon",this.annotListBtnClassSelector="annot-list-btn",this.freetextClassSelector="freetext",this.freetextTextAreaClassSelector="annotation-freetext",this.getPopupPosition=function(t,n,r){var l=a.default.parseMarkerId(t.id).pageOrSheetIdx,c=o.default.getAnnotRatio(l,i.Util.isCellSkin(e.docInfo)),d={left:parseFloat(t.style.left)*c,top:parseFloat(t.style.top)*c,width:parseFloat(t.style.width)*c,height:parseFloat(t.style.height)*c,obj:t},u=s.popUpPos(d,n,r,e.docInfo,l);return e.saveForStyleMenu={isTop:u.isTopPos,ratio:c},{left:u.left,top:u.top}},this.clickPropBtn=function(){e.hideAnnotationPopup(),e.eventObserver.showProp.notify({activeMarkerId:e.activeAnnotation.elem.id,ratio:e.saveForStyleMenu.ratio,isTop:e.saveForStyleMenu.isTop})},this.clickMemoBtn=function(){e.hideAnnotationPopup();var t=a.default.parseMarkerId(e.activeAnnotation.elem.id),n=t.pageOrSheetIdx,i=t.annotId;e.eventObserver.newMemo.notify({pageOrSheetIdx:n,annotId:i})},this.handleDeleteMarker=function(t){var n=0;if(t&&"string"==typeof t){var i=a.default.parseMarkerId(t);n=i.pageOrSheetIdx,e.activeAnnotation.info=o.default.getAnnotData(e.funcgetAnnotationInfos(),n,i.annotId)}else{if(!e.activeAnnotation.elem||!e.activeAnnotation.info)return;n=a.default.parseMarkerId(e.activeAnnotation.elem.id).pageOrSheetIdx}e.eventObserver.unSelectAnnotation.notify();var r={status:a.ANNOT_STATUS_TYPE.DELETE,page:n,annot:e.activeAnnotation.info,afterFunc:null,isUndoRedo:!1};e.eventObserver.saveAnnotationServer.notify(r),e.activeAnnotation.elem=null,e.activeAnnotation.info=null},this.showAnnotationPopup=function(t){var n=l.ScaleEvent.isSupportScale()?l.ScaleEvent.getBrowserScale():1,o=e.getPopupPosition(t,e.popupWidth()*n,e.popupHeight()*n),r=e.popupElem;r.style.cssText="left: "+o.left+"px; top: "+o.top+"px",l.ScaleEvent.scale(r,"left top"),i.Util.hasClass(e.activeAnnotation.elem,e.freetextClassSelector)?(i.Util.addClass(document.getElementById("annotation-popup"),"annotation-popup--short"),i.Util.addClass(document.getElementById("annotation-popup__memo"),"annotation-popup__item--hide")):(i.Util.removeClass(document.getElementById("annotation-popup"),"annotation-popup--short"),i.Util.removeClass(document.getElementById("annotation-popup__memo"),"annotation-popup__item--hide")),i.Util.removeClass(r,"annotation-popup--hide")},this.annotationSelect=function(t){var n=t.page,i=t.annotId,r=t.showPopup;if(e.hideAnnotationPopup(),r){var s=o.default.getAnnotData(e.funcgetAnnotationInfos(),n,i),l=document.getElementById(a.default.createtMarkerId(n,i));"memo"!==o.getAnnotType(s.annot)&&l&&(e.activeAnnotation.elem=l,e.activeAnnotation.info=s,e.showAnnotationPopup(e.activeAnnotation.elem))}},this.hideAnnotationPopup=function(){var t=e.popupElem;i.Util.addClass(t,"annotation-popup--hide")},this.unSelectAnnotationPopup=function(){e.hideAnnotationPopup(),e.activeAnnotation.elem=null,e.activeAnnotation.info=null},this.rePosition=function(){o.default.isFullScreen||!i.Util.hasClass(e.popupElem,"annotation-popup--hide")&&e.activeAnnotation.elem&&e.showAnnotationPopup(e.activeAnnotation.elem)},this.eventBind=function(t){e.eventObserver=t,e.eventObserver.selectAnnotation.subscribe(e.annotationSelect),e.eventObserver.unSelectAnnotation.subscribe(e.unSelectAnnotationPopup),e.eventObserver.dragAnnotStart.subscribe(e.hideAnnotationPopup),e.eventObserver.dragAnnotEnd.subscribe(e.annotationSelect),e.eventObserver.deleteMarker.subscribe(e.handleDeleteMarker),e.eventObserver.resizePage.subscribe(e.rePosition),i.Util.bindClickOrTouchEvent(r("#annotation-popup__prop"),"annotation-popup__item--hover",e.clickPropBtn),i.Util.bindClickOrTouchEvent(r("#annotation-popup__memo"),"annotation-popup__item--hover",e.clickMemoBtn),i.Util.bindClickOrTouchEvent(r("#annotation-popup__delete"),"annotation-popup__item--hover",e.handleDeleteMarker)},this.load=function(t,n,i){e.docInfo=t,e.eventBind(n),e.funcgetAnnotationInfos=i}};t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(16),r=n(6),a=n(43),s=n(62),l=n(3),c=function(){function e(){var t,n=this;this.docInfo=null,this.eventObserver=null,this.isCell=!1,this.curMemoStatus=(t=null,{set:function(e){t=e,i.Util.addClass(t,"memo-icon--on")},clear:function(){t&&i.Util.removeClass(t,"memo-icon--on"),t=null}}),this.funcgetAnnotationInfos=null,this.getMemoInfo=function(e){var t=r.default.parseMarkerId(e);return o.default.getAnnotData(n.funcgetAnnotationInfos(),t.pageOrSheetIdx,t.annotId).annot},this.getPageNumFromMemoId=function(e){var t=e.split("-");return parseInt(t[1])},this.selectAnnotation=function(e){if(n.unSelectAnnot(),void 0!==e){var t=document.getElementById(a.MemoIcon.getMemoId(e.page,e.annotId));n.curMemoStatus.set(t),t&&e.showMemo&&(n.memoContent.show(n.getMemoInfo(t.id),t,e.page,n.isCell,e.memoFocus),n.hideAnnotList(!0))}},this.hideAnnotList=function(e){r.default.isAnnotMode&&i.Util.isMobileMode()&&n.eventObserver.hideAnnotListInMobile.notify(e)},this.updatedMemoInfo=function(e,t,i){var o=n.getMemoInfo(e.id),r=e.id,a={left:(parseFloat(o.l)-t).toFixed(2),top:(parseFloat(o.t)-i).toFixed(2)};n.eventObserver.modifyMarkerAttr.notify({elemId:r,attr:a})},this.createMemoIcon=function(e,t,i){var o=new a.MemoIcon(n.eventObserver,e,n.memoContent,t,i,n.isCell);r.default.annotObjectMap.set(a.MemoIcon.getMemoId(t,i),o)},this.renderMemo=function(e,t){var i=t.annot,o=a.MemoIcon.getMemoId(e,t.id);document.getElementById(o)||n.createMemoIcon(i,e,t.id)},this.rePosition=function(){if(!o.default.isFullScreen&&s.MemoContent.isShow()){var e=n.memoContent.getContentElem().getAttribute("data-memo-id"),t=document.getElementById(e),i=n.getPageNumFromMemoId(e);n.memoContent.setPosition(t,i,n.isCell)}},this.handleDeleteMemo=function(){var t=n.memoContent.getContentElem().getAttribute("data-memo-id"),i=r.default.parseMarkerId(t),a=o.default.getAnnotData(n.funcgetAnnotationInfos(),i.pageOrSheetIdx,i.annotId);if(a){var s=function(){e.deleteMemoIcon(t),n.memoContent.hide(!1),n.hideAnnotList(!1)},c=a.annot.contents?l.extend(!0,{},a.annot.contents):{t:"",d:"",text:""};if("memo"===o.getAnnotType(a.annot)||""!==c.text){if(n.eventObserver.editedAnnotation.notify(i.pageOrSheetIdx),"memo"!==o.getAnnotType(a.annot)){n.eventObserver.modifyMarkerAttr.notify({elemId:t,attr:{text:""}})}else{var d={status:r.ANNOT_STATUS_TYPE.DELETE,page:i.pageOrSheetIdx,annot:a,afterFunc:null,isUndoRedo:!1};n.eventObserver.saveAnnotationServer.notify(d)}s()}else s()}},this.saveMemo=function(){var e=document.getElementById("annotation-memo__author-input"),t=n.memoContent.getContentElem().getAttribute("data-memo-id");if(t){var a={author:e.value,text:n.memoContent.getContentElem().value},s=r.default.parseMarkerId(t),c=s.pageOrSheetIdx,d=s.annotId,u=o.default.getAnnotData(n.funcgetAnnotationInfos(),c,d);if(u){if("memo"!==o.getAnnotType(u.annot)&&0===n.memoContent.getContentElem().value.length){var h=document.getElementById(t);h&&i.Util.getParentElement(h).removeChild(h)}var f=u.annot.contents?l.extend(!0,{},u.annot.contents):{t:"",d:"",text:""};f.t===a.author&&f.text===a.text||(n.eventObserver.editedAnnotation.notify(c),n.eventObserver.modifyMarkerAttr.notify({elemId:t,attr:a}))}}},this.unSelectAnnot=function(){n.curMemoStatus.clear(),n.memoContent.hide(!0),n.hideAnnotList(!1)},this.hideMemoIcon=function(e){var t=e.elemId,n=r.default.parseMarkerId(t),i=n.pageOrSheetIdx,o=n.annotId,s=document.getElementById(a.MemoIcon.getMemoId(i,o));s&&(s.style.display="none")},this.showMemoIcon=function(e){var t=e.page,i=e.annotId,o=document.getElementById(a.MemoIcon.getMemoId(t,i));if(o){var r=a.MemoIcon.getPosition(n.getMemoInfo(a.MemoIcon.getMemoId(t,i)),t,n.isCell),s=r.top,l=r.left;o.style.left=l+"px",o.style.top=s+"px",o.style.display=""}},this.addMemo=function(e){var t=e.pageOrSheetIdx,i=e.annotId;n.unSelectAnnot();var o=a.MemoIcon.getMemoId(t,i),r=!1;if(!document.getElementById(o)){var s=n.getMemoInfo(o);n.createMemoIcon(s,t,i),r=!0}n.eventObserver.selectAnnotation.notify({page:t,annotId:i,showMemo:!0,showPopup:!1,memoFocus:r})},this.fullscreen=function(e){var t=e.isFullScreen?i.Util.addClass:i.Util.removeClass;Array.from(document.getElementsByClassName("memo-icon")).forEach((function(e){t(e,"hide")}))},this.eventBind=function(e){n.eventObserver=e,n.eventObserver.resizeContents.subscribe(n.rePosition),n.eventObserver.newMemo.subscribe(n.addMemo),n.eventObserver.unSelectAnnotation.subscribe(n.unSelectAnnot),n.eventObserver.selectAnnotation.subscribe(n.selectAnnotation),n.eventObserver.dragAnnotStart.subscribe(n.hideMemoIcon),n.eventObserver.dragAnnotEnd.subscribe(n.showMemoIcon),n.eventObserver.deleteMarker.subscribe((function(){n.memoContent.hide(!1),n.hideAnnotList(!1)})),n.eventObserver.fullScreen.subscribe(n.fullscreen),document.getElementById("annotation-memo__delete-btn").addEventListener("click",n.handleDeleteMemo)},this.load=function(e,t,o){n.docInfo=e,n.isCell=i.Util.isCellSkin(n.docInfo),n.funcgetAnnotationInfos=o,n.eventBind(t)},this.memoContent=new s.MemoContent(this.saveMemo),a.MemoIcon.setMemoCommonFunc(this.getMemoInfo,this.updatedMemoInfo)}return e.deleteMemoIcon=function(e){var t=document.getElementById(e);i.Util.removeElem(t),r.default.annotObjectMap.has(e)&&(r.default.annotObjectMap.get(e).delete(),r.default.annotObjectMap.delete(e))},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageFit=void 0;var i=n(3),o=n(0),r=n(26),a=n(37),s=n(1),l=function(){var e=this;this.rotateSize=[0,0],this.noneRotateSize=[0,0],this.scrollContentAreaEl=s.Browser.instance.isIOS?i(document):i("#contents"),this.PADDING=4,this.resizePage=function(t,n,l,c){var d,u,h;void 0===l&&(l=0),void 0===c&&(c=0);var f=o.Util.fixedPageFit()||s.Browser.instance.isMobile||100===a.DetectZoom.getRatio()?1:a.DetectZoom.getRatio()/100,p=i("#page-area0").height(),m=e.scrollContentAreaEl.scrollTop(),g=i(".contents-page").length,v=0===c||c>g?g:l+c,b=i("#contents").width(),y=0;y=s.Browser.instance.isIOS&&o.Util.isFullScreen()?window.innerHeight:document.getElementById("contents").offsetHeight,o.Util.isFullScreen()&&(r.Page.isOutFullscreen=!0),e.rotateSize=[y,b],e.noneRotateSize=[b,y];for(var E=l;E<v;++E){var I=n.get(E),S=void 0,w=void 0;if(void 0===I)S=(d=e.getResizeResult(!1,r.Page.ORIGIN_SIZE[E].width,r.Page.ORIGIN_SIZE[E].height))[0],w=d[1];else if(I%180!=0){S=(u=e.getResizeResult(!0,r.Page.ORIGIN_SIZE[E].width,r.Page.ORIGIN_SIZE[E].height))[0];var _=(y-(w=u[1]))*f/2;i("#page"+E).css({"margin-top":_,"margin-bottom":_})}else S=(h=e.getResizeResult(!1,r.Page.ORIGIN_SIZE[E].width,r.Page.ORIGIN_SIZE[E].height))[0],w=h[1];if(o.Util.isFullScreen())if(1===f){var T=(y-w*f)/2;void 0===I||I%180==0?i("#page"+E).css({"margin-top":T,"margin-bottom":T}):i("#page"+E).css("margin",T+"px auto")}else void 0!==I&&I%180!=0||i("#page"+E).css({"margin-top":"","margin-bottom":""});else r.Page.isOutFullscreen&&(void 0!==I&&I%180!=0||i("#page"+E).css({"margin-top":"","margin-bottom":""}));i("#page"+E).css({width:S*f,height:w*f}),r.Page.CURRENT_SIZE[E]={width:S*f,height:w*f}}r.Page.isOutFullscreen=o.Util.isFullScreen(),e.setPageMargin(f),!s.Browser.instance.isIOS&&e.scrollContentAreaEl.scrollTop(m*(i("#page-area0").height()/p)),o.Util.isFullScreen()&&(document.getElementById("contents-area").style.paddingBottom="")},this.getResizeResult=function(t,n,i,o){var r;void 0===o&&(o=null);var a=t?e.rotateSize:null===o?e.noneRotateSize:o,s=a[0],l=a[1],c=(s-e.PADDING)/n,d=(l-e.PADDING)/i;return[n*(r=l<s&&n*d<s||l>s&&i*c>l?d:c),i*r]},this.setPageMargin=function(e){var t=i("#page-area0").height()/r.Page.ORIGIN_SIZE[0].height*e;i(".contents-page").css("margin-top",r.Page.ORIGIN_MARGIN.marginTop*t),i(".contents-page").css("margin-bottom",r.Page.ORIGIN_MARGIN.marginBottom*t)}};t.PageFit=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageWidthFit=void 0;var i=n(3),o=n(0),r=n(26),a=n(37),s=n(1),l=function(){var e=this;this.contentAreaWidth=0,this.scrollContentAreaEl=s.Browser.instance.isIOS?i(document):i("#contents"),this.PADDING=4,this.resizePage=function(t,n,l,c){void 0===l&&(l=0),void 0===c&&(c=0);var d=o.Util.fixedPageFit()||s.Browser.instance.isMobile||100===a.DetectZoom.getRatio()?1:a.DetectZoom.getRatio()/100,u=i("#page-area0").height(),h=e.scrollContentAreaEl.scrollTop(),f=i(".contents-page").length,p=0===c||c>f?f:l+c;e.contentAreaWidth=i("#contents").width(),o.Util.isFullScreen()&&s.Browser.instance.isIOS&&!s.Browser.instance.isiPad&&s.Browser.instance.getIOSVersion()>=11&&(document.getElementById("fullscreen-close").style.position="",document.getElementById("fullscreen-close").style.top="");for(var m=l;m<p;++m){var g=n.get(m),v=e.getResizeResult(!1,r.Page.ORIGIN_SIZE[m].width,r.Page.ORIGIN_SIZE[m].height),b=v[0],y=v[1];if(g&&g%180!=0){var E=(b-y)*d/2;if(e.contentAreaWidth<y){var I=(y-e.contentAreaWidth)*d/2;i("#page"+m).css("margin",E+"px "+I+"px")}else i("#page"+m).css("margin",E+"px auto")}r.Page.isOutFullscreen&&(void 0!==g&&g%180!=0||i("#page"+m).css({"margin-top":"","margin-bottom":""})),i("#page"+m).css({width:b*d,height:y*d}),r.Page.CURRENT_SIZE[m]={width:b*d,height:y*d}}r.Page.isOutFullscreen=o.Util.isFullScreen(),e.setPageMargin(d),!s.Browser.instance.isIOS&&e.scrollContentAreaEl.scrollTop(h*(i("#page-area0").height()/u))},this.getResizeResult=function(t,n,i){var o=(e.contentAreaWidth-e.PADDING)/n;return[n*o,i*o]},this.setPageMargin=function(e){o.Util.isFullScreen()&&i(".contents-page__img").css({"margin-top":"","margin-bottom":""});var t=i("#page-area0").height()/r.Page.ORIGIN_SIZE[0].height*e;i(".contents-page").css("margin-top",r.Page.ORIGIN_MARGIN.marginTop*t),i(".contents-page").css("margin-bottom",r.Page.ORIGIN_MARGIN.marginBottom*t)}};t.PageWidthFit=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageZoom=void 0;var i=n(3),o=n(26),r=n(37),a=n(1),s=function(){var e=this;this.scrollContentAreaEl=a.Browser.instance.isIOS?i(document):i("#contents"),this.resizePage=function(t,n,s,l){void 0===s&&(s=0),void 0===l&&(l=0);for(var c=a.Browser.instance.isMobile||100===r.DetectZoom.getRatio()?1:r.DetectZoom.getRatio()/100,d=i("#page-area0").height(),u=e.scrollContentAreaEl.scrollTop(),h=e.scrollContentAreaEl.scrollLeft(),f=i(".contents-page").length,p=0===l||l>f?f:s+l,m=s;m<p;++m){var g=n.get(m),v=t/100,b=[o.Page.ORIGIN_SIZE[m].width*v,o.Page.ORIGIN_SIZE[m].height*v],y=b[0],E=b[1];if(g&&g%180!=0){var I=(y-E)*c/2;if(i("#contents").width()<E){var S=(E-y)*c/2;i("#page"+m).css("margin",I+"px "+S+"px")}else i("#page"+m).css("margin",I+"px auto")}i("#page"+m).css({width:y*c,height:E*c}),o.Page.CURRENT_SIZE[m]={width:y*c,height:E*c}}e.setPageMargin(c);var w=i("#page-area0").height()/d;e.scrollContentAreaEl.scrollTop(u*w),e.scrollContentAreaEl.scrollLeft(h*w)},this.getResizeResult=function(e,t,n){var i=o.Page.RESIZE_OBJ.percent/100;return(e?[n,t]:[t,n]).map((function(e){return e*i}))},this.setPageMargin=function(e){var t=i("#page-area0").height()/o.Page.ORIGIN_SIZE[0].height*e;i(".contents-page").css("margin-top",o.Page.ORIGIN_MARGIN.marginTop*t),i(".contents-page").css("margin-bottom",o.Page.ORIGIN_MARGIN.marginBottom*t)}};t.PageZoom=s},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DPIPage=void 0;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getParam=function(e){var n={};return n.w=Math.round(e.width*t.ratio),n.h=Math.round(e.height*t.ratio),n},t}return o(t,e),t}(n(61).DPI);t.DPIPage=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),o=n(110),r=n(111),a=n(0),s=n(1),l=function(){var e=this;this.createDialogEl=function(e){void 0===e&&(e=!0);var t=document.createElement("div");return t.id=r.default.dialogElSelector,t.title=i.LocaleMessage.getMessage("dialog"),t.className=e?r.default.dialogElSelector+" "+r.default.dialogElSelector+"--min-width":r.default.dialogElSelector,t},this.createMsgBox=function(e){var t=document.createElement("div");return t.className=r.default.dialogElSelector+"__msg",t.innerHTML=e,t},this.createLocaleMsgBox=function(t){return e.createMsgBox(i.LocaleMessage.getMessage(t))},this.createCheckBox=function(e){var t=document.createElement("div"),n=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input");return l.type="checkbox",l.id=e.id,l.checked=e.checked,l.value=e.value,o.innerHTML=i.LocaleMessage.getMessage(e.message),n.appendChild(l),n.appendChild(o),t.appendChild(n),s.Browser.instance.isMobile&&n.addEventListener(a.Util.getClickOrTouchEventName(),(function(e){this.click(),e.preventDefault(),e.stopPropagation()})),t.className=r.default.dialogElSelector+"__checkbox",t},this.createBtnEl=function(e,t,n){void 0===n&&(n=null);var o=document.createElement("div");return o.className="btn btn--"+t,o.innerHTML=i.LocaleMessage.getMessage(e),o.title=i.LocaleMessage.getMessage(e),o.addEventListener(a.Util.getClickOrTouchEventName(),(function(){n&&n()})),o},this.createSingleBtnBoxEl=function(t,n,i){void 0===i&&(i=null);var o=e.createBtnEl(t,n,i),a=document.createElement("div");return a.className=r.default.dialogElSelector+"__btn "+r.default.dialogElSelector+"__btn--single",a.appendChild(o),{btnEl:o,boxEl:a}},this.create2AnswerBtnBoxEl=function(t,n,i,s){void 0===i&&(i=null),void 0===s&&(s=null);var l=e.createBtnEl(n,o.BUTTON_COLOR.WHITE,s);a.Util.addClass(l,"btn--answer-left");var c=e.createBtnEl(t,o.BUTTON_COLOR.BLACK,i),d=document.createElement("div");return d.className=r.default.dialogElSelector+"__btn "+r.default.dialogElSelector+"__btn--answer",d.appendChild(l),d.appendChild(c),{boxEl:d,yesBtnEl:c,noBtnEl:l}},this.create3AnswerBtnBoxEl=function(t,n,i,s,l,c){void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null);var d=e.createBtnEl(i,o.BUTTON_COLOR.WHITE,c);a.Util.addClass(d,"btn--answer-white"),a.Util.addClass(d,"btn--3answer-width");var u=e.createBtnEl(n,o.BUTTON_COLOR.WHITE,l);a.Util.addClass(u,"btn--answer-white"),a.Util.addClass(u,"btn--3answer-width");var h=e.createBtnEl(t,o.BUTTON_COLOR.BLACK,s);a.Util.addClass(h,"btn--3answer-width");var f=document.createElement("div");return f.className=r.default.dialogElSelector+"__btn "+r.default.dialogElSelector+"__btn--answer",f.appendChild(d),f.appendChild(u),f.appendChild(h),{boxEl:f,yesBtnEl:h,noBtnEl:u,cancelBtnEl:d}},this.createKeyValueBoxEl=function(e){var t=document.createElement("div");t.className="key-box";var n=document.createElement("div");n.className="value-box";for(var i=0,o=e;i<o.length;i++){var r=o[i],a=r.key,s=r.value,l=document.createElement("div");l.className="key-box__item",l.innerText=a,t.appendChild(l);var c=document.createElement("div");c.className="value-box__item",c.innerHTML=s,n.appendChild(c)}var d=document.createElement("div");d.className="key-value";var u=document.createElement("div");u.className="key-value__key-box",u.appendChild(t),d.appendChild(u);var h=document.createElement("div");return h.className="key-value__value-box",h.appendChild(n),d.appendChild(h),d}};t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),o=n(1),r=n(111),a=n(110),s=n(51),l=n(0),c=n(52),d=function(){function e(e){var t=this;this.create=function(){var e=t.elFactory.createLocaleMsgBox("sns_title"),n=t.createUrlBoxEl(),i=t.createSnsBtnBoxEl(),o=t.elFactory.createSingleBtnBoxEl("msg_cancel",a.BUTTON_COLOR.WHITE,(function(){t.closeSnsDialog()})).boxEl,l=t.elFactory.createDialogEl(!1);l.appendChild(e);var d=document.createElement("div");d.className=r.default.dialogElSelector+"__url",d.appendChild(n);var u=document.createElement("div");u.className=r.default.dialogElSelector+"__sns",u.appendChild(i);var h=document.createElement("div");return h.className=r.default.dialogElSelector+"__order",h.appendChild(d),h.appendChild(u),l.appendChild(h),l.appendChild(o),l.addEventListener("keydown",(function(e){"Escape"!==e.key&&e.keyCode!==c.keyMap.ESC||s.default.instance.remove()})),l},this.createUrlBoxEl=function(){var e=document.createElement("a");e.className="url__text",e.innerText=t.url,o.Browser.instance.isIOS&&o.Browser.instance.getIOSVersion()<10&&(e.href=t.url);var n=document.createElement("div");n.className="url__btn";var r=""+i.LocaleMessage.getMessage("sns_url_copy");n.innerHTML=r,n.title=r,n.tabIndex=0,n.addEventListener(l.Util.getClickOrTouchEventName(),(function(){t.clipboardCopy(e)})),l.Util.bindEnterKey(n);var a=document.createElement("div");return a.className="url",a.appendChild(e),o.Browser.instance.isIOS9Lower()||a.appendChild(n),a},this.createSnsBtnEl=function(e,t){var n=document.createElement("div");return n.id="sns__btn--"+e,n.className="sns__btn sns__btn--"+e,n.title=e,n.tabIndex=0,n.addEventListener(l.Util.getClickOrTouchEventName(),(function(){t()})),l.Util.bindEnterKey(n),n},this.createSnsBtnBoxEl=function(){var e=document.createElement("div");e.className="sns";for(var n=function(n){if("kakaotalk"==n&&!window.localSynap.config.kakaoAPIKey)return"continue";var i=t.createSnsBtnEl(n,(function(){t.sendSns(n),t.closeSnsDialog()}));e.appendChild(i)},i=0,o=["facebook","twitter","kakaotalk","band"];i<o.length;i++){n(o[i])}return e},this.closeSnsDialog=function(){l.Util.removeClass(document.getElementById("sns-btn__img"),"sns-btn__img--on"),s.default.instance.remove()},this.elFactory=e,this.url=document.location.href}return e.prototype.allowAuth=function(e){return!(!window.clipboardData||window.clipboardData.getData("Text")!==e)},e.prototype.clipboardCopy=function(e){var t=[l.Util.getPageXOffset(),l.Util.getPageYOffset()],n=t[0],r=t[1],a=document.createElement("input");if(a.type="text",a.value=e.innerText,a.readOnly=!0,document.body.appendChild(a),o.Browser.instance.isIOS){var s=a.contentEditable,c=a.readOnly;a.contentEditable="true",a.readOnly=!1;var d=document.createRange();d.selectNodeContents(a);var u=window.getSelection();u.removeAllRanges(),u.addRange(d),a.setSelectionRange(0,999999),a.contentEditable=s,a.readOnly=c}else a.focus(),a.select();if(!o.Browser.instance.isIOS9Lower())try{var h=document.execCommand("copy",null,null);o.Browser.instance.isIE&&window.clipboardData&&(window.clipboardData.clearData(),window.clipboardData.setData("Text",a.value)),!h||o.Browser.instance.isIE&&!this.allowAuth(a.value)||alert(""+i.LocaleMessage.getMessage("sns_url_copy_completed")),window.scrollTo(n,r)}catch(e){alert(e)}document.body.removeChild(a)},e.prototype.sendSns=function(t,n){void 0===n&&(n="");var r=window.localSynap.config.kakaoAPIKey;if(!0!==e.kakaoInit&&void 0!==r)try{Kakao.init(r),e.kakaoInit=!0}catch(e){console.log("Kakao.init has already been run or there is an exception.")}var a=encodeURIComponent(this.url),s=encodeURIComponent(n),l=encodeURIComponent("\r\n"),c={};switch(t){case"facebook":c.method="popup",c.url="http://www.facebook.com/sharer/sharer.php?u="+a;break;case"twitter":c.method="popup",c.url="http://twitter.com/intent/tweet?text="+s+"&url="+a;break;case"kakaostory":c.method="popup",c.url="https://story.kakao.com/share?url="+a;break;case"band":o.Browser.instance.isMobile?(c.method="web2app",c.param="bandapp://create/post?text="+s+l+a,c.a_store="itms-apps://itunes.apple.com/app/id542613198",c.g_store="market://details?id=com.nhn.android.band"):(c.method="popup",c.url="http://www.band.us/plugin/share?body="+a);break;case"kakaotalk":try{Kakao.Share.sendDefault({objectType:"text",text:""+i.LocaleMessage.getMessage("view_title"),link:{mobileWebUrl:this.url,webUrl:this.url},installTalk:!0})}catch(e){}return!0;default:return!1}switch(c.method){case"popup":window.open(c.url);break;case"web2app":if(o.Browser.instance.isAndroid)if(-1!==o.Browser.instance.getChromeVersion())location.href="intent:"+c.param+"#Intent;package=com.nhn.android.band;end;";else{var d=document.createElement("iframe");d.style.display="none",d.src=c.param,document.body.appendChild(d),document.body.removeChild(d)}else o.Browser.instance.isIOS&&(location.href=c.param)}},e.kakaoInit=!1,e}();t.default=d},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CellTextSearch=t.DEFAULT_STROKE_WIDTH=void 0;var s=n(27),l=n(82),c=n(65),d=n(33),u=n(168),h=n(6),f=n(0),p=n(54),m=n(17),g=n(30),v=n(1);t.DEFAULT_STROKE_WIDTH=6;var b=function(e){function n(n,i,o){var h=e.call(this,n,i)||this;return h.textLayer=null,h.prevSearchResult={searchedCells:[],query:"",focusedCellIdx:null},h.nextSearchTileIdx="",h.renderFocusRect=function(e,n,i,o,r){f.Util.removeElem(document.getElementById("cell-focus-rect"));var a=document.getElementById("textLayer"+h.docInfo.currentSheet),l=g.default.instance.getPageOrCurrentSheetRatio(h.docInfo.currentSheet,!0),c=(n-1)*l,d=(i-1)*l,u=o*l,p=r*l,m=h.textLayer.getCellText(e,n,i),v=s.select(a).append("svg").attr("id","cell-focus-rect").attr("class","marker-svg").attr("viewBox",c+" "+d+" "+u+" "+p).style("left",c+"px").style("top",d+"px").style("width",u+"px").style("height",p+"px").attr("data",n-1+"_"+(i-1)+"_"+o+"_"+r);return v.append("rect").attr("class","cell-search-rect").attr("x",""+c).attr("y",""+d).attr("width",u+"px").attr("height",p+"px").style("stroke-width",(t.DEFAULT_STROKE_WIDTH*l).toFixed(0)+"px").append("title").text(m),v},h.getTileX=function(e){return 1+e*d.ImageSheet.defaultCellWidth},h.getTileY=function(e){return 1+e*d.ImageSheet.defaultCellHeight},h.getTileInfo=function(e,t){var n=h.getTileX(e),i=h.getTileY(t);return{tileIdx:h.docInfo.currentSheet+"_"+n+"_"+i,thumbnailX:n,thumbnailY:i}},h.parseTileIdx=function(e){var t=e.toString().split("_");return{col:(parseInt(t[1])-1)/d.ImageSheet.defaultCellWidth,row:(parseInt(t[2])-1)/d.ImageSheet.defaultCellHeight}},h.parseSearchResult=function(e){var t=e.split("_").map((function(e){return parseFloat(e)}));return{tileIdx:t[0]+"_"+t[1]+"_"+t[2],left:t[3],top:t[4],width:t[5],height:t[6]}},h.searchText=function(e,t){return r(h,void 0,void 0,(function(){var n,i,o,r,s,c,u,h;return a(this,(function(a){switch(a.label){case 0:this.prevSearchResult.query!==t&&this.clearPrevSearchResult(),n=this.parseTileIdx(e),i=this.docInfo.currentSheet,o=n.row,r=n.col,s=[],l.TextSearch.cachedSearchCount=0,l.TextSearch.isSearching=!0,this.disableMoveBtnDuringSearch(),a.label=1;case 1:return o<d.ImageSheet.maxRow&&r<d.ImageSheet.maxCol?l.TextSearch.isSearching?(c=this.getTileInfo(r,o),this.textLayer.updatedTile(c.tileIdx)?[3,3]:[4,this.textLayer.updateTileText(i,c.thumbnailX,c.thumbnailY)]):[2]:[3,7];case 2:return a.sent(),[3,5];case 3:return l.TextSearch.cachedSearchCount+=1,l.TextSearch.cachedSearchCount%100!=0?[3,5]:[4,f.Util.sleep(5)];case 4:a.sent(),a.label=5;case 5:return[4,this.search(t,c.tileIdx)];case 6:return s=a.sent(),r+1===d.ImageSheet.maxCol?(r=0,o+=1):r+=1,this.nextSearchTileIdx=this.getTileInfo(r,o).tileIdx,0!==s.length?[3,7]:[3,1];case 7:if(this.enableMoveBtnAfterSearch(),l.TextSearch.isSearching=!1,0!==s.length){if(this.prevSearchResult.query===t)for(this.prevSearchResult.focusedCellIdx=this.prevSearchResult.searchedCells.length,u=0;u<s.length;++u)this.prevSearchResult.searchedCells.push(s[u]);else this.prevSearchResult.query=t,this.prevSearchResult.searchedCells=s,this.prevSearchResult.focusedCellIdx=0;this.searchMoveBtnEnable("search-next"),this.searchMoveBtnEnable("search-prev"),h=this.parseSearchResult(s[0]),this.renderFocusRect(h.tileIdx,h.left,h.top,h.width,h.height),this.searchScroll()}else 0!==this.prevSearchResult.searchedCells.length?this.searchMoveBtnDisable("search-next",p.SEARCH_TYPE.NEXT,!1):(f.Util.removeElem(document.getElementById("cell-focus-rect")),f.Util.addClass(this.searchInput,"search__input--notfound"),this.searchInput.value=m.LocaleMessage.getMessage("empty-searchword"),this.searchMoveBtnDisable("search-next",p.SEARCH_TYPE.NONE,!0),this.searchMoveBtnDisable("search-prev",p.SEARCH_TYPE.NONE,!0),this.searchInput.blur());return[2]}}))}))},h.search=function(e,t){return r(h,void 0,void 0,(function(){var n,i,o,r,s=this;return a(this,(function(a){return void 0===(n=c.TextLayer.getLocalStorageText(this.docInfo.jobId)[t])||0===u.kmp(Array.from(n),Array.from(e)).length?[2,[]]:(i=function(e){var t=e.split("_");return{left:t[3],top:t[4]}},o=function(e){return s.prevSearchResult.searchedCells.some((function(t){var n=i(t);return e.left===n.left&&e.top===n.top}))},r=this.textLayer.getCellInfo(t,e),[2,r.filter((function(e){var t=i(e);return!o(t)}))])}))}))},h.getSearchStartTileIdx=function(e,t){var n=!1,i=null,o=null;if(h.prevSearchResult.searchedCells.length>0&&h.prevSearchResult.query===e){var r=h.prevSearchResult.focusedCellIdx;if(t==p.SEARCH_TYPE.NEXT){if((i=r+1)===h.prevSearchResult.searchedCells.length)return{bNeedSearch:n=!0,searchStartTileIdx:h.nextSearchTileIdx,shiftedIdx:null}}else i=r-1}else{n=!0;var a=d.ImageSheet.getEndRowCol();o=h.getTileInfo(a.endCol,a.endRow).tileIdx}return{bNeedSearch:n,searchStartTileIdx:o,shiftedIdx:i}},h.moveSearchResult=function(e){return r(h,void 0,void 0,(function(){var t,n,i,o,r,s,l=this;return a(this,(function(a){switch(a.label){case 0:return e==p.SEARCH_TYPE.NONE||0==(t=this.searchInput.value.toLowerCase()).length?[2]:this.prevSearchResult.query==t?[3,2]:(this.loadSpinner(),[4,this.clearSearchResult()]);case 1:return a.sent(),setTimeout((function(){l.removeSpinner()}),200),[2];case 2:return n=this.getSearchStartTileIdx(t,e),i=n.searchStartTileIdx,n.bNeedSearch?(o=this.getTileInfo(d.ImageSheet.maxCol-1,d.ImageSheet.maxRow-1).tileIdx,i===this.getTileInfo(0,0).tileIdx&&i!==o?(this.searchMoveBtnDisable("search-prev",e),this.prevSearchResult.searchedCells.length>1&&this.searchMoveBtnEnable("search-next"),[2]):(r=this.getTileInfo(0,d.ImageSheet.maxRow).tileIdx,i===r?(this.searchMoveBtnDisable("search-next",e),this.prevSearchResult.searchedCells.length>1&&this.searchMoveBtnEnable("search-prev"),[2]):(this.loadSpinner(),e!==p.SEARCH_TYPE.NEXT?[3,4]:[4,this.searchText(i,t)]))):[3,5];case 3:a.sent(),setTimeout((function(){l.removeSpinner()}),200),a.label=4;case 4:return[3,6];case 5:if(e===p.SEARCH_TYPE.PREV&&-1===n.shiftedIdx)return this.searchMoveBtnDisable("search-prev",p.SEARCH_TYPE.PREV),[2];s=this.parseSearchResult(this.prevSearchResult.searchedCells[n.shiftedIdx]),this.prevSearchResult.focusedCellIdx=n.shiftedIdx,this.renderFocusRect(s.tileIdx,s.left,s.top,s.width,s.height),this.searchScroll(),0===this.prevSearchResult.focusedCellIdx&&this.prevSearchResult.focusedCellIdx==this.prevSearchResult.searchedCells.length-1||(this.searchMoveBtnEnable("search-prev"),this.searchMoveBtnEnable("search-next")),a.label=6;case 6:return[2]}}))}))},h.clearPrevSearchResult=function(){h.prevSearchResult={searchedCells:[],query:"",focusedCellIdx:null},h.searchMoveBtnEnable("search-prev"),h.searchMoveBtnEnable("search-next")},h.sheetMoveEvent=function(){h.clearPrevSearchResult(),f.Util.removeClass(h.searchInput,"search__input--notfound"),""!==h.searchInput.value&&(h.searchInput.value=""),document.getElementById("search__label").style.display="block"},h.textLayer=o,h.eventBind(),h.nextSearchTileIdx=h.docInfo.currentSheet+"_1_1",h}return o(n,e),n.prototype.clearSearchResult=function(){return r(this,void 0,void 0,(function(){var e,t=this;return a(this,(function(n){switch(n.label){case 0:return 0==(e=this.searchInput.value.toLowerCase()).length?(this.searchMoveBtnDisable("search-next",p.SEARCH_TYPE.NONE,!0),this.searchMoveBtnDisable("search-prev",p.SEARCH_TYPE.NONE,!0),this.searchInput.blur(),[2]):this.prevSearchResult.query==e?[3,2]:(this.loadSpinner(),[4,this.searchText(this.getTileInfo(0,0).tileIdx,e)]);case 1:return n.sent(),setTimeout((function(){t.removeSpinner()}),200),[3,3];case 2:this.moveSearchResult(p.SEARCH_TYPE.NEXT),n.label=3;case 3:return[2]}}))}))},n.prototype.searchResultShow=function(){var e=document.getElementById("cell-focus-rect");e&&e.setAttribute("display","block")},n.prototype.searchResultHide=function(){l.TextSearch.isSearching=!1;var e=document.getElementById("cell-focus-rect");e&&e.setAttribute("display","none")},n.prototype.searchScroll=function(){h.annotScrollMove("cell-focus-rect",parseInt(this.docInfo.currentSheet),!0),v.Browser.instance.isMobile&&this.searchInput.blur()},n.prototype.eventBind=function(){this.eventObserver.searchNext.subscribe(this.moveSearchResult),this.eventObserver.sheet.subscribe(this.sheetMoveEvent),this.eventObserver.searchDisplay.subscribe(this.searchDisplay)},n}(l.TextSearch);t.CellTextSearch=b}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WordTextSearch=void 0;var s=n(17),l=n(0),c=n(16),d=n(65),u=n(82),h=n(54),f=n(169),p=n(168),m=n(6),g=n(1),v=function(e){function t(t,n,i){var o=e.call(this,t,n)||this;return o.textLayer=null,o.prevSearchResult={textId:[],query:"",highlight:""},o.isSearchFocus=!1,o.getSearchIndex=function(e,t){var n=!1,i=o.prevSearchResult.highlight,r=c.default.parseTextId(o.prevSearchResult.highlight),a=o.docInfo.currentPage===r.pageNum?o.docInfo.currentPage:r.pageNum,s=null;if(o.prevSearchResult.textId.length>0&&o.prevSearchResult.query===e){var l=o.prevSearchResult.textId.indexOf(i);t==h.SEARCH_TYPE.NEXT?(s=o.prevSearchResult.textId[l+1],a+=1):(s=o.prevSearchResult.textId[l-1],a-=1),void 0!==s&&(n=!0,a=c.default.parseTextId(s).pageNum)}return{result:n,pageIdx:a,updateIdx:s}},o.moveSearchText=function(e,t,n){return void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=h.SEARCH_TYPE.NEXT),r(o,void 0,void 0,(function(){var i,o,r,p,m,g,v,b,y,E,I,S,w,_,T;return a(this,(function(a){switch(a.label){case 0:i=e,o=null==t?this.docInfo.currentPage:t,r=this.docInfo.status.pageNum-1,p=d.TextLayer.getLocalStorageText(this.docInfo.jobId),m=[],g=!1,v=n!=h.SEARCH_TYPE.PREV,u.TextSearch.isSearching=!0,u.TextSearch.cachedSearchCount=0,this.disableMoveBtnDuringSearch(),a.label=1;case 1:return o>=0&&o<=r?u.TextSearch.isSearching?[4,this.search(i,o)]:[2]:[3,10];case 2:return 0==(m=a.sent()).length&&o===r||!v&&0==m.length&&o<=0?(g=!0,[3,10]):0!=m.length?[3,8]:(v?o++:o--,p[o]?[3,5]:[4,c.default.getXml(this.docInfo,o,this.docInfo.dpi)]);case 3:return null==a.sent().result?[3,1]:[4,this.textLayer.setTextObjectAndLocalStorage(o,p)];case 4:return a.sent(),[3,7];case 5:return u.TextSearch.cachedSearchCount+=1,u.TextSearch.cachedSearchCount%100!=0?[3,7]:[4,l.Util.sleep(5)];case 6:a.sent(),a.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,1];case 10:if(this.enableMoveBtnAfterSearch(),u.TextSearch.isSearching=!1,g&&0===this.prevSearchResult.textId.length)return l.Util.addClass(this.searchInput,"search__input--notfound"),this.searchInput.value=s.LocaleMessage.getMessage("empty-searchword"),this.searchInput.blur(),[2];if(g&&n!=h.SEARCH_TYPE.NONE)return n==h.SEARCH_TYPE.NEXT?(this.searchMoveBtnDisable("search-next",n),1!==this.prevSearchResult.textId.length&&this.searchMoveBtnEnable("search-prev")):(this.searchMoveBtnDisable("search-prev",n),1!==this.prevSearchResult.textId.length&&this.searchMoveBtnEnable("search-next")),[2];if(0!=m.length)for(b=c.default.parseTextId(this.prevSearchResult.highlight),S=0;S<i.length;S++)y=f.WordTextLayer.getTextId(b.pageNum,b.idx+S),E=document.getElementById(y),l.Util.removeClass(E,"text--current"),l.Util.addClass(E,"text--highlight");return[4,this.createTextLayerAndText(o)];case 11:for(a.sent(),I=[],S=0;S<m.length;S++){for(w=m[S],_=0;_<i.length;_++)T=document.getElementById("text-"+o+"-"+(w+_)),l.Util.containClassName(T,"text--highlight")||(l.Util.addClass(T,"text--highlight"),0==S&&v?(this.isSearchFocus=!0,l.Util.addClass(T,"text--current")):S!=m.length-1||v||(this.isSearchFocus=!0,l.Util.addClass(T,"text--current"))),0==S&&0==_&&v?this.prevSearchResult.highlight="text-"+o+"-"+w:S!=m.length-1||0!=_||v||(this.prevSearchResult.highlight="text-"+o+"-"+w);I.push("text-"+o+"-"+w)}return 0!=I.length&&(this.prevSearchResult.query=i,this.prevSearchResult.textId.length>0&&this.prevSearchResult.textId.indexOf(I[0])<0&&(n==h.SEARCH_TYPE.PREV?this.prevSearchResult.textId=I.concat(this.prevSearchResult.textId):this.prevSearchResult.textId=this.prevSearchResult.textId.concat(I))),this.eventObserver.page.notify({pageNum:o,isScroll:!1}),this.prevSearchResult.textId[0]==this.prevSearchResult.highlight&&this.prevSearchResult.highlight==this.prevSearchResult.textId[this.prevSearchResult.textId.length-1]||(this.searchMoveBtnEnable("search-prev"),this.searchMoveBtnEnable("search-next")),[2]}}))}))},o.createTextLayerAndText=function(e){return r(o,void 0,void 0,(function(){var t,n;return a(this,(function(i){switch(i.label){case 0:return document.getElementById("annotationlayer"+e)?[3,2]:[4,this.removeTextDiv(e)];case 1:for(i.sent(),t=c.default.getAnnotLoadingRange(this.docInfo,e),n=t.startIdx;n<t.endIdx;n++)c.createAnnotationLayer(n,l.Util.isCellSkin(this.docInfo));i.label=2;case 2:return document.getElementById("textLayer"+e)?[3,4]:[4,this.textLayer.loadTextXml(e)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},o._updateCurrentTextHighlight=function(e,t){return r(o,void 0,void 0,(function(){var n,i,o,r,s,d;return a(this,(function(a){switch(a.label){case 0:for(n=c.default.parseTextId(this.prevSearchResult.highlight),s=0;s<e.length;s++)i=f.WordTextLayer.getTextId(n.pageNum,n.idx+s),o=document.getElementById(i),l.Util.removeClass(o,"text--current"),l.Util.addClass(o,"text--highlight");return r=c.default.parseTextId(t),[4,this.createTextLayerAndText(r.pageNum)];case 1:for(a.sent(),s=0;s<e.length;s++)d=f.WordTextLayer.getTextId(r.pageNum,r.idx+s),l.Util.addClass(document.getElementById(d),"text--current");return this.isSearchFocus&&(this.searchScroll(f.WordTextLayer.getTextId(r.pageNum,r.idx),r.pageNum),this.isSearchFocus=!1),null!=t&&(this.prevSearchResult.highlight=t),[2]}}))}))},o.moveSearchResult=function(e){return r(o,void 0,void 0,(function(){var t,n,i,o=this;return a(this,(function(r){switch(r.label){case 0:return e==h.SEARCH_TYPE.NONE||0==(t=this.searchInput.value.toLowerCase()).length?[2]:this.prevSearchResult.query==t?[3,2]:(this.loadSpinner(),[4,this.clearSearchResult()]);case 1:return r.sent(),setTimeout((function(){o.removeSpinner()}),200),[2];case 2:return n=this.getSearchIndex(t,e),i=n.pageIdx,n.result?[3,4]:-1===i?(this.searchMoveBtnDisable("search-prev",e),1!==this.prevSearchResult.textId.length&&this.searchMoveBtnEnable("search-next"),[2]):this.docInfo.status.pageNum===i?(this.searchMoveBtnDisable("search-next",e),1!==this.prevSearchResult.textId.length&&this.searchMoveBtnEnable("search-prev"),[2]):(this.loadSpinner(),[4,this.moveSearchText(t,i,e)]);case 3:return r.sent(),setTimeout((function(){o.removeSpinner()}),200),[3,5];case 4:this.isSearchFocus=!0,this._updateCurrentTextHighlight(t,n.updateIdx),this.docInfo.currentPage!=i&&this.eventObserver.page.notify({pageNum:i,isScroll:!0}),this.prevSearchResult.textId[0]==this.prevSearchResult.highlight&&this.prevSearchResult.highlight==this.prevSearchResult.textId[this.prevSearchResult.textId.length-1]||(this.searchMoveBtnEnable("search-prev"),this.searchMoveBtnEnable("search-next")),r.label=5;case 5:return[2]}}))}))},o.removeTextDiv=function(e){return r(o,void 0,void 0,(function(){var t,n,i;return a(this,(function(o){for(t=c.default.getAnnotLoadingRange(this.docInfo,e),n=0;n<this.docInfo.status.pageNum;n++)n>=t.startIdx&&n<t.endIdx||(i=document.getElementById("textLayer"+n))&&l.Util.removeElem(i);return[2]}))}))},o.search=function(e,t){return r(o,void 0,void 0,(function(){var n;return a(this,(function(i){return void 0===(n=d.TextLayer.getLocalStorageText(this.docInfo.jobId)[t])?[2,[]]:[2,p.kmp(Array.from(n),Array.from(e))]}))}))},o.focusSearchText=function(e,t,n,i){return void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=h.SEARCH_TYPE.NONE),r(o,void 0,void 0,(function(){var o,r,d,u,f,p,m,g,v,b,y,E;return a(this,(function(a){switch(a.label){case 0:return o=null!=t?t:e.target.value.toLowerCase(),r=null==n?this.docInfo.currentPage:n,d=this.docInfo.status.pageNum-1,u=[],f=!1,p=i!=h.SEARCH_TYPE.PREV,r<0||r>d?[2]:[4,this.search(o,r)];case 1:if(0==(u=a.sent()).length&&(f=!0),f&&0===this.prevSearchResult.textId.length)return l.Util.addClass(this.searchInput,"search__input--notfound"),this.searchInput.value=s.LocaleMessage.getMessage("empty-searchword"),this.searchInput.blur(),[2];for(m=[],g=0;g<u.length;g++){for(v=u[g],b=0;b<o.length;b++)y=document.getElementById("text-"+r+"-"+(v+b)),l.Util.containClassName(y,"text--highlight")||l.Util.addClass(y,"text--highlight");m.push("text-"+r+"-"+v)}return E=c.default.parseTextId(this.prevSearchResult.highlight).pageNum>r,0!=m.length&&(this.prevSearchResult.query=o,this.prevSearchResult.textId.length>0&&this.prevSearchResult.textId.indexOf(m[0])<0&&(this.prevSearchResult.textId=!p||E?m.concat(this.prevSearchResult.textId):this.prevSearchResult.textId.concat(m)),this._updateCurrentTextHighlight(o,this.prevSearchResult.highlight)),[2]}}))}))},o.newSearchText=function(e){return r(o,void 0,void 0,(function(){var t,n,i,o,r,f,p,m,g,v,b,y;return a(this,(function(a){switch(a.label){case 0:t=this.docInfo.currentPage,n=t,i=this.docInfo.status.pageNum-1,o=d.TextLayer.getLocalStorageText(this.docInfo.jobId),r=[],f=!1,p=!1,u.TextSearch.isSearching=!0,u.TextSearch.cachedSearchCount=0,this.disableMoveBtnDuringSearch(),a.label=1;case 1:return n>=0&&n<=i?u.TextSearch.isSearching?[4,this.search(e,n)]:[2]:[3,10];case 2:if(r=a.sent(),p&&0==r.length&&n<=0)return f=!0,[3,10];if(0==r.length&&n===i){if(0==t)return f=!0,[3,10];n=t,p=!0}return 0!=r.length?[3,8]:(p?n--:n++,o[n]?[3,5]:[4,c.default.getXml(this.docInfo,n,this.docInfo.dpi)]);case 3:return null==a.sent().result?[3,1]:[4,this.textLayer.setTextObjectAndLocalStorage(n,o)];case 4:return a.sent(),[3,7];case 5:return u.TextSearch.cachedSearchCount+=1,u.TextSearch.cachedSearchCount%100!=0?[3,7]:[4,l.Util.sleep(5)];case 6:a.sent(),a.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,1];case 10:if(this.enableMoveBtnAfterSearch(),u.TextSearch.isSearching=!1,f&&0===this.prevSearchResult.textId.length)return l.Util.addClass(this.searchInput,"search__input--notfound"),this.searchInput.value=s.LocaleMessage.getMessage("empty-searchword"),this.searchMoveBtnDisable("search-next",h.SEARCH_TYPE.NONE,!0),this.searchMoveBtnDisable("search-prev",h.SEARCH_TYPE.NONE,!0),this.searchInput.blur(),[2];for(this.searchMoveBtnEnable("search-next"),this.searchMoveBtnEnable("search-prev"),m=[],g=0;g<r.length;g++){for(v=r[g],b=0;b<e.length;b++)y=document.getElementById("text-"+n+"-"+(v+b)),l.Util.containClassName(y,"text--highlight")||(l.Util.addClass(y,"text--highlight"),0==g&&l.Util.addClass(y,"text--current")),0==g&&0==b&&(this.isSearchFocus=!0,this.prevSearchResult.highlight="text-"+n+"-"+v);m.push("text-"+n+"-"+v)}return 0!=m.length&&(this.prevSearchResult.query=e,this.prevSearchResult.textId=m),this.eventObserver.page.notify({pageNum:n,isScroll:!0}),[2]}}))}))},o.searchText=function(e){return r(o,void 0,void 0,(function(){var t,n,i,o=this;return a(this,(function(r){switch(r.label){case 0:return[4,this.textLayer.loadTextXml(e)];case 1:if(r.sent(),l.Util.isActiveSearch()&&""!=this.searchInput.value&&this.prevSearchResult.textId.length>0){for(t=!1,n=0;n<this.prevSearchResult.textId.length&&!(t=this.prevSearchResult.textId[n].indexOf("text"+e)>-1);n++);i=this.searchInput.value.toLowerCase(),t||(this.focusSearchText(null,i,e),setTimeout((function(){o.focusSearchText(null,i,e+1,h.SEARCH_TYPE.NEXT),o.focusSearchText(null,i,e-1,h.SEARCH_TYPE.PREV)}),20))}return setTimeout((function(){o.removeTextDiv(e)}),20),[2]}}))}))},o.textLayer=i,o.eventBind(),o}return o(t,e),t.prototype.clearSearchResult=function(){return r(this,void 0,void 0,(function(){var e,t,n,i,o=this;return a(this,(function(r){switch(r.label){case 0:if(e=this.searchInput.value.toLowerCase(),this.prevSearchResult.textId.length>0&&this.prevSearchResult.query!=e){for(t=document.getElementsByClassName("text--highlight"),n=t.length,i=0;i<n;i++)t[0].className="text";this.prevSearchResult={textId:[],query:"",highlight:""}}return 0==e.length?(this.searchMoveBtnDisable("search-next",h.SEARCH_TYPE.NONE,!0),this.searchMoveBtnDisable("search-prev",h.SEARCH_TYPE.NONE,!0),this.searchInput.blur(),[2]):this.prevSearchResult.query==e?[3,2]:(this.loadSpinner(),[4,this.newSearchText(e)]);case 1:return r.sent(),setTimeout((function(){o.removeSpinner()}),200),[3,3];case 2:this.moveSearchResult(h.SEARCH_TYPE.NEXT),r.label=3;case 3:return[2]}}))}))},t.prototype.searchScroll=function(e,t){m.annotScrollMove(e,t,!1),g.Browser.instance.isMobile&&this.searchInput.blur()},t.prototype.searchResultHide=function(){u.TextSearch.isSearching=!1;for(var e=document.getElementsByClassName("text--highlight"),t=e.length,n=0;n<t;n++)l.Util.addClass(e[n],"text--hide")},t.prototype.searchResultShow=function(){for(var e=document.getElementsByClassName("text--hide"),t=e.length,n=0;n<t;n++)l.Util.removeClass(e[0],"text--hide")},t.prototype.eventBind=function(){this.eventObserver.searchNext.subscribe(this.moveSearchResult),this.eventObserver.searchText.subscribe(this.searchText),this.eventObserver.searchDisplay.subscribe(this.searchDisplay)},t}(u.TextSearch);t.WordTextSearch=v}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=n(0),c=n(3),d=n(32),u=n(61),h=function(e){function t(){var t=e.call(this)||this;return t.getDimensionImg=function(e,n,i,o){return r(t,void 0,void 0,(function(){var t,r,s;return a(this,(function(a){switch(a.label){case 0:return n=void 0!==n?n:0,t=e.contextPath+"/dimension/"+e.status.id+"/"+n+"-"+i+"?dpi="+o,this.docInfo.status.imageConverting&&(t=e.contextPath+"/dimension/"+n+"-"+i+".js?dpi="+o),r=[],[4,l.Util.getJson(t)];case 1:return s=a.sent(),c.each(s,(function(e,t){var n={index:t.p,width:t.w,height:t.h};r[t.p]=n})),[2,r]}}))}))},t.retry=function(e){var n=parseInt(e.target.name),i=document.getElementById("thumb"+n);t.onLoadImg(i,n)},t.getDimensionHtml=function(e){return r(t,void 0,void 0,(function(){var t,n;return a(this,(function(i){switch(i.label){case 0:return t=e.resultPath+"/"+e.status.fileName+".xml",[4,l.Util.getXml(t)];case 1:return n=i.sent(),"image"===e.skinType?[2,l.Util.getDimensionHtmlForImage(n)]:[2,l.Util.getDimensionHtmlForPDF(n)]}}))}))},t.onLoadImg=function(e,n){e.className="thumb__img img-loading-small",e.removeEventListener("click",t.retry);var i=new Image;i.onerror=function(){e.src=t.transparentImg,e.className+=" img-retry",e.addEventListener("click",t.retry)},i.onload=function(){e.className="thumb__img"},l.Util.isConvHtml(t.docInfo)?i.src=""+l.Util.getResultPath(t.docInfo,t.THUMB_SIZE[n].path):i.src=""+l.Util.getThumbPath(t.docInfo,n,u.DPI.thumbDPI),e.src=i.src},t.createThumbDiv=function(e){return r(t,void 0,void 0,(function(){var t,n,i,o,r,d,h,f,p,m,g,v,b,y,E,I,S,w;return a(this,(function(a){switch(a.label){case 0:return t=114,n=72,i=null,l.Util.isConvHtml(this.docInfo)?[4,this.getDimensionHtml(e)]:[3,2];case 1:return i=a.sent(),[3,4];case 2:return[4,this.getDimensionImg(e,0,e.status.pageNum,u.DPI.thumbDPI)];case 3:i=a.sent(),a.label=4;case 4:for(o=Math.round(t/i[0].width*i[0].height),r=Math.round(n/i[0].width*i[0].height),d=this.jqThumbnail.height(),h=o,l.Util.isMobileMode()&&(h=r),this.initThumbNum=Math.ceil(d/h),f=document.createDocumentFragment(),p=0,m=i;p<m.length;p++)g=m[p],this.THUMB_SIZE[g.index]={width:g.width,height:g.height,desktopHeight:o,mobileHeight:r},(v=document.createElement("div")).id="thumb-content"+g.index,v.className="thumb",(b=document.createElement("span")).className="thumb__span",b.textContent=g.index+1,(y=document.createElement("div")).id="thumb-area"+g.index,y.className=s.Browser.instance.isMobile?"thumb-area thumb__div thumb--nohover":"thumb-area thumb__div",y.setAttribute("data-index",g.index),(E=document.createElement("img")).id="thumb"+g.index,E.name=""+g.index,E.title="page"+(g.index+1),E.src=this.transparentImg,E.className="thumb__img img-loading-small",E.alt="thumbnail "+g.index,y.addEventListener("click",this.thumbMovePage),this.isWindowCSS&&(E.style.setProperty("--page-width",g.width),E.style.setProperty("--page-height",g.height)),l.Util.isConvHtml(this.docInfo)&&(this.THUMB_SIZE[g.index].path=g.path),I=0,this.isWindowCSS||(this.THUMB_SIZE[0].width!==g.width||this.THUMB_SIZE[0].height!==g.height?(S=Math.round(t/g.width*g.height),w=Math.round(n/g.width*g.height),I=!0===l.Util.isMobileMode()?w:S,this.THUMB_SIZE[g.index].desktopHeight=S,this.THUMB_SIZE[g.index].mobileHeight=w):I=!0===l.Util.isMobileMode()?this.THUMB_SIZE[0].mobileHeight:this.THUMB_SIZE[0].desktopHeight),g.index<this.initThumbNum&&(this.thumbOnOffOption()&&this.onLoadImg(E,g.index),this.isWindowCSS||(E.style.cssText="height:"+I+"px;")),y.appendChild(E),v.appendChild(b),v.appendChild(y),f.appendChild(v);return c("#wrap__index").append(f),c("#thumb-area0").removeClass("thumb--nohover"),[2]}}))}))},t.thumbOnOffOption=function(){return l.Util.isMobileMode()?!(window.localSynap&&window.localSynap.config&&!1===window.localSynap.config.showThumbnailMobile):void 0!==window.localSynap&&window.localSynap.config.showThumbnail},t.eventBind=function(e){t.eventObserver=e,t.eventObserver.page.subscribe(t.focusPage),t.eventObserver.resizeWindow.subscribe(t.resizeWindow),t.eventObserver.fullScreen.subscribe(t.fullScreen),t.eventObserver.annotMode.subscribe(t.annotMode),t.scrollEventBind(),t.thumbnailDesktop.eventBind(t.eventObserver),t.thumbnailMobile.eventBind(t.eventObserver,t.docInfo),t.webThumbnailResize(),l.Util.bindClickEvent(document.getElementById("mobile-thumbnailbar"),t.toggleEvent),l.Util.bindClickEvent(document.getElementById("thumbnailview-btn"),t.toggleEvent)},t.loadThumbDelay=function(e){return r(t,void 0,void 0,(function(){return a(this,(function(e){return[2]}))}))},t.load=function(e,n){return r(t,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.docInfo=e,[4,this.createThumbDiv(this.docInfo)];case 1:return t.sent(),c("#thumb-area0").addClass("thumb__focus"),s.Browser.instance.isMobile&&(c("#web-thumbnailbar").addClass("thumbnailbar--touch-expand"),c("#mobile-thumbnailbar").addClass("thumbnailbar--touch-expand")),this.eventBind(n),l.Util.isMobileMode()?(this.thumbnailActions=this.thumbnailMobile,window.localSynap&&window.localSynap.config&&!1===window.localSynap.config.showThumbnailMobile?(d.Thumbnail.THUMB_STATUS=d.THUMB_FLAG.on,this.thumbnailActions.toggleAction()):(this.thumbnailActions.toggleAction(),this.setThumbnailAreaHeightForIOS())):(this.thumbnailActions=this.thumbnailDesktop,window.localSynap&&window.localSynap.config&&window.localSynap.config.showThumbnail&&this.thumbnailActions.toggleAction()),this.isWindowCSS||this.thumbSizeResize(this.initThumbNum,this.docInfo.status.pageNum,null),[2]}}))}))},t}return o(t,e),t}(d.Thumbnail);t.default=h}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=n(0),c=n(3),d=n(32),u=n(112),h=function(e){function t(){var n=e.call(this)||this;return n.getDimensionHtml=function(e){return r(n,void 0,void 0,(function(){var n,i,o;return a(this,(function(r){switch(r.label){case 0:return n=e.resultPath+"/"+e.status.fileName+".xml",i=[],[4,l.Util.getXml(n)];case 1:return o=r.sent(),t.SLIDE_INFO.start=parseInt(o.index.startPage),t.SLIDE_INFO.end=parseInt(o.index.endPage),t.SLIDE_INFO.total=parseInt(o.index.slide_cnt),1===t.SLIDE_INFO.total?(i[0]=[],i[0].index=parseInt(o.index.slide_list.slide.id)-1,i[0].path=o.index.slide_list.slide.path_xhtml,i[0].width=o.index.width,i[0].height=o.index.height,[2,i]):(c.each(o.index.slide_list.slide,(function(e,t){var n={index:parseInt(t.id)-1,path:t.path_xhtml,width:o.index.width,height:o.index.height};i[e]=n})),[2,i])}}))}))},n.onLoadImg=function(e,t){e.className="thumb__img img-loading-small",e.src=""+l.Util.getResultPath(n.docInfo,n.THUMB_SIZE[t].path)},n.slideRenderingSize=function(e,t,i,o){return r(n,void 0,void 0,(function(){var n,r,l,c;return a(this,(function(a){return n=Math.round(o/t*i),l=-2*t*(1-(r=o/(2*t)))/2,c=-2*i*(1-r)/2,s.Browser.instance.isIE9Lower()?e.style.cssText+="width:"+o+"px;height:"+n+"px;":e.style.cssText+="width:"+2*t+"px;height:"+2*i+"px;\n\t\t\ttransform:scale("+r+","+r+");left:"+l+"px;top:"+c+"px;",[2]}))}))},n.createThumbDiv=function(e){return r(n,void 0,void 0,(function(){var t,n,i,o,r,l,d,u,h,f,p,m,g,v;return a(this,(function(a){switch(a.label){case 0:return t=114,n=72,[4,this.getDimensionHtml(e)];case 1:for(i=a.sent(),o=Math.round(t/i[0].width*i[0].height),r=Math.round(n/i[0].width*i[0].height),this.THUMB_SIZE[0]={width:i[0].width,height:i[0].height,desktopHeight:o,mobileHeight:r},l=document.createDocumentFragment(),d=0,u=i;d<u.length;d++)h=u[d],(f=document.createElement("div")).id="thumb-content"+h.index,f.className="thumb",f.onclick=this.thumbMovePage,(p=document.createElement("span")).className="thumb__span",p.textContent=h.index+1,(m=document.createElement("div")).id="thumb-area"+h.index,m.className=s.Browser.instance.isMobile?"thumb-area thumb-slide thumb__div img-loading-small thumb--nohover":"thumb-area thumb-slide thumb__div img-loading-small thumb-area-slide",m.style.cssText="width:"+t+"px;height:"+o+"px;",(g=document.createElement("iframe")).id="thumb"+h.index,g.name=""+h.index,g.title="page"+(h.index+1),g.scrolling="no",g.frameBorder="no",(v=document.createElement("div")).className="thumb-slide-alpha",v.style.cssText="width:"+t+"px;height:"+o+"px;",v.onclick=this.thumbMovePage,v.setAttribute("data-index",h.index),this.THUMB_SIZE[h.index]={path:h.path},this.slideRenderingSize(g,h.width,h.height,t),h.index<this.initThumbNum&&this.onLoadImg(g,h.index),m.appendChild(g),m.appendChild(v),f.appendChild(p),f.appendChild(m),l.appendChild(f);return c("#wrap__index").append(l),c("#thumb-area0").removeClass("thumb--nohover"),[2]}}))}))},n.eventBind=function(e){n.eventObserver=e,n.eventObserver.page.subscribe(n.focusPage),n.eventObserver.resizeWindow.subscribe(n.resizeWindow),n.eventObserver.fullScreen.subscribe(n.fullScreen),n.scrollEventBind(),n.thumbnailDesktop.eventBind(n.eventObserver),n.thumbnailMobile.eventBind(n.eventObserver,n.docInfo),n.webThumbnailResize(),l.Util.bindClickEvent(document.getElementById("mobile-thumbnailbar"),n.toggleEvent),l.Util.bindClickEvent(document.getElementById("thumbnailview-btn"),n.toggleEvent)},n._loadThumbnail=function(){return r(n,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.createThumbDiv(this.docInfo)];case 1:return e.sent(),c("#thumb-area0").addClass("thumb__focus"),s.Browser.instance.isMobile&&(c("#web-thumbnailbar").addClass("thumbnailbar--touch-expand"),c("#mobile-thumbnailbar").addClass("thumbnailbar--touch-expand")),l.Util.isMobileMode()?(this.thumbnailActions=this.thumbnailMobile,window.localSynap&&window.localSynap.config&&!1===window.localSynap.config.showThumbnailMobile?(d.Thumbnail.THUMB_STATUS=d.THUMB_FLAG.on,this.thumbnailActions.toggleAction()):(this.thumbnailActions.toggleAction(),this.setThumbnailAreaHeightForIOS())):(this.thumbnailActions=this.thumbnailDesktop,window.localSynap&&window.localSynap.config&&window.localSynap.config.showThumbnail&&this.thumbnailActions.toggleAction()),this.isWindowCSS||this.thumbSizeResize(this.initThumbNum,this.docInfo.status.pageNum,null),[2]}}))}))},n.loadThumbDelay=function(e){return r(n,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return e%5!=0?[3,2]:[4,l.Util.sleep(100)];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},n.load=function(e,t){return r(n,void 0,void 0,(function(){var n=this;return a(this,(function(i){return this.docInfo=e,c(".wrap__thumbnail").addClass("wrap__thumbnail-slide"),this.eventBind(t),this.loadSpinner(),setTimeout((function(){n._loadThumbnail(),n.removeSpinner()}),500),[2]}))}))},n.loadSpinner=function(){if(!(l.Util.isMobileMode()||c(".loading_spinner").length>0)){var e=document.createElement("div");e.setAttribute("class","inner loading_spinner "),document.getElementById("contents-area").appendChild(e),new u({lines:11,length:0,width:12,radius:30,scale:1.25,corners:.5,color:"#435c85",opacity:.25,rotate:0,direction:1,speed:1,trail:65,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"}).spin(e)}},n.removeSpinner=function(){l.Util.isMobileMode()||setTimeout((function(){c(".loading_spinner").remove()}),50)},n.initThumbNum=10,n}return o(t,e),t.SLIDE_INFO={start:0,end:0,total:0},t}(d.Thumbnail);t.default=h}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlSheet=void 0;var s=n(1),l=n(0),c=n(38),d=n(3),u=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.sheetIdList=[],n.getSheet=function(e){return n.docInfo.status.sheetList[e]},n.getTitle=function(t,i,o){return r(n,void 0,e,(function(){return a(this,(function(e){return[2,this.getSheet(o).title]}))}))},n.loadSheet=function(t){return r(n,void 0,e,(function(){var e;return a(this,(function(n){return this.docInfo.currentSheet=t,e=l.Util.getResultPath(this.docInfo,this.getSheet(t).path),d(".wrap__innerWrap").get(0).setAttribute("src",e),this.checkMoveControlbar(),d("#innerWrap").trigger("focus"),[2]}))}))},n.bindControlbarEvent=function(){l.Util.bindClickOrTouchEvent(d("#cell-first"),"controlbar-first--hover",(function(){n.eventObserver.sheet.notify({sheetIdx:0})})),l.Util.bindClickOrTouchEvent(d("#cell-end"),"controlbar-end--hover",(function(){n.eventObserver.sheet.notify({sheetIdx:n.maxPage-1})})),l.Util.bindClickOrTouchEvent(d("#cell-prev"),"controlbar-prev--hover",(function(){n.eventObserver.sheet.notify({sheetIdx:n.docInfo.currentSheet-1})})),l.Util.bindClickOrTouchEvent(d("#cell-next"),"controlbar-next--hover",(function(){n.eventObserver.sheet.notify({sheetIdx:n.docInfo.currentSheet+1})}))},n.resizeWindow=function(){d("#contents").removeAttr("style"),l.Util.isMobileMode()&&(d("#tablist-popup").hide(),l.Util.isFullScreen()||n.eventObserver.mobileHeader.notify(c.ShowActionType.HIDE3SEC)),l.Util.isFullScreen()||l.Util.isFullScreen()||n.sheetTabResize()},n.iframeEventBind=function(){d("#contents-area").on("click",(function(){s.Browser.instance.isMobile||n.toggleMobileHeader()})),d("#innerWrap").on("load",(function(){var e=document.getElementById("contents-area"),t=document.getElementById("innerWrap");t.contentDocument.addEventListener("mousemove",l.Util.getMouseHandlerDispatch(e)),t.contentDocument.addEventListener("click",l.Util.getMouseHandlerDispatch(e)),t.contentDocument.addEventListener("touchstart",l.Util.getTouchHandlerDispatch(e)),t.contentDocument.addEventListener("touchmove",l.Util.getTouchHandlerDispatch(e)),t.contentDocument.addEventListener("touchend",l.Util.getTouchHandlerDispatch(e)),d(this).contents().on("keydown keyup",(function(e){d("#contents-area").trigger(e)}))}))},n.singleTap=function(){n.toggleMobileHeader()},n.iosSheetTabEventBind=function(){s.Browser.instance.isIOS&&d("#header-tablist__input, #cell-select-arrow").on("click",(function(){var e=document.createElement("div");e.id="dimmed",e.style.width="100%",e.style.height="100%",e.style.position="fixed",e.style.zIndex="30",e.addEventListener("click",(function(){document.getElementById("dimmed").remove()})),document.getElementById("header-tablist__select").addEventListener("change",(function(){document.getElementById("dimmed").remove()})),document.getElementsByTagName("body")[0].appendChild(e)}))},n.syncSheetTab=function(){var e=n.docInfo,t=n.sheetIdList,i=n.checkMoveControlbar,o=n.sheetTabActive;d("#innerWrap").on("load",(function(){var n=e.status.sheetList;"number"==typeof this.contentWindow.sheetIndex&&n[e.currentSheet].id!==this.contentWindow.sheetIndex&&(e.currentSheet=t[this.contentWindow.sheetIndex],i(),o(e.currentSheet))}))},n.eventObserverBind=function(e){n.eventObserver=e,n.eventObserver.sheet.subscribe(n.moveSheet),n.eventObserver.resizeWindow.subscribe(n.resizeWindow),n.eventObserver.fullScreen.subscribe(n.fullScreen),n.eventObserver.singleTap.subscribe(n.singleTap)},n.eventBind=function(){n.iframeEventBind(),n.iosSheetTabEventBind(),n.syncSheetTab()},n.getDimensionHtml=function(){return r(n,void 0,void 0,(function(){var e,t,n,i,o=this;return a(this,(function(r){switch(r.label){case 0:return e=this.docInfo.resultPath+"/"+this.docInfo.status.fileName+".xml",t=[],[4,l.Util.getXml(e)];case 1:return n=r.sent(),1===parseInt(n.index.sheet_cnt)?(t[0]={id:parseInt(n.index.sheet_list.sheet.id),title:n.index.sheet_list.sheet.title,path:n.index.sheet_list.sheet.path_xhtml},this.sheetIdList[t[0].id]=0):(i=0,d.each(n.index.sheet_list.sheet,(function(e,n){if(n.title){var r={id:parseInt(n.id),title:n.title,path:n.path_xhtml};t[i]=r,o.sheetIdList[r.id]=i,i++}}))),[2,t]}}))}))},n.setTabIndex=function(){var e=l.Util.setTabIndexList(),t=document.getElementById("tabmore").tabIndex,i=document.getElementById("header-tablist__input").tabIndex;l.Util.setTabIndex(document.getElementById("innerWrap"),e++);for(var o=0;o<n.maxPage;o++)l.Util.setTabIndex(document.getElementById("tablist"+o),t+1),l.Util.setTabIndex(document.getElementById("mobileTablist"+o),i),l.Util.setTabIndex(document.getElementById("sheet"+o),e)},n.load=function(t,i){return r(n,void 0,e,(function(){var e,n,o;return a(this,(function(r){switch(r.label){case 0:return this.docInfo=t,e=this.docInfo.status,n="sheetList",[4,this.getDimensionHtml()];case 1:return e[n]=r.sent(),this.maxPage=this.docInfo.status.pageNum=this.docInfo.status.sheetList.length,d("#wrap").addClass("wrap--cell"),s.Browser.instance.isIOS&&(d("#wrap").addClass("wrap--ios"),d("#container").addClass("wrap__container--ios"),d("#contents").addClass("wrap__contents--ios"),d("#footer").addClass("wrap__footer--ios")),d("#header-title-text").addClass("wrap__title--cell"),d("#contents-area").addClass("wrap__contents-area"),this.bindControlbarEvent(),this.eventObserverBind(i),o=this.createIframe(),document.getElementById("contents-area").appendChild(o),[4,this.loadSheetTab(this.docInfo.currentSheet)];case 2:return r.sent(),[4,this.loadSheet(this.docInfo.currentSheet)];case 3:return r.sent(),this.setTabIndex(),this.eventBind(),[2]}}))}))},n.createIframe=function(){var e=document.createElement("iframe");return e.id="innerWrap",e.className="wrap__innerWrap",e.title="content",e.style.backgroundColor="#ffffff",e},n}return o(n,t),n}(n(163).Sheet);t.HtmlSheet=u}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WindowEvent=void 0;var i=n(0),o=n(3),r=n(1),a=function(){var e=this;this.eventObserver=null,this.docInfo=null,this.eventBind=function(t){if(e.eventObserver=t,r.Browser.instance.isIOS){var n;o(window).on("orientationchange",(function(){clearTimeout(n),n=setTimeout((function(){e.eventObserver.resizeWindow.notify()}),100)}))}else{var i;o(window).on("resize",(function(){clearTimeout(i),i=setTimeout(a,100)}));var a=function(){e.eventObserver.resizeWindow.notify()}}},this.preventCopy=function(){o(document.body).on("contextmenu",(function(){return!1}))},this.preventDragSelect=function(){o(document.body).on("dragstart",(function(){return!1})),o(document.body).on("selectstart",(function(t){return!("page__input"!==t.target.id&&"urlArea"!==t.target.id&&"search__input"!==t.target.id&&"annotation-memo__content"!==t.target.id&&"annotation-memo__author-input"!==t.target.id&&"download-input"!==t.target.id&&"annotation-list__search__input"!==t.target.id&&!i.Util.containClassName(t.target,"annot-page-li-info-authorInput")&&(!i.Util.isUseSearch(e.docInfo)&&!i.Util.isUseAnnotation(e.docInfo)||"text"!==t.target.className))}))},this.copyPlainText=function(){document.addEventListener("copy",(function(e){if(void 0!==window.getSelection&&-1!=e.target.parentElement.className.indexOf("textLayer")){var t=window.getSelection().getRangeAt(0).toString();e.clipboardData.setData("text/plain",t),e.preventDefault()}}))},this.load=function(e,t){this.docInfo=e,this.eventBind(t),i.Util.allowCopy()?(this.copyPlainText(),this.preventDragSelect()):(this.preventDragSelect(),this.preventCopy())}};t.WindowEvent=a},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Word=void 0;var r=n(1),a=n(0),s=n(38),l=n(3),c=function(){var e=this;this.docInfo=null,this.eventObserver=null,this.createIframe=function(){var t=document.createElement("iframe");t.id="innerWrap",t.className="wrap__innerWrap",t.title="content";var n=a.Util.useSingle(e.docInfo)&&"xmldart"!==e.docInfo.fileType?e.docInfo.status.fileName+".xhtml":e.docInfo.status.fileName+".view.xhtml";return t.src=a.Util.getResultPath(e.docInfo,n),t},this.load=function(t,n){e.docInfo=t,r.Browser.instance.isIOS&&(l("#wrap").addClass("wrap--ios"),l("#container").addClass("wrap__container--ios"),l("#contents").addClass("wrap__contents--ios"));var i=e.createIframe();document.getElementById("contents-area").appendChild(i),e.setTabIndex(),e.eventBind(n)},this.eventBind=function(t){e.eventObserver=t,e.eventObserver.fullScreen.subscribe(e.fullScreen),e.eventObserver.singleTap.subscribe(e.singleTap),e.iframeEventBind()},this.toggleMobileHeader=function(){a.Util.isMobileMode()&&!a.Util.isFullScreen()&&("none"===l(".wrap__header").css("display")?e.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE3SEC):e.eventObserver.mobileHeader.notify(s.ShowActionType.HIDE))},this.iframeEventBind=function(){l("#contents-area").on("click",(function(){r.Browser.instance.isMobile||e.toggleMobileHeader()})),l("#innerWrap").on("load",(function(){var e=document.getElementById("contents-area"),t=document.getElementById("innerWrap");t.contentDocument.addEventListener("touchstart",a.Util.getTouchHandlerDispatch(e)),t.contentDocument.addEventListener("touchmove",a.Util.getTouchHandlerDispatch(e)),t.contentDocument.addEventListener("touchend",a.Util.getTouchHandlerDispatch(e)),t.contentDocument.addEventListener("click",a.Util.getMouseHandlerDispatch(e)),l(this).contents().on("keydown keyup",(function(e){l("#contents-area").trigger(e)}))})),l("#innerWrap").trigger("focus")},this.fullScreen=function(t){return i(e,void 0,void 0,(function(){return o(this,(function(e){return t.isFullScreen?(l("#contents").addClass("wrap__contents--page-fullscreen"),l(".wrap__innerWrap").addClass("wrap__contents--page-fullscreen"),l("#container").addClass("wrap__container--presentation"),t.isSupport||l(".wrap__header").addClass("wrap__header--presentation")):(l("#contents").removeClass("wrap__contents--page-fullscreen"),l(".wrap__innerWrap").removeClass("wrap__contents--page-fullscreen"),l("#container").removeClass("wrap__container--presentation"),t.isSupport||l(".wrap__header").removeClass("wrap__header--presentation")),[2]}))}))},this.singleTap=function(){e.toggleMobileHeader()},this.setTabIndex=function(){var e=a.Util.setTabIndexList();a.Util.setTabIndex(document.getElementById("innerWrap"),e)}};t.Word=c}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlidePageScrollFit=void 0;var i=n(3),o=n(0),r=n(113),a=n(1),s=function(){var e=this;this.noneRotateSize=[0,0],this.scrollContentAreaEl=a.Browser.instance.isIOS?i(document):i("#contents"),this.resizePage=function(t,n,s,l){void 0===s&&(s=0),void 0===l&&(l=0);var c=i("#page-area0").height(),d=e.scrollContentAreaEl.scrollTop(),u=i(".contents-page").length,h=0===l||l>u?u:s+l,f=0;f=a.Browser.instance.isIOS&&o.Util.isFullScreen()?window.innerHeight:document.getElementById("contents").offsetHeight;var p=i("#contents").width();e.noneRotateSize=[p,f];for(var m=s;m<h;++m){var g=e.getResizeResult(!1,r.Slide.ORIGIN_SIZE[m].width,r.Slide.ORIGIN_SIZE[m].height),v=g[0],b=g[1];if(o.Util.isFullScreen()){var y=0;y=(f-b)/2,i("#page"+m).css({"margin-top":y,"margin-bottom":y}),i("#page-alpha"+m).css({"margin-top":y,"margin-bottom":y})}else i("#page-alpha"+m).css({"margin-top":0,"margin-bottom":0});i("#page"+m).css({width:1*v,height:1*b}),i("#page-alpha"+m).css({width:1*v,height:1*b}),r.Slide.CURRENT_SIZE[m]={width:1*v,height:1*b}}e.setPageMargin(1),!a.Browser.instance.isIOS&&e.scrollContentAreaEl.scrollTop(d*(i("#page-area0").height()/c))},this._getRatio=function(t,n){var i=e.noneRotateSize,o=i[0],r=i[1],a=o/t,s=r/n;return r<o&&t*s<o||r>o&&n*a>r?s:a},this.getResizeResult=function(t,n,i,o){void 0===o&&(o=null);var r=e._getRatio(n,i);return[n*r,i*r]},this.setPageMargin=function(e){var t=i("#page-area0").height()/r.Slide.ORIGIN_SIZE[0].height*e;i(".contents-page").css("margin-top",r.Slide.ORIGIN_MARGIN.marginTop*t),i(".contents-page").css("margin-bottom",r.Slide.ORIGIN_MARGIN.marginBottom*t),i(".thumb-slide-alpha").css("left",i("#page0").offset().left)}};t.SlidePageScrollFit=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlidePageFit=void 0;var i=n(3),o=n(0),r=n(113),a=n(1),s=function(){var e=this;this.noneRotateSize=[0,0],this.scrollContentAreaEl=a.Browser.instance.isIOS?i(document):i("#contents"),this.resizePage=function(t,n,s,l){void 0===s&&(s=0),void 0===l&&(l=0),i("#contents").css("overflow","hidden"),i("#contents-area").css("overflow","hidden");var c=0;c=a.Browser.instance.isIOS&&o.Util.isFullScreen()?window.innerHeight:document.getElementById("contents").offsetHeight;var d=i("#contents").width();e.noneRotateSize=[d,c];var u=s,h=r.Slide.ORIGIN_SIZE[u].width,f=r.Slide.ORIGIN_SIZE[u].height,p=e._getRatio(h,f);i("#contents-area").css({width:d,height:c}),i("#page"+u).css({width:2*h,height:2*f}),r.Slide.CURRENT_SIZE[u]={width:1*h,height:1*f},i("#page"+u).css("transform","scale("+p/2+")").css("margin-left",h*(p-2)/2+(d-h*p)/2+"px").css("margin-top",f*(p-2)/2+(c-f*p)/2+"px"),e.setPageMargin(1)},this._getRatio=function(t,n){var i=e.noneRotateSize,o=i[0],r=i[1],a=.95*o/t;return r/o<n/t&&(a=.95*r/n),a},this.getResizeResult=function(t,n,i,o){void 0===o&&(o=null);var r=e._getRatio(n,i);return[n*r,i*r]},this.setPageMargin=function(e){i(".contents-page").css("margin-top",0),i(".contents-page").css("margin-bottom",0)}};t.SlidePageFit=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZipTree=void 0;var i=n(170),o=function(e,t){var n=this;this.arrangeIntoTree=function(e){for(var t=[],o=function(e){for(var o=e.pathArr,r=[],a=t,s=function(t){var s=o[t],l=n.findWhere(a,"fileName",s);if(l)a=l.children,r=l;else{var c=void 0;c=t===o.length-1?{filePath:e.filePath,fileName:s,fileType:e.fileType,fileSize:e.fileSize,directory:e.directory,parent:r,children:[],childSort:{sortingField:i.SORTING_FIELD.NULL,sortingStatus:i.SORTING_STATUS.NULL}}:{filePath:function(){for(var e="",n=0;n<=t;n++)e+=o[n]+"/";return e}(),fileName:s,fileType:null,fileSize:0,directory:!0,parent:r,children:[],childSort:{sortingField:i.SORTING_FIELD.NULL,sortingStatus:i.SORTING_STATUS.NULL}},a.push(c),r=c,a=c.children}},l=0;l<o.length;l++)s(l)},r=0,a=e;r<a.length;r++)o(a[r]);return t},this.findWhere=function(e,t,n){for(var i=0;i<e.length&&e[i][t]!==n;)i++;return i<e.length&&e[i]},this.getZipTree=function(){return n.zipTree};for(var o=[],r=0;r<e.length;r++){var a=e[r].fileName.replace(/^\/|\/$/g,"").split("/");o[r]={pathArr:a,filePath:e[r].fileName,fileType:e[r].directory||null===e[r].fileType?null:e[r].fileType.toLowerCase(),fileSize:e[r].fileSize,directory:e[r].directory}}for(var s={filePath:"/",fileName:t,fileType:"",fileSize:0,directory:!0,parent:null,children:this.arrangeIntoTree(o),childSort:{sortingField:i.SORTING_FIELD.NULL,sortingStatus:i.SORTING_STATUS.NULL}},l=0,c=s.children;l<c.length;l++)c[l].parent=s;this.zipTree=s};t.ZipTree=o},,function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.MobileControlbar=void 0;var r=n(309),a=n(0),s=n(1),l=n(19),c=function(){var t=this;this.eventObserver=null,this.controlbar=document.getElementById("mobile-controlbar"),this.controlbarShow=document.getElementById("mobile-controlbar-show"),this.controlbarMore=document.getElementById("mobile-controlbar-more"),this.hideClass="mobile-controlbar--hide",this.mobileControlbarShowSize={width:65,height:65},this.mobileControlbarMoreSize={width:65,height:65},this.fullScreen=function(e){e.isFullScreen?a.Util.addClass(t.controlbar,t.hideClass):a.Util.removeClass(t.controlbar,t.hideClass)},this.startViewportScroll=function(){a.Util.isFullScreen()||a.Util.addClass(t.controlbar,t.hideClass)},this.endViewportScroll=function(){t.scaleControlbarPostion(),a.Util.isFullScreen()||a.Util.removeClass(t.controlbar,t.hideClass)},this.scaleControlbarPostion=function(){l.ScaleEvent.scaleWithPosition(t.controlbarShow,l.TransformOriginType.RIGHT_BOTTOM,t.mobileControlbarShowSize.width*l.ScaleEvent.getBrowserScale(),t.mobileControlbarShowSize.height*l.ScaleEvent.getBrowserScale()),l.ScaleEvent.scaleWithPosition(t.controlbarMore,l.TransformOriginType.RIGHT_BOTTOM,t.mobileControlbarMoreSize.width*l.ScaleEvent.getBrowserScale(),t.mobileControlbarMoreSize.height*l.ScaleEvent.getBrowserScale())},this.eventObserverBind=function(e){t.eventObserver=e,t.eventObserver.fullScreen.subscribe(t.fullScreen),t.eventObserver.resizeWindow.subscribe(t.scaleControlbarPostion),s.Browser.instance.isSupportVisualViewport()&&(t.eventObserver.startViewportScroll.subscribe(t.startViewportScroll),t.eventObserver.endViewportScroll.subscribe(t.endViewportScroll))},this.load=function(n,l){return i(t,void 0,e,(function(){return o(this,(function(e){return new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-show__btn"),r.FloatingType.SHOW),new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-hide__btn"),r.FloatingType.HIDE),new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-next__btn"),r.FloatingType.NEXT),new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-prev__btn"),r.FloatingType.PREV),new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-zoomin__btn"),r.FloatingType.ZOOMIN),new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-zoomout__btn"),r.FloatingType.ZOOMOUT),s.Browser.instance.isMobile||(a.Util.removeClass(document.getElementById("mobile-controlbar-floating__scroll"),"hide"),new r.FloatingBtn(n,l,document.getElementById("mobile-controlbar-hand-scroll__btn"),r.FloatingType.SCROLL)),this.scaleControlbarPostion(),this.eventObserverBind(l),[2]}))}))},a.Util.removeClass(this.controlbar,this.hideClass);var n=window.getComputedStyle(this.controlbarShow),c=parseInt(n.getPropertyValue("margin-right")),d=c||20;this.mobileControlbarShowSize.width+=d,this.mobileControlbarMoreSize.width+=d;var u=parseInt(n.getPropertyValue("margin-bottom")),h=u||20;this.mobileControlbarShowSize.height+=h,this.mobileControlbarMoreSize.height+=h};t.MobileControlbar=c}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.FloatingBtn=t.FloatingType=void 0;var r,a=n(0),s=n(80),l=n(6),c=n(81);function d(){var e="mobile-controlbar-floating--hide";a.Util.removeClass(document.getElementById("mobile-controlbar-more"),e),a.Util.addClass(document.getElementById("mobile-controlbar-show"),e)}function u(){var e="mobile-controlbar-floating--hide";a.Util.removeClass(document.getElementById("mobile-controlbar-show"),e),a.Util.addClass(document.getElementById("mobile-controlbar-more"),e)}function h(e,t,n){!e.disabled&&t.page.notify({pageNum:n,isScroll:!1})}function f(e,t,n){!e.disabled&&t.sheet.notify({sheetIdx:n})}function p(t,n,r){return i(this,void 0,e,(function(){return o(this,(function(e){switch(e.label){case 0:return t.disabled?[3,3]:l.default.isDrawingMode?[4,n.saveAnnotation.notify()]:[3,2];case 1:e.sent(),e.label=2;case 2:n.zoom.notify(r),e.label=3;case 3:return[2]}}))}))}!function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE",e[e.NEXT=2]="NEXT",e[e.PREV=3]="PREV",e[e.ZOOMIN=4]="ZOOMIN",e[e.ZOOMOUT=5]="ZOOMOUT",e[e.SCROLL=6]="SCROLL"}(r=t.FloatingType||(t.FloatingType={}));var m=function(e,t,n,i){var o=this;this.docInfo=null,this.eventObserver=null,this.target=null,this.handleClick=null,this.docInfo=e,this.eventObserver=t,this.target=n,this.handleClick=function(){switch(i){case r.SHOW:return d;case r.HIDE:return u;case r.NEXT:return function(){a.Util.isCellSkin(o.docInfo)?f(o.target,o.eventObserver,o.docInfo.currentSheet+1):h(o.target,o.eventObserver,o.docInfo.currentPage+1)};case r.PREV:return function(){a.Util.isCellSkin(o.docInfo)?f(o.target,o.eventObserver,o.docInfo.currentSheet-1):h(o.target,o.eventObserver,o.docInfo.currentPage-1)};case r.ZOOMIN:return function(e){e.preventDefault(),p(o.target,o.eventObserver,s.ZOOM_TYPE.ZoomIn)};case r.ZOOMOUT:return function(e){e.preventDefault(),p(o.target,o.eventObserver,s.ZOOM_TYPE.ZoomOut)};case r.SCROLL:return c.MouseScroll.instance.bindMobileControlbar({elem:n,selector:"mobile-controlbar-floating__btn--hover"});default:return null}}(),this.handleClick&&this.target.addEventListener("click",this.handleClick)};t.FloatingBtn=m}).call(this,n(4))},function(e,t,n){"use strict";(function(e){var n=this&&this.__awaiter||function(t,n,i,o){return new(i||(i=e))((function(e,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},i=this&&this.__generator||function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var o=function(){function e(){this.observers=[]}return e.prototype.subscribe=function(e){this.observers.push(e)},e.prototype.unsubscribe=function(e){this.observers=this.observers.filter((function(t){return t!==e}))},e.prototype.notify=function(e){return void 0===e&&(e=void 0),n(this,void 0,void 0,(function(){var t,n;return i(this,(function(i){switch(i.label){case 0:t=0,n=this.observers,i.label=1;case 1:return t<n.length?[4,(0,n[t])(e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e}();t.Observable=o}).call(this,n(4))},,function(e,t){},,,,,,,,,,,,,,,function(e,t){},,,,function(e,t){},,function(e,t){},,function(e,t){}]);