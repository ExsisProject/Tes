define("components/active-scroll/active-scroll",function(require){return Backbone.View.extend({events:{},initialize:function(e){this.options=e||{},this.scrollEl=this.options.scrollEl||this.$el,this.activeClass=this.options.activeClass||"active",this.menuArray=this.options.menuArray||{},this.first=this.options.first||"",this.last=this.options.last||"",this._setBenchmark(),this._setRecognizer(),this._bindChangeMenuIndex()},bind:function(){this._bindScrollEvent(),this._bindClickEvent()},unbind:function(){this.scrollEl.off("scroll"),$(".menu_scroll_group").off("click")},setScrollEl:function(e){this.scrollEl=e,this._setBenchmark()},setMenuElArray:function(e){this.menuArray=e,this._setBenchmark()},menuActiveChange:function(e){$(".menu_scroll_group").removeClass(this.activeClass),$("#"+e).addClass(this.activeClass)},_setBenchmark:function(){this.diffHeight=this.scrollEl.offset().top-$("#"+this._getAnyKey(this.menuArray)).offsetParent().offset().top,this.benchmark=this.scrollEl.height()*.5+this.diffHeight},_setRecognizer:function(){for(var e in this.menuArray)$("#"+this.menuArray[e]).addClass("menu_scroll_group")},_bindChangeMenuIndex:function(){this.menuIndex={},this._indexInit();var e=this;Object.defineProperty(this.menuIndex,"key",{get:function(){return this._key||0},set:function(t){if(this._key==t)return;this._key=t,e.menuActiveChange(t)}})},_indexInit:function(){this.first&&this.scrollEl.scrollTop===0&&this.menuActiveChange(this.menuArray[this.first]),this.last&&this.scrollEl.scrollTop()+this.scrollEl.innerHeight()>=this.scrollEl.prop("scrollHeight")&&this.menuActiveChange(this.menuArray[this.last]);for(var e in this.menuArray)this.benchmark>$("#"+e).position().top&&this.benchmark<$("#"+e).position().top+$("#"+e).height()&&this.menuActiveChange(this.menuArray[e])},_bindScrollEvent:function(){var e=this;this.scrollEl.on("scroll",function(t){if(e.first&&e.scrollEl.scrollTop===0){e.menuIndex.key=e.menuArray[e.first];return}if(e.last&&e.scrollEl.scrollTop()+e.scrollEl.innerHeight()>=e.scrollEl.prop("scrollHeight")){e.menuIndex.key=e.menuArray[e.last];return}for(var n in e.menuArray)if(e.benchmark>$("#"+n).position().top&&e.benchmark<$("#"+n).position().top+$("#"+n).height()){e.menuIndex.key=e.menuArray[n];return}})},_bindClickEvent:function(){var e=this;$(".menu_scroll_group").click(function(t){var n=$(t.currentTarget).attr("id");for(var r in e.menuArray)if(e.menuArray[r]==n){e.scrollEl.animate({scrollTop:"+="+($("#"+r).position().top-e.diffHeight)},200);break}})},_getAnyKey:function(e){for(var t in e)return t}})});