define("components/go-fileuploader/main",["jquery","underscore","app","i18n!nls/commons","browser","jquery.progressbar","jquery.fileupload"],function(e,t,n,r,i){function s(s,o){o=o||{};var u=e('<input class="go-fileupload" type="file" name="file" title="'+r["\ud30c\uc77c\uc120\ud0dd"]+'" alt="'+r["\ud30c\uc77c\uc120\ud0dd"]+'" style="cursor:pointer">'),a={"font-size":0,position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",opacity:0},f={};f=t.extend({},{url:s.data("url")||n.config("contextRoot")+"api/file",attachType:""+s.data("attachtype")||"file",success:function(){},error:function(){}},o||{}),i.msie&&i.version<11&&t.extend(a,{"font-size":"999px"}),u.css(a),f.isWorks?s.css({overflow:"hidden"}).append(u):s.css({position:"relative",overflow:"hidden"}).append(u);var l=0,c=0,h=this;this.progressEl=f.progressEl?e(f.progressEl):e("div.progress"),this.progressBarOpt={boxImage:n.config("contextRoot")+"resources/images/progressbar.gif",barImage:n.config("contextRoot")+"resources/images/progressbg_green_100.gif",width:200,max:100},this.progressEl.hide(),this.progressEl.progressBar(0,this.progressBarOpt),this.progressEl.find("span:first").css("vertical-align","top"),this.progressEl.append("<a><span class='ic_classic ic_del' title='"+r["\uc0ad\uc81c"]+"'></span><a>"),this.progressEl.find("span.ic_del").on("click",function(){h.XHR.abort()}),u.fileupload({url:f.url+"?GOSSOcookie="+e.cookie("GOSSOcookie"),autoUpload:!0,dropZone:f.dropZone,progressEl:this.progressEl,pasteZone:null,add:function(t,i){if(f.validateFileType){var s=new RegExp("("+f.validateFileType+")","gi"),o=i.files[0].name,u=o.substring(o.lastIndexOf(".")+1).toLowerCase();if(!s.test(u))return e.goSlideMessage(f.validateFileTypeMessage),!1}if(!n.config("attachFileUpload"))return e.goAlert(r["\ud30c\uc77c\ucca8\ubd80\uc6a9\ub7c9\ucd08\uacfc"]),e("#dropZone").removeClass("drag_file"),!1;h.XHR=i;if(n.session().brandName=="DO_SAAS"){var a=parseInt(n.config("commonAttachConfig").maxAttachSize),p=a*1024*1024;if(p<i.files[0].size)return e.goMessage(n.i18n(r["\ucca8\ubd80\ud560 \uc218 \uc788\ub294 \ucd5c\ub300 \uc0ac\uc774\uc988\ub294 0MB \uc785\ub2c8\ub2e4."],"arg1",a)),e("#dropZone").removeClass("drag_file"),!1;l+=i.files[0].size;var d=f.totalAttachCount+c+1,v=parseInt(n.config("commonAttachConfig").maxAttachNumber);if(v<d)return e.goMessage(n.i18n(r["\ucd5c\ub300 \ucca8\ubd80 \uac2f\uc218\ub294 0\uac1c \uc785\ub2c8\ub2e4."],"arg1",v)),e("#dropZone").removeClass("drag_file"),!1;c++}i.submit()},progress:function(e,t){h.progressEl.show();var n=t.files[0],r={name:n.name,type:"."+n.name.split(".")[1],loadedSize:t.loaded,totalSize:t.total},i=Math.ceil(r.loadedSize/r.totalSize*100);i>99&&(i=100),h.progressEl.progressBar(i,h.progressBarOpt),f.isWorks&&f.progress()},fail:function(e,t){t.jqXHR&&t.jqXHR.statusText=="abort"?f.error(r["\ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]):f.error(r["\uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."])},success:function(t,n){var r;e.browser.msie&&Number(e.browser.version)<10?r=e.parseJSON(e("pre",t).text()):r=e.parseJSON(t),f.isWorks?f.success(r):f.success(r.data)},always:function(){h.progressEl.hide(),h.progressEl.progressBar(0,h.progressBarOpt),l=0,c=0}})}return{bind:function(t,n){n=n||{},e(t).each(function(t,r){new s(e(r),n)})}}});