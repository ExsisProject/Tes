define(function(require){var e=require("backbone"),t=require("moment"),n="YYYY-MM-DDTHH:mm:ss.SSSZ";return e.Model.extend({initialize:function(e,t){this.modelName="matrix_item",this.matrix=t.matrix,t.startTimeKey&&this.set("startTime",this.get(t.startTimeKey)),t.endTimeKey&&this.set("endTime",this.get(t.endTimeKey))},defaults:{startTime:t(new Date).format(n),endTime:t(new Date).format(n)},setDateByGrid:function(e){this.setStartDateByGrid(e),this.setEndDateByGrid(e)},setStartDateByGrid:function(e){var r=this.matrix.get("gridValue"),i=this.matrix.get("gridUnit"),s=t(this.get("startTime")).add(e*r,i).format(n);this.set({startTime:s})},setEndDateByGrid:function(e){var r=this.matrix.get("gridValue"),i=this.matrix.get("gridUnit"),s=t(this.get("endTime")).add(e*r,i).format(n);this.set({endTime:s})},dateToPosition:function(){var e=t(this.matrix.get("startTime")),n=t(this.matrix.get("endTime")),r=(t(this.get("startTime"))-e)/(n-e)*100,i=(t(this.get("endTime"))-e)/(n-e)*100,s=(r<0?0:r)+"%",o=(r<0?i:i-r)+"%",u=this.index*parseInt(this.matrix.get("itemHeight"))+"px";return{left:s,width:o,top:u}},ratioToDate:function(e){var r=t(this.matrix.get("startTime")),i=t(this.matrix.get("endTime")),s=new Date(e*(i-r)/100+r);return t(s).format(n)},isValid:function(){return t(this.get("startTime"))<t(this.get("endTime"))}})});