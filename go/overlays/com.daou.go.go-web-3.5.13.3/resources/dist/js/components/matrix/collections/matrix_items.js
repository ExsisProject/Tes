define(function(require){var e=require("backbone"),t=require("moment");return e.Collection.extend({setOverlapIndex:function(){var e=this;this._clearIndex(),e.each(function(n){var r=n.get("startTime"),i=n.get("endTime"),s=e.filter(function(e){return t(n.get("startTime"))-t(e.get("endTime"))<0&&t(n.get("endTime"))-t(e.get("startTime"))>0});_.each(s,function(e,t){var r=_.findWhere(s,{index:t});if(!r)return n.index=t,!1})})},overlapCount:function(){if(this.isEmpty())return 1;var e=this.max(function(e){return e.index});return e.index+1},_clearIndex:function(){this.each(function(e){e.index=null})}})});