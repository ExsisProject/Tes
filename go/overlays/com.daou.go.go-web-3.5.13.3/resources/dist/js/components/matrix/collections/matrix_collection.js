define(function(require){var e=require("moment"),t=require("backbone"),n=require("matrix/collections/matrix_items"),r=require("matrix/models/matrix_item");return t.Collection.extend({initMatrixItems:function(e,t){return t=t||{},new n(e,_.extend(t,{matrix:this.matrix,model:r}))},setMatrix:function(e){this.matrix=e},setRows:function(e){this.rows=e},prev:function(){this._changeTimes(-1)},next:function(){this._changeTimes(1)},today:function(){this._changeTimes(this._calculateDateDiff())},changeTime:function(e){this._changeTimes(this._calculateDateDiff(e))},changeTimeCallback:function(){},_calculateDateDiff:function(t){t=t||new Date;var n=this.matrix.get("navigationInterval"),r=e(this.matrix.get("startTime")).startOf(n);return e(t).startOf(n).diff(r,n)},_changeTimes:function(t){var n=this.matrix.get("startTime"),r=this.matrix.get("endTime"),i=e(n).add(t,this.matrix.get("navigationInterval")).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),s=e(r).add(t,this.matrix.get("navigationInterval")).format("YYYY-MM-DDTHH:mm:ss.SSSZ");this.matrix.set("startTime",i),this.matrix.set("endTime",s),this.matrix.initColumns(),this.changeTimeCallback()}})});