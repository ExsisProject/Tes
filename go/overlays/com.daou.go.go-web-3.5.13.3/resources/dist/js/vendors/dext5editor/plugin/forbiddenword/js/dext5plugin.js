(function(){try{var e={pluginName:"forbiddenword"};G_DEPlugin.forbiddenword=e;if(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion){var t=DEXTTOP.G_CURREDITOR._config.toolBar1.indexOf("p_forbiddenword"),n=DEXTTOP.G_CURREDITOR._config.toolBar2.indexOf("p_forbiddenword");-1<t&&DEXTTOP.G_CURREDITOR._config.toolBar1.splice(t,1),-1<n&&DEXTTOP.G_CURREDITOR._config.toolBar2.splice(n,1)}e.onClickToolIcon=function(){try{if(1!=e.isProcess){e.isProcess=!0,showProcessingBackground();var t=DEXTTOP.G_CURREDITOR._BODY.innerText;if(DEXTTOP.DEXT5.IsEmpty(DEXTTOP.G_CURREDITOR.ID))return alert(dext5_lang.plugins.forbiddenword.no_content),e.isProcess=!1,hideProcessingBackground(),!1;var n=DEXTTOP.G_CURREDITOR._config.forbiddenWord,r=n.split(","),i=[];r.sort(function(e,t){if(e.length<t.length)return 1;if(e.length>t.length)return-1;var n=e,r=t,i=null,s="number"==typeof r&&"number"==typeof n;if(!s){for(var o=n.length,u=r.length,a="",f="",l="",c=0;c<o&&!(c+1>u);c++){var h=n.substring(c,c+1),p=r.substring(c,c+1);if(h!=p)break;a=n.substring(c+1),f=r.substring(c+1),l=isNaN(parseInt(h,10))||isNaN(parseInt(p,10))?"":l+h}""!=a&&(n=l+a),""!=f&&(r=l+f);if(!isNaN(parseInt(n.substring(0,1),10))&&!isNaN(parseInt(r.substring(0,1),10)))if(parseInt(r,10)!=parseInt(n,10))i=parseInt(r,10)>parseInt(n,10);else{o=n.length;for(c=i=0;c<o;c++)if(isNaN(parseInt(n.substring(c,c+1),10))){i=c;break}o=r.length;for(c=u=0;c<o;c++)if(isNaN(parseInt(r.substring(c,c+1),10))){u=c;break}i=u<i}}return null==i&&(i=s?r>n:DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.chrome?0>n.localeCompare(r,"en-us"):0>n.localeCompare(r)),i?1:-1});if(""!=n&&null!=n&&void 0!=n)for(n=0;n<r.length;n++){var s=null;if(s=t.match(new RegExp(r[n],"ig")))for(var o=0,u=0;u<s.length;u++){var o=t.indexOf(s[u],o),a={word:s[u],indexOf:o},o=o+r[n].length;i.push(a);for(var f=0;f<i.length-1;f++)-1<i[f].word.indexOf(a.word)&&i[f].indexOf<=a.indexOf&&i[f].indexOf+i[f].word.length>=a.indexOf&&i.splice(i.length-1,1)}}if(0==i.length)return alert(dext5_lang.plugins.forbiddenword.compMsg),e.isProcess=!1,hideProcessingBackground(),!1;i.sort(function(e,t){return e.indexOf>t.indexOf?1:e.indexOf<t.indexOf?-1:0}),e.chkWordArr=i,DEXT5_EDITOR.prototype.dialog.show(_dext_editor._config.webPath.plugin,"forbiddenword/editor_popup.html"),hideProcessingBackground()}}catch(l){e.isProcess=!1,hideProcessingBackground()}},e.setPopup=function(e,t,n){try{var r=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID).contentWindow,i=r.rangy.createRange(n.document.getElementById("copycontent").contentWindow.document);if(0==e.length)return!1;for(var s=0;s<e.length;s++)if(i.findText(e[s].word)){i.deleteContents();var o=n.document.createElement("span");o.setAttribute("id","cnt"+s),o.setAttribute("class","cnt"),o.setAttribute("onmouseover","parent.forbidden_word_over(this)"),o.setAttribute("onmouseout","parent.forbidden_word_out(this)");var u=document.createElement("span");u.setAttribute("class","wordspan"),u.innerText=e[s].word;var a=n.document.createElement("sup"),f=n.document.createTextNode(s+1+")");a.appendChild(f),o.appendChild(a),o.appendChild(u),i.insertNode(o),i.selectNode(o),t?i.collapse(!1):i.collapse(!0);var l=n.document.createElement("dl");l.setAttribute("id","list"+s),l.setAttribute("value",s),-1!=r.G_DEPlugin.forbiddenword.chkWordArr[s].word.indexOf("'")?l.innerHTML='<div class="forbiddenDiv"><div class="forbiddenWord" onclick="scroll_to_text_click(this)"><p>'+(s+1)+") "+r.G_DEPlugin.forbiddenword.chkWordArr[s].word+'</p></div><div class="forbiddenBtn"><button onclick="delete_btn_click(this)" class="forbiddenDBtn">'+dext5_lang.plugins.forbiddenword.word_delete+'</button> <button onclick="permit_btn_click(this)" class="forbiddenPBtn">'+dext5_lang.plugins.forbiddenword.permit+"</button>":l.innerHTML+="<div class='forbiddenDiv'><div class='forbiddenWord' onclick='scroll_to_text_click(this)'><p>"+(s+1)+") "+r.G_DEPlugin.forbiddenword.chkWordArr[s].word+"</p></div><div class='forbiddenBtn'><button onclick='delete_btn_click(this)' class='forbiddenDBtn'>"+dext5_lang.plugins.forbiddenword.word_delete+"</button> <button onclick='permit_btn_click(this)' class='forbiddenPBtn'>"+dext5_lang.plugins.forbiddenword.permit+"</button>",n.document.getElementById("wordlist").appendChild(l)}hideProcessingBackground()}catch(c){}}}catch(r){}command_forbidden_word=function(t,n,r){e.callbackType=r,e.onClickToolIcon()}})();