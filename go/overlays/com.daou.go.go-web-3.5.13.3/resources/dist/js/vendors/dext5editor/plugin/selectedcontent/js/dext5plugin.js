(function(){try{var e="selectedcontent",t={pluginName:e};G_DEPlugin[e]=t;if(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion){var n=DEXTTOP.G_CURREDITOR._config.toolBar1.indexOf("p_selectedcontent"),r=DEXTTOP.G_CURREDITOR._config.toolBar2.indexOf("p_selectedcontent");-1<n&&DEXTTOP.G_CURREDITOR._config.toolBar1.splice(n,1),-1<r&&DEXTTOP.G_CURREDITOR._config.toolBar2.splice(r,1)}t.onInit=function(){},t.onClickToolIcon=function(e){try{1!=t.isProcess&&(t.isProcess=!0,command_p_selectedcontent_click())}catch(n){}finally{t.isProcess=!1}},t.onDisableToolIcon=function(e){switch(e){case"cellSelectText":case"selectArea":return!0;default:return["p_selectedcontent"]}},t.onLoaded=function(){DEXT5_CONTEXT._setMenuOrg=DEXT5_CONTEXT._setMenu,DEXT5_CONTEXT._setMenu=function(t){DEXT5_CONTEXT._setMenuOrg(t),t=DEXTTOP.DEXT5.GetSelectedContent();if(""!==t.text){var n=getDialogDocument().getElementById("dext_context_iframe");if(n){var r=this._context_document.createElement("dd");r.id=id="context_p_selectedcontent",r.innerHTML='<div class="s_left"><span style="background: url('+(DEXTTOP.G_CURREDITOR._config.webPath.plugin+e+"/images/icon.png")+') transparent no-repeat;"></span></div><div class="s_right">'+dext5_lang.plugins.selectedcontent.title+"</div>";var i=this._context_document.getElementById("ul_context_main"),s=this._context_document.createElement("dd");s.className="b_border",i.appendChild(s),i.appendChild(r),r.className=""!==t.text?"":"item_disabled",i=function(e){return function(t){var n=e.className.replace("on_mouseover","");e.className=n+(-1<e.className.indexOf("item_disabled")?"":" on_mouseover"),DEXTTOP.DEXT5.util.stopEvent(t)}}(r),s=function(e){return function(t){e.className=e.className.replace("on_mouseover",""),DEXTTOP.DEXT5.util.stopEvent(t)}}(r),DEXTTOP.DEXT5.util.addEvent(r,"mouseover",i),DEXTTOP.DEXT5.util.addEvent(r,"mouseout",s),""!==t.text&&DEXTTOP.DEXT5.util.addEvent(r,"click",command_p_selectedcontent_click),window.setTimeout(function(){var e=DEXTTOP.DEXT5.util.parseIntOr0(n.style.height);n.style.height=e+26+"px"},1)}}}}}catch(i){}command_p_selectedcontent_click=function(){"undefined"!=typeof DEXTTOP.dext_editor_plugin_custom_action&&DEXTTOP.dext_editor_plugin_custom_action({pluginName:e})}})();