(function(){try{var e={pluginName:"spellcheck"};G_DEPlugin.spellcheck=e;var t=DEXTTOP.DEXT5.util.xml;if(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion){var n=DEXTTOP.G_CURREDITOR._config.toolBar1.indexOf("p_spellcheck"),r=DEXTTOP.G_CURREDITOR._config.toolBar2.indexOf("p_spellcheck");-1<n&&DEXTTOP.G_CURREDITOR._config.toolBar1.splice(n,1),-1<r&&DEXTTOP.G_CURREDITOR._config.toolBar2.splice(r,1)}e.onClickToolIcon=function(){1!=e.isProcess&&(e.isProcess=!0,showProcessingBackground(),setTimeout(function(){g_findRepalceRange=null,_dext_editor._LastRange=null,doSetCaretPosition(_iframeDoc.body.firstChild,0);var n=T.toString(),n=n.replace(/,/gi,""),r=function(){if("Y"==G_SC){var r=DEXTTOP.G_CURREDITOR._BODY.innerText,r=r.replace(/\u00a0/gi,""),r=r.replace(/&nbsp/gi,""),r=r.replace(/ /gi,""),r=r.replace(/\r\n/gi,""),r=r.replace(/\n/gi,""),r=r.replace(/\r/gi,""),r=r.replace(/\s/gi,"");if(""==r||null==r||void 0==r)alert(dext5_lang.plugins.spellcheck.no_content),e.isProcess=!1,hideProcessingBackground();else{var r=DEXTTOP.G_CURREDITOR._BODY.innerHTML,r=r.replace(/&nbsp;/gi," "),r=r.replace(/\+/gi,"%2B"),r=r.replace(/&amp;/gi,""),r=r.replace(/style[^>]*(.*?)/gi,""),r=r.replace(/<p><br><\/p>/gi,"\n"),r=r.replace(/<br>/gi,"\n"),r=r.replace(/<br >/gi,"\n"),r=r.replace(/<o:p>/gi,"\n"),r=r.replace(/<\/o:p>/gi,"\n"),r=r.replace(/<\/p>/gi,"\n"),r=r.replace(/<\/td>/gi,"\n"),s=new RegExp(DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter,"gi"),r=r.replace(new RegExp(DEXTTOP.G_CURREDITOR._config.unitDelimiter,"gi"),""),r=r.replace(s,""),r=r.replace(/<[^>]+>/gi,""),r=r.replace(/&lt;/gi,"<"),r=r.replace(/&gt;/gi,">");e.chkWordArr=[];var r=r.split("\n"),s=r.length,o=e.checkLineCount?e.checkLineCount:s,u=e.handlerURL,u=DEXTTOP.DEXT5.util.setProtocolBaseDomainURL(u),a=!1;for(i=0;i<s;i+=o){var f=i,c=i+o;c>=s&&(c=s),f=r.slice(f,c).join("\n"),c=___,-1<c.indexOf("?")&&(c=c.substring(0,c.indexOf("?")));var h=c.indexOf("//"),c=-1<h?c.substring(0,c.substring(h+2).indexOf("/")+(h+2)+1):c.substring(0,c.indexOf("/")+1);if(void 0==e.weakRule||null==e.weakRule||""==e.weakRule)e.weakRule=!1;f="s01"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+"DE"+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s02"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+DEXTTOP.G_CURREDITOR._config.productKey+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s03"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+c+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s04"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+f+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s05"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+e.weakRule,f=encodeURI("s00="+DEXTTOP.DEXT5.util.makeEncryptParamEx3(f)),f=DEXTTOP.DEXT5.util.makeDecryptReponseMessageEx3(DEXTTOP.DEXT5.ajax.postData(u,f));if(null==f||-1==f.indexOf("<?xml")&&""!=f){a=!0;break}f=f.split("\f");for(c=0;c<f.length;c++)for(var h=DEXTTOP.DEXT5.util.stringToXML(f[c]),p=t.count(h,"PnuErrorWord"),d=0;d<p;d++){for(var v=t.getNodeIdx(h,"PnuErrorWord",d),m=[],g=t.count(v,"CandWord"),y=0;y<g;y++)m.push(t.getNodeValueIdx(v,"CandWord",y));v={word:t.getNodeValue(v,"OrgStr"),suggestions:m},""!=m&&-1==v.word.indexOf("\n")&&-1!=DEXTTOP.G_CURREDITOR._BODY.innerText.indexOf(v.word)&&e.chkWordArr.push(v)}}if(a)return alert("HandlerURL\uc758 \uc124\uc815\uac12\uc774 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \n\nspellcheck/js/config.js\uc758 handlerURL\uc758 \uac12\uc744 \ud655\uc778\ud558\uc138\uc694."),e.isProcess=!1,hideProcessingBackground(),!1;0==e.chkWordArr.length?(alert(dext5_lang.plugins.spellcheck.compMsg),e.isProcess=!1,hideProcessingBackground()):DEXT5_EDITOR.prototype.dialog.show(_dext_editor._config.webPath.plugin,"spellcheck/editor_popup.html")}}else"N"==G_SC&&(alert(n+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M5)),e.isProcess=!1,hideProcessingBackground())};if(""==G_SC)var s=setInterval(function(){""!=G_SC&&(r(),hideProcessingBackground(),clearInterval(s))},100);else r()},100))},e.onInit=function(){s("../js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/aes.js");var e="../plugin/spellcheck/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/config.js",e="1"==DEXTTOP.DEXT5.config.UseConfigTimeStamp?e+("?t="+DEXTTOP.DEXT5.util.getTimeStamp()):e+("?ver="+DEXTTOP.DEXT5.ReleaseVer);s(e)};var s=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,t.appendChild(n)};e.onInit()}catch(o){}})();