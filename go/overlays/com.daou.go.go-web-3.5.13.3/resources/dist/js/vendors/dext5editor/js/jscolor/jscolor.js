Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){t=t||0;for(var n=this.length;t<n;){if(this[t]===e)return t;++t}return-1});var jscolor={dir:"../images/editor/jscolor/",bindClass:"color",binding:!0,preloading:!0,clickedElem:null,styleColor:"",actionType:"",excuteFn:null,install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){jscolor.binding&&jscolor.bind(),jscolor.preloading&&jscolor.preload()},getDir:function(){if(!jscolor.dir){var e=jscolor.detectDir();jscolor.dir=!1!==e?e:"jscolor/"}return jscolor.dir},detectDir:function(){for(var e=location.href,t=document.getElementsByTagName("base"),n=0;n<t.length;n+=1)t[n].href&&(e=t[n].href);t=document.getElementsByTagName("script");for(n=0;n<t.length;n+=1)if(t[n].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(t[n].src))return e=(new jscolor.URI(t[n].src)).toAbsolute(e),e.path=e.path.replace(/[^\/]+$/,""),e.query=null,e.fragment=null,e.toString();return!1},bind:function(){for(var e=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i"),t=document.getElementsByTagName("div"),n=0;n<t.length;n+=1){var r;if(!t[n].color&&t[n].className&&(r=t[n].className.match(e))){var i={};if(r[3])try{i=(new Function("return ("+r[3]+")"))()}catch(s){}t[n].color=new jscolor.color(t[n],i)}}},preload:function(){for(var e in jscolor.imgRequire)jscolor.imgRequire.hasOwnProperty(e)&&jscolor.loadImage(e)},images:{pad:[130,81],sld:[15,81],cross:[20,20],arrow:[3,0]},imgRequire:{},imgLoaded:{},requireImage:function(e){jscolor.imgRequire[e]=!0},loadImage:function(e){jscolor.imgLoaded[e]||(jscolor.imgLoaded[e]=new Image,jscolor.imgLoaded[e].src=jscolor.getDir()+e)},fetchElement:function(e){return"string"==typeof e?document.getElementById(e):e},addEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},fireEvent:function(e,t){if(e)if(document.createEvent){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}else document.createEventObject?document.createEventObject():e["on"+t]&&e["on"+t]()},getElementPos:function(e){var t=e,n=0,r=0;if(t.offsetParent)do n+=t.offsetLeft,r+=t.offsetTop;while(t=t.offsetParent);for(;(e=e.parentNode)&&"BODY"!==e.nodeName.toUpperCase();)n-=e.scrollLeft,r-=e.scrollTop;return[n,r]},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight]},getRelMousePos:function(e){var t=0,n=0;return e||(e=window.event),"number"==typeof e.offsetX?(t=e.offsetX,n=e.offsetY):"number"==typeof e.layerX&&(t=e.layerX,n=e.layerY),{x:t,y:n}},getViewPos:function(){return"number"==typeof window.pageYOffset?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return"number"==typeof window.innerWidth?[window.innerWidth,window.innerHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?[document.body.clientWidth,document.body.clientHeight]:[0,0]},URI:function(e){function t(e){for(var t="";e;)if("../"===e.substr(0,3)||"./"===e.substr(0,2))e=e.replace(/^\.+/,"").substr(1);else if("/./"===e.substr(0,3)||"/."===e)e="/"+e.substr(3);else if("/../"===e.substr(0,4)||"/.."===e)e="/"+e.substr(4),t=t.replace(/\/?[^\/]*$/,"");else if("."===e||".."===e)e="";else{var n=e.match(/^\/?[^\/]*/)[0];e=e.substr(n.length),t+=n}return t}this.authority=this.scheme=null,this.path="",this.fragment=this.query=null,this.parse=function(e){return e=e.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/),this.scheme=e[3]?e[2]:null,this.authority=e[5]?e[6]:null,this.path=e[7],this.query=e[9]?e[10]:null,this.fragment=e[12]?e[13]:null,this},this.toString=function(){var e="";return null!==this.scheme&&(e=e+this.scheme+":"),null!==this.authority&&(e=e+"//"+this.authority),null!==this.path&&(e+=this.path),null!==this.query&&(e=e+"?"+this.query),null!==this.fragment&&(e=e+"#"+this.fragment),e},this.toAbsolute=function(e){e=new jscolor.URI(e);var n=new jscolor.URI;return null===e.scheme?!1:(null!==this.scheme&&this.scheme.toLowerCase()===e.scheme.toLowerCase()&&(this.scheme=null),null!==this.scheme?(n.scheme=this.scheme,n.authority=this.authority,n.path=t(this.path),n.query=this.query):(null!==this.authority?(n.authority=this.authority,n.path=t(this.path),n.query=this.query):(""===this.path?(n.path=e.path,n.query=null!==this.query?this.query:e.query):("/"===this.path.substr(0,1)?n.path=t(this.path):(n.path=null!==e.authority&&""===e.path?"/"+this.path:e.path.replace(/[^\/]+$/,"")+this.path,n.path=t(n.path)),n.query=this.query),n.authority=e.authority),n.scheme=e.scheme),n.fragment=this.fragment,n)},e&&this.parse(e)},color:function(e,t,n,r,i,s){function o(e,t,n){if(null===e)return[n,n,n];var r=Math.floor(e),i=n*(1-t);e=n*(1-t*(r%2?e-r:1-(e-r)));switch(r){case 6:case 0:return[n,e,i];case 1:return[e,n,i];case 2:return[i,n,e];case 3:return[i,e,n];case 4:return[e,i,n];case 5:return[n,i,e]}}function u(e,t){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),boxC:document.createElement("div"),boxHEX:document.createElement("span"),boxRGB:document.createElement("span"),btnS:document.createElement("span"),btnT:document.createTextNode(g.pickerCloseText),select:document.createElement("select"),option1:document.createElement("option"),option2:document.createElement("option"),btnOk:document.createElement("input"),btnCancle:document.createElement("input"),label:document.createElement("label"),labelR:document.createElement("label"),labelG:document.createElement("label"),labelB:document.createElement("label"),lbColor:document.createElement("input"),lbColor2:document.createElement("input"),lbColorR:document.createElement("input"),lbColorG:document.createElement("input"),lbColorB:document.createElement("input"),inbottom:document.createElement("div"),bottom:document.createElement("div")};for(var n=0;n<jscolor.images.sld[1];n+=4){var r=document.createElement("div");r.style.height="4px",r.style.fontSize="1px",r.style.lineHeight="0",jscolor.picker.sld.appendChild(r)}jscolor.picker.sldB.appendChild(jscolor.picker.sld),jscolor.picker.box.appendChild(jscolor.picker.sldB),jscolor.picker.box.appendChild(jscolor.picker.sldM),jscolor.picker.padB.appendChild(jscolor.picker.pad),jscolor.picker.box.appendChild(jscolor.picker.padB),jscolor.picker.box.appendChild(jscolor.picker.padM),jscolor.picker.btnS.appendChild(jscolor.picker.btnT),jscolor.picker.btn.appendChild(jscolor.picker.btnS),jscolor.picker.box.appendChild(jscolor.picker.btn),jscolor.picker.boxB.appendChild(jscolor.picker.box),jscolor.picker.boxC.style.margin="0 0 5px 0",jscolor.picker.boxC.style.padding="0",jscolor.picker.boxC.style.textAlign="left",jscolor.picker.boxC.style.marginBottom="5px",jscolor.picker.lbColor2.setAttribute("type","text"),jscolor.picker.lbColor2.setAttribute("id","cp_lb_color2"),jscolor.picker.lbColor2.setAttribute("disabled","disabled"),jscolor.picker.lbColor2.style.border="solid 1px #c5c5c5",jscolor.picker.lbColor2.style.width="33px",jscolor.picker.lbColor2.style.backgroundColor="#ffffff",n=19,parent.DEXTTOP.DEXT5.browser.ie&&9>=parent.DEXTTOP.DEXT5.browser.ieVersion&&!parent.DEXTTOP.DEXT5.browser.quirks&&(n=15),jscolor.picker.lbColor2.style.height=n+"px",jscolor.picker.lbColor2.style.marginLeft="-1px",jscolor.picker.boxHEX.style.display="inline-block",jscolor.picker.boxHEX.style.margin="0",jscolor.picker.boxHEX.style.padding="0",jscolor.picker.label.innerText="#",jscolor.picker.label.style.marginLeft="1px",jscolor.picker.label.style.color="#5d5d5d",jscolor.picker.label.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.label.style.fontSize="13px",jscolor.picker.lbColor.setAttribute("type","text"),jscolor.picker.lbColor.setAttribute("id","cp_lb_color"),jscolor.picker.lbColor.style.border="solid 1px #c5c5c5",jscolor.picker.lbColor.style.color="#5d5d5d",jscolor.picker.lbColor.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.lbColor.style.fontSize="13px",jscolor.picker.lbColor.style.width=parent.DEXTTOP.DEXT5.browser.ie&&9>=parent.DEXTTOP.DEXT5.browser.ieVersion&&!parent.DEXTTOP.DEXT5.browser.quirks?"98px":parent.DEXTTOP.DEXT5.browser.chrome?"108px":"107px",jscolor.picker.lbColor.style.height=n+"px",jscolor.picker.lbColor.style.imeMode="disabled",jscolor.picker.lbColor.maxLength="6",parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColor,"keyup",function(e){try{jscolor.picker.lbColor2.style.backgroundColor="#"+jscolor.picker.lbColor.value}catch(t){jscolor.picker.lbColor2.style.backgroundColor="#ffffff"}}),jscolor.picker.boxHEX.appendChild(jscolor.picker.label),jscolor.picker.boxHEX.appendChild(jscolor.picker.lbColor);var r="30px",i="3px";parent.DEXTTOP.DEXT5.browser.ie&&9>=parent.DEXTTOP.DEXT5.browser.ieVersion&&!parent.DEXTTOP.DEXT5.browser.quirks?(r="25.5px",i=""):parent.DEXTTOP.DEXT5.browser.chrome&&(r="29.5px"),jscolor.picker.labelR.innerText="R",jscolor.picker.labelR.style.color="#5d5d5d",jscolor.picker.labelR.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.labelR.style.fontSize="13px",jscolor.picker.labelR.style.marginLeft=i,jscolor.picker.lbColorR.setAttribute("type","text"),jscolor.picker.lbColorR.setAttribute("id","cp_lb_color_r"),jscolor.picker.lbColorR.style.border="solid 1px #c5c5c5",jscolor.picker.lbColorR.style.width=r,jscolor.picker.lbColorR.style.height=n+"px",jscolor.picker.lbColorR.style.color="#5d5d5d",jscolor.picker.lbColorR.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.lbColorR.style.fontSize="13px",jscolor.picker.lbColorR.style.imeMode="disabled",jscolor.picker.lbColorR.maxLength="3",parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColorR,"keypress",function(e){var t=e.keyCode?e.keyCode:e.which;(48>t||57<t)&&parent.DEXTTOP.DEXT5.util.cancelEvent(e)}),parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColorR,"keyup",function(e){17==(e.keyCode?e.keyCode:e.which)&&(ctrlDown=!1),0>jscolor.picker.lbColorR.value?jscolor.picker.lbColorR.value=0:255<jscolor.picker.lbColorR.value?jscolor.picker.lbColorR.value=255:"0"!=jscolor.picker.lbColorR.value&&0==jscolor.picker.lbColorR.value.indexOf("0")&&(jscolor.picker.lbColorR.value=jscolor.picker.lbColorR.value.replace("0",""));try{jscolor.picker.lbColor2.style.backgroundColor="rgb("+jscolor.picker.lbColorR.value+", "+jscolor.picker.lbColorG.value+", "+jscolor.picker.lbColorB.value+")"}catch(t){jscolor.picker.lbColor2.style.backgroundColor="rgb(255,255,255)"}}),jscolor.picker.labelG.innerText="G",jscolor.picker.labelG.style.color="#5d5d5d",jscolor.picker.labelG.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.labelG.style.fontSize="13px",jscolor.picker.lbColorG.setAttribute("type","text"),jscolor.picker.lbColorG.setAttribute("id","cp_lb_color_g"),jscolor.picker.lbColorG.style.border="solid 1px #c5c5c5",jscolor.picker.lbColorG.style.width=r,jscolor.picker.lbColorG.style.height=n+"px",jscolor.picker.lbColorG.style.color="#5d5d5d",jscolor.picker.lbColorG.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.lbColorG.style.fontSize="13px",jscolor.picker.lbColorG.style.imeMode="disabled",jscolor.picker.lbColorG.maxLength="3",parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColorG,"keypress",function(e){var t=e.keyCode?e.keyCode:e.which;(48>t||57<t)&&parent.DEXTTOP.DEXT5.util.cancelEvent(e)}),parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColorG,"keyup",function(e){0>jscolor.picker.lbColorG.value?jscolor.picker.lbColorG.value=0:255<jscolor.picker.lbColorG.value?jscolor.picker.lbColorG.value=255:"0"!=jscolor.picker.lbColorG.value&&0==jscolor.picker.lbColorG.value.indexOf("0")&&(jscolor.picker.lbColorG.value=jscolor.picker.lbColorG.value.replace("0",""));try{jscolor.picker.lbColor2.style.backgroundColor="rgb("+jscolor.picker.lbColorR.value+", "+jscolor.picker.lbColorG.value+", "+jscolor.picker.lbColorB.value+")"}catch(t){jscolor.picker.lbColor2.style.backgroundColor="rgb(255,255,255)"}}),jscolor.picker.labelB.innerText="B",jscolor.picker.labelB.style.color="#5d5d5d",jscolor.picker.labelB.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.labelB.style.fontSize="13px",jscolor.picker.lbColorB.setAttribute("type","text"),jscolor.picker.lbColorB.setAttribute("id","cp_lb_color_b"),jscolor.picker.lbColorB.style.border="solid 1px #c5c5c5",jscolor.picker.lbColorB.style.width=r,jscolor.picker.lbColorB.style.height=n+"px",jscolor.picker.lbColorB.style.color="#5d5d5d",jscolor.picker.lbColorB.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.lbColorB.style.fontSize="13px",jscolor.picker.lbColorB.style.imeMode="disabled",jscolor.picker.lbColorB.maxLength="3",parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColorB,"keypress",function(e){var t=e.keyCode?e.keyCode:e.which;(48>t||57<t)&&parent.DEXTTOP.DEXT5.util.cancelEvent(e)}),parent.DEXTTOP.DEXT5.util.addEvent(jscolor.picker.lbColorB,"keyup",function(e){17==(e.keyCode?e.keyCode:e.which)&&(ctrlDown=!1),0>jscolor.picker.lbColorB.value?jscolor.picker.lbColorB.value=0:255<jscolor.picker.lbColorB.value?jscolor.picker.lbColorB.value=255:"0"!=jscolor.picker.lbColorB.value&&0==jscolor.picker.lbColorB.value.indexOf("0")&&(jscolor.picker.lbColorB.value=jscolor.picker.lbColorB.value.replace("0",""));try{jscolor.picker.lbColor2.style.backgroundColor="rgb("+jscolor.picker.lbColorR.value+", "+jscolor.picker.lbColorG.value+", "+jscolor.picker.lbColorB.value+")"}catch(t){jscolor.picker.lbColor2.style.backgroundColor="rgb(255,255,255)"}}),jscolor.picker.boxRGB.style.margin="0",jscolor.picker.boxRGB.style.padding="0",jscolor.picker.boxRGB.appendChild(jscolor.picker.labelR),jscolor.picker.boxRGB.appendChild(jscolor.picker.lbColorR),jscolor.picker.boxRGB.appendChild(jscolor.picker.labelG),jscolor.picker.boxRGB.appendChild(jscolor.picker.lbColorG),jscolor.picker.boxRGB.appendChild(jscolor.picker.labelB),jscolor.picker.boxRGB.appendChild(jscolor.picker.lbColorB),jscolor.picker.select.name="colorValue",jscolor.picker.select.id="colorValue",jscolor.picker.select.style.border="1px solid #c5c5c5",jscolor.picker.select.style.color="#5d5d5d",jscolor.picker.select.style.fontFamily="Tahoma,AppleGothic,sans-serif !important",jscolor.picker.select.style.fontSize="13px","0"==parent.DEXTTOP.G_CURREDITOR._config.colorPickerInputKind?(jscolor.picker.option1.value="hex",jscolor.picker.option1.innerText="HEX",jscolor.picker.option2.value="rgb",jscolor.picker.option2.innerText="RGB"):"1"==parent.DEXTTOP.G_CURREDITOR._config.colorPickerInputKind&&(jscolor.picker.option1.value="rgb",jscolor.picker.option1.innerText="RGB",jscolor.picker.option2.value="hex",jscolor.picker.option2.innerText="HEX"),jscolor.picker.select.appendChild(jscolor.picker.option1),jscolor.picker.select.appendChild(jscolor.picker.option2),jscolor.picker.btnOk.setAttribute("type","button"),jscolor.picker.btnOk.setAttribute("id","cp_btn_ok"),jscolor.picker.btnOk.setAttribute("value",parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.ok),jscolor.picker.btnOk.style.width="42px",jscolor.picker.btnOk.style.color="#5d5d5d",jscolor.picker.btnOk.className="DEXT_fiVe_EdiTor_font",jscolor.picker.btnOk.style.fontSize="13px",jscolor.picker.btnCancle.setAttribute("type","button"),jscolor.picker.btnCancle.setAttribute("id","cp_btn_cancle"),jscolor.picker.btnCancle.setAttribute("value",parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.close);if(n=0==parent.DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase().indexOf("mac")&&"safari"==parent.DEXTTOP.DEXT5.UserAgent.browser.name.toLowerCase())jscolor.picker.btnOk.style.height="24px";parent.DEXTTOP.DEXT5.browser.mobile||n?(jscolor.picker.btnCancle.style.width="40px",n&&(jscolor.picker.btnCancle.style.height="24px")):jscolor.picker.btnCancle.style.width=parent.DEXTTOP.DEXT5.browser.ie?"54px":"51px",jscolor.picker.btnCancle.style.color="#5d5d5d",jscolor.picker.btnCancle.className="DEXT_fiVe_EdiTor_font",jscolor.picker.btnCancle.style.fontSize="13px",jscolor.picker.boxC.appendChild(jscolor.picker.lbColor2),"0"==parent.DEXTTOP.G_CURREDITOR._config.colorPickerInputKind?jscolor.picker.boxC.appendChild(jscolor.picker.boxHEX):"1"==parent.DEXTTOP.G_CURREDITOR._config.colorPickerInputKind&&jscolor.picker.boxC.appendChild(jscolor.picker.boxRGB),jscolor.picker.bottom.appendChild(jscolor.picker.boxC),jscolor.picker.select.onchange=function(){"hex"==jscolor.picker.select.value?(jscolor.picker.lbColor.value="",jscolor.picker.lbColor2.style.backgroundColor="#ffffff",jscolor.picker.boxC.removeChild(jscolor.picker.boxRGB),jscolor.picker.boxHEX.style.display="inline-block",jscolor.picker.boxC.appendChild(jscolor.picker.boxHEX),jscolor.picker.lbColor.focus()):"rgb"==jscolor.picker.select.value&&(jscolor.picker.lbColorR.value="",jscolor.picker.lbColorG.value="",jscolor.picker.lbColorB.value="",jscolor.picker.lbColor2.style.backgroundColor="#ffffff",jscolor.picker.boxC.removeChild(jscolor.picker.boxHEX),jscolor.picker.boxRGB.style.display="inline-block",jscolor.picker.boxC.appendChild(jscolor.picker.boxRGB),jscolor.picker.lbColorR.focus())},jscolor.picker.inbottom.appendChild(jscolor.picker.select),jscolor.picker.inbottom.appendChild(jscolor.picker.btnOk),jscolor.picker.inbottom.appendChild(jscolor.picker.btnCancle),jscolor.picker.bottom.appendChild(jscolor.picker.inbottom),jscolor.picker.boxB.appendChild(jscolor.picker.bottom),jscolor.picker.boxB.setAttribute("id","color_picker")}var s=jscolor.picker;s.box.onmouseup=s.box.onmousedown=function(){b=!0},s.box.onmousemove=function(e){if(S||x)S&&p(e),x&&d(e),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),v()},"ontouchstart"in window&&s.box.addEventListener("touchmove",function(e){var t={offsetX:e.touches[0].pageX-T.X,offsetY:e.touches[0].pageY-T.Y};if(S||x)S&&p(t),x&&d(t),v();e.stopPropagation(),e.preventDefault()},!1),s.padM.onmouseup=s.padM.onmouseout=function(){S&&(S=!1,jscolor.fireEvent(w,"change"))},s.padM.onmousedown=function(e){switch(y){case 0:0===g.hsv[2]&&g.fromHSV(null,null,1);break;case 1:0===g.hsv[1]&&g.fromHSV(null,1,null)}x=!1,S=!0,p(e),v()},"ontouchstart"in window&&s.padM.addEventListener("touchstart",function(e){T={X:e.target.offsetParent.offsetLeft,Y:e.target.offsetParent.offsetTop},this.onmousedown({offsetX:e.touches[0].pageX-T.X,offsetY:e.touches[0].pageY-T.Y})}),s.sldM.onmouseup=s.sldM.onmouseout=function(){x&&(x=!1,jscolor.fireEvent(w,"change"))},s.sldM.onmousedown=function(e){S=!1,x=!0,d(e),v()},"ontouchstart"in window&&s.sldM.addEventListener("touchstart",function(e){T={X:e.target.offsetParent.offsetLeft,Y:e.target.offsetParent.offsetTop},this.onmousedown({offsetX:e.touches[0].pageX-T.X,offsetY:e.touches[0].pageY-T.Y})}),n=a(g),s.box.style.width=n[0]+"px",s.box.style.height=n[1]+"px",s.boxB.style.position="absolute",s.boxB.style.clear="both",s.boxB.style.left=e-6+"px",r=parent.document.getElementById("editor_popup_row_property"),i=parent.document.getElementById("editor_popup_column_property"),r||i?(n={left:0,top:0,right:0,bottom:0},r&&(n=r.getBoundingClientRect()),i&&(n=i.getBoundingClientRect()),r=parseInt(n.bottom,10)-parseInt(n.top,10),i=parseInt(s.box.style.height.replace("px",""))+43,n=document.getElementById("color_ul").getBoundingClientRect(),parseInt(n.bottom,10)-parseInt(n.top,10)<i&&(i+=44),s.boxB.style.top=r-i-13+"px"):s.boxB.style.top=t+2+"px",s.boxB.style.zIndex=g.pickerZIndex,s.boxB.style.border=g.pickerBorder+"px solid",s.boxB.style.borderColor=g.pickerBorderColor,s.boxB.style.background=g.pickerFaceColor,s.pad.style.width=jscolor.images.pad[0]+"px",s.pad.style.height=jscolor.images.pad[1]+"px",s.padB.style.position="absolute",s.padB.style.left=g.pickerFace+"px",s.padB.style.top=g.pickerFace+"px",s.padB.style.border=g.pickerInset+"px solid",s.padB.style.borderColor=g.pickerInsetColor,s.padM.style.position="absolute",s.padM.style.left="0",s.padM.style.top="0",s.padM.style.width=g.pickerFace+2*g.pickerInset+jscolor.images.pad[0]+"px",s.padM.style.height=s.box.style.height,s.padM.style.cursor="crosshair",s.sld.style.overflow="hidden",s.sld.style.width=jscolor.images.sld[0]+"px",s.sld.style.height=jscolor.images.sld[1]+"px",s.sldB.style.display=g.slider?"block":"none",s.sldB.style.position="absolute",s.sldB.style.right=g.pickerFace+"px",s.sldB.style.top=g.pickerFace+"px",s.sldB.style.border=g.pickerInset+"px solid",s.sldB.style.borderColor=g.pickerInsetColor,s.sldM.style.display=g.slider?"block":"none",s.sldM.style.position="absolute",s.sldM.style.right="3px",s.sldM.style.top="0",s.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+2*g.pickerInset+"px",s.sldM.style.height=s.box.style.height;try{s.sldM.style.cursor="pointer"}catch(o){s.sldM.style.cursor="hand"}n=function(e){e=e?e:window.event;if(13==e.keyCode)return c(),!1;e.shiftKey&&9==e.keyCode&&setTimeout(function(){s.btnCancle.focus()},0)},s.lbColor.onkeydown=n,s.lbColorR.onkeydown=n,s.btn.style.display=g.pickerClosable?"block":"none",s.btn.style.position="absolute",s.btn.style.left=g.pickerFace+"px",s.btn.style.bottom=g.pickerFace+"px",s.btn.style.padding="0 15px",s.btn.style.height="18px",s.btn.style.border=g.pickerInset+"px solid",function(){var e=g.pickerInsetColor.split(/\s+/);s.btn.style.borderColor=2>e.length?e[0]:e[1]+" "+e[0]+" "+e[0]+" "+e[1]}(),s.btn.style.color=g.pickerButtonColor,s.btn.style.font="12px sans-serif",s.btn.style.textAlign="center";try{s.btn.style.cursor="pointer"}catch(u){s.btn.style.cursor="hand"}s.btn.onmousedown=function(){g.hidePicker()},s.btnS.style.lineHeight=s.btn.style.height;var c=function(){var e="",t=s.select.value;if("hex"==t){if(e=s.lbColor.value,null!=e.match(/[^a-f\d]/gi)){alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),setTimeout(function(){s.lbColor.focus()},0);return}}else{var n=s.lbColorR.value,r=s.lbColorG.value,e=s.lbColorB.value;if(0>=n.length||null!=n.match(/[^0-9\d]/gi)){alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),setTimeout(function(){s.lbColorR.focus()},0);return}if(0>=r.length||null!=r.match(/[^0-9\d]/gi)){alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),setTimeout(function(){s.lbColorG.focus()},0);return}if(0>=e.length||null!=e.match(/[^0-9\d]/gi)){alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),setTimeout(function(){s.lbColorB.focus()},0);return}n=parseInt(n,10).toString(16),1==n.length&&(n="0"+n),r=parseInt(r,10).toString(16),1==r.length&&(r="0"+r),e=parseInt(e,10).toString(16),1==e.length&&(e="0"+e),e=n+r+e}e=e.replace("#",""),n=e.match(/[a-f\d]/gi);if(0>=e.length||null==n)alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),"hex"==t?setTimeout(function(){s.lbColor.focus()},0):setTimeout(function(){s.lbColorR.focus()},0);else if(3==n.length&&(e=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),3!=n.length&&6!=n.length)alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),"hex"==t?setTimeout(function(){s.lbColor.focus()},0):setTimeout(function(){s.lbColorR.focus()},0);else if(-1==e.indexOf("#")&&(e="#"+e),7!=e.length)alert(parent.DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.color_picker.msg),"hex"==t?setTimeout(function(){s.lbColor.focus()},0):setTimeout(function(){s.lbColorR.focus()},0);else{"#000000"==e&&(e="black"),e=e.toLowerCase(),parent.DEXTTOP.DEXT5.browser.LocalStorageSupported&&(t=parent.DEXTTOP.DEXTWIN.localStorage.getItem(parent.DEXTTOP.G_CURREDITOR.recentlyColorName),null!=t?(t=t.split(","),-1!=t.indexOf(e)&&t.splice(t.indexOf(e),1),t.unshift(e),9<t.length&&(t.reverse(),t.shift(),t.reverse()),parent.DEXTTOP.DEXTWIN.localStorage.setItem(parent.DEXTTOP.G_CURREDITOR.recentlyColorName,t)):parent.DEXTTOP.DEXTWIN.localStorage.setItem(parent.DEXTTOP.G_CURREDITOR.recentlyColorName,e)),void 0!==jscolor.styleColor||""!==jscolor.styleColor?jscolor.clickedElem.style[jscolor.styleColor]=e:(t=iframeDoc.createElement("input"),t.type="hidden",t.value=e,t.id="hidden_color",iframeDoc.body.appendChild(t));if(void 0!==jscolor.actionType||""!==jscolor.actionType)"font_color"==jscolor.actionType||"detail_font_color"==jscolor.actionType?parent.command_fontColor(parent.DEXTTOP.G_CURREDITOR.ID,parent.document.getElementById("dext5_design_"+parent.DEXTTOP.G_CURREDITOR.ID),e):"font_bg_color"==jscolor.actionType||"detail_font_bg_color"==jscolor.actionType?parent.command_fontBgColor(parent.DEXTTOP.G_CURREDITOR.ID,parent.document.getElementById("dext5_design_"+parent.DEXTTOP.G_CURREDITOR.ID),e):"doc_bg_color"==jscolor.actionType?parent.command_docBGColor(parent.DEXTTOP.G_CURREDITOR.ID,parent.document.getElementById("dext5_design_"+parent.DEXTTOP.G_CURREDITOR.ID),e):"cell_bg_color"==jscolor.actionType||"detail_cell_bg_color"==jscolor.actionType?parent.command_cellBGColor(parent.DEXTTOP.G_CURREDITOR.ID,parent.document.getElementById("dext5_design_"+parent.DEXTTOP.G_CURREDITOR.ID),e):"line_color"==jscolor.actionType&&jscolor.excuteFn&&jscolor.excuteFn();jscolor.clickedElem=null,jscolor.styleColor="",jscolor.actionType="",jscolor.excuteFn=null,parent.document.body.removeChild(parent.document.getElementById("dext_color_back")),parent.document.body.removeChild(parent.document.getElementById("popupCover"))}};s.btnOk.style.margin="0 2px 0 4px",s.btnOk.onkeydown=function(e){e=e?e:window.event;if(13==e.keyCode)return c(),!1},s.btnOk.onmousedown=c,s.lbColor2.style.margin="0 2px 0 0",s.bottom.style.margin="0 0 3px 6px";var h=function(){jscolor.clickedElem=null,jscolor.styleColor="",jscolor.actionType="",jscolor.excuteFn=null;var e=parent.document.getElementById("popupCover").style.height.replace("px",""),t={left:0,top:0,right:0,bottom:0},t=document.getElementById("color_picker").getBoundingClientRect(),t=parseInt(t.bottom,10)-parseInt(t.top,10);parent.document.getElementById("popupCover").style.height=e-t+"px",parent.onColorPicker({cmd:"more_close"}),document.getElementById("color_picker").style.display="none"};s.btnCancle.onkeydown=function(e){e=e?e:window.event,13==e.keyCode?h():0==e.shiftKey&&9==e.keyCode&&("hex"==s.select.value?setTimeout(function(){s.lbColor.focus()},0):"rgb"==s.select.value&&setTimeout(function(){s.lbColorR.focus()},0))},s.btnCancle.onmousedown=h;switch(y){case 0:var m="hs2.png";break;case 1:m="hv.png"}s.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')",s.padM.style.backgroundRepeat="no-repeat",s.pad.style.backgroundImage="url('"+jscolor.getDir()+m+"')",s.pad.style.backgroundRepeat="no-repeat",s.pad.style.backgroundPosition="0 0",f(),l(),jscolor.picker.owner=g,document.getElementsByTagName("body")[0].appendChild(s.boxB),"hex"==jscolor.picker.select.value?jscolor.picker.lbColor.focus():jscolor.picker.lbColorR.focus()}function a(e){return[2*e.pickerInset+2*e.pickerFace+jscolor.images.pad[0]+(e.slider?2*e.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),e.pickerClosable?4*e.pickerInset+3*e.pickerFace+jscolor.images.pad[1]+e.pickerButtonHeight:2*e.pickerInset+2*e.pickerFace+jscolor.images.pad[1]]}function f(){switch(y){case 0:var e=1;break;case 1:e=2}var t=Math.round(g.hsv[0]/6*(jscolor.images.pad[0]-1)),e=Math.round((1-g.hsv[e])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=g.pickerFace+g.pickerInset+t-Math.floor(jscolor.images.cross[0]/2)+"px "+(g.pickerFace+g.pickerInset+e-Math.floor(jscolor.images.cross[1]/2))+"px",t=jscolor.picker.sld.childNodes;switch(y){case 0:for(var n=o(g.hsv[0],g.hsv[1],1),e=0;e<t.length;e+=1)t[e].style.backgroundColor="rgb("+n[0]*(1-e/t.length)*100+"%,"+n[1]*(1-e/t.length)*100+"%,"+n[2]*(1-e/t.length)*100+"%)";break;case 1:var r,i=[g.hsv[2],0,0],e=Math.floor(g.hsv[0]),s=e%2?g.hsv[0]-e:1-(g.hsv[0]-e);switch(e){case 6:case 0:n=[0,1,2];break;case 1:n=[1,0,2];break;case 2:n=[2,0,1];break;case 3:n=[2,1,0];break;case 4:n=[1,2,0];break;case 5:n=[0,2,1]}for(e=0;e<t.length;e+=1)r=1-1/(t.length-1)*e,i[1]=i[0]*(1-r*s),i[2]=i[0]*(1-r),t[e].style.backgroundColor="rgb("+100*i[n[0]]+"%,"+100*i[n[1]]+"%,"+100*i[n[2]]+"%)"}}function l(){switch(y){case 0:var e=2;break;case 1:e=1}e=Math.round((1-g.hsv[e])*(jscolor.images.sld[1]-1)),jscolor.picker.sldM.style.backgroundPosition="0 "+(g.pickerFace+g.pickerInset+e-Math.floor(jscolor.images.arrow[1]/2))+"px"}function c(){return jscolor.picker&&jscolor.picker.owner===g}function h(){w!==e&&g.importColor()}function p(e){var t=jscolor.getRelMousePos(e);e=t.x-g.pickerFace-g.pickerInset,t=t.y-g.pickerFace-g.pickerInset;switch(y){case 0:g.fromHSV(6/(jscolor.images.pad[0]-1)*e,1-t/(jscolor.images.pad[1]-1),null,L);break;case 1:g.fromHSV(6/(jscolor.images.pad[0]-1)*e,null,1-t/(jscolor.images.pad[1]-1),L)}}function d(e){e=jscolor.getRelMousePos(e).y-g.pickerFace-g.pickerInset;switch(y){case 0:g.fromHSV(null,null,1-e/(jscolor.images.sld[1]-1),k);break;case 1:g.fromHSV(null,1-e/(jscolor.images.sld[1]-1),null,k)}}function v(){g.onImmediateChange&&("string"==typeof g.onImmediateChange?new Function(g.onImmediateChange):g.onImmediateChange).call(g)}jscolor.clickedElem=n,jscolor.styleColor=r,jscolor.actionType=i,jscolor.excuteFn=s,this.slider=this.caps=this.hash=this.adjust=this.required=!0,this.styleElement=this.valueElement=e,this.onImmediateChange=null,this.hsv=[0,0,1],this.rgb=[1,1,1],this.minH=0,this.maxH=6,this.minS=0,this.maxS=1,this.minV=0,this.maxV=1,this.pickerOnfocus=!1,this.pickerMode="HSV",this.pickerPosition="bottom",this.pickerSmartPosition=!1,this.pickerButtonHeight=0,this.pickerClosable=!1,this.pickerCloseText="Close",this.pickerButtonColor="ButtonText",this.pickerFace=6,this.pickerFaceColor="ThreeDFace",this.pickerBorder=1,this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight",this.pickerInset=1,this.pickerInsetColor="ThreeDShadow ThreeDShadow ThreeDShadow ThreeDShadow",this.pickerZIndex=15e3;for(var m in t)t.hasOwnProperty(m)&&(this[m]=t[m]);this.hidePicker=function(){c()&&(delete jscolor.picker.owner,document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB))},this.showPicker=function(){if(!c()){var t=jscolor.getElementPos(e),n=jscolor.getElementSize(e),r=jscolor.getViewPos(),i=jscolor.getViewSize(),s=a(this),o,f,l;switch(this.pickerPosition.toLowerCase()){case"left":o=1,f=0,l=-1;break;case"right":o=1,f=0,l=1;break;case"top":o=0,f=1,l=-1;break;default:o=0,l=f=1}var h=(n[f]+s[f])/2,t=this.pickerSmartPosition?[-r[o]+t[o]+s[o]>i[o]?-r[o]+t[o]+n[o]/2>i[o]/2&&0<=t[o]+n[o]-s[o]?t[o]+n[o]-s[o]:t[o]:t[o],-r[f]+t[f]+n[f]+s[f]-h+h*l>i[f]?-r[f]+t[f]+n[f]/2>i[f]/2&&0<=t[f]+n[f]-h-h*l?t[f]+n[f]-h-h*l:t[f]+n[f]-h+h*l:0<=t[f]+n[f]-h+h*l?t[f]+n[f]-h+h*l:t[f]+n[f]-h-h*l]:[t[o],t[f]+n[f]-h+h*l];u(t[o],t[f])}},this.importColor=function(){w?this.adjust?!this.required&&/^\s*$/.test(w.value)?(w.value="",E.style.backgroundImage=E.jscStyle.backgroundImage,E.style.backgroundColor=E.jscStyle.backgroundColor,E.style.color=E.jscStyle.color,this.exportColor(N|C)):this.fromString(w.value):this.fromString(w.value,N)||(E.style.backgroundImage=E.jscStyle.backgroundImage,E.style.backgroundColor=E.jscStyle.backgroundColor,E.style.color=E.jscStyle.color,this.exportColor(N|C)):this.exportColor()},this.exportColor=function(e){if(!(e&N)&&w){var t=this.toString(),n=t;this.caps&&(t=t.toUpperCase()),null!=jscolor.picker.lbColor&&(jscolor.picker.lbColor.value=t);if(null!=jscolor.picker.lbColorB){t=n.match(/[a-f\d]/gi),3==t.length&&(n=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var t=n.match(/[a-f\d]{2}/gi),n=parseInt(t[0],16),r=parseInt(t[1],16),t=parseInt(t[2],16);jscolor.picker.lbColorR.value=n,jscolor.picker.lbColorG.value=r,jscolor.picker.lbColorB.value=t}}e&C||!E||null==jscolor.picker.lbColor2||(jscolor.picker.lbColor2.style.backgroundColor="#"+this.toString()),e&k||!c()||f(),e&L||!c()||l()},this.fromHSV=function(e,t,n,r){null!==e&&(e=Math.max(0,this.minH,Math.min(6,this.maxH,e))),null!==t&&(t=Math.max(0,this.minS,Math.min(1,this.maxS,t))),null!==n&&(n=Math.max(0,this.minV,Math.min(1,this.maxV,n))),this.rgb=o(null===e?this.hsv[0]:this.hsv[0]=e,null===t?this.hsv[1]:this.hsv[1]=t,null===n?this.hsv[2]:this.hsv[2]=n),this.exportColor(r)},this.fromRGB=function(e,t,n,r){null!==e&&(e=Math.max(0,Math.min(1,e))),null!==t&&(t=Math.max(0,Math.min(1,t))),null!==n&&(n=Math.max(0,Math.min(1,n))),e=null===e?this.rgb[0]:e,t=null===t?this.rgb[1]:t;var i=null===n?this.rgb[2]:n,s=Math.min(Math.min(e,t),i);n=Math.max(Math.max(e,t),i);var u=n-s;0===u?e=[null,0,n]:(e=e===s?3+(i-t)/u:t===s?5+(e-i)/u:1+(t-e)/u,e=[6===e?0:e,u/n,n]),null!==e[0]&&(this.hsv[0]=Math.max(0,this.minH,Math.min(6,this.maxH,e[0]))),0!==e[2]&&(this.hsv[1]=null===e[1]?null:Math.max(0,this.minS,Math.min(1,this.maxS,e[1]))),this.hsv[2]=null===e[2]?null:Math.max(0,this.minV,Math.min(1,this.maxV,e[2])),e=o(this.hsv[0],this.hsv[1],this.hsv[2]),this.rgb[0]=e[0],this.rgb[1]=e[1],this.rgb[2]=e[2],this.exportColor(r)},this.fromString=function(e,t){var n="More".match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);return n?(6===n[1].length?this.fromRGB(parseInt(n[1].substr(0,2),16)/255,parseInt(n[1].substr(2,2),16)/255,parseInt(n[1].substr(4,2),16)/255,t):this.fromRGB(parseInt(n[1].charAt(0)+n[1].charAt(0),16)/255,parseInt(n[1].charAt(1)+n[1].charAt(1),16)/255,parseInt(n[1].charAt(2)+n[1].charAt(2),16)/255,t),!0):!1},this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var g=this,y="hvs"===this.pickerMode.toLowerCase()?1:0,b=!1,w=jscolor.fetchElement(this.valueElement),E=jscolor.fetchElement(this.styleElement),S=!1,x=!1,T={},N=1,C=2,k=4,L=8;jscolor.addEvent(e,"click",function(){g.showPicker()}),jscolor.addEvent(e,"blur",function(){b?b=!1:window.setTimeout(function(){b||(w===e&&g.importColor(),g.pickerOnfocus&&g.hidePicker()),b=!1},0)}),w&&(t=function(){g.fromString(w.value,N),v()},jscolor.addEvent(w,"keyup",t),jscolor.addEvent(w,"input",t),jscolor.addEvent(w,"blur",h),w.setAttribute("autocomplete","off")),E&&(E.jscStyle={backgroundImage:E.style.backgroundImage,backgroundColor:E.style.backgroundColor,color:E.style.color});switch(y){case 0:jscolor.requireImage("hs2.png");break;case 1:jscolor.requireImage("hv.png")}jscolor.requireImage("cross.gif"),jscolor.requireImage("arrow.gif"),this.importColor()}};parent.DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(e){parent.DEXTTOP.DEXT5.util.cancelEvent(e)}),jscolor.install();