function setDEXTWINwindow(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!1)}catch(e){DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0}}function setDEXTDOCdocument(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!1)}catch(e){DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0}}function DEXT5_EDITOR(e,t,n){G_PutUndoCharCount=t.undoCount,this.ID=e,this.Frame=n,this.FrameStatus="",this.FrameID=n.FrameID,DEXTTOP.DEXT5.DEXTMULTIPLE[n.FrameID]=this,DEXTTOP.G_CURREDITOR=this,this._config=t,this._newMode=this._currentMode="design",this._BODY=this._DOC=null,this._EDITOR={},this._defaultHeight="",this._setting={},this._top_menu_click_flag=!1,this._top_menu_click_id="",this._docType={},this.UndoManager=new UndoManager,this.WordCountUndoManager=new UndoManager,this.baseMenuToolbarHeight=0,this._PageProp={},this.remove_item=[],this.remove_context_item=[],this.____={},this._LastRange=null,this._RangeBlurBug=!1,this._defaultWidth=this._defTableWidth=0,this._dextCustomData=[],this._dextframeHasFocus=this._dextCustomDataMode=!1,this.changeMultiValue={valueLength:0},this._FRAMEWIN=window,this._formatPainterList=null,this._contentsClass=["dext5_bookmark"],_R_O_+="/",_R_O_+="=",G_MAIN_ZINDEX=t.zIndex,this.setImageArr=[],this.setElementsArr=[],this.sTextareaArr=[],this.applyEdgeMode=this.violationNode=this._editingCheckedValue=null,this._configXml=n.configXml,this.ShowBlocks="",this.lastElemForLock=this.dext_dragresize=null,this.Toolbar_group=[[],[]],this.detailSubCmd="list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman list_disc list_circle list_square list_none".split(" "),this.initPaste=!0,this.imageForPhotoEditor=null,this.initSetSize=!0,this.groupingBoxOpen=this.isOccurredResizeEvent=!1,this.dialogWindow=null!=DEXTTOP.DEXT5.config.DialogWindow?DEXTTOP.DEXT5.config.DialogWindow:null,null!=this.dialogWindow&&(this.dialogWindow.DEXTWIN=DEXTTOP.DEXTWIN,this.dialogWindow.DEXTDOC=DEXTTOP.DEXTDOC,this.dialogWindow.G_CURREDITOR=DEXTTOP.G_CURREDITOR),this.topStatusBarTitleIdx=this.statusBarTitleIdx=0,this.setTextPaste=!1,this.setTextPasteMode="0",this.iconEnableCommandType=this.dextResize=null,this.lockCommand=[],this.toolmenu_bg_resize=function(){return function(e){try{var t="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,n="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,r=DEXTTOP.DEXTDOC.getElementById("dext_toolmenu_background"+_dext_editor.ID);r.firstChild.style.width=t+"px",r.firstChild.style.height=n+"px"}catch(i){}}}(),this.topmenu_bg_resize=function(){return function(e){try{var t="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,n="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,r=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+_dext_editor.ID);r.firstChild.style.width=t+"px",r.firstChild.style.height=n+"px"}catch(i){}}}(),this.context_bg_resize=function(){return function(e){try{getDialogWindow();var t=getDialogDocument(),n="CSS1Compat"==t.compatMode?t.documentElement.scrollWidth:t.body.scrollWidth,r="CSS1Compat"==t.compatMode?t.documentElement.scrollHeight:t.body.scrollHeight,i=t.getElementById("dext_context_background");i&&(i.firstChild.style.width=n+"px",i.firstChild.style.height=r+"px")}catch(s){}}}(),this.isInitFocusHandler=!0,this.mouseDropPosition={clientX:null,clientY:null},this.ShowTableBorder=!1,this.selectionDextmark=[],this.isUseApplyFormat=!1,this.strOldSaveFileName="",this.pluginInstallGuidePopup=this.beforeOffset=null,this.bTextorHtmlData=this.isInitKeydownForSetApi=!1,this.pasteEvt=this.clipImageBlob=null,this.clipData="";try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.languageDefinition?DEXTTOP.G_CURREDITOR._config.event.languageDefinition(dext5_lang,e):DEXTTOP.DEXTWIN.dext_editor_language_definition_event(dext5_lang,e)}catch(r){}this.isStopScroll=!1,this.previousScrollTop=0,this.preventScrollMove={use:!1,beforeTop:0,beforeLeft:0},this.xhr_onprogress=null;if("undefined"==typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG)this.lastDateType=null;else try{this.lastDateType=DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG.dateTime.common_date[0]}catch(i){this.lastDateType=""}this.recentlyColorName="dextRecentlyColor",this.recentlyFontName="dextRecentlyFont",this.DEXT5WordDoc=this.DEXT5WordApp=null,this.checkEnterKeyTargetTagArr="li h1 h2 h3 h4 h5".split(" "),this.isEnterKeyInTargetTag=!1,this.changeDivTagArr=[],this.isClickedMiniPhoto=this.miniPhotoLastMode=this.dextiframeKeydown=!1,this.keydownStyleForIOS={currStyle:null,fontSize:""},this.defaultTableTemplateTab=this.keydownInputText="",this.isInitBodyAutoFit=!0,this.keydownNodeForTableCaret={tdNode:null,backupRange:null},this.useFocusDivForIOS=DEXTTOP.DEXT5.browser.iOS?!0:!1,this.pasteTableParam={tableNode:null,tableHtml:"",currTableNode:null,currCellNode:null},this.isTablePaste=this.AccessClipboardForIEGecko=!1,this.autoMoveInitFocusData={targetDocument:null,targetNode:null,targetNodeEx:null},this.insertBrNodes=[],this.backupWidthForIOS={backupWidth:"",isPopup:!1},this.hasFontNodeInPasteHtml=!1,this.relativeNode=[],this.isAOver={over:!1,node:null,nodeChild:null,openHelp:!1,linkStyle:!1,timer:null,addTarget:!1},this.disableUndoRedo=!1,this.lastCellForUndoManager=null,this.autoListUse="",this.fixDEXTWINScroll={keyCodeArr:[33,34],backupValue:null,fn:function(){DEXTTOP.DEXTWIN.scrollTo(DEXTTOP.G_CURREDITOR.fixDEXTWINScroll.backupValue.left,DEXTTOP.G_CURREDITOR.fixDEXTWINScroll.backupValue.top)}}}function event_dext_image_upload(e,t,n,r,i,s,o,u,a,f,l){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),i,s,o,u,a,f),f.continueInsert?(saveSelection(G_USE_EDITOR_ID),e=l.getElementsByTagName("iframe")[0],"1"==DEXTTOP.G_CURREDITOR._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?e.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content2:e.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content,e.contentWindow.G_dragDropFileObj=null):e.contentWindow.document.getElementById("image_url").value="",e.contentWindow.document.getElementById("Filedata").value="",1==e.contentWindow.document.getElementById("radio_image_url").checked&&(e.contentWindow.document.getElementById("img_web_url").value="http://"),s=e.contentWindow.document.getElementById("img_width"),o=e.contentWindow.document.getElementById("img_height"),s.value="",o.value="",t=e.contentWindow.document.getElementById("img_id"),null!=t&&void 0!=t&&(t.value=""),e.contentWindow.document.getElementById("maintain_value").checked||(t=e.contentWindow.document.getElementById("img_class"),null!=t&&void 0!=t&&(t.value=""),e.contentWindow.document.getElementById("img_title").value="",e.contentWindow.document.getElementById("img_alt").value="",e.contentWindow.document.getElementById("img_margin_left").value="",e.contentWindow.document.getElementById("img_margin_right").value="",e.contentWindow.document.getElementById("img_margin_top").value="",e.contentWindow.document.getElementById("img_margin_bottom").value="",e.contentWindow.document.getElementById("img_align").value="",t=e.contentWindow.document.getElementById("original_size"),null!=t&&void 0!=t&&1==t.checked&&(s.removeAttribute("disabled"),o.removeAttribute("disabled")),e.contentWindow.document.getElementById("image_spacing")&&(e.contentWindow.document.getElementById("image_spacing").checked=!1),s=e.contentWindow.document.getElementById("link_url"),o=e.contentWindow.document.getElementById("link_title"),t=e.contentWindow.document.getElementById("link_target"),null!=s&&void 0!=s&&(s.value="http://"),null!=o&&void 0!=o&&(o.value=""),null!=t&&void 0!=t&&(t.value="_blank"),s=e.contentWindow.document.getElementById("line_style"),null!=s&&void 0!=s&&e.contentWindow.setBorderListValue("solid",s),s=e.contentWindow.document.getElementById("line_kind"),null!=s&&void 0!=s&&(s.value=""),s=e.contentWindow.document.getElementById("line_color"),null!=s&&void 0!=s&&(s.style.borderTopColor="#000000"),s=e.contentWindow.document.getElementById("line_thickness"),null!=s&&void 0!=s&&(s.value="0"),e.contentWindow.popup_toggle(0))):hideDialog(l)}function event_dext_flash_upload(e,t,n,r,i,s,o,u){command_InsertMedia(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),s,o),hideDialog(u)}function event_dext_media_upload(e,t,n,r,i,s,o,u){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),o),hideDialog(u)}function event_dext_detail_table_insert(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,L,A,O,M,_,D,P),hideDialog(k)}function event_dext_detail_table_insert_new(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,M),hideDialog(O)}function event_dext_table_property(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){command_InsertTableProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,w,E,S,x,T),hideDialog(b)}function event_dext_cell_property(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){command_InsertCellProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r,i,s,o,u,a,f,l,c,h,d,v,m,g,y),hideDialog(p)}function event_dext_cell_border(e,t,n,r,i){command_InsertCellBorder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r),hideDialog(i)}function event_dext_dog_bg_img_insert(e,t,n,r,i,s,o){command_InsertDogBGImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r,i,o),hideDialog(s)}function event_dext_emoticon_insert(e,t){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),"","","","","",e),hideDialog(t)}function event_dext_insert_row_column(e,t,n,r){command_InsertRowColumn(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n),hideDialog(r)}function event_dext_setting(e,t){command_editorSetting(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_horizontal_line(e,t,n,r){command_insertHorizontalLine(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n),hideDialog(r)}function event_dext_row_property(e,t,n,r,i){command_RowProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r),hideDialog(i)}function event_dext_column_property(e,t,n,r,i){command_ColumnProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,r),hideDialog(i)}function event_dext_bookmark_add(e,t){command_InsertBookmark(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t)}function event_dext_create_iframe(e,t){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_create_hyperlink(e,t){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_split_cell(e,t,n){command_InsertSplitCell(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t),hideDialog(n)}function event_dext_symbol(e,t){command_InsertSymbol(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_template(e,t){0!=e.url.toLowerCase().indexOf("http:")&&0!=e.url.toLowerCase().indexOf("https:")&&0!=e.url.toLowerCase().indexOf("/")&&(e.url=DEXTTOP.DEXT5.rootPath+e.url);var n=DEXTTOP.DEXT5.ajax.load(e.url);null!=n&&(n=removeCarriageReturn(DEXTTOP.G_CURREDITOR,n),setHtmlValueToEditor(n),"1"==DEXTTOP.G_CURREDITOR._config.ruler.use&&"1"==DEXTTOP.G_CURREDITOR._config.autoBodyFit&&(n=parseIntOr0(DEXTTOP.G_CURREDITOR._setting.ruler_position),"1"==DEXTTOP.G_CURREDITOR._config.defaultBodySpace.use&&(n-=parseIntOr0(DEXTTOP.G_CURREDITOR._config.defaultBodySpace.configValue.left)),DEXTTOP.G_CURREDITOR._BODY.style.wordWrap="break-word",DEXTTOP.G_CURREDITOR._BODY.style.width=n+"px"),setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR),setCssForFormMode(DEXTTOP.G_CURREDITOR)),DEXTTOP.G_CURREDITOR._config.printHeader="null"!=e.print_header?e.print_header:DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter="null"!=e.print_footer?e.print_footer:DEXTTOP.G_CURREDITOR._config.basePrintFooter,hideDialog(t)}function event_dext_layout(e,t){var n=DEXTTOP.DEXT5.ajax.load(DEXTTOP.DEXT5.rootPath+"pages/layout/layout"+e.num+".html");null!=n&&DEXTTOP.DEXT5.setHtmlValueEx(n,G_USE_EDITOR_ID),hideDialog(t)}function event_dext_upload_cancel(e){hideDialog(e,{isCancel:!0})}function event_dext_find(e,t,n,r,i,s){command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,r,i,n)}function event_dext_replace(e,t,n,r,i,s,o){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,i,s,r,o)}function event_dext_all_replace(e,t,n,r,i,s,o,u){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n,i,s,r,o,u)}function event_dext_spellcheck_find(e){return command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,!0,!1,!0,!1,!1)}function event_dext_spellcheck_replace(e,t){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,!0,!1,!0,!1,!0)}function event_dext_spellcheck_all_replace(e,t){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,!0,!1,!0,!1,!0)}function event_dext_capital_small_letter(e,t){command_changeWordUpperLower(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e)}function event_dext_insert_link_media(e,t,n,r){e=getCustomParam(e,{forceFullSreenAllow:n}),t&&""!=t&&(e.caption=t),command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(r)}function event_dext_modify_link_media(e,t,n,r,i){e=getCustomParam(e,{forceFullSreenAllow:n}),t&&""!=t&&(e.caption=t),command_ModifyReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,r),hideDialog(i)}function event_dext_insert_paste_dialog_html(e,t){command_InsertPasteDialogHtml(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_file(e,t){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e);if(e.continueInsert){var n=t.getElementsByTagName("iframe")[0];"1"==DEXTTOP.G_CURREDITOR._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?n.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content2:n.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content,n.contentWindow.G_dragDropFileObj=null):n.contentWindow.document.getElementById("image_url").value="",n.contentWindow.document.getElementById("Filedata").value="",n.contentWindow.document.getElementById("file_text_view").value="",n.contentWindow.document.getElementById("input_id").value="",n.contentWindow.document.getElementById("input_class").value="",n.contentWindow.document.getElementById("file_title").value=""}else hideDialog(t)}function event_dext_insert_open_file(e,t){command_InsertOpenFile(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_blockquote(e,t){command_InsertBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_cancel_blockquote(e){command_CancelBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID)),hideDialog(e)}function event_dext_insert_input_text(e,t){command_InsertInputText(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_input_radio_or_checkbox(e,t){command_InsertInputRadioOrCheckbox(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_input_button(e,t){command_InsertInputButton(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_input_select(e,t){command_InsertInputSelect(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_input_textarea(e,t){command_InsertInputTextarea(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_input_hidden(e,t){command_InsertInputHidden(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_input_image(e,t){command_InsertInputImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_setAccessibility(e,t,n){command_setAccessibility(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,t,n)}function event_dext_create_conversion(e,t){command_InsertConversion(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_video_upload(e,t,n,r,i,s,o,u){command_InsertVideo(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),s,o),hideDialog(u)}function event_dext_calculator(e,t){command_InsertCalculator(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_insert_placeholder(e,t){command_InsertPlaceholder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_load_auto_save_open(e,t,n){return getAutoSaveHtml_userID(e,t,n)}function event_dext_load_auto_save(e,t){command_loadAutoSave(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_load_auto_save_del(e,t,n,r){delAutoSaveHtml(e,t,r)||DEXTTOP.G_CURREDITOR._iconEnable("")}function event_dext_paragraph_attribute(e,t){command_ParagraphAttribute(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),hideDialog(t)}function event_dext_paste_table(e,t){DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.removeAttribute("DEXT5CellSelected");for(var n=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.rows,r=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.rows.length,i=0;i<r;i++)for(var s=n[i].cells,o=n[i].cells.length,u=0;u<o;u++)"true"==s[u].getAttribute("dext_select")&&(s[u].style.backgroundColor=s[u].getAttribute("cellOrgBgColor"),removeAttribute(s[u],"cellOrgBgColor"),removeAttribute(s[u],"dext_select"));DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.outerHTML;switch(e.type){case"paste_table":"1"==DEXTTOP.G_CURREDITOR._config.pasteWhenTableIsLast&&(DEXTTOP.G_CURREDITOR.isTablePaste=!0),DEXTTOP.DEXT5.setInsertHTML(DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml,DEXTTOP.G_CURREDITOR.ID);break;case"paste_table_contents":command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode);break;case"paste_table_right":command_AddTableLeftAndRight(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"right");break;case"paste_table_left":command_AddTableLeftAndRight(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"left");break;case"paste_table_up":command_AddTableUpAndDown(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"up");break;case"paste_table_down":command_AddTableUpAndDown(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"down")}DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml="",DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=null,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=null,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=null,hideDialog(t)}function event_dext5plugin_action(e,t){command_PluginAction(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e),1==e.closeDialog&&hideDialog(t)}function onlyNumberAndNegative(e){isNaN(new Number(e.value))&&"-"!=e.value&&(isNaN(new Number(DEXTTOP.G_CURREDITOR.keydownInputText))?e.value="":e.value=DEXTTOP.G_CURREDITOR.keydownInputText)}function onlyNumber(e){window.netscape?34<e.which&&41>e.which||47<e.which&&58>e.which||95<e.which&&106>e.which||8==e.which||9==e.which||13==e.which||46==e.which||DEXTTOP.DEXT5.util.cancelEvent(e):34<e.keyCode&&41>e.keyCode||47<e.keyCode&&58>e.keyCode||95<e.keyCode&&106>e.keyCode||8==e.keyCode||9==e.keyCode||13==e.keyCode||46==e.keyCode||DEXTTOP.DEXT5.util.cancelEvent(e)}function locationDialog(e){setFocusTopWindow();var t=getDialogWindow(),n=getDialogDocument(),r=n.createElement("div");r.setAttribute("id","dext_disabled"),r.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1e3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;" oncontextmenu="return false;"></div>',r.style.overflow="visible";var i="100%",s="100%",i=DEXTTOP.G_CURREDITOR._config.popupBackgroundHolderId,o=null;""!=i&&(o=n.getElementById(i));if(null!=o){var u=getClientRect(o);o.clientWidth?(i=o.clientWidth,s=o.clientHeight):(i=u.right-u.left,s=u.bottom-u.top);if("absolute"==o.style.position)r.firstChild.style.top="0px",r.firstChild.style.left="0px";else{var a=0,f=0;try{DEXTTOP.DEXT5.browser.ie?(a=Math.max(n.documentElement.scrollLeft,n.body.scrollLeft),f=Math.max(n.documentElement.scrollTop,n.body.scrollTop)):(a=t.scrollX,f=t.scrollY)}catch(l){}r.firstChild.style.top=f+u.top+"px",r.firstChild.style.left=a+u.left+"px"}}else i="CSS1Compat"==n.compatMode?n.documentElement.scrollWidth:n.body.scrollWidth,s="CSS1Compat"==n.compatMode?n.documentElement.scrollHeight:n.body.scrollHeight;r.firstChild.style.width=i+"px",r.firstChild.style.height=s+"px",null!=o&&"absolute"==o.style.position?o.appendChild(r):n.body.appendChild(r),DEXTTOP.DEXT5.util.addEvent(t,"resize",setLayerbgResize),DEXTTOP.DEXT5.util.addEvent(r,"dragover",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),DEXTTOP.DEXT5.util.addEvent(r,"drop",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),e.style.display="block",e.style.zIndex=G_MAIN_ZINDEX+2e3,e.style.position="absolute",o={},o=getWindowClientSize(t),n={},n=getWindowScrollPos(t),r=e.getElementsByTagName("iframe")[0],i=e.getElementsByTagName("div")[2],r&&i&&(DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(i.style.position=r.style.position),i.style.left=r.style.left,i.style.right=r.style.right,i.style.width=r.style.width,i.style.height=r.style.height),r=e.clientWidth,0==r&&(r=386),i=e.clientHeight;if("1"==DEXTTOP.G_CURREDITOR._config.showDialogPosition){o=getClientRect(_iframeWin.parent.frameElement),i=getClientRect(_iframeWin.frameElement),u=s=0;if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(a=_iframeWin.parent.parent;a!=t;)f=getClientRect(a.frameElement),s+=f.left,u+=f.top,a=a.parent;e.style.left=n[0]+o.left+s+((i.right-i.left)/2-r/2)+"px",e.style.top=n[1]+o.top+i.top+u+10+"px"}else e.style.left=n[0]+o[0]/2-r/2+"px",e.style.top=n[1]+o[1]/2-i/2+"px";makeDragPopup(e)}function localToGlobal(e){var t=e.offsetWidth,n=e.offsetHeight,r=0,i=0,s={},o=function(u){if(!u)return s={top:e.offsetTop+i,left:e.offsetLeft+r,bottom:e.offsetTop+i+n,right:e.offsetLeft+r+t};r+=u.offsetLeft,i+=u.offsetTop,o(u.offsetParent)};return o(e.offsetParent),s}function setLayerbgResize(){var e=getDialogDocument(),t=e.getElementById("dext_disabled"),n=DEXTTOP.G_CURREDITOR._config.popupBackgroundHolderId,r=null;""!=n&&(r=e.getElementById(n)),r?r.clientWidth?(n=r.clientWidth,e=r.clientHeight):(e=getClientRect(r),n=e.right-e.left,e=e.bottom-e.top):(n="CSS1Compat"==e.compatMode?e.documentElement.scrollWidth:e.body.scrollWidth,e="CSS1Compat"==e.compatMode?e.documentElement.scrollHeight:e.body.scrollHeight),t.firstChild.style.width=n+"px",t.firstChild.style.height=e+"px"}function hideDialog(e,t){dialogCancel();var n=getDialogWindow(),r=getDialogDocument();_dext_editor.violationNode&&(removeClassName(_dext_editor.violationNode,"DEXT_accessibility"),_dext_editor.violationNode=null,DEXTTOP.DEXT5.setEditorChangeMode("source",_dext_editor.ID),DEXTTOP.DEXT5.setEditorChangeMode("design",_dext_editor.ID));var i=r.getElementById("dext_disabled");if(null!=i){DEXTTOP.DEXT5.util.removeEvent(n,"resize",setLayerbgResize),e.style.display="none";var s=e.getElementsByTagName("iframe")[0];s.style.width="10px",s.style.height="10px",i.parentElement.removeChild(i);if("hyperlink_property"==G_LAST_CMD||"hyperlink_create"==G_LAST_CMD)try{DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,1)}catch(o){}DEXTTOP.G_SELECTED_ELEMENT=null,DEXTTOP.DEXT5.util.removeEvent(r,"keyup",press_enter_esc_btn),setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});if(!t||!t.isCancel){var e=s.contentWindow.location.href.split(".")[0];try{e=e.split("/"),e=e[e.length-1],e=e.replace("editor_","")}catch(n){}onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:e})}},100)}}function getWindowClientSize(e){var t=0,n=0;return"number"==typeof e.innerWidth?(t=e.innerWidth,n=e.innerHeight):e.document.documentElement&&(e.document.documentElement.clientWidth||e.document.documentElement.clientHeight)?(t=e.document.documentElement.clientWidth,n=e.document.documentElement.clientHeight):e.document.body&&(e.document.body.clientWidth||e.document.body.clientHeight)&&(t=e.document.body.clientWidth,n=e.document.body.clientHeight),[t,n]}function getWindowScrollPos(e){return"number"==typeof e.pageYOffset?[e.pageXOffset,e.pageYOffset]:e.document.body&&(e.document.body.scrollLeft||e.document.body.scrollTop)?[e.document.body.scrollLeft,e.document.body.scrollTop]:e.document.documentElement&&(e.document.documentElement.scrollLeft||e.document.documentElement.scrollTop)?[e.document.documentElement.scrollLeft,e.document.documentElement.scrollTop]:[0,0]}function _MD(e){if(isLeftClick(e)){var t=null,t=e.target?e.target:e.srcElement,t=t.parentElement;e=getMousePosition(e),_startXY.X=e.X-parseIntOr0(t.style.left),_startXY.Y=e.Y-parseIntOr0(t.style.top)}}function _MM(e){if(isLeftClick(e)){var t=getMousePosition(e),n=null,n=e.target?e.target:e.srcElement,n=n.parentElement;n.style.left=t.X-_startXY.X+"px",n.style.top=t.Y-_startXY.Y+"px"}DEXTTOP.DEXT5.util.cancelEvent(e)}function _MU(e){}function click_plus_func(e,t,n,r){n=parseIntOr0(e.value,10)+parseIntOr0(n,10),e.value="number"==typeof t?n>t?t:n:n,r&&r()}function click_minus_func(e,t,n,r,i){n=parseIntOr0(e.value,10)-parseIntOr0(n,10),e.value="number"==typeof t?n<t?t:n:n,void 0!==r&&1==r&&n<t&&(e.value=""),i&&i()}function elementIndexOf(e,t){for(var n,r=document.getElementsByName(t),i=r.length,s=0;s<i;s++)if(r[s]==e){n=s;break}return n}function getElementsByClass(e,t,n){var r=[];null==t&&(t=document),null==n&&(n="*"),t=t.getElementsByTagName(n),n=t.length,e=new RegExp("(^|\\s)"+e+"(\\s|$)");for(j=i=0;i<n;i++)try{e.test(t[i].className)&&(r[j]=t[i],j++)}catch(s){}return r}function getElementsById(e,t,n){var r=[];null==t&&(t=document),null==n&&(n="*"),t=t.getElementsByTagName(n),n=t.length;for(j=i=0;i<n;i++)t[i].id==e&&(r[j]=t[i],j++);return r}function getIframeWin(){return _iframeWin}function getIframeDoc(){return _iframeDoc}function isCustomDomain(e){if(!DEXTTOP.DEXT5.browser.ie)return!1;var t=e.domain;e=getDocWindow(e).location.hostname;var n=!1;try{n=dext5EnforceDocumentDomain}catch(r){}return 1==!!n||t!=e&&t!="["+e+"]"}function getDocWindow(e){return e.parentWindow||e.defaultView}function getIframeDocument(e){return"undefined"!=typeof e.contentDocument?e.contentDocument:"undefined"!=typeof e.contentWindow?e.contentWindow.document:null}function getIframeWindow(e){return"undefined"!=typeof e.contentWindow?e.contentWindow:"undefined"!=typeof e.contentDocument?e.contentDocument.defaultView:null}function createPopupIframe(e,t,n,r,i,s,o,u,a,f,l){var c=e.createElement("div");c.id=t,c.className=n,c.style.position="absolute",c.style.zIndex=r,c.style.width=i,c.style.height=s,c.style.display=o,n=e.createElement("iframe"),n.frameBorder=0,n.style.top="0px",n.style.position="absolute",n.style.left="0px",n.width="100%",n.height="100%",n.scrolling="no",n.title=t,1==u&&(n.allowTransparency=!0),c.appendChild(n),e.body.appendChild(c),t="",void 0===a||""==a?(t="document.open();"+(isCustomDomain(e)?'document.domain="'+e.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":""):t=a,n.src=t,t=getIframeDocument(n);if(void 0===a||""==a)a="<html><head><title>"+_dext_editor._config.system_title+' Editor Popup Window</title></head><body style="padding:0; margin:0;"></body></html>',t.open("text/html","replace"),isCustomDomain(e)&&(t.domain=e.domain),t.write(a),t.close(),1==u&&(t.body.style.backgroundColor="transparent");e=t.getElementsByTagName("head")[0],a=f.length;for(u=0;u<a;u++)r=t.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=f[u],e.appendChild(r);t=getIframeDocument(n),e=t.getElementsByTagName("head")[0],f=l.length;for(u=0;u<f;u++)a=t.createElement("script"),a.type="text/javascript",a.src=l[u],e.appendChild(a);return l={},l.layer=c,l.iframe=n,l.iframeDoc=getIframeDocument(n),l.iframeWin=getIframeWindow(n),l}function showColorPopup(e,t,n,r,i,s,o){var u=onColorPicker({cmd:"before",targetDoc:e,clickedElem:t,styleColor:n,actionType:r,leftX:i,topY:s,excuteFn:o});void 0!=u&&null!=u.clickedElem&&(t=u.clickedElem);var a="",u="";DEXTTOP.DEXT5.isRelease?(a=_dext_editor._config.webPath.css,u=_dext_editor._config.webPath.js):(a=_dext_editor._config.webPath.css_dev,u=_dext_editor._config.webPath.js_dev);var a="3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=_dext_editor._config.lang?a+("editor_"+DEXTTOP.DEXT5.config.UseLang+".css"):a+"editor.css",a=a+("?ver="+DEXTTOP.DEXT5.ReleaseVer),f=createPopupIframe(e,"popupCover","",G_MAIN_ZINDEX+2e3,"165px","300px","block",!0,"",[a],[u+"jscolor/jscolor.js"]),l=e.createElement("div");l.setAttribute("id","dext_color_back"),l.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1e3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>',u="CSS1Compat"==e.compatMode?e.documentElement.scrollHeight:e.body.scrollHeight,l.firstChild.style.width=("CSS1Compat"==e.compatMode?e.documentElement.scrollWidth:e.body.scrollWidth)+"px",l.firstChild.style.height=u+"px",e.body.appendChild(l),l.onclick=function(){e.body.removeChild(e.getElementById("popupCover")),e.body.removeChild(l),dialogCancel()};var a=getClientRect(t),u=t.ownerDocument||t.document||e,c;"undefined"!=typeof u.defaultView?c=u.defaultView:"undefined"!=typeof u.parentWindow&&(c=u.parentWindow);var h=getDocWindow(e),p=null;c!==h&&(p=getClientRect(c.frameElement)),null==i&&(i=0),null==s&&(s=0),0==a.left&&(a=getClientRect(t)),DEXTTOP.G_CURREDITOR._config.userColorPicker&&""!=DEXTTOP.G_CURREDITOR._config.userColorPicker&&(G_BASE_COLOR_PICKER=DEXTTOP.G_CURREDITOR._config.userColorPicker.split(","));var d=f.iframeDoc,v=f.iframeWin,m=G_BASE_COLOR_PICKER,g;if("detail_font_bg_color"==r){var y=d.createElement("div");y.setAttribute("class","color"),y.setAttribute("id","removeBgColor"),y.style.display="block",y.style.textAlign="center",y.style.lineHeight="24px",y.style.backgroundColor="#ffffff",y.style.color="#5d5d5d",y.style.fontSize="11px",y.style.overflow="hidden",y.style.cursor="pointer",y.style.widh="150px",y.style.height="20px",y.style.margin="5px 5px 0 5px",_a_tag=d.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.style.width="150px",_a_tag.style.height="20px",_a_tag.style.display="block",_a_tag.style.textDecoration="none",_a_tag.style.color="#5d5d5d",_a_tag.innerText=dext5_lang.color_picker.remove_bg_Color,y.appendChild(_a_tag);var b=function(e){return function(t){T("",e),DEXTTOP.DEXT5.util.stopEvent(t)}}("removeBgColor");DEXTTOP.DEXT5.util.addEvent(y,"click",b)}var w=m.length,u=d.createElement("ul");u.setAttribute("id","color_ul"),DEXTTOP.DEXT5.util.setClass(u,"dext_color"),"cssFloat"in u.style?u.style.cssFloat="left":u.style.styleFloat="left";for(var E=0;E<w;E++){var S="",S="cp_"+G_USE_EDITOR_ID+"_"+E;g=d.createElement("li"),g.setAttribute("id",S),g.setAttribute("title",m[E]),g.style.fontSize="1pt";var x="12px";DEXTTOP.DEXT5.browser.mobile&&(x="24px"),g.style.width=x,g.style.height=x,"cssFloat"in g.style?g.style.cssFloat="left":g.style.styleFloat="left",g.style.padding="2px",g.style.margin="-1px 0 0 -1px",g.style.border="1px solid #fff",g.style.cursor="pointer",g.style.listStyleType="none",g.style.backgroundColor=m[E],_a_tag=d.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.style.width=x,_a_tag.style.height=x,_a_tag.style.display="block",_a_tag.title=m[E],g.appendChild(_a_tag);var T=function(i,s){S=s?s:3<i.length?i:m[i],"#000000"==S&&(S="black");var u=S;if(""!==n||void 0!==n){t.style[n]=S,0==DEXTTOP.DEXT5.browser.ie&&h.focus(),e.body.focus(),t.parentNode.focus(),void 0!==r&&("doc_bg_color"==r?command_docBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),S):"detail_cell_bg_color"==r?(isGroupingIcon(G_USE_EDITOR_ID,"cell_bg_color")&&hideGroupingBox(),command_cellBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),S),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:r})):"line_color"==r?o&&o():"detail_font_color"==r?(isGroupingIcon(G_USE_EDITOR_ID,"font_color")&&hideGroupingBox(),command_fontColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),S)):"detail_font_bg_color"==r?(isGroupingIcon(G_USE_EDITOR_ID,"font_bg_color")&&hideGroupingBox(),"removeBgColor"==S?command_removeBackgroundColor(G_USE_EDITOR_ID,DEXTTOP.G_CURREDITOR):command_fontBgColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),S)):"custom_color"==r&&t.onchange&&t.onchange()),e.body.removeChild(l),e.body.removeChild(e.getElementById("popupCover"));if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&"removeBgColor"!=u){var a=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName);null==a?DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyColorName,u):(a=a.split(","),-1<a.indexOf(u)&&a.splice(a.indexOf(u),1),a.unshift(u),9<a.length&&(a.reverse(),a.shift(),a.reverse()),DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyColorName,a.toString()))}}},b=function(e){return function(t){T(e),DEXTTOP.DEXT5.util.stopEvent(t)}}(E);DEXTTOP.DEXT5.util.addEvent(g,"click",b),g.onmousedown=function(){return!1},g.unselectable="on",b=function(e,t,n){return function(n){function r(e,t,r){e.getElementsByTagName("li")[t+r]&&(e.getElementsByTagName("li")[t+r].getElementsByTagName("a")[0]&&e.getElementsByTagName("li")[t+r].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(n))}var i="which"in n?n.which:n.keyCode;37==i?r(e,t,-1):39==i?r(e,t,1):38==i?r(e,t,-14):40==i&&r(e,t,14)}}(u,E),DEXTTOP.DEXT5.util.addEvent(_a_tag,"keydown",b),u.appendChild(g)}u.style.width="158px",u.style.paddingLeft="5px",u.style.paddingTop="5px",u.style.paddingRight="0",u.style.paddingBottom="0",u.style.margin="0px",u.style.backgroundColor="#fbfbfb";var N=/msie ([0-9]{1,}[.0-9]{0,})/;null!=N.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(u.style.width="210px"),g=d.createElement("div"),g.style.margin="0px 0px 0px 0px",g.style.padding=DEXTTOP.DEXT5.browser.mobile&&"tablet"!=DEXTTOP.DEXT5.UserAgent.device.type?"5px 0px 3px 5px":"5px 0px 0px 5px",g.style.display="block";if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&null!=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName)){w=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName).split(","),b=d.createElement("div"),b.style.padding="0",b.style.margin="0 0 5px 0",b.style.fontSize="0px",b.style.height="1px",b.style.width="151px",b.style.backgroundColor="#c5c5c5",g.appendChild(b),b=d.createElement("div"),b.innerHTML=dext5_lang.color_picker.recently_used_color,b.className="DEXT_fiVe_EdiTor_font",b.style.color="#5d5d5d",b.style.fontSize="11px",g.appendChild(b);for(var E=w.length,C=0;C<E;C++){var k=d.createElement("span");k.setAttribute("id","recentlyColor_"+C),k.style.width=x,k.style.height=x,k.style.border="1px solid #fff",k.style.display="inline-block",k.style.margin="2px 0px 0px -1px",k.style.padding="2px",k.setAttribute("title",w[C]),_a_tag=d.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.style.width=x,_a_tag.style.height=x,_a_tag.style.display="block",k.appendChild(_a_tag),k.style.backgroundColor=w[C],b=function(e){return function(t){T("",e),DEXTTOP.DEXT5.util.stopEvent(t)}}(w[C]),DEXTTOP.DEXT5.util.addEvent(k,"click",b),g.appendChild(k)}}if((!DEXTTOP.DEXT5.browser.mobile||"tablet"==DEXTTOP.DEXT5.UserAgent.device.type)&&"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code){var L=d.createElement("div");L.setAttribute("class","color"),L.setAttribute("id","more_btn"),L.style.cursor="pointer",L.style.width="150px",L.style.height="20px",L.style.overflow="hidden",L.style.fontSize="11px",L.style.color="#5d5d5d",L.style.lineHeight="20px",L.style.display="block",L.style.textAlign="center",L.style.autoComplete="off",L.style.marginBottom="5px",L.style.marginTop="5px",_a_tag=d.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.style.width="146px",_a_tag.style.height="16px",_a_tag.style.display="block",_a_tag.style.textDecoration="none",_a_tag.style.color="#5d5d5d",_a_tag.style.marginTop="2px",_a_tag.style.marginLeft="2px",_a_tag.innerText=dext5_lang.color_picker.custom_color,L.appendChild(_a_tag),DEXTTOP.DEXT5.util.addEvent(L,"click",function(){var i=new v.jscolor.color(L,{},t,n,r,o);onColorPicker({cmd:"more",colorPopup:f}),i.showPicker(),i=getClientRect(A),i=parseInt(i.bottom,10)-parseInt(i.top,10),f.layer.style.height=i+150+"px",null!=N.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(f.iframe.style.height=i+150+"px");var s=163;DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks&&--s,d.getElementById("color_picker").firstChild.style.width=s+"px",d.getElementById("color_picker").style.width="163px",d.getElementById("color_picker").style.display="",s=getClientRect(d.getElementById("color_picker")),s=parseInt(s.bottom,10)-parseInt(s.top,10),setColorPickerHeight(e,i+s)})}x=d.createElement("div"),x.style.clear="both",x.style.margin="0",x.style.padding="0",x.style.line_height="0",x.style.fontSize="0";var A=d.createElement("div");A.className="DEXT_fiVe_EdiTor",A.style.backgroundColor="#fbfbfb","detail_font_bg_color"==r&&A.appendChild(y),A.appendChild(u),A.appendChild(x),A.appendChild(g),DEXTTOP.DEXT5.browser.mobile&&"tablet"!=DEXTTOP.DEXT5.UserAgent.device.type||A.appendChild(L),A.style.position="absolute",A.style.width="163px",A.style.border="solid 1px #bbbbbb",d.body.appendChild(A),c=f.iframe.contentWindow;var O=getIframeDocument(f.iframe);setTimeout(function(){O.getElementsByTagName("A")[0].focus()},1),DEXTTOP.DEXT5.util.addEvent(O,"keyup",function(n){n=n?n:c.event,27==("which"in n?n.which:n.keyCode)&&(e.body.removeChild(l),e.body.removeChild(e.getElementById("popupCover")),setTimeout(function(){try{h==window?setFocusToBody():(0==DEXTTOP.DEXT5.browser.ie&&h.focus(),e.body.focus(),t.parentNode.focus())}catch(n){}},1))}),e==document?(y=d.getElementsByTagName("div")[0],y=getClientRect(y),x=getClientRect(_iframeWin.frameElement),b=parseInt(y.right,10)-parseInt(y.left,10),parseInt(y.bottom,10),parseInt(y.top,10),a.left+b>=x.right?(f.layer.style.left=a.left-(a.left+b-x.right+30)+"px",f.layer.style.top=a.bottom+s+"px"):null==p?(f.layer.style.left=a.left+i+"px",f.layer.style.top=a.bottom+s+"px"):(f.layer.style.left=p.left+a.left+i+"px",f.layer.style.top=p.top+a.bottom+s+"px")):null==p?(f.layer.style.left=a.left+i+"px",e.getElementById("editor_popup_row_property")||e.getElementById("editor_popup_column_property")?f.layer.style.top="0px":f.layer.style.top=a.bottom+s+"px"):(f.layer.style.left=p.left+a.left+i+"px",f.layer.style.top=p.top+a.bottom+s+"px"),DEXTTOP.DEXT5.browser.ie&&(i=d.getElementById("color_ul"),i=getClientRect(i),850<i.bottom-i.top&&(u.style.paddingBottom=DEXTTOP.G_CURREDITOR._config.userColorPicker&&""!=DEXTTOP.G_CURREDITOR._config.userColorPicker?"":"5px")),onColorPicker({cmd:"show",colorPopup:f}),setFocusFirstAndLast(O,A.getElementsByTagName("a")[0])}function showAccessPopup(e,t,n,r,i,s){var o=e.createElement("div");o.setAttribute("id","dext_access_back"),o.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:12; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var u="CSS1Compat"==e.compatMode?e.documentElement.scrollHeight:e.body.scrollHeight;o.firstChild.style.width=("CSS1Compat"==e.compatMode?e.documentElement.scrollWidth:e.body.scrollWidth)+"px",o.firstChild.style.height=u+"px",e.body.appendChild(o),o.onclick=function(){e.body.removeChild(o),n.style.display="none"},n.getElementsByTagName("p")[0].innerHTML=r,setTimeout(function(){var e=getClientRect(t);n.style.left=e.left+i+"px",n.style.top=e.top+s+"px",n.style.display=""},0)}function getClickCell(e,t){var n=null;e.srcElement?n=e.srcElement:e.target&&(n=e.target);if(null!=n)return GetParentbyTagName(n,t)}function createSelectProtocols(e,t){var n=["http://","https://","ftp://","news://","other"],r=["http://","https://","ftp://","news://",""],i=[],s;for(s in n)i.push(document.createElement("option")),i[s].innerHTML=n[s],i[s].setAttribute("value",r[s]),e.appendChild(i[s]);DEXTTOP.DEXT5.util.addEvent(t,"keyup",function(){for(var r in n)n[r]==t.value&&"other"!=n[r]&&(t.value="",e.options[r].selected="selected")})}function lastFocus(e){}function press_enter_esc_btn(e,t){var n=!1,r=!1;if(27==("which"in e?e.which:e.keyCode)){for(var i in G_DEPlugin)if(G_DEPlugin[i].isProcess)return!1;t?(n=closeWebAccessPopup(t),r=closeGridSelectPopop(t)):r=n=!0,n&&r&&(n=DEXTTOP.G_CURREDITOR.dialog._selfTopWindow(DEXTTOP.G_CURREDITOR.ID).parentNode.parentNode,hideDialog(n,{isCancel:!0}))}}function closeWebAccessPopup(e){for(var t=e.getElementsByTagName("div"),n=t.length,r=!0,i=0;i<n;i++)if(-1<t[i].id.indexOf("access_div")&&"none"!=t[i].style.display){n=e.getElementById("dext_access_back"),e.body.removeChild(n),t[i].style.display="none",r=!1;break}return r}function closeGridSelectPopop(e){e=e.getElementById("grid_select");var t=!0;return e&&"none"!=e.style.display&&(e.style.display="none",t=!1),t}function setEditorHeight(e,t){var n={};t?n.height=parseIntOr0(e._config.style.height):n=getClientSize(e._FRAMEWIN.frameElement);var r=n.height,n=getEditorFrameDoc(e),i=n.getElementById("dext_topstatusbar_"+e.ID),s=n.getElementById("dext_menu_"+e.ID),o=n.getElementById("dext_toolbar_"+e.ID),u=n.getElementById("dext_statusbar_"+e.ID),a=n.getElementById("tool3_"+e.ID),f=0,l=0;if(i){switch(e._config.top_status_bar){case"1":l=0;break;default:l=27}f+=l}if(s){switch(e._config.top_menu){case"1":l=0;break;default:l=29}f+=l}if(o){switch(e._config.tool_bar){case"1":l=31,"mono"==e._config.style.skinName&&(l+=7),DEXTTOP.DEXT5.browser.quirks&&("mono"==e._config.style.skinName?--l:l-=2),DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(l+=1);break;case"2":l=29,"mono"==e._config.style.skinName?l+=9:DEXTTOP.DEXT5.browser.quirks&&--l,DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(l+=1);break;case"3":l=1,"mono"==e._config.style.skinName&&--l,DEXTTOP.DEXT5.browser.quirks&&(l="mono"==e._config.style.skinName?l-2:l-3),1>l&&(l=1);break;case"4":l=93;break;default:l=59,"mono"==e._config.style.skinName&&(l+=16),DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.DEXT5.browser.quirks||7!=DEXTTOP.DEXT5.browser.ieVersion?DEXTTOP.DEXT5.browser.quirks&&7>=DEXTTOP.DEXT5.browser.ieVersion&&"mono"==e._config.style.skinName&&(l+=5):--l)}f+=l,"1"==e._config.formMode&&a&&(f+=35,!DEXTTOP.DEXT5.browser.ie||11>=DEXTTOP.DEXT5.browser.ieVersion&&10<=DEXTTOP.DEXT5.browser.ieVersion||(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks?f-=6:9>=DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion&&(f-=3)))}if(u){switch(e._config.status_bar){case"1":l=1;break;default:l=23}f+=l}i=n.getElementById("dext_tab_tool3_"+e.ID),"none"!=o.style.display&&i&&"none"!=i.style.display&&(i=getClientRect(i),f+=i.bottom-i.top),i=n.getElementById("dext_tab_tool4_"+e.ID),"none"!=o.style.display&&i&&"none"!=i.style.display&&(i=getClientRect(i),f+=i.bottom-i.top-1,DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion&&(f+=1)),e.baseMenuToolbarHeight=f,-1<e._config.style.height.indexOf("%")&&(n.getElementsByTagName("html")[0].style.height="100%",r=n.getElementsByTagName("body")[0],r.style.height="100%",r.style.margin="0",n.body.getElementsByTagName("div")[0].style.height="100%",getClientRect(n.body.getElementsByTagName("div")[0]),r=Math.max(n.body.clientHeight,n.documentElement.clientHeight)),isViewMode(e)&&(f=2,7==DEXTTOP.DEXT5.browser.trident||12<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.quirks||(f=0)),"0"==e._config.editorborder&&(f-=2),e._defaultHeight=r-f}function _fn_0(){var e=null,t=null;try{e=DEXTTOP.G_CURREDITOR}catch(n){}if(e)try{t=DEXTTOP.G_CURREDITOR._config}catch(r){}if(0!=!!e&&0!=!!t&&(e=function(e){try{DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(e)}catch(t){}},"undefined"!=typeof T)){var i=T.toString(),i=i.replace(/,/gi,""),s,o,u,a,f,l;s=o=u=a=f=l="";try{l=_0_[3],s=_0_[4],o=_0_[5],u=_0_[7],f=_0_[8],a=_1_}catch(c){e(i+c.toString());return}try{if(0==a.length||a!=u){e(i+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M1)+a);return}}catch(h){e(i+h.toString());return}try{if(0==o.length){e(i);return}if("0"!=o){var p=new Date;o=o.toString(),o=o.split("-");var d=parseIntOr0(o[0]),v=parseIntOr0(o[1]),v=v-1,m=parseIntOr0(o[2]);if(p>new Date(d,v,m,23,59,59)){e(i+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M2)+o.join());return}}}catch(g){e(i+g.toString());return}try{if(0==s.length){e(i);return}s=s.split(","),p=!1,s.push("localhost"),s.push("127.0.0.1"),DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.util&&""==DEXTTOP.DEXT5.util.trim(___)&&(___=DEXTTOP.DEXTWIN.location.href),-1<___.indexOf("file://")&&(___=""!=t.post_url_save_for_notes?t.post_url_save_for_notes:t.post_url);for(d=0;d<s.length;d++){var y=s[d].replace("*.",""),b=y.split("-");if(!(3!=b.length&&4!=b.length||isNaN(b[0])||isNaN(b[1])||isNaN(b[2]))){p="7ylc-firp-7hek-lz88"==y.toLowerCase()||"15si-20th-8ry8-0z0z"==y.toLowerCase()?!1:!0;break}if(-1!=___.toLowerCase().search(y.toLowerCase())){p=!0;break}var w=y.replace("www.","");if(w!=y&&(w="/"+w,-1!=___.toLowerCase().search(w.toLowerCase()))){p=!0;break}}try{var E=f.split(",")[2];E&&-1<E.toLowerCase().indexOf("a")?t.auditLogEnable="0":t.auditLogEnable="1"}catch(S){t.auditLogEnable="1"}if(0==p){e(i+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M3)+___);return}}catch(x){if(x.number&&5011==(x.number&65535))return;e(i+x.toString());return}y=!1;try{if(0==l.length){e(i);return}if("I"==l){try{if("1"==t.formMode&&!(f.split(",")[2]&&-1<f.split(",")[2].indexOf("M"))){e(i+" "+l);return}}catch(N){}y=!0}else if("P"==l){try{if("1"==t.formMode&&!(f.split(",")[2]&&-1<f.split(",")[2].indexOf("M"))){e(i+" "+l);return}}catch(C){}y=!0}else"A"==l?y=!0:"M"==l&&(y=!0)}catch(k){e(i+k.toString());return}try{if(1==y){if((t.interworkingModuleFirst||t.interworkingModuleSecond||t.interworkingModuleThird)&&f.split(",")[2]){var L=f.split(",")[2];l=!1,0>L.indexOf(t.interworkingModuleFirst)?l=!0:0>L.indexOf(t.interworkingModuleSecond)?l=!0:0>L.indexOf(t.interworkingModuleThird)&&(l=!0);if(l){e(i+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M4));return}}if(-1==f.split(",")[0].indexOf("E")){e(i);return}}}catch(A){e(i+A.toString());return}try{G_SC=f.split(",")[2]&&(-1<f.split(",")[2].indexOf("C")||-1<f.split(",")[2].indexOf("O"))?"Y":"N"}catch(O){G_SC="N"}_1_=!0}}function checkDefaultMessage(e){try{var t=DEXTTOP.G_CURREDITOR._config.firstLoadType;""!=DEXTTOP.G_CURREDITOR._config.firstLoadType&&""==DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage=" ");if(""==DEXTTOP.G_CURREDITOR._config.defaultMessage)return!1;""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage="",DEXTTOP.G_CURREDITOR._config.firstLoadType="");var n=!1;!isViewMode(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR._config.editorBodyEditableEx&&(DEXTTOP.G_CURREDITOR._BODY.contentEditable=!0,DEXTTOP.G_CURREDITOR._config.editorBodyEditable=!0);switch(t.toLowerCase()){case"bodyvalue":DEXTTOP.DEXT5.setBodyValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,DEXTTOP.G_CURREDITOR._config.editor_id),n=!0;break;case"bodyvalueex":DEXTTOP.DEXT5.setBodyValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage),n=!0;break;case"bodyvalueexlikediv":DEXTTOP.DEXT5.setBodyValueExLikeDiv(DEXTTOP.G_CURREDITOR._config.firstLoadMessage),n=!0;break;case"htmlvalue":DEXTTOP.DEXT5.setHtmlValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage),n=!0;break;case"htmlvalueex":DEXTTOP.DEXT5.setHtmlValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage),n=!0;break;case"url":DEXTTOP.DEXT5.loadHtmlValueExFromURL(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,DEXTTOP.G_CURREDITOR._config.editor_id),n=!0;break;default:DEXTTOP.DEXT5.setBodyValue("",DEXTTOP.G_CURREDITOR._config.editor_id,!0),setBodyDefaultValue(),setFocusToBody(),n=!0}}catch(r){}return n}function isViewMode(e){var t=e;if(void 0==e||null==e)t=DEXTTOP.G_CURREDITOR;return"view"==t._config.mode?!0:!1}function resizeEditor(e,t){try{if(null==e||void 0==e)e=DEXTTOP.G_CURREDITOR;setEditorHeight(e,t);var n=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+e.ID);("undefined"!=typeof n.contentDocument?n.contentDocument:"undefined"!=typeof n.contentWindow?n.contentWindow.document:document).getElementById("ue_editor_holder_"+e.ID).style.height=e._defaultHeight+"px";for(var n=["source","text"],r=n.length,i=0;i<r;i++){var s=document.getElementById("dext5_"+n[i]+"_"+e.ID),o=e._defaultHeight;DEXTTOP.DEXT5.browser.quirks?o-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(o-=3),s.style.height=o+"px"}set_ruler_pointline_position(e),set_ruler_vertical_height(e),set_horizontal_line_2(e)}catch(u){}}function getCustomIconAttr(e){var t={isCustom:!1,command:"","desc_ko-kr":"","desc_en-us":"","desc_ja-jp":"","desc_zh-cn":"","desc_zh-tw":"","desc-vi-vn":"","desc-ru-ru":""};return"c_"==e.substring(0,2)&&(t.isCustom=!0),t.isCustom&&(e=e.split("|"),t.command=e[0],e[1]&&(e=e[1].split("^"),1==e.length?(t["desc_ko-kr"]=e[0],t["desc_en-us"]=e[0],t["desc_ja-jp"]=e[0],t["desc_zh-cn"]=e[0],t["desc_zh-tw"]=e[0],t["desc_vi-vn"]=e[0],t["desc_ru-ru"]=e[0]):(e[0]&&(t["desc_ko-kr"]=e[0]),e[1]&&(t["desc_en-us"]=e[1]),e[2]&&(t["desc_ja-jp"]=e[2]),e[3]&&(t["desc_zh-cn"]=e[3]),e[4]&&(t["desc_zh-tw"]=e[4]),e[5]&&(t["desc_ru-ru"]=e[5])))),t}function removeCRLFChar(e){return e=changeRealTagToReplaceString(e),e=changeReplaceStringToRealTag(e),e=e.replace(/>\n</g,"><")}function setFocusFirstAndLast(e,t,n){try{var r=null;if(n)r=n;else var i=e.getElementsByTagName("a").length,r=e.getElementsByTagName("a")[i-1];var s=getDocWindow(e),o=!1;s.frameElement&&s.frameElement.parentNode&&"dext_dialog"==s.frameElement.parentNode.id&&(o=!0);var u=n=null;o&&(n=s.frameElement.parentNode.getElementsByTagName("div")[0],u=n.getElementsByTagName("a")[0]),n=function(n){n=n?n:DEXTTOP.DEXTWIN.event;var i="which"in n?n.which:n.keyCode;DEXTTOP.DEXT5.util.cancelEvent(n),0==n.shiftKey&&9==i?(0==DEXTTOP.DEXT5.browser.ie&&s.focus(),e.body.focus(),t.focus()):n.shiftKey&&9==i&&(0==DEXTTOP.DEXT5.browser.ie&&s.focus(),e.body.focus(),r.focus())},t.onkeydown=function(t){t=t?t:s.event;var n="which"in t?t.which:t.keyCode,i=o?DEXTTOP.DEXTWIN:s,a=o?DEXTTOP.DEXTDOC:e,l=o?u:r;t.shiftKey&&9==n&&(DEXTTOP.DEXT5.util.cancelEvent(t),0==DEXTTOP.DEXT5.browser.ie&&i.focus(),a.body.focus(),l.focus())},r.onkeydown=function(n){n=n?n:s.event;var r="which"in n?n.which:n.keyCode,i=o?DEXTTOP.DEXTWIN:s,a=o?DEXTTOP.DEXTDOC:e,l=o?u:t;0==n.shiftKey&&9==r&&(DEXTTOP.DEXT5.util.cancelEvent(n),0==DEXTTOP.DEXT5.browser.ie&&i.focus(),a.body.focus(),l.focus())},u&&(u.onkeydown=n)}catch(a){}}function move_next_a_tag(e,t,n,r,i,s){t.childNodes[n+i]&&t.childNodes[n+i].childNodes[r+s]&&(t.childNodes[n+i].childNodes[r+s].getElementsByTagName("a")[0]&&t.childNodes[n+i].childNodes[r+s].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(e))}function removeFakeLineHeight(e){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion){var t="span strong i u strike sup sub".split(" "),n=t.length,r=DEXTTOP.G_CURREDITOR._setting.line_height,i=r;-1<r.indexOf("%")?(i=parseInt(r,10),r=i/=100,i+=.01):0>r.indexOf("px")&&0>r.indexOf("pt")&&0>r.indexOf("em")&&(r=i=parseFloat(r),i+=.01);for(var s=0;s<n;s++)for(var o=e.getElementsByTagName(t[s]),u=o.length,a=0;a<u;a++)o[a].style.lineHeight!=r&&o[a].style.lineHeight!=i||o[a].style.removeAttribute("line-height")}}function showRuler(e){if("1"==e._config.ruler.use&&"1"==e._config.ruler.view){var t=getEditorFrameDoc(e),n=t.getElementById("dext_tab_tool3_"+e.ID);"1"==e._config.ruler.viewRuler&&(n.style.display="","2"==e._config.ruler.mode&&(t.getElementById("dext_tab_tool4_"+e.ID).style.display=""),resizeEditor(e)),n=e._setting.ruler_position.split(",").length;if("1"==e._config.ruler.viewPointer){for(var r=0;r<n;r++){var i=t.getElementById("dext_ruler_point_"+r+"_"+e.ID);i&&(i.style.display="")}"2"==e._config.ruler.mode&&(r=t.getElementById("dext_ruler_point_3_"+e.ID))&&(r.style.display="")}set_ruler_point_position(e);if("1"==e._config.ruler.viewGuideLine){for(r=0;r<n;r++)if(i=t.getElementById("dext_ruler_pointline_"+r+"_"+e.ID))i.style.display="";set_ruler_pointline_position(e)}}if("1"==e._config.horizontalLine.use){n="";for(r=0;r<e._config.horizontalLine.url.length;r++)0<r&&(n+=","),n+="url("+e._config.horizontalLine.url[r]+")";_iframeDoc.body.style.backgroundImage=n,_iframeDoc.body.style.backgroundRepeat="repeat"}"1"==e._config.ruler.useVertical&&(t=t.getElementById("dext_ruler_vertical_"+e.ID),null!=t&&(t.style.display="")),setRulerPositionForNode(e)}function hideRuler(e){if("1"==e._config.ruler.use){var t=getEditorFrameDoc(e),n=t.getElementById("dext_tab_tool3_"+e.ID);n.style.display="none","2"==e._config.ruler.mode&&(t.getElementById("dext_tab_tool4_"+e.ID).style.display="none");if("1"==e._config.ruler.viewPointer)for(var r=n.getElementsByTagName("img"),i=r.length,n=0;n<i;n++)r[n].style.display="none";if("1"==e._config.ruler.viewGuideLine){r=t.getElementById("dext_ruler_pointline_div").getElementsByTagName("div"),i=r.length;for(n=0;n<i;n++)r[n].style.display="none";"2"==e._config.ruler.mode&&(t.getElementById("dext_ruler_pointline_3_"+e.ID).style.display="none",(n=t.getElementById("dext_ruler_pointline_4_"+e.ID))&&"none"!=n.style.display&&(n.style.display="none"))}"1"==e._config.ruler.useVertical&&(t=t.getElementById("dext_ruler_vertical_"+e.ID),null!=t&&(t.style.display="none")),resizeEditor(e,!1)}"1"==e._config.horizontalLine.use&&changeBodyImageProperty(!0)}function ClearPreViewContent(e){e=e._EDITOR.preview.contentDocument?e._EDITOR.preview.contentDocument:e._EDITOR.preview.contentWindow.document;for(var t=e.getElementsByTagName("embed"),n=t.length-1;0<=n;n--){var r=t[n];try{r.stop()}catch(i){}}e.body.innerHTML=""}function setFocusFirstAndLast2(e,t){try{e.onkeydown=function(e){e=e?e:window.event;var n="which"in e?e.which:e.keyCode;e.shiftKey&&9==n&&(DEXTTOP.DEXT5.util.cancelEvent(e),t.focus())},t.onkeydown=function(t){t=t?t:window.event;var n="which"in t?t.which:t.keyCode;0==t.shiftKey&&9==n&&(DEXTTOP.DEXT5.util.cancelEvent(t),e.focus())}}catch(n){}}function setMatchSelectedValue(e){try{var t=e.getElementsByTagName("select"),n=t.length;for(e=0;e<n;e++){for(var r=t[e].getElementsByTagName("option"),i=r.length,s=0;s<i;s++)1==r[s].selected?r[s].setAttribute("selected","selected"):r[s].removeAttribute("selected");if(DEXTTOP.DEXT5.browser.ie&&9==DEXTTOP.DEXT5.browser.ieVersion){var o=t[e].outerHTML,u=RegExp('(<option[^>]+)(selected="")(.*?>)',"gi");u.test(o)&&(o=o.replace(u,"$1$3"),t[e].outerHTML=o)}}}catch(a){}}function setMatchInputValue(e,t){try{for(var n=e.getElementsByTagName("input"),r=n.length,i=0;i<r;i++){var s=n[i];if(-1<",,text,date,time,datetime-local,number,month,range,color,tel,url,week,".indexOf(","+s.type+",")){var o=s.value;""==o||null!=s.getAttribute("value")&&o==s.getAttribute("value")||s.setAttribute("value",o)}}for(var u=e.getElementsByTagName("textarea"),a=u.length,i=0;i<a;i++){var s=u[i],f=s.value;0==DEXTTOP.DEXT5.browser.ie?""==f||""!=s.innerHTML&&f==s.innerHTML||(s.innerHTML=f):1!=t&&""==f&&s.placeholder&&""!=s.placeholder&&(s.innerHTML="")}}catch(l){}}function getBase64ImageCount(){var e=0;try{var t=DEXTTOP.G_CURREDITOR;if(t){var n=t._FRAMEWIN,r=t.getEditorMode();"source"!=r&&"text"!=r||t.setChangeMode("design"),n.ReplaceImageToRealObject(),n.changeBodyContenteditable(!1),n.changeBodyImageProperty(!0);var i=t._DOC.body.outerHTML,r="",s=RegExp("<img[^>]*src=(.*?)>","gi"),o=i.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),u=i.match(s);if(o)for(var a=o.length,f=0;f<a;f++)r=o[f].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,""),null!=r&&void 0!=r&&""!=r&&(0==r.indexOf("data:")||"ieplugin"==t._config.runtimes&&0==r.indexOf("file://"))&&e++;if(u)for(var l=u.length,f=0;f<l;f++)r=u[f].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,""),null!=r&&void 0!=r&&""!=r&&(0==r.indexOf("data:")||"ieplugin"==t._config.runtimes&&0==r.indexOf("file://"))&&e++;n.changeBodyImageProperty(!1),n.ReplaceRealObjectToImage(),n.changeBodyContenteditable(!0)}}catch(c){}return e}function getBase64ImageCountEx(e){var t=DEXTTOP.G_CURREDITOR,n=0;try{var r="",i=RegExp("<img[^>]*src=(.*?)>","gi"),s=e.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),o=e.match(i);if(s)for(var u=s.length,a=0;a<u;a++)r=s[a].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,""),null!=r&&void 0!=r&&""!=r&&(0==r.indexOf("data:")||"ieplugin"==t._config.runtimes&&0==r.indexOf("file://"))&&n++;if(o)for(var f=o.length,a=0;a<f;a++)r=o[a].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,""),null!=r&&void 0!=r&&""!=r&&(0==r.indexOf("data:")||"ieplugin"==t._config.runtimes&&0==r.indexOf("file://"))&&n++}catch(l){}return n}function setEditorIframeTitle(e){var t="";isViewMode(e)?t=dext5_lang.iframe_title.design:(t="","0"==e._config.top_menu&&(t=dext5_lang.iframe_title.title_menu),"3"!=e._config.tool_bar&&(t+=""==t?" - ":", ","0"==e._config.tool_bar?(t+=dext5_lang.iframe_title.title_tool1,t+=", "+dext5_lang.iframe_title.title_tool2):"1"==e._config.tool_bar?t+=dext5_lang.iframe_title.title_tool2:"2"==e._config.tool_bar&&(t+=dext5_lang.iframe_title.title_tool1)),t+=(""==t?" - ":", ")+dext5_lang.iframe_title.title_text,"0"==e._config.status_bar&&(t+=(""==t?" - ":", ")+dext5_lang.iframe_title.title_status),t+=", "+dext5_lang.iframe_title.title_help,t=dext5_lang.iframe_title.design+" - "+t);try{document.getElementById("dext5_design_"+e.ID).title=t}catch(n){}}function changeFontFamily(e){return-1<e.indexOf(".")&&(e=e.replace(/"/,""),e=e.replace(/'/,""),e="'"+e+"'"),e}function loadPluginJs(e,t){if(G_DEPlugin[e])t();else{var n=_dext_editor._config.webPath.plugin+e+"/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/dext5plugin.js?ver="+DEXTTOP.DEXT5.ReleaseVer,r=document.getElementsByTagName("head")[0];if(!r||document.readyState&&"complete"!=document.readyState)document.write('<script src="'+n+'" type="text/javascript"></script>');else{var i=document.createElement("script");i.type="text/javascript",i.src=n;var s=function(){setTimeout(function(){var t=document.createElement("script");t.type="text/javascript",t.src=_dext_editor._config.webPath.plugin+e+"/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/lang/"+_dext_editor._config.lang+".js",r.appendChild(t)},0)};"undefined"!=typeof i.onreadystatechange?i.onreadystatechange=function(){if("loaded"==i.readyState||"complete"==i.readyState)i.onreadystatechange=null,s(),t()}:i.onload=function(){s(),t()},i.onerror=function(){t()},r.appendChild(i)}}}function setContextMenu(e,t){DEXTTOP.DEXT5.util.cancelEvent(e),DEXT5_CONTEXT.show(e)}function setDoctypeProperty(e,t,n,r){var i=_iframeDoc.getElementsByTagName("head")[0],s=getHeadScriptSrc(i,!0),i=i.outerHTML,o=_iframeDoc.body.outerHTML;setGlobalTableDefaultValue(),FixFlashError2(_iframeDoc),_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(e+"<html>"+i+o+"</html>"),_iframeDoc.close(),setHeadScriptSrc(_iframeDoc,s),0<n.length&&(e=_iframeDoc.getElementsByTagName("html")[0],-1<n.indexOf("-")&&(n=n.split("-")[0]),e.setAttribute("lang",n),e.setAttribute("xml:lang",n),0<r.length&&e.setAttribute("xmlns",r)),""==t&&(t="utf-8");try{var u=_iframeDoc.getElementsByTagName("meta")[0];u.setAttribute("http-equiv","Content-Type"),u.setAttribute("content","text/html"),u.setAttribute("charset",t)}catch(a){}DEXTTOP.G_CURREDITOR._load_editor_frame(!1)}function createEditorIframe(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=document.createElement("iframe");t.appendChild(p),p.id=n,p.title=r,p.frameBorder=0,p.style.width="100%",p.style.height="100%",p.style.borderWidth="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)p.style.overflow="hidden",p.style.display="inline-block";t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",p.src=t,t=getIframeDocument(p),""==l?l="1.2":-1<l.indexOf("%")&&(l=1*parseIntOr0(l,10)/100),n="",""==e.document.docTitle.toString()&&(e.document.docTitle=dext5_lang.document.no_title),n=(""==i?"":i+"\n")+("<html><head><title>"+e.document.docTitle+"</title>"),""!=e.imageBaseUrl&&(n+='<base href="'+e.imageBaseUrl+'" />'),""!=e.ieCompatible&&(n+='<meta http-equiv="X-UA-Compatible" content="IE='+e.ieCompatible+'" />\n'),n+="<style type=text/css>",n+=createEditorDefaultStyleInnerHTML(e,a,f,l,c,h),n+="</style>",""!=e.placeholder.content&&"edit"==e.mode&&(n+='<style type=text/css id="dext_placeholder">',n+=".dext_placeholder:before { content: '"+e.placeholder.content+"'; color: "+e.placeholder.fontColor+"; font-size: "+(""==e.placeholder.fontSize?f:e.placeholder.fontSize)+"; font-family: "+changeFontFamily(""==e.placeholder.fontFamily?a:e.placeholder.fontFamily)+"; display: block; position: absolute; white-space: pre; }",n+="</style>"),i="",i=DEXTTOP.DEXT5.isRelease?e.webPath.css:e.webPath.css_dev,n+='<link href="'+i+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" rel="stylesheet" type="text/css" />';if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use)n+='<link href="'+i+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" rel="stylesheet" type="text/css" />';n+="</head>",i="";switch(e.scrollOverflow){case"1":i='style="overflow-x:scroll;"';break;case"2":i='style="overflow-y:scroll;"';break;case"3":i='style="overflow-x:scroll;overflow-y:scroll;"';break;case"4":i='style="overflow-x:hidden;"';break;case"5":i='style="overflow-y:hidden;"';break;case"6":i='style="overflow-x:hidden;overflow-y:hidden;"'}return n="1"==e.setDefaultStyle.value||"2"==e.setDefaultStyle.value?""!=e.defaultMessage?n+('<body id="'+e.setDefaultStyle.body_id+'" '+i+">"):n+('<body id="'+e.setDefaultStyle.body_id+'" '+i+""+(""!=e.placeholder.content&&"edit"==e.mode?"class='dext_placeholder'":"")+">"):""!=e.defaultMessage?n+("<body "+i+">"):n+("<body "+i+""+(""!=e.placeholder.content&&"edit"==e.mode?"class='dext_placeholder'":"")+">"),n+="<p></p></body></html>",getDocWindow(t),t.open("text/html","replace"),isCustomDomain(document)&&(t.domain=document.domain),t.write(n),t.close(),o&&0<o.length&&(i=t.getElementsByTagName("html")[0],-1<o.indexOf("-")&&(o=o.split("-")[0]),i.setAttribute("lang",o),i.setAttribute("xml:lang",o),0<u.length&&i.setAttribute("xmlns",u)),""==s&&(s="utf-8"),u=t.getElementsByTagName("head")[0],o=t.createElement("meta"),o.setAttribute("http-equiv","Content-Type"),o.setAttribute("content","text/html"),o.setAttribute("charset",s),u.appendChild(o),5<e.userCssUrl.length&&createDynamicCssLinkToHeadTag(t,u,e.userCssUrl),5<e.webFontCssUrl.length&&createDynamicCssLinkToHeadTag(t,u,e.webFontCssUrl),5<e.userJsUrl.length&&createDynamicJsLinkToHeadTag(t,u,e.userJsUrl),p}function setHtmlValueWithDocTypeToEditor(e,t,n){t=n?n:DEXTTOP.G_CURREDITOR,"1"==t._config.enforceDoctype&&(e=e.replace(/<!doctype *([^>?+])*>/gi,"")),n=getRemoveHeadScript(e),e=n.html,e=addDefaultStyleToEditor(e,t),FixFlashError2(_iframeDoc),_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(e),_iframeDoc.close(),setHeadScriptSrc(_iframeDoc,n.scriptsAry),setScrollStyleForIOS(t),showWordCount(),t._load_editor_frame(!1),"base64"!=t._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),"1"==t._config.horizontalLine.use?t._BODY.style.marginTop="0px":t._BODY.style.margin="",moveStyleTagToHead(t)}function setHtmlValueToEditor(e,t,n,r){var i;i=n?n:DEXTTOP.G_CURREDITOR,"1"==i._config.enforceDoctype&&(e=e.replace(/<!doctype *([^>?+])*>/gi,"")),n=i._docType[i._PageProp.doctype];var s=_iframeDoc.getElementsByTagName("head")[0];setHeadLinkUrlTimeStamp(s),s=getRemoveHeadScript(e),e=s.html,!0!==r&&(e=addDefaultStyleToEditor(e,i)),FixFlashError2(_iframeDoc),_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(n+e),_iframeDoc.close(),setHeadScriptSrc(_iframeDoc,s.scriptsAry),setScrollStyleForIOS(i),showWordCount(),DEXTTOP.DEXT5.util.setBodyBackground(i);if("1"==i._config.horizontalLine.use){var o=i._FRAMEWIN;setTimeout(function(){o.showRuler(i)},0)}i._load_editor_frame(!1),"1"==i._config.horizontalLine.use?i._BODY.style.marginTop="0px":i._BODY.style.margin="",!0!==r&&"base64"!=i._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),"show_blocks"==i.ShowBlocks&&(i.ShowBlocks="",command_showBlocks(e,t)),moveStyleTagToHead(i)}function setHeadValueToEditor(e,t){var n;n=t?t:DEXTTOP.G_CURREDITOR,"1"==n._config.enforceDoctype&&(e=e.replace(/<!doctype *([^>?+])*>/gi,""));var r=n._docType[n._PageProp.doctype],i=n._PageProp.lang,s=n._PageProp.xmlnsname,o=_iframeDoc.getElementsByTagName("body")[0],u;u=o.style.padding;var o=o.style.margin,a=getRemoveHeadScript(e);e=a.html,e=addDefaultStyleToEditor(e,n),FixFlashError2(_iframeDoc),_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(r+"<html>"+e+"</html>"),_iframeDoc.close(),setHeadScriptSrc(_iframeDoc,a.scriptsAry),setScrollStyleForIOS(n),showWordCount(),0<i.length&&(r=_iframeDoc.getElementsByTagName("html")[0],-1<i.indexOf("-")&&(i=i.split("-")[0]),r.setAttribute("lang",i),r.setAttribute("xml:lang",i),0<s.length&&r.setAttribute("xmlns",s)),0<u.length&&(_iframeDoc.body.style.padding=u),0<o.length&&(_iframeDoc.body.style.margin=o),n._load_editor_frame(!1),"1"==n._config.horizontalLine.use?n._BODY.style.marginTop="0px":n._BODY.style.margin="","base64"!=n._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),moveStyleTagToHead(n)}function setBodyValueToEditorEx(e,t){var n;n=t?t:DEXTTOP.G_CURREDITOR,"1"==n._config.enforceDoctype&&(e=e.replace(/<!doctype *([^>?+])*>/gi,""));var r=n._docType[n._PageProp.doctype],i=n._PageProp.lang,s=n._PageProp.xmlnsname,o=_iframeDoc.getElementsByTagName("head")[0];setHeadLinkUrlTimeStamp(o);var u=getHeadScriptSrc(o,!0),o=o.outerHTML,a=_iframeDoc.getElementsByTagName("body")[0],f;f=a.style.padding,a=a.style.margin,FixFlashError2(_iframeDoc),_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(r+"<html>"+o+e+"</html>"),_iframeDoc.close(),setHeadScriptSrc(_iframeDoc,u),setScrollStyleForIOS(n),showWordCount(),0<i.length&&(r=_iframeDoc.getElementsByTagName("html")[0],-1<i.indexOf("-")&&(i=i.split("-")[0]),r.setAttribute("lang",i),r.setAttribute("xml:lang",i),0<s.length&&r.setAttribute("xmlns",s)),0<f.length&&(_iframeDoc.body.style.padding=f),0<a.length&&(_iframeDoc.body.style.margin=a),-1<o.indexOf("#"+n._config.setDefaultStyle.body_id)&&(_iframeDoc.body.id=n._config.setDefaultStyle.body_id),n._load_editor_frame(!1),"base64"!=n._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),moveStyleTagToHead(n)}function setBodyValueToEditor(e,t){var n;n=t?t:DEXTTOP.G_CURREDITOR,"1"==n._config.enforceDoctype&&(e=e.replace(/<!doctype *([^>?+])*>/gi,""));var r=n._docType[n._PageProp.doctype],i=n._PageProp.lang,s=n._PageProp.xmlnsname,o=_iframeDoc.getElementsByTagName("head")[0];setHeadLinkUrlTimeStamp(o);var u=getHeadScriptSrc(o,!0),a=o.outerHTML,f=_iframeDoc.getElementsByTagName("body")[0],l,c,h,p,d,o=f.style.padding;l=f.style.margin,c=f.style.backgroundImage,h=f.style.backgroundColor,p=f.style.backgroundAttachment,d=f.style.backgroundRepeat,FixFlashError2(_iframeDoc);var f=f.outerHTML,v=f.toLowerCase().indexOf("<body"),m=f.indexOf(">"),g="",g=-1<v&&-1<m?f.substring(v,m+1):"<body>";_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(r+"<html>"+a+g+e+"</body></html>"),_iframeDoc.close(),setHeadScriptSrc(_iframeDoc,u),setScrollStyleForIOS(n),showWordCount(),0<i.length&&(r=_iframeDoc.getElementsByTagName("html")[0],-1<i.indexOf("-")&&(i=i.split("-")[0]),r.setAttribute("lang",i),r.setAttribute("xml:lang",i),0<s.length&&r.setAttribute("xmlns",s)),0<o.length&&(_iframeDoc.body.style.padding=o),0<l.length&&(_iframeDoc.body.style.margin=l),0<c.length&&(_iframeDoc.body.style.backgroundImage=c),0<h.length&&(_iframeDoc.body.style.backgroundColor=h),0<p.length&&(_iframeDoc.body.style.backgroundAttachment=p),0<d.length&&(_iframeDoc.body.style.backgroundRepeat=d);try{n._load_editor_frame(!1)}catch(y){}"base64"!=n._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),moveStyleTagToHead(n)}function setHtmlToPreview(){var e=DEXTTOP.G_CURREDITOR;""!=e._config.placeholder.content&&placeholderControl(e,"remove");var t;t=e._EDITOR.preview.contentDocument?e._EDITOR.preview.contentDocument:e._EDITOR.preview.contentWindow.document;var n=e._docType[e._PageProp.doctype],r=e._PageProp.lang,i=e._PageProp.xmlnsname,s=_iframeDoc.getElementsByTagName("head")[0],o=getHeadScriptSrc(s,!1),s=s.outerHTML,s=s.replace(/<script[^>]*src=([\s\S]*?)[\s\S]*?>[\s\S]*?<\/script>/gi,"");setMatchSelectedValue(_iframeDoc.body),setMatchInputValue(_iframeDoc.body);var u="",a="",f="";_iframeDoc.body.style.transformOrigin&&""!=_iframeDoc.body.style.transformOrigin&&(u=_iframeDoc.body.style.transformOrigin,_iframeDoc.body.style.transformOrigin=""),_iframeDoc.body.style.transform&&""!=_iframeDoc.body.style.transform&&(a=_iframeDoc.body.style.transform,_iframeDoc.body.style.transform=""),_iframeDoc.body.style.zoom&&""!=_iframeDoc.body.style.zoom&&(f=_iframeDoc.body.style.zoom,_iframeDoc.body.style.zoom="");var l=_iframeDoc.body.outerHTML;""!=u&&(_iframeDoc.body.style.transformOrigin=u),""!=a&&(_iframeDoc.body.style.transform=a),""!=f&&(_iframeDoc.body.style.zoom=f),changeBodyImageProperty(!0),DEXTTOP.DEXT5.browser.ie&&"1"==e._config.plugInUse&&"1"==e._config.printPreview&&(u='<object id="dext5printpreview" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" width="0" height="0"><param name="saveFileType" value="">'+('<param name="serverDomain" value="'+e._config.serverDomain+'">'),u+='<param name="toSavePathUrl" value="'+e._config.toSavePathURL+'">',u+='<param name="saveFolderNameRule" value="'+e._config.saveFolderNameRule+'">',u+='<param name="saveFileNameRule" value="'+e._config.saveFileNameRule+'">',u+='<param name="productKey" value="'+e._config.productKey+'">',u+='<param name="licenseKeyUrl" value="'+e._config.plugin_root+'">',u+='<param name="postPageURL" value="'+e._config.post_url+'">',u+='<param name="accessibility" value="'+e._config.accessibility+'">',u+='<param name="licenseKey" value="'+e._config.LicenseKey+'">',u+='<param name="strPrintMargin" value="'+e._config.printMarginltrb+'">',u+='<param name="hasContainer" value="'+e._config.hasContainer+'">',u+='<param name="nUsePrintLandscape" value="'+e._config.printLandscape+'">',u+="</object>",l+=u),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&(l=DEXTTOP.DEXT5.util.htmlRevision(l)),e._PageProp.bshowgrid&&1==e._PageProp.bshowgrid&&changeBodyImageProperty(!1),FixFlashError(),getDocWindow(t),t.open("text/html","replace"),isCustomDomain(document)&&(t.domain=document.domain),t.write(n+"<html>"+s+l+"</html>"),t.close(),""!=e._config.placeholder.content&&placeholderControl(e,"set"),setHeadScriptSrc(t,o),0<r.length&&(n=t.getElementsByTagName("html")[0],-1<r.indexOf("-")&&(r=r.split("-")[0]),(o=_iframeDoc.getElementsByTagName("html")[0])&&o.getAttribute("lang")&&""!=o.getAttribute("lang")?n.setAttribute("lang",r):n.removeAttribute("lang"),n.setAttribute("xml:lang",r),0<i.length&&n.setAttribute("xmlns",i)),replaceClassForBorder(e,t.body,"hidden"),replaceClassForBookmark(e,t.body,"hidden"),hiddenBlocks(t);if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)try{for(var c=t.getElementsByTagName("iframe"),h=c.length,i=0;i<h;i++){var p=c[i],d=t.createElement("div");d.style.height=p.height?p.height+"px":p.style.height+"px",d.style.width=p.width?p.width+"px":p.style.width+"px",d.style.overflow="scroll",d.style.overflowX="hidden",d.style.WebkitOverflowScrolling="touch",setWrapperToElement(p,d)}}catch(v){}"spellcheck"in t.body&&(t.body.spellcheck=!1),"contentEditable"in t.body&&(t.body.contentEditable=!1);if(DEXTTOP.DEXT5.browser.ie)try{DEXTTOP.DEXT5.util.addEvent(e._EDITOR.preview.contentWindow,"unload",function(){FixFlashError()}),DEXTTOP.DEXT5.util.addEvent(_iframeWin,"unload",function(){FixFlashError2(_iframeDoc)})}catch(m){}setAdjustTableBorder(t),DEXTTOP.DEXT5.util.addEvent(t.body,"click",function(e){try{evt=e?e:event,evt.srcElement?elem=evt.srcElement:evt.target&&(elem=evt.target)}catch(t){}if(elem&&("a"!=elem.tagName.toLowerCase()&&(elem=GetParentbyTagName(elem,"a")),elem&&elem.getAttribute("href")&&!(-1<elem.getAttribute("href").indexOf("#")))){var n=elem.getAttribute("target");elem.setAttribute("target","_blank"),setTimeout(function(){n&&""!=n?elem.setAttribute("target",n):elem.removeAttribute("target")},1)}}),DEXTTOP.DEXT5.util.addEvent(e._EDITOR.preview.contentWindow,"scroll",function(){"1"==e._config.ruler.useVertical&&set_ruler_vertical_height(e),"2"==e._config.horizontalLine.use&&set_horizontal_line_2(e)})}function setWrapperToElement(e,t){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t.appendChild(e)}function changeBodyImageProperty(e){var t=DEXTTOP.G_CURREDITOR;if(e)t._PageProp.bodyimage&&0<t._PageProp.bodyimage.length?_iframeDoc.body.style.backgroundImage=t._PageProp.bodyimage:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-image"):_iframeDoc.body.style.removeAttribute("backgroundImage"),t._PageProp.bodycolor&&0<t._PageProp.bodycolor.length?_iframeDoc.body.style.backgroundColor=t._PageProp.bodycolor:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-color"):_iframeDoc.body.style.removeAttribute("backgroundColor"),t._PageProp.bodyattachment&&0<t._PageProp.bodyattachment.length?_iframeDoc.body.style.backgroundAttachment=t._PageProp.bodyattachment:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-attachment"):_iframeDoc.body.style.removeAttribute("backgroundAttachment"),t._PageProp.bodyrepeat&&0<t._PageProp.bodyrepeat.length?_iframeDoc.body.style.backgroundRepeat=t._PageProp.bodyrepeat:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-repeat"):_iframeDoc.body.style.removeAttribute("backgroundRepeat");else if(t._PageProp.gridimage&&0<t._PageProp.gridimage.length&&(_iframeDoc.body.style.backgroundImage=t._PageProp.gridimage),t._PageProp.gridattachment&&0<t._PageProp.gridattachment.length&&(_iframeDoc.body.style.backgroundAttachment=t._PageProp.gridattachment),t._PageProp.gridrepeat&&0<t._PageProp.gridrepeat.length&&(_iframeDoc.body.style.backgroundRepeat=t._PageProp.gridrepeat),"1"==t._config.horizontalLine.use&&0<t._config.horizontalLine.url.length){e="";for(var n=0;n<t._config.horizontalLine.url.length;n++)0<n&&(e+=","),e+='url("'+t._config.horizontalLine.url[n]+'")';_iframeDoc.body.style.backgroundImage=e,_iframeDoc.body.style.backgroundRepeat="repeat",_iframeDoc.body.style.margin="0px 10px 10px 10px"}}function changeBodyContenteditable(e){e?DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(_iframeDoc.body.contentEditable=e):(_iframeDoc.body.removeAttribute("contentEditable"),_iframeDoc.body.style.removeProperty?(_iframeDoc.body.style.removeProperty("margin-left"),_iframeDoc.body.style.removeProperty("margin-top"),_iframeDoc.body.style.removeProperty("margin-right"),_iframeDoc.body.style.removeProperty("margin-bottom"),_iframeDoc.body.style.removeProperty("margin")):(_iframeDoc.body.style.removeAttribute("marginLeft"),_iframeDoc.body.style.removeAttribute("marginTop"),_iframeDoc.body.style.removeAttribute("marginRight"),_iframeDoc.body.style.removeAttribute("marginBottom"),_iframeDoc.body.style.removeAttribute("margin")))}function fakeBodyDivForBackground(e,t){e=e.replace(/(\r\n|\n|\r)/gm,"");if(t){var n=e.substr(0,4),r=e.substr(e.length-6,6);"<div"==n.toLowerCase()&&"</div>"==r.toLowerCase()&&(n=n.replace(n,"<body"),r=r.replace(r,"</body>"),e=e.substring(4,e.length-6),e=n+e+r)}else n=e.substr(0,5),r=e.substr(e.length-7,7),"<body"==n.toLowerCase()&&"</body>"==r.toLowerCase()&&(n=n.replace(n,"<div"),r=r.replace(r,"</div>"),e=e.substring(5,e.length-7),e=n+e+r);return e}function createDynamicCssLinkToHeadTag(e,t,n){try{if(""!=n){var r=e.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=n,t.appendChild(r)}}catch(i){}}function clearDynamicCssLinkToHeadTag(e,t){try{for(var n=e.getElementsByTagName("link"),r=n.length-1;0<r;r--)e.removeChild(n[r]);t&&0<n.length&&e.removeChild(n[0])}catch(i){}}function addDynamicCssToHeadTag(e,t,n){try{for(var r=t.getElementsByTagName("style"),i=r.length-1;0<i;i--)t.removeChild(r[i]);if(""!=n){var s=e.createElement("style");s.type="text/css",s.styleSheet?(s.styleSheet.cssText=n,""==s.innerHTML&&(s.innerHTML=n)):s.appendChild(e.createTextNode(n)),t.appendChild(s)}}catch(o){}}function createDynamicJsLinkToHeadTag(e,t,n){try{if(""!=n){var r=e.createElement("script");r.type="text/javascript",r.src=n,t.appendChild(r)}}catch(i){}}function clearDynamicJsLinkToHeadTag(e){try{for(var t=e.getElementsByTagName("script"),n=t.length-1;0<=n;n--)e.removeChild(t[n])}catch(r){}}function addDynamicJsToHeadTag(e,t,n){try{for(var r=t.getElementsByTagName("script"),i=r.length-1;0<=i;i--){var s=r[i];s.src&&""!=s.src||t.removeChild(s)}if(""!=n){var o=e.createElement("script");o.type="text/javascript",o.appendChild(e.createTextNode(n)),t.appendChild(o)}}catch(u){}}function getValueWithSetStyleInP(e){if("CCODE_001"==e._config.custom_code)try{var t="",n="";""!=e._setting.font_family&&(n=e._setting.font_family),""!=e._setting.font_size&&(t=e._setting.font_size);if(""!=n||""!=t){var r=e._DOC.body.getElementsByTagName("p"),i=r.length;for(e=0;e<i;e++)""!=n&&""==r[e].style.fontFamily&&(r[e].style.fontFamily=n),""!=t&&""==r[e].style.fontSize&&(r[e].style.fontSize=t)}}catch(s){}}function addDefaultStyleToEditor(e,t){if("0"!=t._config.setDefaultStyle.dext_set_style){var n=["body","p","li"];"0"!=t._config.setDefaultStyle.value&&(n="#"+t._config.setDefaultStyle.body_id,n=[n,n+" p",n+" li"]);for(var r=[!1,!1,!1],i=n.length,s=e.toLowerCase(),o=-1,u=-1,a=s,f=0;-1<a.indexOf("<style");){var o=f+a.indexOf("<style"),u=f+a.indexOf("</style>"),l=a.indexOf("<!--"),c=a.indexOf("-->");if(-1==l)break;if(!(f+l<o&&f+c<o||o>f+l+4&&u+8<f+c))break;a=a.substring(c+3),f+=c+3}a=t._setting.line_height,""!=a&&-1<a.indexOf("%")&&parseIntOr0(a,10),a="";if(-1<s.toLowerCase().indexOf("<head")&&-1<o&&-1<u){for(var f="",f=s.substring(o,u),h=f.indexOf(">"),s=f.substring(0,h+1),f=f.substring(h+1),c=f.indexOf("/*"),l=f.indexOf("*/");-1<c&&-1<l;)c=f.substring(0,c),f=f.substring(l+2),f=c+f,c=f.indexOf("/*"),l=f.indexOf("*/");l=f.split("}"),c=l.length;for(f=0;f<c;f++)if(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(-1<l[f].indexOf("<!--")&&(l[f]=l[f].replace("<!--","")),-1<l[f].indexOf("-->")&&(l[f]=l[f].replace("-->",""))),h=l[f].indexOf("{"),-1<h){for(var h=l[f].substring(0,h),p=0;p<i;p++){var d=DEXTTOP.DEXT5.util.trim(h.replace("-->","")),v=n[p].split(" ")[1];d==v&&(l[f]=""),d==n[p]&&(l[f]=-1<h.indexOf("-->")?"-->":"")}a+=l[f],-1<l[f].indexOf("{")&&(a+="}")}else a+=l[f];c=r.length,i="","2"==t._config.setDefaultStyle.dext_set_style&&(i="font-family:"+t._setting.font_family+"; font-size:"+t._setting.font_size+";"),l=createEditorDefaultStyleInnerHTML(t._config,"","","",t._setting.word_break_type,t._setting.word_wrap_type);for(f=0;f<c;f++)0==r[f]&&(h="",reg_exp=new RegExp(n[f]+" {([\\w\\W\\s]+?)}","gi"),(h=l.match(reg_exp))&&(h=h[0].replace(reg_exp,"$1")),n[f]==n[0]?a+=n[f]+" {"+h+"}":(a+=n[f]+" {"+h,a+=i,a+="}"));a=s+a,e=e.substring(0,o)+a.toLowerCase()+e.substring(u,e.length)}else-1<s.toLowerCase().indexOf("<head")&&0>o&&(h=s.toLowerCase().indexOf("</head"),0<h&&(i="","2"==t._config.setDefaultStyle.dext_set_style&&(i="font-family:"+t._setting.font_family+"; font-size:"+t._setting.font_size+";"),l=createEditorDefaultStyleInnerHTML(t._config,"","","",t._setting.word_break_type,t._setting.word_wrap_type),l=l.replace("p {","p {"+i),l=l.replace("li {","li {"+i),a=a+'<style type="text/css">'+l,a+="</style>",e=e.substring(0,h)+a+e.substring(h,e.length)))}return e}function base64imageToLocalFile(e){if(G_dext5plugIn){e=e.body.getElementsByTagName("img");for(var t=e.length,n=0;n<t;n++){var r=e[n];if(!r.getAttribute("raon_chart"))try{var i=r.src;if("data:"==i.substring(0,5)){var s=i.split(",");if(2==s.length){var o=getExtFromImageDataSrc(s[0]);try{var u=G_dext5plugIn.getLocalImageFromBase64Image(s[1],o);0<u.length&&(r.src=u)}catch(a){}}}}catch(f){}}}}function setStyleForTableBorderNodeClass(e){try{if(0==checkIfIncluded("editor_contents.css")){var t="",t=DEXTTOP.DEXT5.isRelease?e._config.webPath.css:e._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(t+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer,e.ID)}}catch(n){}}function setCssForFormMode(e){try{if(("1"==e._config.formMode||"1"==e._config.userTableLock.use)&&0==checkIfIncluded("editor_form.css")){var t="",t=DEXTTOP.DEXT5.isRelease?e._config.webPath.css:e._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(t+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer,e.ID)}}catch(n){}}function setHeadLinkUrlTimeStamp(e){e=e.childNodes;for(var t=e.length,n=0;n<t;n++){var r=e[n];if(r&&r.tagName&&"link"==r.tagName.toLowerCase()&&!(-1<r.href.indexOf("editor_contents.css")||-1<r.href.indexOf("editor_form.css"))){var i="";try{r.outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),i=RegExp.$2}catch(s){i=r.href}r=i.split("?");if(1<r.length){for(var i=r[1].split("&"),o=i.length,u=0;u<o;u++)-1<i[u].indexOf("t=")&&(i[u]="t="+(new Date).getTime());e[n].href=r[0]+"?"+i.join("&")}else e[n].href=r[0]+"?t="+(new Date).getTime()}}}function getHeadScriptSrc(e,t){for(var n=e.getElementsByTagName("script"),r=[],i=n.length;0<i;i--){var s=n[i-1];if(s.src&&""!=s.src){var o="";try{s.outerHTML.match(RegExp("(srcs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),o=RegExp.$2}catch(u){o=s.src}o=o.split("?");if(1<o.length){for(var a=o[1].split("&"),f=a.length,l=0;l<f;l++)-1<a[l].indexOf("t=")&&(a[l]="t="+(new Date).getTime());o=o[0]+"?"+a.join("&")}else o=o[0]+"?t="+(new Date).getTime();r.push(o),t&&e.removeChild(s)}}return r}function setHeadScriptSrc(e,t){var n=e.getElementsByTagName("head")[0];if(n)for(var r=0,i=t.length;r<i;r++)createDynamicJsLinkToHeadTag(e,n,t[r])}function getRemoveHeadScript(e){var t={html:e,scriptsAry:[]},n=e.toLowerCase().indexOf("<head"),r=e.toLowerCase().indexOf("</head>"),i=e.substring(0,n),n=e.substring(n,r+7);e=e.substring(r+7,e.length);var r=RegExp("<script[^>]*src=([\\s\\S]*?)>[\\s\\S]*?</script>","gi"),s=n.match(r);if(s){for(var o=s.length,u=0;o>u;u++)r=RegExp('<script[^>]*src="([\\s\\SS]*?)"([\\s\\S]*?)>[sS]*?</script>',"gi"),r.test(s[u]),t.scriptsAry.push(RegExp.$1);r=RegExp("<script[^>]*src=([\\s\\S]*?)>[\\s\\S]*?</script>","gi"),n=n.replace(r,""),t.html=i+n+e}return t}function addStyleTag(e,t){try{for(var n=!1,r=t._DOC.getElementsByTagName("head")[0],i=r.getElementsByTagName("style"),s=i.length,o=0;o<s;o++)if("mobile_style"==i[o].getAttribute("dext")){n=!0;break}if(!n){var u=e.cssText,a=t._DOC.createElement("style");a.type="text/css";for(var f in e.attrObj)e.attrObj[f]&&a.setAttribute(f,e.attrObj[f]);a.styleSheet?(a.styleSheet.cssText=u,""==a.innerHTML&&(a.innerHTML=u)):a.appendChild(t._DOC.createTextNode(u)),r.appendChild(a)}}catch(l){}}function setScrollStyleForIOS(e){DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&addStyleTag({cssText:"html,body{ -webkit-overflow-scrolling : touch !important; overflow: auto !important; height: 100% !important; }",attrObj:{dext:"mobile_style"}},e)}function removeScrollStyleForIOS(e){if(DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS){e=e._DOC.getElementsByTagName("head")[0];for(var t=e.getElementsByTagName("style"),n=t.length-1;0<=n;n--)"mobile_style"==t[n].getAttribute("dext")&&e.removeChild(t[n])}}function setEmptyTagWhiteSpace(e,t){if("0"==e._config.removeEmptyTag&&"1"==e._config.removeEmptyTagReplaceDefaultParagraphValue){var n=e._DOC;t&&(n=t);for(var n=n.body.getElementsByTagName("p"),r=n.length,i=0;i<r;i++){var s=0,o=n[i].getElementsByTagName("br"),s=s+o.length;0==s&&(o=n[i].getElementsByTagName("input"),s+=o.length),0==s&&(o=n[i].getElementsByTagName("textarea"),s+=o.length),0==s&&(o=n[i].getElementsByTagName("img"),s+=o.length);if(!(0<s)&&"1"==e._config.removeEmptyTagInsertNbspForLineBreak&&""==(void 0!=n[i].innerText?n[i].innerText:n[i].textContent).replace(unescape("%u200B"),"")){s=document.createTextNode("\u00a0");try{n[i].appendChild(s)}catch(u){}}}}}function createEditorDefaultStyleInnerHTML(e,t,n,r,i,s){var o="";if(void 0==t||""==t)t=DEXTTOP.G_CURREDITOR._setting.font_family;if(void 0==n||""==n)n=DEXTTOP.G_CURREDITOR._setting.font_size;if(void 0==r||""==r)r=DEXTTOP.G_CURREDITOR._setting.line_height;if(void 0==i||""==i)i="normal";if(void 0==s||""==s)s="normal";var u="";"1"==e.defaultImemode&&(u="-ms-image-mode: active; ime-mode: active;");var a="";return"1"==e.defaultBodySpace.use?(a="1"==e.defaultBodySpace.mode?"margin:":"2"==e.defaultBodySpace.mode?"margin:0px; padding:":"margin:",a="1"==e.horizontalLine.use?a+("0px "+e.defaultBodySpace.configValue.right+" "+e.defaultBodySpace.configValue.bottom+" "+e.defaultBodySpace.configValue.left+";"):a+(e.defaultBodySpace.configValue.top+" "+e.defaultBodySpace.configValue.right+" "+e.defaultBodySpace.configValue.bottom+" "+e.defaultBodySpace.configValue.left+";")):a="margin:0px;","1"==e.setDefaultStyle.value||"2"==e.setDefaultStyle.value?(o+="#"+e.setDefaultStyle.body_id+" { cursor:text; "+a+" font-family:"+changeFontFamily(t)+"; font-size:"+n+";"+u+" word-break:"+i+"; word-wrap:"+s+"; }",o+="#"+e.setDefaultStyle.body_id+" p { line-height:"+r+"; margin-top:"+e.defaultFontMarginTop+"; margin-bottom:"+e.defaultFontMarginBottom+"; }",o+="#"+e.setDefaultStyle.body_id+" li { line-height:"+r+"; margin-top:"+e.defaultFontMarginTop+"; margin-bottom:"+e.defaultFontMarginBottom+"; }",o+="#"+e.setDefaultStyle.body_id+" .raon_placeholder { display: inline-block; }",o+="#"+e.setDefaultStyle.body_id+" .raon_placeholder:empty:before { content: attr(placeholder); color: #EE0000; }",o+="#"+e.setDefaultStyle.body_id+" .raon_placeholder:focus:before { content: none; }"):(o+="body { cursor:text; "+a+" font-family:"+changeFontFamily(t)+"; font-size:"+n+";"+u+" word-break:"+i+"; word-wrap:"+s+"; }",o+="p { line-height:"+r+"; margin-top:"+e.defaultFontMarginTop+"; margin-bottom:"+e.defaultFontMarginBottom+"; }",o+="li { line-height:"+r+"; margin-top:"+e.defaultFontMarginTop+"; margin-bottom:"+e.defaultFontMarginBottom+"; }",o+=".raon_placeholder { display: inline-block; }.raon_placeholder:empty:before { content: attr(placeholder); color: #EE0000; }",o+=".raon_placeholder:focus:before { content: none; }"),"1"==e.highlight.use&&"undefined"!=typeof e.highlight.color&&""!=e.highlight.color&&(o+=" .raon_highlighter { background-color: "+e.highlight.color+"; } "),o}function defaultStyleSameCheck(e,t){var n=!1;return"1"==t._config.setDefaultStyle.value||"2"==t._config.setDefaultStyle.value?-1<e.indexOf("#"+t._config.setDefaultStyle.body_id)&&(n=!0):0>e.indexOf("#"+t._config.setDefaultStyle.body_id)&&-1<e.indexOf("body {")&&-1<e.indexOf("p {")&&-1<e.indexOf("li {")&&(n=!0),n}function getDefaultStyleTag(e,t){for(var n=null,r=e.getElementsByTagName("style"),i=r.length,s=0;s<i;s++)if(defaultStyleSameCheck(r[s].innerHTML,t)){n=r[s];break}return n}function moveStyleTagToHead(e){try{if("1"==e._config.moveStyleTagToHead)for(var t=e._BODY.getElementsByTagName("style"),n=t.length-1;0<=n;n--)e._DOC.documentElement.getElementsByTagName("head")[0].appendChild(t[n])}catch(r){}}function command_find(e,t,n,r,i,s,o,u){dext_src_init(t),restoreSelection(),setFocusToBody();if(0==n.length)return!1;try{e=null;if(null==g_findRepalceRange){var a=getFirstRange().range;e=rangy.createRange(_iframeDoc),e.selectNodeContents(_iframeDoc.body),s?e.setStart(a.startContainer,a.startOffset):e.setEnd(a.startContainer,a.startOffset)}else e=g_findRepalceRange;r={caseSensitive:r,wholeWordsOnly:i,direction:s?"forward":"backward"};var f=e.findText(n,r);if(f)e.select(),s?e.collapse(!1):e.collapse(!0),setAutoScrollToRange(e),g_findRepalceRange=e;else{if(!o)return 0!=u&&alert(dext5_lang.find.msg.no_find),!1;if(e=s?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),!(f=e.findText(n,r)))return 0!=u&&alert(dext5_lang.find.msg.no_find),!1;e.select(),s?e.collapse(!1):e.collapse(!0),setAutoScrollToRange(e),g_findRepalceRange=e}}catch(l){}}function command_replace(e,t,n,r,i,s,o,u,a){dext_src_init(t),restoreSelection(),setFocusToBody();if(0!=n.length)try{var f=null;if(null==g_findRepalceRange){var l=getFirstRange().range,f=rangy.createRange(_iframeDoc);f.selectNodeContents(_iframeDoc.body),f.setStart(l.startContainer,l.startOffset)}else f=g_findRepalceRange;var c={caseSensitive:i,wholeWordsOnly:s,direction:o?"forward":"backward"},h=!1,p=(l=getFirstRange().range)&&l.toString();!i&&l&&(n=n.toLowerCase(),p=p.toLowerCase());if(p==n){l.collapse(o),f.setStart(l.startContainer,l.startOffset);if(h=f.findText(n,c)){f.select(),f.deleteContents();var d=f.getDocument().createTextNode(r);f.insertNode(d),f.selectNode(d),f.select(),o?f.collapse(!1):f.collapse(!0),a||command_find(e,t,n,i,s,o,u)}else g_findRepalceRange&&u&&(f=o?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),h=f.findText(n,c))&&(f.select(),f.deleteContents(),d=f.getDocument().createTextNode(r),f.insertNode(d),f.selectNode(d),f.select(),o?f.collapse(!1):f.collapse(!0),command_find(e,t,n,i,s,o,u));onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"replace"})}else command_find(e,t,n,i,s,o,u)}catch(v){}}function command_replaceAll(e,t,n,r,i,s,o,u,a,f){dext_src_init(t),restoreSelection(),setFocusToBody();if(0!=n.length)try{g_findRepalceRange=null,range=rangy.createRange(_iframeDoc),range.selectNodeContents(_iframeDoc.body),e={caseSensitive:i,wholeWordsOnly:s,direction:o?"forward":"backward"};for(t=0;range.findText(n,e);){range.select(),range.deleteContents();var l=range.getDocument().createTextNode(r);range.insertNode(l),f&&range.selectNode(l),range.select(),t+=1,o?range.collapse(!1):range.collapse(!0)}0<t&&!a&&alert(t+dext5_lang.replace.replaceall_result),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"replace"})}catch(c){}}function command_highlightAll(e,t,n,r,i,s){dext_src_init(t),restoreSelection(),setFocusToBody();if(0!=r.length)try{doSetCaretPosition(_iframeDoc.body.firstChild,!1,null,!0);var o=getFirstRange().range,u=rangy.createRange(_iframeDoc);u.selectNodeContents(_iframeDoc.body),u.setStart(o.startContainer,o.startOffset),e={caseSensitive:i,wholeWordsOnly:s,direction:"forward"};var a=rangy.createCssClassApplier("raon_highlighter");for(0==u.findText(r,e)&&(u=moveCursorToTag(_iframeDoc.body,!0));u.findText(r,e);)u.select(),"add"==n?a.applyToRange(u):"remove"==n&&a.undoToRange(u),u.collapse(!1);(_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection).removeAllRanges(),"remove"==n&&doSetCaretPosition(_iframeDoc.body.firstChild,!1,null,!0)}catch(f){throw f}}function command_changeWordUpperLower(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),e=function(e,t){try{var r=t.startContainer;r.firstNode&&(r=r.firstNode);var i=t.startOffset,s=t.endContainer;s.lasttNode&&(s=s.lasttNode);for(var o=t.endOffset,u=e.length,a=0;a<u;a++){var f=e[a];if(3==f.nodeType){var l=f.nodeValue,h,p,d;h=p=d="",f==r&&f==s?(p=l.substring(0,i),h=l.substring(i,o),d=l.substring(o,l.length)):f==r&&0<i?(p=l.substring(0,i),h=l.substring(i,l.length)):f==s&&o<l.length?(h=l.substring(0,o),p=l.substring(o,l.length)):h=l;if("UPPER"==n)h=h.toUpperCase();else if("LOWER"==n)h=h.toLowerCase();else{if("FIRSTUPPER"!=n)break;var v=h.substring(0,1),m=h.substring(1,h.length);h=v.toUpperCase()+m.toLowerCase()}l=f==r&&f==s?p+h+d:f==r&&0<i?p+h:h+p,f.nodeValue=l}}}catch(g){}},t=getFirstRange();var r=t.range,i=GetTableSelectionCells(),s=i.length;if(!r.collapsed||0!=s){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0<s)for(var o=r.cloneRange(),u=0;u<s;u++){var a=getAllTextNodeByNode(i[u]),f=a.length;0<f&&(t.sel.removeAllRanges(),r.selectNode(i[u]),t.sel.addRange(r),e(a,r),t.sel.removeAllRanges(),t.sel.addRange(o))}else a=getSelectionTextNodes(r),f=a.length,0<f&&(e(a,r),r.setStart(a[0],0),r.setEnd(a[f-1],a[f-1].length),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(r));DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"tool_replace"})}}function moveCursorToTag(e,t){if(null!=e&&void 0!=e){var n=rangy.createRange(_iframeDoc);n.selectNodeContents(e);try{t?n.collapse(!0):n.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(n)}catch(r){}return n}}function getNextNode(e){if(e.firstChild)return e.firstChild;for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function getNodesInRange(e){var t=e.startContainer,n=e.endContainer;e=e.commonAncestorContainer;var r=[],i;for(i=t.parentNode;i&&(r.push(i),i!=e);i=i.parentNode);r.reverse();for(i=t;i&&(r.push(i),i!=n);i=getNextNode(i));return r}function getAllNodesInBody(e,t){var n=[];if(t){var r=e.getElementsByTagName("*");if(r)for(var i=r.length,s=0;s<i;s++){var o=r[s];o.tagName.toLowerCase(),1==o.nodeType&&n.push(o)}}else for(o=e.childNodes[0];null!=o;)if(1==o.nodeType&&n.push(o),o.hasChildNodes())o=o.firstChild;else{for(;null==o.nextSibling&&o!=e;)o=o.parentNode;o=o.nextSibling}return n}function setAutoScrollToRange(e){try{var t=e.startContainer.parentNode;if(t){var n=getElementOffset(t);_iframeWin.scroll(n.left,n.top)}}catch(r){}}function getNextSiblings(e,t){for(;e=e.nextSibling;)1!=e.nodeType&&3!=e.nodeType||t.push(e)}function firstElementChild(e){var t=e.firstElementChild;if(!t)for(t=e.firstChild;t&&1!==t.nodeType;)t=t.nextSibling;return t}function getTextNodesBetween(e){function t(e){var l=e.nodeValue;e==r&&e==i&&e!==n?(l&&f.push(l.substring(s,o)),u=a=!0):e==r?(l&&f.push(l.substring(s)),u=!0):e==i?(l&&f.push(l.substring(0,o)),a=!0):3==e.nodeType&&l&&u&&!a&&!/^\s*$/.test(l)&&f.push(l);for(var l=0,v=e.childNodes.length;!a&&l<v;++l)t(e.childNodes[l])}var n=e.commonAncestorContainer,r=e.startContainer,i=e.endContainer,s=e.startOffset,o=e.endOffset,u=!1,a=!1,f=[];return t(n),f}function getSelectionTextNodes(e){function t(e){var a=e.nodeValue;e==r&&e==i&&e!==n?(a&&u.push(e),s=o=!0):e==r?(a&&u.push(e),s=!0):e==i?(a&&u.push(e),o=!0):3==e.nodeType&&a&&s&&!o&&!/^\s*$/.test(a)&&u.push(e);for(var a=0,l=e.childNodes.length;!o&&a<l;++a)t(e.childNodes[a])}var n=e.commonAncestorContainer,r=e.startContainer,i=e.endContainer,s=!1,o=!1,u=[];return t(n),u}function saveSelection(e,t){if(0!=DEXTTOP.DEXT5.browser.ie||0!=!!t){var n=document.getElementById("dext5_design_"+e);dext_src_init(n);var n=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,r;try{n&&(n.createRange?r=n.createRange():n.getRangeAt?r=n.getRangeAt(0):n.anchorNode&&n.focusNode&&doc.createRange&&(r=_iframeDoc.createRange(),r.setStart(n.anchorNode,n.anchorOffset),r.setEnd(n.focusNode,n.focusOffset),r.collapsed!==n.isCollapsed&&(r.setStart(n.focusNode,n.focusOffset),r.setEnd(n.anchorNode,n.anchorOffset))))}catch(i){}return r}}function restoreSelection(e,t){if(0!=DEXTTOP.DEXT5.browser.ie||0!=!!t)try{_iframeDoc.body.focus();var n=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,r=getEditrFromEvent(null);if(null==e||void 0==e)e=r._LastRange;n&&e&&(e.select?e.select():n.removeAllRanges&&n.addRange&&(n.removeAllRanges(),n.addRange(e)),r._LastRange=null)}catch(i){}}function createBookmark(){var e=document.getElementById("dext5_design_"+G_USE_EDITOR_ID);dext_src_init(e);var e=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,t;try{e&&(e.createRange?t=e.createRange():e.getRangeAt?t=e.getRangeAt(0):e.anchorNode&&e.focusNode&&doc.createRange&&(t=_iframeDoc.createRange(),t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset),t.collapsed!==e.isCollapsed&&(t.setStart(e.focusNode,e.focusOffset),t.setEnd(e.anchorNode,e.anchorOffset))))}catch(n){}return t}function goToBookmark(e){if(0!=DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.focus();var t=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;t&&e&&(e.select?e.select():t.removeAllRanges&&t.addRange&&(t.removeAllRanges(),t.addRange(e)))}catch(n){}}function RemoveUnnecessaryChar(e){return e=ReplaceAll(e,unescape("%uFEFF"),""),e=ReplaceAll(e,unescape("%u200b"),"")}function CleanZeroChar(e){if("0"==DEXTTOP.G_CURREDITOR._config.removeEmptyTag)return e;var t="span b strong i em strike u sup sub font".split(" "),n=new RegExp("(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>","gim");e=e.replace(n,"$1"+unescape("%u200B")+"</span>");for(var n=t.length,r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"font","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"b","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"strong","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"i","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"em","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"strike","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue
(e,"u","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"sup","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");e=setCleanTagOrValue(e,"sub","");for(r=0;r<n;r++)e=setCleanTagOrValue(e,t[r],"");return t="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>",n=new RegExp(t,"gim"),e=e.replace(n,"$1</span>")}function replaceEmptySpanTag(e){return e=e.replace(RegExp("(<span[^>]*?>)(?:| |)</span>","gim"),"$1"+unescape("%u200B")+"</span>")}function setCleanTagOrValue(e,t,n){for(;;){var r,i;"span"==t?(r="<"+t+"></"+t+">",i="<"+t+" [^>]*></"+t+">"):(r="<"+t+">(?:\\s|<br>|<br />|  | |)</"+t+">",i="<"+t+" [^>]*>(?:\\s|<br>|<br />|  | |)</"+t+">"),r=new RegExp(r,"gim"),e=e.replace(r,n),i=new RegExp(i,"gim"),e=e.replace(i,n);if(0==r.test(e)&&0==i.test(e))break}return e}function getApplyDragResize(e){var t=!1;if("1"==e._config.dragResize&&!DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.mobile&&"1"==e._config.useAutoToolbar)if(0<e._config.dragResizeApplyBrowser.length)for(var n=e._config.dragResizeApplyBrowser.length,r=0,i;r<n;r++)switch(i=e._config.dragResizeApplyBrowser[r].toLowerCase(),i){case"ie":DEXTTOP.DEXT5.browser.ie&&7<=DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(t=!0);break;case"edge":DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion&&(t=!0);break;case"firefox":DEXTTOP.DEXT5.browser.gecko&&(t=!0);break;case"chrome":DEXTTOP.DEXT5.browser.chrome&&(t=!0);break;case"opera":DEXTTOP.DEXT5.browser.opera&&(t=!0);break;case"safari":DEXTTOP.DEXT5.browser.safari&&(t=!0)}else t=!0;return e._config.useMouseTableInoutdent&&!DEXTTOP.DEXT5.browser.mobile&&(t=!0),t}function dext_src_init_once(e,t){rangy.init(),_iframeWin=rangy.dom.getIframeWindow(e),_iframeDoc=rangy.dom.getIframeDocument(e),createTableResizeBar(_iframeDoc);if(getApplyDragResize(t))try{t.dext_dragresize&&t.dext_dragresize.remove(_iframeDoc),t.dext_dragresize=new DextDragResize,t.dext_dragresize.apply(_iframeDoc)}catch(n){}DEXTTOP.DEXT5.util.addEvent(document,"keyup",_dextiframe_Keyup,!1),DEXTTOP.DEXT5.util.addEvent(document,"keydown",_dextiframe_Keydown,!1),DEXTTOP.DEXT5.util.addEvent(window,"unload",_dextiframe_Unload),DEXTTOP.DEXT5.util.addEvent(window,"beforeunload",_dextiframe_BeforeUnload),0==(DEXTTOP.DEXT5.browser.mobile&&"1"==t._config.useAutoToolbar&&DEXTTOP.DEXT5.browser.iOS)&&(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousedown",_iframeDoc_MouseDown,!0),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUp,!0),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUpMenu)),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",_iframeDoc_MouseMove,!0),"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseout",_iframeDoc_MouseOut,!0),"1"!=t._config.contextMenuDisable&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"contextmenu",_iframeDoc_ContextMenu),DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"dblclick",_iframeDoc_DBClick),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"click",_iframeBody_Click),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.documentElement,"click",_iframeBody_Click),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keyup",_iframeDoc_Keyup),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keydown",_iframeDoc_Keydown),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keypress",_iframeDoc_Keypress);try{DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"input",_iframeDoc_input)}catch(r){}if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari&&"windows"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase())DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"paste",_iframeDoc_Paste),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"beforepaste",_iframeDoc_BeforePaste);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",_iframeDoc_Copy),DEXTTOP.DEXT5.util.addEvent(document,"dragover",_iframeDoc_OnDropOver),"1"==t._config.dragAndDropAllow&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)||DEXTTOP.DEXT5.util.addEvent(_iframeWin,"dragover",_iframeDoc_OnDropOver),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"dragstart",_iframeDoc_DragStart),DEXTTOP.DEXT5.util.addEvent(_iframeWin,"scroll",_iframeDoc_Scroll),DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"beforedeactivate",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"focus",_iframeDoc_FocusHandler)):(DEXTTOP.DEXT5.util.addEvent(_iframeWin,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"focus",_iframeDoc_FocusHandler)),"0"==t._config.dragAndDropAllow||"view"==t._config.mode?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1}),DEXTTOP.DEXT5.util.addEvent(document,"drop",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1})):(DEXTTOP.DEXT5.browser.gecko?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEvent(document,"drop",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1})):(DEXTTOP.DEXT5.browser.ie&&9<DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie)&&"ieplugin"!=t._config.runtimes&&(DEXTTOP.DEXT5.util.addEvent(document,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage)),"ieplugin"==t._config.runtimes&&(DEXTTOP.DEXT5.util.addEvent(document,"drop",dropMousePosition),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",dropMousePosition)));if(("1"==t._config.view_mode_auto_height||"1"==t._config.view_mode_auto_width)&&"view"==t._config.mode){var i=function(e){return function(t){DEXTTOP.G_CURREDITOR=e,set_view_mode_auto_height(e)}}(t),s=document.getElementById("dext5_design_"+t.ID);DEXTTOP.DEXT5.util.addEvent(s,"load",i)}DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&"1"==t._config.useAutoToolbar&&(DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchstart",_iframeDoc_MouseDown),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchmove",_iframeDoc_MouseMove),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchend",_iframeDoc_MouseUp),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchend",_iframeDoc_MouseUpMenu));try{_iframeDoc.execCommand("MultipleSelection",null,!0)}catch(o){}if("0"==DEXTTOP.G_CURREDITOR._config.autoUrlDetect)try{_iframeDoc.execCommand("AutoUrlDetect",!1,!1)}catch(u){}if(DEXTTOP.DEXT5.browser.gecko)try{_iframeDoc.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}if(!isViewMode(t)){if("1"==t._config.defaultImemode&&(8>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks))try{var f=_iframeDoc.createElement("input");f.style.width="100px",f.style.height="30px",f.type="text",f.style.display="none",f.style.imeMode="active",_iframeDoc.body.appendChild(f),f.focus(),_iframeWin.focus(),_iframeDoc.body.removeChild(f)}catch(l){}""!=t._config.tabIndexObjId?0==DEXTTOP.DEXT5.browser.ie&&setTimeout(function(){setBodyDefaultValue(t)},0):((!DEXTTOP.DEXT5.browser.ie||t._config.initFocus&&DEXTTOP.DEXT5.browser.ie)&&setTimeout(function(){setBodyDefaultValue(t),onChange({editor:t})},0),setTimeout(function(){DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion?t._config.initFocus&&setFocusToBody(t):setFocusToBody(t)},0)),setTimeout(function(){try{DEXTTOP.DEXT5.browser.ie?DEXTTOP.DEXT5.util.addEvent(document.body,"focus",_dextiframe_Focus):DEXTTOP.DEXT5.util.addEvent(window,"focus",_dextiframe_Focus)}catch(e){}},1e3)}onInitOnce({editor:t})}function _dextiframe_Focus(e){if(DEXTTOP.DEXT5.browser.ie)try{var t=getEditrFromEvent(e),n=t._dextframeHasFocus;"1"==t._config.tabSequenceMode&&(n=!0);if(0==n){setFocusToBody(),DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var r=document.getElementsByTagName("A");0<r.length&&(r[0].className="")}checkDefaultMessage()}t._dextframeHasFocus=!0}catch(i){}else setTimeout(function(){try{var t=getEditrFromEvent(e),n=t._dextframeHasFocus;"1"==t._config.tabSequenceMode&&(n=!0);if(0==n){setFocusToBody(),DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var r=document.getElementsByTagName("A");0<r.length&&(r[0].className="")}checkDefaultMessage()}t._dextframeHasFocus=!0}catch(i){}},0)}function _iframeDoc_BeforePaste(e){setDEXTWINDOC();var t=getEditrFromEvent(e);if(isViewMode(t))DEXTTOP.DEXT5.util.cancelEvent(e);else if(e=e.target?e.target:e.srcElement,e=e.tagName?e.tagName.toLowerCase():null,!DEXTTOP.DEXT5.browser.ie||"textarea"!=e.toLowerCase()&&"input"!=e.toLowerCase())G_dext5plugIn||DEXTTOP.DEXT5.browser.ie&&"paste"!=G_LAST_CMD&&1==DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&setPasteBin()}function setPasteBin(){try{if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var e=null,t=!1;DEXTTOP.G_CURREDITOR.setTextPaste&&"1"==DEXTTOP.G_CURREDITOR._config.pasteToTextMode&&(t=!0),e=t?document.createElement("textarea"):document.createElement("div"),e.id="pasteDiv";var n=DEXTTOP.DEXT5.UserAgent;return"10"==n.os.version&&"IE"==n.browser.name||0!=t||(e.innerHTML=unescape("%uFEFF")),e.style.position="absolute",e.style.filter="alpha(opacity=0)",e.style.overflow="hidden",DEXTTOP.DEXT5.browser.gecko?(e.style.left="0px",e.style.top="0px"):(e.style.left="-1000px",e.style.top="-1000px"),DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion?(e.style.width="999px",e.style.height="999px"):(e.style.width="0px",e.style.height="0px"),e.contentEditable=!0,e.onpaste=fn_PasteIE,document.body.appendChild(e),0==DEXTTOP.G_CURREDITOR.initPaste?document.body.focus():DEXTTOP.G_CURREDITOR.initPaste=!1,e.focus(),!0}}catch(r){return!0}}function setPasteBinForGecko(){if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var e=document.createElement("iframe");e.id="pasteIframe",e.frameBorder=0,e.style.width="0px",e.style.height="0px",e.style.position="absolute",e.style.left="0px",e.style.top="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)e.style.overflow="hidden",e.style.display="inline-block";var t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"";e.src=t,document.body.appendChild(e),e=getIframeDocument(e),e.open("text/html","replace"),isCustomDomain(document)&&(e.domain=document.domain),e.write('<body contenteditable="true">'+unescape("%uFEFF")+"</body>"),e.close(),e.body.contentEditable=!0,e.body.onpaste=fn_PasteIE,e.body.focus()}}function _iframeDoc_Paste(e){setDEXTWINDOC();var t=getEditrFromEvent(e);if(isViewMode(t))DEXTTOP.DEXT5.util.cancelEvent(e);else{if(DEXTTOP.DEXT5.browser.ie&&0==t.AccessClipboardForIEGecko)return!0;var n=e.target?e.target:e.srcElement,n=n.tagName?n.tagName.toLowerCase():null;if("textarea"!=n.toLowerCase()&&"input"!=n.toLowerCase()){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var n=!1,r="",i=!1;if(e&&e.clipboardData&&e.clipboardData.getData){for(var s=e.clipboardData.types,o=s.length,u=!1,a=!1,f=!1,l=0;l<o;l++){var c=s[l].toLowerCase();-1<c.indexOf("files")?u=!0:-1<c.indexOf("text/html")?a=!0:-1<c.indexOf("text/plain")&&(f=!0)}u&&(i=!0);if(u&&e.clipboardData.getData("text/html")&&-1<e.clipboardData.getData("text/html").indexOf("><!--p."))n=!1;else if(a)r=e.clipboardData.getData("text/html"),n=!0;else if(f&&(r=e.clipboardData.getData("text/plain"),n=!0,s="",o=findUrlInText(r,DEXTTOP.G_CURREDITOR),""!=o.changedData&&(s=r,r=o.changedData),a=function(e){return e="1"==DEXTTOP.G_CURREDITOR._config.pasteTextLineBreak?addLineBreaker("p",e):DEXTTOP.DEXT5.util.escapeHtml(e),e=e.replace(/\t/g,DEXTTOP.G_CURREDITOR._config.tabSpace),e=e.replace(/ /g,"&nbsp;"),G_wordProcessorType="TEXT",e},r=a(r),""!=o.changedData)){o.changedData=r;try{r=replaceRealUrl(o)}catch(h){r=a(s)}}if(n)try{if(0>DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,")){var p=RegExp("<img[^>]+file://[^>]+>","gi");if(p.test(r)){var d=e.clipboardData.getData("text/rtf");t._config.clipImageHex=[];var s=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,p=new RegExp("(?:("+s.source+"))([\\da-fA-F\\s]+)\\}","g"),v,l="";if(v=d.match(p))for(var m=v.length,p=0;p<m;p++)if(s.test(v[p])){if(-1!==v[p].indexOf("\\pngblip"))l="image/png";else{if(-1===v[p].indexOf("\\jpegblip"))continue;l="image/jpeg"}t._config.clipImageHex.push({hex:l?v[p].replace(s,"").replace(/[^\da-fA-F]/g,""):null,type:l})}}}}catch(g){t._config.clipImageHex=[]}(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||t.AccessClipboardForIEGecko)&&n&&""==r&&u&&(n=!1)}DEXTTOP.G_CURREDITOR.pasteEvt=e,DEXTTOP.G_CURREDITOR.clipData=r,DEXTTOP.G_CURREDITOR.bTextorHtmlData=n,DEXTTOP.G_CURREDITOR.clipImageBlob=null;if("1"==DEXTTOP.G_CURREDITOR._config.pasteToImage||"2"==DEXTTOP.G_CURREDITOR._config.pasteToImage){try{testCanvas=document.createElement("canvas");if("undefined"!=typeof testCanvas.toBlob&&1==i){for(var y=e.clipboardData.items.length,l=0;l<y&&(!/image\//.test(e.clipboardData.items[l].type)||(DEXTTOP.G_CURREDITOR.clipImageBlob=e.clipboardData.items[l].getAsFile(),!DEXTTOP.G_CURREDITOR.clipImageBlob));l++);if(DEXTTOP.G_CURREDITOR.clipImageBlob){DEXTTOP.DEXT5.util.cancelEvent(e);if(-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector){var b=DEXTTOP.G_CURREDITOR.clipImageBlob,w=b.name.split(".").pop(),E=function(){return function(e,t,n){0==n?setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},10):DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage")}}();D5FileDetector(b,w,E)}else DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage");return}}command_pasteHtml5(DEXTTOP.G_CURREDITOR)}catch(S){command_pasteHtml5(DEXTTOP.G_CURREDITOR)}testCanvas=void 0}else command_pasteHtml5(DEXTTOP.G_CURREDITOR);setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})},500)}}}function _iframeDoc_Keypress(e){setDEXTWINDOC();var t="which"in e?e.which:e.keyCode;try{var n=getEditrFromEvent(e),r=n._config,i=e.target?e.target:e.srcElement,s=i.tagName?i.tagName.toLowerCase():null;if(!DEXTTOP.DEXT5.browser.ie||"textarea"!=s.toLowerCase()&&"input"!=s.toLowerCase()){if("1"!=r.formMode&&"1"==r.userTableLock.use){var o=getFirstRange().range.startContainer;3==o.nodeType&&(o=o.parentNode);var u=GetTDTHCell(o),a;u&&(a=GetParentbyTagName(o,"table"));var s=!0,f=r.userTableLock.defaultTableLockMode;a&&("2"==r.userTableLock.tableLockMode?checkLockAttr(a,!0)&&checkLockAttr(u,!0)?a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(f=a.getAttribute("lock_mode")):f="0":a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(f=a.getAttribute("lock_mode"))),"1"==f?s=!1:"0"==f&&(s=!1,u=null);if(u){if(s&&checkLockAttr(a)){if(n.lastElemForLock)setFocusForLock(n.lastElemForLock);else{var l=findNoLockElem(a);l?setFocusForLock(l):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(event),DEXTTOP.DEXT5.util.cancelEvent(event);return}if(checkLockAttr(u,!s)){n.lastElemForLock?setFocusForLock(n.lastElemForLock):setFocusForLock(findNoLockCell(a)),DEXTTOP.DEXT5.util.stopEvent(event),DEXTTOP.DEXT5.util.cancelEvent(event);return}}}try{if(13==t&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){var c=getFirstRange().range,h=getMyElementNode(c.startContainer);if(1==h.nodeType&&-1<",SPAN,U,I,STRONG,B,S,STRIKE,EM,SUP,SUB,".indexOf(","+h.tagName+",")){var p=h.innerHTML.toLowerCase();""==p&&11>=DEXTTOP.DEXT5.browser.ieVersion?h.innerHTML=unescape("%u200B"):"<br>"!=p&&"<br/>"!=p&&"<br />"!=p||11!=DEXTTOP.DEXT5.browser.ieVersion||(h.innerHTML=unescape("%u200B"))}}}catch(d){}if("1"==r.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{i=getFirstRange().range.startContainer,3==i.nodeType&&(i=i.parentNode),"function"==typeof DEXTTOP.G_CURREDITOR._config.event.key?DEXTTOP.G_CURREDITOR._config.event.key("keypress",e,i,n.ID):DEXTTOP.DEXTWIN.dext_key_event("keypress",e,i,n.ID)}catch(v){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if(""!=r.enterTag){var i=!1,m,g,y;y=r.enterTag;if(13==t){if(!e.shiftKey)if("undefined"!=typeof _iframeWin.getSelection){if(g=_iframeWin.getSelection(),g.getRangeAt&&g.rangeCount){m=g.getRangeAt(0),m.deleteContents();var b=_iframeDoc.createElement(y);m.insertNode(b),m.setEndAfter(b),m.setStartAfter(b),m.collapse(!1),g.removeAllRanges(),g.addRange(m);if(11<=DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie){var w=b.nextSibling;if(null==w||3==w.nodeType&&""==w.nodeValue)b=_iframeDoc.createElement(y),m.insertNode(b),m.setEndBefore(b),m.setStartBefore(b),m.collapse(!1),g.removeAllRanges(),g.addRange(m)}var i=!0,E=b.nextSibling;1!=E.nodeType&&(E=E.parentElement),focusToElement(E)}}else"undefined"!=typeof _iframeDoc.selection&&(g=_iframeDoc.selection,g.createRange&&(m=g.createRange(),"div"==y?(y=getDefaultParagraphValue(!0),pasteHtmlAtCaretHuge(b.outerHTML)):y="<"+y+" />",m.pasteHTML(y),m.collapse(!1),m.select(),i=!0));i&&DEXTTOP.DEXT5.util.cancelEvent(e)}}if("0"==n._config.removeEmptyTagReplaceDefaultParagraphValue&&13==t&&!e.shiftKey&&!e.ctrlKey){var S=getFirstRange().range.startContainer;3==S.nodeType&&(S=S.parentNode),""!=S.innerHTML&&S.innerHTML!=unescape("%u200B")||n.insertBrNodes.push(S)}}}catch(x){}}function _iframeDoc_Keydown(e){setDEXTWINDOC();var t="which"in e?e.which:e.keyCode;if(!checkDefaultMessage(e)){var n=getEditrFromEvent(e);if(1==n.setValueIsBusy)DEXTTOP.DEXT5.util.cancelEvent(e);else if(isViewMode(n)){if(0==(9==t||38==t||40==t||37==t||39==t)){var r=!0;if(e.ctrlKey||e.metaKey)"1"==n._config.viewModeAllowCopy&&67==t&&(r=!1),70==t&&(r=!1),80==t&&(r=!1);r&&DEXTTOP.DEXT5.util.cancelEvent(e)}}else{getApplyDragResize(n)&&n.dext_dragresize.G_dextResizeDiv&&n.dext_dragresize.keyDown(e);try{G_KEY_IMG_COUNT=_iframeDoc.getElementsByTagName("img").length}catch(i){}var s=e.target?e.target:e.srcElement,o=s.tagName?s.tagName.toLowerCase():null;if(0==checkContentEditable(n,s)){r=!0;if(e.ctrlKey||e.metaKey)67==t&&(r=!1),70==t&&(r=!1),80==t&&(r=!1);r&&DEXTTOP.DEXT5.util.cancelEvent(e)}else{var u=!1;if("textarea"==o||"input"==o)u=!0;if(0==u&&"1"!=n._config.formMode&&"1"==n._config.userTableLock.use){var a=getFirstRange().range.startContainer;3==a.nodeType&&(a=a.parentNode);var f=GetTDTHCell(a),l;f&&(l=GetParentbyTagName(a,"table"));var c=n._config.userTableLock.defaultTableLockMode;l&&("2"==n._config.userTableLock.tableLockMode?checkLockAttr(l,!0)&&checkLockAttr(f,!0)?l.getAttribute("lock_mode")&&""!=l.getAttribute("lock_mode")&&(c=l.getAttribute("lock_mode")):c="0":l.getAttribute("lock_mode")&&""!=l.getAttribute("lock_mode")&&(c=l.getAttribute("lock_mode")));var h=!0;"1"==c?h=!1:"0"==c&&(h=!1,f=null);if(f){if(h&&checkLockAttr(l)){if(n.lastElemForLock)setFocusForLock(n.lastElemForLock);else{var p=findNoLockElem(l);p?setFocusForLock(p):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(f,!h)){n.lastElemForLock?setFocusForLock(n.lastElemForLock):setFocusForLock(findNoLockCell(l)),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}}if(8==t||46==t){for(var d=GetTableSelectionCells(),v=d.length,m=!1,g=0;g<v;g++)if(checkLockAttr(d[g],!h)){m=!0;break}if(m){DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}}}var y=e.target?e.target:e.srcElement,b=y.tagName?y.tagName.toLowerCase():null;if(DEXTTOP.DEXT5.browser.mobile&&13==t)if(DEXTTOP.DEXT5.browser.iOS)try{var w=getFirstRange(),E=w.range,S=w.sel;if(0==E.toString().length){var x=E.startContainer;3==x.nodeType&&(x=x.parentNode);for(var T=!1;;){if("FONT"==x.tagName){T=!0;break}if("P"==x.tagName||"BODY"==x.tagName)break;x=x.parentNode}if(T){var N=_iframeDoc.createElement("span");for(x.parentNode.insertBefore(N,x);x.hasChildNodes();)N.appendChild(x.firstChild);x.getAttribute("color")&&""!=x.getAttribute("color")&&(N.style.color=x.getAttribute("color")),x.getAttribute("face")&&""!=x.getAttribute("face")&&(N.style.fontFamily=x.getAttribute("face")),N.style.cssText=x.style.cssText,n.keydownStyleForIOS.currStyle=N.style.cssText,x.getAttribute("size")&&""!=x.getAttribute("size")&&(n.keydownStyleForIOS.fontSize=DEXTTOP.DEXT5.util.getStyle(x,"fontSize"),N.style.fontSize=n.keydownStyleForIOS.fontSize),S.removeAllRanges(),x.parentNode.removeChild(x),S.addRange(E);var C=getFirstRange().range.startContainer,y=3==C.nodeType?C.parentNode:C,b=y.tagName.toLowerCase()}}}catch(k){}else if("android"==DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase())try{var L=getFirstRange(),A;if(L.range.startContainer==L.range.endContainer&&L.range.startOffset==L.range.endOffset&&0==L.range.startOffset&&(A=L.range.startContainer,3==A.nodeType&&(A=A.parentNode),(A=GetParentbyTagName(A,"p",!0))&&_iframeDoc.body.firstChild==A)){var O=A.innerHTML.toLowerCase();if(""!=O&&"<br>"!=O&&"<br />"!=O){var M=rangy.createRange(_iframeDoc).getDocument().createTextNode(unescape("%u200B"));A.insertBefore(M,A.firstChild)}}}catch(_){}"0"==n._config.removeEmptyTagReplaceDefaultParagraphValue&&(n.insertBrNodes=[]),"2"==n._config.olUlTagMode&&(0!=u||37!=t&&38!=t&&39!=t&&40!=t&&13!=t&&8!=t&&46!=t||adjustLiNodeForArrowKey("keydown",y,t,e));if("1"==n._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{y=getFirstRange().range.startContainer,3==y.nodeType&&(y=y.parentNode),"function"==typeof DEXTTOP.G_CURREDITOR._config.event.key?DEXTTOP.G_CURREDITOR._config.event.key("keydown",e,y,n.ID):DEXTTOP.DEXTWIN.dext_key_event("keydown",e,y,n.ID)}catch(D){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}-1<n.fixDEXTWINScroll.keyCodeArr.indexOf(t)&&(n.fixDEXTWINScroll.backupValue={top:DEXTTOP.DEXTWIN.pageYOffset||DEXTTOP.DEXTWIN.document.documentElement.scrollTop,left:DEXTTOP.DEXTWIN.pageXOffset||DEXTTOP.DEXTWIN.document.documentElement.scrollLeft},DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"scroll",n.fixDEXTWINScroll.fn));if(DEXTTOP.DEXT5.browser.ie&&1==e.ctrlKey&&65==t)try{"undefined"!=typeof DEXTTOP.dialogArguments&&command_selectAll(n.ID,n)}catch(P){}DEXTTOP.DEXT5.browser.gecko&&(L=getFirstRange().range,L.startContainer&&L.startContainer.tagName&&"BODY"==L.startContainer.tagName&&L.endContainer&&L.endContainer.tagName&&"BODY"==L.endContainer.tagName&&L.endOffset==_iframeDoc.body.childNodes.length&&(e.ctrlKey&&86==t||!(0!=e.ctrlKey||0!=e.altKey||38==t||40==t||37==t||39==t||91<=t&&93>=t||33<=t&&36>=t||112<=t&&123>=t)&&(32<=t&&127>=t||0==t||13==t||9==t||190<=t&&192>=t||173==t||219<=t&&222>=t))&&(_iframeDoc.body.innerHTML="<p><br></p>",doSetCaretPosition(_iframeDoc.body.firstChild)));if(!b||"textarea"!=b&&"input"!=b&&"select"!=b)if("1"==n._config.disableKeydown&&8!=t&&46!=t)DEXTTOP.DEXT5.util.cancelEvent(e);else{if(0==e.ctrlKey&&112<=t&&123>=t)return DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),!1;e.ctrlKey&&!e.altKey&&(r=nextTabKeyAccess(e,t))&&DEXTTOP.DEXT5.util.cancelEvent(e);if(r=setTableShortcut(e))return DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),!1;if(8==t){var H=e.srcElement;if(H){if(Mouse_Status==Mouse_IsControlSelecting&&1==H.nodeType&&"IMG"==H.tagName){DEXTTOP.DEXT5.util.cancelEvent(e);return}var B=getFirstRange(),j=B.range,F=B.sel;if(F&&F.docSelection&&"Control"==F.docSelection.type){DEXTTOP.DEXT5.util.cancelEvent(e);return}j&&"BODY"==j.startContainer.nodeName&&0<n.UndoManager.charCount&&n.UndoManager.putUndo()}}adjustIEEnterBug({keyCode:t,event:e});var I=n._config.undoMode;if("2"==I&&0==e.ctrlKey&&0==e.altKey){if(32==t||8==t)n.UndoManager.putUndo();else{var q=getFirstRange().range,R=3==q.startContainer.nodeType?q.startContainer.parentNode:q.startContainer,U=3==q.endContainer.nodeType?q.endContainer.parentNode:q.endContainer;n.UndoManager.tempSContainerText=R.innerText||R.textContent,n.UndoManager.tempEContainerText=U.innerText||U.textContent}n.UndoManager.charCount=99}startBookmark=endBookmark=void 0,bCtrlKey=e.ctrlKey;var z=229;DEXTTOP.DEXT5.browser.gecko&&(z=0),"1"==I&&0==e.ctrlKey&&0==e.altKey&&0==n.UndoManager.arrImageHTML.length&&(32<=t&&127>=t||t==z)?(n.UndoManager.putUndo(),n.UndoManager.charCount=0,n._iconEnable("")):8==t||46==t||e.shiftKey||1==e.ctrlKey||1==e.ctrlKey&&67==t?1==e.ctrlKey&&0==e.altKey&&0==e.shiftKey&&67==t&&0<GetTableSelectionCells().length&&(command_tableCopy(n.ID,n),DEXTTOP.DEXT5.util.cancelEvent(e)):(ClearDraggingTableCellSelected(),ActiveCurrTable=null),0==e.shiftKey&&0==bCtrlKey&&9==t&&"1"!=n._config.EditorTabDisable&&(setTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(e)),e.shiftKey&&0==bCtrlKey&&9==t&&"1"!=n._config.EditorTabDisable&&(setShiftTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(e)),!DEXTTOP.DEXT5.browser.chrome||37!=t&&38!=t&&39!=t&&40!=t||setArrowKeyAction(37)&&DEXTTOP.DEXT5.util.cancelEvent(e),!DEXTTOP.DEXT5.browser.chrome&&!DEXTTOP.DEXT5.browser.opera||39!=t&&37!=t&&38!=t||0!=e.ctrlKey||0!=e.altKey||0!=e.shiftKey||(j=getFirstRange().range,H=null,j&&j.startContainer&&(H=getMyElementNode(j.startContainer)),H?(n.keydownNodeForTableCaret.tdNode=GetTDTHCell(H),n.keydownNodeForTableCaret.backupRange=j.cloneRange()):(n.keydownNodeForTableCaret.tdNode=null,n.keydownNodeForTableCaret.backupRange=null)),e.ctrlKey&&!e.altKey&&86==t&&0==n.UndoManager.arrImageHTML.length&&(n.UndoManager.putUndo(),n.UndoManager.charCount=0,n._iconEnable(""));if(1==bCtrlKey&&0==e.altKey&&13==t&&(j=getFirstRange().range,H=null,j&&j.startContainer&&(H=getMyElementNode(j.startContainer)),H)){var W=GetTDTHCell(H);if(null==W&&"tr"==H.tagName.toLowerCase()){var X=H.cells.length;0<X&&(W=H.cells[X-1])}if(W){var V=GetParentbyTagName(W,"tr");if(l=GetParentbyTagName(W,"table")){var $=W.cellIndex,J=V.cells.length,K=V.rowIndex,Q=l.rows.length;1==Q?0==$?insertPtagTableNear(!0,l):$==J-1&&insertPtagTableNear(!1,l):0==K&&0==$?insertPtagTableNear(!0,l):(1<W.rowSpan&&(K+=W.rowSpan-1),K==Q-1&&$==J-1&&insertPtagTableNear(!1,l)),DEXTTOP.DEXT5.util.cancelEvent(e)}}}if(1==bCtrlKey){if(e.altKey&&191==t)n._dextCommands(n.ID,"about");else if(e.altKey&&220==t)n._dextCommands(n.ID,"symbol"),DEXTTOP.DEXT5.util.cancelEvent(e);else if(e.altKey&&48==t){DEXTTOP.DEXT5.util.cancelEvent(e);var G="- DEXT5 Editor Information -\n  Client Ver. "+DEXTTOP.DEXT5.ReleaseVer,G=G+("\n  Server Ver. "+DEXTTOP.DEXT5.ServerReleaseVer);if("ieplugin"==n._config.runtimes)try{G+="\n  Client Cab Ver. "+G_dext5plugIn.getDext5PluginVersion()}catch(Y){}alert(G)}else if(e.altKey&&57==t)n._config.useServerLicense||(DEXTTOP.DEXT5.util.cancelEvent(e),G="DEXT5 Editor License Information",G+="\n - Company : "+_0_[1],G+="\n - System : "+_0_[2],G+="\n - Domain : "+_0_[4],"0"!=_0_[5]&&(G+="\n - ExpireDate : "+_0_[5]),G+="\n - User Count : "+_0_[6],alert(G));else if(e.altKey&&80==t)try{G_dext5plugIn.SetLogLevel(1)}catch(Z){}else if(!e.altKey&&e.shiftKey&&67==t)DEXTTOP.DEXT5.util.cancelEvent(e),command_tableCopy(n.ID,n);else if(!e.altKey&&e.shiftKey&&86==t)DEXTTOP.DEXT5.util.cancelEvent(e),command_intablePaste(n.ID,n);else if(!e.altKey&&e.shiftKey&&(70==t||84==t))DEXTTOP.DEXT5.util.cancelEvent(e),command_tablePaste(n.ID,n);else if(!e.altKey&&86==t){"paste"==G_LAST_CMD&&(G_LAST_CMD=null);if(G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(e);var et=G_dext5plugIn.getPasteHtml();if("3"==G_dext5plugIn.getHTMLFormatFromType&&"1"==n._config.removeTdStyleInPastePpt){for(var tt=RegExp("<(td|th)([^>]*?)style='([^']*?)(font-size: 18pt; )([^']*?)'>","gi");tt.test(et);)et=et.replace(tt,"<$1$2style='$3$5'>");for(tt=RegExp('<(td|th)([^>]*?)style="([^"]*?)(font-size: 18pt; )([^"]*?)">',"gi");tt.test(et);)et=et.replace(tt,'<$1$2style="$3$5">');for(tt=RegExp("<(td|th)([^>]*?)style='([^']*?)(font-family: Arial; )([^']*?)'>","gi");tt.test(et);)et=et.replace(tt,"<$1$2style='$3$5'>");for(tt=RegExp('<(td|th)([^>]*?)style="([^"]*?)(font-family: Arial; )([^"]*?)">',"gi");tt.test(et);)et=et.replace(tt,'<$1$2style="$3$5">')}et=et.replace(/layout-flow:.*?;/gi,""),"1"==n._config.removeDummyFontTagInPaste&&6==G_dext5plugIn.getHTMLFormatFromType&&(n.hasFontNodeInPasteHtml=!1,-1<et.toLowerCase().indexOf("<font")&&(n.hasFontNodeInPasteHtml=!0)),et=et.replace(RegExp('(text-underline.*?)(;|(?="))',"gi"),""),"1"==n._config.paste_image_base64_remove&&(et=et.replace(/<img[^>]*src=["\']([^>]*:\\)([^>"\']+)["\']?[^>]*>/gi,""));if(100==G_dext5plugIn.getHTMLFormatFromType){var nt="",rt=findUrlInText(et,n);""!=rt.changedData&&(nt=et,et=rt.changedData),et=adjustTextPasteForPlugin(et);if(""!=rt.changedData){rt.changedData=et;try{et=replaceRealUrl(rt)}catch(it){et=nt,et=adjustTextPasteForPlugin(et)}}}else{var st="";try{st=G_dext5plugIn.getDext5PluginVersion()}catch(ot){}""!=st&&"5,0,0,9"<=st&&6!=G_dext5plugIn.getHTMLFormatFromType&&(et=et.replace(/\r\n/g,"\n")),"1"==n._config.removeHwpDummyTag&&(et=et.replace(/\&lt;!--\[if !supportEmptyParas\]--\&gt;/gi,""),et=et.replace(/\&lt;!--\[if !supportLists\]--\&gt;/gi,""),et=et.replace(/\&lt;!--\[endif\]--\&gt;/gi,""),et=et.replace(/\&lt;!\[if !supportEmptyParas\]\&gt;/gi,""),et=et.replace(/\&lt;!\[endif\]\&gt;/gi,""))}var ut=!1;if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(ut=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion)){var tt=RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi"),at=et.match(tt);if(at)for(var ft=at.length,g=0;g<ft;g++)if(-1<at[g].indexOf("file://")){ut=!1;break}}if(6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion){var lt=G_dext5plugIn.getPasteHtmlEx(),lt=checkCopyInCellFormInertnNet(lt);""!=lt&&(et=lt,ut=!1)}if(checkCanPasteToIamge()){if("1"==n._config.pasteToImage||"2"==n._config.pasteToImage){var ct=G_dext5plugIn.ShowImageSaveDlgFromClipboard("");try{if("HTML"==ct&&"1"==n._config.limitPasteHtmlLength.value){var ht=n._config.limitPasteHtmlLength.length,pt=G_dext5plugIn.getOriginalHtml("body");if(pt.length>ht){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1),setFocusToBody();return}}}catch(dt){}if(""==ct)return;""!=ct&&"HTML"!=ct&&(et=ct,ut=!1)}else if("0"==n._config.pasteToImage&&"1"==n._config.limitPasteHtmlLength.value&&(ht=n._config.limitPasteHtmlLength.length,pt=G_dext5plugIn.getOriginalHtml("body"),pt.length>ht)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1),setFocusToBody();return}}else try{if("1"==n._config.limitPasteHtmlLength.value&&(ht=n._config.limitPasteHtmlLength.length,pt=G_dext5plugIn.getOriginalHtml("body"),pt.length>ht)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2),setFocusToBody();return}}catch(vt){}"1"==n._config.ie_BugFixed_Hyfont&&(et=DEXTTOP.DEXT5.util.replaceHyFont(et,n));var mt=!0;ut&&(setPasteBin(),(mt=document.execCommand("paste",!1,null))?(mt=!1,fn_PasteIE()):mt=!0);if(mt){var gt=!1;6==G_dext5plugIn.getHTMLFormatFromType&&(gt=!0);var yt=document.createElement("div");yt.innerHTML=et;var bt=replaceSpanToDivContainAbsolute(yt);bt&&(et=yt.innerHTML);if(-1<n._config.disableInsertImage.indexOf(",paste_image,")){for(var bt=!1,wt=yt.getElementsByTagName("img"),g=wt.length-1;0<=g;g--){var Et=wt[g];Et.src&&0==Et.src.toLowerCase().indexOf("file:")&&(bt=!0,Et.parentNode.removeChild(Et))}bt&&(et=yt.innerHTML)}try{yt.innerHTML="",yt=null,delete yt}catch(St){}et=execReplaceMsoStyle(et),"1"==n._config.useHtmlCorrection?"1"==n._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:n._config,callFn:"htmlTagRevision",callFnParam:[et,!0,gt],callBackFn:fn_PastePlugin_htmlTagRevision_After})):(et=htmlTagRevision(et,!0,gt),fn_PastePlugin_htmlTagRevision_After(et)):fn_PastePlugin_htmlTagRevision_After(et)}}DEXTTOP.DEXT5.browser.gecko&&setPasteBinForGecko(),DEXTTOP.DEXT5.browser.ie&&"12"<=DEXTTOP.DEXT5.browser.ieVersion&&setPasteBin()}else if(!e.altKey&&83==t){if("1"==n._config.setAutoSave.useManuallySaveShortcutKey)DEXTTOP.DEXT5.manuallyTempSave(n.ID);else{for(var xt=!1,Tt=n.remove_item,Nt=Tt.length,g=0;g<Nt;g++)if("save"==Tt[g]){xt=!0;break}xt||command_saveAs("",n)}DEXTTOP.DEXT5.util.cancelEvent(e)}}else if(13==t){var Ct=!1;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)Ct=!0;if(Ct&&!e.shiftKey)try{var kt=getFirstRange().range.startContainer;3==kt.nodeType&&(kt=kt.parentNode);for(var Lt=n.checkEnterKeyTargetTagArr.length,g=0;g<Lt;g++)if(GetParentbyTagName(kt,n.checkEnterKeyTargetTagArr[g],!0)){n.isEnterKeyInTargetTag=!0;break}if(1==n.isEnterKeyInTargetTag){var At=kt;if("DIV"==At.tagName)n.changeDivTagArr.push(At);else{for(var Ot=At;;){var Mt=Ot.tagName;if("BODY"==Mt){Ot=null;break}if(Mt&&("LI"==Mt||2==Mt.length&&0==Mt.indexOf("H")))break;Ot=Ot.parentNode}null==Ot&&(At=GetParentbyTagName(At,"div",!0))&&n.changeDivTagArr.push(At)}}}catch(_t){n.isEnterKeyInTargetTag=!1,n.changeDivTagArr=[]}DEXTTOP.DEXT5.browser.ie&&setLineHeightForBgColor()}DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(e);try{if(229==t||"string"==typeof e.key&&0==e.ctrlKey&&1==e.key.length){var Dt=getFirstRange().range.startContainer,Pt=GetTDTHCell(Dt);Pt&&n.lastCellForUndoManager!=Pt&&(n.lastCellForUndoManager=Pt,n.UndoManager.putUndo(),n.UndoManager.charCount=0)}}catch(Ht){}if(DEXTTOP.DEXT5.browser.ie&&13==t&&!bCtrlKey&&!e.altKey&&!e.shiftKey){var Bt=getFirstRange(),L=Bt.range;if(Bt.sel.isCollapsed&&3==L.startContainer.nodeType){var jt=getMyElementNode(L.startContainer);"span"==jt.tagName.toLowerCase()&&jt.nextSibling&&null==jt.nextSibling.nextSibling&&1==jt.nextSibling.nodeType&&"br"==jt.nextSibling.tagName.toLowerCase()&&jt.nextSibling.removeNode(!0)}}if(1==bCtrlKey&&0==e.altKey&&89==t)n.UndoManager.execRedo(),DEXTTOP.DEXT5.util.cancelEvent(e);else if(1==bCtrlKey&&0==e.altKey&&90==t)getApplyDragResize(n)&&n.dext_dragresize.G_dextResize_elem&&n.dext_dragresize.resizeHandleClear(),"1"==n._config.undoMode&&0<n.UndoManager.charCount&&(n.UndoManager.putUndo(),n.UndoManager.charCount=0),n.UndoManager.execUndo(),DEXTTOP.DEXT5.util.cancelEvent(e);else if(0==bCtrlKey&&13==t){var Ft=!0;"1"==n._config.useUndoLightMode&&(isSelected()||(Ft=!1)),Ft&&(isSelected()&&setTimeout(function(){n.UndoManager.putUndo(),n.UndoManager.charCount=0},1),n.UndoManager.putUndo(),n.UndoManager.charCount=0)}else if(0==bCtrlKey&&(46==t||8==t)&&setDeleteKeyAction())return"1"==n._config.allowDeleteCount?(n.UndoManager.charCount+=1,n.UndoManager.charCount>=G_PutUndoCharCount&&(n.UndoManager.putUndo(),n.UndoManager.charCount=0)):(n.UndoManager.putUndo(),n.UndoManager.charCount=0),DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),!0;if(0==bCtrlKey&&(46==t||8==t)){var It=getFirstRange().range.startContainer;3==It.nodeType&&(It=It.parentNode),!DEXTTOP.DEXT5.browser.ie||1!=It.childNodes.length||It.innerHTML!=unescape("%u200B")&&It.innerHTML!=unescape("%uFEFF")||(It.innerHTML="");try{var qt=getFirstRange(),Rt=qt.range;if(Rt.startContainer==Rt.endContainer){var Ut=GetParentbyTagName(It,"p");if(Ut)if(DEXTTOP.DEXT5.browser.ie){var zt=qt.sel;if(1==DEXTTOP.DEXT5.util.isEmptyContents(Ut)){var Wt=!1,Xt=!1;if(8==t&&Ut.previousSibling){var Vt=Ut.previousSibling,$t=null;if(1!=Vt.nodeType||!Vt.childNodes||0!=Vt.childNodes.length)if(3==Vt.nodeType)try{var Jt=Vt.nodeValue,Jt=Jt.replace(/\n/g,""),Jt=Jt.replace(/\r/g,""),Jt=Jt.replace(/\t/g,""),Jt=Jt.replace(/ /g,""),Jt=Jt.replace(/\s/g,"");if(""==Jt){if(!Vt.previousSibling||1!=Vt.previousSibling.nodeType){null==Vt.previousSibling&&"BODY"==Vt.parentNode.tagName&&(Vt.parentNode.removeChild(Vt),DEXTTOP.DEXT5.util.cancelEvent(e));return}$t=getMyChildElementNode(Vt.previousSibling),Vt.parentNode.removeChild(Vt)}else $t=getMyChildElementNode(Vt)}catch(Kt){return}else $t=getMyChildElementNode(Vt);null==$t&&($t=Vt,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&e.srcElement&&"BODY"==e.srcElement.tagName&&(Xt=!0)),"BR"==$t.nodeName&&($t=Vt),Wt=!0,Vt&&"HR"==Vt.nodeName&&(Wt=!1,fn_PrevOrNextNodeForkeyDownEvt(t,qt,Ut,!0),$t=Vt.previousSibling),window.setTimeout(function(){doSetCaretPosition($t,1)},0)}else 46==t&&Ut.nextSibling&&(Wt=!0,"HR"==Ut.nextSibling.nodeName&&(Wt=!1,fn_PrevOrNextNodeForkeyDownEvt(t,qt,Ut,!0,11==DEXTTOP.DEXT5.browser.ieVersion)));Wt&&!Xt&&(zt.removeAllRanges(),Rt.selectNode(Ut),zt.addRange(Rt))}else fn_PrevOrNextNodeForkeyDownEvt(t,qt,Ut,!0)}else 0==DEXTTOP.DEXT5.util.isEmptyContents(Ut)&&fn_PrevOrNextNodeForkeyDownEvt(t,qt,Ut,!1)}}catch(Qt){}if(DEXTTOP.DEXT5.browser.ie&&"1"==n._config.allowUnableToDeleteMsg){var j=getFirstRange().range,Gt=j.endContainer,Yt=GetParentbyTagName(j.startContainer,"table"),Zt=GetParentbyTagName(Gt,"table");(Yt||Zt)&&Yt!=Zt&&alert(dext5_lang.msg.unable_to_delete)}"1"==n._config.allowDeleteCount?(n.UndoManager.charCount+=1,n.UndoManager.charCount>=G_PutUndoCharCount&&(n.UndoManager.putUndo(),n.UndoManager.charCount=0)):(Ft=!0,"1"==n._config.useUndoLightMode&&(isSelected()||(Ft=!1)),Ft&&(isSelected()&&setTimeout(function(){n.UndoManager.putUndo(),n.UndoManager.charCount=0},1),n.UndoManager.putUndo(),n.UndoManager.charCount=0));if(removePTagNearTable(t))return DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),!0}"1"==I&&0==bCtrlKey&&(32<=t&&127>=t||t==z)&&(0==n.UndoManager.index&&0<n.UndoManager.arrImageHTML.length?(n.UndoManager.arrImageHTML.length=1,n.UndoManager.charCount=0):n.UndoManager.index<n.UndoManager.arrImageHTML.length&&(n.UndoManager.arrImageHTML.length=n.UndoManager.index+1),32<t&&41>t||(n.UndoManager.charCount+=1),1==n.UndoManager.canRedo&&(n.UndoManager.canRedo=!1,n.UndoManager.canUndo=!0,n._iconEnable("")),n.UndoManager.charCount>=G_PutUndoCharCount&&(n.UndoManager.putUndo(),n.UndoManager.charCount=0)),!DEXTTOP.DEXT5.browser.ie||37!=t&&38!=t&&39!=t&&40!=t||setTableArrowKeyDownAction(e);if(1==n._config.adjustCursorInTable&&0==e.shiftKey&&0==e.ctrlKey&&0==e.altKey&&(38==t||40==t)){var L=getFirstRange().range,en=L.startContainer;if((W=GetTDTHCell(en))&&0==isSelected()){var tn=!1,nn=!1,rn=function(){try{var e=_iframeDoc.getElementsByTagName("dext_dummy");if(e)for(var t=e.length-1;0<=t;t--)e[t].parentNode.removeChild(e[t])}catch(n){}};if(40==t){a=en;if(1==a.nodeType&&0<a.childNodes.length){var sn=a.childNodes[L.startOffset];if(0==!!sn){for(g=L.startOffset-1;0<=g;g--)if(sn=a.childNodes[g]){a=sn;break}}else a=sn}if(a.nodeType&&"BR"==a.tagName&&a.nextSibling){var on=a.nextSibling;if(1==on.nodeType&&"BR"==on.tagName)null==on.nextSibling?tn=!0:nn=!0;else if(3!=on.nodeType||""!=on.textContent.replace(/\s/g,""))nn=!0}if(0==nn&&0==tn){var un=_iframeDoc.createElement("dext_dummy");try{1==a.nodeType?a.nextSibling?a.parentNode.insertBefore(un,a.nextSibling):a.parentNode.appendChild(un):3==a.nodeType&&L.insertNode(un)}catch(an){rn()}try{var fn=W.innerHTML.toLowerCase(),ln=fn.indexOf("</dext_dummy>");-1<ln&&(fn=fn.substring(ln+13),un.parentNode.removeChild(un),0==fn.indexOf("<br")&&(fn=fn.replace(/<br *([^>?+])*>/i,"")),fn=fn.replace(/<br *([^>?+])*><\//gi,"</"),0>fn.indexOf("<p")&&0>fn.indexOf("<br")&&0>fn.indexOf("<div")&&0>fn.indexOf("<table")&&(tn=!0))}catch(cn){tn=!1}}}else if(38==t){a=en;if(1==a.nodeType&&0<a.childNodes.length)if(sn=a.childNodes[L.startOffset],0==!!sn){for(g=L.startOffset-1;0<=g;g--)if(sn=a.childNodes[g]){a=sn;break}}else a=sn;if(a.nodeType&&"BR"==a.tagName&&a.previousSibling){var hn=a.previousSibling;1==hn.nodeType&&"BR"==hn.tagName&&(nn=!0)}if(0==nn&&0==tn){un=_iframeDoc.createElement("dext_dummy");try{1==a.nodeType?a.previousSibling?a.parentNode.insertBefore(un,a):a.parentNode.firstChild?a.parentNode.insertBefore(un,a.parentNode.firstChild):a.parentNode.appendChild(un):3==a.nodeType&&L.insertNode(un)}catch(pn){rn()}try{fn=W.innerHTML.toLowerCase(),ln=fn.indexOf("<dext_dummy>"),-1<ln&&(fn=fn.substring(0,ln),un.parentNode.removeChild(un),fn=fn.replace(/<br *([^>?+])*>$/i,""),fn=fn.replace(/<br *([^>?+])*><\//gi,"</"),0>fn.indexOf("</p")&&0>fn.indexOf("</div")&&0>fn.indexOf("</table")&&0>fn.indexOf("<br")&&(tn=!0))}catch(dn){tn=!0}}}if(tn){DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e);var vn=getTopOrBottomBoundNextCell(W,t);if(vn.nextCell){if(40==t){for(var mn=vn.nextCell;mn.firstChild;){if(!mn.firstChild)break;mn=mn.firstChild}3==mn.nodeType?mn=mn.parentNode:1!=mn.nodeType||"BR"!=mn.tagName&&"IMG"!=mn.tagName||(mn=mn.parentNode),doSetCaretPosition(mn,0)}else if(38==t){for(mn=vn.nextCell;mn.lastChild;){if(!mn.lastChild)break;mn=mn.lastChild}3==mn.nodeType?mn=mn.parentNode:1!=mn.nodeType||"BR"!=mn.tagName&&"IMG"!=mn.tagName||(mn=mn.parentNode),doSetCaretPosition(mn,1)}}else l=GetParentbyTagName(W,"table"),40==t?l.nextSibling&&doSetCaretPosition(l.nextSibling,0):38==t&&l.previousSibling&&doSetCaretPosition(l.previousSibling,1)}rn()}}if(32==t&&"1"==DEXTTOP.G_CURREDITOR.autoListUse)try{if(j=getFirstRange().range,0==j.toString().length&&(y=getMyElementNode(j.startContainer),y=GetParentbyTagName(y,"p"))){var gn=function(t,r){DEXTTOP.DEXT5.util.cancelEvent(e),n.UndoManager.putUndo();var i=t.innerHTML.substring(0,t.innerHTML.indexOf("1.")),i=ReplaceAll(i,"&nbsp;",""),i=DEXTTOP.DEXT5.util.rtrim(DEXTTOP.DEXT5.util.ltrim(i)),i=i.replace(/>\s+</gi,"><"),i=i+t.innerHTML.substring(t.innerHTML.indexOf("1."),t.innerHTML.length);t.innerHTML=i,i=t,t.firstChild&&1==t.firstChild.nodeType&&(i=t.firstChild),doSetCaretPosition(i,0);try{for(var s=t.childNodes,o=s.length,u=0;u<o;u++)if(3==s[u].nodeType)if(0==ReplaceAll(s[u].textContent.replace(/\s/g,""),unescape("%u200B"),"").length)s[u].textContent="";else{var a=r.replace(".","\\.").replace("*","\\*"),f=new RegExp(a,""),l=s[u].textContent.match(f);if(l&&0<l.length){s[u].textContent=s[u].textContent.replace(f,"");break}}doSetCaretPosition(i,0)}catch(c){}},yn=y.innerText,bn=j.startContainer.nodeValue,bn=bn.substring(0,getFirstRange().range.startOffset),bn=DEXTTOP.DEXT5.util.ltrim(bn),yn=DEXTTOP.DEXT5.util.ltrim(yn),yn=yn.substring(0,bn.length);if(bn==yn)switch(ReplaceAll(yn,unescape("%u200B"),"")){case"1.":gn(y,yn),command_insertOrderedList(n.ID,n);break;case"01.":gn(y,yn),command_listNumberBullets(n.ID,n,"N","decimal-leading-zero");break;case"i.":gn(y,yn),command_listNumberBullets(n.ID,n,"N","lower-roman");break;case"I.":gn(y,yn),command_listNumberBullets(n.ID,n,"N","upper-roman");break;case"a.":gn(y,yn),command_listNumberBullets(n.ID,n,"N","lower-alpha");break;case"A.":gn(y,yn),command_listNumberBullets(n.ID,n,"N","upper-alpha");break;case"*":gn(y,yn),command_insertUnOrderedList(n.ID,n)}}}catch(wn){}removeEmptyTagByBackspace(e),putUndoWordCount(e),setTimeout(function(){bCtrlKey=!1},300);if(27==t){var En=DEXTTOP.document.getElementById("dext_context_background");En&&"none"!=En.style.display&&DEXT5_CONTEXT.hide()}var Sn=e.ctrlKey,xn=e.altKey;setTimeout(function(){if(0==u){var e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode),G_CURSOR_ELEMENT=e}e=!1,0==Sn&&0==xn?e=8<=t&&13>=t||32==t||46<=t&&90>=t||96<=t&&111>=t||186<=t&&192>=t||219<=t&&222>=t||229==t:1==Sn&&0==xn&&(e=66==t||68==t||69==t||72==t||73==t||76==t||85==t||86==t||88==t||89==t||90==t||222==t),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:e})},10),"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&n.isAOver.over&&!n.isAOver.linkStyle&&e.ctrlKey&&hyperLinkIn()}}}}}function _iframeDoc_input(e){setDEXTWINDOC();var t=getEditrFromEvent(e);if("1"==t._config.returnEvent.input_event){DEXTTOP.DEXT5.config.InputEventCancel=!1;var n=getFirstRange().range.startContainer;3==n.nodeType&&(n=n.parentNode);try{"function"==typeof t._config.event.input?t._config.event.input("input",e,n,t.ID):DEXTTOP.DEXTWIN.dext_input_event("input",e,n,t.ID)}catch(r){}if(1==DEXTTOP.DEXT5.config.InputEventCancel)try{var i=getFirstRange(),s=i.range,o=new RegExp(" "+e.data+"$","g");if(o.test(s.startContainer.data))s.startContainer.data=s.startContainer.data.replace(o,"\u00a0");else if(s.startContainer.data=s.startContainer.data.replace(new RegExp(e.data+"$","g"),""),0==getClientRect(s.startContainer.parentNode).height){s.setStart(s.startContainer,s.startContainer.length),s.setEnd(s.endContainer,s.endContainer.length);var u=_iframeDoc.createElement("br");s.insertNode(u)}s.setStart(s.startContainer,s.startContainer.length),s.setEnd(s.endContainer,s.endContainer.length),i.sel.removeAllRanges(),i.sel.addRange(s),t._LastRange=s}catch(a){}}}function _iframeDoc_Copy(e){setDEXTWINDOC();var t=getEditrFromEvent(e),n=DEXTTOP.G_CURREDITOR._config.replaceMsoStyle,r=n.settingStyle.length;if(0<r)try{for(var i=getFirstRange().range.toHtml(),s=0;s<r;s++){var o=getReplaceMsoStyleReg(n.settingStyle[s].replace("mso",n.replaceAttributeName));reg_exp=new RegExp(o,"gi");if(reg_exp.test(i)){if(void 0==e.clipboardData){var u=0,a=0;if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)try{u=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft),a=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop)}catch(f){}}var l=document.createElement("div");l.style.position="absolute",l.style.left="-5000px",l.style.top=a+"px",l.id="dext_temp_copy_div_number",l.style.width="1px",l.style.height="1px",l.innerHTML=i;for(var c=0;c<r;c++)for(var h=n.settingStyle[s],p=l.querySelectorAll("span["+h.replace("mso",n.replaceAttributeName)+"]"),d=0;d<p.length;d++)if(p[d].parentNode){var v=p[d].outerHTML,m=v.substring(0,v.indexOf(">")+1),g=v.substring(v.indexOf(">")+1);if(!(-1<m.indexOf(h)))if(-1<m.indexOf("style")){var y=RegExp("(style=['\"])","gi");p[d].outerHTML=m.replace(y,"$1"+h+": "+DEXTTOP.G_CURREDITOR._config.replaceMsoStyle.styleValue[h]+"; ")+g}else y=RegExp("(<span)","gi"),p[d].outerHTML=m.replace(y,'$1 style="'+h+": "+DEXTTOP.G_CURREDITOR._config.replaceMsoStyle.styleValue[h]+';"')+g}var b=l.getElementsByTagName("table")[0];ClearDraggingTable(b),void 0!=e.clipboardData?(e.clipboardData.setData("text/html",l.innerHTML),e.preventDefault()):setTimeout(function(){try{_iframeDoc.body.appendChild(l);var e=saveSelection(t.ID,!0),n=getFirstRange(),r=n.range,i=n.sel;r.setStartBefore(l.firstChild),r.setEndAfter(l.firstChild),i.removeAllRanges(),i.addRange(r),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"copy",_iframeDoc_Copy),_iframeDoc.execCommand("copy");if(e){restoreSelection(e,!0);try{DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&_iframeWin.scroll(u,a)}catch(s){}}l.parentNode.removeChild(l),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",_iframeDoc_Copy)}catch(o){l&&l.parentNode&&l.parentNode.removeChild(l)}},0)}}}catch(w){}}function fn_PrevOrNextNodeForkeyDownEvt(e,t,n,r,i){var s=t.range,o=t.sel;t=t.range.cloneRange();var u=!1;if(46==e)try{var a=s.getBoundingDocumentRect(),f=saveSelection(DEXTTOP.G_CURREDITOR.ID,!0);o.removeAllRanges(),DEXTTOP.DEXT5.browser.ie?s.selectNode(n):s.selectNodeContents(n),1==i&&s.selectNodeContents(n),o.addRange(s);var l=s.getBoundingDocumentRect();restoreSelection(f,!0),0==Math.round(a.width)&&Math.round(a.left)==Math.round(a.right)&&Math.round(a.right)==Math.round(l.right)&&(u=!0)}catch(c){restoreSelection(t,!0)}else 8==e&&0==s.startOffset&&0==s.endOffset&&(u=!0);if(u){G_KeyDownUpSync=r;var h;8==e&&n.previousSibling?h=n.previousSibling:46==e&&n.nextSibling&&(h=n.nextSibling);if(h)if(DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.util.isEmptyContents(h))h.innerHTML="";else if("FIGURE"==h.nodeName||"HR"==h.nodeName)DEXTTOP.DEXT5.browser.ie?(o.removeAllRanges(),s.selectNode(h),o.addRange(s)):h.parentNode.removeChild(h)}}function fn_PastePlugin_htmlTagRevision_After(e){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),e=removeTagStyle(e),e=repairPasteTextInCell(e),0<e.length?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR._iconEnable("")),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(e=DEXTTOP.DEXT5.util.officeCleanByDom(e,!0),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[e,!0],callBackFn:fn_PastePlugin_officeClean_After})):(e=DEXTTOP.DEXT5.util.officeClean(e,!0),fn_PastePlugin_officeClean_After(e))):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}function fn_PastePlugin_officeClean_After(e){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),"1"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjustInPaste&&/<table/i.test(e)&&(e=command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"paste",htmlData:e})),e=OfficePasteClean(e),G_dext5plugIn&&3!=G_dext5plugIn.getHTMLFormatFromType&&(e=DEXTTOP.DEXT5.util.emptyTagRemove(e));if("HWP"==getPasteFormatType()){for(var t=RegExp("(<p [^>]*)(background:#000000;)","gi");t.test(e);)e=e.replace(t,"$1");for(t=RegExp("(<p [^>]*)(background: rgb\\(0, 0, 0\\);)","gi");t.test(e);)e=e.replace(t,"$1")}e=IEPasteRemoveEmptyNodes(e),e=DEXTTOP.DEXT5.util.htmlRevision(e),e=xssReplaceScript(null,e),e=adjustSizeInContainer({strHtml:e}),e=getImageAutoFitForPasteHtml(e);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&e&&""!=e&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&(t=getBase64ImageCountEx(e),0<t&&getBase64ImageCount()+t>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10))){var n=dext5_lang.msg.max_base64file_count,n=n.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(n),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}e=removeEditorAttribute(e);try{if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){t=e;try{t="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?DEXTTOP.G_CURREDITOR._config.event.beforePaste(e):DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(e)}catch(r){t=e}if(t)e=t;else if(0==t||""==t){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(i){}if(pasteWordCount(e)){-1<e.indexOf("dext5customdata")&&(e=checkExistCustomData(e)),e=externalPageBreakDataRaplaceInEditor(e);var s=GetTableSelectionCells(),t=document.createElement("div");t.innerHTML=e,t=t.childNodes;if(1==t.length&&t[0].tagName&&"table"==t[0].tagName.toLowerCase()&&0<s.length)0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,t[0]),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;else{s=!1;if("1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog){var o=getFirstRange().range,n=null;o.startContainer==o.endContainer&&(n=o.startContainer,3==n.nodeType&&(n=n.parentNode),n=GetTDTHCell(n)),n&&1==t.length&&t[0].tagName&&"table"==t[0].tagName.toLowerCase()&&(s=!0)}s?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=t[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=e,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=n,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(n,"table"),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):setTimeout(function(){pasteHtmlAtCaretHuge(e,!1,!1,!0)},0)}checkPasteImage(e),0>e.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable()),"base64"!=DEXTTOP.G_CURREDITOR._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground(),window.setTimeout(function(){try{contentChangeEventWrapper(),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}catch(e){}},500)}else"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}function removePTagNearTable(e){var t=!1;try{var n=getFirstRange().range;if(0<n.toString().length)return t;var r=null;n&&n.startContainer&&(r=getMyElementNode(n.startContainer));if(r&&1==r.nodeType){var i=r.innerHTML;if(""==i||"<br>"==i||"<br/>"==i||"<br />"==i)if(46==e?nearElem=r.nextSibling:8==e&&(nearElem=r.previousSibling),nearElem&&1==nearElem.nodeType&&("table"==nearElem.tagName.toLowerCase()||"blockquote"==nearElem.tagName.toLowerCase())){if(46==e)"table"==nearElem.tagName.toLowerCase()?doSetCaretPosition(nearElem.rows[0].cells[0],0):doSetCaretPosition(nearElem,0);else if(8==e)if("table"==nearElem.tagName.toLowerCase()){var s=nearElem.rows.length;doSetCaretPosition(nearElem.rows[s-1].cells[nearElem.rows[s-1].cells.length-1],0)}else{var o=nearElem.childNodes[nearElem.childNodes.length-1];o||(o=nearElem),doSetCaretPosition(o,1)}r.innerHTML="",r.parentNode.removeChild(r),t=!0}}}catch(u){}return t}function setPasteCellData(){var e=getFirstRange().range,t=null;if(e&&e.startContainer){if(t=DrageStartCell){var n=GetTDTHCell(t);if(n){if(null==DEXTTOP.G_COPIEDCELLDATA)return!1;for(var r=GetParentbyTagName(n,"tr"),e=GetParentbyTagName(n,"table"),n=n.cellIndex,r=r.rowIndex,i,s=DEXTTOP.G_COPIEDCELLDATA.length,o=0,u=0;u<s&&void 0!=e.rows[r+u];u++){for(var o=DEXTTOP.G_COPIEDCELLDATA[u].length,a=0;a<o&&!(o>e.rows[r+u].cells.length);a++)void 0!=e.rows[r+u].cells[n+a]&&(e.rows[r+u].cells[n+a].innerHTML=DEXTTOP.G_COPIEDCELLDATA[u][a],i=e.rows[r+u].cells[n+a]);try{if(e.rows[r+(u+1)])for(var f=e.rows[r+(u+1)].cells,o=0;o<=f.length;o++){var l=getClientRect(f[o]),c=getClientRect(t);if(l.left<=c.left&&l.right>c.left){n=f[o].cellIndex;break}}}catch(h){}}null!=i&&(doSetCaretPosition(i.childNodes[0],1),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==i.innerHTML&&(i.innerHTML=""))}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;t=DEXTTOP.G_COPIEDTABLE.outerHTML,0==DEXTTOP.DEXT5.browser.gecko&&(t=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?t+"<p></p>":t+getDefaultParagraphValue(!0)),pasteHtmlAtCaretHuge(t)}}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;restoreSelection(),setFocusToBody(),e=getFirstRange().range,getMyElementNode(e.startContainer),t=DEXTTOP.G_COPIEDTABLE.outerHTML,0==DEXTTOP.DEXT5.browser.gecko&&(t=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?t+"<p></p>":t+getDefaultParagraphValue(!0)),pasteHtmlAtCaretHuge(t)}return!0}return!1}function getEnterTagString(e){var t="",t=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br />",n="";return"br"==e?n="<br />":"p"==e?n="<p>"+t+"</p>":"div"==e&&(n="<div>"+t+"</div>"),n}function _iframeDoc_Keyup(e){setDEXTWINDOC();var t=getEditrFromEvent(e);if(isViewMode(t)||t.dextiframeKeydown)t.dextiframeKeydown=!1,DEXTTOP.DEXT5.util.cancelEvent(e);else{var n="which"in e?e.which:e.keyCode,r=e.target?e.target:e.srcElement,i=r.tagName?r.tagName.toLowerCase():null;"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(t.isAOver.openHelp&&17!=n?hyperHelpClose():t.isAOver.over&&(t.isAOver.node||t.isAOver.nodeChild)&&t.isAOver.linkStyle&&hyperLinkOut());if(0==checkContentEditable(t,r)){t=!0;if(e.ctrlKey||e.metaKey)67==n&&(t=!1),70==n&&(t=!1),80==n&&(t=!1);t&&DEXTTOP.DEXT5.util.cancelEvent(e)}else{r=!1;if("textarea"==i||"input"==i)r=!0;if(0==r){i=getFirstRange(),i=i.range.startContainer,3==i.nodeType&&(i=i.parentNode),G_CURSOR_ELEMENT=i,set_ruler_vertical_height(t);try{if(i&&1==i.nodeType&&"hr"==i.tagName.toLowerCase()&&!e.shiftKey&&!e.ctrlKey)if(37==n){for(;i&&(1!=i.nodeType||"hr"==i.tagName.toLowerCase());){if(3==i.nodeType){i=i.parentNode;break}if(!i.previousSibling){var s=_iframeDoc.createElement("p");if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion)s.innerHTML="&nbsp;";else{var o=_iframeDoc.createElement("br");s.appendChild(o)}i.parentNode.insertBefore(s,i)}i=i.previousSibling}if(i){if(i&&"table"==i.tagName.toLowerCase())var u=i.rows,a=u[u.length-1].cells,f=a[a.length-1],i=f.lastChild;else if("ul"==i.tagName.toLowerCase()||"ol"==i.tagName.toLowerCase())i=i.lastChild;if(i.lastChild&&1==i.lastChild.nodeType&&"br"==i.lastChild.tagName.toLowerCase()){for(var l=i.lastChild.previousSibling;l;){if(1!=l.nodeType||"br"!=l.tagName.toLowerCase())break;l=l.previousSibling}l?l&&1==l.nodeType?i=l:l&&3==l.nodeType&&(i=l):(doSetCaretPosition(i,0),i=null)}i&&doSetCaretPosition(i,1)}}else if(39==n){for(;i&&(1!=i.nodeType||"hr"==i.tagName.toLowerCase());){if(3==i.nodeType){i=i.parentNode;break}i.nextSibling||(s=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?s.innerHTML="&nbsp;":(o=_iframeDoc.createElement("br"),s.appendChild(o)),i.parentNode.appendChild(s)),i=i.nextSibling}if(i){if("table"==i.tagName.toLowerCase())u=i.rows,a=u[0].cells,f=a[0],i=f.firstChild;else if("ul"==i.tagName.toLowerCase()||"ol"==i.tagName.toLowerCase())i=i.firstChild;doSetCaretPosition(i,0)}}}catch(c){}}if(0==r&&"1"!=t._config.formMode&&"1"==t._config.userTableLock.use){i=getFirstRange(),i=i.range.startContainer,3==i.nodeType&&(i=i.parentNode);var s=GetTDTHCell(i),h;s&&(h=GetParentbyTagName(i,"table")),o=t._config.userTableLock.defaultTableLockMode,h&&("2"==t._config.userTableLock.tableLockMode?checkLockAttr(h,!0)&&checkLockAttr(s,!0)?h.getAttribute("lock_mode")&&""!=h.getAttribute("lock_mode")&&(o=h.getAttribute("lock_mode")):o="0":h.getAttribute("lock_mode")&&""!=h.getAttribute("lock_mode")&&(o=h.getAttribute("lock_mode"))),u=!0,"1"==o?u=!1:"0"==o&&(u=!1,s=null);if(s){if(u&&checkLockAttr(h)){t.lastElemForLock?setFocusForLock(t.lastElemForLock):(t=findNoLockElem(h))?setFocusForLock(t):(window.focus(),document.body.focus()),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(s,!u)){9==n&&(n=0==e.shiftKey?findNextNoLockCell(s,!0):findNextNoLockCell(s,!1))&&(t.lastElemForLock=n),t.lastElemForLock?setFocusForLock(t.lastElemForLock):setFocusForLock(findNoLockCell(h)),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}t.lastElemForLock=s}else"0"!=o&&checkLockElemInSelectionRange()}h=e.target?e.target:e.srcElement,s=h.tagName?h.tagName.toLowerCase():null;if(DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&13==n)try{var p=getFirstRange(),d=p.range,v=p.sel,m=d.startContainer;3==m.nodeType&&(m=m.parentNode);if("SPAN"==m.tagName&&m.firstChild&&1==m.firstChild.nodeType&&"BR"==m.firstChild.tagName){m.removeChild(m.firstChild);var g=rangy.createRange(_iframeDoc).getDocument().createTextNode(unescape("%uFEFF"));m.appendChild(g),doSetCaretPosition(m,1)}for(p=!1;;){if("FONT"==m.tagName){p=!0;break}if("P"==m.tagName||"BODY"==m.tagName)break;m=m.parentNode}if(p){var y=_iframeDoc.createElement("span");for(m.parentNode.insertBefore(y,m);m.hasChildNodes();)y.appendChild(m.firstChild);m.getAttribute("color")&&""!=m.getAttribute("color")&&(y.style.color=m.getAttribute("color")),m.getAttribute("face")&&""!=m.getAttribute("face")&&(y.style.fontFamily=m.getAttribute("face")),m.getAttribute("size")&&""!=m.getAttribute("size")&&(y.style.fontSize=t.keydownStyleForIOS.fontSize),null!=t.keydownStyleForIOS.currStyle&&(y.style.cssText=t.keydownStyleForIOS.currStyle),v.removeAllRanges(),m.parentNode.removeChild(m),v.addRange(d);var b=getFirstRange().range.startContainer;h=3==b.nodeType?b.parentNode:b,s=h.tagName.toLowerCase()}t.keydownStyleForIOS.currStyle=null,t.keydownStyleForIOS.fontSize=""}catch(w){}d=!1;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)d=!0;if(d&&13==n&&!e.shiftKey&&t.isEnterKeyInTargetTag){t.isEnterKeyInTargetTag=!1;try{var E=getFirstRange().range.startContainer;3==E.nodeType&&(E=E.parentNode),d=E,v=!1;if("DIV"==d.tagName)v=!0;else{for(m=d;;){var S=m.tagName;if("BODY"==S){m=null;break}if(S&&("LI"==S||2==S.length&&0==S.indexOf("H")))break;m=m.parentNode}if(null==m){var x=GetParentbyTagName(d,"div",!0);x&&(v=!0,d=x)}}if(v){var T=t.changeDivTagArr.length;if(0<T){for(var N=T-1;0<=N;N--){var C=_iframeDoc.createElement("p"),k=t.changeDivTagArr[N];setCopyAllObjectAtributes(k,C,!0),k.parentNode.replaceChild(C,k)}t.changeDivTagArr=[]}makeRangeSelectionMarkInDesign();var L=_iframeDoc.createElement("p"),S=d;setCopyAllObjectAtributes(S,L,!0),S.parentNode.replaceChild(L,S),setRangeSelectionMarkInDesign(!0)}}catch(A){setRangeSelectionMarkInDesign(!0),t.isEnterKeyInTargetTag=!1,t.changeDivTagArr=[]}}if("1"==t._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{h=getFirstRange().range.startContainer,3==h.nodeType&&(h=h.parentNode),"function"==typeof DEXTTOP.G_CURREDITOR._config.event.key?DEXTTOP.G_CURREDITOR._config.event.key("keyup",e,h,t.ID):DEXTTOP.DEXTWIN.dext_key_event("keyup",e,h,t.ID)}catch(O){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if(!(!s||"textarea"!=s&&"input"!=s&&"select"!=s))return!1;if("0"==t._config.removeEmptyTagReplaceDefaultParagraphValue&&13==n&&!e.shiftKey&&!e.ctrlKey){L=getFirstRange().range,S=L.startContainer,3==S.nodeType&&(S=S.parentNode),x=t.insertBrNodes?t.insertBrNodes.length:0;if(0<x){try{for(N=0;N<x;N++)t.insertBrNodes[N].innerHTML=DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br>"}catch(M){}t.insertBrNodes=[]}""==S.innerHTML&&(S.innerHTML=DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br>",L.collapse(!1))}if(8==n||46==n||DEXTTOP.DEXT5.browser.gecko&&e.ctrlKey&&88==n)if(3>_iframeDoc.body.childNodes.length&&(N=_iframeDoc.body.innerHTML,""==N||"<br>"==N||DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion&&"<div><br></div>"==N)&&(_iframeDoc.body.innerHTML="",setBodyDefaultValue()),G_KeyDownUpSync&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{G_KeyDownUpSync=!1;var _=getFirstRange().range,E=getMyElementNode(_.startContainer);if("SPAN"==E.nodeName){var D=E.style.cssText,P;if(E.nextSibling){var H=E.nextSibling;if(("SPAN"==H.nodeName||"FONT"==H.nodeName)&&""==H.className&&""==H.id&&null==H.nextSibling&&(F=H.style.cssText,-1<D.indexOf(F))){for(P=saveSelection(t.ID);0<H.childNodes.length;)E.appendChild(H.childNodes[0]);DEXTTOP.DEXT5.util.removeElement(H),restoreSelection(P)}}else if(E.childNodes){H=!1,P=saveSelection(t.ID);for(var B=E.childNodes.length-1,j,F;0<=B;B--)j=E.childNodes[B],"SPAN"!=j.nodeName&&"FONT"!=j.nodeName||""!=j.className||""!=j.id||(F=j.style.cssText,-1<D.indexOf(F)&&(DEXTTOP.DEXT5.util.removeElement(j),H=!0));H&&restoreSelection(P)}}}catch(I){G_KeyDownUpSync=!1}if(!e.ctrlKey&&!bCtrlKey||e.altKey){if(46==n||8==n)removeEmptyTagByBackspace(e),_iframeDoc_MouseUpMenu(e),DEXTTOP.G_SELECTED_ELEMENT=null;if(!e.shiftKey&&13==n&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){setLineHeightForBgColor();try{if(_=getFirstRange().range,E=getMyElementNode(_.startContainer),1==E.nodeType&&-1<",SPAN,U,I,STRONG,B,S,STRIKE,EM,SUP,SUB,".indexOf(","+E.tagName+",")){var q=E.innerHTML.toLowerCase();if(""==q&&11>=DEXTTOP.DEXT5.browser.ieVersion)E.innerHTML=unescape("%u200B");else if("<br>"!=q&&"<br/>"!=q&&"<br />"!=q||11!=DEXTTOP.DEXT5.browser.ieVersion){if(""!=q&&"SPAN"==E.nodeName&&(D=E.style.cssText,E.childNodes&&3>=E.childNodes.length&&(1!=E.childNodes.length||"#text"!=E.childNodes[0].nodeName))){var R=E.childNodes;P=null,"SPAN"!=R[0].nodeName&&"FONT"!=R[0].nodeName||""!=R[0].className||""!=R[0].id?"#text"==R[0].nodeName&&("SPAN"!=R[1].nodeName&&"FONT"!=R[1].nodeName||""!=R[1].className||""!=R[1].id?2==R.length&&"BR"==R[1].nodeName&&R[1].parentNode.removeChild(R[1]):(_currFCStyle=R[1].style.cssText,-1<D.indexOf(_currFCStyle)&&(P=R[1]))):(_currFCStyle=E.firstChild.style.cssText,-1<D.indexOf(_currFCStyle)&&(P=R[0])),P&&(DEXTTOP.DEXT5.util.removeElement(P),doSetCaretPosition(E,0))}}else"1"==t._config.removeEmptyTagReplaceDefaultParagraphValue&&(E.innerHTML=unescape("%u200B"))}}catch(U){}}}else if(86==n&&G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(e);return}DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(e);if(32==n||13==n||46==n||8==n||37==n||38==n||39==n||40==n||36==n||35==n||33==n||34==n){"2"==t._config.olUlTagMode&&(0!=r||37!=n&&38!=n&&39!=n&&40!=n&&13!=n||adjustLiNodeForArrowKey("keyup",h,n));try{var z=getFirstRange(),W=z.range,E=null;if(W&&W.startContainer&&(D=!0,32==n&&(D=!1),D)){if((E=z.sel.focusNode)&&3==E.nodeType)for(;1!=E.nodeType;){if(!E.parentNode)break;E=E.parentNode}else E=getMyElementNode(W.startContainer);setMenuIconRealable(E)}t._iconEnableForTextInRange()}catch(X){}DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&0==(32==n||13==n)?setTableArrowKeyUpAction(e):(!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion)&&1==(32==n||13==n)&&setAutoUrlHyperLink(e,z)}z=229,DEXTTOP.DEXT5.browser.gecko&&(z=0),0==e.ctrlKey&&0==e.altKey&&1==t.UndoManager.arrImageHTML.length&&t.isInitKeydownForSetApi&&(32<=n&&127>=n||n==z)&&(t.isInitKeydown=!1,t.UndoManager.canUndo=!0);if(e.shiftKey&&35==n){W=getFirstRange().range;try{if(1==W.endContainer.nodeType&&"BODY"==W.endContainer.tagName){for(var V=W.endContainer.childNodes[W.endOffset-1];3!=V.nodeType;)V=V.lastChild,1==V.nodeType&&"BR"==V.tagName&&(V=V.previousSibling);W.setEndAfter(V),getFirstRange().sel.addRange(W),W.collapse(!0)}}catch($){}}-1<t.fixDEXTWINScroll.keyCodeArr.indexOf(n)&&null!=t.fixDEXTWINScroll.backupValue&&(DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTWIN,"scroll",t.fixDEXTWINScroll.fn),t.fixDEXTWINScroll.backupValue=null);try{V=!1;if(DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks){if(37==n||38==n||39==n||40==n||36==n||35==n||33==n||34==n||e.ctrlKey)V=!0}else V=!0;if(V){V=null,(W=getFirstRange().range)&&0==W.toString().length&&W.startContainer&&(V=getMyElementNode(W.startContainer));if((DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(39==n||37==n||38==n)&&0==e.ctrlKey&&0==e.altKey&&0==e.shiftKey)if(t.keydownNodeForTableCaret.tdNode){var J=GetParentbyTagName(t.keydownNodeForTableCaret.tdNode,"table");if(V==J.parentNode)if(39==n){var K=J.nextSibling;try{if(null==K)restoreSelection(t.keydownNodeForTableCaret.backupRange,!0);else{var Q=!1;if(3==K.nodeType){var G=K.nodeValue,G=G.replace(/\n/g,""),G=G.replace(/\t/g,""),G=G.replace(/ /g,"");if(""==G)try{K=V.childNodes[W.startOffset+1],0==!!K&&(Q=!0)}catch(Y){Q=!0}}0==Q&&("P"==K.tagName||"TABLE"==K.tagName||"DIV"==K.tagName?K.firstChild&&(K=getFirstChildNodeForCaret(K.firstChild),doSetCaretPosition(K,0),setMenuIconRealable(K),V=K):Q=!0),Q&&restoreSelection(t.keydownNodeForTableCaret.backupRange,!0)}}catch(Z){}}else if(37==n||38==n){K=J.previousSibling;try{if(null==K)restoreSelection(t.keydownNodeForTableCaret.backupRange,!0);else{Q=!1;if(3==K.nodeType&&(G=K.nodeValue,G=G.replace(/\n/g,""),G=G.replace(/\t/g,""),G=G.replace(/ /g,""),""==G))try{1==W.startContainer.nodeType?K=V.childNodes[W.startOffset-2]:3==W.startContainer.nodeType&&(K=W.startContainer.previousSibling),0==!!K&&(Q=!0)}catch(et){Q=!0}0==Q&&("P"==K.tagName||"TABLE"==K.tagName||"DIV"==K.tagName?(K=getLastChildNodeForCaret(K),doSetCaretPosition(K,1),setMenuIconRealable(K),V=K):Q=!0),Q&&restoreSelection(t.keydownNodeForTableCaret.backupRange,!0)}}catch(tt){}}}else if(("BODY"==V.tagName||"DIV"==V.tagName)&&1==W.startContainer.nodeType)if(37==n&&0<W.startOffset)try{var nt=V.childNodes[W.startOffset-1];nt&&"TABLE"==nt.tagName&&(K=getLastChildNodeForCaret(nt),doSetCaretPosition(K,1),setMenuIconRealable(K),V=K)}catch(rt){}else if(39==n)try{var it=V.childNodes[W.startOffset];it&&"TABLE"==it.tagName&&(K=it.rows[0].cells[0],K.firstChild&&(K=getFirstChildNodeForCaret(K.firstChild),doSetCaretPosition(K,0),setMenuIconRealable(K),V=K))}catch(st){}if("2"==t._config.toolBarEnableDisableMode)try{8==n?(_=getFirstRange().range,1<_.toString().length&&_iframeDoc_MouseUpMenu(e,V)):!e.ctrlKey&&!e.shiftKey||40!=n&&38!=n&&37!=n&&39!=n&&35!=n&&36!=n&&34!=n&&33!=n||_iframeDoc_MouseUpMenu(e,V)}catch(ot){_iframeDoc_MouseUpMenu(e,V)}else _iframeDoc_MouseUpMenu(e,V)}var ut=getFirstRange();if("2"==t._config.undoMode&&0==e.ctrlKey&&0==e.altKey&&32!=n&&13!=n&&46!=n&&null!=t.UndoManager.tempSContainerText&&null!=t.UndoManager.tempEContainerText){var at=ut.range.startContainer,ft=ut.range.endContainer,at=3==at.nodeType?at.parentNode:at,ft=3==ft.nodeType?ft.parentNode:ft,lt=ft.innerText||ft.textContent;if((at.innerText||at.textContent)!=t.UndoManager.tempSContainerText||lt!=t.UndoManager.tempEContainerText)t.UndoManager.isInsertData=!0,t.UndoManager.clearNextImgData()}}catch(ct){}showWordCount(e),setRulerPositionForNode(t),setContentChangeKeyEvent(e,n),onChange({editor:t})}}}function recursionBase64ImageToServer(){if(DEXTTOP.DEXT5.browser.ie)dummy=document.getElementById("pasteDiv");else try{var e=document.getElementById("pasteIframe");e&&(dummy=getIframeDocument(e).body)}catch(t){dummy=null}for(var n=null,n=dummy?dummy.getElementsByTagName("img"):_iframeDoc.getElementsByTagName("img"),r=n.length-1;0<=r;r--){var e=n[r],i=e.src;if("data:"==i.substring(0,5))if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,"))e.parentNode.removeChild(e);else if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove)e.parentNode.removeChild(e);else if(i=i.split(","),2==i.length){n=getExtFromImageDataSrc(i[0]),postBase64ImageToServer(i[1],n,e,!0);break}}}function fn_PasteIE(e){var t=DEXTTOP.G_CURREDITOR;if(e&&e.clipboardData&&e.clipboardData.getData){try{e.clipboardData.items&&0<e.clipboardData.types.length&&(t.AccessClipboardForIEGecko=!0)}catch(n){t.AccessClipboardForIEGecko=!1}if(0==t.AccessClipboardForIEGecko){var r=e.clipboardData.types,i=r.length;if(1<i)for(var s=0;s<i;s++)if("text/html"==r[s].toLowerCase()){t.AccessClipboardForIEGecko=!0;break}}}if(t.AccessClipboardForIEGecko){try{DEXTTOP.DEXT5.browser.ie?(document.getElementById("pasteDiv").blur(),document.body.removeChild(document.getElementById("pasteDiv"))):document.body.removeChild(document.getElementById("pasteIframe")),_iframeWin.focus()}catch(o){}_iframeDoc_Paste(e)}else setTimeout(function(e){DEXTTOP.G_CURREDITOR=t;var n=null;if(DEXTTOP.DEXT5.browser.ie)n=document.getElementById("pasteDiv");else try{var r=document.getElementById("pasteIframe");r&&(n=getIframeDocument(r).body)}catch(i){n=null}if(n){n.blur();var s="",r=!1;DEXTTOP.G_CURREDITOR.setTextPaste&&"1"==DEXTTOP.G_CURREDITOR._config.pasteToTextMode&&(r=!0),r?(s=n.value,s=DEXTTOP.DEXT5.util.escapeHtml(s),n.parentNode.removeChild(n),n=null,n=document.createElement("div"),n.id="pasteDiv",document.body.appendChild(n)):s=n.innerHTML;if("html5"==t._config.runtimes)var o=RegExp("(<p [^>]*)(background:#000000;)","gi"),s=s.replace(o,function(e,t){return-1<e.indexOf('class="0"')?t:e}),o=RegExp("(<p [^>]*)(background: rgb\\(0, 0, 0\\);)","gi"),s=s.replace(o,function(e,t){return-1<e.indexOf('class="0"')?t:e});G_dext5plugIn&&"1"==DEXTTOP.G_CURREDITOR._config.removeDummyFontTagInPaste&&6==G_dext5plugIn.getHTMLFormatFromType&&0==DEXTTOP.G_CURREDITOR.hasFontNodeInPasteHtml&&-1<s.toLowerCase().indexOf("<font")&&(s=s.replace(/<\/?font(\s|\S)*?>/gi,"")),"1"==DEXTTOP.G_CURREDITOR._config.removeHwpDummyTag&&(s=s.replace(/\&lt;!--\[if !supportEmptyParas\]--\&gt;/gi,""),s=s.replace(/\&lt;!--\[if !supportLists\]--\&gt;/gi,""),s=s.replace(/\&lt;!--\[endif\]--\&gt;/gi,""),s=s.replace(/\&lt;!\[if !supportEmptyParas\]\&gt;/gi,""),s=s.replace(/\&lt;!\[endif\]\&gt;/gi,"")),s=removeDummyDivInHwp(s);if(DEXTTOP.G_CURREDITOR.setTextPaste)if(DEXTTOP.G_CURREDITOR.setTextPaste=!1,"1"==DEXTTOP.G_CURREDITOR.setTextPasteMode)for(var r="span font strong i em u strike s sub sup".split(" "),o=r.length,s=s.replace(/<b>/gi,""),s=s.replace(/<b ([^>?+])*>/gi,""),s=s.replace(/<\/b>/gi,""),u=0;u<o;u++)var a=new RegExp("</"+r[u]+">","gi"),s=s.replace(new RegExp("<"+r[u]+" *([^>?+])*>","gi"),""),s=s.replace(a,"");else r?(s=s.replace(/\r\n/g,"<br>"),s=s.replace(/\n/g,"<br>")):s=DEXTTOP.DEXT5.convertHtmlToText(s),n.innerHTML=s;s=s.replace(RegExp('(text-underline.*?)(;|(?="))',"gi"),""),s=s.replace(RegExp("(<colgroup*[^>?+]*>)<span*[^>?+]*>","gim"),"$1"),s=s.replace(RegExp("(<col*[^>?+]*>)</span>","gim"),"$1"),"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(s=s.replace(/--\x3e\s</gi,"--><")),s=dummyTagClassClear(s),restoreSelection(DEXTTOP.G_CURREDITOR._LastRange),r=n.getElementsByTagName("img"),o=r.length;if(0==o&&1==s.length&&"undefined"!=typeof e&&1==DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion)try{for(var a=-1,f=!0,u=0;u<e.clipboardData.items.length;u++)"file"==e.clipboardData.items[u].kind&&"image/png"==e.clipboardData.items[u].type?a=u:f=!1;if(f&&-1!=a){var l=e.clipboardData.items[a].getAsFile(),c=new FileReader;return c.onload=function(){var e=document.createElement("img");e.src=c.result,n.appendChild(e);var t=c.result;if("data:"==t.substring(0,5)&&(t=t.split(","),2==t.length)){var r=getExtFromImageDataSrc(t[0]);e.parentNode.removeChild(e),postBase64ImageToServer(t[1],r),checkPasteImage(n.innerHTML),pasteHtmlAtCaretHuge(n.innerHTML),document.body.removeChild(n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}c=void 0},c.readAsDataURL(l),null}}catch(h){}checkPasteImage(s);for(var p=!1,u=0;u<o;u++){var d=r[u];e=d.src;if("data:"==e.substring(0,5)&&(e=e.split(","),2==e.length)){p=!0;break}}var v=function(){!p||G_dext5plugIn&&"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod||(recursionBase64ImageToServer(),s=n.innerHTML),s=removeDummyfontTagInTable(s),"1"==DEXTTOP.G_CURREDITOR._config.ie_BugFixed_Hyfont&&(s=DEXTTOP.DEXT5.util.replaceHyFont(s,DEXTTOP.G_CURREDITOR)),n.innerHTML=s,"2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(adjustOlUlTag(n),s=n.innerHTML);var e=n.innerHTML,t=RegExp("<li.*?(mso-list).*?>","gi");if(DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion&&t.test(e)){for(var e=n.getElementsByTagName("ol"),t=e.length,r=n.getElementsByTagName("ul"),i=r.length,o=0;o<t;o++){var u=e[o].getElementsByTagName("li")[0];if(""==u.style.fontFamily){var a=u.innerHTML,f=RegExp("mso-hansi-font-family:([^;]*)","g"),l="";f.exec(a)&&(l=RegExp.$1),u.style.fontFamily=""!=l?l:"\ub9d1\uc740 \uace0\ub515"}u.firstChild.style&&""==u.firstChild.style.fontFamily&&(u.firstChild.style.fontFamily=""!=l?l:"\ub9d1\uc740 \uace0\ub515")}for(o=0;o<i;o++)u=r[o].getElementsByTagName("li")[0],""==u.style.fontFamily&&(a=u.innerHTML,f=RegExp("mso-hansi-font-family:([^;]*)","g"),l="",f.exec(a)&&(l=RegExp.$1),u.style.fontFamily=""!=l?l:"\ub9d1\uc740 \uace0\ub515"),u.firstChild.style&&""==u.firstChild.style.fontFamily&&(u.firstChild.style.fontFamily=""!=l?l:"\ub9d1\uc740 \uace0\ub515")}l=replaceSpanToDivContainAbsolute(n),o=!1,e="",t=n.childNodes.length;for(r=0;r<t;r++)i=n.childNodes[r],1==i.nodeType&&"FONT"==i.tagName?(o="",""!=i.color&&(o+="color:"+i.color+";"),""!=i.face&&(o+="font-family:"+i.face+";"),""!=i.style.cssText&&(o+=i.style.cssText),0<o.length&&(o=" style='"+o+"'"),e+="<span"+o+">"+i.innerHTML+"</span>",o=!0):3==i.nodeType?e+=i.nodeValue:8==i.nodeType?"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(e=void 0!=i.text?e+i.text:e+i.nodeValue):e+=i.outerHTML;if(1==o||l)s=e;if(DEXTTOP.DEXT5.browser.ie)document.body.removeChild(n);else try{document.body.removeChild(document.getElementById("pasteIframe"))}catch(c){}setFocusToBody(),s=execReplaceMsoStyle(s),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection?(l=!1,G_dext5plugIn&&6==G_dext5plugIn.getHTMLFormatFromType&&(l=!0),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"htmlTagRevision",callFnParam:[s,!0,l],callBackFn:fn_PasteIE_htmlTagRevision_After})):(s=htmlTagRevision(s,!0,l),fn_PasteIE_htmlTagRevision_After(s))):fn_PasteIE_htmlTagRevision_After(s)};"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector?1==o?(d=r[u],e=d.src,u=DEXTTOP.DEXT5.util.dataURItoBlob(e),e=e.split(","),e=getExtFromImageDataSrc(e[0]),D5FileDetector(u,e,function(e,t,n){0==n&&(alert(dext5_lang.msg.message_file_ext_detect),d.parentNode.removeChild(d)),v()})):v():v()}},0,e),setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})},500)}function fn_PasteIE_htmlTagRevision_After(e){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),e=removeTagStyle(e),e=ReplaceAll(e,unescape("%uFEFF"),""),e=ReplaceAll(e,unescape("%u200B"),"");if(0<e.length){e=SetCorrectOfficeHtml(e),e=SetCorrectOfficeHtmlForDOM(e);var t=!1;G_dext5plugIn&&(t=!0),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(e=DEXTTOP.DEXT5.util.officeCleanByDom(e,t),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[e,t],callBackFn:fn_PasteIE_officeClean_After})):(e=DEXTTOP.DEXT5.util.officeClean(e,t),fn_PasteIE_officeClean_After(e))}else"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}function fn_PasteIE_officeClean_After(e){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),0==/<span[^>]*?mso-bidi-font-family: \+mn-cs;.*?>/i.test(e)&&(e=DEXTTOP.DEXT5.util.emptyTagRemove(e)),e=IEPasteRemoveEmptyNodes(e),e=DEXTTOP.DEXT5.util.htmlRevision(e),e=xssReplaceScript(null,e),e=adjustSizeInContainer({strHtml:e});if(DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.gecko){"1"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjustInPaste&&/<table/i.test(e)&&(e=command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"paste",htmlData:e})),e=OfficePasteClean(e);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&e&&""!=e&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount){var t=getBase64ImageCountEx(e);if(0<t&&getBase64ImageCount()+t>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)){e=dext5_lang.msg.max_base64file_count,e=e.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(e),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}e=removeEditorAttribute(e);try{if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){t=e;try{t="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?DEXTTOP.G_CURREDITOR._config.event.beforePaste(e):DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(e)}catch(n){t=e}if(t)e=t;else if(0==t||""==t){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(r){}if(!pasteWordCount(e)){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}-1<e.indexOf("dext5customdata")&&(e=checkExistCustomData(e)),e=externalPageBreakDataRaplaceInEditor(e);var i=GetTableSelectionCells(),t=document.createElement("div");t.innerHTML=e,t=t.childNodes;if(1==t.length&&t[0].tagName&&"table"==t[0].tagName.toLowerCase()&&0<i.length)0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,t[0]),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;else{i=!1;if("1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog){var s=getFirstRange().range,o=null;s.startContainer==s.endContainer&&(o=s.startContainer,3==o.nodeType&&(o=o.parentNode),o=GetTDTHCell(o)),o&&1==t.length&&t[0].tagName&&"table"==t[0].tagName.toLowerCase()&&(i=!0)}i?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=t[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=e,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=o,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(o,"table"),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):pasteHtmlAtCaretHuge(e,!1,!1,!0)}0>e.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable()),setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC)}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();try{contentChangeEventWrapper()}catch(u){}}function IEPasteRemoveEmptyNodes(e){function t(e){function t(e){for(var n=e.childNodes,r=[],i=0,s=n.length;i<s;++i)e=n[i],e.TEXT_NODE==e.nodeType?r.push(e.data):e.ELEMENT_NODE==e.nodeType&&r.push(t(e));return r.join("").replace(/\s+/g," ")}return"string"==typeof e&&(e=_iframeDoc.getElementById(e)),"string"==typeof e.textContent?e.textContent:"string"==typeof e.innerText?e.innerText:t(e)}if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.pasteRemoveEmptyTag)try{var n=_iframeDoc.createElement("div");n.innerHTML=e;for(var r,i=n.getElementsByTagName("*"),s,o=newline=!1,u=/^\s*$/,a,f,l=0;l<i.length;l++)if(r=i[l],a=new RegExp("\\b"+r.tagName+"\\b","i"),!a.test("base basefont body br col hr html img input isindex link meta param title")&&a.test("span div b strong i em strike u sup sub")&&u.test(t(r))){s=r.getElementsByTagName("*");for(var c=0,h=s.length;c<h;c++)if(f=new RegExp("\\b"+s[c].tagName+"\\b","i"),f.test("base basefont body br col hr html img input isindex link meta param title")){o=!0;break}var p=r.innerHTML;-1<p.indexOf("&nbsp;")&&(newline=!0),p=p.replace(/(<([^>]+)>)/gi,"")," "==p&&(o=!0),o||newline||(r.parentNode.removeChild(r),--l),newline=o=!1}e=n.innerHTML}catch(d){}return e}function pasteHtmlAtCaretHuge(e,t,n,r,i){try{if(0!=e.length){var s,o,u=getFirstRange();s=u.sel,o=u.range;if(s.getRangeAt&&s.rangeCount){var a=getBlockContainer(o.startContainer),f,l,c,h;if(a){var p=_iframeDoc.createElement("div");p.innerHTML=e,l=_iframeDoc.createDocumentFragment();for(var d=!1;h=p.firstChild;)if(l.appendChild(h),0==d&&1==h.nodeType){var v=h.tagName.toLowerCase(),m=",p,table,div,hr,ol,ul,figure,h1,h2,h3,h4,h5,h6";1!=t&&(m+="input,select,button,textarea,"),-1<m.indexOf(","+v+",")&&(d=!0)}try{p&&(p.innerHTML="",delete null)}catch(g){}var y=a.tagName.toLowerCase();"div"==y&&(d=!1);if(d){if("1"==DEXTTOP.G_CURREDITOR._config.pasteWhenTableIsLast&&1==r&&l.lastChild&&1==l.lastChild.nodeType&&"TABLE"==l.lastChild.tagName){var b=_iframeDoc.createElement("p");b.innerHTML=getDefaultParagraphValue(!1),b.id="dext_paste_caret_node",l.appendChild(b)}o.deleteContents();try{f=extractBlockContentsFromCaret(!0),c=extractBlockContentsFromCaret(!1),t="";var w=f.childNodes.length,E,S;E=S,u=getFirstRange(),s=u.sel,o=u.range,o.selectNode(a),o.deleteContents();if(0<w){var x=f.childNodes[0];if(1!=w||3!=x.nodeType||0!=x.nodeValue.length){var T=!0;if("p"==y&&1==w)try{if(0==(x.tagName&&-1<",area,base,basefont,frame,hr,img,input,isindex,link,meta,param,embed,br,".indexOf(","+x.tagName.toLowerCase()+","))){var N=x.innerHTML.toLowerCase(),N=N.replace(/<(span|strong|font|i|u|strike|sup|sub|b|em|s|)>/gi,""),N=N.replace(/<(span .*?|strong .*?|font .*?|i .*?|u .*?|strike .*?|sup .*?|sub .*?|b .*?|em .*?|s .*?)>/gi,""),N=N.replace(/<(\/span|\/strong|\/font|\/i|\/u|\/strike|\/sup|\/sub|\/b|\/em|\/s|)>/gi,"");if(""==N||"<br>"==N||"<br />"==N)T=!1}}catch(C){}T&&(E=_iframeDoc.createElement(y),E.appendChild(f),setCopyAllObjectAtributes(a,E,!1),o.insertNode(E),o.setStartAfter(E),w=c?c.childNodes.length:0,0==w&&doSetCaretPosition(E,1),o.collapse(!0))}}var k;if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie||n)k=_iframeDoc.createElement("span"),k.innerHTML=DEXTTOP.DEXT5.browser.gecko?"<br>":"&nbsp;",o.insertNode(k),o.setStartAfter(k),o.collapse(!0);w=c?c.childNodes.length:0;if(0<w&&(x=c.childNodes[0],1!=w||3!=x.nodeType||0!=x.nodeValue.length)){T=!0;if("p"==y&&1==w)try{0==(x.tagName&&-1<",area,base,basefont,frame,hr,img,input,isindex,link,meta,param,embed,br,".indexOf(","+x.tagName.toLowerCase()+","))&&(N=x.innerHTML.toLowerCase(),N=N.replace(/<(span|strong|font|i|u|strike|sup|sub|b|em|s|)>/gi,""),N=N.replace(/<(span .*?|strong .*?|font .*?|i .*?|u .*?|strike .*?|sup .*?|sub .*?|b .*?|em .*?|s .*?)>/gi,""),N=N.replace(/<(\/span|\/strong|\/font|\/i|\/u|\/strike|\/sup|\/sub|\/b|\/em|\/s|)>/gi,""),""==N||"<br>"==N||"<br />"==N)&&(T=!1)}catch(L){}T&&(S=_iframeDoc.createElement(y),S.appendChild(c),setCopyAllObjectAtributes(a,S,!1),o.insertNode(S),rangy.getSelection(_iframeWin).removeAllRanges(),o.selectNode(S),o.setEndBefore(S),s.addRange(o),o.collapse(!0))}t="";var A=l.childNodes.length;s=!1;for(u=0;u<A;u++){var O=l.childNodes[u];if(1==O.nodeType&&checkBlockTag(O.tagName))1==s&&(t+="</p>",s=!1),t+=O.outerHTML;else if(1==O.nodeType&&0==checkBlockTag(O.tagName))0==s&&(t+="<p>",s=!0),t+=O.outerHTML;else if(3==O.nodeType&&0<O.nodeValue.length){var M=O.nodeValue,M=M.replace(/\r\n/g,""),M=M.replace(/\r/g,""),M=M.replace(/\n/g,""),M=M.replace(/\t/g,""),M=M.replace(/ /g,"");""!=M&&(0==s&&(t+="<p>",s=!0),t+=O.nodeValue)}else 8==O.nodeType&&"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(t=void 0!=O.text?t+O.text:t+O.nodeValue);u==A-1&&1==s&&(t+="</p>",s=!1)}if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie||n)rangy.getSelection(_iframeWin).removeAllRanges(),o.setStartBefore(k),o.setEndBefore(k),k.parentNode.removeChild(k),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(o);pasteHtmlAtCaretMini(t,r,i);try{if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie)k.removeNode?k.removeNode():k.outerHTML="";else if(!(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)){var _=a.lastChild;_&&"table"==_.tagName.toLowerCase()&&doSetCaretPosition(_.cells[0],1)}}catch(D){}}catch(P){pasteHtmlAtCaretMini(e,!1,i)}}else pasteHtmlAtCaretMini(e,!1,i)}else pasteHtmlAtCaretMini(e,!1,i)}}}catch(H){}}function pasteHtmlAtCaretMini(e,t,n){if(0!=e.length){e=insertCarriageReturnBeforeCloseCell(e);var r,i,s=getFirstRange();r=s.sel,i=s.range;if(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){if(r.getRangeAt&&r.rangeCount||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){i.deleteContents(!0);var o;try{if(""==_iframeDoc.body.innerHTML){o=_iframeDoc.createElement("div"),o.innerHTML=e;for(var u=o.childNodes,s="",a=!0,f=u.length,l=0;l<f;l++){var c=u[l];if(!c||1!=c.nodeType||"P"!=c.tagName&&"TABLE"!=c.tagName&&"DIV"!=c.tagName&&"HR"!=c.tagName&&"OL"!=c.tagName&&"UL"!=c.tagName&&"H1"!=c.tagName&&"H2"!=c.tagName&&"H3"!=c.tagName&&"H4"!=c.tagName&&"H5"!=c.tagName&&"H6"!=c.tagName)if(3==c.nodeType){var h=c.nodeValue,h=h.replace(/&/g,"&amp;"),h=h.replace(/</g,"&lt;"),h=h.replace(/>/g,"&gt;"),h=h.replace(/\r\n/g,"<br />"),h=h.replace(/\r?\n/g,"<br />"),h=h.replace(/\n/g,"<br />");0==a?s+=h:(s=s+"<p>"+h,a=!1)}else 8!=c.nodeType?0==a?s+=c.outerHTML:(s=s+"<p>"+c.outerHTML,a=!1):"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(s+=c.text);else 0==a&&(s+="</p>",a=!0),s+=c.outerHTML,a=!0}0==a&&(s+="</p>"),0<s.length&&(e=s)}}catch(p){}try{o&&(o.innerHTML="",delete null)}catch(d){}o=_iframeDoc.createElement("div"),o.innerHTML=e;if((e=getMyElementNode(i.startContainer))&&1==e.nodeType&&"BODY"==e.tagName){u=o.childNodes,s="",a=!0,f=u.length;for(l=0;l<f;l++)!(c=u[l])||1!=c.nodeType||"P"!=c.tagName&&"TABLE"!=c.tagName&&"DIV"!=c.tagName&&"HR"!=c.tagName&&"OL"!=c.tagName&&"UL"!=c.tagName?3==c.nodeType?(h=c.nodeValue,h=h.replace(/&/g,"&amp;"),h=h.replace(/</g,"&lt;"),h=h.replace(/>/g,"&gt;"),h=h.replace(/\r\n/g,"<br />"),h=h.replace(/\r?\n/g,"<br />"),h=h.replace(/\n/g,"<br />"),0==a?s+=h:(s=s+"<p>"+h,a=!1)):8!=c.nodeType&&(0==a?s+=c.outerHTML:(s=s+"<p>"+c.outerHTML,a=!1)):(0==a&&(s+="</p>",a=!0),s+=c.outerHTML,a=!0);0==a&&(s+="</p>"),0<s.length&&(e=s)}e=_iframeDoc.createDocumentFragment();for(var v;c=o.firstChild;)v=e.appendChild(c);i.insertNode(e);if(v)if(3==v.nodeType){i.selectNodeContents(v),i=i.cloneRange();try{i.setEnd(i.endContainer,i.endOffset),i.collapse(!1)}catch(m){i.setStartBefore(v),i.collapse(!0)}r.removeAllRanges(),r.addRange(i)}else if(!v||1!=v.nodeType||0!=v.outerHTML.indexOf("<table")&&0!=v.outerHTML.indexOf("<TABLE")){i.selectNodeContents(v),i=i.cloneRange();try{"IMG"==v.tagName||"HR"==v.tagName||"IFRAME"==v.tagName||"EMBED"==v.tagName?("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?i.setStartBefore(v):i.setStartAfter(v),i.collapse(!0)):(DEXTTOP.DEXT5.browser.gecko||8<DEXTTOP.DEXT5.browser.ieVersion?("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?i.setEnd(i.startContainer,i.startOffset):i.setEnd(i.endContainer,i.endOffset),i.collapse(!1)):("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?i.setStartBefore(v):i.setStartAfter(v),i.collapse(!0)),"OL"!=v.tagName&&"UL"!=v.tagName||setTimeout(function(){doSetCaretPosition(i.endContainer.lastChild.lastChild,1)},0))}catch(g){i.setStartBefore(v),i.collapse(!0)}try{r.removeAllRanges(),r.addRange(i)}catch(y){i.startContainer&&1==i.startContainer.nodeType&&setTimeout(function(){doSetCaretPosition(i.startContainer,1)},0)}}else if(e=v.getElementsByTagName("td")){var b=null,b="0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?v.rows[v.rows.length-1].cells[0].childNodes[0]:e[e.length-1].childNodes[0];if(0==b.length)doSetCaretPosition(cell,1);else{for(;0!=b.childNodes.length&&"BR"!=b.childNodes[0].tagName;)b=b.childNodes[0];doSetCaretPosition(b,0)}}try{o&&(o.innerHTML="",delete null)}catch(w){}}}else(r=_iframeDoc.selection)&&"Control"!=r.type&&(v=r.createRange(),v.collapse(!0),r.createRange().pasteHTML(e),i=r.createRange(),i.setEndPoint("StartToStart",v));try{if(t){if(b=_iframeDoc.getElementById("dext_paste_caret_node")){var E=getFirstRange().range;E.setStart(b,0),E.setEnd(b,0),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(E),b.removeAttribute("id")}}else if(i.startContainer&&i.startContainer.tagName&&"BR"==i.startContainer.tagName){for(var S=i.startContainer;;){if(null==S||void 0==S){S=S.parentNode;break}if("BR"!=S.tagName)break;S=S.previousSibling}i.setStartAfter(S),i.collapse(!0),r.removeAllRanges(),r.addRange(i)}}catch(x){}showWordCount(),n||DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}function getBlockContainer(e){for(;e;){if(1==e.nodeType&&/^(P|H[1-6]|DIV)$/i.test(e.nodeName))return e;e=e.parentNode}}function getContainerForRemoveCss(e){for(;e;){if(1==e.nodeType&&/^(P|H[1-6]|DIV|LI|BLOCKQUOTE|HR|OL|UL|TD|TH)$/i.test(e.nodeName))return e;e=e.parentNode}}function extractBlockContentsFromCaretForRemoveCss(e){var t=getFirstRange(),n=t.range;if(t.sel.rangeCount)if(e){if(e=getContainerForRemoveCss(n.startContainer))return t=n.cloneRange(),t.selectNodeContents(e),t.setEnd(n.startContainer,n.startOffset),t.extractContents()}else if(e=getContainerForRemoveCss(n.endContainer))return t=n.cloneRange(),t.selectNodeContents(e),t.setStart(n.endContainer,n.endOffset),t.extractContents()}function extractBlockContentsFromCaret(e){var t=getFirstRange(),n=t.range;if(t.sel.rangeCount)if(e){if(t=getBlockContainer(n.startContainer))return e=n.cloneRange(),e.selectNodeContents(t),e.setEnd(n.startContainer,n.startOffset),e.extractContents()}else if(t=getBlockContainer(n.endContainer)){e=n.cloneRange(),e.selectNodeContents(t);if(DEXTTOP.DEXT5.browser.ie)e.setStart(n.endContainer,n.endOffset);else{t=n.endOffset;try{0<n.endOffset&&n.endContainer.childNodes.length>=n.endOffset&&(t=n.endContainer.childNodes.length-1-n.endOffset,0>t&&(t=0))}catch(r){}e.setStart(n.endContainer,t)}return e.extractContents()}}function insertNodeAtCaret(e){var t=DEXTTOP.G_CURREDITOR._DOC.createElement("span");t.id=e,t.innerHTML="&nbsp;";if(e=getFirstRange().range)e.collapse(!1),e.insertNode(t)}function replacePasteHTML(){if(null!=startBookmark&&null!=endBookmark)try{var e=getFirstRange().range;e.setStart(startBookmark.startContainer,startBookmark.startOffset),e.setEnd(endBookmark.startContainer,endBookmark.startOffset);var t=e.toHtml();if(0<t.length){var t=SetCorrectOfficeHtml(t),t=SetCorrectOfficeHtmlForDOM(t),n=DEXTTOP.DEXT5.util.officeClean(t,!1),n=DEXTTOP.DEXT5.util.htmlRevision(n),n=xssReplaceScript(null,n);e&&(e.deleteContents(),e.pasteHtml(n))}}catch(r){}}function dext_src_init(e){_iframeWin=rangy.dom.getIframeWindow(e),_iframeDoc=rangy.dom.getIframeDocument(e)}function setBodyDefaultValue(e){try{if(!(0<getFirstRange().range.toString().length)){var t=_iframeDoc.body.childNodes.length,n=_iframeDoc.body.childNodes,r=null,i=null;if(0==t)r=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?r.innerHTML="&nbsp;":(i=_iframeDoc.createElement("br"),r.appendChild(i)),_iframeDoc.body.appendChild(r),doSetCaretPosition(r,0,e);else if(3!==n[0].nodeType)if(1==t&&1===n[0].nodeType){if(r=n[0],"p"==r.nodeName.toLowerCase())""!=r.innerHTML&&" "!=r.innerHTML&&"&nbsp;"!=r.innerHTML||DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(i=_iframeDoc.createElement("br"),r.appendChild(i)),doSetCaretPosition(r,0,e);else if("br"==r.nodeName.toLowerCase()){var s=_iframeDoc.createElement("p");_iframeDoc.body.appendChild(s),s.appendChild(r),doSetCaretPosition(s,0,e)}}else 2<=t&&setFocusToBody()}}catch(o){}}function setFocusToBody(e){try{var t=DEXTTOP.G_CURREDITOR;e&&(t=e),1!=DEXTTOP.DEXT5.config.ForceSkipFocus&&(0==t._config.initFocus&&t.isInitFocusHandler||"view"!=t._config.mode&&(DEXTTOP.DEXT5.browser.ie?setTimeout(function(){try{_iframeWin.focus(),_iframeDoc.focus(),_iframeDoc.body.focus()}catch(e){}},0):setTimeout(function(){try{_iframeWin.focus(),_iframeDoc.body.focus()}catch(e){}},0)))}catch(n){}}function _iframeDoc_ContextMenu(e){setDEXTWINDOC();var t=getEditrFromEvent(e);DEXTTOP.G_CURREDITOR=t;if(isViewMode(t))"1"==t._config.viewModeBrowserMenu&&DEXTTOP.DEXT5.util.cancelEvent(e);else{var n=e?e:_iframeWin.event;currElem=n.target?n.target:n.srcElement;if(0!=checkContentEditable(DEXTTOP.G_CURREDITOR,currElem)){var r=!1;if("textarea"==currElem||"input"==currElem)r=!0;setTimeout(function(){if(0==r){var e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode),G_CURSOR_ELEMENT=e,onChange({editor:t})}},10);if("1"!=t._config.formMode&&"1"==t._config.userTableLock.use){var i=GetTDTHCell(currElem),s;i&&(s=GetParentbyTagName(currElem,"table"));var o=t._config.userTableLock.defaultTableLockMode;s&&("2"==t._config.userTableLock.tableLockMode?checkLockAttr(s,!0)&&checkLockAttr(i,!0)?s.getAttribute("lock_mode")&&""!=s.getAttribute("lock_mode")&&(o=s.getAttribute("lock_mode")):o="0":s.getAttribute("lock_mode")&&""!=s.getAttribute("lock_mode")&&(o=s.getAttribute("lock_mode")));var u=!0;"1"==o?u=!1:"0"==o&&(u=!1,i=null);if(i){if(checkLockAttr(s)){if(t.lastElemForLock)setFocusForLock(t.lastElemForLock);else{var a=findNoLockElem(s);a?setFocusForLock(a):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(i,!u)){t.lastElemForLock?setFocusForLock(t.lastElemForLock):setFocusForLock(findNoLockCell(s)),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}t.lastElemForLock=i}}if("1"==t._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("contextmenu",n,currElem):DEXTTOP.DEXTWIN.dext_mouse_event("contextmenu",n,currElem)}catch(f){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(n);return}}n=GetParentbyTagName(currElem,"table"),null==n?(ClearDraggingTableCellSelected(),ActiveCurrTable=null):(DEXTTOP.G_SELECTED_ELEMENT=currElem,ActiveCurrTable=n);try{var l=currElem.tagName.toLowerCase();if("html"==l||"body"==l){n=!1,500>e.clientX&&10>e.clientY&&(n=!0),repairBodyFirstLastTag(n);if(DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&7!=DEXTTOP.DEXT5.browser.ieVersion){if((a=getFirstRange().range)&&0==a.toString().length&&_iframeDoc.body.createTextRange){var a=_iframeDoc.body.createTextRange(),c=e.clientX,h=e.clientY;"None"==t._setting.doctype&&(c<a.boundingLeft&&(c=a.boundingLeft),"html"==l&&h>a.boundingHeight-(a.offsetTop-a.boundingTop)&&("None"!=t._setting.doctype&&(c=a.boundingWidth+a.boundingLeft),h=a.boundingHeight-(a.offsetTop-a.boundingTop),"None"==t._setting.doctype&&--h)),a.moveToPoint(c,h),a.select()}setFocusToBody()}else if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var p=getFirstRange().range;if(0==p.toString().length){l=null;try{createSelectionFromPoint(e.clientX,e.clientY,e.clientX,e.clientY),setFocusToBody(),p=getFirstRange().range,l=_iframeDoc.createElement("dexttemp"),p.insertNode(l),null!=l.nextSibling&&doSetCaretPosition(l.nextSibling,!1)}catch(d){}l&&l.parentNode.removeChild(l)}}else setFocusToBody();(a=getFirstRange().range)&&a.startContainer==a.endContainer&&1==a.collapsed&&(currElem=getMyElementNode(a.startContainer)),setMenuIconRealable(currElem)}else setTimeout(function(){var e=getFirstRange().range;e&&e.startContainer==e.endContainer&&1==e.collapsed&&(currElem=getMyElementNode(e.startContainer)),setMenuIconRealable(currElem)},0)}catch(v){}if(!IsMousePointOnBorder(e)){if(getApplyDragResize(DEXTTOP.G_CURREDITOR)&&!DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_showContext){DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_showContext=!0,DEXTTOP.DEXT5.util.cancelEvent(e);return}if(DEXTTOP.DEXT5.browser.mobile)return;setContextMenu(e)}"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose())}DEXTTOP.DEXT5.util.cancelEvent(e)}}function _iframeDoc_BlurHandler(e){var t=getEditrFromEvent(e);if(!t._LastRange&&!t._RangeBlurBug){t._LastRange=saveSelection(t.ID);try{"1"==t._config.returnEvent.focus_event&&("function"==typeof t._config.event.focus?t._config.event.focus("blur",e):DEXTTOP.DEXTWIN.dext_focus_event("blur",e))}catch(n){}}}function _iframeDoc_FocusHandler(e){if(e.target?e.target:e.srcElement){var t=getEditrFromEvent(e);setCurrentEditor(t),1==t.isInitFocusHandler&&0==t._config.initFocus&&DEXTTOP.DEXT5.browser.ie&&(setBodyDefaultValue(),t.isInitFocusHandler=!1);if(1==t._config.initFocus&&t._LastRange){var n=null;1==t.isCloseTopMenu&&(n=t._LastRange),restoreSelection(t._LastRange),1==t.isCloseTopMenu&&(t._LastRange=n,t.isCloseTopMenu=!1)}}try{"1"==t._config.returnEvent.focus_event&&("function"==typeof t._config.event.focus?t._config.event.focus("focus",e):DEXTTOP.DEXTWIN.dext_mouse_event("focus",e))}catch(r){}}function setCurrentEditor(e){var t=e._EDITOR.design;e._DOC=t.contentDocument?t.contentDocument:t.contentWindow.document,e._BODY=e._DOC.body,DEXTTOP.G_CURREDITOR=e,G_USE_EDITOR_ID=e.ID,LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID),dext_src_init(t)}function InsertFontElement(e,t){var n=getFirstRange(),r=n.range;if(r){r.collapse(!1);var i=null,i=GetParentbyTagName(r.startContainer,"span");!i||i.innerHTML!=unescape("%u200B")&&i.innerHTML!=unescape("%uFEFF")&&""!=i.innerText&&"\n"!=i.innerHTML&&"<br>"!=i.innerHTML&&"<br />"!=i.innerHTML&&"<br>"!=i.innerHTML?(i=_iframeDoc.createElement("span"),0==DEXTTOP.DEXT5.browser.gecko&&(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?i.innerHTML=unescape("%u200B"):i.innerHTML=unescape("%uFEFF")),i.style[e]=t,r.insertNode(i),r.selectNodeContents(i),rangy.getSelection(_iframeWin).removeAllRanges(),n.sel.addRange(r),doSetCaretPosition(i,1),!DEXTTOP.DEXT5.browser.ie||"fontFamily"!=e&&"fontSize"!=e||(DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID))):(i.style[e]=t,DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?i.innerHTML=unescape("%u200B"):i.innerHTML=unescape("%uFEFF"),r.selectNodeContents(i),rangy.getSelection(_iframeWin).removeAllRanges(),n.sel.addRange(r),doSetCaretPosition(i,1))}}function execCommand(e,t,n){t.document=_iframeDoc,rangy.execCommand(e,t,n)}function getFirstRange(){retValue={};try{var e=rangy
.getSelection(_iframeWin);retValue.sel=e;if(0==e.rangeCount){var t=rangy.createRange(_iframeDoc),e=rangy.getSelection(_iframeWin);e.setSingleRange(t),retValue.sel=e,retValue.range=t}else retValue.range=e.getRangeAt(0),DEXTTOP.DEXT5.browser.chrome&&retValue.range.startContainer==retValue.range.endContainer&&retValue.range.startOffset==retValue.range.endOffset&&retValue.range.startContainer.tagName&&"br"==retValue.range.startContainer.tagName.toLowerCase()&&retValue.range.startContainer.parentNode&&retValue.range.startContainer.parentNode.lastChild==retValue.range.startContainer&&(retValue.range.setStartBefore(retValue.range.startContainer),retValue.range.setEndBefore(retValue.range.endContainer),retValue.sel.removeAllRanges(),retValue.sel.addRange(retValue.range))}catch(n){try{t=rangy.createRange(_iframeDoc),e=rangy.getSelection(_iframeWin),e.setSingleRange(t),retValue.sel=e,retValue.range=t}catch(r){}}return retValue}function setRestoreCaretPos(e){var t=getFirstRange().range;t&&(0==e&&t.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))}function DoExecuteCommand(e,t,n,r){var i=function(e){return"underline"!=e&&"strikeThrough"!=e||"2"!=DEXTTOP.G_CURREDITOR._config.underlineAndStrikeThroughMode||!(0==DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion)?!1:!0},s=function(e,t,n){if(DEXTTOP.DEXT5.browser.ie){var r="";t=n="","underline"==e?(r="u",n="underline",t="textDecoration"):"strikeThrough"==e&&(r="strike",n="line-through",t="textDecoration");if(""!=r)for(e=_iframeDoc.getElementsByTagName(r),r=e.length-1;0<=r;r--){var i=e[r],s=_iframeDoc.createElement("span");s.style[t]=n;for(i.parentNode.insertBefore(s,i);i.hasChildNodes();)s.appendChild(i.firstChild);i.parentNode.removeChild(i)}}else{if(t)for(t=t.getElementsByTagName("span"),e=t.length,r=0;r<e;r++)t[r].style.textDecorationLine&&(t[r].style.textDecoration=t[r].style.textDecorationLine);n&&n.style.textDecorationLine&&(n.style.textDecoration=n.style.textDecorationLine)}},o=function(e){var t=e;return"strikeThrough"==e&&(t="line-through"),t};i(n)&&_iframeDoc.execCommand("styleWithCSS",!1,!0);try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var u="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,a=DEXTTOP.DEXT5.browser.quirks;if(0==t.toString().length){var f=GetTableSelectionCells();if(0==f.length){try{DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&1==t.startContainer.nodeType&&""==t.startContainer.innerHTML&&(t.startContainer.innerHTML=unescape("%u200B"))}catch(l){}if(i(n)){var c;t.startContainer&&3==t.startContainer.nodeType&&"%uFEFF"==escape(t.startContainer.nodeValue)?c=t.startContainer:(c=_iframeDoc.createTextNode(unescape("%uFEFF")),t.insertNode(c),c.previousSibling&&(3==c.previousSibling.nodeType&&"%uFEFF"==escape(c.previousSibling.nodeValue)||"BR"==c.previousSibling.nodeName)&&c.parentNode.removeChild(c.previousSibling)),t.setStart(c,0),t.setEnd(c,c.length),e.removeAllRanges(),e.addRange(t),_iframeDoc.execCommand(n,!1,null);var h=c.parentNode;s(n,h.parentNode),t.setStart(c,c.length),t.setEnd(c,c.length),e.removeAllRanges(),e.addRange(t),setMenuIconRealable(h)}else _iframeDoc.execCommand(n,!1,null),setMenuIconRealable(getMyElementNode(t.startContainer))}else{var p=[];switch(n){case"bold":p=["b","strong"];break;case"italic":p=["em","i"];break;case"underline":p=["u"];break;case"strikeThrough":p=["strike"];break;case"superscript":p=["sup"];break;case"subscript":p=["sub"]}c=!0;if(0<f.length){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag)for(var d=0;d<f.length;d++){var v="<(p|span|b|strong|em|i|u|strike|sup|sub)([^>]*?>)<br ?/?></(p|span|b|strong|em|i|u|strike|sup|sub)>",m=new RegExp(v,"gim");f[d].innerHTML=f[d].innerHTML.replace(m,"<$1$2&nbsp;</$3>")}for(var g=!1,d=0;d<f.length;d++){var y=getAllTextNodeByNode(f[d]);if(y&&0<y.length){if(i(n))if(DEXTTOP.DEXT5.browser.ie){var b=DEXTTOP.DEXT5.util.getStyle(y[0].parentNode,"textDecoration"),w=DEXTTOP.DEXT5.util.getStyle(y[0].parentNode,"textDecorationLine"),E=o(n);b&&-1!=b.indexOf(E)?g=!0:w&&-1!=w.indexOf(E)&&(g=!0)}else g=_iframeDoc.queryCommandState(n);else g=getElementInParentTag(y[0].parentNode,p);break}}g&&(c=!1)}for(d=0;d<f.length;d++)if(e.removeAllRanges(),t.selectNode(f[d]),e.addRange(t),"0"!=DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag||""!=DEXTTOP.DEXT5.util.replaceAll(f[d].innerHTML," ","")&&f[d].innerHTML!=getCellDefValue()&&"<p><br></p>"!=f[d].innerHTML.toLowerCase()&&"<p><br/></p>"!=f[d].innerHTML.toLowerCase()&&"<p><br /></p>"!=f[d].innerHTML.toLowerCase()){DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==u||1==a)&&("<p></p>"==f[d].innerHTML.toLowerCase()?f[d].innerHTML="<p>&nbsp;</p>":"<span></span>"==f[d].innerHTML.toLowerCase()&&(f[d].innerHTML="<span>&nbsp;</span>")),"underline"==n||"strikeThrough"==n?_iframeDoc.execCommand(n,!1,null):(r.ignoreWhiteSpace=!0,rangy.queryCommandValue(n,r),execCommand(n,r,t)),p=!1;switch(n){case"bold":if(0<f[d].getElementsByTagName("b").length||0<f[d].getElementsByTagName("strong").length)p=!0;break;case"italic":if(0<f[d].getElementsByTagName("em").length||0<f[d].getElementsByTagName("i").length)p=!0;break;case"underline":i(n)?DEXTTOP.DEXT5.browser.ie?(y=getAllTextNodeByNode(f[d]))&&0<y.length?(b=DEXTTOP.DEXT5.util.getStyle(y[0].parentNode,"textDecoration"),w=DEXTTOP.DEXT5.util.getStyle(y[0].parentNode,"textDecorationLine"),E=o(n),b&&-1!=b.indexOf(E)?p=!0:w&&-1!=w.indexOf(E)&&(p=!0)):0<f[d].getElementsByTagName("u").length&&(p=!0):p=_iframeDoc.queryCommandState(n):0<f[d].getElementsByTagName("u").length&&(p=!0);break;case"strikeThrough":i(n)?DEXTTOP.DEXT5.browser.ie?(y=getAllTextNodeByNode(f[d]))&&0<y.length?(b=DEXTTOP.DEXT5.util.getStyle(y[0].parentNode,"textDecoration"),w=DEXTTOP.DEXT5.util.getStyle(y[0].parentNode,"textDecorationLine"),E=o(n),b&&-1!=b.indexOf(E)?p=!0:w&&-1!=w.indexOf(E)&&(p=!0)):0<f[d].getElementsByTagName("strike").length&&(p=!0):p=_iframeDoc.queryCommandState(n):0<f[d].getElementsByTagName("strike").length&&(p=!0);break;case"superscript":0<f[d].getElementsByTagName("sup").length&&(p=!0);break;case"subscript":0<f[d].getElementsByTagName("sub").length&&(p=!0)}if(c&&!p||!c&&p)0==i(n)?_iframeDoc.execCommand(n,!1,null):(r.ignoreWhiteSpace=!0,rangy.queryCommandValue(n,r),execCommand(n,r,t))}else DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(DEXTTOP.DEXT5.browser.ie&&(f[d].innerHTML="<p>&nbsp;</p>"),"underline"==n||"strikeThrough"==n?_iframeDoc.execCommand(n,!1,null):(r.ignoreWhiteSpace=!0,rangy.queryCommandValue(n,r),execCommand(n,r,t)));if(i(n)){var S=GetParentbyTagName(f[0],"table");s(n,S)}if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag&&!(DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion))for(d=0;d<f.length;d++)v="<(span|b|strong|em|i|u|strike|sup|sub)([^>]*?>)&nbsp;</(span|b|strong|em|i|u|strike|sup|sub)>",m=new RegExp(v,"gim"),f[d].innerHTML=f[d].innerHTML.replace(m,"<$1$2<br></$3>");e.removeAllRanges();var x=DrageEndCell.lastChild;try{for(;x;){if(3==x.nodeType){x=x.parentNode;break}if(1==x.nodeType&&void 0!=x.tagName&&-1<",img,br,".indexOf(","+x.tagName.toLowerCase()+",")){x=x.parentNode;break}x=x.lastChild}"<br>"==x.innerHTML?doSetCaretPosition(x,0):doSetCaretPosition(x,1)}catch(T){doSetCaretPosition(DrageEndCell.lastChild,1)}DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==u||1==a)&&(DEXTTOP.G_CURREDITOR._LastRange=null);var N=getFirstRange().range,C=getMyChildElementNode(N.startContainer);C&&N.selectNode(C),_iframeDoc_MouseUpMenu(null,DrageEndCell),setMenuIconRealable(x)}}else{if("underline"!=n&&"strikeThrough"!=n&&DEXTTOP.DEXT5.browser.ie)r.ignoreWhiteSpace=!0,rangy.queryCommandValue(n,r),execCommand(n,r,t),DEXTTOP.DEXT5.browser.gecko&&e.removeAllRanges(),e.addRange(t);else if(_iframeDoc.execCommand(n,!1,null),i(n)){s(n,_iframeDoc);var k=getFirstRange();if(k.sel.isCollapsed)try{var L=t.endContainer;k.range.setStartBefore(t.startContainer),k.range.setEndAfter(L),k.sel.removeAllRanges(),k.sel.addRange(k.range)}catch(A){}}else try{k=getFirstRange(),p=k.range,g=k.sel,e=!1,p.startContainer!=t.startContainer&&1==p.startContainer.nodeType&&3==t.startContainer.nodeType&&(p.setStart(t.startContainer,t.startOffset),e=!0);if(p.endContainer&&1==p.endContainer.nodeType){var O=p.endContainer.childNodes[p.endOffset-1],M;O&&(1==O.nodeType?(c=p.endContainer.innerText||p.endContainer.textContent,M=c.length,O=O.firstChild):3==O.nodeType&&(M=O.length)),p.setEnd(O,M),e=!0}e&&(g.removeAllRanges(),g.addRange(p))}catch(_){}setMenuIconRealable(getMyElementNode(t.startContainer))}i(n)&&_iframeDoc.execCommand("styleWithCSS",!1,!1);if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:n})},10)}catch(D){i(n)&&_iframeDoc.execCommand("styleWithCSS",!1,!1)}}function getCommandIconState(e){return"strikeThrough"==e&&(e="strike_through"),-1<document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+e).className.indexOf("uebutton_span_enter")?!0:!1}function DoExecuteCommandFormatting(e,t,n){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r=e.sel,i=e.range;if(0==i.toString().length){var s=GetTableSelectionCells();if(0==s.length)if(n){DEXTTOP.DEXT5.browser.ie&&(t="<"+t+">");try{if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&i.startContainer==i.endContainer){var o,u="";1==i.startContainer.nodeType?(o=i.startContainer,u=i.startContainer.innerHTML):3==i.startContainer.nodeType&&(o=i.startContainer.parentNode,u=o.innerHTML),o&&""!=u&&(u=u.replace(/<br>$/ig,""),o.innerHTML=u)}}catch(a){}_iframeDoc.execCommand("formatBlock",!1,t)}else if(DEXTTOP.DEXT5.browser.ie){var f=GetParentbyTagName(i.startContainer,"h1");null==f&&(f=GetParentbyTagName(i.startContainer,"h2")),null==f&&(f=GetParentbyTagName(i.startContainer,"h3")),null==f&&(f=GetParentbyTagName(i.startContainer,"h4")),null==f&&(f=GetParentbyTagName(i.startContainer,"h5")),null==f&&(f=GetParentbyTagName(i.startContainer,"h6"));if(f){var l=f,c=_iframeDoc.createElement(t);c.innerHTML=l.innerHTML,_iframeDoc.body.appendChild(c),l.parentNode.replaceChild(c,l),doSetCaretPosition(c,0)}}else _iframeDoc.execCommand("formatBlock",!1,t);else for(var h=s.length,p=0,r=0;r<h;r++){for(var d=getFormattingNode(s[r],t,n,!0),p=d.length,v=0;v<p;v++){l=d[v],c=_iframeDoc.createElement(t),u=1==l.nodeType?l.innerHTML:l.nodeValue;if(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&11==DEXTTOP.DEXT5.browser.ieVersion)try{u=u.replace(/<br>$/ig,""),""==u&&(u=unescape("%u200B"))}catch(m){}c.innerHTML=u,_iframeDoc.body.appendChild(c),l.parentNode.replaceChild(c,l)}0==d.length&&n&&(c=_iframeDoc.createElement(t),c.innerHTML=""==s[r].innerHTML?DEXTTOP.DEXT5.browser.ie?"&nbsp;":"<br />":s[r].innerHTML,s[r].innerHTML="",s[r].appendChild(c))}}else{s=[],d=getFormattingNode(i,t,n),p=d.length;for(v=0;v<p;v++)if(l=d[v],c=_iframeDoc.createElement(t),!n||"td"!=l.tagName.toLowerCase()&&"th"!=l.tagName.toLowerCase()||!DEXTTOP.DEXT5.browser.ie||""!=l.innerHTML&&"&nbsp;"!=l.innerHTML&&l.innerHTML!=l.innerText){if(DEXTTOP.DEXT5.browser.ie&&n&&1==l.nodeType){var g=l.tagName.toLowerCase();if("h1"!=g&&"h2"!=g&&"h3"!=g&&"h4"!=g&&"h5"!=g&&"h6"!=g&&GetTDTHCell(l))continue}try{if(l&&1==l.nodeType){u=l.innerHTML;if(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&11==DEXTTOP.DEXT5.browser.ieVersion)try{u=l.innerHTML.replace(/<br>$/ig,""),""==u&&(u=unescape("%u200B"))}catch(y){}c.innerHTML=u}}catch(b){}_iframeDoc.body.appendChild(c),l.parentNode.replaceChild(c,l),s.push(c)}else c.innerHTML=l.innerHTML,""==c.innerHTML&&(c.innerHTML="&nbsp;"),l.innerHTML="",l.appendChild(c);p=s.length;if(0<p){r.removeAllRanges(),i.selectNodeContents(s[0]);var w=i.cloneRange();i.selectNodeContents(s[p-1]),i.setStart(w.startContainer,w.startOffset),i.setEnd(i.endContainer,i.endOffset),r.addRange(i)}}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"formatting"})},10)}catch(E){}}function getFormattingNode(e,t,n,r){t=[];var i=null;if(r){if(i=e.childNodes,0==i.length)return i}else i=getNodesInRange(e);e=!1;for(var s=i.length,o=0;o<s;o++){var u=i[o];if(1==u.nodeType){var a=u.tagName.toLowerCase();"html"!=a&&"body"!=a&&(e=!0,n?("h1"==a||"h2"==a||"h3"==a||"h4"==a||"h5"==a||"h6"==a||"p"==a||"pre"==a||DEXTTOP.DEXT5.browser.ie&&1!=r&&("td"==a||"th"==a))&&t.push(u):"h1"!=a&&"h2"!=a&&"h3"!=a&&"h4"!=a&&"h5"!=a&&"h6"!=a||t.push(u))}else r&&3==u.nodeType&&n&&(e=!0,t.push(u))}if(0==e)for(i=getAllNodesInBody(_iframeDoc.body,!0),s=i.length,o=0;o<s;o++)u=i[o],1==u.nodeType?(a=u.tagName.toLowerCase(),n?("h1"==a||"h2"==a||"h3"==a||"h4"==a||"h5"==a||"h6"==a||"p"==a||"pre"==a||DEXTTOP.DEXT5.browser.ie&&1!=r&&("td"==a||"th"==a))&&t.push(u):"h1"!=a&&"h2"!=a&&"h3"!=a&&"h4"!=a&&"h5"!=a&&"h6"!=a||t.push(u)):r&&3==u.nodeType&&n&&t.push(u);return t}function DoExecuteCommand2(e,t,n,r,i){try{(0==!!i&&null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0==t.toString().length||0!=t.endOffset){var s=GetTableSelectionCells();-1<n.indexOf("justify")&&7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==r&&(r=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",r=!0),setAdjustTableWidthHeight(ActiveCurrTable),r&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));if(0==s.length)"justifyLeft"!=n||DEXTTOP.DEXT5.browser.ie||_iframeDoc.execCommand("justifyFull",!1,null),-1<n.indexOf("justify")?t.commonAncestorContainer&&"BODY"!=t.commonAncestorContainer.tagName&&_iframeDoc.execCommand(n,!1,null):_iframeDoc.execCommand(n,!1,null),-1<n.indexOf("justify")&&executeTextAlign(t,n),setMenuIconRealable(getMyElementNode(t.startContainer));else{var o=s.length;r=[];for(var u=0;u<o;u++){var a=s[u].innerHTML,a=ReplaceAll(a,unescape("\r\n"),""),a=ReplaceAll(a,unescape("\r"),""),a=ReplaceAll(a,unescape("\n"),""),a=ReplaceAll(a,unescape("%20%20"),"");s[u].innerHTML=a,e.removeAllRanges(),t.selectNodeContents(s[u]),e.addRange(t),"removeFormat"==n&&r.push(s[u].getAttribute("cellOrgBgColor")),_iframeDoc.execCommand(n,!1,null);if(-1<n.indexOf("justify")){for(var f=s[u].getElementsByTagName("p"),l=f.length,c=s[u].getElementsByTagName("div"),h=c.length,p="",p="justifyFull"==n?"justify":n.substring(7),d=null,v=0;v<l;v++)d=f[v],d.style.textAlign!=p&&(d.style.textAlign=p);for(v=0;v<h;v++)d=c[v],d.style.textAlign!=p&&(d.style.textAlign=p)}}e.removeAllRanges();if("removeFormat"==n)for(o=s.length,e=0;e<o;e++){var m=s[e];m.setAttribute("cellOrgBgColor",r[e]),m.style.backgroundColor=ColorCellBackColor,m.setAttribute("dext_select","true")}doSetCaretPosition(DrageEndCell.childNodes[0],1);var g=getFirstRange().range,y=getMyChildElementNode(g.startContainer);g.selectNode(y),setMenuIconRealable(y),_iframeDoc_MouseUpMenu(null,DrageEndCell)}}else _iframeDoc.execCommand(n,!1,null),-1<n.indexOf("justify")&&executeTextAlign(t,n);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)if(g=getFirstRange().range,s=null,g&&g.startContainer&&(s=getMyElementNode(g.startContainer)),s){var b=GetParentbyTagName(s,"td");if(b){for(var w=b.getElementsByTagName("li"),u=w.length-1;0<=u;u--)if("OL"!=w[u].parentNode.tagName&&"UL"!=w[u].parentNode.tagName){a=_iframeDoc.createElement("div"),a.innerHTML=w[u].innerHTML;var E=a.firstChild;w[u].parentNode.replaceChild(E,w[u]),doSetCaretPosition(E,1)}if("<p></p>"==b.innerHTML||""==b.innerHTML)b.innerHTML=getCellDefValue()}}if(0==!!i&&null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:n})},10)}catch(S){}}function DoExecuteCommand3(e,t,n,r,i){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0==t.toString().length){var s=GetTableSelectionCells();if(0==s.length)"fontcolor"==n&&(n="color"),"fontbgcolor"==n&&(n="backgroundColor"),"lineheight"==n&&(n="lineHeight"),InsertFontElement(n,i);else{var o=s.length;i=[];var u="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,a=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==u||1==a))for(var f=0;f<o;f++){var l=s[f];"<p></p>"==l.innerHTML.toLowerCase()?l.innerHTML="<p>&nbsp;</p>":"<span></span>"==l.innerHTML.toLowerCase()?l.innerHTML="<span>&nbsp;</span>":""==l.innerHTML.toLowerCase()&&(l.innerHTML="&nbsp;")}for(f=0;f<o;f++){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var c="<(p|span)([^>]*?>)<br ?/?></(p|span)>",h=new RegExp(c,"gim");s[f].innerHTML=s[f].innerHTML.replace(h,"<$1$2&nbsp;</$3>")}e.removeAllRanges(),t.selectNode(s[f]),e.addRange(t),rangy.queryCommandValue(n,r);if("fontbgcolor"==n&&(i.push(s[f].getAttribute("cellOrgBgColor")),DEXTTOP.DEXT5.browser.ie)){var p=colorToHex(r.fontcolor),d=colorToHex(s[f].style.backgroundColor);p==d&&(s[f].style.backgroundColor="")}execCommand(n,r),rangy.getSelection(_iframeWin).removeAllRanges(),"1"!=DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag||DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion||(c="(<span[^>]*?>)&nbsp;</span>",h=new RegExp(c,"gim"),s[f].innerHTML=s[f].innerHTML.replace(h,"$1<br></span>"))}e.removeAllRanges();if("fontbgcolor"==n)for(o=s.length,e=0;e<o;e++){var v=s[e];v.setAttribute("cellOrgBgColor",i[e]),v.style.backgroundColor=ColorCellBackColor,v.setAttribute("dext_select","true")}var m=DrageEndCell.lastChild;try{for(;m;){if(3==m.nodeType){m=m.parentNode;break}if(1==m.nodeType&&void 0!=m.tagName&&-1<",img,br,".indexOf(","+m.tagName.toLowerCase()+",")){m=m.parentNode;break}m=m.lastChild}"<br>"==m.innerHTML?doSetCaretPosition(m,0):doSetCaretPosition(m,1)}catch(g){doSetCaretPosition(DrageEndCell.childNodes[0],1)}!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=u&&1!=a||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else{r.ignoreWhiteSpace=!0,rangy.queryCommandValue(n,r),s=null,o="";try{if("fontbgcolor"==n){var y=t.commonAncestorContainer.parentNode;y&&1==y.nodeType&&(s=GetTDTHCell(y)),s&&(o=s.style.backgroundColor)}}catch(b){s=null}if(!t.commonAncestorContainer.tagName||"BODY"!=t.commonAncestorContainer.tagName&&"DIV"!=t.commonAncestorContainer.tagName)execCommand(n,r,t);else try{var w=t.getNodes(),E=w.length;if(500<E){u=[];for(f=0;f<E;f++)if(3==w[f].nodeType){var S=w[f].parentNode;1==S.nodeType&&"BODY"!=S.tagName&&u.push(S)}for(f=0;f<u.length;f++)"fontcolor"==n?u[f].style.color=i:"fontbgcolor"==n?u[f].style.backgroundColor=i:"lineheight"==n?u[f].style.lineHeight=i:"fontSize"==n?u[f].style.fontSize=i:"fontFamily"==n&&(u[f].style.fontFamily=i)}else execCommand(n,r,t)}catch(x){execCommand(n,r,t)}s&&(s.style.backgroundColor=o),DEXTTOP.DEXT5.browser.ie&&(9>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)||e.removeAllRanges(),e.addRange(t),!DEXTTOP.DEXT5.browser.ie||"fontFamily"!=n&&"fontSize"!=n||(DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID))}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:n})},10)}catch(T){}}function getSelectionTable(e){if(DEXTTOP.DEXT5.browser.ie&&!(11<DEXTTOP.DEXT5.browser.ieVersion)){e=getFirstRange().range;var t,n,r=e.collapsed,i;try{if(!r){t=_iframeDoc.createElement("span"),t.style.display="none",t.innerHTML="&nbsp;",n=e.cloneRange(),n.collapse(),n.insertNode(t);var s;t&&(s=t.previousSibling),s&&1==s.nodeType&&"table"==s.tagName.toLowerCase()&&(i=s)}}catch(o){}return t&&t.parentNode&&t.parentNode.removeChild(t),i}}function setBlockTag(e,t,n,r){for(var i="p li dt dd h1 h2 h3 h4 h5 h6 pre table hr blockquote address iframe figure".split(" "),s=["body","td","th","div"],o="b big i small tt abbr acronym cite code dfn em kbd strong samp var a bdo br img map object q script span sub sup button input label select textarea u s strike".split(" "),u=e.length,a=0;a<u;a++)if(e[a]){var f=e[a].tagName;f&&(f=f.toLowerCase());if(3!=e[a].nodeType||/\S/.test(e[a].nodeValue))if(3==e[a].nodeType||-1<o.indexOf(f)){for(var l=e[a];;){if(-1<i.indexOf(l.parentNode.tagName.toLowerCase())){-1<t.indexOf(l.parentNode.tagName.toLowerCase())&&("lineHeight"==n?"span"==l.parentNode.tagName.toLowerCase()?""!=l.parentNode.style.lineHeight&&(l.parentNode.style.lineHeight=r):l.parentNode.style.lineHeight=r:"letterSpacing"==n?"span"==l.parentNode.tagName.toLowerCase()?""!=l.parentNode.style.letterSpacing&&(l.parentNode.style.letterSpacing=r):l.parentNode.style.letterSpacing=r:"align"==n?(""!=l.parentNode.style.layoutGridMode&&(l.parentNode.style.layoutGridMode="none"),l.parentNode.style.textAlign=r):"paragraphAttribute"==n&&(""!=r.marginLeft.toString()&&(l.parentNode.style.marginLeft=r.marginLeft+"px"),""!=r.marginRight.toString()&&(l.parentNode.style.marginRight=r.marginRight+"px"),""!=r.marginTop.toString()&&(l.parentNode.style.marginTop=r.marginTop+"px"),""!=r.marginBottom.toString()&&(l.parentNode.style.marginBottom=r.marginBottom+"px"),""!=r.letterSpacing.toString()&&(l.parentNode.style.letterSpacing=r.letterSpacing+"px"),""!=r.wordSpacing.toString()&&(l.parentNode.style.wordSpacing=r.wordSpacing+"px"),""!=r.textIndent.toString()&&(l.parentNode.style.textIndent=r.textIndent+"px"),""!=r.fontSize.toString()&&(l.parentNode.style.fontSize=r.fontSize+r.fontType),""!=r.fontFamily.toString()&&("default"==r.fontFamily?l.parentNode.style.fontFamily="":l.parentNode.style.fontFamily=r.fontFamily))),l=null;break}if(-1<s.indexOf(l.parentNode.tagName.toLowerCase()))break;l=l.parentNode}if(l){for(var f=[l],c=l.previousSibling;;){try{if(null==c||-1<i.indexOf(c.tagName.toLowerCase())||"div"==c.tagName.toLowerCase())break}catch(h){}f.unshift(c),c=c.previousSibling}for(l=l.nextSibling;;){try{if(null==l||-1<i.indexOf(l.tagName.toLowerCase())||"div"==l.tagName.toLowerCase())break}catch(p){}f.push(l),l=l.nextSibling}l=_iframeDoc.createElement("p"),"lineHeight"==n?l.style.lineHeight=r:"letterSpacing"==n?l.style.letterSpacing=r:"align"==n?l.style.textAlign=r:"indent"==n?(c=parseIntOr0(l.style.marginLeft),0<c?l.style.marginLeft=c+r+"px":(c=parseIntOr0(l.style.paddingLeft),l.style.paddingLeft=c+r+"px")):"paragraphAttribute"==n&&(""!=r.marginLeft.toString()&&(l.style.marginLeft=r.marginLeft+"px"),""!=r.marginRight.toString()&&(l.style.marginRight=r.marginRight+"px"),""!=r.marginTop.toString()&&(l.style.marginTop=r.marginTop+"px"),""!=r.marginBottom.toString()&&(l.style.marginBottom=r.marginBottom+"px"),""!=r.letterSpacing.toString()&&(l.style.letterSpacing=r.letterSpacing+"px"),""!=r.wordSpacing.toString()&&(l.style.wordSpacing=r.wordSpacing+"px"),""!=r.textIndent.toString()&&(l.style.textIndent=r.textIndent+"px"),""!=r.fontSize.toString()&&(l.style.fontSize=r.fontSize+r.fontType),""!=r.fontFamily.toString()&&("default"==r.fontFamily?l.style.fontFamily="":l.style.fontFamily=r.fontFamily)),f[0].parentNode.insertBefore(l,f[0]);var c=f.length,d,v,m;if("lineHeight"==n||"align"==n||"letterSpacing"==n)try{d=getFirstRange(),v=d.range,m=d.sel}catch(g){}for(var y=0;y<c;y++)l.appendChild(f[y]);if("lineHeight"==n||"align"==n||"letterSpacing"==n)if(f=DEXTTOP.G_CURREDITOR.beforeOffset)try{var b=GetTableSelectionCells();if(b&&0==b.length){var w,E,c=!0;"TD"==f[2].tagName?w=l:(w=f[2],c=!1);if("TD"==f[3].tagName){if(E=l,0==c){for(var c=w,S=c.parentNode;S!=l;)c=S,S=S.parentNode;E=c.nextSibling;for(var x=f[4],x=x-((w.innerText||w.textContent).length-f[0]),l=0;null!=E;){var T=(E.innerText||E.textContent).length;if(x<T){l=x,f[1]=l;break}x-=T,E=E.nextSibling}}}else E=f[3];v.setStart(w.firstChild,f[0]),1==E.nodeType&&(E=E.firstChild),v.setEnd(E,f[1]),m.removeAllRanges(),m.addRange(v),DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID)}else DEXTTOP.G_CURREDITOR.beforeOffset=null}catch(N){}}}}}function GetParentbyTagName(e,t,n){null==e&&1==n&&(n=getFirstRange().range)&&n.startContainer&&(e=getMyElementNode(n.startContainer),e=GetTDTHCell(e),DEXTTOP.G_SELECTED_ELEMENT=e);for(;!(null==e||e.tagName&&e.tagName.toLowerCase()==t||e.tagName&&e.tagName.toLowerCase()==t&&null==e.parentNode);)e=e.parentNode;return e}function getParentbyTagNameEx(e,t){for(var n=e,r=","+t+",";!(null==n||n.tagName&&-1<r.indexOf(","+n.tagName.toLowerCase()+",")||n.tagName&&-1<r.indexOf(","+n.tagName.toLowerCase()+",")&&null==n.parentNode);)n=n.parentNode;return n}function _iframeDoc_DBClick(e){setDEXTWINDOC();var t=getEditrFromEvent(e);if(!isViewMode(t)){var n,r=e?e:event;n=r.target?r.target:r.srcElement;if(0==checkContentEditable(t,n))DEXTTOP.DEXT5.util.cancelEvent(e);else{if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){e=GetTDTHCell(n);var i;e&&(i=GetParentbyTagName(n,"table")),t=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode,i&&("2"==DEXTTOP.G_CURREDITOR._config.userTableLock.tableLockMode?checkLockAttr(i,!0)&&checkLockAttr(e,!0)?i.getAttribute("lock_mode")&&""!=i.getAttribute("lock_mode")&&(t=i.getAttribute("lock_mode")):t="0":i.getAttribute("lock_mode")&&""!=i.getAttribute("lock_mode")&&(t=i.getAttribute("lock_mode")));var s=!0;"1"==t?s=!1:"0"==t&&(s=!1,e=null);if(e){if(s&&checkLockAttr(i)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(n=findNoLockElem(i))?setFocusForLock(n):(window.focus(),document.body.focus()),DEXTTOP.DEXT5.util.stopEvent(r),DEXTTOP.DEXT5.util.cancelEvent(r);return}if(checkLockAttr(e,!s)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(i)),DEXTTOP.DEXT5.util.stopEvent(r),DEXTTOP.DEXT5.util.cancelEvent(r);return}}}i=n.tagName.toLowerCase(),"img"!=i&&"hr"!=i&&"a"!=i&&"input"!=i&&"textarea"!=i&&"select"!=i&&(e=GetParentbyTagName(n,"a"))&&(n=e,i=n.tagName.toLowerCase());if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("dblclick",r,n):DEXTTOP.DEXTWIN.dext_mouse_event("dblclick",r,n)}catch(o){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(r);return}}if(n.getAttribute("raon_plugin"))switch(r=n.getAttribute("raon_plugin"),i){case"img":if(G_DEPlugin[r]){G_DEPlugin[r].onDbClickImage&&G_DEPlugin[r].onDbClickImage(n);return};default:if(G_DEPlugin[r]&&G_DEPlugin[r].onDbClickElement){G_DEPlugin[r].onDbClickElement(n);return}}switch(i){case"img":DEXTTOP.G_SELECTED_ELEMENT=n;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){r=!0;try{r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.managerImg?DEXTTOP.G_CURREDITOR._config.event.managerImg(n,DEXTTOP.G_CURREDITOR.ID):DEXTTOP.DEXTWIN.dext_editor_img_event(n,DEXTTOP.G_CURREDITOR.ID)}catch(u){}null!=r&&void 0!=r&&0==r&&(r=!1);if(!r)return}setSelectoinElement(n),r=n.getAttribute("dext5customdata");if(null!=r&&void 0!=r)if(i=getDextCustomData(r),"iframe"==i.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.iframe);else if("flash"==i.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);else if("media"==i.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);else if("link_media"==i.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_link_media);else if("hidden"==i.type){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){r=!0,n={},n.type=i.type,n.id=i.id,n.name=i.name,n.value=i.value,n.className=i.className,n.title=i.title;try{r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.managerInput?DEXTTOP.G_CURREDITOR._config.event.managerInput(n,DEXTTOP.G_CURREDITOR.ID):DEXTTOP.DEXTWIN.dext_editor_input_event(n,DEXTTOP.G_CURREDITOR.ID)}catch(a){}null!=r&&void 0!=r&&0==r&&(r=!1);if(!r)return;DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_hidden)}}else"video_media"==i.type&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.video);else n.getAttribute("raon_chart")&&G_DEPlugin.chart?G_DEPlugin.chart.onDbClickImage(n):""==DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick||n.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick&&n.alt!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick?G_dext5plugIn?showSetImageProperty(n):DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.image):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick,n);break;case"flash":DEXTTOP.G_SELECTED_ELEMENT=n,setSelectoinElement(n),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);break;case"media":DEXTTOP.G_SELECTED_ELEMENT=n,setSelectoinElement(n),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);break;case"hr":DEXTTOP.G_SELECTED_ELEMENT=n,setSelectoinElement(n),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.horizontal_line);break;case"a":DEXTTOP.G_SELECTED_ELEMENT=n,setSelectoinElement(n),r=getFirstRange(),r=r.range,i=getFirstRange().sel,i.removeAllRanges(),r.selectNode(n),i.addRange(r),r=n.getAttribute("DEXT5InsertFile"),""==DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick||n.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick&&n.title!=DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick?""==n.href&&n.name==n.id?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.bookmark):""==r?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_file):DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.hyperlink):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick,n);break;case"iframe":DEXTTOP.G_SELECTED_ELEMENT=n,setSelectoinElement(n),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.iframe);break;case"table":DEXTTOP.G_SELECTED_ELEMENT=n;if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use)r=getFirstRange(),(i=r.sel)&&i.docSelection&&"Control"==i.docSelection.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT):(i._ranges.length=i.rangeCount=i.nativeSelection.rangeCount,i.rangeCount&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT));break;case"input":DEXTTOP.G_SELECTED_ELEMENT=n;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){r=!0;try{r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.managerInput?DEXTTOP.G_CURREDITOR._config.event.managerInput(n,DEXTTOP.G_CURREDITOR.ID):DEXTTOP.DEXTWIN.dext_editor_input_event(n,DEXTTOP.G_CURREDITOR.ID)}catch(f){}null!=r&&void 0!=r&&0==r&&(r=!1);if(!r)return}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(""==n.type||"text"==n.type||"password"==n.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_text):"radio"==n.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_radio):"checkbox"==n.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_checkbox):"button"==n.type||"reset"==n.type||"submit"==n.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_button):"hidden"==n.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_hidden):"image"==n.type&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_image));break;case"select":DEXTTOP.G_SELECTED_ELEMENT=n;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){r=!0;try{r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.managerSelect?DEXTTOP.G_CURREDITOR._config.event.managerSelect(n,DEXTTOP.G_CURREDITOR.ID):DEXTTOP.DEXTWIN.dext_editor_select_event(n,DEXTTOP.G_CURREDITOR.ID)}catch(l){}null!=r&&void 0!=r&&0==r&&(r=!1);if(!r)return}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_select);break;case"textarea":DEXTTOP.G_SELECTED_ELEMENT=n;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){r=!0;try{r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.managerTextArea?DEXTTOP.G_CURREDITOR._config.event.managerTextArea(n,DEXTTOP.G_CURREDITOR.ID):DEXTTOP.DEXTWIN.dext_editor_textarea_event(n,DEXTTOP.G_CURREDITOR.ID)}catch(c){}null!=r&&void 0!=r&&0==r&&(r=!1);if(!r)return}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_textarea)}"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose())}}}function setSelectoinElement(e){var t=getFirstRange().range;if(t)if(""==t.toString()&&e){var n=getFirstRange().sel;n.removeAllRanges(),t.selectNode(e),n.addRange(t)}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)}function _iframeBody_Click(e){setDEXTWINDOC();var t=DEXTTOP.G_CURREDITOR.ID,n=getEditrFromEvent(e);t!=n.ID&&(DEXTTOP.G_CURREDITOR=n);if(!checkDefaultMessage(e)){var r,i;try{i=e?e:event,i.srcElement?r=i.srcElement:i.target&&(r=i.target)}catch(s){setFocusToBody();return}if(isViewMode(n)&&r){if("a"!=r.tagName.toLowerCase()&&(r=GetParentbyTagName(r,"a")),r&&r.getAttribute("href")&&!(-1<r.getAttribute("href").indexOf("#")))if(G_FIRST_CLICK_EVENT)G_FIRST_CLICK_EVENT=!1;else{G_FIRST_CLICK_EVENT=!0;var o=r.getAttribute("target");r.setAttribute("target","_blank"),setTimeout(function(){o&&""!=o?r.setAttribute("target",o):r.removeAttribute("target")},1)}}else{t=!1;if(r.tagName&&"INPUT"==r.tagName&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari?t=!0:0==r.isContentEditable&&(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.gecko)&&(t=!0),t)){var u=null,a=e?e:_iframeWin.event,u=a.target?a.target:a.srcElement;if("checkbox"==u.type.toLowerCase()||"radio"==u.type.toLowerCase())if(1==u.checked){if("radio"==u.type.toLowerCase())for(var f=_iframeDoc.getElementsByName(u.name),l=f.length,c=0;c<l;c++)f[c].checked=!1,f[c].removeAttribute("checked");u.checked=!0,u.setAttribute("checked","checked")}else u.checked=!1,u.removeAttribute("checked")}if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var f=GetTDTHCell(r),h;f&&(h=GetParentbyTagName(r,"table")),l=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode,h&&("2"==DEXTTOP.G_CURREDITOR._config.userTableLock.tableLockMode?checkLockAttr(h,!0)&&checkLockAttr(f,!0)?h.getAttribute("lock_mode")&&""!=h.getAttribute("lock_mode")&&(l=h.getAttribute("lock_mode")):l="0":h.getAttribute("lock_mode")&&""!=h.getAttribute("lock_mode")&&(l=h.getAttribute("lock_mode"))),c=!0,"1"==l?c=!1:"0"==l&&(c=!1,f=null);if(f){if(c&&checkLockAttr(h)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(e=findNoLockElem(h))?setFocusForLock(e):(window.focus(),document.body.focus()),t||(DEXTTOP.DEXT5.util.stopEvent(i),DEXTTOP.DEXT5.util.cancelEvent(i));return}if(checkLockAttr(f,!c)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(h)),t||(DEXTTOP.DEXT5.util.stopEvent(i),DEXTTOP.DEXT5.util.cancelEvent(i));return}n.lastElemForLock=f}}if("1"==n._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("contextmenu",a,u):DEXTTOP.DEXTWIN.dext_mouse_event("contextmenu",a,u)}catch(p){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(i);return}}if(!(!(i=r.tagName?r.tagName.toLowerCase():null)||"textarea"!=i&&"input"!=i&&"select"!=i&&"div"!=i))return!1;if(DEXTTOP.DEXT5.browser.ie&&7==DEXTTOP.DEXT5.browser.ieVersion)try{var d=getFirstRange().range;d&&d.startContainer&&(r=getMyElementNode(d.startContainer));if(void 0==r)return}catch(v){return}i=r.tagName.toLowerCase();try{if("html"==i||"body"==i){t=!1,500>e.clientX&&10>e.clientY&&(t=!0),repairBodyFirstLastTag(t);var m=getFirstRange().range,g=m.startOffset,y=m.endOffset;if("body"==m.endContainer.nodeName.toLowerCase()&&g==y){var b=_iframeDoc.body,m=null;if(b.childNodes[g]&&"table"==b.childNodes[g].nodeName.toLowerCase())m=b.childNodes[g].getElementsByTagName("td")[0];else if(b.childNodes[g-1]&&"table"==b.childNodes[g-1].nodeName.toLowerCase())var w=b.childNodes[g-1].getElementsByTagName("td"),m=w[w.length-1];doSetCaretPosition(m,1)}if(DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&7!=DEXTTOP.DEXT5.browser.ieVersion){if((d=getFirstRange().range)&&0==d.toString().length&&_iframeDoc.body.createTextRange){var d=_iframeDoc.body.createTextRange(),E=e.clientX,S=e.clientY;"None"==n._setting.doctype&&(E<d.boundingLeft&&(E=d.boundingLeft),"html"==i&&S>d.boundingHeight-(d.offsetTop-d.boundingTop)&&("None"!=n._setting.doctype&&(E=d.boundingWidth+d.boundingLeft),S=d.boundingHeight-(d.offsetTop-d.boundingTop),"None"==n._setting.doctype&&--S)),d.moveToPoint(E,S),d.select()}setFocusToBody()}else if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var x=getFirstRange().range;if(0==x.toString().length){n=null;try{createSelectionFromPoint(e.clientX,e.clientY,e.clientX,e.clientY),setFocusToBody(),x=getFirstRange().range,n=_iframeDoc.createElement("dexttemp"),x.insertNode(n),null!=n.nextSibling&&doSetCaretPosition(n.nextSibling,!1)}catch(T){}n&&n.parentNode.removeChild(n)}}else setFocusToBody();if((r=getFirstRange().sel.focusNode)&&3==r.nodeType)for(;1!=r.nodeType;){if(!r.parentNode)break;r=r.parentNode}else(d=getFirstRange().range)&&d.startContainer==d.endContainer&&1==d.collapsed&&(r=getMyElementNode(d.startContainer));setMenuIconRealable(r)}else setTimeout(function(){if((r=getFirstRange().sel.focusNode)&&3==r.nodeType)for(;1!=r.nodeType;){if(!r.parentNode)break;r=r.parentNode}else{var e=getFirstRange().range;e&&e.startContainer==e.endContainer&&1==e.collapsed&&(r=getMyElementNode(e.startContainer))}setMenuIconRealable(r)},0)}catch(N){}}}}function createCollapsedRangeFromPoint(e,t){var n=_iframeDoc,r,i=null;if("undefined"!=typeof n.body.createTextRange)i=n.body.createTextRange(),i.moveToPoint(e,t);else if("undefined"!=typeof n.caretPositionFromPoint)r=n.caretPositionFromPoint(e,t),i=n.createRange(),i.setStart(r.offsetNode,r.offset),i.collapse(!0);else{if("undefined"==typeof n.caretRangeFromPoint)return i;n.caretRangeFromPoint(e,t)}}function createSelectionFromPoint(e,t,n,r){var i=_iframeDoc,s,o,u=null;"undefined"!=typeof i.caretPositionFromPoint?(s=i.caretPositionFromPoint(e,t),o=i.caretPositionFromPoint(n,r),u=i.createRange(),u.setStart(s.offsetNode,s.offset),u.setEnd(o.offsetNode,o.offset)):"undefined"!=typeof i.caretRangeFromPoint&&(s=i.caretRangeFromPoint(e,t),o=i.caretRangeFromPoint(n,r),u=i.createRange(),u.setStart(s.startContainer,s.startOffset),u.setEnd(o.startContainer,o.startOffset)),null!==u&&"undefined"!=typeof _iframeWin.getSelection?(n=_iframeWin.getSelection(),n.removeAllRanges(),n.addRange(u)):"undefined"!=typeof i.body.createTextRange&&(u=i.body.createTextRange(),u.moveToPoint(e,t),e=u.duplicate(),e.moveToPoint(n,r),u.setEndPoint("EndToEnd",e),u.select())}function insertPtagTableNear(e,t){var n=getFirstRange().range;if(n&&t){n.selectNode(t),e?(n.setStartBefore(t),n.collapse(!0)):(n.setEndAfter(t),n.collapse(!1));var r=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(r.innerHTML=getDefaultParagraphValue(!1)),n.insertNode(r),doSetCaretPosition(r,0)}}function moveCaret(e){var t;if(_iframeWin.getSelection){if(t=_iframeWin.getSelection(),0<t.rangeCount){var n=t.focusNode;t.collapse(n,Math.min(n.length,t.focusOffset+e))}}else(t=_iframeDoc.selection)&&"Control"!=t.type&&(t=t.createRange(),t.move("character",e),t.select())}function setMenuIconRealable(e){if(null!=e&&void 0!=e){if("body"==e.tagName.toLowerCase()){var t=getSelectionTable(DEXTTOP.G_CURREDITOR);t&&(e=t)}var t=getElementInParentTag(e,G_FORMATTING),n="";try{n=getFontStyle(e).fontFamily}catch(r){n=getElementInParentStyleProperty(e,"fontFamily")}var i=getElementInParentStyleProperty(e,"fontSize"),s=getElementInParentStyleProperty(e,"lineHeight");"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode&&(n=getFontFamilyStyle(n),""==i&&(i=DEXTTOP.DEXT5.util.getStyle(e,"fontSize")),""==s&&(s=DEXTTOP.DEXT5.util.getStyle(e,"lineHeight")),i=getFontSizeStyle(i,s),s=getLineHeightStyle(i,s,e),-1<s.toString().indexOf("normal")||-1<s.toString().indexOf("inherit"))&&(s=dext5_lang.icon.line_height);var o=getElementInParentStyleProperty(e,"letterSpacing");""==o&&(o=dext5_lang.icon.letter_spacing);if("0"==DEXTTOP.G_CURREDITOR._setting.show_font_real)i==DEXTTOP.G_CURREDITOR._setting.font_size&&(i=dext5_lang.icon.font_size),n==DEXTTOP.G_CURREDITOR._setting.font_family&&(n=dext5_lang.icon.font_family),""==i&&(i=dext5_lang.icon.font_size),""==n&&(n=dext5_lang.icon.font_family),""==s&&(s=dext5_lang.icon.line_height);else{var u,a,f;if(""==i||""==n||""==s)a=getFontStyle(e),u=a.fontFamily,f=a.lineHeight,a=getFontStyle(e,!0),a=a.fontSize;""==i&&(i=""!=a&&void 0!=a?a:dext5_lang.icon.font_size),""==n&&(n=""!=u?u:dext5_lang.icon.font_family),""==s&&(s=f&&""!=f&&"normal"!=f?f:dext5_lang.icon.line_height);if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion){try{s=s.toString()}catch(l){s=""}try{if(u=!1,0>s.indexOf("%")&&0>s.indexOf("px")&&0>s.indexOf("pt")&&0>s.indexOf("em")&&(u=!0),"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode){if(u)c=DEXTTOP.G_CURREDITOR._setting.line_height,h="",-1<c.indexOf("%")?h=parseInt(c,10)/100+.01:0>c.indexOf("px")&&0>c.indexOf("pt")&&0>c.indexOf("em")&&(h=parseFloat(c)+.01),h=h.toString(),s==h&&(-1<c.indexOf("%")?s=parseFloat(c)/100:0>c.indexOf("px")&&0>c.indexOf("pt")&&0>c.indexOf("em")&&(s=c));else if(-1<s.indexOf("%")){var c=DEXTTOP.G_CURREDITOR._setting.line_height,h="";-1<c.indexOf("%")?h=parseInt(c,10)+1:0>c.indexOf("px")&&0>c.indexOf("pt")&&0>c.indexOf("em")&&(h=100*parseFloat(c)+1),h=h.toString(),s==h+"%"&&(-1<c.indexOf("%")?s=c+"%":0>c.indexOf("px")&&0>c.indexOf("pt")&&0>c.indexOf("em")&&(s=100*parseFloat(c)+"%"))}}else c=DEXTTOP.G_CURREDITOR._setting.line_height,h="",-1<c.indexOf("%")?h=parseInt(c,10)/100+.01:0>c.indexOf("px")&&0>c.indexOf("pt")&&0>c.indexOf("em")&&(h=parseFloat(c)+.01),h=h.toString(),s==h&&(s=100*parseFloat(c)+"%")}catch(p){}}}""==t&&(t=dext5_lang.icon.formatting);if(c=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"formatting"))c.innerHTML="<span>"+t+"</span>";c=null;if("1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin){if(c=document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"line_height"))c.value=s}else if(c=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"line_height"))c.innerHTML="<span>"+s+"</span>";c=null;if(c="1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"font_size"):document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_size")){try{if(-1<i.indexOf(".")&&(h="",-1<i.indexOf("px")||-1<i.indexOf("pt")||-1<i.indexOf("em")?h=i.substring(i.length-2):-1<i.indexOf("%")&&(h=i.substring(i.length-1)),"pt"!=h))var d=parseFloat(i),d=Math.round(d),i=d+h}catch(v){}"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?c.value=i:c.innerHTML="<span>"+i+"</span>"}d=null;if("1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin){if(d=document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))c=getDisplayFontName(n),d.value=c}else if(d=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))c=getDisplayFontName(n),d.innerHTML="<span>"+c+"</span>";if(d=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"letter_spacing"))d.innerHTML="<span>"+o+"</span>";d=[],""!=getElementInParentTag(e,["b","strong"])&&d.push("bold"),""!=getElementInParentTag(e,["em","i"])&&d.push("italic"),""!=getElementInParentTag(e,["u"])&&d.push("underline"),""!=getElementInParentTag(e,["strike"])&&d.push("strike_through"),""!=getElementInParentTag(e,["sup"])&&d.push("superscript"),""!=getElementInParentTag(e,["sub"])&&d.push("subscript"),""!=getElementInParentTag(e,["ol"])&&d.push("list_number"),""!=getElementInParentTag(e,["ul"])&&d.push("list_bullets");var m;DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(m=GetParentbyTagName(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,"figure"));if("table"==e.tagName.toLowerCase()){if(m=e.getAttribute("align"),null==m||""==m)m="justify"}else m?(m="cssFloat"in m.style?m.style.cssFloat:m.style.styleFloat,""==m&&(m=DEXTTOP.DEXT5.util.getStyle(e,"textAlign"),""==m&&(m=getElementInParentProperty(e,"align")))):(m=DEXTTOP.DEXT5.util.getStyle(e,"textAlign"),""==m&&(m=getElementInParentProperty(e,"align")));"left"==m&&d.push("align_left"),"center"==m&&d.push("align_center"),"right"==m&&d.push("align_right"),"justify"==m&&d.push("align_full"),m=getElementInParentProperty(e,"dir").toLowerCase(),"rtl"==m&&d.push("dirrtl"),"ltr"==m&&d.push("dirltr");try{null==DrageEndCell&&""==getElementInParentTag(e,"h1 h2 h3 h4 h5 h6".split(" "))&&(_iframeDoc.queryCommandState("bold")?d.push("bold"):removeArrayItemByValue(d,"bold"))}catch(g){removeArrayItemByValue(d,"bold")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("italic")?d.push("italic"):removeArrayItemByValue(d,"italic"))}catch(y){removeArrayItemByValue(d,"italic")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("underline")?d.push("underline"):removeArrayItemByValue(d,"underline"))}catch(b){removeArrayItemByValue(d,"underline")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("strikeThrough")?d.push("strike_through"):removeArrayItemByValue(d,"strike_through"))}catch(w){removeArrayItemByValue(d,"strike_through")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("superscript")?d.push("superscript"):removeArrayItemByValue(d,"superscript"))}catch(E){removeArrayItemByValue(d,"superscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("subscript")?d.push("subscript"):removeArrayItemByValue(d,"subscript"))}catch(S){removeArrayItemByValue(d,"subscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertOrderedList")?d.push("list_number"):removeArrayItemByValue(d,"list_number"))}catch(x){removeArrayItemByValue(d,"list_number")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertUnOrderedList")?d.push("list_bullets"):removeArrayItemByValue(d,"list_bullets"))}catch(T){removeArrayItemByValue(d,"list_bullets")}return"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?d.push("full_screen"):removeArrayItemByValue(d,"full_screen"),"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?d.push("show_blocks"):removeArrayItemByValue(d,"show_blocks"),1==DEXTTOP.G_CURREDITOR.ShowTableBorder?d.push("table_border"):removeArrayItemByValue(d,"table_border"),m=GetTDTHCell(e),checkLockAttr(m,!0)?d.push("cell_lock"):removeArrayItemByValue(d,"cell_lock"),e=GetParentbyTagName(e,"table"),checkLockAttr(e,!0)?d.push("table_lock"):removeArrayItemByValue(d,"table_lock"),DEXTTOP.G_CURREDITOR._iconSelected(d),{formattingVal:t,lineHeightVal:s,fontSizeVal:i,fontFamilyVal:n,fontLetterSpacingVal:o}}}function removeArrayItemByValue(e){for(var t,n=arguments,r=n.length,i;1<r&&e.length;)for(t=n[--r];-1!==(i=e.indexOf(t));)e.splice(i,1)}function dialogCancel(){var e=getEditrFromEvent(null);"shortcut"==G_LAST_CMD&&G_ShortCutClick?(G_ShortCutClose=!0,G_ShortCutClick=!1,0==DEXTTOP.DEXT5.browser.ie&&window.focus(),document.getElementById("ue_"+e.ID+"shortcut").focus()):((e._LastRange||void 0!=e._LastRange)&&restoreSelection(e._LastRange),setFocusToBody())}function RepaireTagInTag(e,t){for(var n=_iframeDoc.body.getElementsByTagName(t),r=n.length,i=null,s=0;s<r;s++){var i=n[s],o=GetParentbyTagName(i,e);o&&(o.removeChild(i),i=getFirstRange().range)&&(i.selectNode(o),i.setStartBefore(o),i.collapse(!0),o=_iframeDoc.createElement("hr"),i.insertNode(o),i.selectNode(o),i.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges())}}function doSetCaretPosition(e,t,n,r){try{var i=DEXTTOP.G_CURREDITOR;n&&(i=n);if(0!=i._config.initFocus||!i.isInitFocusHandler)if("view"!=i._config.mode||null!=r&&void 0!=r&&1==r)n=!0,0<t&&(n=!1),moveCursorToTag(e,n),setFocusToBody()}catch(s){}}function setFocusTopWindow(){try{DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXTWIN.focus(),DEXTTOP.DEXTDOC.body.focus()}catch(e){}}function setDextCustomData(e,t){return t.keyid=getNextNumber(),e.setAttribute("dext5customdata",t.keyid),DEXTTOP.G_CURREDITOR._dextCustomData.push(t),t.keyid}function getDextCustomData(e){for(var t=DEXTTOP.G_CURREDITOR._dextCustomData.length,n=0;n<t;n++)if(DEXTTOP.G_CURREDITOR._dextCustomData[n].keyid==e)return DEXTTOP.G_CURREDITOR._dextCustomData[n];return null}function removeDextCustomData(e){for(var t=DEXTTOP.G_CURREDITOR._dextCustomData.length,n=0;n<t;n++)DEXTTOP.G_CURREDITOR._dextCustomData[n].keyid===e&&DEXTTOP.G_CURREDITOR._dextCustomData.splice(n,1)}function getDextVideoData(e){var t={};if(e){t.type="video_media",t.src="",t.source=[];try{if(null!=e.getAttribute("src"))t.src=e.getAttribute("src");else if(0!=e.getElementsByTagName("source").length){var n=e.getElementsByTagName("source");if(null!=n[0].getAttribute("src")){t.source.push({src:n[0].getAttribute("src")});try{"undefined"!=typeof n[1]&&(n[1].src=""),"undefined"!=typeof n[2]&&(n[2].src="")}catch(r){}}}}catch(i){}t.width="",t.height="",""!=e.style.width?t.width=e.style.width:null!=e.getAttribute("width")&&(t.width=e.getAttribute("width")),""!=e.style.height?t.height=e.style.height:null!=e.getAttribute("height")&&(t.height=e.getAttribute("height")),t.autoPlay=null==e.getAttribute("autoplay")?!1:!0,t.loop=null==e.getAttribute("loop")?!1:!0,t.controls=null==e.getAttribute("controls")?!1:!0,t.muted=null==e.getAttribute("muted")?!1:!0,t.poster=null==e.getAttribute("poster")?"":e.getAttribute("poster"),"object"==typeof e.attributes&&(t.attributes=e.attributes)}return t}function removeAllDextCustomData(){DEXTTOP.G_CURREDITOR._dextCustomData=[]}function isSameCustomData(e){for(var t=DEXTTOP.G_CURREDITOR._dextCustomData.length,n=0;n<t;n++)if(DEXTTOP.G_CURREDITOR._dextCustomData[n].keyid===e)return DEXTTOP.G_CURREDITOR._dextCustomData[n];return null}function ReplaceImageToRealObject(e,t){if((0!=!!t||"0"!=DEXTTOP.G_CURREDITOR._config.useReplaceImage)&&1!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,displayPageBreak(!1);for(var n=_iframeDoc.getElementsByTagName("img"),r=n.length-1;0<=r;r--){var i=n[r],s=i.getAttribute("dext5customdata");if(null!=s&&void 0!=s&&(s=getDextCustomData(s)))if("iframe"==s.type||"iframe"==s.type2){var o=_iframeDoc.createElement("iframe");if("undefined"!=typeof s.attributes)for(var u=",src,id,name,title,class,width,height,align,scrolling,frameborder,caption,",a=s.attributes.length,f=0;f<a;f++){var l=s.attributes[f];l.specified&&0>u.indexOf(","+l.name.toLowerCase()+",")&&("style"==l.name.toLowerCase()?o.style.cssText=l.value:o.setAttribute(l.name,l.value))}o.style.width=""!=i.style.width?0==parseIntOr0(i.style.width)?i.width:i.style.width:"",o.style.height=""!=i.style.height?0==parseIntOr0(i.style.height)?i.height:i.style.height:"",-1<s.src.indexOf("dext5player/media_player")?(u=s.src.lastIndexOf("&"),u=s.src.substring(0,u),u+="&size="+parseIntOr0(o.width)+"^"+parseIntOr0(o.height),o.src=u):o.src=s.src,o.id=s.id,o.name=s.name,o.title=s.title,o.className=s.className,null!=i.align&&void 0!=i.align&&(s.align=i.align),o.align=s.align,o.scrolling=s.scrolling,o.frameBorder=s.frameBorder?1:0,s.caption&&""!=s.caption&&o.setAttribute("DEXT_fiVe_Media_Caption",s.caption),o.style.position=i.style.position,o.style.left=i.style.left,o.style.top=i.style.top,i.parentNode.replaceChild(o,i)}else if("flash"==s.type||"flash"==s.type2){o=_iframeDoc.createElement("div"),u="",u+="<embed src='"+s.src+"'",""!=s.hspace&&(u+=" hspace='"+s.hspace+"px'"),""!=s.vspace&&(u+=" vspace='"+s.vspace+"px'"),""!=s.scale&&(u+=" scale='"+s.scale+"'"),""!=s.allowScriptAccess&&(u+=" allowScriptAccess='"+s.allowScriptAccess+"'"),""!=s.quality&&(u+=" quality='"+s.quality+"'"),""!=s.align&&(u+=" align='"+s.align+"'"),u=0==s.menu?u+" menu='false'":u+" menu='true'",u=0==s.play?u+" play='false'":u+" play='true'",u=0==s.loop?u+" loop='false'":u+" loop='true'",u=0==s.allowFullScreen?u+" allowFullScreen='false'":u+" allowFullScreen='true'",s.flashvars&&""!=s.flashvars&&(u+=" flashvars='"+s.flashvars+"'"),s.caption&&""!=s.caption&&(u+=" DEXT_fiVe_Media_Caption='"+s.caption+"'"),0>s.src.indexOf("dext5player/")&&(u+=' wmode="transparent"'),u+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />",o.innerHTML=u,o=o.firstChild;if("undefined"!=typeof s.attributes)for(u=",src,width,height,hspace,vspace,marginLeft,marginright,marginTop,marginbottom,scale,allowscriptaccess,quality,menu,play,loop,allowfullscreen,flashvars,caption,",a=s.attributes.length,f=0;f<a;f++)l=s.attributes[f],l.specified&&0>u.indexOf(","+l.name.toLowerCase()+",")&&("style"==l.name.toLowerCase()?o.style.cssText=l.value:"class"==l.name.toLowerCase()?o.className=l.value:o.setAttribute(l.name,l.value));o.style.marginLeft=i.style.marginLeft,o.style.marginRight=i.style.marginRight,o.style.marginTop=i.style.marginTop,o.style.marginBottom=i.style.marginBottom,o.style.width=""!=i.style.width?0==parseIntOr0(i.style.width)?i.width:i.style.width:"",o.style.height=""!=i.style.height?0==parseIntOr0(i.style.height)?i.height:i.style.height:"",o.style.position=i.style.position,o.style.left=i.style.left,o.style.top=i.style.top,i.parentNode.replaceChild(o,i)}else if("media"==s.type){o=_iframeDoc.createElement("div"),a="",a+="<embed style='width:"+s.width+"px; height:"+s.height+"px;' ",a+=" type='application/x-mplayer2'",a+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ",a+=" src='"+s.src+"'",u=1==s.autoStart?"1":"0",a+=" AutoStart='"+u+"'",u=1==s.playCount?"1":"0",a+=" loop='"+u+"'",u=1==s.showTracker?"1":"0",a+=" ShowTracker='"+u+"'",u=1==s.showStatusBar?"1":"0",a+=" ShowStatusBar='"+u+"'",u=1==s.showControls?"1":"0",a+=" ShowControls='"+u+"'",u=1==s.showAudioControls?"1":"0",a+=" ShowAudioControls='"+u+"'",u=1==s.showDisplay?"1":"0",a+=" ShowDisplay='"+u+"'",u=1==s.showPositionControls?"1":"0",a+=" ShowPositionControls='"+u+"'",a+=" />",o.innerHTML=a;var c=o.firstChild;if("undefined"!=typeof s.attributes)for(u=",src,width,height,autostart,playcount,showtracker,showstatusbar,showcontrols,showaudiocontrols,showdisplay,showpositioncontrols,",a=s.attributes.length,f=0;f<a;f++)l=s.attributes[f],l.specified&&0>u.indexOf(","+l.name.toLowerCase()+",")&&("style"==l.name.toLowerCase()?c.style.cssText=l.value:"class"==l.name.toLowerCase()?c.className=l.value:c.setAttribute(l.name,l.value));c.style.width=""!=i.style.width?0==parseIntOr0(i.style.width)?i.width:i.style.width:"",c.style.height=""!=i.style.height?0==parseIntOr0(i.style.height)?i.height:i.style.height:"",c.style.position=i.style.position,c.style.left=i.style.left,c.style.top=i.style.top,i.parentNode.replaceChild(c,i),o.innerHTML=""}else if("hidden"==s.type){o=_iframeDoc.createElement("input");if("undefined"!=typeof s.attributes)for(u=",id,name,value,class,title,",a=s.attributes.length,f=0;f<a;f++)l=s.attributes[f],l.specified&&0>u.indexOf(","+l.name.toLowerCase()+",")&&("style"==l.name.toLowerCase()?o.style.cssText=l.value:o.setAttribute(l.name,l.value));o.type=s.type,o.id=s.id,o.name=s.name,o.value=s.value,o.className=s.className,o.title=s.title,i.parentNode.replaceChild(o,i)}else if("video_media"==s.type){o=_iframeDoc.createElement("div"),u="",u+="<video";if(""!=s.width||""!=s.height)a=' style="#style#"',f="",""!=s.width&&(f+="width:"+s.width+";"),""!=s.height&&(f+="height:"+s.height+";"),a=a.replace("#style#",f),u+=" "+a;""!=s.src&&(u+=" src='"+s.src+"'"),1==s.autoPlay&&(u+=" autoplay=''"),1==s.loop&&(u+=" loop=''"),1==s.controls&&(u+=" controls=''"),1==s.muted&&(u+=" muted=''"),void 0!=s.poster&&""!=s.poster&&(u+=" poster='"+s.poster+"'"),u+=">";if("undefined"!=typeof s.source&&0<s.source.length){l="",a=0;for(f=s.source.length;a<f;a++)-1<s.source[a].src.lastIndexOf(".")&&(l=s.source[a].src.slice(s.source[a].src.lastIndexOf(".")+1),""!=l&&-1<",mp4,ogv,webm,".indexOf(","+l+",")&&(l="video/"+("ogv"==l?"ogg":l),u+='<source src="'+s.source[a].src+'" type="'+l+'" />'));u+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800"}u+="</video>",o.innerHTML=u,c=o.firstChild;if("undefined"!=typeof s.attributes)for(u=",src,width,height,autoplay,loop,controls,muted,poster,",a=s.attributes.length,f=0;f<a;f++)l=s.attributes[f],l.specified&&0>u.indexOf(","+l.name.toLowerCase()+",")&&("style"==l.name.toLowerCase()?c.style.cssText=l.value:"class"==l.name.toLowerCase()?c.className=l.value:c.setAttribute(l.name,l.value));c.style.width=""!=i.style.width?0==parseIntOr0(i.style.width)?i.width:i.style.width:"",c.style.height=""!=i.style.height?0==parseIntOr0(i.style.height)?i.height:i.style.height:"",c.style.position=i.style.position,c.style.left=i.style.left,c.style.top=i.style.top,i.parentNode.replaceChild(c,i),o.innerHTML=""}}}}function ReplaceRealObjectToImage(e){if("0"!=DEXTTOP.G_CURREDITOR._config.useReplaceImage&&0!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1,0!=e&&removeAllDextCustomData(),displayPageBreak(!0);var t=_iframeDoc.getElementsByTagName("iframe");for(e=t.length-1;0<=e;e--){var n=t[e],r={},i=getLinkMediaType(n.src);r.type=""==i?"iframe":i,r.type2="iframe",r.src=n.getAttribute("src");try{r.src||(r.src=""),n.src=""}catch(s){}r.id=n.id,r.name=n.name,r.title=n.title,r.className=n.className,r.width=""==n.style.width&&0==parseIntOr0(n.style.width)?n.width:n.style.width,r.height=""==n.style.height&&0==parseIntOr0(n.style.height)?n.height:n.style.height,r.align=n.align,r.scrolling=n.scrolling,r.frameBorder="1"==n.frameBorder?!0:!1,n.getAttribute("DEXT_fiVe_Media_Caption")&&(r.caption=n.getAttribute("DEXT_fiVe_Media_Caption")),r.attributes=n.attributes,r=makeImageElementForObject(r),r.style.position=n.style.position,r.style.left=n.style.left,r.style.top=n.style.top,n.parentNode.replaceChild(r,n)}t=_iframeDoc.getElementsByTagName("embed");for(e=t.length-1;0<=e;e--){n=t[e],r=n.getAttribute("type");if(void 0==r||null==r)r="";i=n.getAttribute("pluginspage");if(void 0==i||null==i)i="";if(n.getAttribute("wmode")||-1<r.indexOf("x-shockwave-flash")||-1<n.src.indexOf("dext5player/")){r={},i=getLinkMediaType(n.src),r.type=""==i?"flash":i,r.type2="flash",r.src=n.getAttribute("src");try{n.src=""}catch(o){}r.width=""==n.style.width&&0==parseIntOr0(n.style.width)?n.width:n.style.width,r.height=""==n.style.height&&0==parseIntOr0(n.style.height)?n.height:n.style.height,r.hspace=null==n.getAttribute("hspace")?"":n.getAttribute("hspace").replace("px",""),r.vspace=null==n.getAttribute("vspace")?"":n.getAttribute("vspace").replace("px",""),r.scale=null==n.getAttribute("scale")?"":n.getAttribute("scale"),r.allowScriptAccess=null==n.getAttribute("allowScriptAccess")?"":n.getAttribute("allowscriptaccess"),r.quality=null==n.getAttribute("quality")?"":n.getAttribute("quality"),r.align=null==n.getAttribute("align")?"":n.getAttribute("align"),r.margin_left=n.style.marginLeft,r.margin_right=n.style.marginRight,r.margin_top=n.style.marginTop,r.margin_bottom=n.style.marginBottom,null==n.getAttribute("menu")?r.menu=!0:r.menu=n.getAttribute("menu"),null==n.getAttribute("play")?r.play=!0:r.play=n.getAttribute("play"),null==n.getAttribute("loop")?r.loop=!0:r.loop=n.getAttribute("loop"),null==n.getAttribute("allowFullScreen")?r.allowFullScreen=!0:r.allowFullScreen=n.getAttribute("allowFullScreen"),null==n.getAttribute("DEXT_fiVe_Media_Caption")?r.caption="":r.caption=n.getAttribute("DEXT_fiVe_Media_Caption"),n.getAttribute("flashvars")&&(r.flashvars=n.getAttribute("flashvars")),r.attributes=n.attributes,r=makeImageElementForObject(r),r.style.position=n.style.position,r.style.left=n.style.left,r.style.top=n.style.top,n.parentNode.replaceChild(r,n)}else if(n.getAttribute("AutoStart")||-1<r.indexOf("application/")||-1<i.indexOf("windowsmedia")){r={type:"media"},r.src=n.getAttribute("src");try{n.src=""}catch(u){}r.width=""==n.style.width&&0==parseIntOr0(n.style.width)?n.width:n.style.width,r.height=""==n.style.height&&0==parseIntOr0(n.style.height)?n.height:n.style.height,1==n.getAttribute("AutoStart")?r.autoStart=!0:r.autoStart=!1,1==n.getAttribute("loop")?r.playCount=!0:r.playCount=!1,1==n.getAttribute("ShowTracker")?r.showTracker=!0:r.showTracker=!1,1==n.getAttribute("ShowStatusBar")?r.showStatusBar=!0:r.showStatusBar=!1,1==n.getAttribute("ShowControls")?r.showControls=!0:r.showControls=!1,1==n.getAttribute("ShowAudioControls")?r.showAudioControls=!0:r.showAudioControls=!1,1==n.getAttribute("ShowDisplay")?r.showDisplay=!0:r.showDisplay=!1,1==n.getAttribute("ShowPositionControls")?r.showPositionControls=!0:r.showPositionControls=!1,r.attributes=n.attributes,r=makeImageElementForObject(r),r.style.position=n.style.position,r.style.left=n.style.left,r.style.top=n.style.top,n.parentNode.replaceChild(r,n)}}t=_iframeDoc.getElementsByTagName("input");for(e=t.length-1;0<=e;e--)n=t[e],"hidden"==n.type&&(r={type:"hidden"},r.id=n.id,r.name=n.name,r.value=n.value,r.className=n.className,r.title=n.title,r.attributes=n.attributes,r=makeImageElementForObject(r),n.parentNode.replaceChild(r,n));t=_iframeDoc.getElementsByTagName("video");for(e=t.length-1;0<=e;e--){var n=t[e],r={type:"video_media",source:[],src:""},a=n.getElementsByTagName("source");if(0!=a.length)for(i=0,a=a.length;i<a;i++)null!=n.getElementsByTagName("source")[i].getAttribute("src")&&r.source.push({src:n.getElementsByTagName("source")[i].getAttribute("src")});else i=n.getAttribute("src"),null!=i&&(r.src=i);r.width="",r.height="",""!=n.style.width?r.width=n.style.width:null!=n.getAttribute("width")&&(r.width=n.getAttribute("width")),""!=n.style.height?r.height=n.style.height:null!=n.getAttribute("height")&&(r.height=n.getAttribute("height")),r.autoPlay=null==n.getAttribute("autoplay")?!1:!0,r.loop=null==n.getAttribute("loop")?!1:!0,r.controls=null==n.getAttribute("controls")?!1:!0,r.muted=null==n.getAttribute("muted")?!1:!0,r.poster=null==n.getAttribute("poster")?"":n.getAttribute("poster"),"object"==typeof n.attributes&&(r.attributes=n.attributes),r=makeImageElementForObject(r),r.style.position=n.style.position,r.style.left=n.style.left,r.style.top=n.style.top,n.parentNode.replaceChild(r,n)}}}function ReplaceBase64ImageToArray(e,t){if("html5"==e.runtimes&&"base64"==e.uploadMethod)try{var n=t.getElementsByTagName("img");if(n&&0<n.length){G_ImagesBase64Data=[];for(var r=0,i=n.length;r<i;r++)G_ImagesBase64Data.push(n[r].src),n[r].src="DEXT5ImagesBase64Data_"+r.toString()}}catch(s){}}function ReplaceArrayToBase64Image(e,t,n){var r=n;if("html5"==e.runtimes&&"base64"==e.uploadMethod){try{var i=t.getElementsByTagName("img");if(i&&0<i.length){e=0;for(var s=i.length;e<s;e++)i[e].src=G_ImagesBase64Data[e],r=r.replace("DEXT5ImagesBase64Data_"+e,G_ImagesBase64Data[e])}}catch(o){r=n}G_ImagesBase64Data=[]}return r}function FixFlashError(){var e=DEXTTOP.G_CURREDITOR;if(null!=e){var t;if(t=e._EDITOR.preview.contentDocument?e._EDITOR.preview.contentDocument:e._EDITOR.preview.contentWindow.document){for(var n=t.getElementsByTagName("iframe"),e=n.length-1;0<=e;e--){var r=n[e];try{r.src="",r.parentNode.removeChild(r)}catch(i){}}t=t.getElementsByTagName("embed");for(e=t.length-1;0<=e;e--){n=t[e];try{n.src="",n.parentNode.removeChild(n)}catch(s){}}}}}function FixFlashError2(e){if(e){for(var t=e.getElementsByTagName("iframe"),n=t.length-1;0<=n;n--){var r=t[n];try{r.src="",r.parentNode.removeChild(r)}catch(i){}}e=e.getElementsByTagName("embed");for(n=e.length-1;0<=n;n--){t=e[n];try{t.src="",t.parentNode.removeChild(t)}catch(s){}}}}function makeImageElementForObject(e){var t="";"iframe"==e.type?t=-1<e.src.indexOf("dext5player/media_player")?"dialog/custom_insert_image.jpg":"dialog/objectiframe.jpg":"flash"==e.type?t=-1<e.src.indexOf("dext5player/")?"dialog/custom_insert_image.jpg":"dialog/objectflash.jpg":"media"==e.type?t="dialog/objectmedia.jpg":"youtube"==e.type?t="dialog/youtube.jpg":"daum"==e.type?t="dialog/daum.jpg":"naver"==e.type?t="dialog/naver.jpg":"link_media"==e.type?t="dialog/link_media.jpg":"hidden"==e.type?t="dialog/hidden.jpg":"video_media"==e.type&&(t="dialog/video.jpg");var n=_iframeDoc.createElement("img");return n.src=DEXTTOP.G_CURREDITOR._config.webPath.image+t,t={},t.attributes=e.attributes,""!=e.width&&null!=e.width&&void 0!=e.width&&(e.width=e.width.toString(),-1<e.width.indexOf("px")||-1<e.width.indexOf("%")||-1<e.width.indexOf("pt")?n.style.width=e.width:n.style.width=e.width+"px"),""!=e.height&&null!=e.height&&void 0!=e.height&&(e.height=e.height.toString(),-1<e.height.indexOf("px")||-1<e.height.indexOf("%")||-1<e.height.indexOf("pt")?n.style.height=e.height:n.style.height=e.height+"px"),"iframe"==e.type||"iframe"==e.type2?(t.type=e.type,t.type2=e.type2,t.src=e.src?e.src:"",t.width=e.width?e.width:"",t.height=e.height?e.height:"",t.id=e.id?e.id:"",t.name=e.name?e.name:"",t.title=e.title?e.title:"",t.className=e.className?e.className:"",t.align=e.align?e.align:"",t.scrolling=e.scrolling?e.scrolling:"",t.frameBorder=e.frameBorder?e.frameBorder:"",t.caption=e.caption?e.caption:"",n.align=e.align):"flash"==e.type||"flash"==e.type2?(t.type=e.type,t.type2=e.type2,t.src=e.src,t.width=e.width,t.height=e.height,t.hspace=e.hspace?e.hspace:"",t.vspace=e.vspace?e.vspace:"",t.margin_left=e.margin_left,t.margin_right=e.margin_right,t.margin_top=e.margin_top,t.margin_bottom=e.margin_bottom,t.scale=e.scale,t.allowScriptAccess=e.allowScriptAccess,t.quality=e.quality,t.menu=e.menu,t.play=e.play,t.loop=e.loop,t.allowFullScreen=e.allowFullScreen,t.flashvars=e.flashvars,t.caption=e.caption,t.align="",e.hspace&&(n.hspace=e.hspace),e.vspace&&(n.vspace=e.vspace),e.margin_left&&(-1<e.margin_left.indexOf("px")||-1<e.margin_left.indexOf("%")||-1<e.margin_left.indexOf("pt")?n.style.marginLeft=e.margin_left:n.style.marginLeft=e.margin_left+"px"),e.margin_right&&(-1<e.margin_right.indexOf("px")||-1<e.margin_right.indexOf("%")||-1<e.margin_right.indexOf("pt")?n.style.marginRight=e.margin_right:n.style.marginRight=e.margin_right+"px"),e.margin_top&&(-1<e.margin_top.indexOf("px")||-1<e.margin_top.indexOf("%")||-1<e.margin_top.indexOf("pt")?n.style.marginTop=e.margin_top:n.style.marginTop=e.margin_top+"px"),e.margin_bottom&&(-1<e.margin_bottom.indexOf("px")||-1<e.margin_bottom.indexOf("%")||-1<e.margin_bottom.indexOf("pt")?n.style.marginBottom=e.margin_bottom:n.style.marginBottom=e.margin_bottom+"px"),n.align="",-1<",absbottom,absmiddle,absmiddle,bottom,left,middle,right,texttop,top,".indexOf(","+e.align+",")&&(n.align=e.align,t.align=e.align)):"media"==e.type?(t.type=e.type,t.src=e.src,t.width=e.width,t.height=e.height,t.autoStart=e.autoStart,t.playCount=e.playCount,t.showTracker=e.showTracker,t.showStatusBar=e.showStatusBar,t.showControls=e.showControls,t.showAudioControls=e.showAudioControls,t.showDisplay=e.showDisplay,t.showPositionControls=e.showPositionControls):"hidden"==e.type?(t.type=e.type,t.id=e.id,t.name=e.name,t.value=e.value,t.className=e.className,t.title=e.title):"video_media"==e.type&&(t.type=e.type,t.src=e.src,t.width=e.width,t.height=e.height,t.autoPlay=e.autoPlay,t.loop=e.loop,t.controls=e.controls,t.muted=e.muted,t.poster=e.poster,t.source=e.source,"object"==typeof e.attributes&&(t.attributes=e.attributes),""!=e.width&&null!=e.width&&void 0!=e.width&&(e.width=e.width.toString(),-1<e.width.indexOf("px")||-1<e.width.indexOf("%")||-1<e.width.indexOf("pt")?n.style.width=e.width:n.style.width=e.width+"px"),""!=e.height&&null!=e.height&&void 0!=e.height&&(e.height=e.height.toString(),-1<e.height.indexOf("px")||-1<e.height.indexOf("%")||-1<e.height.indexOf("pt")?n.style.height=e.height:n.style.height=e.height+"px")),setDextCustomData(n,t),n}function startDrag(e){var t=getDialogWindow(),n=getDialogDocument();e||(e=t.event),offsetX=e.clientX,offsetY=e.clientY,dragPopup.style.left||(dragPopup.style.left="0px"),dragPopup.style.top||(dragPopup.style.top="0px");var t=dragPopup.getElementsByTagName("div")[1],r=!1;t&&(t=getClientRect(t),r=point_in_rectagnle(offsetX,offsetY,t.left,t.top,t.right,t.bottom)),0==r&&(coordX=parseInt(dragPopup.style.left),coordY=parseInt(dragPopup.style.top),drag=!0,DEXTTOP.DEXT5.util.addEvent(n,"mousemove",dragDiv),DEXTTOP.DEXT5.util.addEvent(n,"mouseup",stopDrag),11<=DEXTTOP.DEXT5.browser.ieVersion&&dragPopup.getElementsByTagName("iframe")[0].focus()),DEXTTOP.DEXT5.util.cancelEvent(e)}function dragDiv(e){if(drag){var t=getDialogWindow();getDialogDocument(),e||(e=t.event);var n=dragPopup.getElementsByTagName("iframe")[0],r=dragPopup.getElementsByTagName("div")[2],i=dragPopup.getElementsByTagName("iframe")[1];r.style.width="100%",r.style.height="100%",n&&r&&i&&(n.style.zIndex="-1"),n=getWindowClientSize(t),r=[dragPopup.offsetWidth||0,dragPopup.offsetHeight||0],currentScrollPos=getWindowScrollPos(t),t=coordX+e.clientX-offsetX,i=coordY+e.clientY-offsetY,0>=t-currentScrollPos[0]&&(t=currentScrollPos[0]),0>=i-currentScrollPos[1]&&(i=currentScrollPos[1]),t+r[0]>=n[0]+currentScrollPos[0]&&(t=n[0]-r[0]+currentScrollPos[0]),i+r[1]>=n[1]+currentScrollPos[1]&&(i=n[1]-r[1]+currentScrollPos[1]),dragPopup.style.left=t+"px",dragPopup.style.top=i+"px",DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e)}}function stopDrag(e){e=getDialogDocument(),drag=!1,dragPopup.style.cursor="";var t=dragPopup.getElementsByTagName("iframe")[0],n=dragPopup.getElementsByTagName("div")[2],r=dragPopup.getElementsByTagName("iframe")[1];t&&n&&r&&(t.style.zIndex="1"),DEXTTOP.DEXT5.util.removeEvent(e,"mousemove",dragDiv),DEXTTOP.DEXT5.util.removeEvent(e,"mouseup",stopDrag)}function makeDragPopup(e){drag=!1;var t=getDialogWindow();DEXTTOP.DEXT5.util.addEvent(e,"mousedown",startDrag),DEXTTOP.DEXT5.util.addEvent(e,"mouseover",function(){e.style.cursor="move"}),DEXTTOP.DEXT5.util.addEvent(e,"mouseout",function(){e.style.cursor="pointer"}),DEXTTOP.DEXT5.util.addEvent(t,"scroll",function(e){drag&&t.scroll(currentScrollPos[0],currentScrollPos[1])}),dragPopup=e}function isRelativePosition(e){for(;null!=e&&(!e.tagName||"body"!=e.tagName.toLowerCase());)if(e=e.parentNode,"relative"==e.style.position)return!0;return!1}function setBackupHiddenStyle(e,t){originStylebackup=[];for(var n=e;null!=n&&(!n.tagName||"body"!=n.tagName.toLowerCase());){if(n!=e){var r;(r=t.getComputedStyle?t.getComputedStyle(n,""):n.currentStyle)&&r.overflow&&"hidden"==r.overflow&&(originStylebackup.push(n),n.style.setProperty?n.style.setProperty("overflow","visible",null):n.style.setAttribute("overflow","visible"))}n=n.parentNode}}function setRestorreHiddenStyle(){for(var e=originStylebackup.length,t=0;t<e;t++){var n=originStylebackup[t];n.style.setProperty?n.style.setProperty("overflow","hidden",null):n.style.setAttribute("overflow","hidden")}originStylebackup=[]}function resizeDextWin(){var e=DEXTTOP.G_CURREDITOR._config.fullScreenTop,t=DEXTTOP.G_CURREDITOR._config.fullScreenLeft,n=DEXTTOP.G_CURREDITOR._config.fullScreenRight,r=DEXTTOP.G_CURREDITOR._config.fullScreenBottom,i=window.frameElement,s=getWindowClientSize(DEXTTOP.DEXTWIN);if(relativePos){i.style.left="0px",i.style.top="0px";var o=getClientRect(i),u=0,a=0,u=-1*o.left,a=-1*o.top;i.style.left=parseIntOr0(i.style.left)+u+"px",i.style.top=parseIntOr0(i.style.top)+a+"px"}else 1==DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.browser.quirks?(i.style.left=originScrollSize[0]+"px",i.style.top=originScrollSize[1]+"px"):(i.style.left="0px",i.style.top="0px");0<t&&(i.style.left=DEXTTOP.DEXT5.util.parseIntOr0(i.style.left)+t+"px"),0<e&&(i.style.top=DEXTTOP.DEXT5.util.parseIntOr0(i.style.top)+e+"px"),0<n&&(i.style.right=DEXTTOP.DEXT5.util.parseIntOr0(i.style.right)+n+"px"),0<r&&(i.style.bottom=DEXTTOP.DEXT5.util.parseIntOr0(i.style.bottom)+r+"px");var f=document.getElementById("ue_editor_holder_"+DEXTTOP.G_CURREDITOR.ID);0<s[0]-t-n&&(i.style.width=s[0]-t-n+"px"),0<s[1]-e-r&&(i.style.height=s[1]-e-r+"px"),setTimeout(function(){var e=document.getElementById("dext_topstatusbar_"+DEXTTOP.G_CURREDITOR.ID),t=document.getElementById("dext_menu_"+DEXTTOP.G_CURREDITOR.ID),n=document.getElementById("dext_toolbar_"+DEXTTOP.G_CURREDITOR.ID),r=document.getElementById("dext_statusbar_"+DEXTTOP.G_CURREDITOR.ID),s,o,u,a;e&&(s=getClientRect(e)),t&&(o=getClientRect(t)),n&&(u=getClientRect(n)),r&&(a=getClientRect(r)),e=0,o&&(e+=o.bottom-o.top),u&&(e+=u.bottom-u.top),e=s?e+(s.bottom-s.top):e+1,e=a?e+(a.bottom-a.top):e+1,DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight=e,0<DEXTTOP.DEXT5.util.parseIntOr0(i.style.height)-DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight&&(f.style.height=DEXTTOP.DEXT5.util.parseIntOr0(i.style.height)-DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight+"px")},50)}function getCustomParam(e,t){var n={},r=document.createElement("div");r.innerHTML=e;var i=r.getElementsByTagName("embed")[0],s=r.getElementsByTagName("iframe")[0];if(null!=i){n.attributes=i.attributes,n.src=i.getAttribute("src")?i.getAttribute("src"):"";var o=0!=parseIntOr0(i.style.width)?i.style.width:i.getAttribute("width");0==parseIntOr0(o)&&(o="300"),n.width=o,o=0!=parseIntOr0(i.style.height)?i.style.height:i.getAttribute("height"),0==parseIntOr0(o)&&(o="300"),n.height=o,n.hspace=i.getAttribute("hspace")?i.getAttribute("hspace"):"",n.vspace=i.getAttribute("vspace")?i.getAttribute("vspace"):"",n.margin_left=i.style.marginLeft,n.margin_right=i.style.marginRight,n.margin_top=i.style.marginTop,n.margin_bottom=i.style.marginBottom,n.scale=i.getAttribute("scale")?i.getAttribute("scale"):"",n.allowScriptAccess=i.getAttribute("allowScriptAccess")?i.getAttribute("allowScriptAccess"):"",n.quality=i.getAttribute("quality")?i.getAttribute("quality"):"",n.align=i.getAttribute("align")?i.getAttribute("align"):"",n.menu=i.getAttribute("menu")?i.getAttribute("menu"):!1,n.play=i.getAttribute("play")?i.getAttribute("play"):!1,n.loop=i.getAttribute("loop")?i.getAttribute("loop"):!1,n.allowFullScreen=i.getAttribute("allowFullScreen")?i.getAttribute("allowFullScreen"):!0,i.getAttribute("flashvars")&&(n.flashvars=i.getAttribute("flashvars")),i=getLinkMediaType(n.src),n.type=""==i?"flash":i,n.type2="flash"}else null!=s&&(t&&t.forceFullSreenAllow&&s.setAttribute("allowFullscreen","true"),n.attributes=s.attributes,n.src=s.getAttribute("src")?s.getAttribute("src"):"",n.id=s.getAttribute("id")?s.getAttribute("id"):"",n.name=s.getAttribute("name")?s.getAttribute("name"):"",n.title=s.getAttribute("title")?s.getAttribute("title"):"",o=0!=parseIntOr0(s.style.width)?s.style.width:s.getAttribute("width"),0==parseIntOr0(o)&&(o="300"),n.width=o,o=0!=parseIntOr0(s.style.height)?s.style.height:s.getAttribute("height"),0==parseIntOr0(o)&&(o="300"),n.height=o,n.align=s.getAttribute("align")?s.getAttribute("align"):"",n.scrolling=s.getAttribute("scrolling")?s.getAttribute("scrolling"):"no",s.getAttribute("frameBorder")&&("yes"==s.getAttribute("frameBorder").toLowerCase()||"1"==s.getAttribute("frameBorder")?n.frameBorder=!0:("no"==s.getAttribute("frameBorder")||s.getAttribute("frameBorder"),n.frameBorder=!1)),i=getLinkMediaType(n.src),n.type=""==i?"iframe":i,n.type2="iframe");return r.innerHTML="",n}function getLinkMediaType(e){var t="";return-1!=e.search("youtube.com/embed/")?t="link_media":-1!=e.search("videofarm.daum.net/")?t="link_media":-1!=e.search("naver.com/flash/")?t="link_media":-1!=e.search("channel.pandora.tv/")||-1!=e.search("flvr.pandora.tv/")?t="link_media":-1!=e.search("mgoon.com/Video")?t="link_media":-1!=e.search("dext5player/media_player")&&(t="iframe"),t}function showSetImageProperty(e){if(null==e){e=!1;if(DEXTTOP.DEXT5.browser.ie&&DEXT5_TOPMENU){var t=DEXTTOP.DEXTDOC.getElementById(DEXT5_TOPMENU._topmenu_id);t&&""==t.style.display&&(e=!0)}var n,r="";try{r=G_dext5plugIn.getDext5PluginVersion()}catch(i){}n=""==r||"3,6,0,23">r?G_dext5plugIn.showImageProperty("","","","","","","","","","","",""):G_dext5plugIn.showImagePropertyEx("","","","","","","","","","","","","","","","");if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",image,")){var s=document.createElement("div");s.innerHTML=n;for(var o=!1,u=s.getElementsByTagName("img"),a=u.length,a=a-1;0<=a;a--){var f=u[a];if(f.src&&0==f.src.toLowerCase().indexOf("file:/")){var o=!0,l=f;"A"==f.parentNode.tagName&&(l=f.parentNode),l.nextSibling&&3==l.nextSibling.nodeType&&l.parentNode.removeChild(l.nextSibling),l.parentNode.removeChild(l)}}o&&(n=s.innerHTML)}if(""!=n){dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),-1<n.toLowerCase().indexOf("<br")&&(n=n.replace(/<br.*?>/gim,""));if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod){var s=n.indexOf('src="')+5,o=s+n.substr(s).indexOf('"'),s=n.substring(s,o),c;try{c=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_dext5plugIn.getBase64ImageFromLocalImage(s)}catch(h){}if(c&&""!=c){c=c.replace(/\r\n/g,""),c=c.replace(/\n/g,""),c=c.replace(/\t/g,"");try{var p;p="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,c):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,c),null!=p&&void 0!=p&&(c=p)}catch(d){}}c&&""!=c&&(n=n.replace(s,c))}insertNodeLikePasteHtml(n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(v){}}else dialogCancel();e&&setTimeout(function(){DEXTTOP.focus(),setFocusToBody()},0)}else{var t=null,t=e.parentNode,m=e.getAttribute("src");(n=e.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")))&&0<n.length&&(m=n[0].replace("src=",""),m=m.replace(/\'/g,""),m=m.replace(/\"/g,""),m=m.replace(/\&amp;/g,"&")),n=m;var s=e.style.width,o=e.style.height,m=e.border,u=e.align,g=e.vspace,y=e.hspace,f=e.style.marginTop,l=e.style.marginRight,b=e.style.marginBottom,w=e.style.marginLeft,E=e.id,S=e.className,x=e.title,T=e.alt,N="",C="",k="";""!=s&&null!=s||0!=(null!=o&&""!=o&&-1<o.indexOf("%"))||(s=e.width),""!=o&&null!=o||0!=(null!=s&&""!=s&&-1<s.indexOf("%"))||(o=e.height);try{t&&"a"==t.tagName.toLowerCase()?(C=t.getAttribute("href"),N=t.title,k=t.target):t=null}catch(L){t=null}r="";try{r=G_dext5plugIn.getDext5PluginVersion()}catch(A){}""==r||"3,6,0,23">DEXTTOP.DEXT5.cabVersion?n=G_dext5plugIn.showImageProperty(n,s,o,m,u,g,y,x,T,N,C,k):(""==f.toString()&&(""==g.toString()?f="":f=g),""==b.toString()&&(""==g.toString()?b="":b=g),""==l.toString()&&(""==y.toString()?l="":l=y),""==w.toString()&&(""==y.toString()?w="":w=y),y=g=r=m="",m=e.style.borderStyle,""==m?e.getAttribute("border")&&""!=e.getAttribute("border")&&(m="solid",r="",g="#000000",y=e.getAttribute("border")):(g=0>e.style.borderColor.indexOf("rgb")&&0>e.style.borderColor.indexOf("#")?"":e.style.borderColor,""!=e.style.borderWidth&&(-1<e.style.borderWidth.indexOf("px")?y=e.style.borderWidth:r=e.style.borderWidth)),""==m&&(m="solid"),""==r&&(r="default"),""==g&&(g="#000000"),""!=g&&-1<g.indexOf("rgb")&&(g=DEXTTOP.DEXT5.util.rgb2hex(g)),""==y&&(y="0"),-1<y.indexOf("px")&&(y=DEXTTOP.DEXT5.util.parseIntOr0(y)),m=y+"^"+m+"^"+r+"^"+g,n=G_dext5plugIn.showImagePropertyEx(n,s,o,m,u,f,l,b,w,E,S,x,T,N,C,k));if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",image,")){s=document.createElement("div"),s.innerHTML=n,o=!1,u=s.getElementsByTagName("img"),a=u.length;for(--a;0<=a;a--)f=u[a],f.src&&0==f.src.toLowerCase().indexOf("file:/")&&(o=!0,l=f,"A"==f.parentNode.tagName&&(l=f.parentNode),l.parentNode.removeChild(l));o&&(n=s.innerHTML)}if(""!=n){setTimeout(function(){dialogCancel()},100);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&(s=n.indexOf('src="')+5,o=s+n.substr(s).indexOf('"'),s=n.substring(s,o),0==s.indexOf("file:/"))){try{c=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_dext5plugIn.getBase64ImageFromLocalImage(s)}catch(O){}if(c&&""!=c){c=c.replace(/\r\n/g,""),c=c.replace(/\n/g,""),c=c.replace(/\t/g,"");try{p="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,c):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,c),null!=p&&void 0!=p&&(c=p)}catch(M){}}c&&""!=c&&(n=n.replace(s,c))}p=getBorderAndCustomInfo(n),c=p.borderJson,n=p.imageText;try{var _=document.createElement("div");_.innerHTML=n;var D=_.getElementsByTagName("img")[0];p="",D.getAttribute("border")&&""!=D.getAttribute("border")&&(p=D.getAttribute("border"));for(var P=e.attributes.length,a=0;a<P;a++){var H=e.attributes[a];H.specified&&!D.getAttribute(H.name)&&0>",id,class,align,alt,title,".indexOf(H.name)&&D.setAttribute(H.name,H.value)}""==p&&""!=m&&""==c.borderColor&&""==c.borderKind&&""==c.borderStyle&&""==c.borderWidth?""!=e.style.border&&(D.style.border=e.style.border):setImageBorder(D,c),n=_.innerHTML}catch(B){}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),a=getFirstRange().range,t?a.selectNode(t):a.selectNode(e),a.deleteContents(),a.collapse(!0),a.pasteHtml(n),a.collapse(!1),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(j){}}else setTimeout(function(){dialogCancel()},100)}}function insertNodeLikePasteHtml(e){if(""!=e&&null!=e){dialogCancel();var t=getFirstRange().range;if(t){t.deleteContents();var n=getBorderAndCustomInfo(e),r=n.originalSizeCheck,i=n.borderJson;e=n.imageText,n=_iframeDoc.createElement("span"),n.innerHTML=e,e=e.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi"));var s=e.length;if(e&&0<e.length)for(var o=0;o<s;o++)e[o]=e[o].replace("src=",""),e[o]=e[o].replace(/\'/g,""),e[o]=e[o].replace(/\"/g,""),e[o]=e[o].replace(/\&amp;/g,"&");s=n.childNodes.length;for(o=0;o<s;o++){var u=n.childNodes[o];u.src=e[o],u=u.cloneNode(!0),u.src=e[o],r||pluginInsertImageAutoFit(u),u=setImageBorder(u,i),adjustSizeInContainer({nodes:u});try{t.insertNode(u),t.selectNode(u)}catch(a){t.pasteHtml(u.outerHTML)}t.collapse(!1)}setFocusToBody()}}}function getEditrFromEvent(e){var t=null;try{if(null!=e){var n=e.target?e.target:e.srcElement;if(n){e=null,e=9!=n.nodeType?n.ownerDocument:n;try{e=e.defaultView?e.defaultView:e.parentWindow,t=DEXTTOP.DEXT5.DEXTMULTIPLE[e.parent.frameElement.id],0==!!t&&(t=DEXTTOP.G_CURREDITOR)}catch(r){t=DEXTTOP.G_CURREDITOR}}else t=DEXTTOP.G_CURREDITOR}else t=DEXTTOP.G_CURREDITOR}catch(i){t=DEXTTOP.G_CURREDITOR}return t}function getEditorFromUnloadEvent(e){var t=null;try{if(null!=e){var n=e.target?e.target:e.srcElement;if(n)try{e="",n._dext_editor?e="dext_frame_"+n._dext_editor.ID:n.defaultView&&(e="dext_frame_"+n.defaultView.G_USE_EDITOR_ID),t=DEXTTOP.DEXT5.DEXTMULTIPLE[e]}catch(r){t=DEXTTOP.G_CURREDITOR}else t=DEXTTOP.G_CURREDITOR}else t=DEXTTOP.G_CURREDITOR}catch(i){t=DEXTTOP.G_CURREDITOR}return t}function setPasteImageFromClipboard(e,t){if(!(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,")||0==DEXTTOP.G_CURREDITOR.AccessClipboardForIEGecko&&DEXTTOP.DEXT5.browser.gecko))try{if(0==DEXTTOP.DEXT5.browser.ie||DEXTTOP.G_CURREDITOR.AccessClipboardForIEGecko){var n=e.clipboardData.items,r=n.length;0==r&&null!=DEXTTOP.G_CURREDITOR.clipImageBlob&&(r=1);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&n&&0<r&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount){for(var i=0,s=0;s<r;++s)(1==r&&DEXTTOP.G_CURREDITOR.clipImageBlob||"file"==n[s].kind&&-1!==n[s].type.indexOf("image/"))&&i++;if(0<i&&getBase64ImageCount()+i>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)){var o=dext5_lang.msg.max_base64file_count,o=o.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(o);return}}for(var u=0,a=0,s=0;s<r;++s)if(1==r&&DEXTTOP.G_CURREDITOR.clipImageBlob||"file"==n[s].kind&&-1!==n[s].type.indexOf("image/"))if(o=null,o=DEXTTOP.G_CURREDITOR.clipImageBlob?DEXTTOP.G_CURREDITOR.clipImageBlob:n[s].getAsFile(),-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector){var f=function(){return function(e,n,i){a++;if(0==i)u++;else{var s=new FileReader;s.onload=function(e){var n=e.target.result.split(",");2==n.length&&(checkPasteImage('<img src="'+e.target.result+'" />'),e=getExtFromImageDataSrc(n[0]),postBase64ImageToServer(n[1],e,void 0,void 0,t)),s=void 0},s.readAsDataURL(e)}a==r&&0<u&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},2)}}(),l=o.name.split(".").pop();D5FileDetector(o,l,f)}else{var c=new FileReader;c.onload=function(e){var n=e.target.result.split(",");2==n.length&&(checkPasteImage('<img src="'+e.target.result+'" />'),e=getExtFromImageDataSrc(n[0]),postBase64ImageToServer(n[1],e,void 0,void 0,t)),c=void 0},c.readAsDataURL(o)}}else if(11<=DEXTTOP.DEXT5.browser.ieVersion)for(var n=_iframeWin.clipboardData,i=n.files,h=i.length,s=0;s<h;s++){var p=i[s],d=URL.createObjectURL(p);e.msConvertURL(p,"base64",d),c=new FileReader,c.onload=function(e){e=e.target.result.split(",");if(2==e.length){var t=getExtFromImageDataSrc(e[0]);postBase64ImageToServer(e[1],t)}c=void 0},c.readAsDataURL(p)}}catch(v){}}function postBase64ImageToServer(e,t,n,r,i,s,o){if(G_dext5plugIn&&!n.getAttribute("raon_chart"))try{var u=G_dext5plugIn.getLocalImageFromBase64Image(e,t);if(0<u.length)if(void 0==n||null==n){var a=_iframeDoc.createElement("img");a.src=u,a.alt="";var f=getFirstRange().range;f.deleteContents(),f.collapse(!0),f.pasteHtml(a.outerHTML),f.collapse(!1)}else n=SetImageAutoFitSize(n,u)}catch(l){}else if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64)void 0==n||null==n?(a=_iframeDoc.createElement("img"),a.onload=function(e){if(a){0==!!i&&""==a.style.width&&a.width&&(i={width:0,height:0,checkOriginSize:!1},i.width=a.width,""==a.style.height&&a.height&&(i.height=a.height)),i&&0<i.width&&0<i.height&&(a=SetImageAutoFitSize(a,a.src,i)),adjustSizeInContainer({nodes:a}),e=a.outerHTML,a=null,a=void 0;var t=getFirstRange().range;t.deleteContents(),t.collapse(!0),t.pasteHtml(e),t.collapse(!1)}},a.src="data:image/"+t+";base64,"+e,a.alt=""):void 0!=t&&""!=t&&void 0!=e&&""!=e&&(n.src="data:image/"+t+";base64,"+e,""==n.style.width&&n.width&&(n.src+="?"+n.width,""==n.style.height&&n.height&&(n.src+="^"+n.height)),n=SetImageAutoFitSize(n,n.src,i),adjustSizeInContainer({nodes:n}));else{u="",u=null,"CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code&&(u="hello");var f=DEXTTOP.G_CURREDITOR._config.image_convert_width,c=DEXTTOP.G_CURREDITOR._config.image_convert_height;"1"==DEXTTOP.G_CURREDITOR._config.imageAutoConvert&&(c=f="");if("undefined"==typeof FormData||null==u&&""!=DEXTTOP.G_CURREDITOR._config.proxy_url&&"1"!=DEXTTOP.G_CURREDITOR._config.uploadImageFileObject){var h=document.createElement("form");h.method="post",h.target="upload_frame",h.enctype="multipart/form-data";var p='<input type="hidden" id="imagedata" name="imagedata" value="'+e+'" />';"0"!=DEXTTOP.G_CURREDITOR._config.security.encryptParam?(p+='<input type="hidden" id="pe" name="pe" value="'+DEXTTOP.G_CURREDITOR._config.security.encryptParam+'" />',p+='<input type="hidden" id="savefileext" name="savefileext" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(t)+'" />',p+='<input type="hidden" id="serverdomain" name="serverdomain" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.serverDomain)+'" />',p+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.toSavePathURL)+'" />',p+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)+'" />',p+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)+'" />',p+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.proxy_url)+'" />',p+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_format)+'" />',p+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_width)+'" />',p+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_height)+'" />',p+='<input type="hidden" id="uploadtype" name="uploadtype" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal("image")+'" />',p+='<input type="hidden" id="cd" name="cd" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal("1")+'" />'):(p=p+('<input type="hidden" id="savefileext" name="savefileext" value="'+t+'" />')+('<input type="hidden" id="serverdomain" name="serverdomain" value="'+DEXTTOP.G_CURREDITOR._config.serverDomain+'" />'),p+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.G_CURREDITOR._config.toSavePathURL+'" />',p+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFolderNameRule+'" />',p+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFileNameRule+'" />',p+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+DEXTTOP.G_CURREDITOR._config.proxy_url+'" />',p+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_format+'" />',p+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_width+'" />',p+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_height+'" />',p+='<input type="hidden" id="uploadtype" name="uploadtype" value="image" />',p+='<input type="hidden" id="cd" name="cd" value="1" />'),p+='<input type="hidden" id="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" name="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" value="'+DEXTTOP.G_CURREDITOR._config.userFieldValue+'" />',p+='<iframe id="upload_frame" name="upload_frame" frameborder="0" style="width:0px; height:0px;" title="DEXT5Editor Upload"></iframe>',h.innerHTML=p,document.body.appendChild(h),h.action=DEXTTOP.G_CURREDITOR._config.post_url,h.submit();var d=document.getElementById("upload_frame");if(window.postMessage){var v=function(e){try{var t=e.data.replace("*","?");_web_url=DEXTTOP.DEXT5.util.trim(t),document.body.removeChild(h);if(_web_url&&""!=_web_url)try{var i;i="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,_web_url):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,_web_url),null!=i&&void 0!=i&&(_web_url=i)}catch(s){}if("[FAIL]"==_web_url.substring(0,6))try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:_web_url,response:getXhrResponseData()}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:_web_url,response:getXhrResponseData()})}catch(o){}if(void 0==n||null==n){var u=_iframeDoc.createElement("img"),u=SetImageAutoFitSize(u,_web_url);adjustSizeInContainer({nodes:u});var a=getFirstRange().range;a.collapse(!0),a.insertNode(u),a.selectNode(u),a.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a)}else{var f=_iframeDoc.getElementsByTagName("img");if(f){var l=f.length;for(e=0;e<l;e++)if(f[e].src==n.src){var c=_iframeDoc.createElement("img");try{c.attributes=f[e].attributes}catch(p){c.outerHTML=f[e].outerHTML}c.src=_web_url,f[e].parentNode.replaceChild(c,f[e]),n=c}}n=SetImageAutoFitSize(n,_web_url),adjustSizeInContainer({nodes:n}),r&&recursionBase64ImageToServer()}}catch(d){}DEXTTOP.DEXT5.util.removeEvent(window,"message",v)};DEXTTOP.DEXT5.util.addEvent(window,"message",v)}DEXTTOP.DEXT5.util.addEvent(d,"load",function(){d.contentWindow.postMessage("check","*")},!0)}else{var u=new FormData,m=DEXTTOP.G_CURREDITOR._config.proxy_url;"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject&&(m=""),"0"!=DEXTTOP.G_CURREDITOR._config.security.encryptParam?(u.append("savefileext",DEXTTOP.DEXT5.util.makeEncryptParamFinal(t)),u.append("serverdomain",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.serverDomain)),u.append("tosavepathurl",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.toSavePathURL)),u.append("savafoldernamerule",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)),u.append("savafilenamerule",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)),u.append("proxy_url",DEXTTOP.DEXT5.util.makeEncryptParamFinal(m)),u.append("image_convert_format",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_format)),u.append("image_convert_width",DEXTTOP.DEXT5.util.makeEncryptParamFinal(f)),u.append("image_convert_height",DEXTTOP.DEXT5.util.makeEncryptParamFinal(c)),u.append("originalfilename",DEXTTOP.DEXT5.util.makeEncryptParamFinal(s?s.name:"")),u.append("uploadtype",DEXTTOP.DEXT5.util.makeEncryptParamFinal("image")),u.append("pe",DEXTTOP.G_CURREDITOR._config.security.encryptParam),u.append("cd",DEXTTOP.DEXT5.util.makeEncryptParamFinal("0"))):(u.append("savefileext",t),u.append("serverdomain",DEXTTOP.G_CURREDITOR._config.serverDomain),u.append("tosavepathurl",DEXTTOP.G_CURREDITOR._config.toSavePathURL),u.append("savafoldernamerule",DEXTTOP.G_CURREDITOR._config.saveFolderNameRule),u.append("savafilenamerule",DEXTTOP.G_CURREDITOR._config.saveFileNameRule),u.append("proxy_url",m),u.append("image_convert_format",DEXTTOP.G_CURREDITOR._config.image_convert_format),u.append("image_convert_width",f),u.append("image_convert_height",c),u.append("originalfilename",s?s.name:""),u.append("uploadtype","image"),u.append("cd","0")),""!=DEXTTOP.G_CURREDITOR._config.userFieldID&&u.append(DEXTTOP.G_CURREDITOR._config.userFieldID,DEXTTOP.G_CURREDITOR._config.userFieldValue),f=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,c=f.length;for(m=0;m<c;m++)formValue=encodeURIComponent(f[m].form_value),u.append(f[m].form_name,formValue);"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject?0==!!s?(s=e,0>s.indexOf("data:image/")&&(s=t,"jpg"==s&&(s="jpeg"),s="data:image/"+t+";base64,"+e),e=DEXTTOP.DEXT5.util.dataURItoBlob(s),u.append(DEXTTOP.G_CURREDITOR._config.fileFieldID,e,"image."+t)):u.append(DEXTTOP.G_CURREDITOR._config.fileFieldID,s):u.append("imagedata",e),u=DEXTTOP.DEXT5.ajax.postMultiPart(DEXTTOP.G_CURREDITOR._config.post_url,u,!0),t=null,"number"==typeof u.status&&(200!=u.status&&(t=getXhrResponseData(u)),u=u.responseText);if(u&&""!=u){if(o&&(o=[],"0"!=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter&&(o=u.split(DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter),1<o.length&&(u=o[0])),e=u.split("?"),2==e.length)){u=e[0],e=e[1].split("^");if(1==e.length)u+="?0^0";else if(2==e.length)u+="?"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.width)+"^"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.height);else if(3==e.length)if(-1<e[1].indexOf("|"))var g=e[1].indexOf("|"),g=e[1].substring(g,e[1].length)+"^"+e[2],u=u+("?"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.width)+"^"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.height)+g);else u+="?"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.width)+"^"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.height)+"^"+e[2];else if(3<e.length&&(s=0,f=!1,-1<e[s].indexOf("|")&&(g=e[s].indexOf("|"),f=!0),0==f&&(s=1,-1<e[s].indexOf("|")&&(g=e[s].indexOf("|"),f=!0)),f)){0>g&&(g=0),g=e[s].substring(g,e[s].length),f=e.length;for(s+=1;s<f;s++)g+="^"+e[s];u+="?"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.width)+"^"+DEXTTOP.DEXT5.util.parseIntOr0(n.style.height)+g}if(1<o.length)for(g=1;g<o.length;g++)u+=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter+o[g]}try{p="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,u):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,u),null!=p&&void 0!=p&&(u=p)}catch(y){}}if("[FAIL]"==u.substring(0,6)||t)try{(p={type:"imageUpload",message:u},p.response=t?t:getXhrResponseData(),"function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError)?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,p):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,p)}catch(b){}if(void 0==n||null==n){a=_iframeDoc.createElement("img"),a=SetImageAutoFitSize(a,u,i),adjustSizeInContainer({nodes:a}),p=a.outerHTML;try{if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){g=p;try{g="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?DEXTTOP.G_CURREDITOR._config.event.beforePaste(p):DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(p)}catch(w){g=p}if(g)p=g;else if(0==g||""==g)return}}catch(E){}pasteWordCount(p)&&(p=externalPageBreakDataRaplaceInEditor(p),DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP
.DEXT5.browser.gecko?(_iframeDoc.execCommand("inserthtml",!1,p),""!=p&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)):pasteHtmlAtCaretHuge(p,!0),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),f=getFirstRange().range)&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(f))}else n=SetImageAutoFitSize(n,u),adjustSizeInContainer({nodes:n}),r&&recursionBase64ImageToServer()}}}function SetImageAutoFitSize(e,t,n){var r=0,i=0,s="";null!=t&&void 0!=t&&(t=t.replace(/\r\n/g,""),t=t.replace(/\n/g,""),t=t.replace(/\t/g,"")),s=t;if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code){var o=s.split("|");e.setAttribute("src",o[2]),e.setAttribute("filemimeinfo",s),insertImageSrc(DEXTTOP.G_CURREDITOR,o[2])}else{o=[],"0"!=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter&&(o=t.split(DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter),1<o.length&&(t=o[0])),t=t.split("?"),2==t.length&&(s=t[0],t=t[1].split("^"),2==t.length?(r=t[0],i=t[1]):3==t.length&&(r=t[0],i=t[1],s+="?"+t[2]));var u=!1;n&&0<n.width&&0<n.height&&(r=n.width,i=n.height,u=n.checkOriginSize),t=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth;var a=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight;n||(""!=t?DEXTTOP.DEXT5.util.parseIntOr0(r)>DEXTTOP.DEXT5.util.parseIntOr0(t)&&(r=DEXTTOP.DEXT5.util.parseIntOr0(i,10)*DEXTTOP.DEXT5.util.parseIntOr0(t,10)/DEXTTOP.DEXT5.util.parseIntOr0(r,10),i=isNaN(r)?i:Math.round(r),r=DEXTTOP.DEXT5.util.parseIntOr0(t),u=!0):""!=a&&DEXTTOP.DEXT5.util.parseIntOr0(i)>DEXTTOP.DEXT5.util.parseIntOr0(a)&&(i=DEXTTOP.DEXT5.util.parseIntOr0(r,10)*DEXTTOP.DEXT5.util.parseIntOr0(a,10)/DEXTTOP.DEXT5.util.parseIntOr0(i,10),r=isNaN(i)?r:Math.round(i),i=DEXTTOP.DEXT5.util.parseIntOr0(a),u=!0));if(0==u)if(a=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"img"),"1"==DEXTTOP.G_CURREDITOR._config.imageAutoConvert){var a=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.image_convert_width),u=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.image_convert_height),f=!1,l=!1;n=i,t=DEXTTOP.DEXT5.util.parseIntOr0(r),n=DEXTTOP.DEXT5.util.parseIntOr0(n);if(0!=a&&0==u)t>a&&(f=!0);else if(0==a&&0!=u)n>u&&(l=!0);else{var c=1*a/t,h=1*u/n;c<h?1>c&&(f=!0):1>h&&(l=!0)}f?(t=a/t,r=a,i=DEXTTOP.DEXT5.util.parseIntOr0(t*n)):l&&(i=u,r=DEXTTOP.DEXT5.util.parseIntOr0(u/n*t))}else"1"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&r>a?(t=a/r,r=a,i=parseInt(t*i)):"2"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&(t=r,n=i,t>a||n>DEXTTOP.G_CURREDITOR._defaultHeight)&&(r=DEXTTOP.G_CURREDITOR._defaultHeight,i=r/a,u=n/t,u>i?n>r?(i=r,r=Math.round(t*i/n)):(r=t,i=n):u<i?t>a?(r=a,i=Math.round(n*r/t)):(r=t,i=n):(r=t,i=n));e.src=s,0<r&&0<i&&(e.style.width=r+"px",e.style.height=i+"px",e.removeAttribute("width"),e.removeAttribute("height")),"0"==DEXTTOP.G_CURREDITOR._config.allowImgSize&&(e.style.width="",e.style.height="");if(o&&1<o.length)for(r=o.length,i=1;i<r;i++)n=o[i].split("^"),2==n.length&&e.setAttribute(n[0],n[1]);insertImageSrc(DEXTTOP.G_CURREDITOR,s)}return e}function SetCorrectOfficeHtmlForDOM(e){var t=e;try{var n=document.createElement("div");n.innerHTML=e;for(var r=n.getElementsByTagName("table"),i=r.length,s=0;s<i;s++){var o=0,u=0;null!=r[s].getAttribute("width")&&""!=r[s].getAttribute("width")&&0>r[s].getAttribute("width").indexOf("%")&&(o=parseInt(r[s].getAttribute("width"),10),r[s].removeAttribute("width")),null!=r[s].getAttribute("height")&&""!=r[s].getAttribute("height")&&(u=parseInt(r[s].getAttribute("height"),10),r[s].removeAttribute("height")),""==r[s].style.width&&0!=o&&(r[s].style.width=o+"px"),""==r[s].style.height&&0!=u&&(r[s].style.height=u+"px")}if("HWP"==G_wordProcessorType){for(var a=n.getElementsByTagName("span"),f=a.length,s=0;s<f;s++){var l=a[s];if("#ffffff"==colorToHex(l.style.backgroundColor)||"#ffffff"==l.style.backgroundColor)l.style.backgroundColor=""}removeDummyDivInHwp(n)}else if("XLS"==G_wordProcessorType)for(var c=n.getElementsByTagName("table"),s=c.length-1;1<=s;s--){var h=c[s],p=h.parentNode;if(p&&"SPAN"==p.tagName){var d=h.getElementsByTagName("td");if(1==d.length){var r="",v=p.outerHTML.indexOf(">"),r=p.outerHTML.substring(0,v+1);if(-1<r.indexOf("mso-ignore:vglayout2")){var m=h.parentNode.parentNode,g=d[0];if(m&&"TD"==m.tagName){for(var r=["borderBottom","borderLeft","borderTop","borderRight","backgroundColor"],y=r.length,i=0;i<y;i++)m.style[r[i]]=g.style[r[i]],g.style[r[i]]="";(""==g.innerHTML||/^\s$/.test(g.innerHTML))&&c[s].parentNode.removeChild(c[s])}}}}}e=n.innerHTML}catch(b){e=t}if("undefined"!=typeof n)try{n.innerHTML="",delete null}catch(w){}return e}function GetMsPptHtml(e){var t=e,t=e.indexOf("<!--StartFragment-->"),n=e.indexOf("<!--EndFragment-->");if(-1<t&&-1<n&&(t=e.substr(t+20),n=t.indexOf("<!--EndFragment-->"),-1<n)){for(;;){if(e=t.indexOf("<!--EndFragment-->",n+18),!(-1<e))break;n=e}e=t=t.substring(0,n)}return e}function ReplaceAll(e,t,n){return e&&""!=e&&(e=e.split(t).join(n)),e}function getExtFromImageDataSrc(e){var t="";return e=e.replace("data:","").split(";"),0<e.length&&(e=e[0].split("/"),2==e.length&&(t=e[1])),t}function htmlAsciiToChar(e){return e=e.replace(/&#39;/g,"'")}function xssReplaceScript(e,t){var n="",r=t;try{var n=t=removeGarbageTag(t),i=DEXTTOP.G_CURREDITOR._config.xss_use,s=DEXTTOP.G_CURREDITOR._config.xss_remove_tags,o=DEXTTOP.G_CURREDITOR._config.xss_remove_events;if("1"!=i&&""==s&&""==o||null==e&&""==t)return n;if(e){var u=getAllNodesInBody(e,!0);DEXTTOP.DEXT5.util.removeTags(e,s),DEXTTOP.DEXT5.util.removeEvents(e,o,u);if("1"==i)for(var a=","+DEXTTOP.G_CURREDITOR._config.xss_check_attribute.join(",")+",",f=u.length,l=0;l<f;l++){if(-1<a.indexOf(",src,")){var c;try{c=u[l].src}catch(h){}if(void 0!=c&&xssCheckPattern(c)){var p=!0,d=DEXTTOP.G_CURREDITOR._config.xss_allow_url.length;if(0<d){var v=u[l].src.toLowerCase(),m=v.indexOf("?t=");-1<m&&(v=v.substring(0,m));for(var g=0;g<d;g++)if(DEXTTOP.G_CURREDITOR._config.xss_allow_url[g].toLowerCase()==v){p=!1;break}}1==p&&(u[l].src="")}}-1<a.indexOf(",background,")&&(u[l].background&&xssCheckPattern(u[l].background)&&(u[l].background=""),u[l].style.backgroundImage&&xssCheckPattern(u[l].style.backgroundImage)&&(u[l].style.backgroundImage="")),-1<a.indexOf(",url,")&&u[l].url&&xssCheckPattern(u[l].url)&&(u[l].url=""),-1<a.indexOf(",href,")&&u[l].href&&xssCheckPattern(u[l].href)&&(u[l].href="")}}u="","1"==i&&(u="script,vbscript"),a=!1,void 0==t||""==t?e&&(i=!1,1==RegExp("<[^>]+\\sdext5customdata\\b[^>]*>","gim").test(e.innerHTML)&&(i=!0,ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData()),t=e==_iframeDoc.body?e.innerHTML:e.body.innerHTML,t=DEXTTOP.DEXT5.util.replaceForXSS(t,u,s,o,a),""!=t?DEXTTOP.DEXT5.setBodyValue(t,DEXTTOP.G_CURREDITOR._config.editor_id,!0,null,i):i&&ReplaceRealObjectToImage(!1)):("1"==i&&(a=!0),t=DEXTTOP.DEXT5.util.replaceForXSS(t,u,s,o,a),""!=t&&(n=t))}catch(y){n=r}return n}function removeGarbageTag(e){var t=e;if("string"==typeof e)try{var n=RegExp("<\\?xml[^>]*/>","gim");1==n.test(t)&&(t=t.replace(n,"")),n=RegExp("</ustyle[^>]*>","gim"),1==n.test(t)&&(t=t.replace(n,"")),n=RegExp("<ustyle[^>]*>","gim"),1==n.test(t)&&(t=t.replace(n,""))}catch(r){t=e}return t}function xssCheckPattern(e){return-1<e.indexOf("javascript")||-1<e.indexOf("vbscript")||-1<e.indexOf(".js?")||e.lastIndexOf(".js")+3==e.length?!0:!1}function checkCellBRValue(){var e=!1;return"<p><br /></p>"==getCellDefValue()&&(e=!0),e}function checkCellBRValue2(e){var t=!1;return e=e.toLowerCase(),e=ReplaceAll(e," ",""),e=ReplaceAll(e,"<br>","<br />"),e=ReplaceAll(e,"<br/>","<br />"),"<p><br /></p>"==e&&(t=!0),t}function checkCellDefValue(e){var t=!1,n=getCellDefValue();return e=e.toLowerCase(),DEXTTOP.DEXT5.browser.ie&&(e=e.replace(RegExp("<\\/p>\\n$","gi"),"</p>")),e=ReplaceAll(e," ",""),e=ReplaceAll(e,"<br>","<br />"),e=ReplaceAll(e,"<br/>","<br />"),n==e&&(t=!0),t}function getCellDefValue(){var e=10;return"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&DEXTTOP.DEXT5.browser.ie&&"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_typing_bug_in_table&&(e=12),DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.ieVersion<=e?"<p>&nbsp;</p>":"<p><br /></p>"}function setCellDefValue(e){DEXTTOP.DEXT5.browser.ie&&e&&(""==e.innerHTML||"<p></p>"==e.innerHTML)&&(e.innerHTML=getCellDefValue())}function setTableAllCellDefValue(e){if(DEXTTOP.DEXT5.browser.ie){var t=GetParentbyTagName(e,"table");if(t){var n=e.cellIndex,r=GetParentbyTagName(e,"tr").cells;e=[];for(var i=t.rows.length,s=0;s<i;s++)t.rows[s]&&t.rows[s].cells[n]&&e.push(t.rows[s].cells[n]);t=r.length;for(s=0;s<t;s++)setCellDefValue2(r[s]);t=e.length;for(s=0;s<t;s++)setCellDefValue2(e[s])}}}function setCellDefValue2(e){RegExp("<p([^>?+]*)></p>","gi").test(e.innerHTML);var t=ReplaceAll(e.innerHTML,RegExp.$1,"");if(""!=RegExp.$1&&"<p></p>"==t)-1<getCellDefValue().indexOf("&nbsp;")?e.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":e.innerHTML="<p "+RegExp.$1+"><br /></p>";else if(""==e.innerHTML||"<p></p>"==e.innerHTML)e.innerHTML=getCellDefValue();"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(RegExp("<p([^>?+]*)><br /></p>","gi").test(t),t=ReplaceAll(e.innerHTML,RegExp.$1,""),checkCellBRValue2(t)&&(""!=RegExp.$1?-1<getCellDefValue().indexOf("&nbsp;")?e.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":e.innerHTML="<p "+RegExp.$1+"><br /></p>":e.innerHTML=getCellDefValue()))}function createTableCellDefValue(e){if(e&&DEXTTOP.DEXT5.browser.ie){var t=GetParentbyTagName(e,"table");if(t)for(var n=t.rows.length,r=0;r<n;r++)for(var i=t.rows[r],s=i.cells.length,o=0;o<s;o++){var u=i.cells[o];u!=e&&""==u.innerHTML&&(u.innerHTML=getCellDefValue())}3==e.childNodes[0].nodeType?e.innerHTML="":""==e.innerHTML&&(e.innerHTML=getCellDefValue())}return""}function removeCellDefValue(e,t){var n="";if(e)if(1==t)var r=n=e.innerHTML,n=n.replace(/<p *([^>?+])*>(\s+)*(&nbsp;+)*(\s+)*<\/p>/i,""),r=r.replace(/<p *([^>?+])*>(<br *\/*>+)*<\/p>/i,""),n=1==checkCellDefValue(e.innerHTML)||""==e.innerHTML||""==n||""==r?"":e.innerHTML;else{var i=GetParentbyTagName(e,"table");if(i)for(var s=i.rows.length,r=0;r<s;r++)for(var o=i.rows[r],u=o.cells.length,a=0;a<u;a++){var f=o.cells[a],l=RegExp("<p([^>?+]*)></p>","gi");l.test(f.innerHTML),l=ReplaceAll(f.innerHTML,RegExp.$1,"");if(f!=e&&("<p></p>"==l||""==l))if(""!=RegExp.$1)-1<getCellDefValue().indexOf("&nbsp;")?f.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":f.innerHTML="<p "+RegExp.$1+"><br /></p>";else{var c;"0"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&(c=getClientRect(f),c=c.bottom-c.top),f.innerHTML=getCellDefValue(),"0"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&(l=getClientRect(f),l=l.bottom-l.top,l>c&&(f.innerHTML=""))}}if(0<e.childNodes.length)for(i=e.childNodes.length,r=0;r<i&&1!=e.childNodes[r].nodeType;r++);200>e.innerHTML.length&&(l=RegExp("<p([^>?+]*)>&nbsp;</p>","gi"),l.test(e.innerHTML),l=ReplaceAll(e.innerHTML,RegExp.$1,""),1==checkCellDefValue(l)?(""!=RegExp.$1?e.innerHTML="<p "+RegExp.$1+"></p>":0==checkCellBRValue()&&(e.innerHTML="<p></p>"),"view"!=DEXTTOP.G_CURREDITOR._config.mode&&moveCursorToTag(e.childNodes[0],!0),n=!0):n=!1)}return n}function setShiftTabkeyAction(){try{var e=null,t=getFirstRange(),n=t.range,r=t.sel;n&&n.startContainer&&(e=getMyElementNode(n.startContainer));if(e){var i=GetTDTHCell(e);if(null==i&&"tr"==e.tagName.toLowerCase()){var s=e.cells.length;0<s&&(i=e.cells[s-1])}var t=!1,o=GetParentbyTagName(e,"li");if(o)if(i){for(var u=i.getElementsByTagName("li"),a=u.length,f=0;f<a;f++)if(o==u[f]){t=!0;break}}else t=!0;var l=e.tagName.toLowerCase();if(-1<",li,ul,ol,".indexOf(","+l+",")||t)if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode)if(0==n.toString().length){var c=n.startContainer;3==c.nodeType&&(c=c.parentNode);if("OL"==c.tagName||"UL"==c.tagName)c=c.getElementsByTagName("li")[0];var c=GetParentbyTagName(c,"li"),h=createNodeForCaret(1)[0];n.collapse(!0),n.insertNode(h),moveLiNode(c,0),n.setStartBefore(h),n.setEndBefore(h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n),h.parentNode.removeChild(h),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else{var h=createNodeForCaret(2),p=h[0],d=h[1],v=!0,m=n.cloneRange();try{n.collapse(!1),n.insertNode(d),r.removeAllRanges(),r.addRange(m),n=getFirstRange().range,n.collapse(!0);for(n.insertNode(p);;){var g=d.previousSibling;if(!g||"LI"!=g.tagName&&"OL"!=g.tagName&&"UL"!=g.tagName)break;g.appendChild(d)}n.setStartBefore(p),n.setEndBefore(d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n)}catch(y){removeNodeForCaret(),v=!1}if(0==v)try{v=!0,h=createNodeForCaret(2),p=h[0],d=h[1];try{n.setStart(n.endContainer,n.endOffset),n.setEnd(n.endContainer,n.endOffset)}catch(b){3==n.endContainer.nodeType&&(n.setStart(n.endContainer,n.endContainer.length),n.setEnd(n.endContainer,n.endContainer.length))}n.insertNode(d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(m),n=getFirstRange().range;try{n.setStart(n.startContainer,n.startOffset),n.setEnd(n.startContainer,n.startOffset)}catch(w){3==n.startContainer.nodeType&&(n.setStart(n.startContainer,0),n.setEnd(n.startContainer,0))}n.insertNode(p),(g=d.previousSibling)&&"LI"==g.tagName&&g.appendChild(d),n.setStartBefore(p),n.setEndBefore(d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n)}catch(E){removeNodeForCaret(),v=!1}if(v){n=getFirstRange().range,c=n.startContainer,3==c.nodeType&&(c=c.parentNode);var S=n.endContainer;3==S.nodeType&&(S=S.parentNode),c=GetParentbyTagName(c,"li"),S=GetParentbyTagName(S,"li");if(c&&S){if(c==S)moveLiNode(c,0);else{v=[];if(c.parentNode==S.parentNode){v.push(c);for(var x=c.nextSibling;x!=S;)v.push(x),x=x.nextSibling;v.push(S)}for(var T=v.length,f=0;f<T;f++)moveLiNode(v[f],0)}n.setStartBefore(p),n.setEndAfter(d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n),removeNodeForCaret(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else removeNodeForCaret()}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(m)}else{for(var N=getNodesInRange(n),v=[],C=N.length,f=0;f<C;f++)"1"==N[f].nodeType&&"li"==N[f].tagName.toLowerCase()&&v.push(N[f]);for(var T=v.length,k=v[0],L=v[T-1],r=!0,f=0;f<T;f++){var A=v[f],O=A.parentNode,M=A.nextSibling,_=A.previousSibling,D=_&&_.tagName?_.tagName.toLowerCase():"",P=M&&M.tagName?M.tagName.toLowerCase():"";if(!(0>",li,ul,ol,".indexOf(","+O.parentNode.tagName.toLowerCase()+","))){if(M&&_&&(-1<",ul,ol,".indexOf(","+D+",")||-1<",ul,ol,".indexOf(","+P+","))||!M&&"li"==D||!_&&"li"==P||"li"==D&&"li"==P||!M&&!_){for(var H=document.createElement(A.parentNode.tagName);A.previousSibling;)H.childNodes?H.insertBefore(A.previousSibling,H.firstChild):H.appendChild(A.previousSibling);for(var B=document.createElement(A.parentNode.tagName);A.nextSibling;)B.appendChild(A.nextSibling);for(var j=O.attributes,F=j.length,c=0;c<F;c++){var I=j[c];I.specified&&("style"==I.name.toLowerCase()?(H.style.cssText=O.style.cssText,B.style.cssText=O.style.cssText):(H.setAttribute(I.name,I.value),B.setAttribute(I.name,I.value)))}O.parentNode.insertBefore(B,O),B.parentNode.insertBefore(H,B),B.parentNode.insertBefore(A,B),0==B.childNodes.length&&B.parentNode.removeChild(B),0==H.childNodes.length&&H.parentNode.removeChild(H)}else!_&&-1<",ul,ol,".indexOf(","+O.parentNode.tagName.toLowerCase()+",")?O.parentNode.insertBefore(A,O):!M&&-1<",ul,ol,".indexOf(","+O.parentNode.tagName.toLowerCase()+",")&&(O.nextSibling?O.parentNode.insertBefore(A,O.nextSibling):O.parentNode.appendChild(A));1==T&&""==A.innerText&&(r=!1,doSetCaretPosition(A,0)),0==O.childNodes.length&&O.parentNode.removeChild(O)}}r&&(n.setStartBefore(k.firstChild),n.setEndAfter(L.lastChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n)),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else if(i&&"1"!=DEXTTOP.G_CURREDITOR._config.disableTabletap){var q=GetParentbyTagName(i,"tr");if(q){var R=i.cellIndex,U=q.rowIndex;if(0<R){var z=q.cells[R-1];if(z){z.focus(),removeCellDefValue(z,!1);var W=getFirstChildNodeForCaret(z);doSetCaretPosition(W,0)}}else{var X=GetParentbyTagName(q,"table");if(X&&(U=q.rowIndex,0<U)){var V=X.rows[U-1];V&&(z=V.cells[V.cells.length-1])&&(z.focus(),removeCellDefValue(z,!1),W=getFirstChildNodeForCaret(z),doSetCaretPosition(W,0))}}}}}}catch($){}}function setTabkeyAction(){try{var e=null,t=getFirstRange().range;t&&t.startContainer&&(e=getMyElementNode(t.startContainer));if(e){var n=GetTDTHCell(e);if(null==n&&"tr"==e.tagName.toLowerCase()){var r=e.cells.length;0<r&&(n=e.cells[r-1])}var r=!1,i=GetParentbyTagName(e,"li");if(i)if(n){for(var s=n.getElementsByTagName("li"),o=s.length,u=0;u<o;u++)if(i==s[u]){r=!0;break}}else r=!0;var a=e.tagName.toLowerCase();if(-1<",li,ul,ol,".indexOf(","+a+",")||r)if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode)if(0==t.toString().length){var f=t.startContainer;3==f.nodeType&&(f=f.parentNode);if("OL"==f.tagName||"UL"==f.tagName)f=f.getElementsByTagName("li")[0];var f=GetParentbyTagName(f,"li"),l=createNodeForCaret(1)[0];t.collapse(!0),t.insertNode(l),canMoveLiNode(f,1)&&moveLiNode(f,1),t.setStartBefore(l),t.setEndBefore(l),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t),l.parentNode.removeChild(l),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else{var l=createNodeForCaret(2),c=l[0],h=l[1],p=!0,d=t.cloneRange();try{t.collapse(!1),t.insertNode(h),sel.removeAllRanges(),sel.addRange(d),t=getFirstRange().range,t.collapse(!0),t.insertNode(c);var v=h.previousSibling;v&&"LI"==v.tagName&&v.appendChild(h),t.setStartBefore(c),t.setEndBefore(h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)}catch(m){removeNodeForCaret(),p=!1}if(0==p)try{p=!0,l=createNodeForCaret(2),c=l[0],h=l[1];try{t.setStart(t.endContainer,t.endOffset),t.setEnd(t.endContainer,t.endOffset)}catch(g){3==t.endContainer.nodeType&&(t.setStart(t.endContainer,t.endContainer.length),t.setEnd(t.endContainer,t.endContainer.length))}t.insertNode(h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d),t=getFirstRange().range;try{t.setStart(t.startContainer,t.startOffset),t.setEnd(t.startContainer,t.startOffset)}catch(y){3==t.startContainer.nodeType&&(t.setStart(t.startContainer,0),t.setEnd(t.startContainer,0))}t.insertNode(c),(v=h.previousSibling)&&"LI"==v.tagName&&v.appendChild(h),t.setStartBefore(c),t.setEndBefore(h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)}catch(b){removeNodeForCaret(),p=!1}if(p){t=getFirstRange().range,f=t.startContainer,3==f.nodeType&&(f=f.parentNode);var w=t.endContainer;3==w.nodeType&&(w=w.parentNode),f=GetParentbyTagName(f,"li"),w=GetParentbyTagName(w,"li");if(f&&w){if(f==w)canMoveLiNode(f,1)&&moveLiNode(f,1);else{p=[];if(f.parentNode==w.parentNode&&canMoveLiNode(f,1)){p.push(f);for(var E=f.nextSibling;E!=w;)p.push(E),E=E.nextSibling;p.push(w)}for(var S=p.length,u=0;u<S;u++)moveLiNode(p[u],1)}t.setStartBefore(c),t.setEndAfter(h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t),removeNodeForCaret(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else removeNodeForCaret()}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d)}else{for(var x=getNodesInRange(t),p=[],T=x.length,u=0;u<T;u++)"1"==x[u].nodeType&&"li"==x[u].tagName.toLowerCase()&&p.push(x[u]);for(var S=p.length,N,C,f=!0,u=0;u<S;u++){var k,L=p[u],A=L.previousSibling,O=L.nextSibling,M=A&&A.tagName?A.tagName.toLowerCase():"",_=O&&O.tagName?O.tagName.toLowerCase():"";if(!O&&"li"==M||!A&&"li"==_||"li"==M&&"li"==_||!O&&!A){var D=L.parentNode.style.listStyleType.toLowerCase(),P=DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[D]?DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[D]:"";""==P&&(P=DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[D]?DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[D]:"upper-alpha");var H=document.createElement(L.parentNode.tagName);H.style.listStyleType=P,H.innerHTML=L.outerHTML,L.parentNode.replaceChild(H,L),k=H.firstChild}else A&&-1<",ul,ol,".indexOf(","+M+",")?(A.appendChild(L),k=A.lastChild):O&&-1<",ul,ol,".indexOf(","+_+",")&&(O.insertBefore(L,O.firstChild),k=O.firstChild);0==u&&(N=k);if(u==S-1){C=k;var B=C.parentNode,j=B.nextSibling;if(j&&j.tagName&&j.tagName==B.tagName){for(;j.childNodes[0];)B.appendChild(j.childNodes[0]);j.parentNode.removeChild(j)}}1==S&&""==k.innerText&&(f=!1,doSetCaretPosition(k,0))}f&&(t.setStartBefore(N.firstChild),t.setEndAfter(C.lastChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else if(n&&"1"!=DEXTTOP.G_CURREDITOR._config.disableTabletap){var F=GetParentbyTagName(n,"tr");if(F){var I=n.cellIndex,q=F.rowIndex;if(F.cells.length>I+1){var R=F.cells[I+1];if(R){R.focus(),removeCellDefValue(R,!1);var U=getFirstChildNodeForCaret(R);doSetCaretPosition(U,0)}}else{var z=GetParentbyTagName(F,"table");if(z&&(q=F.rowIndex,z.rows.length>q+1)){var W=z.rows[q+1];W&&(R=W.cells[0])&&(R.focus(),removeCellDefValue(R,!1),U=getFirstChildNodeForCaret(R),doSetCaretPosition(U,0))}}}}else 0==GetTableSelectionCells().length&&(pasteHtmlAtCaretMini(DEXTTOP.G_CURREDITOR._config.tabSpace),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}}catch(X){}}function setTableArrowKeyDownAction(e){G_CURSOR_BEFORE_INTABLE=!1,G_BEFORE_INTABLE=null,e="which"in e?e.which:e.keyCode;var t=getFirstRange().range;try{var n=null;t&&(n=getMyElementNode(t.startContainer));if(n){var r=GetTDTHCell(n);if(null==r&&"tr"==n.tagName.toLowerCase()){var i=n.cells.length;0<i&&(r=n.cells[i-1])}if(r){G_CURSOR_BEFORE_INTABLE=!0,G_BEFORE_INTABLE=GetParentbyTagName(r,"table");var s=GetParentbyTagName(r,"tr");if(s){var o=s.cells[r.cellIndex],u=getTopOrBottomBoundNextCell(r,e);if(null!=u.nextCell){var a=GetParentbyTagName(s,"table");if(a){var f=a.rows[u.rowIndex];if(f){var l=f.cells[u.cellIndex];l&&200>l.innerHTML.length&&(""==ReplaceAll(l.innerHTML," ","")||1==checkCellDefValue(l.innerHTML))&&0==checkCellBRValue()&&"1"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(l.innerHTML="<p></p>")}else setCellDefValue(o)}}else setCellDefValue(o)}}}}catch(c){}}function setTableArrowKeyUpAction(e){e="which"in e?e.which:e.keyCode;var t=getFirstRange().range;try{var n=null;t&&(n=getMyElementNode(t.startContainer));if(n){var r=GetTDTHCell(n);if(null==r&&"tr"==n.tagName.toLowerCase()){var i=n.cells.length;0<i&&(r=n.cells[i-1])}if(r){var s=GetParentbyTagName(r,"tr");if(s){var o=s.cells[r.cellIndex];"1"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&setTableAllCellDefValue(o);if(200>o.innerHTML.length){RegExp("<p([^>?+]*)>&nbsp;</p>","gi").test(o.innerHTML);var u=ReplaceAll(o.innerHTML,RegExp.$1,"");if(""==ReplaceAll(o.innerHTML," ","")||1==checkCellDefValue(u)||u=="<p>"+unescape("%u200B")+"</p>")DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&u=="<p>"+unescape("%u200b")+"</p>"&&(o.innerHTML=""!=RegExp.$1?"<p "+RegExp.$1+"></p>":"<p></p>"),0==checkCellBRValue()&&(o.innerHTML=""!=RegExp.$1?"<p "+RegExp.$1+"></p>":"<p></p>"),doSetCaretPosition(o.childNodes[0],0)}}}else if(G_CURSOR_BEFORE_INTABLE&&"body"==n.tagName.toLowerCase()&&(r=!0,37==e||38==e?null==G_BEFORE_INTABLE.previousSibling&&(r=!1):39!=e&&40!=e||null!=G_BEFORE_INTABLE.nextSibling||(r=!1),0==r)){var a=_iframeDoc.createElement("p");a.innerHTML=getDefaultParagraphValue(!1),t.insertNode(a),doSetCaretPosition(a,0)}}}catch(f){}}function getTopOrBottomBoundNextCell(e,t){var n={rowIndex:-1,cellIndex:-1,nextCell:null},r;switch(t){case 38:r=1;break;case 39:r=2;break;case 40:r=3;break;case 37:r=4;break;default:return n}try{var i=GetParentbyTagName(e,"tr");if(i){var s=GetParentbyTagName(e,"table");if(s){var o=s.rows.length,u=i.rowIndex,a=e.cellIndex,f=i.cells.length,l=0;if(""==s.style.borderCollapse||"separate"==s.style.borderCollapse){var c=s.cellSpacing;1<c&&(l=DEXTTOP.DEXT5.util.parseIntOr0(c))}if(1==r){if(0==u)return n;for(var h=u-1;0<=h;h--)for(var p=s.rows[h],d=p.cells.length,v=getClientRect(e),m=0;m<d;m++){var g=p.cells[m],y=getClientRect(g);if(isSameRect(v.top,y.bottom,l)&&(v.left<=y.left&&v.right>=y.right||v.left>=y.left&&v.right<=y.right&&1<g.colSpan)){var b=GetParentbyTagName(g,"tr");if(b)return n.rowIndex=b.rowIndex,n.cellIndex=g.cellIndex,n.nextCell=g,n}}}else if(2==r){if(a!=f-1?(n.rowIndex=u,n.cellIndex=a+1):(n.rowIndex=i.rowIndex+1,n.cellIndex=0),s&&(p=s.rows[n.rowIndex]))if(g=p.cells[n.cellIndex])return n.nextCell=g,n}else if(3==r){if(o==u)return n;for(h=u+1;h<o;h++)for(p=s.rows[h],d=p.cells.length,v=getClientRect(e),m=0;m<d;m++)if(g=p.cells[m],y=getClientRect(g),isSameRect(v.bottom,y.top,l)&&(v.left<=y.left&&v.right>=y.right||v.left>=y.left&&v.right<=y.right&&1<g.colSpan)&&(b=GetParentbyTagName(g,"tr")))return n.rowIndex=b.rowIndex,n.cellIndex=g.cellIndex,n.nextCell=g,n}else if(4==r)if(0!=a){if(n.rowIndex=u,n.cellIndex=a-1,s&&(p=s.rows[n.rowIndex]))if(g=p.cells[n.cellIndex])return n.nextCell=g,n}else if(n.rowIndex=u-1,s&&(p=s.rows[n.rowIndex]))return n.cellIndex=p.cells.length-1,n.nextCell=p.cells[p.cells.length-1],n}}}catch(w){}return n}function setArrowKeyAction(e){return!1}function setDeleteKeyAction(e){e=!1;try{for(var t=GetTableSelectionCells(),n=t.length,r=0;r<n;r++)t[r].innerHTML=getCellDefValue();0<n&&(ClearDraggingTableCellSelected(),removeCellDefValue(t[0],!1),removeCellDefValue(t[n-1],!1),doSetCaretPosition(t[0].childNodes[0],0),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==t[0].innerHTML&&(t[0].innerHTML=""),e=!0)}catch(i){}return e}function getCopyCellData(e){DEXTTOP.G_COPIEDTABLE=null,DEXTTOP.G_COPIEDCELLDATA=null,e=!1;if(null!=ActiveLastTable){var t=CellSelectedCopy(ActiveLastTable);1==t.selected&&(DEXTTOP.G_COPIEDTABLE=t.Table,DEXTTOP.G_COPIEDCELLDATA=t.cellValue,e=!0)}return e}function dextWriteLog(e,t){void 0==t&&(t=!1);if(0==DEXTTOP.DEXT5.isRelease)try{t?parent.parent.document.getElementById("txtTestValue").value+=e:parent.parent.document.getElementById("txtTestValue").value=e}catch(n){}}function _dextiframe_BeforeUnload(e){try{var t=getEditorFromUnloadEvent(e);if(t)try{if(t._config.auditLogEnable&&"1"==t._config.auditLogEnable&&DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.browser.LocalStorageSupported){var n=ALS.toString(),n=n.replace(/,/gi,""),r=DEXTTOP.window.localStorage[n];e=!1;if(null!=r&&void 0!=r&&""!=r)for(var i=r.split(","),s=i.length,o=0;o<s;o++)if(i[o]==t._config.productKey){e=!0;break}if(null==r||void 0==r||""==r||!e){DEXTTOP.window.localStorage[n]=null==r||void 0==r||""==r?t._config.productKey:r+","+t._config.productKey,n=___,-1<n.indexOf("?")&&(n=n.substring(0,n.indexOf("?")));var u=n.indexOf("//"),n=-1<u?n.substring(0,n.substring(u+2).indexOf("/")+(u+2)+1):n.substring(0,n.indexOf("/")+1),a=DEXTTOP.DEXT5.util.makeEncryptParam("ED"+t._config.unitAttributeDelimiter+n+t._config.unitAttributeDelimiter+t._config.productKey);try{_C="https:"!=location.protocol?C1.toString():C2.toString(),_C=_C.replace(/,/gi,""),_C=_C+"?p="+a,(new Image).src=_C}catch(f){}}}}catch(l){}}catch(c){}}function _dextiframe_Unload(e){try{var t=getEditorFromUnloadEvent(e);if(t&&"1"==t._config.autoDestroy.use)try{DEXTTOP.DEXT5.destroy(t)}catch(n){}}catch(r){}}function _dextiframe_Keyup(e){var t="which"in e?e.which:e.keyCode,n=e.target?e.target:e.srcElement,r=null,r=9!=n.nodeType?n.ownerDocument:n;if((r=r.activeElement)&&r.tagName&&"body"!=r.tagName.toLowerCase()&&"html"!=r.tagName.toLowerCase()){var i=r.parentNode,s=r.tagName.toLowerCase(),i=i.tagName.toLowerCase();if(!("span"!=i&&"li"!=i||"a"!=s&&"button"!=s))if(13==t){s=r.id.split(":")[0],i=r.id.split(":")[1],void 0==i&&(i=s.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&-1<i.indexOf("tool_bar_grouping")&&(DEXTTOP.G_CURREDITOR.groupingBoxOpen=!0);var o=isMenuItemEnable(s,i);!o||"shortcut"==i&&1==G_ShortCutClose||(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,i),DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),G_ShortCutClose=!1)}else if(9==t)s=r.id.split(":")[0],i=r.id.split(":")[1],void 0==i&&(i=s.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),o=isMenuItemEnable(s,i),o||(e=moveNextMenu(s,i))&&e.focus();else if(39==t){if(s=r.id.split(":")[0],i=r.id.split(":")[1],void 0==i&&(i=s.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),r=moveNextMenu(s,i))for(s=r.id.split(":")[0],i=r.id.split(":")[1];;){if(o=isMenuItemEnable(s,i)){r.focus();break}if(!(r=moveNextMenu(s,i)))break;s=r.id.split(":")[0],i=r.id.split(":")[1]}}else if(37==t&&(s=r.id.split(":")[0],i=r.id.split(":")[1],void 0==i&&(i=s.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),r=movePrevMenu(s,i)))for(s=r.id.split(":")[0],i=r.id.split(":")[1];;){if(o=isMenuItemEnable(s,i)){r.focus();break}if(!(r=movePrevMenu(s,i)))break;s=r.id.split(":")[0],i=r.id.split(":")[1]}if(27==t&&"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping){t=n;for(n=!1;"BODY"!=t.tagName;){if(-1<t.id.indexOf("dext_div_tool_bar_grouping_box")){n=!0;break}t=t.parentNode}n&&(hideGroupingBox(),setTimeout(function(){setFocusToBody()},1))}}}function _dextiframe_Keydown(e){var t=e.target||e.srcElement,n="which"in e?e.which:e.keyCode;try{var r=DEXTTOP.G_CURREDITOR,i=r.getEditorMode();if(t&&t.tagName&&"textarea"==t.tagName.toLowerCase()){if(13==n){var s=t.id;switch(s){case"ue_"+r.ID+"zoom_text":case"txtara_"+r.ID+"font_family":case"txtara_"+r.ID+"font_size":case"txtara_"+r.ID+"line_height":DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e),r.dextiframeKeydown=!0}switch(s){case"ue_"+r.ID+"zoom_text":command_zoom(r.ID,r);break;case"txtara_"+r.ID+"font_family":r._dextFontFamily.click_func(r.ID,null,t.value);break;case"txtara_"+r.ID+"font_size":r._dextFontSize.click_func(r.ID,null,t.value);break;case"txtara_"+r.ID+"line_height":r._dextLineHeight.click_func(r.ID,null,t.value)}}return}if(8==n&&"design"==i){DEXTTOP.DEXT5.util.cancelEvent(e);return}}catch(o){}e.ctrlKey&&!e.altKey&&nextTabKeyAccess(e,n)&&DEXTTOP.DEXT5.util.cancelEvent(e)}function nextTabKeyAccess(e,t){var n=!1;try{var r=null;switch(t){case 48:var i=DEXTTOP.DEXTDOC.getElementById(DEXTTOP.G_CURREDITOR._config.nextTabElementId);i?setTimeout(function(){i.focus()},0):setFocusTopWindow();var s=getEditrFromEvent(e);s&&(s._dextframeHasFocus=!1),n=!0;break;case 49:r=getFirstCmdElementInBar("dext_tab_menu_"+DEXTTOP.G_CURREDITOR.ID),n=!0;break;case 50:r=getFirstCmdElementInBar("dext_tab_tool1_"+DEXTTOP.G_CURREDITOR.ID),n=!0;break;case 51:r=getFirstCmdElementInBar("dext_tab_tool2_"+DEXTTOP.G_CURREDITOR.ID),n=!0;break;case 52:setFocusToBody(),n=!0;break;case 53:r=getFirstCmdElementInBar("dext_tab_status_"+DEXTTOP.G_CURREDITOR.ID),n=!0;break;case 54:var o=document.getElementById("dext_topstatusbar_"+DEXTTOP.G_CURREDITOR.ID),r=o&&o.getElementsByTagName("a")[0]?o.getElementsByTagName("a")[0]:null,n=!0;break;case 123:DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"shortcut"),n=!0;break;case 66:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"bold"),n=!0;break;case 73:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"italic"),n=!0;break;case 85:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"underline"),n=!0;break;case 68:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"strike_through"),n=!0;break;case 76:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"align_left"),n=!0;break;case 69:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"align_center"),n=!0;break;case 72:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"align_right"),n=!0;break;case 75:if(s=getEditrFromEvent(e))s._dextCommands(s.ID,"hyperlink_property"),n=!0;break;case 222:if(s=getEditrFromEvent(e))e.shiftKey?s._dextCommands(s.ID,"superscript"):s._dextCommands(s.ID,"subscript"),n=!0;break;case 221:(s=getEditrFromEvent(e))&&e.shiftKey&&(s._dextCommands(s.ID,"table_indent"),n=!0);break;case 219:(s=getEditrFromEvent(e))&&e.shiftKey&&(s._dextCommands(s.ID,"table_outdent"),n=!0)}if(r){var u=r.id.split(":")[0],a=r.id.split(":")[1];if(isMenuItemEnable(u,a)){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(f){}r.focus()}else{var l=moveNextMenu(u,a);if(l){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(c){}l.focus()}}}}catch(h){}return n}function isMenuItemEnable(e,t){var n=!0,r=document.getElementById("dext_span_"+e+t);return r&&(r=DEXTTOP.DEXT5.util.getClass(r))&&-1<r.indexOf("_off")&&(n=!1),n}function moveNextMenu(e,t){var n=null,r=document.getElementById("dext_span_"+e+t);if(r&&r.nextSibling){var r=r.nextSibling,i="";r.tagName&&(i=r.tagName.toLowerCase()),"span"==i&&1==r.childNodes.length&&(r=r.nextSibling);if("span"==i&&1<r.childNodes.length&&(n=r.childNodes[1],r=n.id.split(":")[1],!isMenuItemEnable(e,r)))return moveNextMenu(e,r)}return n}function movePrevMenu(e,t){var n=null,r=document.getElementById("dext_span_"+e+t);if(r&&r.previousSibling){var r=r.previousSibling,i=r.tagName.toLowerCase();"span"==i&&1==r.childNodes.length&&(r=r.previousSibling);if("span"==i&&1<r.childNodes.length&&(n=r.childNodes[1],r=n.id.split(":")[1],!isMenuItemEnable(e,r)))return movePrevMenu(e,r)}return n}function getFirstCmdElementInBar(e){var t=null;try{var n=document.getElementById(e),r=n.childNodes.length;for(e=0;e<r;e++){var i=n.childNodes[e];if(1===i.nodeType&&0<i.childNodes.length){for(var s=i.childNodes.length,o=0;o<s;o++){var u=i.childNodes[o];if(1===u.nodeType&&("a"==u.tagName.toLowerCase()||"button"==u.tagName.toLowerCase())){t=u;break}}if(t)break}}}catch(a){t=null}return t}function getImageAutoFitForPasteHtml(e){var t=document.createElement("div");t.innerHTML=e,e=!1,1==t.firstChild.nodeType&&"IMG"==t.firstChild.tagName&&3==t.lastChild.nodeType&&"|"==t.lastChild.nodeValue&&2==t.childNodes.length&&(e=!0,t.removeChild(t.lastChild));for(var n=t.getElementsByTagName("img"),r=null,i=n.length,s=0;s<i;s++)r=n[s],e||pluginInsertImageAutoFit(r);return e=t.innerHTML}function removeHistory(e){}function set_view_mode_auto_height(e){try{setTimeout(function(){var t=DEXTTOP.G_CURREDITOR;e&&(t=e);if(("1"==t._config.view_mode_auto_height||"1"==t._config.view_mode_auto_width)&&"view"==t._config.mode){var n=t._BODY,r=t._DOC.documentElement,i=t._config.style.height,s=t._config.style.width,o=0;if(0>i.indexOf("%"))o=parseInt(i,10);else if("1"==t._config.view_mode_auto_height)return;var u=0;if(0>s.indexOf("%"))u=parseInt(s,10);else if("1"==t._config.view_mode_auto_width)return;var f=0,l=0;"1"==t._config.view_mode_auto_height?(i="",DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(i=n.style,n.style="overflow:initial !important"),f=Math.max(n.scrollHeight,n.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight),DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(n.style=i),f>=o&&(f+=30)):(f=o,-1<i.indexOf("%")&&(f=i)),"1"==t._config.view_mode_auto_width?(l=Math.max(n.scrollWidth,n.offsetWidth,r.clientWidth,r.scrollWidth,r.offsetWidth),l>=u&&(l+=10)):(l=u,-1<s.indexOf("%")&&(l=s)),DEXTTOP.DEXT5.setSize(l,f,t.ID)}},250)}catch(t){}}function getFontStyle(e,t){var n,r={fontFamily:"",fontSize:"",lineHeight:""};return t?window.getComputedStyle?n=window.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle):e.currentStyle?n=e.currentStyle:window.getComputedStyle&&(n=window.getComputedStyle(e,"")),r.fontFamily=getFontFamilyStyle(n.fontFamily),r.fontSize=getFontSizeStyle(n.fontSize,n.lineHeight),r.lineHeight=getLineHeightStyle(r.fontSize,n.lineHeight,e),r}function getFontFamilyStyle(e){return 0<e.length&&(e=e.replace(/"/gi,""),e=e.replace(/'/gi,""),e=e.split(",")[0]),e}function getFontSizeStyle(e,t){var n,r="pt";try{-1<DEXTTOP.G_CURREDITOR._dextFontSize._fontSize[DEXTTOP.G_CURREDITOR.ID][0].indexOf("px")&&(r="px")}catch(i){-1<DEXTTOP.G_CURREDITOR._config.defaultFontSize.indexOf("px")&&(r="px")}return e=e.toString(),-1<e.indexOf("px")?"pt"==r?(n=.75*parseFloat(e),n=Math.round(n)+"pt"):"px"==r&&(n=e):-1<e.indexOf("pt")?"pt"==r?n=e:"px"==r&&(n=parseFloat(e)*(4/3),n=Math.round(n)+"px"):-1<e.indexOf("em")?"pt"==r?-1<t.indexOf("px")?(n=.75*parseFloat(t),n*=parseFloat(e),n=Math.round(n)+"pt"):-1<t.indexOf("pt")?(n=parseFloat(t)*parseFloat(e),n=Math.round(n)+"pt"):n="":"px"==r&&(-1<t.indexOf("px")?(n=parseFloat(t)*parseFloat(e),n=Math.round(n)+"px"):-1<t.indexOf("pt")?(n=parseFloat(t)*(4/3),n*=parseFloat(e),n=Math.round(n)+"px"):n=""):n="",n}function getLineHeightStyle(e,t,n){if(!DEXTTOP.DEXT5.browser.ie){if(1==n.nodeType&&0>",p,li,dt,dd,h1,h2,h3,h4,h5,h6,pre,table,hr,blockquote,address,body,td,th,div,".indexOf(","+n.tagName.toLowerCase()+","))for(;0>",p,li,dt,dd,h1,h2,h3,h4,h5,h6,pre,table,hr,blockquote,address,body,td,th,div,".indexOf(","+n.tagName.toLowerCase()+",");)n=n.parentNode;n.currentStyle?compStyle=n.currentStyle:window.getComputedStyle&&(compStyle=window.getComputedStyle(n,"")),e=compStyle.fontSize,t=compStyle.lineHeight}var r=!0,i=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];i&&0>i.indexOf("%")&&(r=!1),i=t,-1<t.indexOf("px")?(i=parseFloat(e),t=parseFloat(t),-1<e.indexOf("pt")&&(i=96*i/72),t=Math.round(t/i*10)/10,i=r?parseInt(100*t,10)+"%":t):-1<t.indexOf("pt")?(i=parseFloat(e),t=parseFloat(t),-1<e.indexOf("pt")&&(i=96*i/72),t=96*t/72/i,t=Math.round(10*t)/10,i=r?parseInt(100*t,10)+"%":t):-1<t.indexOf("normal")||-1<t.indexOf("inherit")?i=t:"1"==DEXTTOP.G_CURREDITOR._config.lineHeightMode&&r&&(i=Math.round(100*parseFloat(t))+"%"),n=n.tagName.toLowerCase();if("h1"==n||"h2"==n||"h3"==n||"h4"==n||"h5"==n||"h6"==n||""==e)i="";return i}function setAutoSave(e,t,n){try{var r=e._setting.auto_save.toString().split(",");e._setting.auto_save_fn&&DEXTTOP.DEXTWIN.clearInterval(e._setting.auto_save_fn);if(DEXTTOP.DEXT5.browser.LocalStorageSupported)if("1"==r[0]){DEXTTOP.DEXTWIN.localStorage["dext_"+e.ID+"_auto_save"]=r[1];var i=e._config.setAutoSave.use_encrypt,s=e._config.setAutoSave.unique_key,o="dext_"+e.ID;""!=s&&(o+="_"+s);if(t){var u=DEXTTOP.DEXTWIN.localStorage["dext_"+e.ID];null!=u&&void 0!=u&&""==s&&(DEXTTOP.DEXT5.util.saveJsonToLocalStorage(o+"_0",{date:e._DOC.lastModified,html:u}),DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+e.ID))}localSaveValue(o,i,e._config.setAutoSave.maxCount),e._setting.auto_save_fn=fn_AutoSaveInterval(e,o),1==n&&DEXTTOP.DEXT5.manuallyTempSave(e.ID);var a=DEXTTOP.DEXTWIN.localStorage[o+"_0"];null!=a&&void 0!=a&&autoSaveEnable(e.ID)}else"2"==r[0]&&(DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+e.ID+"_auto_save"),DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+e.ID),e._iconEnable(""))}catch(f){}}function getAutoSaveHtml(e){var t=void 0;try{t=DEXTTOP.DEXTWIN.localStorage["dext_"+e]}catch(n){}return t}function getAutoSaveHtml_userID(e,t,n){var r=void 0,i=[],s,o={};e="dext_"+e,""!=t&&null!=t&&void 0!=t&&(e+="_"+t);try{for(t=0;t<parseIntOr0(n);t++)if(r=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(e+"_"+t),null!=r&&void 0!=r){var u=r.html.toLowerCase().indexOf("<html");-1<u?s=r.html:0>u&&(s=DEXTTOP.DEXT5.util.makeDecryptReponseMessage(r.html)),o={date:r.date,html:s},i.push(o)}}catch(a){}return 0<i.length?i:r}function getAutoSave(e){try{var t=DEXTTOP.DEXTWIN.localStorage["dext_"+e.ID+"_auto_save"];return t?"1,"+t:"2"}catch(n){return"0"}}function _iframeDoc_Scroll(e){setDEXTWINDOC();try{if(DEXTTOP.G_CURREDITOR.isStopScroll){var t=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft);return _iframeWin.scroll(t,DEXTTOP.G_CURREDITOR.previousScrollTop),DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),!1}DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.G_CURREDITOR.previousScrollTop=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop))}catch(n){}if(getApplyDragResize(DEXTTOP.G_CURREDITOR))if(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv){var t=getElementOffset(_iframeWin.frameElement),r=getClientRect(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem);DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv.style.left=t.left+r.left-DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDivBorder+"px",DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv.style.top=t.top+r.top-DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDivBorder+"px",DEXTTOP.G_CURREDITOR.dext_dragresize.setDragResizeDivSize(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv),DEXTTOP.G_CURREDITOR.dext_dragresize.setHandlePosition()}else DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();moveRulerPosition(e),"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&DEXTTOP.G_CURREDITOR.isAOver.over&&(DEXTTOP.G_CURREDITOR.isAOver.node||DEXTTOP.G_CURREDITOR.isAOver.nodeChild)&&DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose();if(1==DEXTTOP.G_CURREDITOR.preventScrollMove.use)return _iframeDoc.documentElement.scrollTop=DEXTTOP.G_CURREDITOR.preventScrollMove.beforeTop,_iframeDoc.documentElement.scrollLeft=DEXTTOP.G_CURREDITOR.preventScrollMove.beforeLeft,DEXTTOP.DEXT5.util.cancelEvent(e),DEXTTOP.DEXT5.util.stopEvent(e),!1}function moveRulerPosition(e){if(1==DEXTTOP.G_CURREDITOR._config.ruler.use){var t=getEditrFromEvent(e);if(null==t||void 0==t)t=DEXTTOP.G_CURREDITOR;var n=getEditorFrameDoc(t).getElementById("dext_tab_tool3_"+t.ID);if(n&&"none"!=n.style.display){var r=n.style.backgroundPosition,i=n.style.backgroundPosition.indexOf("px"),r=parseInt(r.substring(0,i),10),i=t._DOC.documentElement.scrollLeft||t._BODY.scrollLeft||0;r!=i&&(n.style.backgroundPosition="-"+i+"px top",set_ruler_point_position(t)),setTimeout(function(){set_ruler_pointline_position(t)},0)}set_ruler_vertical_height(t,e),set_horizontal_line_2(t,e)}}function set_ruler_point_position(e){var t=getEditorFrameDoc(e),n=e._setting.ruler_position;""==n&&"1"==e._config.ruler.mode&&(e._setting.ruler_position=e._config.ruler.rulerInitPosition);var n=n.split(","),r=n.length;"2"==e._config.ruler.mode&&(r=3);var i=t.getElementById("dext_tab_tool3_"+e.ID),s=i.getElementsByTagName("img"),o=s.length,u=!0;if(r!=o)for(u=!1,--o;0<=o;o--)s[o].parentNode.removeChild(s[o]);for(o=0;o<r;o++){if(0==u){var a=t.createElement("img");a.id="dext_ruler_point_"+o+"_"+e.ID,a.src="../images/bg/point.gif",a.style.verticalAlign="top",a.style.border="0px",a.style.width="14px",a.style.height="9px",a.style.margin="0 0 0 -7",a.style.display="none",a.style.position="absolute",a.style.top="-1px",i.appendChild(a)}var s=t.getElementById("dext_ruler_point_"+o+"_"+e.ID),a=parseIntOr0(s.style.width),f=parseIntOr0(n[o])-a/2,a=_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0,f=f-a;s.style.marginLeft=f+"px","2"!=e._config.ruler.mode&&(s.style.display=0>=f?"none":"1"==e._config.ruler.viewPointer?"":"none")}"1"==e._config.autoBodyFit&&("2"!=e._config.ruler.mode||"2"==e._config.ruler.mode&&e.isInitBodyAutoFit)&&(t=parseIntOr0(_iframeDoc.body.style.width),n=parseIntOr0(n[n.length-1]),0<n&&n!=t&&(t=n,"1"==e._config.defaultBodySpace.use&&(t-=parseIntOr0(e._config.defaultBodySpace.configValue.left)),_iframeDoc.body.style.width=t+"px")),"2"==e._config.ruler.mode&&(t=document.getElementById("dext_ruler_area_0"),e=document.getElementById("dext_ruler_area_1"),n=G_RULER_MOVE_AREA.realX1,r=G_RULER_MOVE_AREA.realX2,n-=a,r-=a,t.style.width=(0>=n?0:n)+"px",e.style.left=r+"px",a=getCurrEditorWidth()-r,0>a&&(a=0),e.style.width=a+"px")}function set_ruler_pointline_position(e){if("1"==e._config.ruler.viewGuideLine){var t=getEditorFrameDoc(e),n=e._setting.ruler_position;""==n&&"1"==e._config.ruler.mode&&(e._setting.ruler_position=e._config.ruler.rulerInitPosition);var n=n.split(","),r=n.length;"2"==e._config.ruler.mode&&("1"==e._config.ruler.autoFitMode&&(n[2]=getCurrEditorWidth(),e._setting.ruler_position=n.join(","),e._config.ruler.rulerInitPosition=n.join(",")),r=4);var i=t.getElementById("dext_ruler_pointline_div"),s=i.getElementsByTagName("div"),o=s.length,u=!0;if(r!=o)for(u=!1,--o;0<=o;o--)s[o].parentNode.removeChild(s[o]);for(o=0;o<r;o++){0==u&&(s=t.createElement("div"),s.id="dext_ruler_pointline_"+o+"_"+e.ID,s.style.position="absolute",s.style.zIndex="9999",s.style.borderLeft=e._config.ruler.guideLineStyle+" 1px "+e._config.ruler.guideLineColor,s.style.display="none",i.appendChild(s));var s=t.getElementById("dext_ruler_point_"+o+"_"+e.ID),a=parseIntOr0(s.style.width),s=parseIntOr0(n[o])-a/2,f=_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0,s=s-f,f="ue_editor_holder_"+e.ID,l=t.getElementById(f),f=t.getElementById("dext_ruler_pointline_"+o+"_"+e.ID);if("2"!=e._config.ruler.mode||"2"==e._config.ruler.mode&&(0==o||3==o))f.style.top=l.offsetTop+"px",f.style.left=s+a/2+"px",f.style.height=l.style.height;else{var c=parseIntOr0(t.getElementById("dext_tab_tool4_"+e.ID).style.height);f.style.top=l.offsetTop-c+"px",f.style.left=s+a/2+"px",f.style.height=parseIntOr0(l.style.height)+c+"px"}"2"!=e._config.ruler.mode?(a=t.getElementById("dext_tab_tool3_"+e.ID),0>=s?f.style.display="none":"none"!=a.style.display&&(f.style.display="")):f.style.display="none"}if("1"==e._config.autoBodyFit){i=0,i="2"==e._config.ruler.mode?parseIntOr0(n[r-2]):parseIntOr0(n[r-1]);if("1"==e._config.usePersonalSetting&&0==i)_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("width"):_iframeDoc.body.style.removeAttribute("width"),(t=getDefaultStyleTag(_iframeDoc,e))&&-1<t.innerHTML.toLowerCase().indexOf("width")&&(n=createEditorDefaultStyleInnerHTML(e._config,e._setting.font_family,e._setting.font_size,e._setting.line_height),r=_iframeDoc.createElement("style"),r.type="text/css",r.styleSheet?(r.styleSheet.cssText=n,""==r.innerHTML&&(r.innerHTML=n)):r.appendChild(_iframeDoc.createTextNode(n)),t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t));else{if("2"!=e._config.ruler.mode||"2"==e._config.ruler.mode&&e.isInitBodyAutoFit)e.isInitBodyAutoFit=!1,r=parseIntOr0(_iframeDoc.body.style.width),0<i&&i!=r&&(r=i,"1"==e._config.defaultBodySpace.use&&(r-=parseIntOr0(e._config.defaultBodySpace.configValue.left)),_iframeDoc.body.style.width=r+"px");"2"==e._config.ruler.mode&&("1"==e._config.ruler.autoFitMode&&("0"==e._config.ruler.fixEditorWidth?_iframeDoc.body.style.width="":(r=n[2],r="1"==e._config.defaultBodySpace.use?r-(parseIntOr0(e._config.defaultBodySpace.configValue.left)+parseIntOr0(e._config.defaultBodySpace.configValue.right)+15):r-35,_iframeDoc.body.style.width=r+"px")),a=t.getElementById("dext_tab_tool3_"+e.ID),"none"!=a.style.display&&(n=e._config.ruler.rulerInitPosition.split(",")[2],s=parseIntOr0(n),f=_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0,s-=f,f="ue_editor_holder_"+e.ID,l=t.getElementById(f),"0"==e._config.useNoncreationAreaBackground&&(c=parseIntOr0(t.getElementById("dext_tab_tool4_"+e.ID).style.height),f=t.getElementById("dext_ruler_pointline_4_"+e.ID),f.style.top=l.offsetTop-c+"px",f.style.left=s+"px",f.style.height=parseIntOr0(l.style.height)+c+"px",f.style.display="")))}setEditorHtmlWidth(e)}}}function set_ruler_vertical_height(e,t){if("1"==e._config.ruler.useVertical){var n=getEditorFrameDoc(e),r=n.getElementById("dext_ruler_vertical_scroll_"+e.ID);if(null!=r){if("design"==e._currentMode){var i=e._DOC.documentElement.scrollTop;0==i&&(i=e._BODY.scrollTop),r.style.top=-1*i+"px"}else if("preview"==e._currentMode){var s=e._EDITOR.preview.contentWindow.document,i=s.documentElement.scrollTop;0==i&&(i=s.body.scrollTop),r.style.top=-1*i+"px"}i=r.childNodes.length;for(s=(e._BODY.scrollHeight>e._defaultHeight?e._BODY.scrollHeight:e._defaultHeight)/50;i<=s;i++){var o=n.createElement("div");o.className="ruler_vertical_num",o.innerText=50*i,r.appendChild(o)}}if("2"==e._config.ruler.mode){i=r="0px",i={top:0,bottom:0};try{if(null!=G_CURSOR_ELEMENT){var u=GetParentbyTagName(G_CURSOR_ELEMENT,"p");null!=u&&(i=u.getBoundingClientRect())}}catch(a){}r=(0<i.top?i.top:0)+"px",i=(0<i.bottom?i.bottom:0)+"px",u=n.getElementById("dext_ruler_vertical_area_0_"+e.ID),null!=u&&(u.style.height=r),u=n.getElementById("dext_ruler_vertical_area_1_"+e.ID),null!=u&&(u.style.top=i)}"undefined"==typeof t&&(u=n.getElementById("dext_ruler_vertical_"+e.ID),null!=u&&(u.style.height=e._defaultHeight+"px"),u=n.getElementById("ue_editor_holder_"+e.ID),null!=u&&(u.style.marginLeft="1"==e._config.ruler.view?"18px":"0px"),u=n.getElementById("dext_tab_tool3_"+e.ID),null!=u&&(u.style.left="17px",u.style.borderLeft="1px solid #b8babc"),u=n.getElementById("dext_tab_tool4_"+e.ID),null!=u&&(u.style.left="17px",u.style.borderLeft="1px solid #b8babc"),u=n.getElementById("dext_ruler_pointline_0_"+e.ID),null!=u&&(u.style.marginLeft="18px"),u=n.getElementById("dext_ruler_pointline_1_"+e.ID),null!=u&&(u.style.marginLeft="18px"),u=n.getElementById("dext_ruler_pointline_2_"+e.ID),null!=u&&(u.style.marginLeft="18px"),u=n.getElementById("dext_ruler_pointline_3_"+e.ID),null!=u&&(u.style.marginLeft="18px"),n=n.getElementById("dext_horizontal_line_"+e.ID),null!=n&&(n.style.marginLeft="1"==e._config.ruler.view?"18px":"0px"))}}function set_ruler_mouse_guide(e,t){if("1"==e._config.ruler.useMouseGuide){var n=getEditorFrameDoc(e).getElementById("dext_ruler_mouse_guide_"+e.ID);null!=n&&(n.style.left=t.clientX+"px")}}function set_horizontal_line_2(e){if("2"==e._config.horizontalLine.use){var t=getEditorFrameDoc(e).getElementById("dext_horizontal_line_"+e.ID);if(null!=t){var n=1*e._config.horizontalLine.height,r=getWindowClientSize(e._FRAMEWIN._iframeWin),i=r[0];DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(i=e._FRAMEWIN._iframeWin.frameElement.clientWidth);var r=r[1],s=!1,o=r/n,u=0;"design"==e._currentMode?(u=e._DOC.documentElement.scrollTop,0==u&&(u=e._BODY.scrollTop),s=r<e._BODY.scrollHeight):"preview"==e._currentMode&&(s=e._EDITOR.preview.contentWindow.document,u=s.documentElement.scrollTop,0==u&&(u=s.body.scrollTop),s=r<s.body.scrollHeight);for(var a=t.childNodes,f=0;f<o;f++){var l;a[f]?l=a[f]:(l=e._DOC.createElement("div"),l.className="horizontal_line_2",""!=e._config.horizontalLine.style&&(l.style.borderBottom=e._config.horizontalLine.style),t.appendChild(l));var c=n*(f+1)-u%n;l.style.marginTop=r>=c?c+"px":c+30+"px",l.style.width=s?i-16+"px":""}}}}function changeSpanPageBreakProperty(e){var t=function(e){for(var t=e.length,n=0;n<t;n++){var r=e[n];if("always"==r.style.pageBreakAfter||"page"==r.style.breakAfter)r.getElementsByTagName("span")[0].innerText="",r.style.borderStyle="none",r.style.borderWidth="0px"}},n=e.getElementsByTagName("span");e=e.getElementsByTagName("div"),t(n),t(e)}function restoreSpanPageBreakProperty(e){e=e.getElementsByTagName("span");for(var t=e.length,n=0;n<t;n++){var r=e[n];"always"==r.style.pageBreakAfter&&(r.getElementsByTagName("span")[0].innerText=dext5_lang.icon.pagebreak,r.style.borderColor="red",r.style.borderStyle="dashed",r.style.borderWidth="1px")}}function setLineHeightForBgColor(){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{var e=getFirstRange().range,t=getMyElementNode(e.startContainer);if("SPAN"==t.tagName&&(""!=t.style.color||""!=t.style.backgroundColor)){for(var n,e=t;"BODY"!=e.parentNode.tagName;){if("P"==e.parentNode.tagName){n=e;break}e=e.parentNode}currLineHeight=getFontStyle(t).lineHeight;var r=DEXTTOP.G_CURREDITOR._setting.line_height,e=!1;if(""==currLineHeight)e=!0;else{var i=currLineHeight.indexOf("%");if(-1<i){var s=parseInt(currLineHeight,10);currLineHeight=s/=100}i=r.indexOf("%"),-1<i&&(s=parseInt(r,10),r=s/100)}currLineHeight==r&&(e=!0);var o;1==e&&(o=1*currLineHeight+.01),o&&n&&"SPAN"==n.tagName&&e&&(n.style.lineHeight=o,n!=t&&(t.style.lineHeight=currLineHeight))}}catch(u){}}function isMsHtmlorHugeHtml(e){var t=!0;return 11>DEXTTOP.DEXT5.browser.ieVersion?t:t=RegExp('mso-[^:]+:[^;">]+;',"gi").test(e.innerHTML)}function setEditorBorder(e){for(var t=e._config.style.skinName,n=[],r=document.getElementById("dext_menu_"+e.ID),t=getElementsByClass("ue_tg_"+t,document)[0],i=document.getElementById("dext_toolbar_"+e.ID),s=document.getElementById("ue_editor_holder_"+e.ID),o=document.getElementById("dext_statusbar_"+e.ID),s=[r,i,s,o],o=s.length,r=0;r<o;r++)null!=s[r]&&"none"!=s[r].style.display&&(s[r]==i?n.push(t):n.push(s[r]));t=n.length;for(r=0;r<t;r++)"0px"==n[r].style.borderTopWidth&&DEXTTOP.DEXT5.util.removeStyleAttribute(n[r],"border-top-width"),"1"==e._config.editorborder?(DEXTTOP.DEXT5.util.removeStyleAttribute(n[r],"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(n[r],"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(n[r],"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(n[r],"border-left-width")):(0==r&&(n[r].style.borderTopWidth="0px"),r==t-1&&(n[r].style.borderBottomWidth="0px"),n[r].style.borderRightWidth="0px",n[r].style.borderLeftWidth="0px");"0"!=e._config.top_status_bar||isViewMode(e)||(n[0].style.borderTopWidth="0px")}function getDefaultParagraphValue(e){var t="";return t=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?e?"<p>&nbsp;</p>":"&nbsp;":e?"<p><br /></p>":"<br />"}function repairBodyFirstLastTag(e){try{if(0!=DEXTTOP.G_CURREDITOR._config.editorBodyEditable){var t=_iframeDoc.body.childNodes,n=t.length,r=!1,i,s;if(0==n.length)r=!0;else{s=t[0],i=t[n-1];if(1==e&&1==s.nodeType&&("table"==s.tagName.toLowerCase()||"blockquote"==s.tagName.toLowerCase())){insertPtagTableNear(!0,s),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;return}if(1!=i.nodeType||"p"!=i.tagName.toLowerCase())r=!0;if(1==i.nodeType&&"p"==i.tagName.toLowerCase()){var o=i.childNodes,u=o.length;""==i.innerText&&0<u&&1==o[u-1].nodeType&&("img"==o[u-1].tagName.toLowerCase()||"table"==o[u-1].tagName.toLowerCase())&&(r=!0)}}if(r){var a=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(a.innerHTML=getDefaultParagraphValue(!1)),_iframeDoc.body.appendChild(a)}}}catch(f){}}function OfficePasteClean(e){var t=e;try{e=ReplaceAll(e,unescape("%uFEFF"),""),e=ReplaceAll(e,unescape("%u200B"),""),e=e.replace(/\r\n/g,""),e=e.replace(/\r/g,""),e=removeDummyTag(e);var n=RegExp("<span *([^>?+])*>(\\n)</span>","gi"),r=RegExp("<span *([^>?+])*>(\\n)<span","gi"),i=e,s=!1;try{var o=e.match(n);if(o)for(var u=o.length,a=0;a<u;a++)var f=o[a],l=/>\n</.exec(f),c=l[0].replace(RegExp("\\n","gi")," "),f=f.replace(l,c),i=i.replace(o[a],f);if(o=e.match(r))for(u=o.length,a=0;a<u;a++)f=o[a],l=/>\n</.exec(f),c=l[0].replace(RegExp("\\n","gi")," "),f=f.replace(l,c),i=i.replace(o[a],f)}catch(h){s=!0}s||(e=i),e=e.replace(/>\n+</g,"><"),e=e.replace(/\t/g,""),e=-1<e.indexOf("<")?e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""):e.replace(/^[\xa0]+|[\xa0]+$/g,""),e=e.replace(/<font/gi,'<span dext_fonttag="true"'),e=e.replace(/<\/font/gi,"</span"),r="(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>",n=new RegExp(r,"gim"),e=e.replace(n,"$1"+unescape("%u200B")+"</span>");if(DEXTTOP.DEXT5.browser.ie){e=ReplaceAll(e,unescape("%u3000"),""),r="<font[^>]*>(?:\\s|&nbsp;|  |)</font>",e=e.replace(new RegExp(r,"gim"),"");var r="<span[^>]*>(?:|  |)</span>",p=new RegExp(r,"gim")}else e=ReplaceAll(e,unescape("%u3000"),""),e=ReplaceAll(e,"\u3000","<p><br></p>"),r="<span[^>]*>(?:|  |)</span>",p=new RegExp(r,"gim");e=e.replace(p,"");if("ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes&&G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType||"XLS"==G_wordProcessorType){var d=DEXTTOP.G_CURREDITOR._config.removeFontType.fontFamily,v=DEXTTOP.G_CURREDITOR._config.removeFontType.type,m=d.length,g=v.length;if(0<m&&0<g){p=!1;for(i=0;i<m;i++)if((new RegExp("(<[^>]*)("+d[i]+")([^/>]*>)","gi")).test(e)){p=!0;break}if(p)for(d=0;d<g;d++)n=new RegExp("(<[^>]*)(,\\s?"+v[d]+")([^/>]*>)","gi"),n.test(e)&&(e=e.replace(n,"$1$3"))}}r="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>",n=new RegExp(r,"gim"),e=e.replace(n,"$1</span>");var y=document.createElement("div");y.innerHTML=e;for(var b=y.getElementsByTagName("span"),w=b.length,n=0;n<w;n++){null!=b[n].getAttribute("face")&&void 0!=b[n].getAttribute("face")&&""!=b[n].getAttribute("face")&&(""==b[n].style.fontFamily&&(b[n].style.fontFamily=b[n].getAttribute("face")),removeAttribute(b[n],"face")),null!=b[n].getAttribute("color")&&void 0!=b[n].getAttribute("color")&&""!=b[n].getAttribute("color")&&(""==b[n].style.color&&(b[n].style.color=b[n].getAttribute("color")),removeAttribute(b[n],"color"));if(null!=b[n].getAttribute("dext_fonttag")&&void 0!=b[n].getAttribute("dext_fonttag")&&""!=b[n].getAttribute("dext_fonttag")){null==b[n].getAttribute("size")||void 0==b[n].getAttribute("size")||b[n].getAttribute("size");for(var E=b[n].getElementsByTagName("span"),S=E.length,a=0;a<S;a++)null!=E[a].getAttribute("size")&&void 0!=E[a].getAttribute("size")&&""!=E[a].getAttribute("size")||removeAttribute(E[a],"dext_fonttag");removeAttribute(b[n],"dext_fonttag")}if(null!=b[n].getAttribute("size")&&void 0!=b[n].getAttribute("size")&&""!=b[n].getAttribute("size")){var x;switch(b[n].getAttribute("size")){case"1":x="8pt";break;case"2":x="10pt";break;case"3":x="12pt";break;case"4":x="14pt";break;case"5":x="18pt";break;case"6":x="24pt";break;case"7":x="36pt";break;default:x=""}""!=x&&""==b[n].style.fontSize&&(b[n].style.fontSize=x),removeAttribute(b[n],"size")}}if("1"==DEXTTOP.G_CURREDITOR._config.useCorrectInOutdent){var T=y.innerHTML,N=y.getElementsByTagName("p"),C=N.length;try{for(n=0;n<C;n++){var k=N[n].style.textIndent,L,A;k&&0<k.length&&(L=parseFloat(k),A=k.replace(L,"").toLowerCase());var O=N[n].style.marginLeft,M,_;O&&0<O.length&&(M=parseFloat(O),_=O.replace(M,"").toLowerCase());if(L&&M){if(A==_)var D=L+M;else"pt"==A?L=4*L/3:"cm"==A&&(L*=37.795275593333),"pt"==_?M=4*M/3:"cm"==_&&(M*=37.795275593333),D=L+M;0>D&&(N[n].style.textIndent="",N[n].style.marginLeft="")}else L?0>L&&(N[n].style.textIndent=""):M&&0>M&&(N[n].style.marginLeft="")}}catch(P){y.innerHTML=T}}if("1"==DEXTTOP.G_CURREDITOR._config.adjustTextIndentInPaste&&(G_dext5plugIn&&1==G_dext5plugIn.getHTMLFormatFromType||"DOC"==G_wordProcessorType))for(N=y.getElementsByTagName("p"),C=N.length,n=0;n<C;n++){var H=N[n].style.textIndent,B=DEXTTOP.DEXT5.util.parseIntOr0(N[n].style.marginLeft),j=DEXTTOP.DEXT5.util.parseIntOr0(H);if(0!=j){var F=H.replace(j,"");N[n].style.marginLeft=B+j+F,N[n].style.textIndent=""}}"ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes&&G_dext5plugIn&&4==G_dext5plugIn.getHTMLFormatFromType&&removeDummyDivInHwp(y),copyImageToTempFolder(y),e=y.innerHTML,e=officePasteCleanForTable(e)}catch(I){e=t}return e}function removeAttributeForPasteTable(e){var t=!1;"none"==e.style.display&&(t=!0);for(var n=["height","style"],r=n.length,i=0;i<r;i++)removeAttribute(e,n[i]);t&&(e.style.display="none")}function makeRangeSelectionMarkInDesign(){try{restoreSelection(),setFocusToBody();var e=getFirstRange().range,t=getFirstRange().sel;if(e&&0<e.toString().length)if(e.startContainer==e.endContainer&&3==e.startContainer.nodeType){var n=e.startOffset,r=e.endOffset,i=e.cloneRange(),s=_iframeDoc.createElement("dextmark");s.setAttribute("class","dextmark"),e.collapse(!0),e.insertNode(s),e.selectNode(s),e.setStartAfter(s),e.setEndAfter(s),e.setStart(s.nextSibling,r-n),e.setEnd(s.nextSibling,r-n);var o=_iframeDoc.createElement("dextmark");o.setAttribute("class","dextmark"),e.insertNode(o)}else i=e.cloneRange(),o=_iframeDoc.createElement("dextmark"),o.setAttribute("class","dextmark"),e.collapse(!1),e.insertNode(o),t.removeAllRanges(),t.addRange(i),e=getFirstRange().range,s=_iframeDoc.createElement("dextmark"),s.setAttribute("class","dextmark"),e.collapse(!0),e.insertNode(s);else n=e.startOffset,r=e.endOffset,e.cloneRange(),s=_iframeDoc.createElement("dextmark"),s.setAttribute("class","dextmark"),e.collapse(!0),e.insertNode(s),e.selectNode(s),e.setStartAfter(s),s.nextSibling&&1!=s.nextSibling.nodeType&&(e.setEndAfter(s),e.setStart(s.nextSibling,r-n),e.setEnd(s.nextSibling,r-n)),o=_iframeDoc.createElement("dextmark"),o.setAttribute("class","dextmark"),e.insertNode(o)}catch(u){removeDextMarkInFrame()}}function setRangeSelectionMarkInDesign(e){try{_iframeDoc.body.innerHTML.match(/<dextmark ([^>]+)><\/dextmark>/i);var t=getElementsByClass("dextmark",_iframeDoc,"dextmark"),n=t.length;if(0<n){var r,i,s=!0;1==n?(r=t[0],i=t[0]):2==n&&(s=!1,r=t[0],i=t[1]),setTimeout(function(){var o=getFirstRange().range;getFirstRange(),o.setStartAfter(r),o.setEndBefore(i),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(o);try{var u=o.startContainer;3==u.nodeType&&(u=u.parentNode),setMenuIconRealable(u)}catch(l){}for(u=n-1;0<=u;u--){var h=t[u];h.parentNode.removeChild(h)}t=_iframeDoc.getElementsByTagName("/dextmark"),n=t.length;for(u=n-1;0<=u;u--){var h=t[u],p=h.parentNode;p.removeChild(h),DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&1==n&&("P"==p.tagName||"SPAN"==p.tagName)&&""==p.innerHTML&&(p.innerHTML=unescape("%uFEFF"),doSetCaretPosition(p,!0))}u=null,0==DEXTTOP.DEXT5.browser.ie&&(u=getFirstRange().range);var v=o.startContainer,o=function(){if(0==!!e){var t=getSelectionCoords(_iframeWin);if(t&&0!=t.x&&0!=t.y){var n=getClientRect(_iframeDoc.body),r=0,i=t.y;t.x>=n.right-n.left&&(r=t.x),_iframeWin.scroll(r,i)}else t=getElementOffset(v),_iframeWin.scroll(t.left,t.top)}};s?"BODY"==v.tagName?setFocusChildForStyle(v):o():o(),u&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(u))},0)}}catch(o){removeDextMarkInFrame()}}function makeRangeSelectionMarkInSource(e){try{var t=e.value,n,r,i='<dextmark class="dextmark"></dextmark>',s=e.value.match(/<dextmark class=(.+?)><\/dextmark>/i);null!=s&&(i=s[0]),n=r=i;if(document.selection){e.focus();var o=document.selection.createRange(),u=o.text,a=u.indexOf("<"),f=u.indexOf(">");-1<f&&(a>f||-1==a)&&o.moveStart("character",f+1),a=f=-1,a=u.lastIndexOf("<"),f=u.lastIndexOf(">"),-1<a&&(a>f||-1==f)&&o.moveEnd("character",-(u.length-a));var l=o.duplicate();if(preCheckSpecialCharTextAreaOld(l))return;o=checkSpecialCharTextAreaOldIE(o),u=o.text,o.text=n+u,""!=u&&(o.text+=r)}else if(e.selectionStart||"0"==e.selectionStart){var c=e.selectionStart,h=e.selectionEnd,p=e.value.substring(0,c),d=e.value.substring(c,h),v=e.value.substring(h,e.value.length),a=d.indexOf("<"),f=d.indexOf(">");-1<f&&(a>f||-1==a)&&(c+=f+1),a=f=-1,a=d.lastIndexOf("<"),f=d.lastIndexOf(">"),-1<a&&(a>f||-1==f)&&(h-=d.length-a);if(preCheckSpecialCharTextArea(e))return;p=e.value.substring(0,c),d=e.value.substring(c,h),v=e.value.substring(h,e.value.length);if(""==d){var m=checkSpecialCharTextArea(p,v);0<m&&(c-=m,h-=m)}else m=checkSpecialCharTextArea(p,d),0<m&&(c-=m),m=0,m=checkSpecialCharTextArea(d,v),0<m&&(h-=m);p=e.value.substring(0,c),d=e.value.substring(c,h),v=e.value.substring(h,e.value.length),e.value=p+n+d,e.value=c!=h?e.value+(r+v):e.value+v}var g=document.createElement("div");g.innerHTML=e.value,0==RegExp("<dextmark[^>]+class=.*?dextmark.*?></dextmark>","gi").test(g.innerHTML)&&(e.value=t)}catch(y){e.value=removeDextMarkInString(e.value)}}function preCheckSpecialCharTextArea(e){var t=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],n=!1,r=e.selectionStart,i=e.selectionEnd,s=e.value.substring(0,r),r=e.value.substring(r,i);e=e.value.substring(i,e.value.length),i=s.lastIndexOf("<"),s=s.lastIndexOf(">");if(i>=s)return!0;s=e.lastIndexOf(">"),e=e.lastIndexOf("<");if(s<e&&-1<s)return!0;r=r.toLowerCase();if(""!=r&&-1==r.indexOf("&")&&-1==r.indexOf(";")&&4>=r.length)for(s=0;s<t.length;s++)if(-1<t[s].indexOf(r)){n=!0;break}return n}function preCheckSpecialCharTextAreaOld(e){var t=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],n=!1,r=e.duplicate(),i=e.text,i=ReplaceAll(i,unescape("\r"),""),i=i.toLowerCase();e.moveEnd("character",-i.length);for(var s=1;1e4>=s;s++){e.moveStart("character",-s);var o=e.text;if(/>\s*</.test(o))return r.duplicate(),!0;if(-1<o.lastIndexOf(">"))break;if(-1<o.lastIndexOf("<"))return r.duplicate(),!0}e=r.duplicate(),e.moveStart("character",i.length);for(s=1;1e4>=s;s++){e.moveEnd("character",s),o=e.text;if(/>\s*</.test(o))return r.duplicate(),!0;if(-1<o.lastIndexOf("<"))break;if(-1<o.lastIndexOf(">"))return r.duplicate(),!0}if(""!=i&&-1==i.indexOf("&")&&-1==i.indexOf(";")&&4>=i.length)for(e=t.length,s=0;s<e;s++)if(-1<t[s].indexOf(i)){n=!0;break}return r.duplicate(),n}function checkSpecialCharTextArea(e,t){var n=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],r=0;e=e.toLowerCase(),t=t.toLowerCase();var i=e.split("&");if(1>=i.length)return r;var s=t.split(";");if(1>=s.length)return r;for(var o=!1,u="",u="&"+i[i.length-1]+s[0]+";",s=0;s<n.length;s++)if(n[s]==u){o=!0;break}return o&&(r=i[i.length-1].length+1),r}function checkSpecialCharTextAreaOldIE(e){var t=e.duplicate(),n=e.text,n=ReplaceAll(n,unescape("\r"),"");e.moveStart("character",-7),e.moveEnd("character",-n.length);var r=e.text;e=t.duplicate(),e.moveStart("character",n.length),e.moveEnd("character",7);var i=e.text;return e=t.duplicate(),t=checkSpecialCharTextArea(r,n),0<t&&e.moveStart("character",-t),t=checkSpecialCharTextArea(n,i),0<t&&e.moveEnd("character",-t),e}function setRangeSelectionMarkInSource(e){try{var t=e.value,n='<dextmark class="dextmark"></dextmark>',r=t.match(/<dextmark ([^>]+)><\/dextmark>/i);null!=r&&(n=r[0]);var t=ReplaceAll(t,unescape("\r"),""),i,s;i=s=0;var o=t.indexOf(n);if(-1!=o){i=o;var t=t.replace(n,""),u=t.indexOf(n,i);-1!=u&&(s=u,t=t.replace(n,""),1<t.split(/^\s/g).length&&(t=t.replace(/^\s/g,""),--i),e.value=t,setTimeout(function(){e.focus();if(i==s)if(e.createTextRange){var t=e.createTextRange();t.move("character",i),t.select()}else e.selectionStart?setTimeout(function(){window.focus(),e.focus(),e.setSelectionRange(i,i)},1):e.focus();else"setSelectionRange"in e?setTimeout(function(){window.focus(),e.focus(),e.setSelectionRange(i,s)},1):(t=e.createTextRange(),t.collapse(!0),t.moveEnd("character",s),t.moveStart("character",i),e.focus(),t.select());if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)window.focus(),document.body.focus(),e.focus();if(DEXTTOP.DEXT5.browser.ie&&9<=DEXTTOP.DEXT5.browser.ieVersion&&i!=s||!DEXTTOP.DEXT5.browser.ie&&!DEXTTOP.DEXT5.browser.gecko){var t=e.value.substr(0,i),t=t.replace(/&/gi,"&amp;"),t=t.replace(/</gi,"&lt;"),t=t.replace(/>/gi,"&gt;"),t=t.replace(/\t/gi,"<tempTab>"),t=t.replace(/<tempTab>/gi,"	"),n=document.createElement("div"),r="";"2"==DEXTTOP.G_CURREDITOR._config.sourceViewtype&&(r='style="word-wrap: break-word; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-break: normal;"'),n.innerHTML="<pre "+r+"></pre>",n=n.firstChild,n.style.width=DEXTTOP.G_CURREDITOR._config.style.width,n.style.height="auto",n.style.fontSize=e.style.fontSize,n.style.fontFamily=e.style.fontFamily,document.body.appendChild(n),n.innerHTML="&lt;test&gt;";var o=getClientRect(n),r=o.bottom-o.top;n.innerHTML=t,o=getClientRect(n),t=o.bottom-o.top,t-=r,0>t&&(t=0),document.body.removeChild(n),n=null,e.scrollTop=t}},0))}}catch(a){e.value=removeDextMarkInString(e.value)}}function removeDextMarkInFrame(e){e=e?e:_iframeDoc;for(var t=e.getElementsByTagName("dextmark"),n=t.length,n=n-1;0<=n;n--)t[n].parentNode.removeChild(t[n]);t=e.getElementsByTagName("/dextmark"),n=t.length;for(--n;0<=n;n--)t[n].parentNode.removeChild(t[n])}function removeDextMarkInString(e){return e.replace(/<dextmark ([^>]+)><\/dextmark>/ig,"")}function getSelectionCoords(e){try{e=e||window;var t=e.document,n=t.selection,r,i,s,o=0,u=0;if(n)"Control"!=n.type&&(r=n.createRange(),r.collapse(!0),o=r.boundingLeft,u=r.boundingTop);else if(e.getSelection&&(n=e.getSelection(),n.rangeCount&&(r=n.getRangeAt(0).cloneRange(),r.getClientRects&&(r.collapse(!0),i=r.getClientRects(),0<i.length&&(s=i[0]),s?(o=s.left,u=s.top):u=o=0),0==o&&0==u))){var a=t.createElement("span");if(a.getClientRects){a.appendChild(t.createTextNode("\u200b")),r.insertNode(a),s=a.getClientRects()[0];var o=s.left,u=s.top,f=a.parentNode;f.removeChild(a),f.normalize()}}return{x:o,y:u}}catch(l){}}function setRemoveClass(e,t){if(checkIfIncluded("editor_layout.css")){for(var n=DEXTTOP.G_CURREDITOR.remove_item.length,r=0;r<n;r++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[r])return;for(var n=t.length,i=!1,s=_iframeDoc.body.innerHTML,r=0;r<n;r++)if(-1<s.indexOf(t[r])){i=!0;break}if(i)for(i=e.length,r=0;r<i;r++)for(var s=_iframeDoc.getElementsByTagName(e[r]),o=s.length,u=0;u<o;u++)for(var a=0;a<n;a++){var f=new RegExp("(\\s|^)"+t[a]+"(\\s|$)");f.test(s[u].className)&&(s[u].className=DEXTTOP.DEXT5.util.trim(s[u].className.replace(f," "))),""==DEXTTOP.DEXT5.util.trim(s[u].className)&&s[u].removeAttribute("class")}}}function setAddClass(e,t){if(checkIfIncluded("editor_layout.css")){for(var n=DEXTTOP.G_CURREDITOR.remove_item.length,r=0;r<n;r++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[r])return;n=e.length;for(r=0;r<n;r++)for(var i=_iframeDoc.getElementsByTagName(e[r]),s=i.length,o=0;o<s;o++)for(var u=t.length,a=0;a<u;a++)(new RegExp("(\\s|^)"+t[a]+"(\\s|$)")).test(i[o].className)||(i[o].className+=" "+t[a],i[o].className=DEXTTOP.DEXT5.util.trim(i[o].className))}}function checkIfIncluded(e,t){var n;n=void 0==t?_iframeDoc.getElementsByTagName("link"):t.getElementsByTagName("link");for(var r=0;r<n.length;r++)if(-1<n[r].href.indexOf(e))return!0;return!1}function getDirectionNode(e,t,n,r){e=[],n=GetTDTHCell(n),t=GetTableSelectionCells();if(null==n&&0==t.length){t=",body,";var i=r.length;for(n=0;n<i;n++)null!=r[n]&&null!=r[n].parentNode&&void 0!=r[n].parentNode.tagName&&-1<t.indexOf(","+r[n].parentNode.tagName.toLowerCase()+",")&&-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+r[n].tagName.toLowerCase()+",")&&e.push(r[n])}else if(null!=n&&0==t.length)for(t=",th,td,",i=r.length,n=0;n<i;n++)null!=r[n]&&null!=r[n].parentNode&&void 0!=r[n].parentNode.tagName&&-1<t.indexOf(","+r[n].parentNode.tagName.toLowerCase()+",")&&(null==r[n].firstChild?e.push(r[n].parentNode):-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+r[n].tagName.toLowerCase()+",")?e.push(r[n]):void 0==r[n].firstChild.tagName?e.push(r[n].parentNode):e.push(r[n]));else if(null!=n&&0<t.length)for(n=0;n<t.length;n++){r=t[n].getElementsByTagName("*");for(idx2=0;idx2<r.length;idx2++)r[idx2].dir="";e.push(t[n])}return e}function CheckCommand(e,t){if("bold"==e){var n=t.getElementsByTagName("b"),r=t.getElementsByTagName("strong");return 0<n.length+r.length?!0:!1}return"italic"==e?(n=t.getElementsByTagName("em"),r=t.getElementsByTagName("i"),0<n.length+r.length?!0:!1):"underline"==e?0<t.getElementsByTagName("u").length?!0:!1:"strike_through"==e?0<t.getElementsByTagName("strike").length?!0:!1:"superscript"==e?0<t.getElementsByTagName("sup").length?!0:!1:"subscript"==e?0<t.getElementsByTagName("sub").length?!0:!1:"list_number"==e?0<t.getElementsByTagName("ol").length?!0:!1:"list_bullets"==e?0<t.getElementsByTagName("ul").length?!0:!1:!1}function officePasteCleanForTable(e){var t=document.createElement("div");t.innerHTML=e;if("1"==DEXTTOP.G_CURREDITOR._config.removeImageInPasteExcel&&(G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType||"XLS"==G_wordProcessorType)){e=t.getElementsByTagName("table");var n=e.length,r=e[0];if(0<n){for(var i=t.getElementsByTagName("img"),s=i.length-1;0<=s;s--)i[s].parentNode.removeChild(i[s]);for(s=n-1;0<=s;s--)e[s]!=r&&e[s].parentNode.removeChild(e[s])}}e=t.getElementsByTagName("table"),n=e.length;for(s=0;s<n;s++){"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&adjustTableForIEJASOBug(e[s]),"left"!=e[s].align&&"1"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"2"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||(e[s].align="",e[s].removeAttribute("align")),"fixed"==e[s].style.tableLayout&&"0px"!=e[s].style.width&&(e[s].style.removeAttribute?e[s].style.removeAttribute("table-layout"):(e[s].style.removeProperty("tableLayout"),e[s].style.removeProperty("table-layout"))),r=getPasteFormatType(),"PPT"==r&&(e[s].style.tableLayout="fixed"),i="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode;if((DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&!i||DEXTTOP.DEXT5.browser.gecko)&&"1"==DEXTTOP.G_CURREDITOR._config.removeColgroup&&"PPT"!=r&&(r=e[s].getElementsByTagName("colgroup"),i=r.length,0<i)){r=!1;try{for(var o=e[s].getElementsByTagName("td"),u=o.length,i=0;i<u;i++)if(o[i].getAttribute("width")&&""!=o[i].getAttribute("width")||""!=o[i].style.width){r=!0;break}}catch(a){r=!0}if(r)for(r=e[s].getElementsByTagName("colgroup"),i=r.length,--i;0<=i;i--)try{e[s].removeChild(r[i])}catch(f){}}for(var l=e[s].rows.length,i=0;i<l;i++){var c=e[s].rows[i],h=c.getAttribute("height"),p=c.style.height;removeAttributeForPasteTable(c);var d=c.cells.length;if(0==d)c.innerHTML="";else for(r=0;r<d;r++){var v=c.cells[r],m=v.getAttribute("rowspan"),m=null==m||void 0==m||""==m?1:parseIntOr0(m),g=v.getAttribute("height");null==h||void 0==h||"0"==h||null!=g&&void 0!=g&&""!=g||v.setAttribute("height",parseIntOr0(h)*m),g=v.style.height,null==p||void 0==p||"0px"==p||null!=g&&void 0!=g&&""!=g||(v.style.height=parseIntOr0(p)*m+"px"),1==v.childNodes.length?""!=v.childNodes[0].innerHTML&&"&nbsp;"!=v.childNodes[0].innerHTML||0!=v.innerHTML.indexOf("<p")||(v.innerHTML=getCellDefValue()):0!=v.childNodes.length||""!=v.innerHTML&&"&nbsp;"!=v.innerHTML||(v.innerHTML=getCellDefValue()),m=!1;if(G_dext5plugIn){if(1==G_dext5plugIn.getHTMLFormatFromType||4==G_dext5plugIn.getHTMLFormatFromType)m=!0}else if("DOC"==G_wordProcessorType||"HWP"==G_wordProcessorType)m=!0;if(m){var m=0,g=v.style.paddingLeft,y=v.style.paddingRight,b=v.style.width;try{if(-1<g.indexOf("px")||-1<g.indexOf("pt")||-1<g.indexOf("cm"))m++,g=DEXTTOP.DEXT5.util.replacePtOrCmToPx(g),y=DEXTTOP.DEXT5.util.replacePtOrCmToPx(y);if(-1<b.indexOf("px")||-1<b.indexOf("pt")||-1<b.indexOf("cm"))m++,b=DEXTTOP.DEXT5.util.replacePtOrCmToPx(b);2==m&&(b=parseFloat(b)-parseFloat(g)-parseFloat(y),v.getAttribute("width")&&v.setAttribute("width",b),v.style.width=b+"px")}catch(w){}}}}if(DEXTTOP.DEXT5.browser.gecko)for(""==e[s].style.borderCollapse&&(e[s].style.borderCollapse="collapse"),l=e[s].rows.length,i=0;i<l;i++)for(c=e[s].rows[i],removeAttribute(c,"width"),removeAttribute(c,"height"),removeAttribute(c,"style"),h=c.cells.length,r=0;r<h;r++)v=c.cells[r],""==v.style.borderTop&&(v.style.borderTop="1px solid #000000"),""==v.style.borderRight&&(v.style.borderRight="1px solid #000000"),""==v.style.borderBottom&&(v.style.borderBottom="1px solid #000000"),""==v.style.borderLeft&&(v.style.borderLeft="1px solid #000000"),"\u3000"==v.innerHTML&&(v.innerHTML="<p><br /></p>"),0==parseIntOr0(v.style.height)&&0==parseIntOr0(v.height)&&(v.style.height="20px");if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone)for(i=e[s].rows.length,r=0;r<i;r++)for(l=e[s].rows[r].cells.length,c=0;c<l;c++)showBorderForNoneClass(e[s].rows[r].cells[c],"dext_table_border_t"),showBorderForNoneClass(e[s].rows[r].cells[c],"dext_table_border_l"),showBorderForNoneClass(e[s].rows[r].cells[c],"dext_table_border_r"),showBorderForNoneClass(e[s].rows[r].cells[c],"dext_table_border_b")}return e=t.innerHTML}function checkExistCustomData(e){var t="",t=_iframeDoc.createElement("div");t.innerHTML=e,e=t.getElementsByTagName("img");for(var n=!1,r=e.length-1;0<=r;r--){var i=e[r].getAttribute("dext5customdata");null!=i&&void 0!=i&&(i=getDextCustomData(i),null==i||void 0==i)&&(n=e[r].parentNode,n.removeChild(e[r]),""==n.innerHTML&&(n.innerHTML="&nbsp;"),n=!0)}return n&&alert(dext5_lang.msg.checkCustomData),""==t.innerHTML&&(t.innerHTML="&nbsp"),t=t.innerHTML}function getEditorFrameDoc(e){return setDEXTWINDOC(),e=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+e.ID),getIframeDocument(e)}function getMyFirstOrLastChildElementNode(e,t){try{var n=!1;1==t&&(n=!0);if(3==e.nodeType)return e.parentNode;var r="nextSibling",i="firstChild";n&&(r="previousSibling",i="lastChild");for(var s=e;null!=s.childNodes&&0<s.childNodes.length;)if(s=s[i],3==s.nodeType||8==s.nodeType){if(!(3!=s.nodeType||""==s.data&&"BODY"==s.parentNode.tagName||""==textCheckInString(s.data)&&""!=s.data.replace(/ /,"")))return s.parentNode;s=s[r]}else{if("P"==s.tagName){for(r=s;r[i];){if(r.tagName&&-1<",SPAN,A,U,B,I,STRONG,STRIKE,SUB,SUP,".indexOf(","+r.tagName+",")&&r[i]&&(3==r[i].nodeType||1==r[i].nodeType&&"BR"==r[i].tagName)){s=r;break}r=r[i],n&&r&&"BR"==r.tagName&&r.previousSibling&&(r=r.previousSibling)}return s}if("BR"==s.tagName||"IMG"==s.tagName)return s.parentNode;if("TABLE"==s.tagName){var o=null;if(n)var u=s.getElementsByTagName("td"),o=u[u.length-1];else o=s.getElementsByTagName("th")[0]?s.getElementsByTagName("th")[0]:s.getElementsByTagName("td")[0];return getMyFirstOrLastChildElementNode(o,n)}if("OL"==s.tagName||"UL"==s.tagName)return o=null,u=s.getElementsByTagName("li"),o=n?u[u.length-1]:u[0],getMyFirstOrLastChildElementNode(o,n);if("STYLE"==s.tagName){o=null;for(o=s[r];null!=o;){if(1==o.nodeType){s=o;break}o=o[r]}if(null==o||3==o.nodeType)return _iframeDoc.body}}return 1==s.nodeType&&s.parentNode&&"BODY"!=s.parentNode.tagName?s:null}catch(a){return null}}function setFocusChildForStyle(e,t){var n=!1;1==t&&(n=!0);var r=getMyFirstOrLastChildElementNode(e,n);if(null==r)setFocusToBody();else{t=0,1==n&&(t=1);var i=function(e,t){var n=!0;if(1==t){e.lastChild&&"BR"==e.lastChild.tagName&&(e=e.lastChild,n=!1);try{_iframeWin.scrollTo(0,_iframeDoc.body.scrollHeight)}catch(r){}}if(n){doSetCaretPosition(e,t);try{"design"==DEXTTOP.G_CURREDITOR.getEditorMode()&&setMenuIconRealable(e)}catch(i){}}else{var s=getFirstRange(),n=s.range,s=s.sel;n.setStartBefore(e),n.setEndBefore(e),s.removeAllRanges(),s.addRange(n);try{setMenuIconRealable(n.startContainer)}catch(o){}}};if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){for(var n=e.childNodes,s=n.length,o=!0,u=0;u<s;u++)if(1==n[u].nodeType&&-1<",p,h1,h2,h3,h4,h5,h6,pre,b,big,i,small,strong,span,sub,sup,u,s,strike,".indexOf(","+n[u].tagName.toLowerCase()+",")){i(n[u],t),setMenuIconRealable(n[u]),o=!1;break}if(o){n=e.lastChild;if(3==n.nodeType||"table"==n.tagName.toLowerCase())n=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?n.innerHTML="&nbsp;":(s=_iframeDoc.createElement("br"),n.appendChild(s)),e.appendChild(n);i(n,t),setMenuIconRealable(n)}}else"TEXTAREA"==r.tagName?setFocusToBody():(setTimeout(function(){i(r,t)},2),setMenuIconRealable(r))}}function repairPasteTextInCell(e){if(0==DEXTTOP.DEXT5.browser.ie||DEXTTOP.G_CURREDITOR.AccessClipboardForIEGecko||6!=G_dext5plugIn.getHTMLFormatFromType)return e;var t=e,n=e.substring(0,6);if("<TABLE"==n||"<table"==n){if(getFirstRange(),n=document.createElement("div"),n.innerHTML=e,1==n.childNodes.length&&1==n.childNodes[0].nodeType&&"TABLE"==n.childNodes[0].tagName){e=n.getElementsByTagName("td");if(1==e.length){var t=e[0].innerHTML,r=e[0].childNodes,i=e[0].getElementsByTagName("p");1==i.length&&r[0]&&1==r[0].nodeType&&"P"==r[0].tagName&&(t=r[0].innerHTML)}0==e.length&&(e=n.getElementsByTagName("th"),1==e.length&&(t=e[0].innerHTML,r=e[0].childNodes,i=e[0].getElementsByTagName("p"),1==i.length&&r[0]&&1==r[0].nodeType&&"P"==r[0].tagName&&(t=r[0].innerHTML)))}}else n=e.toLowerCase(),-1<n.indexOf("starthtml")&&-1<n.indexOf("startfragment")&&-1<n.indexOf("<body ")&&-1<n.indexOf("</body")&&(n="<BODY",-1==e.indexOf(n)&&(n="<body"),t="</BODY>",-1==e.indexOf(t)&&(t="</body>"),e=e.substring(e.indexOf(n)),e=e.substring(e.indexOf(">")+1),t=e=e.substring(0,e.indexOf(t)));return t}function findParentNode(e,t){var n=t.parentNode;if("HTML"==n.tagName||"BODY"==n.tagName)return!1;for(;"BODY"!=n.tagName;){if(n==e)return!0;n=n.parentNode}return!1}function executeTextAlign(e,t){var n=null,n=DEXTTOP.DEXT5.browser.ie?getElementsFromSelection():getNodesInRange(e),r=GetTDTHCell(e.startContainer);if(null!=r)for(var i=n,s=i.length,n=[],o=0;o<s;o++)1==findParentNode(r,i[o])&&n.push(i[o]);r=n.length,i=chkAlign="",i=null;for(o=0;o<r;o++)if(i=n[o].nodeName.toLowerCase(),"p"==i||"div"==i)chkAlign="justifyFull"==t?"justify":t.substring(7).toLowerCase(),i=n[o],i.style.textAlign!=chkAlign&&(i.style.textAlign=chkAlign)}function removeNbspInPTag(e){try{if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion){var t=e._BODY.childNodes,n=t.length;for(e=0;e<n;e++){var r=t[e];1==r.nodeType&&-1<",p,h1,h2,h3,h4,h5,".indexOf(","+r.tagName.toLowerCase()+",")&&"&nbsp;"==r.innerHTML&&(r.innerHTML="")}}}catch(i){}}function _iframeDoc_OnDropOver(e){DEXTTOP.DEXT5.util.cancelEvent(e)}function _iframeDoc_DragStart(e){"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&DEXTTOP.DEXT5.util.cancelEvent(e);try{if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.drag_event&&(DEXTTOP.DEXT5.config.DragEventCancel=!1,"function"==typeof DEXTTOP.G_CURREDITOR._config.event.drag?DEXTTOP.G_CURREDITOR._config.event.drag("dragstart",e):DEXTTOP.DEXTWIN.dext_drag_event("dragstart",e),1==DEXTTOP.DEXT5.config.DragEventCancel)){DEXTTOP.DEXT5.util.cancelEvent(e);return}}catch(t){}dragMoveStart(e)}function getElementsFromSelection(e){function t(e){var t=null;return e.parentElement?t=e.parentElement():e.commonAncestorContainer?t=e.commonAncestorContainer:e.commonParentElement&&(t=e.commonParentElement()),t}function n(e,t){var n=null;return e.compareEndPoints?n={method:"compareEndPoints",StartToStart:"StartToStart",StartToEnd:"StartToEnd",EndToEnd:"EndToEnd",EndToStart:"EndToStart"}:e.compareBoundaryPoints&&(n={method:"compareBoundaryPoints",StartToStart:0,StartToEnd:1,EndToEnd:2,EndToStart:3}),n&&!(1==t[n.method](n.StartToStart,e)&&1==t[n.method](n.EndToEnd,e)&&1==t[n.method](n.StartToEnd,e)&&1==t[n.method](n.EndToStart,e)||-1==t[n.method](n.StartToStart,e)&&-1==t[n.method](n.EndToEnd,e)&&-1==t[n.method](n.StartToEnd,e)&&-1==t[n.method](n.EndToStart,e))}function r(e){var t=null;return DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion?_iframeDoc.body.createTextRange?(t=_iframeDoc.body.createTextRange(),t.moveToElementText(e)):_iframeDoc.createRange&&(t=_iframeDoc.createRange(),t.selectNodeContents(e)):_iframeDoc.createRange?(t=_iframeDoc.createRange(),t.selectNodeContents(e)):_iframeDoc.body.createTextRange&&(t=_iframeDoc.body.createTextRange(),t.moveToElementText(e)),t}var i=null,s=[],o,u;e||(e="body");if(u=function(){var e=null;return _iframeWin.getSelection?(e=_iframeWin.getSelection())&&e.rangeCount&&e.getRangeAt&&(e=e.getRangeAt(0)):_iframeDoc.selection&&(e=_iframeDoc.selection.createRange()),e}())if(o=t(u)){for(;1!=o.nodeType;)o=o.parentNode;if(o.nodeName.toLowerCase()!=e.toString()){i=o;do i=i.parentNode,s[s.length]=i;while(i.nodeName.toLowerCase()!=e.toString())}i=o.all||o.getElementsByTagName("*");for(e=0;e<i.length;e++)s[s.length]=i[e];i=[o];for(o=0;o<s.length;o++)(e=r(s[o]))&&n(u,e)&&(i[i.length]=s[o])}return i}function checkCopyInCellFormInertnNet(e){var t="";if(DEXTTOP.DEXT5.browser.ie&&/body[^>]*>(\s+)*<div *([^>])*>/i.test(e)){var n=e.indexOf("<!--StartFragment-->"),r=e.lastIndexOf("<!--EndFragment-->");-1<n&&-1<r&&(e=e.substr(n+20),r=e.lastIndexOf("<!--EndFragment-->"),-1<r&&(t=e=e.substring(0,r)))}return t}function setGlobalTableDefaultValue(){try{ActiveLastTable=ActiveCurrTable=DrageEndCell=DrageStartCell=null}catch(e){}}function fn_IEJASOBug(e){if("0"!=e._config.ie11_BugFixed_JASO)try{var t=e._DOC;if("1"==e._config.ie11_BugFixed_JASO){for(var n=t.getElementsByTagName("table"),r=n.length,i=0;i<r;i++)adjustTableForIEJASOBug(n[i]);n=t.getElementsByTagName("p"),r=n.length;for(i=0;i<r;i++)endBrForIEJASOBug(n[i])}else if("2"==e._config.ie11_BugFixed_JASO)for(n=t.getElementsByTagName("table"),r=n.length,i=0;i<r;i++)if("left"==n[i].align||"1"==e._config.ie11_BugFixed_DeleteTableAlign){if("1"==e._config.ie11_BugFixed_ReplaceAlignMargin&&("center"==n[i].align||"right"==n[i].align)){var s=getReplaceAlignMargin(e,n[i]);0!=s&&(n[i].style.marginLeft=s+"px")}n[i].align="",n[i].removeAttribute("align")}}catch(o){}}function replaceBrTag(e){if("1"==e._config.wrapPtagToSource||"2"==e._config.wrapPtagToSource)try{var t=e._DOC,n=e._BODY,r=n.childNodes;for(i=r.length-1;0<=i;i--){var s=r[i];if(1==s.nodeType&&"BR"==s.tagName&&(null==s.previousSibling||s.previousSibling&&3!=s.previousSibling.nodeType)){var o=t.createElement("p");n.insertBefore(o,s),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?(o.innerHTML="&nbsp;",n.removeChild(s)):o.appendChild(s)}}}catch(u){}}function showImageEditor(){if(G_dext5plugIn){setFocusTopWindow();var e=G_dext5plugIn.setScreenCapture(1);""!=e?(dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertNodeLikePasteHtml(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):dialogCancel()}}function checkCanPasteToIamge(){var e=!1;try{G_dext5plugIn&&1==G_dext5plugIn.canPasteImageFromClipBoard()&&(e=!0)}catch(t){e=!1}return e}function removeEmptySpanBRTag(e){if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&e.childNodes)for(var t=e.childNodes.length,n=0;n<t;n++){var r=e.childNodes[n];if(1===r.nodeType&&"p"==r.tagName.toLowerCase()){var i=r.innerHTML;if(""==(r.innerText||r.textContent))for(;;){var s=RegExp("<span[^>]*>(?:\\s|<br>|<br />|  | |)(</span>)","gim"),i=i.replace(s,"$1"+unescape("%u200B")+"</span>");if(0==s.test(i))break}""==i&&"1"==DEXTTOP.G_CURREDITOR._config.removeEmptyTagReplaceDefaultParagraphValue&&(i=DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br />",r.innerHTML=i)}}}function wrapPtagForNotBlockTag(e){if("1"==e._config.wrapPtagToSource||"2"==e._config.wrapPtagToSource)try{for(var t=e._BODY.innerHTML,n=e._BODY.childNodes,r=[],i=n.length-1;0<=i;i--){if(n[i].tagName&&checkBlockTag(n[i].tagName)){if(0<r.length){for(var s=_iframeDoc.createElement("p"),o=r.length-1;0<=o;o--)s.appendChild(r[o]),n[i].nextSibling?_iframeDoc.body.insertBefore(s,n[i].nextSibling):_iframeDoc.body.appendChild(s);r=[]}}else if(3==n[i].nodeType){var u=n[i].data;"0"==e._config.keepOriginalHtml&&(u=u.replace(/\r\n/,"\n"),u=u.replace(/^\n/,""),u=u.replace(/\n$/,""),n[i].data=u),u=textCheckInString(u),""!=u&&r.push(n[i])}else if(8!=n[i].nodeType){var a=",li,";""!=e._config.wrapPtagSkipTag&&(a+=e._config.wrapPtagSkipTag+",");var f=n[i].tagName?n[i].tagName:"",f=f.toLowerCase();0>a.indexOf(","+f+",")&&r.push(n[i])}if(0==i&&0<r.length){s=_iframeDoc.createElement("p");for(o=r.length-1;0<=o;o--)s.appendChild(r[o]),_iframeDoc.body.insertBefore(s,_iframeDoc.body.firstChild);r=[]}if(n[i].tagName&&"P"==n[i].tagName){try{"<p>"==n[i].outerHTML.toLowerCase()&&(n[i].outerHTML="<p></p>")}catch(l){}var c=void 0!=n[i].innerText?n[i].innerText:n[i].textContent,c=c.replace(/\r\n/gi,""),c=c.replace(/\r/gi,""),c=c.replace(/\n/gi,""),a=!1;try{-1<n[i].innerHTML.toLowerCase().indexOf("<dextmark")&&(a=!0)}catch(h){}if(""==c&&!a&&"1"==e._config.removeEmptyTag){for(var p=n[i].innerHTML,a="(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>",d=new RegExp(a,"gim"),p=p.replace(d,"$1"+unescape("%u200B")+"</span>");a="<span[^>]*>(?:\\s|<br>|<br />|  | |)</span>","0"==e._config.removeEmptyTagReplaceDefaultParagraphValue&&(a="<span[^>]*>(?:\\s|  | |)</span>"),d=new RegExp(a,"gim"),p=p.replace(d,""),0!=d.test(p););a="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>",d=new RegExp(a,"gim");for(p=p.replace(d,"$1</span>");a="<font[^>]*>(?:\\s|<br>|<br />|  | |)</font>",d=new RegExp(a,"gim"),p=p.replace(d,""),0!=d.test(p););p=CleanZeroChar(p),""==p&&"1"==e._config.removeEmptyTagReplaceDefaultParagraphValue&&(p=getDefaultParagraphValue(!1)),n[i].innerHTML=p}}}}catch(v){e._BODY.innerHTML=t}}function checkBlockTag(e){if(void 0!=e&&""!=e){var t=!1,n="p div table ol ul hr h1 h2 h3 h4 h5 h6 dl blockquote iframe pre xmp c:if c:choose c:foreach c:set script style center dextmark /dextmark figure figcaption nav section article".split(" "),r=n.length;e=e.toLowerCase();for(var i=0;i<r;i++)if(n[i]==e){t=!0;break}return t}}function checkExistClassName(e,t){for(var n=e.split(" "),r=n.length,i=!1,s=0;s<r;s++)if(n[s]==t){i=!0;break}return i}function setClassName(e,t){for(var n=t,r=e.className,i=!1,s=r.split(" "),o=s.length,u=0;u<o;u++)if(s[u]==t){i=!0;break}0==i&&(""!=r&&(n=" "+n),e.className=r+n)}function removeClassName(e,t){var n=t,r=e.className;0<r.indexOf(n)&&(n=" "+n),r=r.replace(n,""),""==r?e.getAttribute("class")?e.removeAttribute("class"):e.removeAttribute("className"):e.className=r}function showBorderForNoneClass(e,t){if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone){if(""!=DEXTTOP.DEXT5.util.trim(DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipClass))for(var n=DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipClass.split(","),r=n.length,i=0;i<r;i++)if(checkExistClassName(e.className,n[i]))return;if(""!=DEXTTOP.DEXT5.util.trim(DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipAttribute))for(n=DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipAttribute.split(","),i=0;i<r;i++)if(e.getAttribute(n[i])&&""!=e.getAttribute(n[i]))return;i="";switch(t){case"dext_table_border_b":i="Bottom";break;case"dext_table_border_t":i="Top";break;case"dext_table_border_l":i="Left";break;case"dext_table_border_r":i="Right"}r=checkExistClassName(e.className,t),""==e.style["border"+i+"Width"]&&""==e.style["border"+i+"Style"]?(i=e.parentNode.parentNode.parentNode,!r&&(""==i.border||0>=parseInt(i.border))&&setClassName(e,t)):-1<e.style["border"+i+"Width"].indexOf("0")&&0==parseFloat(e.style["border"+i+"Width"])||"none"==e.style["border"+i+"Style"]?r||setClassName(e,t):r&&removeClassName(e,t)}}function setBorderTableAndAllCell(e,t){for(var n=e.rows.length,r=0;r<n;r++)for(var i=e.rows[r],s=i.cells.length,o=0;o<s;o++){var u=i.cells[o];0==o&&(""!=t.outsideLeft&&(u.style.borderLeft=t.outsideLeft,showBorderForNoneClass(u,"dext_table_border_l")),o!=s-1&&""!=t.insideCol&&(u.style.borderRight=t.insideCol,showBorderForNoneClass(u,"dext_table_border_r")),""!=t.insideRow&&(0==r&&r!=n-1&&(u.style.borderBottom=t.insideRow,showBorderForNoneClass(u,"dext_table_border_b")),0<r&&r==n-1&&(u.style.borderTop=t.insideRow,showBorderForNoneClass(u,"dext_table_border_t")),0<r&&r!=n-1&&(u.style.borderTop=t.insideRow,showBorderForNoneClass(u,"dext_table_border_t"),u.style.borderBottom=t.insideRow,showBorderForNoneClass(u,"dext_table_border_b")))),o==s-1&&(""!=t.outsideRight&&(u.style.borderRight=t.outsideRight,showBorderForNoneClass(u,"dext_table_border_r")),0!=o&&""!=t.insideCol&&(u.style.borderLeft=t.insideCol,showBorderForNoneClass(u,"dext_table_border_l")),""!=t.insideRow&&(0==r&&r!=n-1&&(u.style.borderBottom=t.insideRow,showBorderForNoneClass(u,"dext_table_border_b")),0<r&&r==n-1&&(u.style.borderTop=t.insideRow,showBorderForNoneClass(u,"dext_table_border_t")),0<r&&r!=n-1&&(u.style.borderTop=t.insideRow,showBorderForNoneClass(u,"dext_table_border_t"),u.style.borderBottom=t.insideRow,showBorderForNoneClass(u,"dext_table_border_b")))),0<o&&o!=s-1&&""!=t.insideCol&&(u.style.borderLeft=t.insideCol,showBorderForNoneClass(u,"dext_table_border_l"),u.style.borderRight=t.insideCol,showBorderForNoneClass(u,"dext_table_border_r")),0==r&&(""!=t.outsideTop&&(u.style.borderTop=t.outsideTop,showBorderForNoneClass(u,"dext_table_border_t")),r!=n-1&&""!=t.insideRow&&(u.style.borderBottom=t.insideRow,showBorderForNoneClass(u,"dext_table_border_b"))),r==n-1&&(""!=t.outsideBottom&&(u.style.borderBottom=t.outsideBottom,showBorderForNoneClass(u,"dext_table_border_b")),0!=r&&""!=t.insideRow&&(u.style.borderTop=t.insideRow,showBorderForNoneClass(u,"dext_table_border_t"))),0<r&&r!=n-1&&0<o&&o!=s-1&&(""!=t.insideRow&&(u.style.borderTop=t.insideRow,showBorderForNoneClass(u,"dext_table_border_t"),u.style.borderBottom=t.insideRow,showBorderForNoneClass(u,"dext_table_border_b")),""!=t.insideCol&&(u.style.borderLeft=t.insideCol,showBorderForNoneClass(u,"dext_table_border_l"),u.style.borderRight=t.insideCol,showBorderForNoneClass(u,"dext_table_border_r")))}}function replaceClassForBorder(e,t,n){var r=["dext_table_border_t","dext_table_border_r","dext_table_border_b","dext_table_border_l"];if("0"!=e._config.showLineForBorderNone&&"show"==n){var i=t.getElementsByTagName("table"),s=i.length;for(e=0;e<s;e++)for(var o=i[e].rows.length,u=0;u<o;u++)for(var a=i[e].rows[u].cells.length,f=0;f<a;f++){var l=i[e].rows[u].cells[f].className,l=l.replace("_"+r[0],""),l=l.replace("_"+r[1],""),l=l.replace("_"+r[2],""),l=l.replace("_"+r[3],""),l=l.replace(r[0],""),l=l.replace(r[1],""),l=l.replace(r[2],""),l=l.replace(r[3],""),l=DEXTTOP.DEXT5.util.trim(l);if(""==l){if(i[e].rows[u].cells[f].getAttribute("class")?i[e].rows[u].cells[f].removeAttribute("class"):i[e].rows[u].cells[f].removeAttribute("className"),""!=i[e].rows[u].cells[f].className||i[e].rows[u].cells[f].className!=l)i[e].rows[u].cells[f].className=""}else i[e].rows[u].cells[f].className!=l&&(i[e].rows[u].cells[f].getAttribute("class")?i[e].rows[u].cells[f].setAttribute("class",l):i[e].rows[u].cells[f].setAttribute("className",l),i[e].rows[u].cells[f].className!=l&&(i[e].rows[u].cells[f].className=l));showBorderForNoneClass(i[e].rows[u].cells[f],r[0]),showBorderForNoneClass(i[e].rows[u].cells[f],r[1]),showBorderForNoneClass(i[e].rows[u].cells[f],r[2]),showBorderForNoneClass(i[e].rows[u].cells[f],r[3])}}if("hidden"==n)for(e=0;e<r.length;e++)for(n=[],n=getElementsByClass(r[e],t),i=n.length,s=0;s<i;s++)removeClassName(n[s],r[e]),l=n[s].className,""==DEXTTOP.DEXT5.util.trim(l)?(n[s].className="",n[s].getAttribute("class")?n[s].removeAttribute("class"):n[s].removeAttribute("className")):n[s].className=DEXTTOP.DEXT5.util.trim(l)}function attachFileImage(e,t){var n="url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/",n=-1<t.file_ext.indexOf("doc")?n+"word.png":-1<t.file_ext.indexOf("ppt")?n+"ppt.png":-1<t.file_ext.indexOf("xls")?n+"excel.png":-1<t.file_ext.indexOf("hwp")?n+"hwp.png":-1<t.file_ext.indexOf("pdf")?n+"pdf.png":-1<t.file_ext.indexOf("txt")?n+"txt.png":n+"file.png";e.style.paddingLeft="22px",e.style.paddingTop="3px",e.style.paddingBottom="3px",e.style.background=n+")",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="0% 50%",e.style.lineHeight="1.4"}function replaceClassForBookmark(e,t,n){e=e._contentsClass;for(var r=e.length,i=0;i<r;i++){var s=[];"hidden"==n?s=getElementsByClass(e[i],t):"show"==n&&(s=getElementsByClass("_"+e[i],t));for(var o=s.length,u=0;u<o;u++){var a=s[u].className;"hidden"==n?a=a.replace(e[i],"_"+e[i]):"show"==n&&(a=a.replace("_"+e[i],e[i])),s[u].className=a}}}function removeIncorrectSpaceInTag(e){var t=e;if("1"==DEXTTOP.G_CURREDITOR._config.removeSpaceInTagname)if(void 0==e||""==e)t="";else try{var n=RegExp("<(\\s+)[a-z|/]","gi"),r=t.match(n);if(r)for(var i=r.length,s=0;s<i;s++)var o=r[s],u=/\s+/.exec(o),a=u[0].replace(RegExp("\\s","gi"),""),o=o.replace(u,a),t=t.replace(r[s],o);n=RegExp("<\\/(\\s+)[a-z]","gi");if(r=t.match(n))for(i=r.length,s=0;s<i;s++)o=r[s],u=/\s+/.exec(o),a=u[0].replace(RegExp("\\s","gi"),""),o=o.replace(u,a),t=t.replace(r[s],o)}catch(f){t=e}return t}function removeDummyfontTagInTable(e){var t=e;try{var n=RegExp("(<font ([^>]+)>\\s+</font>(s+)?)(<colgroup>)","gi");e=e.replace(n,"$4"),n=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(<tbody>)","gi"),e=e.replace(n,"$4"),n=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(<td)","gi"),e=e.replace(n,"$4"),n=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(</tr>)","gi"),e=e.replace(n,"$4"),n=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(</tbody>)","gi"),e=e.replace(n,"$4"),n=RegExp("<font ([^>]+)>\\s</font>","gi"),e=e.replace(n,"<font $1>&nbsp;</font>"),n=RegExp("<font ([^>]+)>\\s+</font>","gi"),t=e=e.replace(n,"<font $1></font>")}catch(r){}return t}function setChangeModeForSetApi(e,t){if(1!=t&&"design"!=e._currentMode){var n="design";ClearDraggingTableCellSelected(),Mouse_Status=Mouse_IsPlain,g_findRepalceRange=ActiveCurrTable=DrageStartCell=null,e._iconSelected();for(var r=null,i=["top_design","top_source","top_preview","top_text"],s=0,o=i.length;s<o;s++)r=document.getElementById("ue_"+e.ID+i[s]),null!=r&&((0>n.indexOf("top_")?"top_"+n:n)==i[s]?r.className="on":r.className="");for(var u=i=null,r=["design","source","preview","text"],n=n.replace("top_",""),s=0,o=r.length;s<o;s++)i=document.getElementById("ue_"+e.ID+r[s]),u=document.getElementById("dext5_"+r[s]+"_"+e.ID),null!=i&&(n==r[s]?(i.className=e._config.style.skinName,i.getElementsByTagName("A")[0].className="color_on",i.style.backgroundImage="url("+e._config.webPath.image+"skin/"+e._config.style.skinName+"/ue_btn_bg.gif)",u.style.height="100%",u.style.width="100%",DEXTTOP.DEXT5.browser.gecko||(u.style.display="",u.style.overflow=""),e._LastRange=null,setFocusToBody()):(i.className="",i.getElementsByTagName("A")[0].className="",i.style.backgroundImage="",u.style.width="0px",u.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(u.style.display="none",u.style.overflow="hidden"),u.blur()),i=document.getElementById("ue_diabled_div_"+e.ID),"BackCompat"==document.compatMode&&(i.style.height=document.getElementById("ue_toolbar_"+e.ID).scrollHeight+"px"),document.getElementById("ue_toolbar_"+e.ID).style.position="relative",i.style.width="design"==n?"0px":document.getElementById("ue_toolbar_"+e.ID).scrollWidth+"px");switch(e._currentMode){case"source":switch(n){case"design":ReplaceRealObjectToImage(),xssReplaceScript(_iframeDoc),setAddClass(["td","th"],["DEXT_dot"])}break;case"preview":switch(n){case"design":FixFlashError(),ReplaceRealObjectToImage(),setAddClass(["td","th"],["DEXT_dot"])}}e._currentMode=n,-1<n.indexOf("design")&&setFocusChildForStyle(e._BODY)}onChange({editor:e})}function insertElementsSrc(e,t){t&&0>t.indexOf("file:/")&&0>t.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&e.setElementsArr.push(t)}function insertImageSrc(e,t,n){if(1!=n)try{if(t)0>t.indexOf("file:/")&&0>t.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&(e.setImageArr.push(t),e.setElementsArr.push(t));else{e.setImageArr=[],e.setElementsArr=[];var r=e._DOC.getElementsByTagName("img"),i=r.length;for(t=0;t<i;t++)"1"==DEXTTOP.G_CURREDITOR._config.xss_use&&(r[t].alt&&(r[t].alt=DEXTTOP.DEXT5.util.replaceAll(r[t].alt,"<",""),r[t].alt=DEXTTOP.DEXT5.util.replaceAll(r[t].alt,">","")),r[t].title&&(r[t].title=DEXTTOP.DEXT5.util.replaceAll(r[t].title,"<",""),r[t].title=DEXTTOP.DEXT5.util.replaceAll(r[t].title,">",""))),""==r[t].style.marginRight.toString()&&""==r[t].style.marginLeft.toString()&&r[t].getAttribute("hspace")&&""!=r[t].hspace.toString()&&(r[t].style.marginLeft=r[t].hspace+"px",r[t].style.marginRight=r[t].hspace+"px",r[t].removeAttribute("hspace")),""==r[t].style.marginTop.toString()&&""==r[t].style.marginBottom.toString()&&r[t].getAttribute("vspace")&&""!=r[t].vspace.toString&&(r[t].style.marginTop=r[t].vspace+"px",r[t].style.marginBottom=r[t].vspace+"px",r[t].removeAttribute("vspace"));var s=e._DOC.body.outerHTML,r="",o=RegExp("<img[^>]*src=(.*?)>","gi"),u=RegExp("<embed[^>]*src=(.*?)>","gi"),a=RegExp("<a[^>]*href=(.*?)>","gi"),f=s.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),l=s.match(o),c=s.match(u),h=s.match(a);if(f){var p=f.length;for(t=0;t<p;t++)r="",0>f[t].indexOf(DEXTTOP.DEXT5.rootPath+"images")&&f[t].match("url\\((.*?)\\)")&&(r=f[t].match("url\\((.*?)\\)"
)[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,"")),r&&""!=r&&(e.setImageArr.push(r),e.setElementsArr.push(r))}if(l){var d=l.length;for(t=0;t<d;t++)r="",l[t].match("src=\"(.*?)\"|src='(.*?)'")&&(r=l[t].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),r&&""!=r&&(e.setImageArr.push(r),e.setElementsArr.push(r))}if(c){var v=c.length;for(t=0;t<v;t++)r="",c[t].match("src=\"(.*?)\"|src='(.*?)'")&&(r=c[t].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),r&&""!=r&&e.setElementsArr.push(r)}if(h){var m=h.length;for(t=0;t<m;t++)r="",-1<h[t].toLowerCase().indexOf("dext5insertfile")&&h[t].match("href=\"(.*?)\"|href='(.*?)'")&&(r=h[t].match("href=\"(.*?)\"|href='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),r&&""!=r&&e.setElementsArr.push(r)}}}catch(g){}}function checkPasteImage(e){if("1"==DEXTTOP.G_CURREDITOR._config.eventForPasteImage){var t=_iframeDoc.createElement("div");t.innerHTML=e,e=t.getElementsByTagName("img");if(0<e.length)try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.pasteImage?DEXTTOP.G_CURREDITOR._config.event.pasteImage(e):DEXTTOP.DEXTWIN.dext_paste_image_event(e)}catch(n){}}}function replaceSpanToDivContainAbsolute(e){var t=e.innerHTML,n=!1;try{for(var r=e.getElementsByTagName("table"),i=r.length-1;0<=i;i--)if("1"==DEXTTOP.G_CURREDITOR._config.pasteRemoveSpanAbsolute){for(var s=!1,o=r[i].getElementsByTagName("span"),u=o.length-1;0<=u;u--)o&&"absolute"==o[u].style.position&&(o[u].style.position="",s=!0);n=n?n:s}else if((o=GetParentbyTagName(r[i],"span"))&&"absolute"==o.style.position){var a=document.createElement("div");setCopyAllObjectAtributes(o,a,!0),o.parentNode.insertBefore(a,o),o.parentNode.removeChild(o),n=!0}}catch(f){e.innerHTML=t}return n}function insertCarriageReturn(e,t){return"1"==e._config.insertCarriageReturn&&(t=t.replace(/<\/style>/gi,"</style>\r\n"),t=t.replace(/<\/p>/gi,"</p>\r\n"),t=t.replace(/<br>/gi,"<br>\r\n"),t=t.replace(/<br \/>/gi,"<br />\r\n"),t=t.replace(/<br\/>/gi,"<br/>\r\n"),t=t.replace(/<\/span><\/span>/gi,"</span></span\r\n>"),t=t.replace(/<\/tr>/gi,"</tr>\r\n"),t=t.replace(/<\/td>/gi,"</td>\r\n"),t=t.replace(/<\/th>/gi,"</th>\r\n")),t}function removeCarriageReturn(e,t){if("1"==e._config.keepOriginalHtml)return t;"1"==e._config.insertCarriageReturn&&(t=t.replace(/<\/style>\r\n/gi,"</style>"),t=t.replace(/<\/p>\r\n/gi,"</p>"),t=t.replace(/<br>\r\n/gi,"<br>"),t=t.replace(/<br \/>\r\n/gi,"<br />"),t=t.replace(/<br\/>\r\n/gi,"<br/>"),t=t.replace(/<\/style>\s/gi,"</style>"),t=t.replace(/<\/p>\s/gi,"</p>"),t=t.replace(/<br>\s/gi,"<br>"),t=t.replace(/<br \/>\s/gi,"<br />"),t=t.replace(/<br\/>\s/gi,"<br/>"),t=t.replace(/<\/tr>\r\n/gi,"</tr>"),t=t.replace(/<\/tr>\s/gi,"</tr>"),t=t.replace(/<\/td>\r\n/gi,"</td>"),t=t.replace(/<\/td>\s/gi,"</td>"),t=t.replace(/<\/th>\r\n/gi,"</th>"),t=t.replace(/<\/th>\s/gi,"</th>"));var n=RegExp("(<table *[^>?+]*>)\\s+<","gi");return t=t.replace(n,"$1<"),n=RegExp("(<caption *[^>?+]*>)\\s+<","gi"),t=t.replace(n,"$1<"),n=RegExp("(<tbody *[^>?+]*>)\\s+<","gi"),t=t.replace(n,"$1<"),n=RegExp("(<tr *[^>?+]*>)\\s+<","gi"),t=t.replace(n,"$1<"),n=RegExp("(<td *[^>?+]*>)\\s+<","gi"),t=t.replace(n,"$1<"),n=RegExp("(<th *[^>?+]*>)\\s+<","gi"),t=t.replace(n,"$1<"),n=RegExp("</tbody>\\s+<","gi"),t=t.replace(n,"</tbody><"),n=RegExp("</caption>\\s+<","gi"),t=t.replace(n,"</caption><"),n=RegExp("</tr>\\s+<","gi"),t=t.replace(n,"</tr><"),n=RegExp("</td>\\s+<","gi"),t=t.replace(n,"</td><"),n=RegExp("</th>\\s+<","gi"),t=t.replace(n,"</th><"),n=RegExp("</div>\\s+<","gi"),t=t.replace(n,"</div><"),n=RegExp("</p>\\s+</td","gi"),t=t.replace(n,"</p></td"),n=RegExp("(<span *[^>?+]*>)([\r\n]+)(</ ?span>)","gi"),t=t.replace(n,"$1&nbsp;$3")}function removeStripTags(e,t){var n=t&&0!=t.length?"<\\/?(?!("+t.join("|")+"))\\b[^>]*>":"<(\"[^\"]*\"|'[^']*'|[^'\">])*>";return e.replace(new RegExp(n,"gi"),"")}function unhtmlSpecialChars(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&")}function htmlSpecialChars(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}function addLineBreaker(e,t){if("br"===e.toLowerCase())return"<p>"+t.replace(/\r?\n/g,"<BR />")+"</p>";t=t.replace(/\r?\n/g,"\n");for(var n=new StringBuffer,r=t.split("\n"),i=r.length,s="",o=0;o<i;o++){s=DEXTTOP.DEXT5.util.trim(r[o]);if(o===i-1&&""===s)break;null!==s&&""!==s?(n.append("<P>"),n.append(r[o]),n.append("</P>")):DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?n.append("<P>&nbsp;</P>"):n.append("<P><BR></P>")}return n.toString()}function checkContainClass(e,t){var n=!1;if(""!=t&&e.className&&""!=e.className)for(var r=e.className.split(" "),i=r.length,s=0;s<i;s++)if(r[s]==t){n=!0;break}return n}function addDisalbeItemForNoActionTable(e){return e=e.concat("table_selection table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column convert_table_to_text cell_border cell_bg_color table_indent table_outdent table_tool insert_row insert_column table_select align_vertical table_copy cell_size".split(" "))}function dropMousePosition(e){try{var t=getEditrFromEvent(e),n=_iframeDoc.body.topMargin,r=_iframeDoc.body.leftMargin;t.mouseDropPosition.clientX=e.clientX<r?r:e.clientX,t.mouseDropPosition.clientY=e.clientY<n?n:e.clientY}catch(i){}}function insertDropImage(e){var t=getEditrFromEvent(e);try{if("1"==t._config.returnEvent.drag_event&&(DEXTTOP.DEXT5.config.DragEventCancel=!1,"function"==typeof t._config.event.drag?t._config.event.drag("drop",e):DEXTTOP.DEXTWIN.dext_drag_event("drop",e),1==DEXTTOP.DEXT5.config.DragEventCancel)){DEXTTOP.DEXT5.util.cancelEvent(e);return}}catch(n){}var r=e.dataTransfer.files;if(0<r.length&&(DEXTTOP.G_CURREDITOR=t,t._DOC.body.isContentEditable)){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(DEXTTOP.DEXT5.browser.ie)try{if(dropMousePosition(e),_iframeDoc.caretPositionFromPoint){var i=_iframeDoc.caretPositionFromPoint(t.mouseDropPosition.clientX,t.mouseDropPosition.clientY),s=_iframeDoc.createRange();s.setStart(i.offsetNode,i.offset),s.collapse()}else if(_iframeDoc.caretRangeFromPoint)s=_iframeDoc.caretRangeFromPoint(t.mouseDropPosition.clientX,t.mouseDropPosition.clientY);else if(_iframeDoc.body.createTextRange){var s=_iframeDoc.body.createTextRange();s.moveToPoint(t.mouseDropPosition.clientX,t.mouseDropPosition.clientY),s.select()}}catch(o){i=t._BODY.lastChild;if(1!=i.nodeType||"P"!=i.tagName)i=t._DOC.createElement("p"),t._BODY.appendChild(i);doSetCaretPosition(i,1)}else if(i=getFirstRange().range,0==i.toString().length){s=null;try{createSelectionFromPoint(e.clientX,e.clientY,e.clientX,e.clientY),setFocusToBody(),i=getFirstRange().range,s=_iframeDoc.createElement("dexttemp"),i.insertNode(s),null!=s.nextSibling&&doSetCaretPosition(s.nextSibling,!1)}catch(u){}s&&s.parentNode.removeChild(s)}e.stopPropagation(),e.preventDefault(),G_HandleFilesCheck=!1,e=r.length,i=!1;for(s=0;s<e;s++)s==e-1&&(i=!0),function(e,n){var r=setInterval(function(){try{0==G_HandleFilesCheck&&(G_HandleFilesCheck=!0,handleFiles(e,t,n),clearInterval(r))}catch(i){clearInterval(r)}},100)}(r[s],i)}}function handleFiles(e,t,n){var r=getFirstRange().range;try{0==r.toString().length&&setRestoreCaretPos(!1)}catch(i){}var s=t._config.allowImageFileType.concat([]),o=!1,r=e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase();-1<t._config.disableInsertImage.indexOf(",paste_image,")&&(s=[]);for(var u=0;u<s.length;u++)if(s[u]==r){o=!0;break}if(1==o)if("txt"==r)if(-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector)s=function(){return function(r,i,s){if(0==s)n&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},10),o=void 0,G_HandleFilesCheck=!1;else{var o=new FileReader;o.onload=function(e){e=htmlSpecialChars(e.target.result),e=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,e),DEXTTOP.DEXT5.browser.ie?pasteHtmlAtCaretHuge(e):t._DOC.execCommand("inserthtml",!1,e),o=void 0,G_HandleFilesCheck=!1},o.readAsText(e)}}}(),D5FileDetector(e,r,s);else{var a=new FileReader;a.onload=function(e){e=htmlSpecialChars(e.target.result),e=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,e),DEXTTOP.DEXT5.browser.ie?pasteHtmlAtCaretHuge(e):t._DOC.execCommand("inserthtml",!1,e),a=void 0,G_HandleFilesCheck=!1},a.readAsText(e)}else e&&DEXTTOP.DEXT5.browser.HTML5Supported&&0!=DEXTTOP.G_CURREDITOR._config.maxImageFileSize&&e.size>DEXTTOP.G_CURREDITOR._config.maxImageFileSize?(r=dext5_lang.msg.max_file_size,r=r.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(DEXTTOP.G_CURREDITOR._config.maxImageFileSize).toString),alert(r)):"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&e&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&getBase64ImageCount()>=parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)?(r=dext5_lang.msg.max_base64file_count,r=r.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(r)):"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject?-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector?(s=function(){return function(e,t,r){0==r?(n&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},10),a=void 0):(postBase64ImageToServer("",t,null,null,null,e),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500)),G_HandleFilesCheck=!1}}(),D5FileDetector(e,r,s)):(postBase64ImageToServer("",r,null,null,null,e),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500),G_HandleFilesCheck=!1):-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector?(s=function(){return function(e,r,i){if(0==i)n&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},10),s=void 0,G_HandleFilesCheck=!1;else{var s=new FileReader;s.onload=function(n){t!=DEXTTOP.G_CURREDITOR&&(DEXTTOP.G_CURREDITOR=t),n=n.target.result;if("data:"==n.substring(0,5)&&(n=n.split(","),2==n.length)){var i=getExtFromImageDataSrc(n[0]);"jpeg"==i&&"jpg"==r&&(i="jpg"),postBase64ImageToServer(n[1],i,null,null,null,e),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500)}s=void 0,G_HandleFilesCheck=!1},s.readAsDataURL(e)}}}(),D5FileDetector(e,r,s)):(a=new FileReader,a.onload=function(n){t!=DEXTTOP.G_CURREDITOR&&(DEXTTOP.G_CURREDITOR=t),n=n.target.result;if("data:"==n.substring(0,5)&&(n=n.split(","),2==n.length)){var r=getExtFromImageDataSrc(n[0]);if("jpeg"==r){var i=e.name;"jpg"==i.substring(i.lastIndexOf(".")+1).toLowerCase()&&(r="jpg")}postBase64ImageToServer(n[1],r,null,null,null,e),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500)}a=void 0,G_HandleFilesCheck=!1},a.readAsDataURL(e))}function setScrollOverflow(e){switch(e._config.scrollOverflow){case"0":e._BODY.style.overflowX="",e._BODY.style.overflowY="";break;case"1":e._BODY.style.overflowX="scroll";break;case"2":e._BODY.style.overflowY="scroll";break;case"3":e._BODY.style.overflowX="scroll",e._BODY.style.overflowY="scroll";break;case"4":e._BODY.style.overflowX="hidden";break;case"5":e._BODY.style.overflowY="hidden";break;case"6":e._BODY.style.overflowX="hidden",e._BODY.style.overflowY="hidden"}}function removeEditorCss(e,t){var n=e,r;try{var i=["editor_layout.css","editor_contents.css","editor_showblocks.css","editor_form.css","editor_adjust_table.css"],s=i.length,o=e.match(new RegExp(/<link [^<>]*>/gi)),u=o.length;if(o)for(var a=0;a<s;a++)for(var f=0;f<u;f++)-1<o[f].indexOf(i[a])&&(e=e.replace(o[f],""));r=e}catch(l){r=n}return r}function createEvent(e,t,n){var r=document.createElement("script");r.setAttribute("for",e),r.event=t,r.appendChild(document.createTextNode(n)),document.body.appendChild(r)}function PL_Event_BeforeOpenHtmlConvert(e,t){try{e&&0==e.indexOf("htm")&&(DEXTTOP.G_CURREDITOR.strOldSaveFileName=t)}catch(n){}try{DEXTTOP.DEXTWIN.dext5EventBeforeOpenHtmlConvert(e,t)}catch(r){}}function PL_Event_AfterOpenHtmlConvert(e,t){try{setFileOpenData(e)}catch(n){}}function PL_Event_dropZone_drop(e,t,n){if(!isViewMode(DEXTTOP.G_CURREDITOR)&&e&&0<e.length&&(t=e.lastIndexOf("."),-1<t&&(t=e.substring(t+1),n=",jpg,jpeg,png,bmp,gif,tif,tiff,",-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,")&&(n=""),-1<n.indexOf(t.toLowerCase()))))if(e.indexOf("\\")&&(e=e.replace(/\\/g,"/")),0!=e.indexOf("file://")&&(e="file:///"+e),"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&getBase64ImageCount()+1>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10))e=dext5_lang.msg.max_base64file_count,e=e.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(e);else{t=_iframeDoc.createElement("img"),n=G_dext5plugIn.getImageWidthHeight(e),SetImageAutoFitSize(t,e+"?"+n),t.src=e,t.alt="",dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo();try{9>DEXTTOP.DEXT5.browser.ieVersion&&(DEXTTOP.G_CURREDITOR.mouseDropPosition.clientX=_iframeWin.event.clientX,DEXTTOP.G_CURREDITOR.mouseDropPosition.clientY=_iframeWin.event.clientY);var r=_iframeDoc.body.createTextRange();r.moveToPoint(DEXTTOP.G_CURREDITOR.mouseDropPosition.clientX,DEXTTOP.G_CURREDITOR.mouseDropPosition.clientY),r.select()}catch(i){e=DEXTTOP.G_CURREDITOR._BODY.lastChild;if(1!=e.nodeType||"P"!=e.tagName)e=DEXTTOP.G_CURREDITOR._DOC.createElement("p"),DEXTTOP.G_CURREDITOR._BODY.appendChild(e);doSetCaretPosition(e,1)}r=getFirstRange().range,r.collapse(!0),r.insertNode(t),r.selectNode(t),r.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(r),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper(t)}catch(s){}}}function setEnableDrapDropFile(){try{G_dext5plugIn.SetEnableDrapDropFile(),11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"d5_event_dropZone_drop(strFileFolderName, bFolder, nOrder)","PL_Event_dropZone_drop(strFileFolderName, bFolder, nOrder)"):G_dext5plugIn.attachEvent("d5_event_dropZone_drop",PL_Event_dropZone_drop)}catch(e){}}function file_open_plugin(){if("1"==DEXTTOP.G_CURREDITOR._config.openDocument.beforeOpenEvent)try{11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"DEXT5_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)","PL_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)"):G_dext5plugIn.attachEvent("DEXT5_Event_BeforeOpenHtmlConvert",PL_Event_BeforeOpenHtmlConvert)}catch(e){}11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"DEXT5_Event_AfterOpenHtmlConvert(strHTML, strReserved)","PL_Event_AfterOpenHtmlConvert(strHTML, strReserved)"):G_dext5plugIn.attachEvent("DEXT5_Event_AfterOpenHtmlConvert",PL_Event_AfterOpenHtmlConvert);var t=G_dext5plugIn.openDocumentDialog();"0"==DEXTTOP.G_CURREDITOR._config.useHybrid&&setFileOpenData(t)}function setFileOpenData(e){if(e){var t=!0;0==DEXTTOP.DEXT5.isEmpty()&&0==confirm(dext5_lang.msg.newDocument)&&(t=!1),t&&(t=e.substring(0,3).toLowerCase(),e=e.substring(3),"txt"==t&&(e=htmlSpecialChars(e),e=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,e)),"doc"==t||"ppt"==t||"xls"==t?(setGlobalTableDefaultValue(),e=e.replace(/\x3c!--\[if supportMisalignedColumns\]--\x3e/gi,""),e=e.replace(/\x3c!--\[endif\]--\x3e/gi,""),e=execReplaceMsoStyle(e),e=OfficePasteClean(e),setBodyValueToEditor(e)):DEXTTOP.DEXT5.setHtmlContents(e,DEXTTOP.G_CURREDITOR.ID))}}function removeLastBrTag(e){if("1"==e._config.removeLastBrTag)try{var t=e._DOC.getElementsByTagName("p"),n=t.length;for(e=0;e<n;e++){var r=t[e].lastChild;if(1==r.nodeType&&"BR"==r.tagName){var i=r.previousSibling;!i||1==i.nodeType&&"BR"==i.tagName||r.parentNode.removeChild(r)}}}catch(s){}}function changeRealTagToReplaceString(e){var t=e;if(e){var n=e.match(RegExp("<textarea *([^>?+])*>*([^>?+])*</textarea>","gi"));if(n){DEXTTOP.G_CURREDITOR.sTextareaArr=n;for(var r=n.length,i=0;i<r;i++)t=e.replace(n[i],"{_dext5_textarea_"+i+"}")}}return t}function changeReplaceStringToRealTag(e){var t=e;if(e){for(var n=DEXTTOP.G_CURREDITOR.sTextareaArr,r=n.length,i=0;i<r;i++)t=e.replace("{_dext5_textarea_"+i+"}",n[i]);DEXTTOP.G_CURREDITOR.sTextareaArr=[]}return t}function getViolationNodes(e){dext_src_init(e._EDITOR.design);var t=[];if(""==e._config.accessibilityValidationItems)t=["table","frame","iframe","img","a"];else for(var n=e._config.accessibilityValidationItems.split(","),r=n.length,i=0;i<r;i++)if("duplicate_id"!=n[i].toLowerCase()){var s=n[i].split("_")[0];0>t.indexOf(s)&&t.push(s)}r=t.length,n=[];for(i=0;i<r;i++)for(var s="iframe"==t[i]?_iframeDoc.body.getElementsByTagName("img"):_iframeDoc.body.getElementsByTagName(t[i]),o=s.length,u=0;u<o;u++){var a=s[u].getAttribute("dext5webaccskip");if(null==a||void 0==a)if("table"==t[i])-1<e._config.accessibilityValidationItems.indexOf("table_caption")&&-1<e._config.accessibilityValidationItems.indexOf("table_summary")||""==e._config.accessibilityValidationItems?null!=s[u].caption&&""!=s[u].caption.innerHTML&&""!=s[u].summary||n.push(s[u]):-1<e._config.accessibilityValidationItems.indexOf("table_caption")?null!=s[u].caption&&""!=s[u].caption.innerHTML||n.push(s[u]):-1<e._config.accessibilityValidationItems.indexOf("table_summary")&&""==s[u].summary&&n.push(s[u]);else if(-1<"frame,a".indexOf(t[i]))"a"==t[i]?null!=s[u].href&&""!=s[u].href&&""==s[u].title&&n.push(s[u]):""==s[u].title&&n.push(s[u]);else if("iframe"==t[i]){if(a=s[u].getAttribute("dext5customdata"),null!=a&&void 0!=a&&(elemData=getDextCustomData(a),"iframe"==elemData.type||"iframe"==elemData.type2))void 0!=elemData.title&&""!=elemData.title||n.push(s[u])}else"img"==t[i]&&(a=s[u].getAttribute("dext5customdata"),void 0==a||null==a)&&(void 0!=s[u].alt&&""!=s[u].alt||n.push(s[u]))}t=[];if(-1<e._config.accessibilityValidationItems.indexOf("duplicate_id")||""==e._config.accessibilityValidationItems)for(e=_iframeDoc.body.getElementsByTagName("*"),r=e.length,s=[],i=0;i<r;i++)!e[i].getAttribute("id")||-1<s.indexOf(e[i].getAttribute("id"))||(o=getElementsById(e[i].getAttribute("id"),_iframeDoc))&&1<o.length&&(t.push(o),s.push(e[i].getAttribute("id")));return{violateNodes:n,idSamNodes:t}}function setAdjustTableBorder(e){for(var t=e.getElementsByTagName("link"),n=null,r=t.length-1;0<=r;r--)-1<t[r].href.indexOf("editor_adjust_table.css")&&(n=t[r],n.parentNode.removeChild(n));DEXTTOP.DEXT5.browser.ie&&(11>DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&0<e.getElementsByTagName("table").length&&(t=DEXTTOP.G_CURREDITOR._config.webPath.css,DEXTTOP.DEXT5.isRelease||(t=DEXTTOP.G_CURREDITOR._config.webPath.css_dev),n=e.getElementsByTagName("head")[0],createDynamicCssLinkToHeadTag(e,n,t+"editor_adjust_table.css?ver="+DEXTTOP.DEXT5.ReleaseVer),setTimeout(function(){for(var t=e.getElementsByTagName("link"),n=null,r=t.length-1;0<=r;r--)-1<t[r].href.indexOf("editor_adjust_table.css")&&(n=t[r],n.parentNode.removeChild(n))},0))}function hiddenBlocks(e){e=e.getElementsByTagName("link");for(var t=null,n=e.length-1;0<=n;n--)-1<e[n].href.indexOf("editor_showblocks.css")&&(t=e[n],t.parentNode.removeChild(t))}function removeDummyTag(e){e=DEXTTOP.DEXT5.util.replaceAll(e,"<![if !mso]>",""),e=DEXTTOP.DEXT5.util.replaceAll(e,"<![if !mso & !vml]>","");var t=DEXTTOP.G_CURREDITOR._config.removeDummyTag;if(""!=t)for(var t=t.split(","),n=t.length,r=0;r<n;r++){var i=DEXTTOP.DEXT5.util.trim(t[r]),s=new RegExp("<"+i+".*?>","gi");e=e.replace(s,""),s=new RegExp("</"+i+".*?>","gi"),e=e.replace(s,"")}return e}function dummyTagClassClear(e){return"1"==DEXTTOP.G_CURREDITOR._config.useSelectionMark&&(e=e.replace(RegExp("<dextmark[^>]+class=.*?dextmark.*?></dextmark>","gi"),"")),1==DEXTTOP.G_CURREDITOR.ShowTableBorder&&(e=e.replace(" DEXT_tableborder",""),e=e.replace("DEXT_tableborder ",""),e=e.replace("DEXT_tableborder",""),e=e.replace('class=""',"")),e}function ReplaceCustomDataToRealEvent(e){try{var t=_iframeDoc;e&&(t=e);for(var n=t.getElementsByTagName("input"),r=n.length-1;0<=r;r--){var s=n[r],o=s.getAttribute("dext5customdata");if(null!=o&&void 0!=o){var u=getDextCustomData(o);if(u.type&&"event"==u.type){var a=u.eventName,f=u.eventFunction,l=a.split(""),c=f.split(""),h=l.length;for(i=0;i<h;i++)s.setAttribute(l[i],c[i])}s.removeAttribute("dext5customdata")}}for(var p=t.getElementsByTagName("textarea"),r=p.length-1;0<=r;r--){var d=p[r],o=d.getAttribute("dext5customdata");if(null!=o&&void 0!=o){u=getDextCustomData(o);if(u.type&&"event"==u.type)for(a=u.eventName,f=u.eventFunction,l=a.split(""),c=f.split(""),h=l.length,i=0;i<h;i++)d.setAttribute(l[i],c[i]);d.removeAttribute("dext5customdata")}}for(var v=t.getElementsByTagName("select"),r=v.length-1;0<=r;r--){var m=v[r],o=m.getAttribute("dext5customdata");if(null!=o&&void 0!=o){u=getDextCustomData(o);if(u.type&&"event"==u.type)for(a=u.eventName,f=u.eventFunction,l=a.split(""),c=f.split(""),h=l.length,i=0;i<h;i++)m.setAttribute(l[i],c[i]);m.removeAttribute("dext5customdata")}}}catch(g){}}function ReplaceRealEventToCustomData(){for(var e=_iframeDoc.getElementsByTagName("input"),t=e.length-1;0<=t;t--){for(var n=e[t],r=DEXTTOP.G_CURREDITOR._config.eventList.length,i="",s="",o=!1,u=0;u<r;u++)n.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[u])&&(o&&(i+="",s+=""),o=!0,i+=DEXTTOP.G_CURREDITOR._config.eventList[u],s+=n.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[u]));""!=i&&(r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(n,r))}e=_iframeDoc.getElementsByTagName("textarea");for(t=e.length-1;0<=t;t--){n=e[t],r=DEXTTOP.G_CURREDITOR._config.eventList.length,s=i="",o=!1;for(u=0;u<r;u++)n.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[u])&&(o&&(i+="",s+=""),o=!0,i+=DEXTTOP.G_CURREDITOR._config.eventList[u],s+=n.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[u]));""!=i&&(r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(n,r))}e=_iframeDoc.getElementsByTagName("select");for(t=e.length-1;0<=t;t--){n=e[t],r=DEXTTOP.G_CURREDITOR._config.eventList.length,s=i="",o=!1;for(u=0;u<r;u++)n.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[u])&&(o&&(i+="",s+=""),o=!0,i+=DEXTTOP.G_CURREDITOR._config.eventList[u],s+=n.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[u]));""!=i&&(r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(n,r))}}function checkLockAttr(e,t){for(var n=!1,r=[],r="1"==DEXTTOP.G_CURREDITOR._config.formMode?DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName:DEXTTOP.G_CURREDITOR._config.userTableLock.lockName,i=r.length;null!=e;){for(var s=0;s<i;s++)if(void 0!=e.getAttribute(r[s])){n=!0;break}if(t)break;e=!e.tagName||"TD"!=e.tagName&&"TH"!=e.tagName?e.tagName&&"TABLE"==e.tagName?GetTDTHCell(e):null:GetParentbyTagName(e,"table")}return n}function removeLockAttr(e){var t=DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName,n=t.length;if(e)for(var r=0;r<n;r++)e.removeAttribute(t[r])}function setClassTableAndCellLock(e){if("0"!=e._config.formMode||"0"!=e._config.userTableLock.use){""==e._config.tableNoResizeClass&&(e._config.tableNoResizeClass="dext_no_resize"),""==e._config.tableNoActionClass&&(e._config.tableNoActionClass="dext_no_action");for(var t=e._config.tableNoResizeClass,n=e._config.tableNoActionClass,r=e._DOC.getElementsByTagName("table"),i=r.length,s=0;s<i;s++)if(checkLockAttr(r[s],!0)){if("1"==e._config.formMode)setClassName(r[s],"DEXT_five_table_lock");else if("1"==e._config.userTableLock.use){var o=e._config.userTableLock.defaultShowLockIcon;r[s].getAttribute("show_icon")&&""!=r[s].getAttribute("show_icon")&&(o=r[s].getAttribute("show_icon")),"1"==o?setClassName(r[s],"DEXT_five_table_lock"):removeClassName(r[s],"DEXT_five_table_lock"),"2"==e._config.userTableLock.tableLockMode?(o=e._config.userTableLock.defaultTableLockMode,r[s].getAttribute("lock_mode")&&""!=r[s].getAttribute("lock_mode")&&(o=r[s].getAttribute("lock_mode")),removeClassName(r[s],t),removeClassName(r[s],n),setClassName(r[s],t),"2"==o&&setClassName(r[s],n)):(setClassName(r[s],t),setClassName(r[s],n))}}else"1"==e._config.userTableLock.use&&("2"==e._config.userTableLock.tableLockMode?(removeClassName(r[s],t),removeClassName(r[s],n)):(o=e._config.userTableLock.defaultTableLockMode,r[s].getAttribute("lock_mode")&&""!=r[s].getAttribute("lock_mode")&&(o=r[s].getAttribute("lock_mode")),"2"==o?checkLockAttr(r[s])&&(setClassName(r[s],t),setClassName(r[s],n)):(removeClassName(r[s],t),removeClassName(r[s],n))));t=e._DOC.getElementsByTagName("td"),n=t.length;for(s=0;s<n;s++)checkLockAttr(t[s],!0)&&("1"==e._config.formMode?setClassName(t[s],"DEXT_five_cell_lock"):(r=e._config.userTableLock.defaultShowLockIcon,i=GetParentbyTagName(t[s],"table"),i.getAttribute("show_icon")&&""!=i.getAttribute("show_icon")&&(r=i.getAttribute("show_icon")),"1"==e._config.userTableLock.use&&("1"==r?setClassName(t[s],"DEXT_five_cell_lock"):removeClassName(t[s],"DEXT_five_cell_lock"))))}}function findNoLockCell(e){var t=null;if(e){var n=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&(n=e.getAttribute("lock_mode"));var r=!0;"1"==n&&(r=!1),e=e.getElementsByTagName("td");for(var n=e.length,i=0;i<n;i++)if(0==checkLockAttr(e[i],!r)){t=e[i];break}}return t}function findNextNoLockCell(e,t){var n=null,r=e.cellIndex,i=e.parentNode,s=i.rowIndex,i=i.parentNode;if(t)for(var o=s;o<i.rows.length;o++){var u=0;o==s&&(u=r);for(var a=i.rows[o];u<a.cells.length;u++)if(!checkLockAttr(a.cells[u],!1)){n=a.cells[u];break}if(n)break}else for(o=s;0<=o;o--){a=i.rows[o],u=a.cells.length-1;for(o==s&&(u=r);0<=u;u--)if(!checkLockAttr(a.cells[u],!1)){n=a.cells[u];break}if(n)break}return n}function setFocusForLock(e){try{e&&("TD"==e.tagName||"TH"==e.tagName?"P"==e.firstChild.tagName?(doSetCaretPosition(e.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):(doSetCaretPosition(e,0),DEXTTOP.G_CURREDITOR._iconEnable("")):(doSetCaretPosition(e,0),DEXTTOP.G_CURREDITOR._iconEnable("")))}catch(t){}}function findNoLockElem(e){var t=null;if(e){var n=e.previousSibling;n&&1==n.nodeType&&!checkLockAttr(n)&&(t=n),null==t&&(e=e.nextSibling)&&1==e.nodeType&&!checkLockAttr(e)&&(t=e)}return t}function checkLockElemInSelectionRange(){try{var e=getFirstRange(),t=e.range;if(0<t.toString().length){var n=[[],[]];n[0]=getNodesInRange(t);if(null!=t.startContainer.previousSibling&&"HEAD"==t.startContainer.previousSibling.tagName&&null==t.endContainer.nextSibling){var r=_iframeDoc.getElementsByTagName("table"),i=_iframeDoc.getElementsByTagName("td");n[0]=r,n[1]=i}for(var s=n.length-1;0<=s;s--)for(var o=n[s].length-1;0<=o;o--){var u;u="TD"==n[s][o].tagName||"TABLE"==n[s][o].tagName;if(n[s][o].tagName&&u&&checkLockAttr(n[s][o],!0)){e.sel.removeAllRanges(),DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(window.focus(),document.body.focus());break}}}}catch(a){}}function IsExistTableLock(e){var t=!1,n=e._DOC;e=n.getElementsByTagName("table");var r=n.getElementsByTagName("td"),n=n.getElementsByTagName("th");e=[e,r,n],r=e.length;for(n=0;n<r;n++){for(var i=e[n].length,s=0;s<i;s++)if(checkLockAttr(e[n][s],!0)){t=!0;break}if(t)break}return t}function setDEXTWINDOC(){null!=DEXTTOP.DEXT5.config.DialogWindow&&(setDEXTWINwindow(),setDEXTDOCdocument())}function groupingIcon(e){e&&(DEXTTOP.G_CURREDITOR=e),"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&("0"!=DEXTTOP.G_CURREDITOR._config.tool_bar&&"2"!=DEXTTOP.G_CURREDITOR._config.tool_bar||makeGrouping(1,e),"0"!=DEXTTOP.G_CURREDITOR._config.tool_bar&&"1"!=DEXTTOP.G_CURREDITOR._config.tool_bar||makeGrouping(2,e))}function makeGrouping(e,t){t&&(DEXTTOP.G_CURREDITOR=t);if(DEXTTOP.DEXT5.util.DEXT5_CheckEditorVisible(DEXTTOP.G_CURREDITOR.ID)){var n=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ue_editor_main_"+DEXTTOP.G_CURREDITOR.ID),n=getClientRect(n);if(!(200>n.right-n.left)){for(var r=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext_tab_tool"+e+"_"+DEXTTOP.G_CURREDITOR.ID),i=DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].length,i=i-1;0<=i;i--)r.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[e-1][i]);DEXTTOP.G_CURREDITOR.Toolbar_group[e-1]=[],DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+e).innerHTML="";for(var r=r.childNodes,s=r.length,o=[],i=0;i<s;i++)1==r[i].nodeType&&(-1<r[i].className.indexOf("uebutton")||-1<r[i].className.indexOf("ue_SM"))&&o.push(r[i]);for(i=o.length-1;0<=i;i--)if(getClientRect(o[i]).right>=n.right-18)-1<o[i].id.indexOf("detail_table_insert")?(DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].push(o[i]),DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].push(o[i-1]),--i):-1<o[i].id.indexOf("detail_list_")||-1<o[i].id.indexOf("_group_detail")||-1<o[i].id.indexOf("detail_font_")||-1<o[i].id.indexOf("detail_cell_")?(DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].push(o[i]),DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].push(o[i-1]),--i):DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].push(o[i]);else if("none"!=o[i].style.display)break;i=DEXTTOP.G_CURREDITOR.Toolbar_group[e-1].length,n=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+"tool_bar_grouping"+e);if(0==i)n.style.display="none";else{for(--i;0<=i;i--)r=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.createElement("li"),-1<DEXTTOP.G_CURREDITOR.Toolbar_group[e-1][i].id.indexOf("list_")?(r.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[e-1][i]),r.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[e-1][i-1]),--i):r.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[e-1][i]),DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+e).appendChild(r);n.style.display=""}}}}function setPositionGroupingDiv(e){var t=document.getElementById("dext_div_tool_bar_grouping_box"+e),n=document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+"tool_bar_grouping"+e),n=getClientRect(n);e=getClientRect(document.getElementById("ul_tool_bar_grouping_list"+e)),t.style.left=n.right-(e.right-e.left)-2+"px",t.style.top=n.bottom+"px"}function showGroupingBackground(){var e=document.getElementById("dext_grouping_background");e||(e=document.createElement("div"),e.setAttribute("id","dext_grouping_background"),e.style.zIndex=G_MAIN_ZINDEX+800,document.body.appendChild(e),DEXTTOP.DEXT5.util.addEvent(e,"click",function(){hideGroupingBox()}),e.onmousedown=function(){return!1},e.unselectable="on"),DEXT5_EDITOR.prototype.dialog.set_full_size(e),e.style.display="block"}function hideGroupingBox(){dialogCancel();var e=document.getElementById("dext_div_tool_bar_grouping_box1");e&&(e.style.display="none");if(e=document.getElementById("dext_div_tool_bar_grouping_box2"))e.style.display="none";if(e=document.getElementById("dext_grouping_background"))e.style.display="none"}function isGroupingIcon(e,t,n){var r=!1;return"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(e=n?n:document.getElementById("ue_"+e+t),(e=GetParentbyTagName(e,"ul"))&&-1<e.id.indexOf("ul_tool_bar_grouping")&&(r=!0)),r}function userCssSet(e,t){var n=strRetvalue=e,r='<link href="'+t+'" rel="stylesheet" type="text/css">';try{if(-1==e.indexOf(r)){var i=e.indexOf("</head>");if(-1==i){var s=e.indexOf("<body");strRetvalue=-1==s?"<head>"+r+"</head><body>"+e+"</body>":e.substring(0,s)+"<head>"+r+"</head>"+e.substring(s)}else strRetvalue=e.substring(0,i)+r+e.substring(i)}}catch(o){strRetvalue=n}return strRetvalue}function loadDirectEditHtmlUrl(e){if(""!=e.directEditHtmlUrl){var t=DEXTTOP.G_CURREDITOR._EDITOR.design;DEXTTOP.DEXT5.util.addEvent(t,"load",loadDirectEditHtmlUrlEvent),"1"==DEXTTOP.G_CURREDITOR._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){t.src=e.directEditHtmlUrl},G_Progress_LoadTime)):t.src=e.directEditHtmlUrl}}function loadDirectEditHtmlUrlEvent(){try{var e=DEXTTOP.G_CURREDITOR._EDITOR.design,t=DEXTTOP.G_CURREDITOR._setting.encoding,n=DEXTTOP.G_CURREDITOR._setting.lang,r=DEXTTOP.G_CURREDITOR._setting.xmlnsname,i=DEXTTOP.G_CURREDITOR._setting.font_family,s=DEXTTOP.G_CURREDITOR._setting.font_size,o=DEXTTOP.G_CURREDITOR._setting.line_height,u=e.contentWindow,a=getIframeDocument(e),f=u.document.documentElement.getElementsByTagName("head")[0];if(null==f||void 0==f)f=a.createElement("head"),a.insertBefore(f,a.body);if(""!=DEXTTOP.G_CURREDITOR._config.imageBaseUrl){for(var l=f.getElementsByTagName("base"),c=l.length,h=0;h<c;h++)if(l[h].href&&-1<l[h].href.indexOf(DEXTTOP.G_CURREDITOR._config.imageBaseUrl)){sameCheck=!0;break}var p=a.createElement("base");p.href=DEXTTOP.G_CURREDITOR._config.imageBaseUrl,f.appendChild(p)}if(""!=DEXTTOP.G_CURREDITOR._config.ieCompatible){for(var d=f.getElementsByTagName("meta"),v=d.length,h=0;h<v;h++)if(d[h].getAttribute("content")&&-1<d[h].getAttribute("content").indexOf("IE="+DEXTTOP.G_CURREDITOR._config.ieCompatible)){sameCheck=!0;break}var m=a.createElement("meta");m.setAttribute("http-equiv","X-UA-Compatible"),m.setAttribute("content","IE="+DEXTTOP.G_CURREDITOR._config.ieCompatible),f.appendChild(m)}for(var g=f.getElementsByTagName("style"),y=g.length,u=!1,h=0;h<y;h++)if(1==defaultStyleSameCheck(g[h].innerHTML,DEXTTOP.G_CURREDITOR)){u=!0;break}if(!u){var b=createEditorDefaultStyleInnerHTML(DEXTTOP.G_CURREDITOR._config,i,s,o);addDynamicCssToHeadTag(a,f,b)}i="",i=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,createDynamicCssLinkToHeadTag(a,f,i+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer),"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use||createDynamicCssLinkToHeadTag(a,f,i+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer);if(n&&0<n.length){var w=a.getElementsByTagName("html")[0];w&&(-1<n.indexOf("-")&&(n=n.split("-")[0]),w.setAttribute("lang",n),w.setAttribute("xml:lang",n),0<r.length&&w.setAttribute("xmlns",r))}""==t&&(t="utf-8");var E=a.createElement("meta");E.setAttribute("http-equiv","Content-Type"),E.setAttribute("content","text/html"),E.setAttribute("charset",t),f.appendChild(E),5<DEXTTOP.G_CURREDITOR._config.userCssUrl.length&&createDynamicCssLinkToHeadTag(a,f,DEXTTOP.G_CURREDITOR._config.userCssUrl),5<DEXTTOP.G_CURREDITOR._config.webFontCssUrl.length&&createDynamicCssLinkToHeadTag(a,f,DEXTTOP.G_CURREDITOR._config.webFontCssUrl),5<DEXTTOP.G_CURREDITOR._config.userJsUrl.length&&createDynamicJsLinkToHeadTag(a,f,DEXTTOP.G_CURREDITOR._config.userJsUrl),DEXT5_EDITOR.prototype._load_editor_frame(!1),0==isViewMode(DEXTTOP.G_CURREDITOR)&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,"1"==DEXTTOP.G_CURREDITOR._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage(),0==u&&xssReplaceScript(_iframeDoc)),setScrollOverflow(DEXTTOP.G_CURREDITOR),setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR),setCssForFormMode(DEXTTOP.G_CURREDITOR),DEXTTOP.DEXT5.util.removeLineHeightOfTable(),DEXTTOP.G_CURREDITOR._iconEnable(""),setBodyDefaultValue();try{var S=DEXTTOP.G_CURREDITOR._BODY.innerHTML,S=addHtmlToSetValue(DEXTTOP.G_CURREDITOR,S),S=removeDummyTag(S),S=removeIncorrectSpaceInTag(S),S=DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(S);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection&&0==u&&(S=htmlTagRevision(S,!1)),S=removeTagStyle(S),S=htmlAsciiToChar(S),S=RemoveUnnecessaryChar(S),0==u&&(S=CleanZeroChar(S)),t=!1,"1"==DEXTTOP.G_CURREDITOR._config.replaceEmptyTagWithSpace&&(t=!0),S=DEXTTOP.DEXT5.util.htmlRevision(S,t),DEXTTOP.G_CURREDITOR._BODY.innerHTML=S}catch(x){}wrapPtagForNotBlockTag(DEXTTOP.G_CURREDITOR),replaceBrTag(DEXTTOP.G_CURREDITOR),fn_IEJASOBug(DEXTTOP.G_CURREDITOR),removeLastBrTag(DEXTTOP.G_CURREDITOR),0==isViewMode(DEXTTOP.G_CURREDITOR)&&(removeNbspInPTag(DEXTTOP.G_CURREDITOR),replaceClassForBorder(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"),replaceClassForBookmark(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show")),setFocusToBody(),setFocusChildForStyle(DEXTTOP.G_CURREDITOR._BODY),DEXTTOP.DEXT5.util.setBodyBackground(DEXTTOP.G_CURREDITOR),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!1,DEXTTOP.G_CURREDITOR.UndoManager.canRedo=!1,DEXTTOP.G_CURREDITOR._iconEnable(""),insertImageSrc(DEXTTOP.G_CURREDITOR),showRuler(DEXTTOP.G_CURREDITOR),setClassTableAndCellLock(DEXTTOP.G_CURREDITOR),setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC),"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks&&(DEXTTOP.G_CURREDITOR.ShowBlocks="",command_showBlocks(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR))}catch(T){}finally{DEXTTOP.DEXT5.util.removeEvent(e,"load",loadDirectEditHtmlUrlEvent),"1"==DEXTTOP.G_CURREDITOR._config.statusBarLoading&&hideProcessingBackground()}}function showProcessingBackground(){var e=document.getElementById("dext_Processing_background"),t=document.getElementById("dext_Processing_text");e||(e=document.createElement("div"),e.setAttribute("id","dext_Processing_background"),e.style.zIndex=G_MAIN_ZINDEX+900,e.style.verticalAlign="middle",t=document.createElement("div"),t.setAttribute("id","dext_Processing_text"),t.style.zIndex=parseIntOr0(e.style.zIndex)+100,t.innerHTML=DEXTTOP.G_CURREDITOR._config.style.htmlprocessCustomText,document.body.appendChild(e),document.body.appendChild(t)),DEXT5_EDITOR.prototype.dialog.set_full_size(e),e.style.display="block",t.style.display="block"}function hideProcessingBackground(){var e=document.getElementById("dext_Processing_background"),t=document.getElementById("dext_Processing_text");e&&(e.style.display="none",t.style.display="none"),""!=DEXTTOP.G_CURREDITOR._config.placeholder.content&&placeholderControl(DEXTTOP.G_CURREDITOR,"class");try{for(var n in G_DEPlugin)"function"==typeof G_DEPlugin[n].onChange&&G_DEPlugin[n].onChange()}catch(r){}}function textCheckInString(e){return e=e.replace(/\r\n/g,""),e=e.replace(/\r/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""),e=e.replace(/\s/g,"")}function getDialogWindow(){var e=DEXTTOP.window;return null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(e=DEXTTOP.G_CURREDITOR.dialogWindow),e}function getDialogDocument(){var e=DEXTTOP.window.document;return null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(e=DEXTTOP.G_CURREDITOR.dialogWindow.document),e}function addHtmlToSetValue(e,t){var n=backValue=t;try{var r=e._config.addHtmlToSetValue.html;if(""!=r){var i=e._config.addHtmlToSetValue.preOrSub,s=-1;if(0==i){var o=t.toLowerCase().indexOf("<body");-1<o&&(s=o+t.substring(o).indexOf(">"))}else s=t.toLowerCase().indexOf("</body")-1;n=0<s?t.substring(0,s+1)+r+t.substring(s+1):0==i?r+t:t+r,e._config.addHtmlToSetValue.html=""}}catch(u){n=backValue}return n}function adjustTableForIEJASOBug(e){try{if("1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign){if("1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_ReplaceAlignMargin&&("center"==e.align||"right"==e.align)){var t=getReplaceAlignMargin(DEXTTOP.G_CURREDITOR,e);0!=t&&(e.style.marginLeft=t+"px")}e.align="",e.removeAttribute("align");try{"cssFloat"in e.style?e.style.cssFloat="":e.style.styleFloat=""}catch(n){}}for(var t=["td","th","p","span"],r=t.length,i=0;i<r;i++){var s=e.getElementsByTagName(t[i]),o=s.length;if("span"!=t[i])for(var u=0;u<o;u++)1==s[u].childNodes.length&&1==s[u].childNodes[0].nodeType&&"BR"==s[u].childNodes[0].tagName&&(s[u].innerHTML="P"==s[u].tagName?"&nbsp;":"<p>&nbsp;</p>");else for(u=0;u<o;u++)if(1!=s[u].childNodes.length||"br"!=s[u].childNodes[0].tagName.toLowerCase()){var a=s[u].innerHTML,a=a.replace(/<br>$/ig,""),a=a.replace(/<br ([^>]+)>$/ig,"");11==DEXTTOP.DEXT5.browser.ieVersion&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&""==a&&(a=unescape("%u200B")),s[u].innerHTML=a}}}catch(f){}}function getReplaceAlignMargin(e,t){var n=0;(n=GetTDTHCell(t))?n=parseIntOr0(n.clientWidth):(n=getWidthForAutoBodyFit(e,"table"),"1"!=e._config.autoBodyFit&&(n+=30),DEXTTOP.DEXT5.browser.ie||(n-=20));var r;return""!=t.style.width&&-1<t.style.width.indexOf("px")?r=parseIntOr0(t.style.width):(r=getClientRect(t),r=r.right-r.left),r=n-r,0<r?"center"==t.align?n=r/2:"right"==t.align&&(n=r):n=0,n}function endBrForIEJASOBug(e){if(e.hasChildNodes()&&1==e.lastChild.nodeType&&1<e.childNodes.length)try{var t=e.lastChild;if("br"==t.tagName.toLowerCase()){var n;if(2<e.childNodes.length&&t.previousSibling){var r=t.previousSibling;r&&1==r.nodeType&&"br"==r.tagName.toLowerCase()&&(n=r)}e.removeChild(t),n&&e.removeChild(n)}}catch(i){}}function startCreationPluginObject(e){if(DEXTTOP.DEXT5UPLOAD&&"2.7.1122996"<=DEXTTOP.DEXT5UPLOAD.ReleaseVer)try{var t=0,n=null,r=function(t){var r=t.length,i=0,s=!1,o=setInterval(function(){try{var t=DEXTTOP.DEXT5UPLOAD.DEXTMULTIPLE["dext5uploader_frame_"+n[i]];t&&t._config&&("1"==t._config.hybridDownload&&(s=!0,clearInterval(o)),i++,0==s&&i==r&&(clearInterval(o),fn_createPluginObject(e)))}catch(u){clearInterval(o),fn_createPluginObject(e)}},100)},i=setInterval(function(){try{n=DEXTTOP.DEXT5UPLOAD.DEXTMULTIPLEID,0<n.length&&(clearInterval(i),r(n)),t++,10<=t&&(clearInterval(i),fn_createPluginObject(e))}catch(s){clearInterval(i),fn_createPluginObject(e)}},200)}catch(s){}else fn_createPluginObject(e)}function fn_createPluginObject(e){if(!G_dext5plugIn){var t=e.plugin_root+"dext5editor.cab";!e.pluginInstallType||"1"!=e.pluginInstallType.toString()&&"2"!=e.pluginInstallType.toString()||(t="");var n=document.createElement("div");n.style.display="none";var r="";"1"==e.autoPluginUpdate&&(r=t+"#version="+e.plugin_version),t='<object id="dext5plugin" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" codebase="'+r+'" width="0" height="0"><param name="saveFileType" value="">',t+='<param name="serverDomain" value="'+e.serverDomain+'">',t+='<param name="toSavePathUrl" value="'+e.toSavePathURL+'">',t+='<param name="saveFolderNameRule" value="'+e.saveFolderNameRule+'">',t+='<param name="saveFileNameRule" value="'+e.saveFileNameRule+'">',t+='<param name="productKey" value="'+e.productKey+'">',t+='<param name="licenseKeyUrl" value="'+e.plugin_root+'">',t+='<param name="postPageURL" value="'+e.post_url+'">',t+='<param name="accessibility" value="'+e.accessibility+'">',t+='<param name="trustSites" value="'+e.trustSites+'">',t+='<param name="licenseKey" value="'+e.LicenseKey+'">',t+='<param name="openDialogTitle" value="'+e.userOpenDlgTitle+'">',t+='<param name="mimeBaseURL" value="'+e.mimeBaseURL+'">',t+='<param name="openDialogType" value="'+e.userOpenDlgType+'">',t+='<param name="openDialogInitDir" value="'+e.userOpenDlgInitDir+'">',t+='<param name="imagePropStyle" value="'+e.userImageDlgStyle+'">',t+='<param name="imgDefaultWidth" value="'+e.imgDefaultWidth+'">',t+='<param name="imgDefaultHeight" value="'+e.imgDefaultHeight+'">',t+='<param name="officeLineFix" value="'+e.officeLineFix+'">',t+='<param name="systemTitle" value="'+e.system_title+'">',t+='<param name="useLog" value="'+e.useLog+'">',t+='<param name="editphotouse" value="'+e.imageEditorUse+'">',"3,5,0,23">=DEXTTOP.DEXT5.cabVersion?(r="",r=-1<e.lang.indexOf("ko")?"ko":-1<e.lang.indexOf("en")?"en":-1<e.lang.indexOf("ja")?"ja":e.lang,t+='<param name="sLang" value="'+r+'">'):t+='<param name="sLang" value="'+e.lang+'">',r=e.style.skinName,"mono"==r&&(r="gray"),t+='<param name="skinName" value="'+r+'">',t+='<param name="sFileDataID" value="'+e.fileFieldID+'">',t+='<param name="sUserFieldID" value="'+e.userFieldID+'">',t+='<param name="sUserFieldValue" value="'+e.userFieldValue+'">',t="1"==e.limitPasteHtmlLength.value&&0<e.limitPasteHtmlLength.length?t+('<param name="nLimitPasteLength" value="'+e.limitPasteHtmlLength.length+'">'):t+'<param name="nLimitPasteLength" value="0">',t+='<param name="sMaxWordFileSize" value="'+e.openDocument.word.maxSize+'">',t+='<param name="nMaxWordPageSize" value="'+e.openDocument.word.maxPage+'">',t+='<param name="sMaxExcelFileSize" value="'+e.openDocument.excel.maxSize+'">',t+='<param name="nMaxExcelSheetSize" value="'+e.openDocument.excel.maxSheet+'">',t+='<param name="sMaxPowerPointFileSize" value="'+e.openDocument.powerpoint.maxSize+'">',t+='<param name="nMaxPowerPointSlideSize" value="'+e.openDocument.powerpoint.maxSlide+'">',t+='<param name="nWordToHtml" value="1">',t+='<param name="nUseHwpApp" value="'+e.openDocument.useHwp+'">',t+='<param name="hasContainer" value="'+e.hasContainer+'">',t+='<param name="nUsePostContentType" value="'+e.imgUploadContenttype+'">',"0"!=e.security.encryptParam&&(t+='<param name="nPe" value="'+e.security.encryptParam+'">'),"0"==e.viewModeBrowserMenu&&(t+='<param name="keyInterface" value="ShowIEContextMenu">'),t+='<param name="nUseDragDrop" value="'+e.dragAndDropAllow+'">',r="";try{r=window.location.protocol+"//"+window.location.host}catch(i){}t+='<param name="strCookieURL" value="'+r+'">',t+='<param name="nUseHybrid" value="'+e.useHybrid+'">',t+='<param name="nModalWindow" value="'+e.hybridWindowMode+'">',t+='<param name="strPrintMargin" value="'+e.printMarginltrb+'">',t+='<param name="strKeepVersion" value="'+e.pluginKeepVersion+'">',""!=e.buttonText001&&(t+='<param name="sButtonText001" value="'+e.buttonText001+'">'),""!=e.maxImageFileSize&&"0"!=e.maxImageFileSize&&(t+='<param name="sMaxImageFileSize" value="'+e.maxImageFileSize+'">'),t+='<param name="nAllowedMultiImg" value="'+e.insertMultiImage+'">',t+='<param name="sOpenDocFilter" value="'+e.allowOpenFileType+'">',t+='<param name="nExcelImageCorrectly" value="'+e.excelImageFix+'">',""!=e.pluginTempPath&&(t+='<param name="sTempDirRoot" value="'+e.pluginTempPath+'">'),t+='<param name="nTempFolderCleanDay" value="'+e.removeTempFolderDataDay+'">',t+='<param name="nImgPopupViewMode" value="'+e.pasteToImagePopupMode+'">',DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&(t+='<param name="sProtectionMsoStyle" value="mso-spacerun\fmso-border-">'),e.fileFilterPlugin&&""!=e.fileFilterPlugin&&(t+='<param name="sOpenImageFilter" value="'+e.fileFilterPlugin+'">'),t+="</object>",n.innerHTML=t,document.body.appendChild(n),G_dext5plugIn=document.getElementById("dext5plugin");if("1"==e.dragAndDropAllow&&"ieplugin"==e.runtimes)var s=setInterval(function(){e.isLoadedEditor&&(setEnableDrapDropFile(),clearInterval(s))},100)}}function fn_createDialogHelperObject(){if(!G_dialogHelper){var e=document.createElement("div");e.innerHTML='<object id="dlgHelper" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px"></object>',document.body.appendChild(e),G_dialogHelper=document.getElementById("dlgHelper")}}function requestPluginInstall(e,t,n){var r=null,r=n?n:e.DEXTTOP.G_CURREDITOR._config;e=t.createElement("iframe"),e.name="download_frame",e.id="download_frame",e.style.display="none",t.body.appendChild(e),e=t.createElement("form"),e.target="download_frame",n="",n=""!=r.pluginInstallUrl?r.pluginInstallUrl:r.plugin_root+r.pluginInstallFileName,e.action=n,t.body.appendChild(e),e.submit(),t.body.removeChild(e)}function fnCommaExec(e){e=e.toString();if(3<e.length){var t=e.length%3,n=0<t?e.substring(0,t):"";for(i=0;i<Math.floor(e.length/3);i++)n=0==t&&0==i?n+e.substring(t+3*i,t+3*i+3):n+(","+e.substring(t+3*i,t+3*i+3));return n}return e}function cleanHTML(e){var t=e.match(RegExp("<img .*?>","ig"));if(t&&0<t.length)for(var n=t.length,r=0;r<n;r++)e=e.replace(t[r].toString(),"<dext_temp_tag"+r+">");e=e.replace(/(\n|\r| class=(")?Mso[a-zA-Z]+(")?)/g," "),e=e.replace(RegExp("<!--(.*?)-->","g"),""),n=RegExp("<(/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>","gi"),e=e.replace(n,"");for(var i="style script applet embed noframes noscript".split(" "),r=0;r<i.length;r++)n=new RegExp("<"+i[r]+".*?"+i[r]+"(.*?)>","gi"),e=e.replace(n,"");n=["style","start"];for(r=0;r<n.length;r++)e=e.replace(new RegExp(" "+n[r]+'="(.*?)"',"gi"),"");if(t&&0<t.length)for(n=t.length,r=0;r<n;r++)e=e.replace("<dext_temp_tag"+r+">",t[r]);return e}function removeCssInSelection(e){e=cleanHTML(e),null!=e&&void 0!=e&&""!=e&&replaceSelectionWithHtml(e)}function replaceSelectionWithHtml(e){var t=getFirstRange().range;if(0!=t.toString()){var n=!1,r=!1,i=getContainerForRemoveCss(t.startContainer),s=getContainerForRemoveCss(t.endContainer),o,u=!1;i&&0==!!s&&1==t.endContainer.nodeType&&"BODY"==t.endContainer.tagName&&(s=t.endContainer.childNodes[t.endOffset],o=s.cloneNode(!0),u=!0),t.startContainer==t.endContainer&&1==t.startContainer.nodeType&&"BODY"==t.startContainer.tagName?(i=s=t.startContainer,t.selectNodeContents(i)):DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&3==t.startContainer.nodeType&&1==t.endContainer.nodeType&&"BODY"==t.endContainer.tagName&&(i=s=t.startContainer,t.selectNodeContents(i)),t.deleteContents();var a=extractBlockContentsFromCaretForRemoveCss(!0);0==!!o&&(o=extractBlockContentsFromCaretForRemoveCss(!1));if(i!=s){var f=!1,l=!1;findParentNode(s,i)&&(f=!0),findParentNode(i,s)&&(l=!0),l?i=s:f&&(s=i)}var c=_iframeDoc.createElement("div");c.innerHTML=e,e=_iframeDoc.createDocumentFragment();for(var h,f=_iframeDoc.createDocumentFragment(),l=_iframeDoc.createDocumentFragment(),p=c.childNodes.length,d=0;h=c.firstChild;)d+=1,1==d?e.appendChild(h):1<p&&p==d?(DEXTTOP.DEXT5.browser.ie||""!=h.innerHTML||(h.innerHTML="<br>"),l.appendChild(h),u&&(h=s.cloneNode(!0),h.innerHTML=s.innerHTML,l.appendChild(h))):f.appendChild(h);DEXTTOP.G_CURREDITOR.selectionDextmark[0]=_iframeDoc.createElement("dextmark"),DEXTTOP.G_CURREDITOR.selectionDextmark[0].innerHTML=unescape("%u200B"),DEXTTOP.G_CURREDITOR.selectionDextmark[1]=_iframeDoc.createElement("dextmark"),DEXTTOP.G_CURREDITOR.selectionDextmark[1].innerHTML=unescape("%u200B");if(i==s){i.innerHTML="";if(a&&0<a.childNodes.length)if(IsEmptyNodes(a))n=!0;else for(;0<a.childNodes.length;)i.appendChild(a.childNodes[0]);else n=!0;!n||"P"!=i.tagName&&"DIV"!=i.tagName||(removeAttribute(i,"align"),removeAttribute(i,"style"),removeAttribute(i,"className"),removeAttribute(i,"bgcolor"));try{t.setStartAfter(i.lastChild)}catch(v){t.selectNodeContents(i)}i.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),a=e.childNodes.length,0<a&&i.appendChild(e),a=f.childNodes.length,0<a&&i.appendChild(f),a=l.childNodes.length,0<a&&i.appendChild(l),i.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[1]),i.lastChild?t.setEndAfter(i.lastChild):t.setEnd(i,i.innerHTML.length),o&&0<o.childNodes.length&&i.appendChild(o)}else{i.innerHTML="",s.innerHTML="";if(a&&0<a.childNodes.length)if(IsEmptyNodes(a))n=!0;else for(;0<a.childNodes.length;)i.appendChild(a.childNodes[0]);else n=!0;if(0==n){i.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[0]);try{t.setStartAfter(i.lastChild)}catch(m){t.selectNodeContents(i)}}else t.setStartAfter(i);u=t.cloneRange();if(n)t.insertNode(e),t.insertNode(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),t.setEndBefore(s),t.collapse(!1);else if(0<e.childNodes.length)if(h=e.childNodes[0],checkBlockTag(h.tagName))for(;0<h.childNodes.length;)i.appendChild(h.childNodes[0]);else i.appendChild(e);a=f.childNodes.length,0<a&&(t.setEndBefore(s),t.collapse(!1),t.insertNode(f)),o&&(0==o.childNodes.length||IsEmptyNodes(o))&&(r=!0);if(r)t.setEndBefore(s),t.collapse(!1),t.insertNode(DEXTTOP.G_CURREDITOR.selectionDextmark[1]),t.insertNode(l),t.setEndBefore(s);else{if(0<l.childNodes.length&&(h=l.childNodes[0],checkBlockTag(h.tagName)))if(0<h.childNodes.length)for(;0<h.childNodes.length;)s.appendChild(h.childNodes[0]);else s.appendChild(l);s.lastChild?t.setEndAfter(s.lastChild):t.setEnd(s,s.innerHTML.length)}0==r&&s.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[1]),o&&0<o.childNodes.length&&!IsEmptyNodes(o)&&s.appendChild(o),n?(t.setStartBefore(i),i.parentNode.removeChild(i)):t.setStart(u.startContainer,u.startOffset),r&&(t.setEndAfter(s.previousSibling),s.parentNode.removeChild(s))}setSelectionWithDextmark(t)}}function IsEmptyNodes(e){e=e.childNodes;for(var t=e.length,n=!0,r=null,i=0;i<t;i++){if(r=e[i])3===r.nodeType&&r.nodeValue&&0<r.nodeValue.length?n=!1:1===r.nodeType&&"IMG"!=r.tagName&&(r.hasChildNodes()&&0!=r.innerText.length?n=IsEmptyNodes(r):(r.parentNode.removeChild(e[i]),--i,--t));if(0==n)break}return n}function setSelectionWithDextmark(e,t){2==DEXTTOP.G_CURREDITOR.selectionDextmark.length?(0==!!e&&(getFirstRange().sel.removeAllRanges(),e=getFirstRange().range),1==t?(e.setStart(DEXTTOP.G_CURREDITOR.selectionDextmark[0],1),e.setEnd(DEXTTOP.G_CURREDITOR.selectionDextmark[1],0)):(e.setStartAfter(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),e.setEndBefore(DEXTTOP.G_CURREDITOR.selectionDextmark[1])),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e)):0<DEXTTOP.G_CURREDITOR.selectionDextmark.length&&2!=DEXTTOP.G_CURREDITOR.selectionDextmark.length&&(removeDextmark(),rangy.getSelection(_iframeWin).removeAllRanges())}function removeDextmark(e){for(var t=_iframeDoc.getElementsByTagName("dextmark"),n=t.length,r=n-1;0<=r;r--){if(r==n-1&&e)if(t[r].previousSibling)try{for(var i=t[r].previousSibling;;){if(null==i){i=i.parentNode;break}if(3==i.nodeType)break;if(!i.lastChild)break;i=i.lastChild}var s=getFirstRange(),o=s.range,u=s.sel;3==i.nodeType?o.setEnd(i,i.length):o.setEndAfter(i),o.collapse(!1),u.removeAllRanges(),u.addRange(o)}catch(a){doSetCaretPosition(t[r].previousSibling,1)}else t[r].parentNode&&doSetCaretPosition(t[r].parentNode,0);t[r].parentNode.removeChild(t[r])}DEXTTOP.G_CURREDITOR.selectionDextmark=[]}function parentTouchEndEvent(e){try{DEXTTOP.G_CURREDITOR._DOC.hasFocus()&&(DEXTTOP.G_CURREDITOR._BODY.blur(),setTimeout(function(){DEXTTOP.window.focus()},1))}catch(t){}}function touchEndEvent(e){try{G_IsTouchMoved&&setTimeout(setFocusToBody,0),G_IsTouchMoved=!1}catch(t){}}function touchMoveEvent(e){try{G_IsTouchMoved=!0}catch(t){}}function adjustInputChecked(e){var t=e,n="";try{var r=e.match(RegExp("<input *([^>?+])*>","gi"));if(r&&0<r.length){for(var i=r.length,s=0;s<i;s++){e=e.replace(r[s],"<dext_temp_input>");var o=r[s].toString();if(-1<o.toLowerCase().indexOf("radio")&&-1<o.toLowerCase().indexOf("checked=")){var u=">";-1<r[s].indexOf("/>")&&(u="/>"),r[s]=o.replace(u,' dext5checked=""'+u)}}for(s=0;s<i;s++)e=e.replace("<dext_temp_input>",r[s].toString())}n=e}catch(a){n=t}return n}function Dext5_PopupCenter(e,t,n,r,i,s,o,u){return e=window.open(e,t,o+", width="+n+", height="+r+", top="+(void 0!=i?i:screen.height/2-r/2-40)+", left="+(void 0!=s?s:screen.width/2-n/2)),window.focus&&e&&e.focus(),e}function closePluginInstall(){var e=getDialogDocument();e.getElementById("d5editor_install_div")&&e.getElementById("d5editor_install_div").parentNode.removeChild(e.getElementById("d5editor_install_div")),e.getElementById("d5editor_install_div_back")&&e.getElementById("d5editor_install_div_back").parentNode.removeChild(e.getElementById("d5editor_install_div_back")),e=getDialogWindow(),DEXTTOP.DEXT5.util.removeEvent(e,"resize",DEXTTOP.DEXT5.installGuideResizeEvt)}function adjustScroll(e){try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion){var t=Math.max(e._DOC.documentElement.scrollLeft,e._DOC.body.scrollLeft),n=Math.max(e._DOC.documentElement.scrollTop,e._DOC.body.scrollTop),r=getClientRect(e._EDITOR.design),i=r.bottom-r.top,s=0,o=0;t>r.right-r.left&&(s=t),n>i&&(o=n),(e._DOC.defaultView?e._DOC.defaultView:e._DOC.parentWindow).scroll(s,o)}}catch(u){}}function setImageBorder(e,t){try{if(""!=t.borderStyle){var n="";if("none"==t.borderStyle){var r=newNode.style.border;""!=r?0==r.indexOf("0px")||0==r.indexOf("none")?t.borderStyle="":n="0px solid rgb(0,0,0)":t.borderStyle=""}else r="",""!=t.borderKind?r=t.borderKind+" ":(""==t.borderWidth&&(t.borderWidth="0"),r=t.borderWidth+"px "),n=r+t.borderStyle+" "+t.borderColor;""!=n&&(e.style.border=n)}}catch(i){}return e}function getBorderAndCustomInfo(e){var t={originalSizeCheck:!1,borderJson:{borderStyle:"",borderWidth:"",borderColor:"",borderKind:""},imageText:e};try{var n="",r=e.lastIndexOf(">");-1<r&&(n=e.substring(r+1)),""!=n&&(t.imageText=e.substring(0,r+1)),0==n.indexOf("|")&&(t.originalSizeCheck=!0,n=n.substring(1));if(-1<n.indexOf("\f")){var i,s,o=n.split("\f");t.borderJson.borderWidth=o[0],s=o[1],"dot"==s?s="dotted":"dash"==s&&(s="dashed"),t.borderJson.borderStyle=s,i=o[2],"default"==i?i="":"normal"==i&&(i="medium"),t.borderJson.borderKind=i,t.borderJson.borderColor=o[3]}}catch(u){}return t}function setAutoBodyFit(e){try{if("1"==e._config.autoBodyFit){var t=parseIntOr0(e._setting.ruler_position),n=parseIntOr0(e._BODY.style.width);0<t&&t!=n&&(t=null,e._BODY.currentStyle?t=e._BODY.currentStyle:e._FRAMEWIN._iframeWin.getComputedStyle&&(t=e._FRAMEWIN._iframeWin.getComputedStyle(e._BODY,"")),t&&(n="",n=t.getProperty?t.getProperty("wordWrap"):t.wordWrap,"break-word"!=n&&(e._BODY.style.wordWrap="break-word"))),setBodyFitStyle(e,!0)}}catch(r){}}function removeDivInLiTag(e){var t=getFirstRange().range,n=null,r=!1;if(e)for(var n=[],t=["ol","ul","div"],i=t.length,s=0;s<i;s++){var o=e.getElementsByTagName(t[s]);try{n=n.concat(Array.prototype.slice.call(o,0))}catch(u){for(var a=o.length,f=0;f<a;f++)n.push(o[f])}}else n=getNodesInRange(t);t=n.length;try{for(s=0;s<t;s++)if(n[s].tagName&&"DIV"==n[s].tagName&&n[s].parentNode&&n[s].parentNode.tagName&&"LI"==n[s].parentNode.tagName){r=!0;break}}catch(l){}if(r){0==!!e&&makeRangeSelectionMarkInDesign();try{for(var c=n.length,r=0;r<c;r++){var h=n[r].nodeName.toLowerCase();if("ol"==h||"ul"==h){for(var p=n[r].getElementsByTagName("li"),d=p.length,c=0;c<d;c++)p[c].firstChild&&p[c].firstChild.tagName&&"DIV"==p[c].firstChild.tagName&&(p[c].innerHTML=p[c].firstChild.innerHTML,5>p[c].innerHTML.length&&0==p[c].innerHTML.indexOf("<br")&&(p[c].innerHTML=""));break}}}catch(v){}0==!!e&&setRangeSelectionMarkInDesign(!0)}}function isSelected(e){var t=!1;try{var n=null,n=e?e:getFirstRange().range;if(n.startContainer!=n.endContainer||n.startOffset!=n.endOffset)t=!0}catch(r){t=!1}return t}function correctionRange(e){DEXTTOP.DEXT5.browser.chrome&&e.startContainer==e.endContainer&&e.startOffset==e.endOffset&&e.startContainer.tagName&&"br"==e.startContainer.tagName.toLowerCase()&&(e.setStartBefore(e.startContainer),e.setEndAfter(e.startContainer),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e))}function removeTagStyle(e){if("1"==DEXTTOP.G_CURREDITOR._config.removeStyle.use)if(""==DEXTTOP.G_CURREDITOR._config.removeStyle.tag)for(var t=DEXTTOP.G_CURREDITOR._config.removeStyle.style.split(","),n=t.length,r=0;n>r;r++)""!=t[r]&&(e=e.replace(new RegExp(t[r]+':(([^;"]*;)|([^"]*))',"gi"),""));else for(var i=DEXTTOP.G_CURREDITOR._config.removeStyle.tag.split(","),s=i.length,t=DEXTTOP.G_CURREDITOR._config.removeStyle.style.split(","),n=t.length,r=0;s>r;r++)if(""!=i[r])for(var o=0;n>o;o++)""!=t[o]&&(e=e.replace(new RegExp("(<"+i[r]+"[^>]*)("+t[o]+':(([^;"]*;)|([^"]*)))',"gi"),"$1"));return e}function displayPageBreak(e){var t=null,n="";e?(t=getElementsByClass("DEXT_fiVe_Page_Break_None",_iframeDoc),n="DEXT_fiVe_Page_Break"):(t=getElementsByClass("DEXT_fiVe_Page_Break",_iframeDoc),n="DEXT_fiVe_Page_Break_None"),e=t.length;for(var r=0;e>r;r++)t[r].className=n}function getPersonalData(e){var t={};try{var n=getInnerText(_iframeDoc.body);"undefined"==typeof DEXT_PERSONAL_DATA_CONFIG&&(DEXT_PERSONAL_DATA_CONFIG={},-1<e._config.personalData.toLowerCase().indexOf("email")&&(DEXT_PERSONAL_DATA_CONFIG.email={regexp:RegExp("[_A-Za-z0-9-\\\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})","ig")}),-1<e._config.personalData.toLowerCase().indexOf("phone")&&(DEXT_PERSONAL_DATA_CONFIG.phone={regexp:RegExp("((\\+\\d{1,3}(-| |\\.)?\\(?\\d\\)?(-| |\\.)?\\d{1,5})|(\\d{2,6}\\)?))(-| |\\.)?(\\d{3,4})(-| |\\.)?(\\d{4})","g"),ignore:/(:?^\d{6}-\d{7})/}),-1<e._config.personalData.toLowerCase().indexOf("rrn")&&(DEXT_PERSONAL_DATA_CONFIG.rrn={regexp:RegExp("(\\d{2}(:?1[0-2]|0[1-9])(:?0[1-9]|[1-2]\\d|3[0-1])-?[1-4]\\d{6})","gm")}));for(var r in DEXT_PERSONAL_DATA_CONFIG)try{if(t[r]=n.match(DEXT_PERSONAL_DATA_CONFIG[r].regexp),t[r]&&DEXT_PERSONAL_DATA_CONFIG[r].ignore){for(var i=t[r].length-1;0<=i;i--)DEXT_PERSONAL_DATA_CONFIG[r].ignore.test(t[r][i])&&t[r].splice(i,1);0==t[r].length&&(t[r]=null)}}catch(s){}}catch(o){}return t}function getForbiddenWord(e){dext_src_init(e._EDITOR.design);var t=null;try{var n=getInnerText(_iframeDoc.body),r=e._config.forbiddenWord.split(","),i=r.length;for(e=0;e<i;e++){var s=null;(s=n.match(new RegExp(""+r[e]+"","ig")))&&(t=t?t.concat(s):s)}}catch(o){}return t}function getInnerText(e,t){var n="";try{n=e.innerHTML,n=n.replace(/\r/g,""),n=n.replace(/[\n|\t]/g,""),n=n.replace(/[\v|\f]/g,""),n=n.replace(/<span[^>]*>/gi,""),n=n.replace(/<\/span(\s[^\/]*)?>/gi,""),n=n.replace(/<p[^>]*><br><\/p(\s[^\/]*)?>/gi,"\n"),t||(n=n.replace(/<p[^>]*>&nbsp;<\/p(\s[^\/]*)?>/gi,"\n")),n=n.replace(/<br(\s)*\/?><\/p(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<br(\s[^\/]*)?><\/p(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<br(\s)*\/?><\/li(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<br(\s[^\/]*)?><\/li(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<br(\s)*\/?>/gi,"\n"),n=n.replace(/<br(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<\/tr(\s[^\/]*)?>/gi,"\n"),n=ReplaceAll(n,unescape("%u200B"),""),n=removeStripTags(n,null),n=unhtmlSpecialChars(n)}catch(r){}return n}function removeFindText(e,t){try{dext_src_init(t)}catch(n){}restoreSelection(),setFocusToBody();if(0!=e.length)try{var r=rangy.createRange(_iframeDoc);r.selectNodeContents(_iframeDoc.body);for(var i={caseSensitive:!1,wholeWordsOnly:!1,direction:"forward"};r.findText(e,i);){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),r.select(),r.deleteContents();try{var s="dexttemp",o=_iframeDoc.createElement(s);r.insertNode(o),r.setStartBefore(o),r.setEndBefore(o),o.parentNode.removeChild(o)}catch(u){for(var a=_iframeDoc.getElementsByTagName(s),f=a.length-1;0<=f;f--){var l=a[f];l.parentNode.removeChild(l)}}var c=getFirstRange().range.commonAncestorContainer;!c||1!=c.nodeType||""!=c.innerText&&" "!=c.innerText||(c.innerHTML="&nbsp;"),r=rangy.createRange(_iframeDoc),r.selectNodeContents(_iframeDoc.body),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}catch(h){}}function canConversion(){var e=!0,t;try{t=getFirstRange().range,"BODY"==t.commonAncestorContainer.tagName&&1<t.commonAncestorContainer.childNodes.length&&(e=!1),e&&-1<t.text().indexOf("\n")&&(e=!1)}catch(n){}return e}function getCheckSpelling(e){dext_src_init(e._EDITOR.design),restoreSelection(),setFocusToBody();if(null!=e.DEXT5WordApp){var t=_iframeDoc.body.innerText,t=t.replace(/[\r\n]+/gi,"\n"),t=t.split("\n"),n=t.length,r=[];try{for(var i=0;i<n;++i){var s=[],o=t[i];if(!/^\s*$/.test(o)&&!e.DEXT5WordApp.Application.CheckSpelling(o)){e.DEXT5WordDoc.Content=o;for(var u=1;u<=e.DEXT5WordDoc.SpellingErrors.Count;u++)for(var a=e.DEXT5WordDoc.SpellingErrors.Item(u),f=a.Words.Count,l=1;l<=f;l++){var c=a.Words.Item(l),h={};h.word=DEXTTOP.DEXT5.util.trim(c.Text),h.start=c.Start,h.length=DEXTTOP.DEXT5.util.trim(c.Text).length,h.suggestions=[];for(var p=c.GetSpellingSuggestions(),d=p.Count,v=1;v<=d;v++)h.suggestions.push(p.Item(v).Name);0<d&&1<DEXTTOP.DEXT5.util.trim(h.word).length&&s.push(h)}0<s.length&&(r=r.concat(s))}}}catch(m){}finally{e.DEXT5WordApp&&e.DEXT5WordApp.Quit(0),e.DEXT5WordApp=null,e.DEXT5WordDoc=null}return r}}function getAllTextNodeByNode(e){var t=[];if(e)for(e=e.firstChild;null!=e;)3==e.nodeType?t[t.length]=e:t=t.concat(getAllTextNodeByNode(e)),e=e.nextSibling;return t}function putUndoWordCount(e){if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&"1"==DEXTTOP.G_CURREDITOR._config.wordCount.limit&&"undefined"!=typeof e){var t="which"in e?e.which:e.keyCode;if(t&&(-1==",18,19,20,27,33,34,35,36,37,38,39,40,91,92,93,144,145,".indexOf(","+t+",")||e.shiftKey&&16!=t))try{if(0<DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline){var n=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,r=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,i=getInnerText(_iframeDoc.body,!0);e=0,i.match(/\n/gi)&&(e=i.match(/\n/gi).length),i=i.replace(/\r\n/gi,""),i=i.replace(/\n/gi,""),0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(i=i.replace(/\s/gim,""));var t=!1,s;s="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?i.length:DEXTTOP.DEXT5.getByteLength(i),"byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit&&0<n&&s+3>n?t=!0:0<n&&s==n?t=!0:0<r&&e==r&&(t=!0),t&&0<n&&s>n&&(t=!1),t&&(DEXTTOP.G_CURREDITOR.WordCountUndoManager.reset(),DEXTTOP.G_CURREDITOR.WordCountUndoManager.putUndo())}}catch(o){}}}function showWordCount(e){try{if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&(0<=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline)){if("undefined"!=typeof e){var t="which"in e?e.which:e.keyCode;if(0<=",18,19,20,27,33,34,35,36,37,38,39,40,91,92,93,144,145,".indexOf(","+t+",")||e.shiftKey&&16==t)return}var n=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,r=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,i=getInnerText(_iframeDoc.body,!0);e=0,i.match(/\n/gi)&&(e=i.match(/\n/gi).length),i=i.replace(/\r\n/gi,""),i=i.replace(/\n/gi,""),0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(i=i.replace(/\s/gim,"")),t=!0,""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(t=!1);var s="",o=dext5_lang.wordCount.Maximum_Line_Exceed.replace("{0}",r),s="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?dext5_lang.wordCount.Maximum_Bytes_Exceed.replace("{0}",n):dext5_lang.wordCount.Maximum_Characters_Exceed.replace("{0}",n);if(t){var u;u="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?i.length:DEXTTOP.DEXT5.getByteLength(i);if(0<n&&u>n||0<r&&e>r){if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.limitmessage){var a="";0<n&&u>n&&(a=s+"\n"),0<r&&e>r&&(a+=o),alert(a)}0==DEXTTOP.G_CURREDITOR.WordCountUndoManager.charCount&&DEXTTOP.G_CURREDITOR.WordCountUndoManager.putUndo(),DEXTTOP.G_CURREDITOR.WordCountUndoManager.execUndo()}}t&&(i=getInnerText(_iframeDoc.body,!0),e=0,i.match(/\n/gi)&&(e=i.match(/\n/gi).length),i=i.replace(/\r\n/gi,""),i=i.replace(/\n/gi,""),0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(i=i.replace(/\s/gim,""))),o="",0<r&&(o="/"+r);var f="["+dext5_lang.wordCount.Line+e+o+"]",l=document.getElementById("count_line_span_"+DEXTTOP.G_CURREDITOR.ID);l.innerHTML=f,l.style.color=0!=r&&e>=r?"red":"black",r="",0<n&&(r="/"+n),u="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?i.length:DEXTTOP.DEXT5.getByteLength(i);var i="",i="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?"["+dext5_lang.wordCount.Bytes+u+r+"]":"["+dext5_lang.wordCount.Characters+u+r+"]",c=document.getElementById("count_characters_span_"+DEXTTOP.G_CURREDITOR.ID);c.innerHTML=i,c.style.color=0!=n&&u>=n?"red":"black"}}catch(h){}}function pasteWordCount(e){var t=!0;if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&"1"==DEXTTOP.G_CURREDITOR._config.wordCount.limit)try{if(0<DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline){var n=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,r=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,i=getInnerText(_iframeDoc.body,!0),s=document.createElement("div");s.innerHTML=e,e=getInnerText(s,!0),i.match(/\n/gi),e.match(/\n/gi)&&e.match(/\n/gi),i=i.replace(/\r\n/gi,""),i=i.replace(/\n/gi,""),e=e.replace(/\r\n/gi,""),e=e.replace(/\n/gi,""),0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(i=i.replace(/\s/gim,""),e=e.replace(/\s/gim,""));var o,u,a;"char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?(o=i.length,u=e.length,a=getFirstRange().range.toString().length):(o=DEXTTOP.DEXT5.getByteLength(i),u=DEXTTOP.DEXT5.getByteLength(e),a=DEXTTOP.DEXT5.getByteLength(getFirstRange().range.toString())),e="",dext5_lang.wordCount.Maximum_Line_Exceed.replace("{0}",r),e="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?dext5_lang.wordCount.Maximum_Bytes_Exceed.replace("{0}",n):dext5_lang.wordCount.Maximum_Characters_Exceed.replace("{0}",n),0<n&&n<o-a+u&&("1"==DEXTTOP.G_CURREDITOR._config.wordCount.limitmessage&&alert(e),t=!1)}}catch(f){}return t}function pushAutoSave(e,t,n){for(;t<parseIntOr0(n)-1;t++){var r=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(e+"_"+(t+1));""!=r&&null!=r&&void 0!=r&&(DEXTTOP.DEXT5.util.saveJsonToLocalStorage(e+"_"+t,r),localStorage.removeItem(e+"_"+(t+1)))}}function delAutoSaveHtml(e,t,n){return localStorage.removeItem(e+"_"+t),pushAutoSave(e,t,n),null==localStorage[e+"_"+t]||void 0==localStorage[e+"_"+t]?!1:!0}function localSaveValue(e,t,n){for(var r=0;r<parseIntOr0(n);r++){var i=e+"_"+r,s=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(i),o={};null!=s&&void 0!=s&&(o="",o=s.html.toLowerCase().indexOf("<html"),o="1"==t?-1<o?DEXTTOP.DEXT5.util.makeEncryptParam(s.html):s.html:0>o?DEXTTOP.DEXT5.util.makeDecryptReponseMessage(s.html):s.html,o={date:s.date,html:o},localStorage.removeItem(i),DEXTTOP.DEXT5.util.saveJsonToLocalStorage(i,o))}}function autoSaveEnable(e){if(e=document.getElementById("dext_span_"+e+"load_auto_save")){var t=DEXTTOP.DEXT5.util.getClass(e);t&&-1<t.indexOf("_off")&&DEXTTOP.DEXT5.util.setClass(e,"uebutton_span_on")}}function setImageSizeForProperty(){for(var e=_iframeDoc.body.getElementsByTagName("img"),t=e.length,n=0;n<t;n++){var r=e[n];try{var i=r.style.width,s=r.style.height;if(-1<i.indexOf("px"))i=DEXTTOP.DEXT5.util.parseIntOr0(i);else var o=getClientRect(r),i=DEXTTOP.DEXT5.util.parseIntOr0(o.right-o.left);-1<s.indexOf("px")?s=DEXTTOP.DEXT5.util.parseIntOr0(s):(o=getClientRect(r),s=DEXTTOP.DEXT5.util.parseIntOr0(o.bottom-o.top)),r.setAttribute("width",i),r.setAttribute("height",s)}catch(u){r.removeAttribute("width"),r.removeAttribute("height")}}}function removeBackgroundColorInNodes(e,t,n){for(var r=_iframeDoc.createElement("div"),i=e.childNodes.length,s=0;s<i;s++){var o=e.childNodes[s];1==o.nodeType?("P"==o.tagName&&""==o.innerHTML&&("xp"==DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?o.innerHTML=unescape("%uFEFF"):o.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u200B"):"<br>"),r.innerHTML+=o.outerHTML):3==o.nodeType&&(r.innerHTML+=o.data)}r.innerHTML=CleanZeroChar(r.innerHTML),e=[],i=r.getElementsByTagName("*"),o=i.length;for(s=0;s<o;s++){var u=i[s].tagName.toLowerCase();0>n.indexOf(","+u+",")&&""!=i[s].style.backgroundColor&&(i[s].style.removeAttribute?i[s].style.removeAttribute(t):"backgroundColor"==t&&i[s].style.removeProperty("background-color"),void 0!=i[s].style.length?0==i[s].style.length&&1==i[s].attributes.length&&e.push(i[s]):(u=i[s].outerHTML.toLowerCase(),"span"==i[s].tagName.toLowerCase()&&0==u.indexOf("<"+i[s].tagName.toLowerCase()+">")&&e.push(i[s])))}for(s=e.length-1;0<=s;s--){for(;e[s].firstChild;)e[s].parentNode.insertBefore(e[s].firstChild,e[s]);e[s].parentNode.removeChild(e[s])}return r}function getApplyNodes(e){try{var t=getFirstRange().range,n,r;n=0==t.toString().length?[t.startContainer]:t.getNodes();if(1==n.length){var i=n[0];if(!(i.tagName&&-1<e.indexOf(i.tagName.toLowerCase())))for(;i=i.parentNode,!i.tagName||"body"!=i.tagName.toLowerCase();)if(i.tagName&&-1<e.indexOf(i.tagName.toLowerCase())){n=[i];break}}else{for(var s=n[0],o=n[n.length-1],i=s,u=o;!i.tagName||"body"!=i.tagName.toLowerCase();){if(i.tagName&&-1<e.indexOf(i.tagName.toLowerCase())){s=i;break}i=i.parentNode}for(;!u.tagName||"body"!=u.tagName.toLowerCase();){if(u.tagName&&-1<e.indexOf(u.tagName.toLowerCase())){o=u;break}u=u.parentNode}s==o&&(n=[s])}null!=t.startContainer.previousSibling&&"HEAD"==t.startContainer.previousSibling.tagName&&null==t.endContainer.nextSibling&&(n=t.getNodes());if(0<t.toString().length&&1<n.length&&1==n[0].nodeType&&"P"==n[0].tagName){var a=n[0].innerText||n[0].textContent;3==t.startContainer.nodeType&&null==t.startContainer.nextSibling&&(a=t.startContainer.nodeValue),s=!1,a.length==t.startOffset&&(s=!0),!s&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&2<=n.length&&0<t.startOffset&&3!=n[1].nodeType&&1==t.startContainer.nodeType&&(s=!0),s&&(t.setStartAfter(n[0]),n=t.getNodes())}r=n.length,t=[];for(a=0;a<r;a++)null!=n[a].parentNode&&1==n[a].nodeType&&n[a].tagName&&"body"!=n[a].tagName.toLowerCase()&&n[a].tagName&&-1<e.indexOf(n[a].tagName.toLowerCase())&&t.push(n[a]);return t}catch(f){}}function mouseMoveCaret(e,t){if(DEXTTOP.DEXT5.browser.ie)try{if(_iframeDoc.caretPositionFromPoint){var n=_iframeDoc.caretPositionFromPoint(e,t),r=_iframeDoc.createRange();r.setStart(n.offsetNode,n.offset),r.collapse()}else if(_iframeDoc.caretRangeFromPoint)r=_iframeDoc.caretRangeFromPoint(e,t);else if(_iframeDoc.body.createTextRange){var r=_iframeDoc.body.createTextRange();r.moveToPoint(e,t),r.select()}var i=_iframeDoc.getElementById("raonCaretTemp");i&&i.parentNode.removeChild(i),r.pasteHTML('<span id="raonCaretTemp" style="border:1px solid red;"></span>')}catch(s){console.log("catch : "+s.toString())}else if(n=getFirstRange().range,0==n.toString().length)try{createSelectionFromPoint(e,t,e,t),setFocusToBody(),(i=_iframeDoc.getElementById("raonCaretTemp"))&&i.parentNode.removeChild(i);var n=getFirstRange().range,o=_iframeDoc.createElement("span");o.id="raonCaretTemp",o.style.border="1px solid red",n.insertNode(o),null!=o.nextSibling&&doSetCaretPosition(o.nextSibling,!1)}catch(u){}}function setUserSetting(e,t){if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var n="",r="";if("personalSetting"==t)n="dext_personal_setting",r={fontFamily:e._setting.personal_font_family.toString(),fontSize:e._setting.personal_font_size.toString(),lineHeight:e._setting.personal_line_height.toString(),pasteToImage:e._setting.personal_paste_to_image};else if("ruler"==t){n="dext_"+e.ID+"_ruler",r="";if("2"==e._config.ruler.mode){var i=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+e.ID+"_ruler");i&&i.position&&(r=i.position)}else r=e._setting.ruler_position.toString();r={use:e._setting.ruler.toString(),position:r}}DEXTTOP.DEXT5.util.saveJsonToLocalStorage(n,r)}}function createNodeForCaret(e){for(var t=[],n=0;n<e;n++){var r=_iframeDoc.createElement("dextmark");r.setAttribute("class","dext_temp_caret"),r.innerHTML=unescape("%u200B"),t.push(r)}return t}function removeNodeForCaret(){for(var e=getElementsByClass("dext_temp_caret",_iframeDoc,"dextmark"),t=e.length-1;0<=t;t--)e[t].parentNode.removeChild(e[t])}function canMoveLiNode(e,t){var n=!1;if(1==t){var r=e.previousSibling;r&&(r=r.tagName,"LI"==r||"OL"==r||"UL"==r)&&(n=!0)}return n}function moveLiNode(e,t){var n=e.previousSibling;if(1==t){if(n){var r=n.tagName,i;if("LI"==r)i=n.getElementsByTagName(n.parentNode.tagName),r=n.innerHTML,r=r.replace(/(<([^>]+)>)/ig,""),"<br>"!=r&&""!=r||n.removeChild(n.firstChild),0<i.length?i=i[0]:(i=_iframeDoc.createElement(n.parentNode.tagName),i.style.listStyleType=getNextOlUlListStyle(n.parentNode),n.appendChild(i)),i.appendChild(e);else if("OL"==r||"UL"==r)i=n,i.appendChild(e);n=i.parentNode.innerHTML,n=n.replace(/<[oul].*/gim,""),n=n.replace(/[\r\n]/gim,""),0>n.indexOf(unescape("%u200B"))&&(n=_iframeDoc.createTextNode(unescape("%u200B")),i.parentNode.insertBefore(n,i)),setChildOlUlListStyle(e)}}else{i=e.parentNode;for(var n=i.parentNode,r=getFirstRange().range,s=e;null!=s.nextSibling;)s=s.nextSibling;r.setStartBefore(e),r.setEndAfter(s);for(var o=r.extractContents(),r=o.childNodes.length,s=[],u=r-1;0<=u;u--)s.push(o.childNodes[u]);for(var a=s[s.length-1].childNodes,f=a.length,o=null,l=[],u=0;u<f;u++){if("OL"==a[u].tagName||"UL"==a[u].tagName){o=a[u];break}l.push(a[u])}f=l.length,"LI"==n.tagName?(a=n.cloneNode(),a.innerHTML=""):a=_iframeDoc.createElement("p");for(u=0;u<f;u++)a.appendChild(l[u]);"LI"==n.tagName?(u=n.parentNode,n.nextSibling?u.insertBefore(a,n.nextSibling):u.appendChild(a)):i.nextSibling?n.insertBefore(a,i.nextSibling):n.appendChild(a),l=i.cloneNode(),l.innerHTML="";if(o){f=o.childNodes;for(u=f.length-1;0<=u;u--)l.firstChild?l.insertBefore(f[u],l.firstChild):l.appendChild(f[u]);o.parentNode.removeChild(o)}for(u=r-2;0<=u;u--)l.appendChild(s[u]);for(r=!1;i.firstChild;){if(!i.firstChild||"DEXTMARK"!=i.firstChild.tagName){r=!0;break}i.removeChild(i.firstChild)}0==r&&n.removeChild(i),0!=l.hasChildNodes()&&("LI"==a.tagName?(a.appendChild(l),setChildOlUlListStyle(a)):(a.nextSibling?n.insertBefore(l,a.nextSibling):n.appendChild(l),setChildOlUlListStyle(l)))}}function getNextOlUlListStyle(e){var t="",t=e.tagName.toLowerCase();return e=e.style.listStyleType.toLowerCase(),t="ol"==t?DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[e]?DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[e]:"upper-alpha":DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[e]?DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[e]:"circle"}function setChildOlUlListStyle(e){var t=[],n=e.tagName;if("LI"==n)t=e.getElementsByTagName(e.parentNode.tagName);else if("OL"==n||"UL"==n)for(var r=e.getElementsByTagName(n),i=r.length,n=0;n<i;n++)0==n&&t.push(e),t.push(r[n]);e=t.length;for(n=0;n<e;n++)if(r=t[n],i=GetParentbyTagName(r.parentNode,r.tagName.toLowerCase()))r.style.listStyleType=getNextOlUlListStyle(i)}function checkLastCaretForLi(e,t){if(3==e.nodeType&&e.nodeValue.length==t.endOffset)isLastOfNode=!0;else if(1==e.nodeType){var n=e.childNodes[t.endOffset];3==n.nodeType&&(t=getFirstRange().range,n.nodeValue.length!=t.endOffset||null!=n.nextSibling&&"OL"!=n.nextSibling.tagName&&"UL"!=n.nextSibling.tagName||(isLastOfNode=!0))}}function adjustLiNodeForArrowKey(e,t,n,r){t=getFirstRange().range;if("keydown"==e)if(0==t.toString().length){G_IsMulitSelectionInLi=!1;var i=t.startContainer,s=i;3==s.nodeType&&(s=s.parentNode),e=GetParentbyTagName(s,"li");if("OL"==s.tagName||"UL"==s.tagName)e=s.getElementsByTagName("li")[0];G_LastNodeForLi=e?e:null;if(e)if(13==n)if("LI"==e.parentNode.parentNode.tagName){if(i=e.innerHTML,i=i.replace(/(<([^>]+)>)/ig,""),""==i||i==unescape("%u200B")||"<br>"==i)DEXTTOP.DEXT5.util.cancelEvent(r),r=e.cloneNode(),r.id="",r.innerHTML=unescape("%u200B"),e.nextSibling?e.parentNode.insertBefore(r,e.nextSibling):e.parentNode.appendChild(r),t.setStartBefore(r.firstChild),t.setEndBefore(r.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)}else 0!=DEXTTOP.DEXT5.browser.ie||null!=e.previousSibling||null!=e.nextSibling||""!=e.innerHTML&&e.innerHTML!=unescape("%u200B")&&"<br>"!=e.innerHTML||(DEXTTOP.DEXT5.util.cancelEvent(r),moveLiNode(e,0));else if(8==n){if(0==t.startOffset){e=!1;for(i=3==i.nodeType?i.parentNode:i;;){if("LI"==i.tagName){e=!0;break}if("BODY"==i.tagName)break;if(i.parentNode.firstChild!=i)break;i=i.parentNode}if(e){("<br>"==i.innerHTML||"<br />"==i.innerHTML)&&i.firstChild&&i.removeChild(i.firstChild),e=i;var i=null,o=e.previousSibling;if(o){var i=o.getElementsByTagName("OL"),u=i.length,o=o.getElementsByTagName("UL");n=o.length,0<u||0<n?(s=null,0<u&&0==n?s=i[u-1]:0<n&&0==u&&(s=o[n-1]),i=s.lastChild):i=e.previousSibling}else"LI"==e.parentNode.parentNode.tagName&&e.parentNode.previousSibling&&(i=e.parentNode.parentNode);if(i){DEXTTOP.DEXT5.util.cancelEvent(r);for(r=null;e.hasChildNodes();)null==r&&(r=e.firstChild),e.parentNode.parentNode==i?i.insertBefore(e.firstChild,e.parentNode):i.appendChild(e.firstChild);u=e.parentNode,u.removeChild(e),0==u.getElementsByTagName("li").length&&u.parentNode.removeChild(u),r?(t.setStartBefore(r),t.setEndBefore(r)):(r=i.lastChild)?(t.setStartAfter(r),t.setEndAfter(r)):(r=_iframeDoc.createTextNode("%u200B"),i.appendChild(r),t.setStartBefore(r),t.setEndBefore(r),i.removeChild(r)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t),setChildOlUlListStyle(i)}}}}else if(46==n&&(n=!1,3==i.nodeType?i.nodeValue.length==t.endOffset?n=!0:i.nodeValue==unescape("%u200B")&&i.nodeValue.length==t.endOffset+1&&(n=!0):1==i.nodeType&&(t=getFirstRange().range,s=t.endContainer,3==s.nodeType?o=s.nodeValue.length:1==s.nodeType&&(o=s.childNodes.length,s.childNodes[t.endOffset]&&(1==s.childNodes[t.endOffset].nodeType&&"BR"==s.childNodes[t.endOffset].tagName?--o:3==s.childNodes[t.endOffset].nodeType&&s.childNodes[t.endOffset].nodeValue==unescape("%u200B")&&--o)),o==t.endOffset&&(null==s.nextSibling||"OL"==s.nextSibling.tagName||"UL"==s.nextSibling.tagName?(i=s,n=!0):"LI"==s.tagName&&(i=s,n=!0))),n)){for(o=n=!1;;){if(i.parentNode&&"LI"==i.parentNode.tagName){i.parentNode.lastChild==i?n=!0:!i.nextSibling||"OL"!=i.nextSibling.tagName&&"UL"!=i.nextSibling.tagName||(o=n=!0);break}if(null==i.parentNode||"BODY"==i.parentNode.tagName)break;i=i.parentNode}n&&(u=null,o?u=i.nextSibling:e.nextSibling?u=e.nextSibling:e.parentNode.parentNode.nextSibling?u=e.parentNode.parentNode.nextSibling:DEXTTOP.DEXT5.util.cancelEvent(r));if(u){DEXTTOP.DEXT5.util.cancelEvent(r),i=null,i=o?u.getElementsByTagName("li")[0]:u;for(r=null;i.hasChildNodes();)null==r&&(r=i.firstChild),o?u.parentNode.insertBefore(i.firstChild,u):e.appendChild(i.firstChild);u=i.parentNode,u.removeChild(i),o&&0==u.hasChildNodes()&&u.parentNode.removeChild(u),setChildOlUlListStyle(e),r&&(t.setStartBefore(r),t.setEndBefore(r),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))}}}else!DEXTTOP.DEXT5.browser.ie||13!=n&&8!=n&&46!=n||(s=i=t.startContainer,3==s.nodeType&&(s=s.parentNode),e=GetParentbyTagName(s,"li"),t=t.endContainer,3==t.nodeType&&(t=t.parentNode),t=GetParentbyTagName(t,"li"),(e||t)&&e!=t&&(isMulitSelectionInLi=!0,DEXTTOP.DEXT5.util.cancelEvent(r),alert(dext5_lang.msg.canNotDeleteLi)));else if("keyup"==e&&0==t.toString().length)if(s=i=t.startContainer,3==s.nodeType&&(s=s.parentNode),e=GetParentbyTagName(s,"li"),G_LastNodeForLi&&e&&G_LastNodeForLi!=e){if(r=e.innerHTML,r=r.replace(/<[oul].*/gim,""),r=r.replace(/[\r\n]/gim,""),""==r&&(r=_iframeDoc.createTextNode(unescape("%u200B")),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r=unescape("%u200B")),-1<r.indexOf(unescape("%u200B")))r==unescape("%u200B")?(t.setStartBefore(e.firstChild),t.setEndBefore(e.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)):3==i.nodeType?(r=i.nodeValue.indexOf(unescape("%u200B")),0==r&&1==i.nodeValue.length?((r=i.previousSibling)?3==r.nodeType&&(t.setStart(r,r.nodeValue.length),t.setEnd(r,r.nodeValue.length)):(t.setStartBefore(i),t.setEndBefore(i)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)):-1<r&&t.startOffset-1==r&&(t.setStart(i,t.startOffset-1),t.setEnd(i,t.startOffset-1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))):1==i.nodeType&&(i=i.childNodes[t.startOffset-1],t.setStart(i,i.nodeValue.length-1),t.setEnd(i,i.nodeValue.length-1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t));else if(i=null,0>r.indexOf(unescape("%u200B"))){e=e.childNodes,u=e.length;for(r=0;r<u;r++)if(e[r].tagName&&("OL"==e[r].tagName||"UL"==e[r].tagName)){i=e[r];break}i&&(r=_iframeDoc.createTextNode(unescape("%u200B")),i.parentNode.insertBefore(r,i),t.setStartBefore(r),t.setEndBefore(r),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))}}else if(e)if(39==n){if(3==i.nodeType&&(r=i.nodeValue.indexOf(unescape("%u200B")),-1<r&&t.startOffset>r)){i=null,u=e.childNodes,o=u.length;for(r=0;r<o;r++)if(u[r].tagName&&("OL"==u[r].tagName||"UL"==u[r].tagName)){i=u[r];break}u=null,i?u=i.getElementsByTagName("li")[0]:e.nextSibling&&(u=e.nextSibling),u&&(u.firstChild?(i=u.firstChild,t.setStartBefore(i),t.setEndBefore(i)):(i=_iframeDoc.createTextNode(unescape("%u200B")),u.appendChild(i),t.setStartBefore(i),t.setEndBefore(i),u.removeChild(i)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))}}else 37==n&&(3==i.nodeType?(r=i.nodeValue.indexOf(unescape("%u200B")),0==r&&1==i.nodeValue.length?((r=i.previousSibling)?3==r.nodeType&&(t.setStart(r,r.nodeValue.length-1),t.setEnd(r,r.nodeValue.length-1)):e!=G_LastNodeForLi&&(t.setStartBefore(i),t.setEndBefore(i)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)):-1<r&&t.startOffset-1==r&&(r=t.startOffset-2,0>r&&(r=0),t.setStart(i,r),t.setEnd(i,r),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))):1==i.nodeType&&0<=t.startOffset-1&&(i=i.childNodes[t.startOffset-1],t.setStart(i,i.nodeValue.length),t.setEnd(i,i.nodeValue.length),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t)));else if(G_LastNodeForLi&&null==e&&13==n&&(r=null,DEXTTOP.DEXT5.browser.gecko)){if(r=GetParentbyTagName(s,"div"))if(e=GetParentbyTagName(s,"ol"),i=GetParentbyTagName(s,"ul"),""!=r.innerHTML&&"<br>"!=r.innerHTML||null!=e||null!=i)r=null;r&&(e=_iframeDoc.createElement("p"),e.innerHTML="<br>",r.parentNode.insertBefore(e,r),r.parentNode.removeChild(r),t.setStartBefore(e.firstChild),t.setEndBefore(e.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t))}}function adjustOlUlTag(e){var t=[];t.push(e.getElementsByTagName("ol")),t.push(e.getElementsByTagName("ul")),e=t.length;for(var n=0;n<e;n++){var r=t[n];for(j=r.length-1;0<=j;j--){var i=r[j],s=i.parentNode;if(s&&("OL"==s.tagName||"UL"==s.tagName)){for(var o=i.previousSibling;null!=o&&"LI"!=o.tagName;)o=o.previousSibling;if(o){if(""==o.innerHTML||"<br>"==o.innerHTML)o.innerHTML=unescape("%u200B")}else o=_iframeDoc.createElement("li"),o.innerHTML=unescape("%u200B"),s.insertBefore(o,i);o.appendChild(i)}}}}function rulerStartDrag(e){G_CURR_DRAGGIN_RULER=e.target?e.target:e.srcElement;var t="",n=G_CURR_DRAGGIN_RULER.id.split("_");if(n[4]){for(var r=n.length,i=4;i<r;i++)t+=n[i],i!=r-1&&(t+="_");DEXTTOP.G_CURREDITOR=DEXTTOP.DEXT5.util._setDEXT5editor(t)}dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design),restoreSelection(),setFocusToBody(),t=getDialogWindow(),getDialogDocument(),n=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width),document.getElementById(G_CURR_DRAGGIN_RULER.id.replace("_point_","_pointline_")).style.display="";if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_0")||0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_1")||0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_3")){var r=document.getElementById("dext_ruler_point_2_"+DEXTTOP.G_CURREDITOR.ID),r=DEXTTOP.DEXT5.util.parseIntOr0(r.style.marginLeft),s=document.getElementById("dext_ruler_area_0"),i=DEXTTOP.DEXT5.util.parseIntOr0(s.style.left),s=DEXTTOP.DEXT5.util.parseIntOr0(s.style.width);G_RULER_MOVE_AREA.x1=i+s-n/2,G_RULER_MOVE_AREA.x2=r-30}else 0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_2")&&(i=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),r=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),i=DEXTTOP.DEXT5.util.parseIntOr0(i.style.marginLeft),r=DEXTTOP.DEXT5.util.parseIntOr0(r.style.marginLeft),G_RULER_MOVE_AREA.x1=(i>r?i:r)+30,s=document.getElementById("dext_ruler_area_1"),i=DEXTTOP.DEXT5.util.parseIntOr0(s.style.left)-n/2,G_RULER_MOVE_AREA.x2=i);e||(e=t.event),G_RULER_OFFSET_X=e.clientX,G_CURR_DRAGGIN_RULER.style.marginLeft||(G_CURR_DRAGGIN_RULER.style.marginLeft="0px"),G_RULER_COORD_X=parseInt(G_CURR_DRAGGIN_RULER.style.marginLeft),G_RULER_DRAG=!0,t=document.getElementById("ue_ruler_back_div"),t.style.display="",n=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID),t.style.width=n.style.width,t.style.height=n.style.height,DEXTTOP.DEXT5.util.addEvent(document,"mousemove",rulerDrag,!0),DEXTTOP.DEXT5.util.addEvent(document,"mouseup",rulerStopDrag,!0),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mousemove",rulerDrag,!0),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mouseup",rulerStopDrag,!0),DEXTTOP.DEXT5.util.cancelEvent(e)}function rulerDrag(e){if(G_RULER_DRAG){var t=getDialogWindow();getDialogDocument(),e||(e=t.event),getWindowClientSize(t),currentScrollPos=getWindowScrollPos(t),t=G_RULER_COORD_X+e.clientX-G_RULER_OFFSET_X;try{if(!(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)&&e.currentTarget==DEXTTOP.DEXTDOC)var n=getClientRect(DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID)),t=t-n.left}catch(r){}t<=G_RULER_MOVE_AREA.x1?t=G_RULER_MOVE_AREA.x1:t>=G_RULER_MOVE_AREA.x2&&(t=G_RULER_MOVE_AREA.x2);var n=!1,i=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.ruler.moveGap);1<i?t==G_RULER_MOVE_AREA.x1?n=!0:t==G_RULER_MOVE_AREA.x2?n=!0:0==(t+DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width)/2)%i&&(n=!0):n=!0,n&&(G_CURR_DRAGGIN_RULER.style.marginLeft=t+"px");var i=G_CURR_DRAGGIN_RULER.id,n=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width),i=i.replace("_point_","_pointline_"),i=document.getElementById(i),s=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.marginLeft)+n/2;i.style.left=s+"px";if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_0")){var n=document.getElementById("dext_ruler_point_3_"+DEXTTOP.G_CURREDITOR.ID),o=document.getElementById("dext_ruler_pointline_3_"+DEXTTOP.G_CURREDITOR.ID),t=t-parseIntOr0(n.style.marginLeft);n.style.marginLeft=parseIntOr0(n.style.marginLeft)+t+"px",o.style.left=parseIntOr0(o.style.left)+t+"px"}else if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_3")){var i=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),s=document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID),u=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),a=document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID),t=parseIntOr0(G_CURR_DRAGGIN_RULER.style.marginLeft)-parseIntOr0(i.style.marginLeft),o=!0,f=parseIntOr0(u.style.marginLeft)+t;f<=G_RULER_MOVE_AREA.x1?(f=G_RULER_MOVE_AREA.x1,o=!1):f>=G_RULER_MOVE_AREA.x2&&(f=G_RULER_MOVE_AREA.x2,o=!1),o?(u.style.marginLeft=f+"px",a.style.left=f+n/2+"px",i.style.marginLeft=parseIntOr0(i.style.marginLeft)+t+"px",s.style.left=parseIntOr0(s.style.left)+t+"px"):(n=document.getElementById("dext_ruler_point_3_"+DEXTTOP.G_CURREDITOR.ID),o=document.getElementById("dext_ruler_pointline_3_"+DEXTTOP.G_CURREDITOR.ID),f-=parseIntOr0(u.style.marginLeft),n.style.marginLeft=parseIntOr0(n.style.marginLeft)-t+f+"px",o.style.left=parseIntOr0(o.style.left)-t+f+"px",u.style.marginLeft=parseIntOr0(u.style.marginLeft)+f+"px",a.style.left=parseIntOr0(a.style.left)+f+"px",i.style.marginLeft=parseIntOr0(i.style.marginLeft)+f+"px",s.style.left=parseIntOr0(s.style.left)+f+"px")}DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e)}}function rulerStopDrag(e){getDialogDocument(),G_RULER_DRAG=!1,document.getElementById("ue_ruler_back_div").style.display="none";var t=document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID),n=document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID);e=document.getElementById("dext_ruler_pointline_2_"+DEXTTOP.G_CURREDITOR.ID),t=DEXTTOP.DEXT5.util.parseIntOr0(t.style.left),n=DEXTTOP.DEXT5.util.parseIntOr0(n.style.left),e=DEXTTOP.DEXT5.util.parseIntOr0(e.style.left),DEXTTOP.G_CURREDITOR._setting.ruler_position=t+","+n+","+e,e=G_CURR_DRAGGIN_RULER.id,t=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width),n=e.replace("_point_","_pointline_"),n=document.getElementById(n),t=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.marginLeft)+t/2,n.style.left=t+"px",0==e.indexOf("dext_ruler_point_0")||0==e.indexOf("dext_ruler_point_1")||0==e.indexOf("dext_ruler_point_3")?"1"==DEXTTOP.G_CURREDITOR._config.ruler.useInoutdent&&setNodeStyleForRulerMode(1):0==e.indexOf("dext_ruler_point_2")&&"1"==DEXTTOP.G_CURREDITOR._config.ruler.useInoutdent&&setNodeStyleForRulerMode(2),document.getElementById(G_CURR_DRAGGIN_RULER.id.replace("_point_","_pointline_")).style.display="none",DEXTTOP.DEXT5.util.removeEvent(document,"mousemove",rulerDrag,!0),DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",rulerStopDrag,!0),DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mousemove",rulerDrag,!0),DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mouseup",rulerStopDrag,!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function setNodeStyleForRulerMode(e){var t=document.getElementById("dext_ruler_area_0"),n=DEXTTOP.DEXT5.util.parseIntOr0(t.style.left)+DEXTTOP.DEXT5.util.parseIntOr0(t.style.width),t=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID).style.left)-n,n=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID).style.left)-n-t,r=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_2_"+DEXTTOP.G_CURREDITOR.ID).style.left),i=document.getElementById("dext_ruler_area_1"),r=DEXTTOP.DEXT5.util.parseIntOr0(i.style.left)-r,i=getFirstRange().range,s=!1;i.startContainer&&"BODY"==i.startContainer.tagName&&i.endContainer&&"BODY"==i.endContainer.tagName&&(s=!0);for(var i=s?DEXTTOP.G_CURREDITOR._BODY.childNodes:getNodesInRange(i),s=i.length,o=0;o<s;o++){var u=i[o];if("P"==u.tagName||"LI"==u.tagName)1==e?(u.style.marginLeft=t+"px",u.style.textIndent=n+"px"):u.style.marginRight=r+"px"}}function setRulerMode2Position(e,t){if("design"==t._newMode){var n=t._DOC.documentElement.scrollLeft||t._BODY.scrollLeft||0,r=DEXTTOP.DEXT5.util.parseIntOr0(e.style.textIndent),i=DEXTTOP.DEXT5.util.parseIntOr0(e.style.marginLeft),s=DEXTTOP.DEXT5.util.parseIntOr0(e.style.marginRight),o=getClientRect(e),u=DEXTTOP.DEXT5.util.parseIntOr0(o.left),a=DEXTTOP.DEXT5.util.parseIntOr0(o.right),f=document.getElementById("dext_ruler_point_0_"+t.ID),l=document.getElementById("dext_ruler_point_1_"+t.ID),c=document.getElementById("dext_ruler_point_2_"+t.ID),h=document.getElementById("dext_ruler_point_3_"+t.ID),p=DEXTTOP.DEXT5.util.parseIntOr0(f.style.width),o=document.getElementById("dext_ruler_pointline_0_"+t.ID),d=document.getElementById("dext_ruler_pointline_1_"+t.ID),v=document.getElementById("dext_ruler_pointline_2_"+t.ID),m=document.getElementById("dext_ruler_pointline_3_"+t.ID);"1"==t._config.ruler.useInoutdent&&(f.style.marginLeft=u-p/2+"px",o.style.left=u+"px",l.style.marginLeft=u+r-p/2+"px",d.style.left=u+r+"px",c.style.marginLeft=a-p/2+"px",v.style.left=a+"px",h.style.marginLeft=u-p/2+"px",m.style.left=u+"px"),f=document.getElementById("dext_ruler_area_0"),l=document.getElementById("dext_ruler_area_1"),c=h=r=c=0,r=a+s,h=u-i,0>h&&(h=0),getCurrEditorWidth(),f.style.width=h+"px",l.style.width="100%",f.style.left=c+"px",l.style.left=r+"px",G_RULER_MOVE_AREA.x1=c+h,G_RULER_MOVE_AREA.x2=r,i=0==c+h?u+n:c+h+n,G_RULER_MOVE_AREA.realX1=i,G_RULER_MOVE_AREA.realX2=r+n,"1"==t._config.ruler.useInoutdent&&(t._setting.ruler_position=DEXTTOP.DEXT5.util.parseIntOr0(o.style.left)+n+","+(DEXTTOP.DEXT5.util.parseIntOr0(d.style.left)+n)+","+(DEXTTOP.DEXT5.util.parseIntOr0(v.style.left)+n))}}function setRulerPositionForNode(e,t){var n;n=e?e:DEXTTOP.G_CURREDITOR;if(1==n.isInitFocusHandler&&0==n._config.initFocus)n.isInitFocusHandler=!1;else if("2"==n._config.ruler.mode&&"none"!=document.getElementById("dext_tab_tool3_"+n.ID).style.display){var r=null!=t&&void 0!=t&&t&&0==n._config.initFocus&&DEXTTOP.DEXT5.browser.ie,i=null;r||(i=getFirstRange().range);if(i||r){var s=null;r?s=n._DOC.getElementsByTagName("p")[0]:(s=i.startContainer,3==s.nodeType&&(s=s.parentNode)),r=GetParentbyTagName(s,"p"),null==r&&(r=GetParentbyTagName(s,"li")),null!=r||"BODY"!=s.tagName&&9!=s.nodeType||(r=n._DOC.getElementsByTagName("p")[0],n._dextframeHasFocus&&n._DOC.body.focus()),r&&setRulerMode2Position(r,n)}}}function getCurrEditorWidth(){var e=null,e=getClientRect(document.getElementById("editorContentArea"));return e=e.right-e.left}function setAutoUrlHyperLink(e,t){if("0"!=DEXTTOP.G_CURREDITOR._config.autoUrlDetect){var n=null;try{var r="which"in e?e.which:e.keyCode,i="",s=null,o=t.range,u=!1;if(32==r&&o.startOffset==o.endOffset&&"3"==o.endContainer.nodeType)s=o.startContainer,i=o.endContainer.nodeValue,i=i.substring(0,o.endOffset-1);else if(13==r&&!e.shiftKey){var a=GetParentbyTagName(o.startContainer,"p");a&&a.previousSibling&&a.previousSibling.lastChild&&(s=a.previousSibling.lastChild,"1"==s.nodeType?i=s.textContent:"3"==s.nodeType&&(i=s.nodeValue),s.previousSibling&&"A"==s.previousSibling.tagName&&(u=!0,i=s.previousSibling.textContent+i))}o=!1,r=0,-1<i.toLowerCase().indexOf("http:")?(i=i.substring(i.toLowerCase().lastIndexOf("http:")),o=!0,r=0):-1<i.toLowerCase().indexOf("https:")?(i=i.substring(i.toLowerCase().lastIndexOf("http:")),o=!0,r=0):-1<i.toLowerCase().indexOf("www.")&&(i=i.substring(i.toLowerCase().lastIndexOf("www.")),o=!0,r=1);if(o&&(i=i.replace(/[,!@#^&*()_+={}[;:".~`><]$/g,""),i=i.replace(/\u00A0/g,""),o=null,0==r?o=i.match(/^(https?|ftp):\/\/(-\.)?([^\s\/?\.#]+\.?)+(\/[^\s]*)?[^\s\.,]$/i):1==r&&(o=i.match(/(www\.)?([^\s\/?\.#]+\.?)+(\/[^\s]*)?[^\s\.,]$/i)),o)){var n=saveSelection(DEXTTOP.G_CURREDITOR.ID,!0),f=rangy.createRange(_iframeDoc);0==u&&f.selectNodeContents(s),f.findText(i,{caseSensitive:!1,wholeWordsOnly:!1,direction:"forward"})&&(f.select(),1==r&&(i="http://"+i),i={type:"hyperlink",url:i,target:"_blank",attr_info_arr:[]},command_InsertHyperLink(DEXTTOP.G_CURREDITOR.ID,document.getElementById("dext5_design_"+DEXTTOP.G_CURREDITOR.ID),i)),restoreSelection(n,!0)}}catch(l){null!=n&&restoreSelection(n,!0)}}}function setContentChangeKeyEvent(e,t){if(("function"==typeof DEXTTOP.dext_editor_contentsize_change_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange)&&38!=t&&40!=t&&37!=t&&39!=t&&36!=t&&35!=t&&33!=t&&34!=t)try{0<G_KEY_IMG_COUNT&&G_KEY_IMG_COUNT!=_iframeDoc.getElementsByTagName("img").length&&(G_KEY_IMG_COUNT=-1,contentChangeEventWrapper())}catch(n){}}function contentChangeEventWrapper(e,t){if("function"==typeof DEXTTOP.dext_editor_contentsize_change_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange){var n=[],r=0,i=_iframeDoc.getElementsByTagName("img"),s=!0;"undefined"!=typeof DEXTTOP.DEXT5.config.ContentSizeChangeEvent&&!1===DEXTTOP.DEXT5.config.ContentSizeChangeEvent.UseGetContentSize&&(s=!1);if(G_IMG_TOTAL_COUNT==i.length){var o=!0;try{for(var u=0,a=i.length;u<a;u++){if("undefined"==typeof G_IMG_CURRENT_LIST[i[u].src]){o=!1,G_IMG_CURRENT_LIST[i[u].src]=0;break}if(G_IMG_CURRENT_ARRAYLIST.length==a&&G_IMG_CURRENT_ARRAYLIST[u]!=i[u].src){o=!1;break}}}catch(f){o=!1}if(o)return}if(null!=e&&"object"==typeof e){if("img"!=e.nodeName.toLowerCase())return;r=0,DEXTTOP.DEXT5.util.checkUrlForContentSizeCheckEvent(e.src)&&n.push(e)}else if(null==e||"undefined"==typeof e){if(null==i||i&&0==i.length){if(-1==G_IMG_TOTAL_SIZE||0!=G_IMG_TOTAL_SIZE||0==s){G_IMG_TOTAL_COUNT=G_IMG_TOTAL_SIZE=0,G_IMG_CURRENT_LIST={},G_IMG_CURRENT_ARRAYLIST=[];try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:0}):DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:0})}catch(l){}}return}u=0;for(a=i.length;u<a;u++)DEXTTOP.DEXT5.util.checkUrlForContentSizeCheckEvent(i[u].src)&&n.push(i[u]);r=1}if(0==n.length){G_IMG_CURRENT_LIST={},G_IMG_TOTAL_SIZE=0;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:0}):DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:0})}catch(c){}}else{for(var h=[],p=[],u=0,a=n.length;u<a;u++)"undefined"==typeof G_IMG_TOTAL_LIST[n[u].src]?h.push(n[u].src):p.push(n[u].src);var d=0;G_IMG_TOTAL_COUNT=i.length,-1==G_IMG_TOTAL_SIZE&&(G_IMG_TOTAL_SIZE=0);if(0==h.length){G_IMG_CURRENT_LIST={},G_IMG_CURRENT_ARRAYLIST=[],u=0;for(a=i.length;u<a;u++)"undefined"!=typeof G_IMG_TOTAL_LIST[i[u].src]&&(d+=G_IMG_TOTAL_LIST[i[u].src],G_IMG_CURRENT_LIST[i[u].src]=G_IMG_TOTAL_LIST[i[u].src],G_IMG_CURRENT_ARRAYLIST.push(i[u].src));if(G_IMG_TOTAL_SIZE!=d){G_IMG_TOTAL_SIZE=d;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:d}):DEXTTOP.dext_editor_contentsize_change_event
(DEXTTOP.G_CURREDITOR.ID,{image:d})}catch(v){}}}else if(0==s)try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:d}):DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:d})}catch(m){}else DEXTTOP.DEXT5.GetFileSizeEx(h,function(e){if(0==r)d=G_IMG_TOTAL_SIZE+parseInt(e),G_IMG_TOTAL_LIST[h]=parseInt(e),G_IMG_CURRENT_LIST[h]=parseInt(e);else if(1==r){G_IMG_CURRENT_LIST={},G_IMG_CURRENT_ARRAYLIST=[];for(var t=0,n=p.length;t<n;t++)"undefined"!=G_IMG_TOTAL_LIST[p[t]]&&(d+=G_IMG_TOTAL_LIST[p[t]],G_IMG_CURRENT_LIST[p[t]]=G_IMG_TOTAL_LIST[p[t]],G_IMG_CURRENT_ARRAYLIST.push(p[t]));t=0,n=h.length;for(e=(e+"").split(",");t<n;t++)""==e[t]&&(e[t]=0),d+=parseInt(e[t]),G_IMG_TOTAL_LIST[h[t]]=parseInt(e[t]),G_IMG_CURRENT_LIST[h[t]]=parseInt(e[t]),G_IMG_CURRENT_ARRAYLIST.push(h[t])}if(G_IMG_TOTAL_SIZE!=d){G_IMG_TOTAL_SIZE=d;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:d}):DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:d})}catch(i){}}},DEXTTOP.G_CURREDITOR.ID)}}}function getWidthForAutoBodyFit(e,t){var n;n="table"==t?e._defTableWidth:e._defaultWidth;if("1"==e._config.autoBodyFit){var r=DEXTTOP.DEXT5.util.parseIntOr0(e._BODY.style.width);0==r&&"0"==e._config.ruler.fixEditorWidth&&(r=getClientRect(e._BODY),r=r.right-r.left),0<r&&(n=r,"1"==e._config.defaultBodySpace.use&&(n-=DEXTTOP.DEXT5.util.parseIntOr0(e._config.defaultBodySpace.configValue.left)))}return n}function findUrlInText(e,t){var n={changedData:"",matchArr:null,tempUrlPattern:unescape("%u200B")+"dext5_url_{0}"+unescape("%u200B")};if("1"==t._config.autoUrlDetect)try{var r=e,i=r.match(/((^https?:\/\/)|(\shttps?:\/\/))[\S]{1,}/gi);if(i){for(var s=i.length,o=0;o<s;o++)r=r.replace(DEXTTOP.DEXT5.util.trim(i[o]),n.tempUrlPattern.replace("{0}",o)),i[o]=i[o].replace(/&/g,"&amp;");n.changedData=r,n.matchArr=i}}catch(u){}return n}function replaceRealUrl(e){for(var t=e.matchArr.length,n=0;n<t;n++){var r='<a href="'+(0>e.matchArr[n].indexOf("://")?"http://"+e.matchArr[n]:e.matchArr[n])+'">'+e.matchArr[n]+"</a>";e.changedData=e.changedData.replace(e.tempUrlPattern.replace("{0}",n),r)}return e.changedData}function getFirstChildNodeForCaret(e){if(e.firstChild)for(e=e.firstChild;;){if(3==e.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+e.tagName.toLowerCase()+",")){e=e.parentNode;break}if("BR"==e.tagName){e=e.parentNode;break}if(null==e.firstChild)break;e=e.firstChild}return e}function getLastChildNodeForCaret(e){"TABLE"==e.tagName&&(e=e.getElementsByTagName("td"),e=e[e.length-1]);for(;null!=e.lastChild;)e=e.lastChild;if(3==e.nodeType||e.tagName&&-1<",br,img,input,iframe,object,video,".indexOf(","+e.tagName.toLowerCase()+","))e=e.parentNode;return e}function setToolbarScroll(e,t){if(DEXTTOP.DEXT5.browser.mobile&&"1"==e._config.useAutoToolbar){var n=document.getElementById("ue_editor_main_"+e.ID),r=getClientRect(n),n=document.getElementById("dext_tab_tool1_"+e.ID),i=document.getElementById("dext_tab_tool2_"+e.ID);n.style.width=r.width-10+"px",i.style.width=r.width-10+"px",t&&(r=document.createElement("div"),r.id="toolbar2_hidden",r.style.display="none",document.body.appendChild(r),hiddenIconForAutoToolbar(e),n.style.overflowX="auto",i.style.overflowX="auto",DEXTTOP.DEXT5.util.addEvent(n,"scroll",toolbarScrollEvent),DEXTTOP.DEXT5.util.addEvent(i,"scroll",toolbarScrollEvent),createMobileScrollIcon(e,n),createMobileScrollIcon(e,i)),showMobileScrollIcon(n),showMobileScrollIcon(i)}}function createMobileScrollIcon(e,t){for(var n=1;2>=n;n++){var r=document.createElement("div");r.id=t.id+"_scroll_icon_"+n,r.className="scroll_icon_"+e._config.style.skinName+"_"+n,r.style.display="none",t.appendChild(r)}}function showMobileScrollIcon(e){var t=e.clientWidth,n=e.scrollWidth;document.getElementById(e.id+"_scroll_icon_2").style.display=n>t&&t+e.scrollLeft<n?"":"none"}function toolbarScrollEvent(e){var t=e.srcElement;e=DEXTTOP.DEXT5.util.parseIntOr0(t.clientWidth);var n=DEXTTOP.DEXT5.util.parseIntOr0(t.scrollLeft),r=DEXTTOP.DEXT5.util.parseIntOr0(t.scrollWidth),i=document.getElementById(t.id+"_scroll_icon_1"),t=document.getElementById(t.id+"_scroll_icon_2");i.style.display=0==n?"none":"",1>=Math.abs(n-(r-e))?t.style.display="none":n<r-e&&(t.style.display="")}function hiddenIconForAutoToolbar(e){var t=document.getElementById("dext_tab_tool2_"+e.ID);e=document.getElementById("toolbar2_hidden");for(var t=t.childNodes,n=t.length-1;0<=n;n--){var r=t[n];"SPAN"==r.tagName&&("ue_SM"==r.className?r.parentNode.removeChild(r):e.appendChild(r))}}function adjustTextPasteForPlugin(e){return"5,0,0,45"<=G_dext5plugIn.getDext5PluginVersion()?e="1"==DEXTTOP.G_CURREDITOR._config.pasteTextLineBreak?addLineBreaker("p",e):DEXTTOP.DEXT5.util.escapeHtml(e):(e=e.replace(/&lt;/g,"<DeXt5_Lt>"),e=e.replace(/&gt;/g,"<DeXt5_Gt>"),e=e.replace(/&nbsp;&nbsp;/g,"<DeXt5_NbSp>"),e=e.replace(/&/g,"&amp;"),e=e.replace(/<DeXt5_Lt>/g,"&lt;"),e=e.replace(/<DeXt5_Gt>/g,"&gt;"),e=e.replace(/<DeXt5_NbSp>/g,"&nbsp;&nbsp;")),e}function getHTMLForAutoSave(e,t){var n="";ReplaceImageToRealObject(!1,!1),DEXTTOP.DEXT5.util.postimageToServer(e._DOC,e._config.mimeUse,e._config),"/"==e._config.serverDomain&&DEXTTOP.DEXT5.util.removeDomainFromIMGObject(e._DOC);var r=e._DOC.cloneNode(!0);try{for(var i in G_DEPlugin)"function"==typeof G_DEPlugin[i].onBeforeGetApi&&G_DEPlugin[i].onBeforeGetApi({targetDoc:r})}catch(s){}ReplaceRealObjectToImage(),clearAllFormControlSelected(r),ClearDraggingTableAllTable(r),"1"==e._config.formMode&&ReplaceCustomDataToRealEvent(r),setMatchSelectedValue(r),setMatchInputValue(r,!0),adjustInputNodeForFF(r,!1),setEmptyTagWhiteSpace(e,r),n=r.body,n.style.transformOrigin&&""!=n.style.transformOrigin&&(n.style.transformOrigin=""),n.style.transform&&""!=n.style.transform&&(n.style.transform=""),n.style.zoom&&""!=n.style.zoom&&(n.style.zoom="");switch(t){case"doctype":n="",void 0!=e._PageProp.doctype&&0<e._docType[e._PageProp.doctype].length&&(n=e._docType[e._PageProp.doctype]),n+=r.documentElement.outerHTML;break;case"htmlEx":n=r.documentElement.outerHTML;break;case"html":n=r.documentElement.innerHTML;break;case"bodyEx":n=r.body.outerHTML;break;default:n=r.body.innerHTML}return n=insertCarriageReturn(e,n),delete r,""!=e._config.placeholder.content&&(placeholderControl(e,"set"),placeholderControl(e,"class")),n}function setBodyFitStyle(e,t){if(!("1"!=e._config.ruler.use||"0"==e._config.useNoncreationAreaBackground||DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)))if(t){var n=parseIntOr0(document.getElementById("ue_editor_holder_"+e.ID).style.height);e._BODY.style.minHeight=(n-parseIntOr0(e._config.defaultBodySpace.configValue.top))/n*100+"%",e._BODY.style.position="absolute";if(null==e._BODY.style.backgroundColor||void 0==e._BODY.style.backgroundColor||""==e._BODY.style.backgroundColor)e._BODY.style.backgroundColor="#ffffff";e._BODY.parentNode.style.backgroundColor="#e6e6e6","2"==e._config.ruler.mode&&(getEditorFrameDoc(e).getElementById("dext_tab_tool4_"+e.ID).style.backgroundColor="#e6e6e6")}else e._BODY.style.minHeight="",e._BODY.style.position="","#ffffff"==e._BODY.style.backgroundColor&&(e._BODY.style.backgroundColor=""),e._BODY.parentNode.style.backgroundColor=""}function removeEmptyTagByBackspace(e){"keydown"==e.type&&(G_KeydownNode=null);var t="which"in e?e.which:e.keyCode;if(DEXTTOP.DEXT5.browser.ie&&(8==t||46==t))try{var n=getFirstRange().range;if(n.startContainer==n.endContainer&&0==n.startOffset&&0==n.endOffset){var r=3==n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;r==(3==n.endContainer.nodeType?n.endContainer.parentNode:n.endContainer)&&(0==r.childNodes.length||1==r.childNodes.length&&"BR"==r.childNodes[0].tagName)&&-1<",span,b,strong,i,italic,underline,u,strike,em,sup,sub,".indexOf(","+r.tagName.toLowerCase()+",")&&("keyup"==e.type?(G_KeydownNode==r&&(n.setStartBefore(r),n.setEndBefore(r),getFirstRange().sel.removeAllRanges(),getFirstRange().sel.addRange(n),r.parentNode.removeChild(r)),G_KeydownNode=null):G_KeydownNode=r)}}catch(i){G_KeydownNode=null}}function fn_saveToLocalStorage(e,t){var n=!0,r=e._config.setAutoSave.use_encrypt,i=e._config.setAutoSave.unique_key,s="dext_"+e.ID;""!=i&&(s+="_"+i);for(var o=DEXTTOP.DEXT5.isEmpty(e.ID,!0),u="",i=parseIntOr0(e._config.setAutoSave.maxCount),a=parseIntOr0(e._config.setAutoSave.maxCount)-1;0<=a;a--)u=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(s+"_"+a),null==u&&void 0==u&&(i=a);return 0==o?(o="",o="1"==r?DEXTTOP.DEXT5.util.makeEncryptParam(t):t,r={date:e._DOC.lastModified,html:o},i>parseIntOr0(e._config.setAutoSave.maxCount)-1&&(--i,pushAutoSave(s,0,e._config.setAutoSave.maxCount)),DEXTTOP.DEXT5.util.saveJsonToLocalStorage(s+"_"+i,r),showTemporarilySaveMessage(e),autoSaveEnable(e.ID)):n=!1,n}function fn_AutoSaveInterval(e,t){var n=e._setting.auto_save.toString().split(",");return DEXTTOP.DEXTWIN.setInterval(function(){if(DEXTTOP&&DEXTTOP.G_CURREDITOR){if(!isViewMode(DEXTTOP.G_CURREDITOR)){var t="",n=e.getEditorMode();if("design"==n)t=DEXTTOP.DEXT5.getHtmlValueExWithDocType(e.ID,!0);else if("source"==n){n=e._EDITOR.source.value,n=n.replace(/\t/g,"");if("1"==e._config.sourceViewtype||"2"==e._config.sourceViewtype)n=removeCRLFChar(n);n=DEXTTOP.DEXT5.util.htmlRevision(n),n=xssReplaceScript(null,n),"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(n=DEXTTOP.DEXT5.util.ImageSrcConvert(n,!0,DEXTTOP.G_CURREDITOR.ID));var t=e._docType[e._PageProp.doctype],r=e._PageProp.lang,i=e._PageProp.xmlnsname,s=_iframeDoc.getElementsByTagName("head")[0].outerHTML,o=_iframeDoc.getElementsByTagName("body")[0],u="<html";0<r.length&&(-1<r.indexOf("-")&&(r=r.split("-")[0]),u+=' lang="'+r+'" xml:lang="'+r+'"'),0<i.length&&(u+=' xmlns="'+i+'"'),i=o.id,r="<body>",""!=i&&null!=i&&void 0!=i&&(r="<body id='"+o.id+"'>"),t=t+(u+">")+s+r+n+"<body></html>"}else"preview"==n?(n=e._EDITOR.preview.contentDocument?e._EDITOR.preview.contentDocument:e._EDITOR.preview.contentWindow.document,t=e._docType[e._PageProp.doctype],t+=n.documentElement.outerHTML):"text"==n&&(t=e._EDITOR.text.value);fn_saveToLocalStorage(e,t)}}else try{clearInterval(e._setting.auto_save_fn)}catch(f){}},6e4*(n[1]?n[1]:e._config.setAutoSave.interval))}function showTemporarilySaveMessage(e){try{var t=e._FRAMEWIN.document.getElementById("editor_temporarily_message");if(t){for(var n=t.parentNode.childNodes,r=n.length,i=0;i<r;i++)1==n[i].nodeType&&n[i]!=t&&"none"!=n[i].style.display&&(n[i].setAttribute("d_temp_display",n[i].style.display),n[i].style.display="none");t.innerHTML='<span style="color:black; margin-top:1px; margin-right:10px;">'+e._FRAMEWIN.dext5_lang.msg.manually_temp_save+"</span>",t.style.display="",setTimeout(function(){try{t.style.display="none";for(var e=0;e<r;e++)1==n[e].nodeType&&n[e]!=t&&null!=n[e].getAttribute("d_temp_display")&&(n[e].style.display=n[e].getAttribute("d_temp_display"),n[e].removeAttribute("d_temp_display"))}catch(i){}},2e3)}}catch(s){}}function adjustInputNodeForFF(e,t){if(0!=DEXTTOP.DEXT5.browser.gecko)try{if(t){for(var n=e.getElementsByTagName("input"),r=n.length-1;0<=r;r--)if(n[r].isContentEditable&&"checkbox"==n[r].type||"radio"==n[r].type&&"dextinputholder"!=n[r].parentNode.tagName.toLowerCase()){var i=e.createElement("dextinputholder");i.contentEditable=!1;var s=n[r].parentNode;s.insertBefore(i,n[r]),i.appendChild(n[r])}}else for(var o=e.getElementsByTagName("dextinputholder"),r=o.length-1;0<=r;r--)s=o[r].parentNode,s.insertBefore(o[r].firstChild,o[r]),s.removeChild(o[r])}catch(u){}}function setColorPickerHeight(e,t){e.getElementById("popupCover").style.height=t+5+"px"}function replaceLineBreak(e,t){var n=t;if("0"!=e._config.replaceLineBreak)try{"1"==e._config.replaceLineBreak&&(n=n.replace(/([\r\n ]{2,}|[\r\n])</g,"<temp_text2><"));for(var r=["pre","textarea"],i=r.length,s=0;s<i;s++)n=n.replace(new RegExp("(<"+r[s]+"[^>]*>)([\\s\\S]*?)<\\/"+r[s]+">","gi"),function(e){return e=DEXTTOP.DEXT5.util.trim(e).replace(/\r\n/g,"<temp_text>"),e=DEXTTOP.DEXT5.util.trim(e).replace(/\n/g,"<temp_text>"),e=DEXTTOP.DEXT5.util.trim(e).replace(/\r/g,"<temp_text>")});n=DEXTTOP.DEXT5.util.trim(n).replace(/\n/g," "),n=DEXTTOP.DEXT5.util.trim(n).replace(/<temp_text>/g,"\n"),"1"==e._config.replaceLineBreak&&(n=n.replace(/<temp_text2>/g,"\r\n"))}catch(o){n=str}return n}function AdjustDesignBodyWidth(e){if("ios"==DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()&&"13">DEXTTOP.DEXT5.UserAgent.os.version){var t=e.editor;e.isApply?(e=document.body.clientWidth,e<t._BODY.clientWidth&&(t.backupWidthForIOS.backupWidth=""!=t._BODY.style.width?t._BODY.style.width:"",t._BODY.style.width=e+"px",t._BODY.setAttribute("iosWidth","true"))):((e=t._BODY.getAttribute("iosWidth"))&&"true"==e&&(t._BODY.style.width=""!=t.backupWidthForIOS.backupWidth?t.backupWidthForIOS.backupWidth:"",t._BODY.removeAttribute("iosWidth")),t.backupWidthForIOS.isPopup=!1)}}function checkContentEditable(e,t){var n=!0;if("2"==e._config.editorBodyEditableMode){if("HTML"==t.tagName)return!0;DEXTTOP.DEXT5.browser.ie?n=t.isContentEditable:"TEXTAREA"==t.tagName?1==t.disabled&&(n=!1):"INPUT"==t.tagName?""!=t.type&&"text"!=t.type||1!=t.disabled||(n=!1):n=t.isContentEditable}return n}function copyImageToTempFolder(e){if(G_dext5plugIn&&1==G_dext5plugIn.getHTMLFormatFromType||G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType){e=e.getElementsByTagName("img");for(var t=e.length,n=0;n<t;n++){var r=e[n].src;if(0==r.indexOf("file:")&&0>r.indexOf("\\dext5Temp\\")){var i="";try{i=G_dext5plugIn.GetCopyImageToTemp(r)}catch(s){r=G_dext5plugIn.getBase64ImageFromLocalImage(r).split(","),i=getExtFromImageDataSrc(r[0]),i=G_dext5plugIn.getLocalImageFromBase64Image(r[1],i)}i="file:///"+i,e[n].src=i}}}}function hyperHelpOpen(e,t){var n=DEXTTOP.G_CURREDITOR,r=getDialogDocument();if(r.getElementById("dext_context_iframe")&&"none"==r.getElementById("dext_context_iframe").style.display)if((n.isAOver.node||n.isAOver.nodeChild)&&n.isAOver.over){currElem=n.isAOver.node,r=document.getElementById("dext_div_hyper_link_help"),document.getElementById("dext_div_hyper_link_help_content").innerHTML=currElem.getAttribute("href"),r.style.display="block",n.isAOver.nodeChild&&(currElem=n.isAOver.nodeChild);var i=getClientRect(_iframeWin.frameElement),s=Math.round(e+document.body.scrollLeft+document.documentElement.scrollLeft),o=Math.round(t+document.body.scrollTop+document.documentElement.scrollTop),u=0;i.right-s<r.clientWidth&&(u=r.clientWidth-(i.right-s)+10),i.bottom-(o+i.top)<r.clientHeight?r.style.bottom=i.bottom-(o+i.top)+r.clientHeight+2+"px":r.style.top=o+i.top+2+"px",r.style.left=s-u+3+"px",n.isAOver.openHelp=!0}else DEXTTOP.G_CURREDITOR.isAOver.node=null,DEXTTOP.G_CURREDITOR.isAOver.nodeChild=null}function hyperHelpClose(){var e=DEXTTOP.G_CURREDITOR,t=document.getElementById("dext_div_hyper_link_help");t.style.display="none",removeAttribute(t.style,"bottom"),removeAttribute(t.style,"top"),removeAttribute(t.style,"left"),e.isAOver={over:!1,node:null,nodeChild:null,openHelp:!1}}function hyperLinkIn(){var e=DEXTTOP.G_CURREDITOR;e.isAOver.node&&(null==e.isAOver.node.getAttribute("target")&&(e.isAOver.node.setAttribute("target","_blank"),e.isAOver.addTarget=!0),e.isAOver.node.setAttribute("contenteditable","false"),e.isAOver.node.style.cursor="pointer",e.isAOver.nodeChild&&(e.isAOver.nodeChild.setAttribute("contenteditable","false"),e.isAOver.nodeChild.style.cursor="pointer",null==e.isAOver.node.getAttribute("target")&&(e.isAOver.nodeChild.setAttribute("target","_blank"),e.isAOver.addTarget=!0)),e.isAOver.linkStyle=!0)}function hyperLinkOut(){var e=DEXTTOP.G_CURREDITOR;e.isAOver.node&&(1==e.isAOver.node.style.length?e.isAOver.node.removeAttribute("style"):removeAttribute(e.isAOver.node.style,"cursor"),removeAttribute(e.isAOver.node,"contenteditable"),e.isAOver.addTarget&&e.isAOver.node.removeAttribute("target"),e.isAOver.nodeChild&&(1==e.isAOver.nodeChild.style.length?removeAttribute(e.isAOver.nodeChild,"style"):removeAttribute(e.isAOver.nodeChild.style,"cursor"),removeAttribute(e.isAOver.nodeChild,"contenteditable"),e.isAOver.addTarget&&e.isAOver.nodeChild.removeAttribute("target")),e.isAOver.addTarget=!1,e.isAOver.linkStyle=!1)}function focusToElement(e){if(e&&e.getBoundingClientRect){e=e.getBoundingClientRect();var t=getWindowClientSize(_iframeWin);0>e.top?scrollToTop(getScrollTop()+e.top):e.bottom>t[1]&&scrollToTop(getScrollTop()+e.bottom-t[1])}}function getScrollTop(){return DEXTTOP.DEXT5.util.browser.ie?_iframeWin.documentElement.scrollTop:_iframeDoc.body.scrollTop}function scrollToTop(e){DEXTTOP.DEXT5.util.browser.ie?_iframeWin.documentElement.scrollTop=e:_iframeDoc.body.scrollTop=e}function adjustIEEnterBug(e){var t=e.event;try{if(DEXTTOP.DEXT5.browser.ie&&0==t.ctrlKey&&0==t.altKey&&13==e.keyCode){var n=getFirstRange(),r=n.range.startContainer;if(r==n.range.endContainer&&1==r.nodeType&&"SPAN"==r.tagName&&""==(void 0!=r.innerText?r.innerText:r.textContent)&&1==r.childNodes.length){for(e=null;null!=r;){if(null==r.lastChild&&"BR"==r.tagName){e=r;break}if(r=r.lastChild,r.childNodes&&1<r.childNodes.length)break}e&&(n.range.setStartAfter(e),n.range.setEndAfter(e),n.sel.removeAllRanges(),n.sel.addRange(n.range))}}}catch(i){}}function removeDummyDivInHwp(e){if("1"==DEXTTOP.G_CURREDITOR._config.removeDummyDivInHwpPaste)if("string"==typeof e){var t=RegExp('<div [^>].*id="hwpEditorBoardContent".*><!--(:?.|\\s)*--><\\/div>',"gi");if(t.test(e))return e=e.replace(t,"")}else for(var t=e.getElementsByTagName("div"),n=t.length-1;0<=n;n--){var r=t[n];r&&"hwpEditorBoardContent"==r.id&&r.childNodes&&1==r.childNodes.length&&8==r.childNodes[0].nodeType&&r.parentNode.removeChild(r)}if("string"==typeof e)return e}function setNodeWidthHeight(e,t){try{for(s in t){var n="",r=t[s];""!=r?(n=""!=e.style[s]?"style":e.getAttribute(s)&&""!=e.getAttribute(s)?"attr":"style","style"==n?e.style[s]=r:e.setAttribute(s,DEXTTOP.DEXT5.util.parseIntOr0(r))):(e.removeAttribute(s),e.style.removeAttribute?e.style.removeAttribute(s):e.style.removeProperty(s))}}catch(i){}}function getNodeWidthHeight(e,t){var n="";return""!=e.style[t]?n=e.style[t]:e.getAttribute(t)&&""!=e.getAttribute(t)&&(n=e.getAttribute(t)),n}function getFileName(e,t){for(var n;-1!==e.indexOf("\\");)e=e.replace("\\","/");return n=e.split("/").pop(),t&&(n=n.slice(0,n.lastIndexOf("."))),n}function checkClickOnScrollBar(e){var t=!1;if((e.target?e.target:e.srcElement)==_iframeDoc.documentElement&&(e.clientX>=_iframeDoc.documentElement.clientWidth&&(t=!0),0==t)){var n=0,n=DEXTTOP.DEXT5.browser.ie?_iframeDoc.documentElement.clientHeight:_iframeDoc.body.clientHeight;e.clientY>=n&&(t=!0)}return t}function preventScrollMove(e){e?(e=DEXTTOP.G_CURREDITOR.preventScrollMove,e.use=!0,e.beforeTop=_iframeDoc.documentElement.scrollTop,e.beforeLeft=_iframeDoc.documentElement.scrollLeft):setTimeout(function(){DEXTTOP.G_CURREDITOR.preventScrollMove.use=!1},1)}function setDisableUndoRedo(e,t){t.disableUndoRedo=0<=t._config.undoLimitLength?DEXTTOP.DEXT5.browser.ie&&e.length>=t._config.undoLimitLength?!0:!1:!1}function adjustSizeInContainer(e){var t=function(e){return e=getNodeWidthHeight(e,"width"),e.indexOf("px")?e=DEXTTOP.DEXT5.util.parseIntOr0(e):(e=getClientRect(parent),e=e.right-e.left),e},n=function(e){for(var n=e.length-1;0<=n;n--){var r=e[n];t(r)>=i&&("IMG"==r.tagName&&(r.style.removeAttribute?r.style.removeAttribute("height"):r.style.removeProperty("height")),r.style.width="100%")}};if("1"==DEXTTOP.G_CURREDITOR._config.autoFitInHolder){var r=function(){var e=getFirstRange().range.startContainer;return 3==e.nodeType&&(e=e.parentNode),e}();if(r=getParentbyTagNameEx(r,"td,th,div")){var i=t(r);if(0<i){if(e.strHtml){r=document.createElement("div"),r.innerHTML=e.strHtml,e=["table","img"];for(var s=e.length,o=0;o<s;o++){var u=r.getElementsByTagName(e[o]);n(u)}return r.innerHTML}e.nodes&&(u=e.nodes,"undefined"==typeof u.length&&(u=[u]),n(u))}}}if("string"==typeof e.strHtml)return e.strHtml}function getCurrentZoomValue(e){var t=1;try{var n=e._BODY.style.transform;""!=n&&(n=n.replace("scale(",""),t=parseFloat(n))}catch(r){t=1}return 0==t&&(t=1),t}function pluginInsertImageAutoFit(e){var t=e.src;if(0<G_dext5plugIn.getImageWidthHeight(t).length){var n=e.style.width.replace("px","");""==n&&(n=e.width);var r=e.style.height.replace("px","");""==r&&(r=e.height);var i=n+"^"+r,s="",o="",u=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth;""!=u&&(u=DEXTTOP.DEXT5.util.parseIntOr0(u),DEXTTOP.DEXT5.util.parseIntOr0(n)>u&&(s=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth,DEXTTOP.G_CURREDITOR._config.imgDefaultWidth=n)),n=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight,""!=n&&(n=DEXTTOP.DEXT5.util.parseIntOr0(n),DEXTTOP.DEXT5.util.parseIntOr0(r)>n&&(o=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight,DEXTTOP.G_CURREDITOR._config.imgDefaultHeight=r)),SetImageAutoFitSize(e,t+"?"+i),""!=s&&(DEXTTOP.G_CURREDITOR._config.imgDefaultWidth=s),""!=o&&(DEXTTOP.G_CURREDITOR._config.imgDefaultHeight=o)}}function placeholderControl(e,t){if("remove"==t)0==e._BODY.classList.length?e._BODY.removeAttribute("class"):e._BODY.classList.remove("dext_placeholder"),e._DOC.getElementById("dext_placeholder")&&e._DOC.getElementById("dext_placeholder").parentNode.removeChild(e._DOC.getElementById("dext_placeholder"));else if("set"==t){if(!e._DOC.getElementById("dext_placeholder")){var n=document.createElement("style");n.setAttribute("id","dext_placeholder"),n.innerHTML=".dext_placeholder:before { content: '"+DEXTTOP.G_CURREDITOR._config.placeholder.content+"'; color: "+DEXTTOP.G_CURREDITOR._config.placeholder.fontColor+"; font-size: "+DEXTTOP.G_CURREDITOR._config.placeholder.fontSize+"; font-family: "+DEXTTOP.G_CURREDITOR._config.placeholder.fontFamily+"; display: block; position: absolute; white-space: pre; }",e._DOC.getElementsByTagName("head")[0].appendChild(n)}}else if("class"==t)if(0<e._BODY.childNodes.length&&"edit"==e._config.mode){var n=e._BODY.innerHTML,r=e._BODY.innerText,n=n.replace(/<head(.*?)>(.*?)<(\/?)head>/gi,""),n=n.replace(/<title(.*?)>(.*?)<(\/?)title>/gi,""),n=n.replace(/<style(.*?)>(.*?)<(\/?)style>/gi,""),n=n.replace(/<meta(.*?)>(.*?)<(\/?)meta>/gi,""),n=n.replace(/<meta(.*?)>/gi,""),n=n.replace(/<br \/>/i,""),n=n.replace(/<br>/i,"");DEXTTOP.DEXT5.browser.ie&&10==DEXTTOP.DEXT5.browser.ieVersion&&(n=n.replace(/&nbsp;/i,""),n=" "==r?r:n),n=n.replace(/<p *([^>?+])*><\/p>/i,""),""==n?e._BODY.classList.add("dext_placeholder"):0==e._BODY.classList.length?e._BODY.removeAttribute("class"):e._BODY.classList.remove("dext_placeholder")}else"edit"==e._config.mode&&e._BODY.classList.add("dext_placeholder")}function getReplaceMsoStyleReg(e){var t=DEXTTOP.G_CURREDITOR._config.replaceMsoStyle.styleValue[e],n="(\\s?"+e+")";return t&&(n="(\\s?"+e+":\\s*"+t+")([^>]*)>"),n}function execReplaceMsoStyle(e){var t=e;try{for(var n=DEXTTOP.G_CURREDITOR._config.replaceMsoStyle,r=0;r<n.settingStyle.length;r++){var i=getReplaceMsoStyleReg(n.settingStyle[r]);reg_exp=new RegExp(i,"gi"),reg_exp.test(t)&&(t=t.replace(reg_exp,"$1 $2 "+n.settingStyle[r].replace("mso",n.replaceAttributeName)+">"))}}catch(s){t=e}return t}function restoreValueInSetError(e){try{e&&(e.setValueIsBusy=!1)}catch(t){}}function externalPageBreakDataRaplaceInEditor(e){try{if(-1<e.indexOf("page-break")){var t=RegExp("(<span [^>]*>)(<br .*page-break)(.*?>)(.*?>)","gi"),n=getPageBreakOuterHTML();e=e.replace(t,n),t=RegExp("(<br .*page-break)(.*?>)","gi"),e=e.replace(t,n)}}catch(r){}return e}function insertCarriageReturnBeforeCloseCell(e){if(!DEXTTOP.DEXT5.browser.ie)return e;try{return e.replace(RegExp("(\\/(?:p|div)>)(<\\/t[dh]>)","gi"),"$1\n$2")}catch(t){return e}}function removeEditorAttribute(e){try{var t=RegExp('(<t[dh][^>]*)( dext_select="true")',"gi");t.test(e)&&(e=e.replace(t,"$1")),t=RegExp('(<t[dh][^>]*)( cellorgbgcolor=".*?"| cellorgbgcolor)',"gi"),t.test(e)&&(e=e.replace(t,"$1")),t=RegExp('(<table[^>]*)( DEXT5CellSelected=".*?")',"gi"),t.test(e)&&(e=e.replace(t,"$1"))}catch(n){}return e}function adjustMsoBorder(e){var t=e;if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion)return t;if(RegExp("<t[dh] [^>]+mso-border[^>]*>","gi").test(t)){e=document.createElement("div"),e.innerHTML=t;for(var n=["td","th"],t=[],r=0;r<n.length;r++){var i=e.getElementsByTagName(n[r]);try{t=t.concat(Array.prototype.slice.call(i,0))}catch(s){for(var o=i.length,u=0;u<o;u++)t.push(i[u])}}n=t.length;for(r=0;r<n;r++){i=t[r],u=i.tagName,o={};if(DEXTTOP.DEXT5.browser.ie)o=i.style;else{u=new RegExp("(<"+u+" [^>]*>)","i"),u.test(i.outerHTML);var a=RegExp.$1,a=a.replace(/\n|\t|\s{2,}/gi,""),u=/style="[^"](.*)"/i;if(u.test(a))for(var a=RegExp.$1,u=a.split(";"),a=u.length,f=0;f<a;f++){var l=u[f].split(":");if(2==l.length){var c=DEXTTOP.DEXT5.util.trim(l[0]),l=DEXTTOP.DEXT5.util.trim(l[1]);o[c]?o[c].length<l.length&&(o[c]=l):o[c]=l}}}u=["Top","Bottom","Left","Right"],a=u.length;for(f=0;f<a;f++)if((c=o["mso-border-"+u[f].toLowerCase()+"-alt"])&&0<c.length){c=c.split(" ");if(3!=c.length){var l=o["mso-border-style-alt"],h=o["mso-border-width-alt"];1==c.length?(l&&0<l.length&&(-1<c[0].indexOf("pt")&&(c[2]=c[0]),c[0]=l),h&&0<h.length&&(c[2]=h)):2==c.length&&(c[2]=c[1],c[1]="")}0<c.length&&"none"==i.style["border"+u[f]+"Style"]&&(i.style["border"+u[f]+"Style"]=c[0],i.style["border"+u[f]+"Width"]=c[2])}}t=e.innerHTML}return t}function setLiStyle(){for(var e=getFirstRange().range,t=getNodesInRange(e),n=t.length,e=function(e){var t=e;t.firstChild&&"DIV"==t.firstChild.tagName&&(t=t.firstChild);var n=!1;1!=t.childNodes.length||"SPAN"!=t.childNodes[0].tagName&&3!=t.childNodes[0].nodeType?2!=t.childNodes.length||"BR"!=t.childNodes[1].tagName||"SPAN"!=t.childNodes[0].tagName&&3!=t.childNodes[0].nodeType||(n=!0):n=!0;if(n){t=t.childNodes[0],3==t.nodeType&&(t=t.parentNode);var r=DEXTTOP.DEXT5.util.getStyle,n=r(t,"fontFamily"),i=r(t,"fontSize"),r=r(t,"color");n!=DEXTTOP.G_CURREDITOR._config.defaultFontFamily&&(e.style.fontFamily=n),i!=DEXTTOP.G_CURREDITOR._config.defaultFontSize&&(e.style.fontSize=i),""!=r&&""!=t.style.color&&(e.style.color=r)}},r=!1,i=[],s=!1,o=0;o<n;o++){var u=t[o].nodeName.toLowerCase();if("ol"==u||"ul"==u)r=!0,i.push(t[o]);"li"==u&&(s=!0,e(t[o]))}if(1==r&&0==s)for(o=i.length-1;0<=o;o--)for(t=i[o].getElementsByTagName("li"),n=t.length,r=0;r<n;r++)e(t[r])}function getPasteFormatType(){var e="";if("DOC"==G_wordProcessorType||G_dext5plugIn&&1==G_dext5plugIn.getHTMLFormatFromType)e="DOC";else if("XLS"==G_wordProcessorType||G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType)e="XLS";else if("PPT"==G_wordProcessorType||G_dext5plugIn&&3==G_dext5plugIn.getHTMLFormatFromType)e="PPT";else if("HWP"==G_wordProcessorType||G_dext5plugIn&&4==G_dext5plugIn.getHTMLFormatFromType)e="HWP";return e}function getXhrResponseData(e){var t={status:"",bodyText:""};try{e&&(t.status=e.status,t.bodyText=e.responseText)}catch(n){}return t}function getDisplayFontName(e,t){var n=DEXTTOP.G_CURREDITOR;t&&(n=t);var r=e,n=n._config.displayFontFamilyList;return"object"==typeof n&&"[object Object]"==Object.prototype.toString.call(n)&&(r=n[e],0==!!r&&(r=e)),r}function getRealNameThroughDisplayName(e,t){var r=DEXTTOP.G_CURREDITOR;t&&(r=t);var i=e,r=r._config.displayFontFamilyList;if("object"==typeof r&&"[object Object]"==Object.prototype.toString.call(r))for(n in r)if(r[n]==e){i=n;break}return i}function setEditorHtmlWidth(e){var t=e._config;e=_iframeDoc.documentElement;var n=_iframeDoc.body.style.width;-1!=n.indexOf("px")&&(n=parseInt(n,10),t=n+parseIntOr0(t.defaultBodySpace.configValue.left)+parseIntOr0(t.defaultBodySpace.configValue.right),e.style.width=t+"px")}function replaceColorRgbToHex(e){var t=e;try{e=e.replace(RegExp("<[^>]+style=(.*?)>","gi"),function(e){return e=e.replace(RegExp("(rgb\\(\\d+,\\s*\\d+,\\s*\\d+\\)*)","gi"),function(e){return DEXTTOP.DEXT5.util.rgb2hex(e)})})}catch(n){return t}return e}function command_bold(e,t){dext_src_init(t._EDITOR.design);var n={document:_iframeDoc,styleWithCss:!1,tagName:"strong"};restoreSelection(),setFocusToBody();var r=getFirstRange();DoExecuteCommand(r.sel,r.range,"bold",n)}function command_italic(e,t){dext_src_init(t._EDITOR.design);var n={document:_iframeDoc,styleWithCss:!1,tagName:"i"};restoreSelection(),setFocusToBody();var r=getFirstRange();DoExecuteCommand(r.sel,r.range,"italic",n)}function command_formatting(e,t,n){dext_src_init(t),n.toLowerCase(),restoreSelection(),setFocusToBody(),e=getFirstRange(),""==n?DoExecuteCommandFormatting(e,"p",!1):DoExecuteCommandFormatting(e,n,!0)}function command_underline(e,t){dext_src_init(t._EDITOR.design);var n={document:_iframeDoc,styleWithCss:!1,tagName:"u"};restoreSelection(),setFocusToBody();var r=getFirstRange();DoExecuteCommand(r.sel,r.range,"underline",n)}function command_strikeThrough(e,t){dext_src_init(t._EDITOR.design);var n={document:_iframeDoc,styleWithCss:!1,tagName:"strike"};restoreSelection(),setFocusToBody();var r=getFirstRange();DoExecuteCommand(r.sel,r.range,"strikeThrough",n)}function command_superscript(e,t){dext_src_init(t._EDITOR.design);var n={document:_iframeDoc,styleWithCss:!1,tagName:"sup"};restoreSelection(),setFocusToBody();var r=getFirstRange();DoExecuteCommand(r.sel,r.range,"superscript",n)}function command_subscript(e,t){dext_src_init(t._EDITOR.design);var n={document:_iframeDoc,styleWithCss:!1,tagName:"sub"};restoreSelection(),setFocusToBody();var r=getFirstRange();DoExecuteCommand(r.sel,r.range,"subscript",n)}function command_selectAll(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),_iframeDoc.execCommand("selectAll",!1,null),t._iconEnable("selectArea")}function command_align(e,t,n,r,i){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var s=getFirstRange();e=s.range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(e.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(e.endOffset),3==e.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(e.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(e.startContainer),3==e.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(e.endContainer.parentNode):(DEXTTOP.G_CURREDITOR.beforeOffset.push(e.endContainer),1==e.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(e.endContainer.innerText||e.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(e.toString().length)}catch(o){DEXTTOP.G_CURREDITOR.beforeOffset=null}var u=null;if(i&&"table"==i.tagName.toLowerCase())u=i;else if(i&&"img"==i.tagName.toLowerCase()){if(t=GetParentbyTagName(i,"figure")){if("justify"==n||"center"==n)n="";"cssFloat"in t.style?t.style.cssFloat=n:t.style.styleFloat=n,rangy.getSelection(_iframeWin).removeAllRanges(),(n=t.getElementsByTagName("figcaption"))&&n[0]&&doSetCaretPosition(n[0],0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,i&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=i,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null)),setMenuIconRealable(getMyElementNode(i));return}}else u=getSelectionTable(t);if(u){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if("0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)"justify"==n||"left"==n&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?u.removeAttribute("align"):u.setAttribute("align",n);try{var a=_iframeDoc.body.createControlRange();a.add(u),a.select()}catch(f){}setMenuIconRealable(u),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",u),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,i&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=i,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null))}else{if(void 0==e)"left"==n?n="justifyLeft":"right"==n?n="justifyRight":"center"==n?n="justifyCenter":"justify"==n&&(n="justifyFull"),DoExecuteCommand2(s.sel,e,n,r);else{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),i="p li dt dd h1 h2 h3 h4 h5 h6 pre address div".split(" "),a=i.length,t=GetTableSelectionCells();if(0==t.length){if(null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling){for(var l=0;l<a;l++)for(s=_iframeDoc.body.getElementsByTagName(i[l]),u=s.length,r=0;r<u;r++)""!=s[r].style.layoutGridMode&&(s[r].style.layoutGridMode="none"),s[r].style.textAlign=n;a=_iframeDoc.body.getElementsByTagName("table"),s=a.length;for(l=0;l<s;l++){if("0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)"justify"==n||"left"==n&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?a[l].removeAttribute("align"):a[l].setAttribute("align",n);var u=a[l].rows,c=u.length;for(r=0;r<c;r++){t=u[r].cells,e=t.length;for(var h=0;h<e;h++)setBlockTag(t[h].childNodes,i,"align",n)}}setBlockTag(_iframeDoc.body.childNodes,i,"align",n),h=_iframeDoc.body.getElementsByTagName("div"),s=h.length;for(r=0;r<s;r++)setBlockTag(h[r].childNodes,i,"align",n)}else{t=!1,e&&(l=GetTDTHCell(e.startContainer),r=GetTDTHCell(e.endContainer),s=e.commonAncestorContainer,null!=l&&null!=r&&null!=s&&l==r==s&&(h=GetParentbyTagName(l,"table"),t=!0)),t?s=getElementsFromSelection(l.nodeName.toString().toLowerCase()):0==e.toString().length?(r=e.startContainer,s=[r]):s=e.getNodes(),u=s.length;if(2>=u)for(l=0;l<u;l++)r=s[l],3==r.nodeType&&s.push(r.parentNode);if(!s||1==s.length&&-1<"body,td,th".indexOf(s[0].nodeName.toLowerCase()))s=getNodesInRange(e);var u=s.length,c=e.startOffset,p=e.endOffset;0==e.toString().length&&0==e.getNodes().length&&e.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(var d=0;d<u;d++)if(1==s[d].nodeType&&(l=s[d].tagName.toLowerCase(),"0"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign&&"0"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||0==e.toString().length||0==e.getNodes().length||"table"!=l||t&&h==s[d]||("justify"==n||"left"==n&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?s[d].removeAttribute("align"):s[d].setAttribute("align",n)),-1<i.indexOf(l))){for(l=0;l<a;l++){var v=s[d].getElementsByTagName(i[l]),m=v.length;for(r=0;r<m;r++)""!=v[r].style.layoutGridMode&&(v[r].style.layoutGridMode="none"),v[r].style.textAlign=n}""!=s[d].style.layoutGridMode&&(s[d].style.layoutGridMode="none"),s[d].style.textAlign=n}var g;0==e.toString().length&&1==e.getNodes().length&&(g=e.getNodes()[0],s.push(e.getNodes()[0])),a=3==s[0].nodeType,setBlockTag(s,i,"align",n);if(a){if(0==e.toString().length)try{e.setEnd(s[0],p)}catch(y){}e.setStart(s[0],c),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e)}}(n=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(n,1),n.parentNode.removeChild(n)):g&&(n=getFirstRange().range,getFirstRange().sel.removeAllRanges(),n.selectNode(g),getFirstRange().sel.addRange(n)),s=getFirstRange(),e=s.range,setMenuIconRealable(getMyElementNode(e.startContainer))}else{7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==r&&(g=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",g=!0),setAdjustTableWidthHeight(ActiveCurrTable),g&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0")),e=t.length;for(l=0;l<e;l++){for(r=0;r<a;r++)for(s=t[l].getElementsByTagName(i[r]),u=s.length,h=0;h<u;h++)""!=s[h].style.layoutGridMode&&(s[h].style.layoutGridMode="none"),s[h].style.textAlign=n;setBlockTag(t[l].childNodes,i,"align",n),h=t[l].getElementsByTagName("div"),s=h.length;for(r=0;r<s;r++)setBlockTag(h[r].childNodes,i,"align",n);g=t[l].getElementsByTagName("table"),h=g.length;for(r=0;r<h;r++)"justify"==n?g[r].removeAttribute("align"):g[r].setAttribute("align",n)}doSetCaretPosition(DrageEndCell.childNodes[0],1),n=getFirstRange().range,g=getMyChildElementNode(n.startContainer),n.selectNode(g),setMenuIconRealable(g),_iframeDoc_MouseUpMenu(null,DrageEndCell)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}DEXTTOP.G_CURREDITOR.beforeOffset=null}}function command_justifyLeft(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=getFirstRange(),DoExecuteCommand2(e.sel,e.range,"justifyLeft",n)}function command_justifyCenter(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=getFirstRange(),DoExecuteCommand2(e.sel,e.range,"justifyCenter",n)}function command_justifyRight(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=getFirstRange(),DoExecuteCommand2(e.sel,e.range,"justifyRight",n)}function command_justifyFull(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=getFirstRange(),DoExecuteCommand2(e.sel,e.range,"justifyFull",n)}function command_indent(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange().range,r=n.startContainer,r=3==r.nodeType?r.parentNode:r;if(GetParentbyTagName(r,"li"))setTabkeyAction();else{r=parseIntOr0(t._config.inoutdentDefaultSize),0==r&&(r=40);if(n&&"1"!=t._config.allowInoutdentText){var i=GetTDTHCell(n.startContainer);if(i&&0<n.toString().length)return;if(i=GetParentbyTagName(i,"table")){var s=parseIntOr0(i.style.marginLeft);i.style.marginLeft=s+r+"px";return}}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var i="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),o,u;o=0==n.toString().length?[n.startContainer]:n.getNodes();if(1==o.length){var a=o[0];if(!(a.tagName&&-1<i.indexOf(a.tagName.toLowerCase())))for(;a=a.parentNode,!a.tagName||"body"!=a.tagName.toLowerCase();)if(a.tagName&&-1<i.indexOf(a.tagName.toLowerCase())){o=[a];break}}else{var a=o[0],f=o[o.length-1],s=a;for(u=f;!s.tagName||"body"!=s.tagName.toLowerCase();){if(s.tagName&&-1<i.indexOf(s.tagName.toLowerCase())){a=s;break}s=s.parentNode}for(;!u.tagName||"body"!=u.tagName.toLowerCase();){if(u.tagName&&-1<i.indexOf(u.tagName.toLowerCase())){f=u;break}u=u.parentNode}a==f&&(o=[a])}null!=n.startContainer.previousSibling&&"HEAD"==n.startContainer.previousSibling.tagName&&null==n.endContainer.nextSibling&&(o=n.getNodes()),0<n.toString().length&&1<o.length&&1==o[0].nodeType&&"P"==o[0].tagName&&(a=o[0].innerText||o[0].textContent,3==n.startContainer.nodeType&&null==n.startContainer.nextSibling&&(a=n.startContainer.nodeValue),f=!1,a.length==n.startOffset&&(f=!0),!f&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&2<=o.length&&0<n.startOffset&&3!=o[1].nodeType&&1==n.startContainer.nodeType&&(f=!0),f&&(n.setStartAfter(o[0]),o=n.getNodes())),u=o.length;for(var a=n.startOffset,f=n.endOffset,l=0;l<u;l++)if(null!=o[l].parentNode&&1==o[l].nodeType&&o[l].tagName&&"body"!=o[l].tagName.toLowerCase())if("table"==o[l].tagName.toLowerCase())"1"!=t._config.allowInoutdentText&&(s=parseIntOr0(o[l].style.marginLeft),o[l].style.marginLeft=s+r+"px");else if(o[l].tagName&&-1<i.indexOf(o[l].tagName.toLowerCase())){var c=DEXTTOP.DEXT5.util.parseFloatOr0(o[l].style.paddingLeft),s=DEXTTOP.DEXT5.util.parseFloatOr0(o[l].style.marginLeft),h=DEXTTOP.DEXT5.util.parseFloatOr0(o[l].style.marginRight),p=DEXTTOP.DEXT5.util.parseFloatOr0(o[l].style.textIndent),d=DEXTTOP.DEXT5.util.parseFloatOr0(_iframeDoc.body.style.width);if(0<c){var v=o[l].style.paddingLeft.replace(c,"");0<s&&(c+=s),s=0,"1"==t._config.autoBodyFit?(0==d&&(d=getCurrEditorWidth()),s=0<p?c+r+p>d-h?c:c+r:c+r>d-h?c:c+r):s=c+r,o[l].style.paddingLeft="",o[l].style.marginLeft=s+(""==v?"px":v)}else v=o[l].style.marginLeft.replace(s,""),c=0,"1"==t._config.autoBodyFit?(0==d&&(d=getCurrEditorWidth()),c=0<p?s+r+p>d-h?s:s+r:s+r>d-h?s:s+r):c=s+r,o[l].style.marginLeft=c+(""==v?"px":v)}s=o[0]&&o[0].nodeType?3==o[0].nodeType:!1,setBlockTag(o,i,"indent",r),s&&(0==n.toString().length&&n.setEnd(o[0],f),n.setStart(o[0],a),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n)),"2"==t._config.ruler.mode&&setRulerPositionForNode(t,!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_outdent(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange().range,r=n.startContainer,r=3==r.nodeType?r.parentNode:r;if(GetParentbyTagName(r,"li"))setShiftTabkeyAction();else{r=parseIntOr0(t._config.inoutdentDefaultSize),0==r&&(r=40);if(n&&"1"!=t._config.allowInoutdentText){var i=GetTDTHCell(n.startContainer);if(i&&0<n.toString().length)return;if(i=GetParentbyTagName(i,"table")){var s=parseIntOr0(i.style.marginLeft),o;i.style.marginLeft=(0>s-r?0:s-r)+"px"}}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var s="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),u,i=0==n.toString().length?[n.startContainer]:n.getNodes();if(1==i.length){if(u=i[0],!(u.tagName&&-1<s.indexOf(u.tagName.toLowerCase())))for(;u=u.parentNode,!u.tagName||"body"!=u.tagName.toLowerCase();)if(u.tagName&&-1<s.indexOf(u.tagName.toLowerCase())){i=[u];break}}else{u=i[0];for(var a=i[i.length-1],f=u,l=a;!f.tagName||"body"!=f.tagName.toLowerCase();){if(f.tagName&&-1<s.indexOf(f.tagName.toLowerCase())){u=f;break}f=f.parentNode}for(;!l.tagName||"body"!=l.tagName.toLowerCase();){if(l.tagName&&-1<s.indexOf(l.tagName.toLowerCase())){a=l;break}l=l.parentNode}u==a&&(i=[u])}null!=n.startContainer.previousSibling&&"HEAD"==n.startContainer.previousSibling.tagName&&null==n.endContainer.nextSibling&&(i=n.getNodes()),u=i.length,a=n.startOffset,f=n.endOffset;for(l=0;l<u;l++)if(null!=i[l].parentNode&&1==i[l].nodeType&&i[l].tagName&&"body"!=i[l].tagName.toLowerCase())if("table"==i[l].tagName.toLowerCase())"1"!=t._config.allowInoutdentText&&(s=parseIntOr0(i[l].style.marginLeft),o=0>s-r?0:s-r,i[l].style.marginLeft=o+"px");else{o=DEXTTOP.DEXT5.util.parseFloatOr0(i[l].style.paddingLeft);var s=DEXTTOP.DEXT5.util.parseFloatOr0(i[l].style.marginLeft),c=DEXTTOP.DEXT5.util.parseFloatOr0(i[l].style.textIndent);if(0<o){var h=i[l].style.paddingLeft.replace(o,"");0<s&&(o+=s),s=0,0!=c?0<c?0>o-r?(s=0,i[l].style.textIndent=c+o-r):s=o-r:0>c&&(s=0>o-r+c?-c:o-r):s=0>o-r?0:o-r,i[l].style.paddingLeft="",i[l].style.marginLeft=s+(""==h?"px":h)}else h=i[l].style.marginLeft.replace(s,""),o=0,0!=c?0<c?0>s-r?(o=0,i[l].style.textIndent=c+s-r):o=s-r:0>c&&(o=0>s-r+c?-c:s-r):o=0>s-r?0:s-r,i[l].style.marginLeft=o+(""==h?"px":h)}3==i[0].nodeType&&(0==n.toString().length&&n.setEnd(i[0],f),n.setStart(i[0],a),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n)),"2"==t._config.ruler.mode&&setRulerPositionForNode(t,!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_insertOrderedList(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(null==t._formatPainterList||t._formatPainterList&&"1"!=t._formatPainterList.nowApplying)try{t.UndoManager.putUndo(),t.UndoManager.charCount=0}catch(n){}var r=function(e){""==e.style.listStyleType&&(e.style.listStyleType="decimal"),""!=t._config.orderListDefaultClass&&e.setAttribute("class",t._config.orderListDefaultClass);if(e.parentNode&&e.parentNode.tagName&&-1<",ul,ol,".indexOf(","+e.parentNode.tagName.toLowerCase()+",")){for(var n=e.previousSibling;null!=n&&1!=n.nodeType;)n=n.previousSibling;"2"==t._config.olUlTagMode&&n&&"li"==n.tagName.toLowerCase()&&n.appendChild(e)}},i=function(e){for(var t=e.length,n=0;n<t;n++)if("ol"==e[n].nodeName.toLowerCase()){var r=e[n].parentNode;"p"==r.nodeName.toLowerCase()&&(""==e[n].style.fontSize&&""!=r.style.fontSize&&(e[n].style.fontSize=r.style.fontSize),""==e[n].style.fontFamily&&""!=r.style.fontFamily&&(e[n].style.fontFamily=r.style.fontFamily),r.parentNode.replaceChild(e[n],r),r=getFirstRange(),r.sel.removeAllRanges(),r.range.selectNodeContents(e[n]),r.sel.addRange(r.range))}},s=function(e){var t=getFirstRange().range,n=null;t&&t.startContainer&&(n="BODY"==t.startContainer.tagName?t.startContainer.childNodes[t.startOffset]:getMyElementNode(t.startContainer));var t=GetParentbyTagName(n,"ol",!0),s=GetParentbyTagName(n,"ul",!0);s?s.style.listStyleType="":t&&(t.style.listStyleType=""),_iframeDoc.execCommand("insertOrderedList",!1,null);var o=getFirstRange().range;0==!!o&&(o=f),setMenuIconRealable(getMyElementNode(o.startContainer));if(e)for(var n=e.getElementsByTagName("ol"),o=n.length,u=0;u<o;u++)r(n[u]),i([n[u]]);else(n="BODY"==o.startContainer.tagName?o.startContainer.childNodes[o.startOffset]:getMyElementNode(o.startContainer))&&(n=GetParentbyTagName(n,"ol"))&&r(n),n=getNodesInRange(o),i(n);null==t&&null==s&&setLiStyle(),removeDivInLiTag(e)},o=GetTableSelectionCells(),u=o.length;if(0<u)for(var a=getFirstRange(),f=a.range,l=f.cloneRange(),c=0;c<u;c++){a.sel.removeAllRanges();var h=getMyFirstOrLastChildElementNode(o[c],!1),p=getMyFirstOrLastChildElementNode(o[c],!0);if(null==h&&null==p){var d=_iframeDoc.createElement("p");d.innerHTML="<br>",p=h=d,o[c].appendChild(d)}h&&p&&(f.setStartBefore(h),f.setEndAfter(p),a.sel.addRange(f),s(o[c]),a.sel.removeAllRanges(),a.sel.addRange(l))}else s();setRulerPositionForNode(t);if(null==t._formatPainterList||t._formatPainterList&&"1"!=t._formatPainterList.nowApplying)try{t.UndoManager.putUndo(),t.UndoManager.charCount=0}catch(v){}}function command_listDecimal(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","decimal")}function command_listDecimalLeadingZero(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","decimal-leading-zero")}function command_listLowerAlpha(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","lower-alpha")}function command_listLowerGreek(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","lower-greek")}function command_listLowerRoman(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","lower-roman")}function command_listUpperAlpha(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","upper-alpha")}function command_listUpperRoman(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","upper-roman")}function command_insertUnOrderedList(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(null==t._formatPainterList||t._formatPainterList&&"1"!=t._formatPainterList.nowApplying)try{t.UndoManager.putUndo(),t.UndoManager.charCount=0}catch(n){}var r=function(e){""==e.style.listStyleType&&(e.style.listStyleType="disc"),""!=t._config.unOrderListDefaultClass&&e.setAttribute("class",t._config.unOrderListDefaultClass);if(e.parentNode&&e.parentNode.tagName&&-1<",ul,ol,".indexOf(","+e.parentNode.tagName.toLowerCase()+",")){for(var n=e.previousSibling;null!=n&&1!=n.nodeType;)n=n.previousSibling;"2"==t._config.olUlTagMode&&n&&"li"==n.tagName.toLowerCase()&&n.appendChild(e)}},i=function(e){for(var t=e.length,n=0;n<t;n++)if("ul"==e[n].nodeName.toLowerCase()){var r=e[n].parentNode;"p"==r.nodeName.toLowerCase()&&(""==e[n].style.fontSize&&""!=r.style.fontSize&&(e[n].style.fontSize=r.style.fontSize),""==e[n].style.fontFamily&&""!=r.style.fontFamily&&(e[n].style.fontFamily=r.style.fontFamily),r.parentNode.replaceChild(e[n],r),r=getFirstRange(),r.sel.removeAllRanges(),r.range.selectNodeContents(e[n]),r.sel.addRange(r.range))}},s=function(e){var t=getFirstRange().range,n=null;t&&t.startContainer&&(n="BODY"==t.startContainer.tagName?t.startContainer.childNodes[t.startOffset]:getMyElementNode(t.startContainer));var t=GetParentbyTagName(n,"ol",!0),s=GetParentbyTagName(n,"ul",!0);s?s.style.listStyleType="":t&&(t.style.listStyleType=""),_iframeDoc.execCommand("insertUnOrderedList",!1,null);var o=getFirstRange().range;0==!!o&&(o=f),setMenuIconRealable(getMyElementNode(o.startContainer));if(e)for(var n=e.getElementsByTagName("ul"),o=n.length,u=0;u<o;u++)r(n[u]),i([n[u]]);else(n="BODY"==o.startContainer.tagName?o.startContainer.childNodes[o.startOffset]:getMyElementNode(o.startContainer))&&(n=GetParentbyTagName(n,"ul"))&&r(n),n=getNodesInRange(o),i(n);null==t&&null==s&&setLiStyle(),removeDivInLiTag(e)},o=GetTableSelectionCells(),u=o.length;if(0<u)for(var a=getFirstRange(),f=a.range,l=f.cloneRange(),c=0;c<u;c++){a.sel.removeAllRanges();var h=getMyFirstOrLastChildElementNode(o[c],!1),p=getMyFirstOrLastChildElementNode(o[c],!0);if(null==h&&null==p){var d=_iframeDoc.createElement("p");d.innerHTML="<br>",p=h=d,o[c].appendChild(d)}h&&p&&(f.setStartBefore(h),f.setEndAfter(p),a.sel.addRange(f),s(o[c]),a.sel.removeAllRanges(),a.sel.addRange(l))}else s();setRulerPositionForNode(t);if(null==t._formatPainterList||t._formatPainterList&&"1"!=t._formatPainterList.nowApplying)try{t.UndoManager.putUndo(),t.UndoManager.charCount=0}catch(v){}}function command_listDisc(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"B","disc")}function command_listCircle(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"B","circle")}function command_listSquare(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"B","square")}function command_listNone_N(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"N","none")}function command_listNone_B(e,t){dext_src_init(t._EDITOR.design),command_listNumberBullets(e,t,"B","none")}function command_removeFormat(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange();DoExecuteCommand2(n.sel,n.range,"removeFormat")}function command_removeCss(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange().range;try{var r=getElementsFromSelection(),i=r.length;if(0==n.toString().length){var s=GetTableSelectionCells(),o=s.length;if(0==o)return!1;1!=isApplyFormat&&ClearDraggingTableCellSelected();for(var r=[],n=null,u=0,a=0;a<o;a++){r.push(s[a]);for(var n=s[a].getElementsByTagName("*"),u=n.length,f=0;f<u;f++)r.push(n[f])}i=r.length}else{s="",o=!1;for(a=0;a<i;a++)s=r[a].nodeName,"TABLE"==s&&(o=!0);o&&ClearDraggingTableAllTable()}(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var s=null,l,a=0;a<i;a++)if(s=r[a],l=s.tagName.toLowerCase(),"table"==l||"td"==l||"th"==l){if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying){var c=s.style.width,h=s.style.height,p=s.style.border,d=s.style.borderBottom,v=s.style.borderTop,m=s.style.borderLeft,g=s.style.borderRight,y=s.style.borderWidth,b=s.style.borderStyle,w=s.style.borderColor,o="";"table"==l&&(o=s.style.fontSize),removeAttribute(s,"align"),removeAttribute(s,"style"),removeAttribute(s,"className"),removeAttribute(s,"bgcolor"),""!=o&&(s.style.fontSize=o),""!=c&&(s.style.width=c),""!=h&&(s.style.height=h),""!=p&&(s.style.border=p),""!=y&&(s.style.borderWidth=y),""!=b&&(s.style.borderStyle=b),""!=w&&(s.style.borderColor=w),""!=d&&(s.style.borderBottom=d),""!=v&&(s.style.borderTop=v),""!=m&&(s.style.borderLeft=m),""!=g&&(s.style.borderRight=g),"table"==l&&(s.style.borderCollapse="collapse",null!=s.getAttribute("cellpadding")&&"0"!=s.getAttribute("cellpadding")||s.setAttribute("cellPadding","1"))}}else{var o="style align background cellOrgBgColor border borderColor color face size height width hspace vspace valign class".split(" "),E=o.length;if(-1<",a,p,span,div,address,b,dd,dl,dt,font,i,li,label,ol,ul,strike,strong,sub,sup,u,".indexOf(","+l+","))for(n=0;n<E;n++)removeAttribute(s,o[n])}var S=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(S=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(a=i-1;0<=a;a--)if(s=r[a],l=s.tagName.toLowerCase(),S[l]&&"BODY"!=s.parentNode.tagName)if(DEXTTOP.DEXT5.browser.ie)s.removeNode();else{for(;s.firstChild;)s.parentNode.insertBefore(s.firstChild,s);s.parentNode.removeChild(s)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(x){}}function command_removeCss2(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=getFirstRange().range;if(0==e.toString().length)try{var r=getElementsFromSelection(),i=r.length;if(0==e.toString().length){var s=GetTableSelectionCells(),o=s.length;if(0==o)return!1;r=[],n=null;for(var u=e=0;u<o;u++){r.push(s[u]),n=s[u].getElementsByTagName("*"),e=n.length;for(var a=0;a<e;a++)r.push(n[a])}i=r.length}for(var s=null,f,u=0;u<i;u++)if(s=r[u],f=s.tagName.toLowerCase(),"table"!=f&&"td"!=f&&"th"!=f&&"tr"!=f&&"tbody"!=f&&"body"!=f&&"img"!=f){for(var l=s.attributes.length,o=[],a=0;a<l;a++)o.push(s.attributes[a].nodeName);for(n=0;n<l;n++)removeAttribute(s,o[n])}var c=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(c=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(u=0;u<i;u++)s=r[u],f=s.tagName.toLowerCase(),c[f]&&"BODY"!=s.parentNode.tagName&&s.removeNode()}catch(h){}else removeCssInSelection(n)}function command_copy(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),1!=DEXTTOP.DEXT5.browser.gecko&&1!=DEXTTOP.DEXT5.browser.safari?_iframeDoc.execCommand("copy",!1,null):alert(dext5_lang.msg.copy)}function command_cut(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(1!=DEXTTOP.DEXT5.browser.gecko&&1!=DEXTTOP.DEXT5.browser.safari){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),_iframeDoc.execCommand("cut",!1,null),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(n){}}else alert(dext5_lang.msg.cut)}function command_pastehtml(e,t,n,r){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){0<t.UndoManager.charCount&&t.UndoManager.putUndo();if(G_dext5plugIn&&0==t.setTextPaste){try{if(void 0==r&&"1"==t._config.limitPasteHtmlLength.value){var i=t._config.limitPasteHtmlLength.length,s=G_dext5plugIn.getOriginalHtml("body");if(s.length>i&&!checkCanPasteToIamge()){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2),setFocusToBody();return}if("0"==t._config.pasteToImage&&s.length>i){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2),setFocusToBody();return}}}catch(o){}e=G_dext5plugIn.getPasteHtml(),e=e.replace(/layout-flow:.*?;/gi,""),"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove&&(e=e.replace(/<img[^>]*src=["\']([^>]*:\\)([^>"\']+)["\']?[^>]*>/gi,""));if(100==G_dext5plugIn.getHTMLFormatFromType){var u="",a=findUrlInText(e,DEXTTOP.G_CURREDITOR);""!=a.changedData&&(u=e,e=a.changedData),e=adjustTextPasteForPlugin(e);if(""!=a.changedData){a.changedData=e;try{e=replaceRealUrl(a)}catch(f){e=adjustTextPasteForPlugin(u),e=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,e)}}}else{u="";try{u=G_dext5plugIn.getDext5PluginVersion()}catch(l){}""!=u&&"5,0,0,9"<=u&&6!=G_dext5plugIn.getHTMLFormatFromType&&(e=e.replace(/\r\n/g,"\n"))}u=!1;if(DEXTTOP.G_CURREDITOR.setTextPaste&&"1"!=DEXTTOP.G_CURREDITOR.setTextPasteMode){if(6==G_dext5plugIn.getHTMLFormatFromType){e=G_dext5plugIn.getPasteHtmlEx();var a=e.indexOf("<!--StartFragment-->"),c=e.lastIndexOf("<!--EndFragment-->");-1<a&&-1<c&&(strTemp=e.substr(a+20),c=strTemp.lastIndexOf("<!--EndFragment-->"),-1<c&&(e=strTemp=strTemp.substring(0,c)))}a=document.createElement("div"),a.innerHTML=e,e=a.innerHTML,e=DEXTTOP.DEXT5.convertHtmlToText(e)}else{if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(u=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&(c=e.match(RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi")))))for(var h=c.length,a=0;a<h;a++)if(-1<c[a].indexOf("file://")){u=!1;break}6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&(a=G_dext5plugIn.getPasteHtmlEx(),a=checkCopyInCellFormInertnNet(a),""!=a&&(e=a,u=!1))}if(void 0!=n){r&&"0"==t._config.pasteToImage&&r.hide(),n=G_dext5plugIn.ShowImageSaveDlgFromClipboard(n);try{if("HTML"==n&&"1"==t._config.limitPasteHtmlLength.value&&(i=t._config.limitPasteHtmlLength.length,s=G_dext5plugIn.getOriginalHtml("body"),s.length>i)){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2),setFocusToBody();return}}catch(p){}if(""==n){setFocusToBody();return}""!=n&&"HTML"!=n&&(e=n,u=!1)}"1"==t._config.ie_BugFixed_Hyfont&&(e=DEXTTOP.DEXT5.util.replaceHyFont(e,t)),i=!0,u&&(setPasteBin(),t.isStopScroll=!0,(i=document.execCommand("paste",!1,null))?(i=!1,fn_PasteIE(),setTimeout(function(){t.isStopScroll=!1},1)):i=!0);if(i){i=!1,6==G_dext5plugIn.getHTMLFormatFromType&&(i=!0),s=document.createElement("div"),s.innerHTML=e;if(n=replaceSpanToDivContainAbsolute(s))e=s.innerHTML;if(-1<t._config.disableInsertImage.indexOf(",paste_image,")){n=!1,r=s.getElementsByTagName("img");for(a=r.length-1;0<=a;a--)u=r[a],u.src&&0==u.src.toLowerCase().indexOf("file:")&&(n=!0,u.parentNode.removeChild(u));n&&(e=s.innerHTML)}e=execReplaceMsoStyle(e),"1"==t._config.useHtmlCorrection?"1"==t._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"htmlTagRevision",callFnParam:[e,!0,i],callBackFn:fn_PastePlugin_htmlTagRevision_After})):(e=htmlTagRevision(e,!0,i),fn_PastePlugin_htmlTagRevision_After(e)):fn_PastePlugin_htmlTagRevision_After(e)}}else setPasteBin(),t.isStopScroll=!0,document.execCommand("paste",!1,null),fn_PasteIE(),setTimeout(function(){t.isStopScroll=!1},1);t.UndoManager.putUndo(),t.UndoManager.charCount=0}else _iframeDoc.queryCommandState("paste")?(0<t.UndoManager.charCount&&t.UndoManager.putUndo(),_iframeDoc.execCommand("paste",!1,null),t.UndoManager.putUndo(),t.UndoManager.charCount=0):t._dextCommands(t.ID,"paste_dialog")}function fn_command_pasteHtml_htmlTagRevision_After(e,t){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),"undefined"==typeof t&&(t=DEXTTOP.G_CURREDITOR),e=removeTagStyle(e),e=repairPasteTextInCell(e),0<e.length?(0<t.UndoManager.charCount&&(t.UndoManager.putUndo(),t._iconEnable("")),"1"==t._config.useHtmlProcessByWorker?(e=DEXTTOP.DEXT5.util.officeCleanByDom(e,!0),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:t._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[e,!0],callBackFn:fn_command_pasteHtml_officeClean_After})):(e=DEXTTOP.DEXT5.util.officeClean(e,!0),fn_command_pasteHtml_officeClean_After(e,t))):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}function fn_command_pasteHtml_officeClean_After(e,t){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),"undefined"==typeof t&&(t=DEXTTOP.G_CURREDITOR),"1"==t._config.tableAutoAdjustInPaste&&/<table/i.test(e)&&(e=command_AdjustTableAndCellWidth(t.ID,t,{type:"paste",htmlData:e})),e=OfficePasteClean(e),e=DEXTTOP.DEXT5.util.emptyTagRemove(e),e=IEPasteRemoveEmptyNodes(e),e=DEXTTOP.DEXT5.util.htmlRevision(e),e=xssReplaceScript(null,e),e=adjustSizeInContainer({strHtml:e}),e=getImageAutoFitForPasteHtml(e),e=removeEditorAttribute(e);try{if("function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste||"function"==typeof DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste){var n=e;try{n="function"==typeof DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste?DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste(e):DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(e)}catch(r){n=e}if(n)e=n;else if(0==n||""==n){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(i){}pasteWordCount(e)?(-1<e.indexOf("dext5customdata")&&(e=checkExistCustomData(e)),e=externalPageBreakDataRaplaceInEditor(e),setTimeout(function(){pasteHtmlAtCaretHuge(e)},0),checkPasteImage(e),0>e.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1)),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground(),window.setTimeout(function(){try{contentChangeEventWrapper(),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}catch(e){}},500)):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}function command_pastetext(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=document.getElementById("dext_span_"+e+"text_paste");t.setTextPaste?(t.setTextPaste=!1,n.style.backgroundImage=""):(t.setTextPaste=!0,n&&(_className=DEXTTOP.DEXT5.util.getClass(n),_className+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(n,_className),-1<n.className.indexOf("uebutton_type")?n.style.backgroundImage="url("+t._config.webPath.image+"skin/"+t._config.style.skinName+"/form_skinback_release.gif)":n.style.backgroundImage="url("+t._config.webPath.image+"skin/"+t._config.style.skinName+"/skinback_release.gif)"))}function getPageBreakOuterHTML(){var e;return e='<div class="DEXT_fiVe_Page_Break" style="page-break-after:always; display:block;" contentEditable="false">'+('<span style="display:none;">'+dext5_lang.icon.pagebreak+"</span>"),e+"</div>"}function command_pagebreak(e,t){try{dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var n=getFirstRange(),r=n.range,i=n.sel,s=function(e,t){var n=e.sel,r=e.range;if(DEXTTOP.DEXT5.browser.ie)n.removeAllRanges(),r.setStartBefore(t),r.setEndBefore(t);else{var i=_iframeDoc.createElement("p");i.innerHTML="<br>",t.parentNode.insertBefore(i,t),n.removeAllRanges(),r.setStart(i,0),r.setEnd(i,0)}n.addRange(r)},o=getParentbyTagNameEx(r.startContainer,"td,th");if(o){var u=/<table/i.test(o.innerHTML),a=GetParentbyTagName(o,"table"),f=null;if(f=u?a:GetParentbyTagName(a.parentNode,"table")){for(;;){var l=GetParentbyTagName(f.parentNode,"table");if(null==l)break;f=l}s({sel:i,range:r},f)}else{var c=splitTable(o,a);if(!c.table2)return;s({sel:i,range:r},c.table2)}}else 0<r.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var n=getFirstRange(),i=n.sel,h=getPageBreakOuterHTML(),h=h.replace(/<div /,'<div id="dext_page_break" '),n="";DEXTTOP.DEXT5.browser.ie&&(n="<p>",11<=DEXTTOP.DEXT5.browser.ieVersion?n+="<br>":7>=DEXTTOP.DEXT5.browser.ieVersion&&(n+="&nbsp;"),n+="</p>"),pasteHtmlAtCaretHuge(h+n,!1,!0,!1,!0);var p=_iframeDoc.getElementById("dext_page_break");p.removeAttribute("id");var d=GetParentbyTagName(p,"span");d&&(d.parentNode.insertBefore(p,d),""==d.innerHTML&&d.parentNode.removeChild(d)),h=null;try{p.nextSibling?h=p.nextSibling:(h=_iframeDoc.createElement("p"),h.innerHTML=!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion?"<br>":"&nbsp;",p.parentNode.appendChild(h)),h&&doSetCaretPosition(h,0)}catch(v){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(m){}}function command_print(e,t){dext_src_init(t._EDITOR.design);var n=function(e,t){isViewMode(t)||t.setChangeMode("preview"),setTimeout(function(){var e,n="preview";isViewMode(t)&&(n="design"),e=t._EDITOR[n].contentDocument?t._EDITOR[n].contentDocument:t._EDITOR[n].contentWindow.document,changeSpanPageBreakProperty(e);if(DEXTTOP.DEXT5.browser.ie)if(n=e.getElementById("dext5printpreview"))try{n.doPrintPreview(t._config.printHeader,t._config.printFooter,"")}catch(r){e.execCommand("print",!1,null)}else e.execCommand("print",!1,null);else"none"==t._EDITOR[n].style.display&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(bChnageDisplay=!0,t._EDITOR[n].style.display=""),t._EDITOR[n].contentWindow.print();isViewMode(t)?restoreSpanPageBreakProperty(e):t.setChangeMode("design")},350)};if(DEXTTOP.DEXT5.browser.ie)if(G_dext5plugIn&&"1"==t._config.usePrintApp){var r=DEXTTOP.DEXT5.getHtmlValueExWithDocType(t.ID,!0);try{G_dext5plugIn.doPrintDirectEx(r,t._config.printHeader,t._config.printFooter)}catch(i){n(e,t)}}else n(e,t);else n(e,t)}function command_saveAs(e,t,n){dext_src_init(t._EDITOR.design);var r=DEXTTOP.DEXT5.getHtmlValueExWithDocType(),r=r.replace("&amp;","&");if(G_dext5plugIn){var i=t._config.saveHtmlName,i=i.replace(/[\\/:*?"<>|]/gi,""),s=i.lastIndexOf(".");0<=s&&(i=i.substr(0,s)),n?(i=G_dext5plugIn.doSaveHTML(r,i,"utf-8",""),""!=i&&(t.strOldSaveFileName=i)):(n="",n=""==t.strOldSaveFileName?i:t.strOldSaveFileName,t.strOldSaveFileName=G_dext5plugIn.doSaveHTML(r,n,"utf-8",""))}else{var o=t._config.saveHtmlName,o=o.replace(/[\\/:*?"<>|]/gi,""),s=o.lastIndexOf(".");0>o.substr(s+1).indexOf("htm")&&(o=0<=s?o.substr(0,s):o+".html");var u=function(){var e=DEXTTOP.DEXTDOC.createElement("form");e.id="dext5_saveFrm",e.name="dext5_saveFrm",e.method="post";var n=DEXTTOP.DEXTDOC.createElement("input");n.id="htmlstring",n.name="htmlstring",n.type="hidden",n.value=encodeURIComponent(r);var i=DEXTTOP.DEXTDOC.createElement("input");i.id="tosavepathurl",i.name="tosavepathurl",i.type="hidden";var s=DEXTTOP.DEXTDOC.createElement("input");s.id="savafoldernamerule",s.name="savafoldernamerule",s.type="hidden";var u=DEXTTOP.DEXTDOC.createElement("input");u.id="saveHtmlName",u.name="saveHtmlName",u.type="hidden";if("0"!=t._config.security.encryptParam){i.value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(t._config.toSavePathURL),s.value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(t._config.saveFolderNameRule),u.value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(o);var a=DEXTTOP.DEXTDOC.createElement("input");a.id="pe",a.name="pe",a.value=t._config.security.encryptParam,a.type="hidden",e.appendChild(a)}else i.value=t._config.toSavePathURL,s.value=t._config.saveFolderNameRule,u.value=encodeURIComponent(o);e.action=""!=t._config.post_url_save_for_notes?t._config.post_url_save_for_notes:t._config.post_url,e.appendChild(n),e.appendChild(i),e.appendChild(s),e.appendChild(u),DEXTTOP.DEXTDOC.body.appendChild(e),null==DEXTTOP.DEXTDOC.getElementById("dext_saveframe")&&(n=DEXTTOP.DEXTDOC.createElement("iframe"),n.style.display="none",n.id="dext_saveframe",n.name="dext_saveframe",DEXTTOP.DEXTDOC.body.appendChild(n)),e.target="dext_saveframe",e.submit(),DEXTTOP.DEXTDOC.body.removeChild(e)},i=function(t){if(t){var n=document.createElement("iframe");n.style.display="none",n.id="saveframe",document.body.appendChild(n);var r=n.contentWindow.document;n.onload=function(){setTimeout(function(){r.execCommand("SaveAs",!0,o),n.parentNode.removeChild(n),n=null},10)},r.open("text/html","replace"),r.write(DEXTTOP.DEXT5.getHtmlValueExWithDocType(e)),r.close()}else{t=document.createElement("a"),t.setAttribute("href","data:text/html;charset=utf-8,"+encodeURIComponent(DEXTTOP.DEXT5.getHtmlValueExWithDocType(e))),t.setAttribute("download",o);if(document.createEvent){var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),t.dispatchEvent(i)}else t.click();t=null}};n=function(){if(DEXTTOP.navigator.msSaveOrOpenBlob){var t=new Blob([DEXTTOP.DEXT5.getHtmlValueExWithDocType(e)]);DEXTTOP.navigator.msSaveOrOpenBlob(t,o)}else u()},"1"==t._config.forceSaveAsServer||DEXTTOP.DEXT5.browser.mobile?u():DEXTTOP.DEXT5.browser.safari?u():DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion?n():DEXTTOP.DEXT5.browser.ie?i(!0):i(!1)}}function command_undo(e,t){dext_src_init(t._EDITOR.design),0<t.UndoManager.charCount&&(t.UndoManager.putUndo(),t.UndoManager.charCount=0),t.UndoManager.execUndo()}function command_redo(e,t){dext_src_init(t._EDITOR.design),t.UndoManager.execRedo(),t.UndoManager.charCount=0}function command_fontsize(e,t,n){dext_src_init(t),e={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontsize:n},restoreSelection(),setFocusToBody(),t=getFirstRange(),DoExecuteCommand3(t.sel,t.range,"fontSize",e,n)}function command_fontfamily(e,t,n){dext_src_init(t),e=changeFontFamily(n),t={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontfamily:e},restoreSelection(),setFocusToBody(),n=getFirstRange(),DoExecuteCommand3(n.sel,n.range,"fontFamily",t,e)}function command_docBGColor(e,t,n){dext_src_init(t),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),_iframeDoc.body.style.background=n,DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_fontColor(e,t,n){dext_src_init(t),e=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"color_show"),n?e.style.backgroundColor=n:n=e.style.backgroundColor,""==n&&(n="#000000"),e={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:n},restoreSelection(),setFocusToBody(),t=getFirstRange(),DoExecuteCommand3(t.sel,t.range,"fontcolor",e,n)}function command_fontBgColor(e,t,n){dext_src_init(t),e=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"bg_color_show"),n?e.style.backgroundColor=n:n=e.style.backgroundColor,""==n&&(n="#ffffff"),e={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:n},restoreSelection(),setFocusToBody(),t=getFirstRange(),DoExecuteCommand3(t.sel,t.range,"fontbgcolor",e,n)}function command_lineHeight(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),e=getFirstRange();var r=e.range;if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{if("BODY"!=r.startContainer.tagName&&1==r.endContainer.nodeType&&"BODY"==r.endContainer.tagName){var i=r.endContainer.childNodes[r.endOffset];r.setEnd(i,i.childNodes.length)}}catch(s){}try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endOffset),3==r.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startContainer),3==r.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endContainer.parentNode):(DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endContainer),1==r.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(r.endContainer.innerText||r.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(r.toString().length)}catch(o){DEXTTOP.G_CURREDITOR.beforeOffset=null}"2"==DEXTTOP.G_CURREDITOR._config.lineHeightMode&&-1<n.toString().indexOf("%")&&(n=parseInt(n,10)/100);if(void 0==r)DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion&&n==DEXTTOP.G_CURREDITOR._setting.line_height&&(n=parseInt(n,10)/100+.01),DoExecuteCommand3(e.sel,r,"lineheight",{document:_iframeDoc,styleWithCss:!0,lineheight:n},n);else{0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var i="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),u=i.length,a,f,l=GetTableSelectionCells();if(0==l.length){if(null!=r.startContainer.previousSibling&&"HEAD"==r.startContainer.previousSibling.tagName&&null==r.endContainer.nextSibling){for(e=0;e<u;e++)for(a=_iframeDoc.body.getElementsByTagName(i[e]),f=a.length,t=0;t<f;t++)"span"==a[t].tagName.toLowerCase()?""!=a[t].style.lineHeight&&(a[t].style.lineHeight=n):a[t].style.lineHeight=n;u=_iframeDoc.body.getElementsByTagName("table"),a=u.length;for(e=0;e<a;e++){f=u[e].rows;var c=f.length;for(t=0;t<c;t++)for(var l=f[t].cells,r=l.length,h=0;h<r;h++)setBlockTag(l[h].childNodes,i,"lineHeight",n)}setBlockTag(_iframeDoc.body.childNodes,i,"lineHeight",n),a=_iframeDoc.body.getElementsByTagName("div"),f=a.length;for(t=0;t<f;t++)setBlockTag(a[t].childNodes,i,"lineHeight",n)}else{a=getNodesInRange(r),f=a.length,0==r.toString().length&&0==r.getNodes().length&&r.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(l=0;l<f;l++)if(1==a[l].nodeType&&(h=a[l].tagName.toLowerCase(),-1<i.indexOf(h))){if("div"!=h)for(e=0;e<u;e++){var c=a[l].getElementsByTagName(i[e]),p=c.length;for(t=0;t<p;t++)"span"==c[t].tagName.toLowerCase()?""!=c[t].style.lineHeight&&(c[t].style.lineHeight=n):c[t].style.lineHeight=n}"span"==h?""!=a[l].style.lineHeight&&(a[l].style.lineHeight=n):a[l].style.lineHeight=n}var d;0==r.toString().length&&1==r.getNodes().length&&(d=r.getNodes()[0],a.push(r.getNodes()[0])),setBlockTag(a,i,"lineHeight",n)}(n=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(n,1),n.parentNode.removeChild(n)):d&&(n=getFirstRange().range,getFirstRange().sel.removeAllRanges(),n.selectNode(d),getFirstRange().sel.addRange(n))}else for(r=l.length,e=0;e<r;e++){for(t=0;t<u;t++)for(a=l[e].getElementsByTagName(i[t]),f=a.length,h=0;h<f;h++)"span"==a[h].tagName.toLowerCase()?""!=a[h].style.lineHeight&&(a[h].style.lineHeight=n):a[h].style.lineHeight=n;setBlockTag(l[e].childNodes,i,"lineHeight",n),a=l[e].getElementsByTagName("div"),f=a.length;for(t=0;t<f;t++)setBlockTag(a[t].childNodes,i,"lineHeight",n)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}DEXTTOP.G_CURREDITOR.beforeOffset=null}function command_InsertTablebyRowCol(e,t,n,r){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),t=getFirstRange(),e=t.range;try{0==e.toString().length&&setRestoreCaretPos(!1)}catch(i){}t=getCellDefValue(),e=_iframeDoc.createElement("table");var s=DEXTTOP.DEXT5.util.getWordBreakStyle(DEXTTOP.G_CURREDITOR._config);e.style.wordBreak=s;var s=0,o=getFirstRange().range,u=getMyElementNode(o.startContainer),a,o=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"table");try{var f=GetParentbyTagName(u,"td");if(f){var l=getClientRect(f);a=l.right-l.left}a&&50<a?(a-=10,s=Math.round(a/r),e.style.width=a+"px"):(s=Math.round(o/r),e.style.width=o+"px")}catch(c){s=Math.round(o/r),e.style.width=o+"px"}""!=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth&&(s=Math.round(DEXTTOP.G_CURREDITOR._config.tableDefaultWidth/r),e.style.width=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth+"px"),""!=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight&&(e.style.height=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight+"px"),""!=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent&&(e.style.marginLeft=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent+"px"),a="",""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?(a=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight+"px",e.style.height=parseInt(a,10)*n+"px"):a="20px",""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(e.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,a="",e.style.height=""):e.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size,e.style.borderCollapse="collapse","1"==DEXTTOP.G_CURREDITOR._config.useTableBorderAttribute&&e.setAttribute("border","1"),f="",f=DEXTTOP.DEXT5.browser.gecko?"1px solid ":"1px none ",e.style.border=f+DEXTTOP.G_CURREDITOR._config.defaultBorderColor,e.setAttribute("cellSpacing","0"),e.setAttribute("cellPadding",DEXTTOP.G_CURREDITOR._config.tableDefaultCellPadding),f=_iframeDoc.createElement("tbody");for(l=0;l<n;l++){o=_iframeDoc.createElement("tr");for(u=0;u<r;u++){var h=_iframeDoc.createElement("td");h.innerHTML=t,h.style.border="1px solid "+DEXTTOP.G_CURREDITOR._config.defaultBorderColor,o.appendChild(h),h.style.width=s-1+"px",h.style.height=a,DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&0==u&&0==l&&(h.id="temp_td_for_caret")}f.appendChild(o)}e.appendChild(f),o=getFirstRange().range,u=getMyElementNode(o.startContainer),"p"!=u.tagName.toLowerCase()||"<br>"!=u.innerHTML&&"<br/>"!=u.innerHTML&&"<br />"!=u.innerHTML&&""!=u.innerHTML&&"&nbsp;"!=u.innerHTML||o.selectNode(u),n=e.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,n),o=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(o)}else pasteHtmlAtCaretHuge(n);t=getFirstRange();if(t.range.startContainer&&(e=GetParentbyTagName(t.range.startContainer,"table"),null==e))try{if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion){var p=_iframeDoc.getElementById("temp_td_for_caret");p.removeAttribute("id"),e=GetParentbyTagName(p,"table")}}catch(d){}try{o.selectNode(e);var v=e.parentNode;"body"!=v.tagName.toLowerCase()&&o.setEndAfter(v),o.collapse(!1),DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||(t=getFirstRange(),t.sel.addRange(o)),DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(v,1),repairBodyFirstLastTag(!1);var m=e.rows[0].cells[0];m&&(createTableCellDefValue(m),0==checkCellBRValue()&&0==(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion)&&(m.innerHTML="<p></p>"),0!=DEXTTOP.DEXT5.browser.ie?doSetCaretPosition(m.childNodes[0],0):setTimeout(function(){doSetCaretPosition(m.childNodes[0],0)},10),DEXTTOP.G_SELECTED_ELEMENT=m.childNodes[0])}catch(g){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),ActiveCurrTable=e,setRulerPositionForNode(DEXTTOP.G_CURREDITOR),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}function command_InsertDetailTable(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){dext_src_init(t),restoreSelection(),setFocusToBody(),H||(H="px"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var B=M=t=e=0,j=getFirstRange().range,F=getMyElementNode(j.startContainer),I,j=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"table");if("3"!=n&&"4"!=n){e=r,t=i;if(""==s)try{var q=GetParentbyTagName(F,"td");if(q){var R=getClientRect(q);I=R.right-R.left}I?(M=I,"px"==H&&(M-=10)):M=j}catch(U){M=j}else M="%"==H?(j+10)*(1*parseInt(s,10)/100):"1"==DEXTTOP.G_CURREDITOR._config.autoBodyFit?s>j?j:s:s;""!=o&&(B=o)}else if("3"==n){e=S,t=x;if(""==T)try{if(q=GetParentbyTagName(F,"td"))R=getClientRect(q),I=R.right-R.left;M=I&&50<I?I-10:DEXTTOP.G_CURREDITOR._defTableWidth}catch(z){M=DEXTTOP.G_CURREDITOR._defTableWidth}else M=T;""!=N&&(B=N)}r=getFirstRange(),r=r.range;try{0==r.toString().length&&setRestoreCaretPos(!1)}catch(W){}if("4"!=n){D=Math.floor(M/t*100)/100,r=Math.floor(B/e*100)/100,0==r&&(r=""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?parseInt(DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight,10):20),i=getCellDefValue(),_=_iframeDoc.createElement("table"),S=DEXTTOP.DEXT5.util.getWordBreakStyle(DEXTTOP.G_CURREDITOR._config),_.style.wordBreak=S,null!=O&&""!=O&&(_.id=O),null!=A&&""!=A?(_.className=A,r=""):null==A&&""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(_.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,r=""):_.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size,"%"==H&&(M=""==s?"100":s),_.style.width=M+H;if("3"!=n){""!=o&&(_.style.height=B+"px"),"Y"==u?_.style.borderCollapse="separate":"N"==u&&(_.style.borderCollapse="collapse"),""==a||"left"==a&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||(_.align=a),"N"==u?_.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==u&&(""!=f.outsideTop&&(_.style.borderTop=f.outsideTop,showBorderForNoneClass(_,"dext_table_border_t")),""!=f.outsideLeft&&(_.style.borderLeft=f.outsideLeft,showBorderForNoneClass(_,"dext_table_border_l")),""!=f.outsideRight&&(_.style.borderRight=f.outsideRight,showBorderForNoneClass(_,"dext_table_border_r")),""!=f.outsideBottom&&(_.style.borderBottom=f.outsideBottom,showBorderForNoneClass(_,"dext_table_border_b"))),"1"==DEXTTOP.G_CURREDITOR._config.useTableBorderAttribute&&_.setAttribute("border","1"),""!=l&&_.setAttribute("cellSpacing",l),""!=c&&_.setAttribute("cellPadding",c),""!=p&&_.setAttribute("summary",p);if(""!=d){"[FAIL]"==d.substring(0,6)?(_.setAttribute("alt",d.substring(6,d.length)),d=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"):insertImageSrc(DEXTTOP.G_CURREDITOR,d),_.style.backgroundImage="url("+d+")",""!=v&&(_.style.backgroundAttachment=v),""!=m&&(_.style.backgroundRepeat=m);if(""!=g||""!=y)_.style.backgroundPosition=parseInt(g,10)+"px "+parseInt(y,10)+"px";if(P&&1<P.length)for(o=P.length,s=1;s<o;s++)a=P[s].split("^"),2==a.length&&_.setAttribute(a[0],a[1])}""!=b&&(_.style.backgroundColor=b)}else""!=N&&"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(_.style.height=B+"px"),"1"==k?(f.outsideTop="3px solid rgb(0, 216, 255)",f.outsideLeft="0px rgb(0, 0, 0)",f.outsideRight="0px rgb(0, 0, 0)",f.outsideBottom="3px solid rgb(0, 216, 255)",f.insideRow="1px solid rgb(0, 0, 0)",f.insideCol="1px solid rgb(0, 0, 0)",_.style.borderCollapse="collapse",_.style.fontSize="10pt",_.setAttribute("cellSpacing","0"),_.setAttribute("cellPadding","3")):"2"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"3"==k?(_.style.borderWidth="1px",_.style.borderStyle="dashed",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"4"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"5"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"6"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"7"==k?(_.style.borderWidth="medium",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.setAttribute("rules","none"),_.setAttribute("cellSpacing","0")):"8"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"9"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("cellSpacing","0")):"10"==k?(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1")):"11"==k?(_.style.borderStyle="hidden",_.style.borderColor="#ffffff",_.style.fontSize="10pt",_.setAttribute("border","1"),_.setAttribute("rules","none"),_.setAttribute("frame","void"),_.setAttribute("cellSpacing","0")):"12"==k&&(_.style.borderWidth="1px",_.style.borderStyle="solid",_.style.borderColor="#000000",_.style.fontSize="10pt",_.style.borderCollapse="collapse",_.setAttribute("border","1"),_.setAttribute("rules","rows"),_.setAttribute("cellSpacing","0"));0<L&&(_.style.marginLeft=L+"px"),b=_iframeDoc.createElement("tbody");for(L=0;L<e;L++){P=_iframeDoc.createElement("tr");for(s=0;s<t;s++){if("3"!=n)"2"==E?0==s?(o=_iframeDoc.createElement("th"),"Y"==w&&(o.scope="row")):o=_iframeDoc.createElement("td"):"3"==E?0==L?(o=_iframeDoc.createElement("th"),"Y"==w&&(o.scope="col")):o=_iframeDoc.createElement("td"):"4"==E?0==s||0==L?(o=_iframeDoc.createElement("th"),"Y"!=w||0==s&&0==L||(0==s&&(o.scope="row"),0==L&&(o.scope="col"))):o=_iframeDoc.createElement("td"):o=_iframeDoc.createElement("td"),o.innerHTML=i;else{if("5"==k&&0!=s&&0==L)continue;"1"==k||"2"==k||"5"==k||"10"==k||"11"==k||"12"==k?0==L?(o=_iframeDoc.createElement("th"),"Y"==C&&(o.scope="col")):o=_iframeDoc.createElement("td"):"6"==k?0==L||0==s?(o=_iframeDoc.createElement("th"),"Y"!=C||0==s&&0==L||(0==s&&(o.scope="row"),0==L&&(o.scope="col"))):o=_iframeDoc.createElement("td"):"8"==k?0==s?(o=_iframeDoc.createElement("th"),"Y"==C&&(o.scope="row")):o=_iframeDoc.createElement("td"):o=_iframeDoc.createElement("td"),"1"==k?0==L?(a=_iframeDoc.createElement("p"),a.innerHTML="T"+(s+1),o.appendChild(a)):o.innerHTML=i:o.innerHTML=i}P.appendChild(o),"3"==n&&"1"!=k?"4"==k?(o.style.borderWidth="1px",o.style.borderStyle="dashed",o.style.borderColor="#000000"):"5"==k?0==s&&0==L&&o.setAttribute("colSpan",t):"6"==k?0==L?0!=s&&(o.style.backgroundColor="#e5e5e5"):0==s&&(o.style.backgroundColor="#e9f5f7"):"8"==k&&0==s&&(o.style.backgroundColor="#e9f5f7"):("3"==n&&"1"==k&&0==L&&(o.style.textAlign="center"),o.style.border="1px solid #000000","N"==u&&(0==L&&""!=f.outsideTop&&(o.style.borderTop=f.outsideTop,showBorderForNoneClass(o,"dext_table_border_t")),0==s&&""!=f.outsideLeft&&(o.style.borderLeft=f.outsideLeft,showBorderForNoneClass(o,"dext_table_border_l")),s==t-1&&""!=f.outsideRight&&(o.style.borderRight=f.outsideRight,showBorderForNoneClass(o,"dext_table_border_r")),L==e-1&&""!=f.outsideBottom&&(o.style.borderBottom=f.outsideBottom,showBorderForNoneClass(o,"dext_table_border_b")))),""!=D&&(o.style.width=D-1+"px"),""!=r&&(o.style.height=r+"px"),DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&0==s&&0==L&&(o.id="temp_td_for_caret")}b.appendChild(P),"3"==n&&("2"==k?0==L&&(P.style.backgroundColor="#e5e5e5"):"5"==k?0==L&&(P.style.backgroundColor="#e5e5e5"):"9"==k?P.style.backgroundColor=0==L%2?"#e5e5e5":"#e9f5f7":"10"==k?0==L?P.style.backgroundColor="#e5e5e5":L==parseInt(e,10)-1&&(P.style.backgroundColor="#e9f5f7"):"11"==k?0==L&&(P.style.backgroundColor="#e5e5e5"):"12"==k&&0==L&&(P.style.backgroundColor="#e5e5e5"))}""!=h&&(u=_iframeDoc.createElement("caption"),u.innerHTML=h,_.appendChild(u)),_.appendChild(b),("3"!=n||"3"==n&&"1"==k)&&setBorderTableAndAllCell(_,f),f=_}else f="TableTemplateList",0==DEXTTOP.DEXT5.util.xml.count(D,f)&&(f="TableTempleteList"),f=DEXTTOP.DEXT5.util.xml.getNodeIdx(D,f,parseInt(_,10)-1),f=DEXTTOP.DEXT5.util.xml.getNode(f,"SetSource").textContent||DEXTTOP.DEXT5.util.xml.getNode(f,"SetSource").text,f=DEXTTOP.DEXT5.util.replaceAll(f,"\r\n",""),f=DEXTTOP.DEXT5.util.replaceAll(f,"\r",""),f=DEXTTOP.DEXT5.util.replaceAll(f,"\n",""),f=DEXTTOP.DEXT5.util.replaceAll(f,"	",""),f=f.replace(/^\s+/,"").replace(/\s+$/,""),h=_iframeDoc.createElement("div"),h.innerHTML=f,f=h.childNodes[0],delete h;j=getFirstRange().range,F=getMyElementNode(j.startContainer),"p"!=F.tagName.toLowerCase()||"<br>"!=F.innerHTML&&"<br/>"!=F.innerHTML&&"<br />"!=F.innerHTML&&""!=F.innerHTML&&"&nbsp;"!=F.innerHTML||j.selectNode(F),j.deleteContents(),h=f.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,h),j=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(j)}else pasteHtmlAtCaretHuge(h);r=getFirstRange();if(r.range.startContainer&&(f=GetParentbyTagName(r.range.startContainer,"table"),null==f))try{if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion){var X=_iframeDoc.getElementById("temp_td_for_caret");X.removeAttribute("id"),f=GetParentbyTagName(X,"table")}}catch(V){}try{j.selectNode(f);var $=f.parentNode;"body"!=$.tagName.toLowerCase()&&j.setEndAfter($),j.collapse(!1),DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||(r=getFirstRange(),r.sel.addRange(j)),DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition($,1),repairBodyFirstLastTag(!1);var J=f.rows[0].cells[0];J&&("4"!=n&&createTableCellDefValue(J),0==checkCellBRValue()&&""==J.innerHTML&&(J.innerHTML="<p></p>"),doSetCaretPosition(J.childNodes[0],0))}catch(K){}if("1"==DEXTTOP.G_CURREDITOR._config.limitTableInoutdent){n=0,X=getClientRect(f),$=X.right;if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))n=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width),$-=10;else{n=_iframeDoc.documentElement.clientWidth;if(0==n||null==n||void 0==n)n=_iframeDoc.body.clientWidth;n=Math.floor(n),n-=10}0<n&&$>=n&&(n-=X.right-X.left+10,0>n&&(n=0),f.style.marginLeft=n+"px")}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),ActiveCurrTable=f,setRulerPositionForNode(DEXTTOP.G_CURREDITOR)}function command_InsertTableProperty(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),N||(N="px");var C=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");null==S||""==S?removeAttribute(C,"id"):""!=S&&(C.id=S),C.style.wordBreak=C.style.wordBreak,""==E?(removeAttribute(C,"class"),C.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size):null!=E&&(C.className=E,C.style.fontSize=""),t=C.style.width,""!=n&&("%"==N&&(C.oWidth=C.clientWidth),C.style.width=n+N),e=C.style.height,""!=r&&"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(C.style.height=r+"px"),"N"==i?C.style.borderCollapse="collapse":"Y"==i&&(C.style.borderCollapse="separate"),C.align=""==s||"left"==s&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?"":s,C.style.marginLeft=0<w?w+"px":"","N"==i?C.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==i&&(""!=o.outsideTop&&(C.style.borderTop=o.outsideTop,showBorderForNoneClass(C,"dext_table_border_t")),""!=o.outsideLeft&&(C.style.borderLeft=o.outsideLeft,showBorderForNoneClass(C,"dext_table_border_l")),""!=o.outsideRight&&(C.style.borderRight=o.outsideRight,showBorderForNoneClass(C,"dext_table_border_r")),""!=o.outsideBottom&&(C.style.borderBottom=o.outsideBottom,showBorderForNoneClass(C,"dext_table_border_b"))),""!=u&&C.setAttribute("cellSpacing",u),""!=a&&C.setAttribute("cellPadding",a),s=!1,u=0,a=C.childNodes.length;for(i=0;i<a;i++)if(C.childNodes[i].nodeName.match(/caption/i)){s=!0,u=i;break}""==f?s&&C.removeChild(C.childNodes[u]):s?C.childNodes[u].innerHTML=f:(i=_iframeDoc.createElement("caption"),i.innerHTML=f,C.appendChild(i)),""!=l&&C.setAttribute("summary",l);if("Y"==c)C.style.backgroundImage="",C.style.backgroundAttachment="",C.style.backgroundRepeat="",C.style.backgroundPosition="",C.style.backgroundColor="",C.removeAttribute("background");else if("N"==c){if(""!=h){"[FAIL]"==h.substring(0,6)&&(C.setAttribute("alt",h.substring(6,h.length)),h=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),0==h.indexOf("url")?C.style.backgroundImage=h:C.style.backgroundImage="url("+h+")",C.removeAttribute("background"),C.style.backgroundAttachment=""==p?"":p,C.style.backgroundRepeat=""==d?"":d;if(""!=v||""!=m)C.style.backgroundPosition=parseInt(v,10)+"px "+parseInt(m,10)+"px";if(T&&1<T.length)for(f=T.length,i=1;i<f;i++)l=T[i].split("^"),2==l.length&&C.setAttribute(l[0],l[1])}if(""!=g)for(C.style.backgroundColor=g,T=C.rows,f=C.rows.length,i=0;i<f;i++)for(l=T[i].cells,c=T[i].cells.length,g=0;g<c;g++)""!=l[g].style.backgroundColor&&(l[g].style.backgroundColor="")}g=GetTableSelectionCellsPosition(C,!0),T=g.arrOutSideLeft.length,f=g.arrOutSideRight.length,l=g.arrOutSideTop.length,c=g.arrOutSideBottom.length,h=g.arrSelected.length,p=[],d=[],v=[],m=[],s="";if(""==o.outsideLeft)for(i=0;i<T;i++)s=g.arrOutSideLeft[i].style.borderLeftWidth+" "+g.arrOutSideLeft[i].style.borderLeftStyle+" "+g.arrOutSideLeft[i].style.borderLeftColor,p.push(s);if(""==o.outsideRight)for(i=0;i<f;i++)s=g.arrOutSideRight[i].style.borderRightWidth+" "+g.arrOutSideRight[i].style.borderRightStyle+" "+g.arrOutSideRight[i].style.borderRightColor,d.push(s);if(""==o.outsideTop)for(i=0;i<l;i++)s=g.arrOutSideTop[i].style.borderTopWidth+" "+g.arrOutSideTop[i].style.borderTopStyle+" "+g.arrOutSideTop[i].style.borderTopColor,v.push(s);if(""==o.outsideBottom)for(i=0;i<c;i++)s=g.arrOutSideBottom[i].style.borderBottomWidth+" "+g.arrOutSideBottom[i].style.borderBottomStyle+" "+g.arrOutSideBottom[i].style.borderBottomColor,m.push(s);if(""!=o.insideRow)for(i=0;i<h;i++)command_ApplyCellProperty("inRow",g.arrSelected[i],o);if(""!=o.insideCol)for(i=0;i<h;i++)command_ApplyCellProperty("inCol",g.arrSelected[i],o);if(""==o.outsideLeft)for(i=0;i<T;i++)o.outsideLeft=p[i],command_ApplyCellProperty("left",g.arrOutSideLeft[i],o);else for(i=0;i<T;i++)command_ApplyCellProperty("left",g.arrOutSideLeft[i],o);if(""==o.outsideRight)for(i=0;i<f;i++)o.outsideRight=d[i],command_ApplyCellProperty("right",g.arrOutSideRight[i],o);else for(i=0;i<f;i++)command_ApplyCellProperty("right",g.arrOutSideRight[i],o);if(""==o.outsideTop)for(i=0;i<l;i++)o.outsideTop=v[i],command_ApplyCellProperty("top",g.arrOutSideTop[i],o);else for(i=0;i<l;i++)command_ApplyCellProperty("top",g.arrOutSideTop[i],o);if(""==o.outsideBottom)for(i=0;i<c;i++)o.outsideBottom=m[i],command_ApplyCellProperty("bottom",g.arrOutSideBottom[i],o);else for(i=0;i<c;i++)command_ApplyCellProperty("bottom",g.arrOutSideBottom[i],o);o=C.rows.length;for(i=T=0;i<o;i++)for(T=C.rows[i].cells.length,g=0;g<T;g++){"2"==b?0==g?(f=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0),"Y"==y&&(f.scope="row")):(f=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0)):"3"==b?0==i?(f=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0),"Y"==y&&(f.scope="col")):(f=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0)):"4"==b?0==i||0==g?(f=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0),"Y"==y&&(0!=i||0!=g?(0==i&&(f.scope="col"),0==g&&(f.scope="row")):f.scope="")):(f=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0)):(f=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(C.rows[i].cells[g],f,!0)),"N"==y&&(f.scope=""),""!=C.rows[i].cells[g].id&&(f.id=C.rows[i].cells[g].id),"1"!=C.rows[i].cells[g].colSpan&&(f.colSpan=C.rows[i].cells[g].colSpan),"1"!=C.rows[i].cells[g].rowSpan&&(f.rowSpan=C.rows[i].cells[g].rowSpan),""!=C.rows[i].cells[g].style.width&&(f.style.width=C.rows[i].cells[g].style.width),""!=C.rows[i].cells[g].style.height&&(f.style.height=C.rows[i].cells[g].style.height),""!=C.rows[i].cells[g].style.textAlign&&(f.style.textAlign=C.rows[i].cells[g].style.textAlign),""!=C.rows[i].cells[g].style.verticalAlign&&(removeAttribute(C.rows[i].cells[g],"valign"),f.style.verticalAlign=C.rows[i].cells[g].style.verticalAlign),"nowrap"==C.rows[i].cells[g].style.whiteSpace&&(f.style.whiteSpace="nowrap"),""!=C.rows[i].cells[g].style.backgroundImage&&(f.style.backgroundImage=C.rows[i].cells[g].style.backgroundImage),""!=C.rows[i].cells[g].style.backgroundAttachment&&(f.style.backgroundAttachment=C.rows[i].cells[g].style.backgroundAttachment),""!=C.rows[i].cells[g].style.backgroundRepeat&&(f.style.backgroundRepeat=C.rows[i].cells[g].style.backgroundRepeat),""!=C.rows[i].cells[g].style.backgroundPosition&&(f.style.backgroundPosition=C.rows[i].cells[g].style.backgroundPosition),""!=C.rows[i].cells[g].style.backgroundColor&&(f.style.backgroundColor=C.rows[i].cells[g].style.backgroundColor),l=[],c=[];try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion){l=C.rows[i].cells[g].getElementsByTagName("a");for(var k=l.length,L=0;L<k;L++)l[L].outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),c.push(RegExp.$2)}}catch(A){l=[],c=[]}f.innerHTML=C.rows[i].cells[g].innerHTML;try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(k=l.length,0<k))for(var O=f.getElementsByTagName("a"),M=O.length,L=0;L<M;L++)O[L].href&&0>O[L].href.toLowerCase().indexOf("javascript")&&0>O[L].href.indexOf("'")&&0>O[L].href.indexOf('"')&&""!=c[L]&&O[L].href!=c[L]&&(O[L].href=c[L],O[L].setAttribute("href",c[L]))}catch(_){f.innerHTML=C.rows[i].cells[g].innerHTML}C.rows[i].cells[g].parentNode.replaceChild(f,C.rows[i].cells[g])}setAdjustTableWidthHeight(C),ClearDraggingTableCellSelected(),0<C.rows[0].cells[0].childNodes.length?setTimeout(function(){doSetCaretPosition(C.rows[0].cells[0].childNodes[0],0)},0):setTimeout(function(){doSetCaretPosition(C.rows[0].cells[0],0)},0),""!=t&&(y=parseInt(t,10),b=t.replace(y,""),y==parseInt(n,10)&&b==N||command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"forceAdjust",targetTable:C})),-1<e.indexOf("px")&&(e=parseInt(e,10),e!=parseInt(r,10)&&command_AdjustTableAndCellHeight(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"forceAdjust",targetTable:C,beforeHeight:e}));if("1"==DEXTTOP.G_CURREDITOR._config.limitTableInoutdent){n=0,r=getClientRect(C),N=r.right;if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))n=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width),N-=10;else{n=_iframeDoc.documentElement.clientWidth;if(0==n||null==n||void 0==n)n=_iframeDoc.body.clientWidth;n=Math.floor(n),n-=10}0<n&&N>=n&&(n-=r.right-r.left+10,0>n&&(n=0),C.style.marginLeft=n+"px")}DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertCellProperty(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var w="";"collapse"==e.style.borderCollapse?w="N":"separate"==e.style.borderCollapse&&(w="Y"),t=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT),t=GetTableSelectionCellsPosition(t,!1),ClearDraggingTableCellSelected();var E=t.arrOutSideLeft.length,S=t.arrOutSideRight.length,x=t.arrOutSideTop.length,T=t.arrOutSideBottom.length,N=t.arrSelected.length,C=[],k=[],L=[],A=[],O="";if(""==u.outsideLeft)for(var M=0;M<E;M++)O=t.arrOutSideLeft[M].style.borderLeftWidth+" "+t.arrOutSideLeft[M].style.borderLeftStyle+" "+t.arrOutSideLeft[M].style.borderLeftColor,C.push(O);if(""==u.outsideRight)for(M=0;M<S;M++)O=t.arrOutSideRight[M].style.borderRightWidth+" "+t.arrOutSideRight[M].style.borderRightStyle+" "+t.arrOutSideRight[M].style.borderRightColor,k.push(O);if(""==u.outsideTop)for(M=0;M<x;M++)O=t.arrOutSideTop[M].style.borderTopWidth+" "+t.arrOutSideTop[M].style.borderTopStyle+" "+t.arrOutSideTop[M].style.borderTopColor,L.push(O);if(""==u.outsideBottom)for(M=0;M<T;M++)O=t.arrOutSideBottom[M].style.borderBottomWidth+" "+t.arrOutSideBottom[M].style.borderBottomStyle+" "+t.arrOutSideBottom[M].style.borderBottomColor,A.push(O);if(""!=u.insideRow)for(M=0;M<N;M++)command_ApplyCellProperty("inRow",t.arrSelected[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);else for(M=0;M<N;M++)command_ApplyCellProperty("inRow",t.arrSelected[M],null,n,r,s,o,a,f,l,c,h,p,d,v,m,g);if(""!=u.insideCol)for(M=0;M<N;M++)command_ApplyCellProperty("inCol",t.arrSelected[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);else for(M=0;M<N;M++)command_ApplyCellProperty("inCol",t.arrSelected[M],null,n,r,s,o,a,f,l,c,h,p,d,v,m,g);if(""==u.outsideLeft)for(M=0;M<E;M++)u.outsideLeft=C[M],command_ApplyCellProperty("left",t.arrOutSideLeft[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);else for(M=0;M<E;M++)"N"==w&&(C=getCellNearLeftTop(t.arrOutSideLeft[M]),command_ApplyEdgeReduce(C.arrLeft,u,"left")),command_ApplyCellProperty("left",t.arrOutSideLeft[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);if(""==u.outsideRight)for(M=0;M<S;M++)u.outsideRight=k[M],command_ApplyCellProperty("right",t.arrOutSideRight[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);else for(M=0;M<S;M++)"N"==w&&(C=getCellNearLeftTop(t.arrOutSideRight[M]),command_ApplyEdgeReduce(C.arrRight,u,"right")),command_ApplyCellProperty("right",t.arrOutSideRight[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);if(""==u.outsideTop)for(M=0;M<x;M++)u.outsideTop=L[M],command_ApplyCellProperty("top",t.arrOutSideTop[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);else for(M=0;M<x;M++)"N"==w&&(C=getCellNearLeftTop(t.arrOutSideTop[M]),command_ApplyEdgeReduce(C.
arrTop,u,"top")),command_ApplyCellProperty("top",t.arrOutSideTop[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);if(""==u.outsideBottom)for(M=0;M<T;M++)u.outsideBottom=A[M],command_ApplyCellProperty("bottom",t.arrOutSideBottom[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);else for(M=0;M<T;M++)"N"==w&&(C=getCellNearLeftTop(t.arrOutSideBottom[M]),command_ApplyEdgeReduce(C.arrBottom,u,"bottom")),command_ApplyCellProperty("bottom",t.arrOutSideBottom[M],u,n,r,s,o,a,f,l,c,h,p,d,v,m,g);if(null!=i)if(0<N)for(M=0;M<N;M++)command_ApplyTitleCell(t.arrSelected[M],i);else command_ApplyTitleCell(DEXTTOP.G_SELECTED_ELEMENT,i);if(""!=y||""!=b){r=[],0<t.arrSelected.length?r=t.arrSelected:r.push(DEXTTOP.G_SELECTED_ELEMENT),i=r.length,o=[];for(M=0;M<i;M++)s=r[M],""!=y&&(y=DEXTTOP.DEXT5.util.parseIntOr0(y),n=getClientRect(s),n=DEXTTOP.DEXT5.util.parseIntOr0(n.right-n.left),o.push(n)),""!=b&&(s.style.height=b+"px");if(""!=y){for(M=0;M<i;M++)s=r[M],s.style.width=y+"px";y=[0];for(M=1;M<i;M++){b=y.length,o=!1,s=r[M],n=getClientRect(s);for(s=0;s<b;s++)if(u=getClientRect(r[y[s]]),n.left>=u.left&&n.right<=u.right){o=!0;break}0==o&&y.push(M)}b=y=M=!1,n=getClientRect(t.arrOutSideTop[0]),r=getClientRect(t.arrOutSideBottom[0]),i=getClientRect(e),1>=Math.abs(n.top-i.top)&&(y=!0),1>=Math.abs(r.bottom-i.bottom)&&(b=!0),y&&b&&(M=!0);if(M){for(M=b=y=0;M<t.virtualSelectionsCellTable.length;M++)n=t.virtualSelectionsCellTable[M].length,n>b&&(b=n,y=M);t=t.virtualSelectionsCellTable[y][0].parentNode.cells,y=t.length;for(M=b=0;M<y;M++)n=0,""!=t[M].style.width&&t[M].style.width.indexOf("px")?n=DEXTTOP.DEXT5.util.parseIntOr0(t[M].style.width):(n=getClientRect(t[M]),n=n.right-n.left),b+=n;e.style.width=b+1+"px",setRulerPositionForNode(DEXTTOP.G_CURREDITOR)}}}0<DEXTTOP.G_SELECTED_ELEMENT.childNodes.length?doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT.childNodes[0],0):doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_ApplyTitleCell(e,t){var n=e.tagName.toLowerCase(),r="",i;"Y"==t?(r="th",i=_iframeDoc.createElement("th")):"N"==t?(r="td",i=_iframeDoc.createElement("td")):(i=_iframeDoc.createElement(e.tagName.toLowerCase()),r=e.tagName.toLowerCase()),n!=r&&(setCopyAllObjectAtributes(e,i,!0),i.innerHTML=e.innerHTML,i.style.width=e.style.width,i.style.height=e.style.height,1<e.colSpan&&(i.colSpan=e.colSpan),1<e.rowSpan&&(i.rowSpan=e.rowSpan)),n!=r&&e.parentNode.replaceChild(i,e)}function command_ApplyCellProperty(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){""==d?removeAttribute(t,"class"):null!=d&&(t.className=d),""==v?removeAttribute(t,"id"):null!=v&&(t.id=v),""==r?t.style.textAlign="":null!=r&&(t.style.textAlign=r),""==i?t.style.verticalAlign="":null!=i&&(removeAttribute(t,"valign"),t.style.verticalAlign=i),null!=s&&(""==s?t.removeAttribute("scope"):t.scope=s),null!=o&&("Y"==o?t.style.whiteSpace="nowrap":"N"==o&&"nowrap"==t.style.whiteSpace&&(t.style.whiteSpace="")),n&&((r=RegExp("^\\s\\s*$","g"),"top"==e)?n.outsideTop.match(r)?""!=t.style.borderTop&&(t.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_t")):(t.style.borderTop=n.outsideTop,showBorderForNoneClass(t,"dext_table_border_t")):"bottom"==e?n.outsideBottom.match(r)?""!=t.style.borderBottom&&(t.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_b")):(t.style.borderBottom=n.outsideBottom,showBorderForNoneClass(t,"dext_table_border_b")):"left"==e?n.outsideLeft.match(r)?""!=t.style.borderLeft&&(t.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_l")):(t.style.borderLeft=n.outsideLeft,showBorderForNoneClass(t,"dext_table_border_l")):"right"==e?n.outsideRight.match(r)?""!=t.style.borderRight&&(t.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_r")):(t.style.borderRight=n.outsideRight,showBorderForNoneClass(t,"dext_table_border_r")):"inRow"==e?n.insideRow.match(r)?(""!=t.style.borderTop&&(t.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_t")),""!=t.style.borderBottom&&(t.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_b"))):(t.style.borderTop=n.insideRow,t.style.borderBottom=n.insideRow,showBorderForNoneClass(t,"dext_table_border_t"),showBorderForNoneClass(t,"dext_table_border_b")):"inCol"==e&&(n.insideCol.match(r)?(""!=t.style.borderLeft&&(t.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_l")),""!=t.style.borderRight&&(t.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(t,"dext_table_border_r"))):(t.style.borderLeft=n.insideCol,t.style.borderRight=n.insideCol,showBorderForNoneClass(t,"dext_table_border_l"),showBorderForNoneClass(t,"dext_table_border_r"))));if("Y"==u)t.style.backgroundImage="",t.style.backgroundAttachment="",t.style.backgroundRepeat="",t.style.backgroundPosition="",t.style.backgroundColor="",t.removeAttribute("cellOrgBgColor"),t.removeAttribute("background");else if("N"==u){""!=a&&("[FAIL]"==a.substring(0,6)&&(t.setAttribute("alt",a.substring(6,a.length)),a=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),0==a.indexOf("url")?t.style.backgroundImage=a:t.style.backgroundImage="url("+a+")",t.removeAttribute("background"));if(m&&1<m.length)for(e=m.length,n=1;n<e;n++)u=m[n].split("^"),2==u.length&&t.setAttribute(u[0],u[1]);""==f?t.style.backgroundAttachment="":null!=f&&(t.style.backgroundAttachment=f),""==l?t.style.backgroundRepeat="":null!=l&&(t.style.backgroundRepeat=l),f=t.style.backgroundPosition,l=["0px","0px"],""!=f&&(l=f.split(" "));if(""!=c&&""!=h)t.style.backgroundPosition=parseInt(c,10)+"px "+parseInt(h,10)+"px";else if(""!=c||""!=h)""!=c&&""==h?t.style.backgroundPosition=parseInt(c,10)+"px "+l[1]:""==c&&""!=h&&(t.style.backgroundPosition=l[0]+" "+parseInt(h,10)+"px");""!=p&&(t.style.backgroundColor=p)}}function command_ApplyEdgeReduce(e,t,n){if(e){var r=e.length;if("top"==n)for(var i=0;i<r;i++)e[i].style.borderBottom=t.outsideTop;if("left"==n)for(i=0;i<r;i++)e[i].style.borderRight=t.outsideLeft;if("right"==n)for(i=0;i<r;i++)e[i].style.borderLeft=t.outsideRight;if("bottom"==n)for(i=0;i<r;i++)e[i].style.borderTop=t.outsideBottom}}function command_InsertRowColumn(e,t,n,r,i){dext_src_init(t),restoreSelection(),setFocusToBody(),"R"==n&&"U"==r?command_insertRowUp(e,_dext_editor,i):"R"==n&&"D"==r?command_insertRowDown(e,_dext_editor,i):"C"==n&&"R"==r?command_insertCellRight(e,_dext_editor,i):"C"==n&&"L"==r&&command_insertCellLeft(e,_dext_editor,i)}function command_RowProperty(e,t,n,r,i,s){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT),setTableRowSelect(e),e=getCellNearLeftTop(e),t=e.arrSelected.length;for(var o=0;o<t;o++)""!=r&&(e.arrSelected[o].style.height=r+"px"),e.arrSelected[o].style.textAlign=""==i?"":i,e.arrSelected[o].style.verticalAlign=""==s?"":s,""!=n&&e.arrSelected[o].setAttribute("cellOrgBgColor",n);ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected"),ClearDraggingTableCellSelected(),e&&0<e.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}function command_ColumnProperty(e,t,n,r,i,s,o){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT),setTableColumnSelect(e),e=getCellNearLeftTop(e),t=e.arrSelected.length;for(o=0;o<t;o++)""!=r&&(e.arrSelected[o].style.width=r+"px"),e.arrSelected[o].style.textAlign=""==i?"":i,e.arrSelected[o].style.verticalAlign=""==s?"":s,""!=n&&e.arrSelected[o].setAttribute("cellOrgBgColor",n);ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected"),ClearDraggingTableCellSelected(),e&&e.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}function command_InsertCellBorder(e,t,n,r,i,s){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var o="";"collapse"==e.style.borderCollapse?o="N":"separate"==e.style.borderCollapse&&(o="Y"),e=!1,t=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT),t=getCellNearLeftTop(t);for(var u=t.arrSelected.length,a=0;a<u;a++)e=t.arrSelected[a],""!=n&&(e.style.borderTop=n),""!=r&&(e.style.borderLeft=r),""!=i&&(e.style.borderRight=i),""!=s&&(e.style.borderBottom=s),e=!0;if("N"==o){if(""!=n)for(o=t.arrTop.length,a=0;a<o;a++)t.arrTop[a].style.borderBottom=n,e=!0;if(""!=r)for(n=t.arrLeft.length,a=0;a<n;a++)t.arrLeft[a].style.borderRight=r,e=!0;if(""!=i)for(r=t.arrRight.length,a=0;a<r;a++)t.arrRight[a].style.borderLeft=i,e=!0;if(""!=s)for(i=t.arrBottom.length,a=0;a<i;a++)t.arrBottom[a].style.borderTop=s,e=!0}e&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}function command_cellBGColor(e,t,n){dext_src_init(t),e=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"cell_bg_color_show"),n?e.style.backgroundColor=n:n=e.style.backgroundColor,restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r;try{if(DEXTTOP.G_SELECTED_ELEMENT)r=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);else{var i=getFirstRange().range;e=null,i&&i.startContainer&&(e=getMyElementNode(i.startContainer)),r=GetTDTHCell(e)}var s=getCellNearLeftTop(r),o=s.arrSelected.length;for(r=0;r<o;r++){var u=s.arrSelected[r];u.style.backgroundColor=n,u.removeAttribute("dext_select")}s&&0<s.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}catch(a){}}function command_InsertDogBGImg(e,t,n,r,i,s,o,u){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if("Y"==n)_iframeDoc.body.style.backgroundImage="",_iframeDoc.body.style.backgroundAttachment="",_iframeDoc.body.style.backgroundRepeat="",_iframeDoc.body.style.backgroundColor="",_iframeDoc.body.removeAttribute("background"),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="",DEXTTOP.G_CURREDITOR._PageProp.bodycolor="",DEXTTOP.G_CURREDITOR._PageProp.bodyattachment="",DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat="",showRuler(DEXTTOP.G_CURREDITOR);else if("N"==n&&("1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&("[FAIL]"==r.substring(0,6)&&(_iframeDoc.body.setAttribute("alt",r.substring(6,r.length)),r=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),_iframeDoc.body.style.backgroundImage="url("+r+")",_iframeDoc.body.removeAttribute("background"),_iframeDoc.body.style.backgroundAttachment=i,_iframeDoc.body.style.backgroundRepeat=s,""!=o&&(_iframeDoc.body.style.backgroundColor=o)),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="url("+r+")",""!=o&&(DEXTTOP.G_CURREDITOR._PageProp.bodycolor=o),DEXTTOP.G_CURREDITOR._PageProp.bodyattachment=i,DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat=s,u&&1<u.length))for(e=u.length,t=1;t<e;t++)n=u[t].split("^"),2==n.length&&_iframeDoc.body.setAttribute(n[0],n[1]);DEXTTOP.G_CURREDITOR._PageProp.bshowgrid&&1==DEXTTOP.G_CURREDITOR._PageProp.bshowgrid?changeBodyImageProperty(!1):"1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&changeBodyImageProperty(!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertImage(e,t,n,r,i,s,o,u){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),n=getFirstRange().range;try{0==n.toString().length&&setRestoreCaretPos(!1)}catch(a){}n=_iframeDoc.createElement("img");if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code)r=u.srcURL,i=r.split("|"),"emoticon"==G_LAST_CMD||u.input_url_checked?"[FAIL]"==r.substring(0,6)?(n.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),n.setAttribute("alt",r.substring(6,r.length).replace(/"/g,"'"))):n.setAttribute("src",r):("[FAIL]"==i[2].substring(0,6)?(n.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),n.setAttribute("alt",i[2].substring(6,i[2].length).replace(/"/g,"'"))):n.setAttribute("src",i[2]),n.setAttribute("filemimeinfo",r),0==u.input_url_checked&&"[FAIL]"!=i[2].substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,i[2])),n.setAttribute("title",u.title),"emoticon"==G_LAST_CMD||u.input_url_checked?"[FAIL]"!=r.substring(0,6)&&n.setAttribute("alt",u.alt):"[FAIL]"!=i[2].substring(0,6)&&n.setAttribute("alt",u.alt),"undefined"!=typeof u.id&&""!=u.id&&n.setAttribute("id",u.id),"undefined"!=typeof u.className&&""!=u.className&&n.setAttribute("class",u.className),"0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=u.width&&(n.style.width=u.width+"px"),""!=u.height&&(n.style.height=u.height+"px")),""!=u.margin_top.toString()&&(n.style.marginTop=u.margin_top+"px"),""!=u.margin_right.toString()&&(n.style.marginRight=u.margin_right+"px"),""!=u.margin_bottom.toString()&&(n.style.marginBottom=u.margin_bottom+"px"),""!=u.margin_left.toString()&&(n.style.marginLeft=u.margin_left+"px"),""!=u.align&&n.setAttribute("align",u.align),""==u.border?n.setAttribute("border","0"):n.setAttribute("border",u.border),""==u.border?n.style.border="0px solid":n.style.border=u.border+"px solid";else if(void 0==u.widthUnit&&(u.widthUnit="px"),void 0==u.heightUnit&&(u.heightUnit="px"),"0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=u.width&&(n.style.width=u.width+u.widthUnit),""!=u.height&&(n.style.height=u.height+u.heightUnit)),"[FAIL]"==u.srcURL.substring(0,6)?(n.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),n.setAttribute("alt",u.srcURL.substring(6,u.srcURL.length).replace(/"/g,"'"))):n.setAttribute("src",u.srcURL),0==u.input_url_checked&&"[FAIL]"!=u.srcURL.substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,u.srcURL),n.setAttribute("title",u.title),"[FAIL]"!=u.srcURL.substring(0,6)&&n.setAttribute("alt",u.alt),"undefined"!=typeof u.id&&""!=u.id&&n.setAttribute("id",u.id),"undefined"!=typeof u.className&&""!=u.className&&n.setAttribute("class",u.className),""!=u.margin_top.toString()&&(n.style.marginTop=u.margin_top+"px"),""!=u.margin_right.toString()&&(n.style.marginRight=u.margin_right+"px"),""!=u.margin_bottom.toString()&&(n.style.marginBottom=u.margin_bottom+"px"),""!=u.margin_left.toString()&&(n.style.marginLeft=u.margin_left+"px"),""!=u.align&&n.setAttribute("align",u.align),""==u.border?n.setAttribute("border","0"):n.setAttribute("border",u.border),""==u.border?n.style.border="0px solid":n.style.border=u.border+"px solid",n=setImageBorder(n,{borderStyle:u.borderStyle,borderWidth:u.borderThickness,borderColor:u.borderColor,borderKind:u.borderKind}),(r=u.img_attr_info_arr)&&1<r.length)for(s=r.length,i=1;i<s;i++)o=r[i].split("^"),2==o.length&&n.setAttribute(o[0],o[1]);r=getFirstRange().range,r.collapse(!0);if(u.figure){i=_iframeDoc.createElement("figure"),s=_iframeDoc.createElement("figcaption"),i.setAttribute("contenteditable","false"),i.setAttribute("style",DEXTTOP.G_CURREDITOR._config.figure.figurestyle),s.setAttribute("style",DEXTTOP.G_CURREDITOR._config.figure.figcaptionstyle),s.setAttribute("contenteditable","true"),s.setAttribute("dext_default_caption","true"),i.appendChild(n),i.appendChild(s),i=i.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,i),r=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(r)}else pasteHtmlAtCaretHuge(i);s=_iframeDoc.getElementsByTagName("figcaption"),o=s.length;for(i=0;i<o;i++)if("true"==s[i].getAttribute("dext_default_caption")){s[i].removeAttribute("dext_default_caption"),o=_iframeDoc.createElement("p"),o.innerHTML=DEXTTOP.G_CURREDITOR._config.figure.defaultcaption,s[i].appendChild(o);break}}else r.insertNode(n);try{if(void 0==n.nextSibling||null==n.nextSibling){var f=r.getDocument().createTextNode(" ");n.parentNode.appendChild(f)}}catch(l){}r.selectNode(n),r.collapse(!1),f=!1,DEXTTOP.DEXT5.browser.safari&&u.continueInsert&&(f=!0,i=_iframeDoc.createElement("br"),r.insertNode(i),r.selectNode(i),r.collapse(!1)),u.imageSpacing&&(i=_iframeDoc.createElement("br"),r.insertNode(i),r.selectNode(i),r.collapse(!1),0==f&&(i=_iframeDoc.createElement("br"),r.insertNode(i),r.selectNode(i),r.collapse(!1))),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(r),adjustSizeInContainer({nodes:n}),""!=u.linkurl&&(n.parentNode.removeChild(n),command_InsertHyperLink(e,t,{type:"hyperlink",text:n.outerHTML,url:u.linkurl,target:u.linktarget,title:u.linktitle})),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper(n)}catch(c){}}function command_InsertMedia(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange(),0<e.range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),range.pasteHtml(n),e.sel.collapseToEnd(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertReplacedImg(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),e=makeImageElementForObject(n),t=getFirstRange().range,t.deleteContents(),t.insertNode(e),t.selectNode(t.endContainer),t.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(t),rangy.getSelection(_iframeWin).collapseToEnd(),"0"==DEXTTOP.G_CURREDITOR._config.useReplaceImage&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1,ReplaceImageToRealObject(!1,!0)),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertLinkMedia(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange(),t=e.range,0<t.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),t.pasteHtml(n),e.sel.collapseToEnd(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_ModifyReplacedImg(e,t,n,r){dext_src_init(t),restoreSelection(),setFocusToBody(),e=r.getAttribute("dext5customdata");if(null!=e&&void 0!=e)if(e=getDextCustomData(e),"iframe"==n.type||"iframe"==n.type2)e.type=n.type,e.type2=n.type2,e.src=n.src?n.src:"",e.id=n.id?n.id:"",e.name=n.name?n.name:"",e.title=n.title?n.title:"",e.className=n.className?n.className:"",e.width=n.width?n.width:"",e.height=n.height?n.height:"",e.align=n.align?n.align:"",e.scrolling=n.scrolling?n.scrolling:"",e.frameBorder=n.frameBorder?n.frameBorder:"",e.attributes=n.attributes?n.attributes:"",e.caption=n.caption?n.caption:"",-1<n.width.indexOf("px")||-1<n.width.indexOf("%")||-1<n.width.indexOf("pt")?r.style.width=n.width:""!=n.width&&(r.style.width=n.width+"px"),-1<n.height.indexOf("px")||-1<n.height.indexOf("%")||-1<n.height.indexOf("pt")?r.style.height=n.height:r.style.height=n.height+"px",r.align=n.align;else if("flash"==n.type||"flash"==n.type2){e.type=n.type,e.type2=n.type2,e.src=n.src,e.width=n.width,e.height=n.height,e.hspace=n.hspace,e.vspace=n.vspace,e.scale=n.scale,e.allowScriptAccess=n.allowScriptAccess,e.quality=n.quality,e.align="",e.menu=n.menu,e.play=n.play,e.loop=n.loop,e.allowFullScreen=n.allowFullScreen,e.flashvars=n.flashvars,e.caption=n.caption,-1<n.width.indexOf("px")||-1<n.width.indexOf("%")||-1<n.width.indexOf("pt")?r.style.width=n.width:r.style.width=n.width+"px",-1<n.height.indexOf("px")||-1<n.height.indexOf("%")||-1<n.height.indexOf("pt")?r.style.height=n.height:r.style.height=n.height+"px",r.align="",t="absbottom absmiddle absmiddle bottom left middle right texttop top".split(" ");for(var i=t.length,s=0;s<i;s++)if(n.align==t[s]){r.align=n.align,e.align=n.align;break}}}function command_InsertHR(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var n=getFirstRange().range;if(n){for(var r=_iframeDoc.createElement("hr"),i=!1,s=n.startContainer;s;){if("p"===s.nodeName.toLowerCase()){i=!0;break}s=s.firstChild}i&&(n.setStartBefore(s),n.collapse(!0)),n.insertNode(r),n.selectNode(r),n.collapse(!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_insertHorizontalLine(e,t,n,r,i){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),e=getFirstRange().range,t=_iframeDoc.createElement("hr");if(e){r?(t.style.cssText=r.style.cssText,100>i&&DEXTTOP.DEXT5.util.dextSetAttribute(t,"width",i,"%")):n&&(100>n.width&&DEXTTOP.DEXT5.util.dextSetAttribute(t,"width",n.width,"%"),""==n.height?t.style.height="1px":t.style.height=n.height+"px",""!=n.align&&(t.align=n.align),t.style.backgroundColor=""!=n.color?n.color:"#000000",t.style.color=n.color,t.style.border="0px"),r=!1;for(n=e.startContainer;n;){if("p"===n.nodeName.toLowerCase()){r=!0;break}n=n.parentNode}i=t.outerHTML,i+='<p id="dext_target"></p>',r&&!n.nextSibling&&(r=e.cloneRange(),r.selectNodeContents(n),r.setEnd(e.endContainer,e.endOffset),n.innerText.length==r.toString().length&&(i+="<p><br></p>"));if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,i),e=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e)}else pasteHtmlAtCaretHuge(i);if(n=_iframeDoc.getElementById("dext_target"))if(r=n.nextSibling,e.selectNode(n),e.deleteContents(),r)try{if(("P"==r.tagName||"TABLE"==r.tagName||"DIV"==r.tagName)&&r.firstChild)for(var s=r.firstChild;;){if(3==s.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+s.tagName.toLowerCase()+",")){r=s.parentNode;break}if("BR"==s.tagName){r=s.parentNode;break}if(null==s.firstChild){r=s;break}s=s.firstChild}doSetCaretPosition(r,0)}catch(o){}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertIframe(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),e=_iframeDoc.createElement("iframe"),""!=n.id&&(e.id=n.id),""!=n.name&&(e.name=n.name),""!=n.title&&(e.title=n.title),e.style.width=""!=n.width?n.width+"px":"400px",e.style.height=""!=n.height?n.height+"px":"400px",e.align=n.align,e.scrolling=n.scroll,e.frameBorder=1==n.border?1:0,e.src=n.url,n=getFirstRange().range,n.deleteContents(),n.insertNode(e),n.selectNode(n.endContainer),n.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertHyperLink(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range;if("hyperlink"==n.type||"image"==n.type)if(0==e.toString().length){""==n.text&&(n.text=n.url),t=_iframeDoc.createElement("a"),0>n.text.toLowerCase().indexOf("<img")&&(n.text=DEXTTOP.DEXT5.util.escapeHtml(n.text)),t.innerHTML=n.text,t.setAttribute("href",n.url),t.target="undefined"!=typeof n.target&&""!=n.target?n.target:"_blank"," "==n.target&&t.removeAttribute("target"),"undefined"!=typeof n.title&&""!=n.title?t.title=n.title:"0"!=DEXTTOP.G_CURREDITOR._config.accessibility&&-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("a_title")&&(t.title=n.url),"undefined"!=typeof n.id&&""!=n.id&&(t.id=n.id),"undefined"!=typeof n.className&&""!=n.className&&(t.className=n.className),"undefined"!=typeof n.type2&&"insert_file"==n.type2&&(t.setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(t,n));if("undefined"!=typeof n.attr_info_arr&&1<n.attr_info_arr.length)for(var r=n.attr_info_arr.length,i=1;i<r;i++){var s=n.attr_info_arr[i].split("^");2==s.length&&t.setAttribute(s[0],s[1])}e.deleteContents(),e.insertNode(t),e.selectNode(t),n=n.text.replace(/"/g,"'").match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")),i="",n&&0<n.length&&(i=n[0].replace("src=",""),i=i.replace(/\'/g,""),i=i.replace(/&amp;/g,"&"),t.getElementsByTagName("img")[0].src=i)}else for(_iframeDoc.execCommand("CreateLink",!1,n.url),t=getFirstRange().range,0==!!t&&(t=e),t=getNodesInRange(t),r=t.length,i=0;i<r;i++)"a"==t[i].nodeName.toLowerCase()&&(t[i].target="undefined"!=typeof n.target&&""!=n.target?n.target:"_blank","undefined"!=typeof n.title&&""!=n.title?t[i].title=n.title:"0"!=DEXTTOP.G_CURREDITOR._config.accessibility&&-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("a_title")&&(t[i].title=n.url),"undefined"!=typeof n.id&&""!=n.id&&(t[i].id=n.id),"undefined"!=typeof n.className&&""!=n.className&&(t[i].className=n.className),"undefined"!=typeof n.type2&&"insert_file"==n.type2&&(t[i].setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(t[i],n)));else"bookmark"==n.type&&(0==e.toString().length?(""==n.text&&(n.text=n.bookname),t=_iframeDoc.createElement("a"),n.text=DEXTTOP.DEXT5.util.escapeHtml(n.text),t.innerHTML=n.text,t.href=n.bookname,e.deleteContents(),e.insertNode(t),e.selectNode(t)):(_iframeDoc.execCommand("CreateLink",!1,n.bookname),getNodesInRange(e)));e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges();try{rangy.getSelection(_iframeWin).addRange(e)}catch(o){alert("DEXT5 Hyperlink error : "+o)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertBookmark(e,t,n,r){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),e=_iframeDoc.createElement("a"),""==n&&(n=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF")),e.innerHTML=n,e.setAttribute("id",r),e.setAttribute("name",r),e.className="dext5_bookmark",n=getFirstRange().range,n.deleteContents(),r=n.getDocument().createTextNode("\u00a0"),n.insertNode(r),n.insertNode(e),n.selectNode(e.nextSibling),n.collapse(!1),DEXTTOP.DEXT5.browser.ie&&r.parentNode.removeChild(r),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertSymbol(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,e.deleteContents(),0<e.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),e.pasteHtml(n+'<span id="dext_symbol">dext_symbol</span>'),n=_iframeDoc.getElementById("dext_symbol"),doSetCaretPosition(n,1),n.parentNode.removeChild(n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_TableSelect(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(e=getFirstRange().range)e=GetTDTHCell(e.startContainer),GetParentbyTagName(e,"table").setAttribute("DEXT5CellSelected","DEXT5CellSelected"),"select_cell"==n?setTableCellSelect(e):"select_row"==n?setTableRowSelect(e):"select_column"==n?setTableColumnSelect(e):"select_all"==n&&setTableAllSelect(e)}function command_TableWidthHeightRemove(e,t,n){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),"width_remove"==n?setTableWidthRemove():"height_remove"==n?setTableHeightRemove():"width_height_remove"==n&&setTableWidthHeightRemove(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_TableSameWidthheight(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),"same_width"==n?setTableWidthSame():"same_height"==n?setTableHeightSame():"same_widthheight"==n&&(setTableWidthSame(),setTableHeightSame()),e=GetTableSelectionCells(),1<e.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"):1==e.length&&DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_TableRowClone(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange().range;n&&(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),n=GetTDTHCell(n.startContainer),setTableRowClone(n),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}function command_VerticalAlignExcute(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(e=getFirstRange().range){var r=GetTDTHCell(e.startContainer);e=GetTableSelectionCells(r),t=e.length,0==t&&(e[0]=r,t=e.length);for(r=0;r<t;r++){var i=e[r];removeAttribute(i,"valign"),i.style.verticalAlign=n}e=GetTableSelectionCells(),t=e.length,0==t?DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"):1==t?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell"):1<t&&DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}function command_editorSetting(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),t=DEXTTOP.DEXT5.util.getEditorByName(e),t._setting.grid_color=n.grid_color,t._setting.grid_color_nm=n.grid_color_nm,t._setting.grid_spans=n.grid_spans,t._setting.grid_form=n.grid_form,t._setting.page_title=n.page_title,t._setting.encoding=n.encoding,t._setting.doctype=n.doctype,t._setting.xhtml=n.xhtml,t._setting.lang=n.lang,t._PageProp.encoding=n.encoding,t._PageProp.doctype=n.doctype,t._PageProp.xmlnsname=n.xhtml,t._PageProp.lang=n.lang,t._setting.auto_save=n.auto_save;var r=!1;"1"==t._config.setAutoSave.saveAndStartInterval&&n.auto_save&&0==n.auto_save.indexOf("1")&&(r=!0),setAutoSave(t,void 0,r),DEXTTOP.G_CURREDITOR.autoListUse=0<n.auto_list?1<n.auto_list?0:1:t._config.autoList.use;try{DEXTTOP.DEXTWIN.localStorage["dext_"+e+"_auto_list"]=n.auto_list}catch(i){}1==t._config.ruler.use&&(t._setting.ruler=n.ruler,"2"!=t._config.ruler.mode&&(t._setting.ruler_position=n.ruler_px),"0"==n.ruler&&(t._config.ruler.view="0",hideRuler(t),"1"==t._config.usePersonalSetting&&"1"==t._config.ruler.mode&&(_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("width"):_iframeDoc.body.style.removeAttribute("width"))),setUserSetting(t,"ruler")),r=e="","1"==t._config.useLineBreak&&(t._setting.word_break_type=n.word_break_type,t._setting.word_wrap_type=n.word_wrap_type,e=n.word_break_type,r=n.word_wrap_type);if(1==t._config.usePersonalSetting){t._setting.personal_font_family=n.personal_font_family,t._setting.personal_font_size=n.personal_font_size,t._setting.personal_line_height=n.personal_line_height,t._config.pasteToImage=n.personal_paste_to_image,t._setting.personal_paste_to_image=n.personal_paste_to_image,setUserSetting(t,"personalSetting"),t._config.pasteToImagePopupMode=n.personal_paste_to_image_popupMode,t._setting.personal_paste_to_image_popupMode=n.personal_paste_to_image_popupMode,setUserSetting(t,"personalSetting");var s=n.personal_font_family,o=n.personal_font_size,u=n.personal_line_height;""==s&&(s=t._config.defaultFontFamily),""==o&&(o=t._config.defaultFontSize),""==u&&(u=t._config.defaultLineHeight),t._setting.font_family=s,t._dextFontFamily._fontFamily[t.ID]&&(t._dextFontFamily._fontFamily[t.ID][0]=s),t._dextFontFamily._iframe_doc&&(t._dextFontFamily._iframe_doc.getElementById("ff_"+t.ID+"_0").getElementsByTagName("span")[0].style.fontFamily=s),t._setting.font_size=o,t._dextFontSize._fontSize[t.ID]&&(t._dextFontSize._fontSize[t.ID][0]=o),t._dextFontSize._iframe_doc&&(t._dextFontSize._iframe_doc.getElementById("fs_"+t.ID+"_0").style.fontSize=o),t._setting.line_height=u,t._dextLineHeight._lineHeight[t.ID]&&(t._dextLineHeight._lineHeight[t.ID][0]=u)}if(1==t._config.useLineBreak||1==t._config.usePersonalSetting)o=createEditorDefaultStyleInnerHTML(t._config,s,o,u,e,r),s=_iframeDoc.createElement("style"),s.type="text/css",s.styleSheet?(s.styleSheet.cssText=o,""==s.innerHTML&&(s.innerHTML=o)):s.appendChild(_iframeDoc.createTextNode(o)),(o=getDefaultStyleTag(_iframeDoc,t))?(o.parentNode.insertBefore(s,o),o.parentNode.removeChild(o)):(o=_iframeDoc.getElementsByTagName("head")[0])&&o.appendChild(s);if(n.word_break_for_all_table)for(""==e&&(e="normal"),s=_iframeDoc.getElementsByTagName("table"),o=s.length,u=0;u<o;u++)s[u].style.wordBreak=e;setDoctypeProperty(t._docType[n.doctype],n.encoding,n.lang,n.xhtml),"0"==n.ruler?"1"==t._config.usePersonalSetting&&"2"==t._config.ruler.mode&&setBodyFitStyle(t,!0):("1"==t._config.ruler.view?(set_ruler_point_position(t),set_ruler_pointline_position(t)):(t._config.ruler.view="1",showRuler(t)),"1"==t._config.autoBodyFit&&setBodyFitStyle(t,!0)),e=t._config.webPath.image+"grid/bggrid_"+n.grid_spans+"_"+n.grid_color_nm.replace(" ","").toLowerCase()+"_"+n.grid_form+".png",_iframeDoc.title=n.page_title,t._PageProp.bshowgrid&&1==t._PageProp.bshowgrid&&(t._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(e)+")",t._PageProp.gridattachment="scroll",t._PageProp.gridrepeat="repeat",changeBodyImageProperty(!1)),setEditorHtmlWidth(t)}function command_InsertInputText(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("input"),t.type=n.insertType,t.setAttribute("value",n.insertValue),t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,""!=n.insertAlign&&(t.style.textAlign=n.insertAlign),""!=n.insertWidth&&(t.style.width=n.insertWidth+"px"),""!=n.insertHeight&&(t.style.height=n.insertHeight+"px"),n.insertDisabled?t.disabled=!0:t.removeAttribute("disabled"),n.insertReadonly?t.readOnly=!0:t.removeAttribute("readonly"),""!=n.insertSize&&(t.size=n.insertSize),""!=n.insertMaxlength&&(t.maxLength=n.insertMaxlength);var r=n.insertEventNameArr.length;if(0<r){for(var i="",s="",o=0;o<r;o++)0!=o&&(i+="",s+=""),i+=n.insertEventNameArr[o],s+=n.insertEventFunctionArr[o];r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(t,r)}e.deleteContents(),DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(t.setAttribute("name",n.insertName),e.insertNode(t),e.selectNode(t)):(t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" />'),e.pasteHtml(t)),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertInputRadioOrCheckbox(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("input"),t.type=n.insertType,t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,""!=n.insertWidth&&(t.style.width=n.insertWidth+"px"),""!=n.insertHeight&&(t.style.height=n.insertHeight+"px"),n.insertDisabled?t.disabled=!0:t.removeAttribute("disabled"),n.insertChecked?(t.checked=!0,t.setAttribute("checked","checked")):(t.checked=!1,t.removeAttribute("chekced")),t.setAttribute("value",n.insertValue);var r=n.insertEventNameArr.length;if(0<r){for(var i="",s="",o=0;o<r;o++)0!=o&&(i+="",s+=""),i+=n.insertEventNameArr[o],s+=n.insertEventFunctionArr[o];o={type:"event"},o.eventName=i,o.eventFunction=s,setDextCustomData(t,o)}e.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie){t.setAttribute("name",n.insertName);if("radio"==n.insertType&&n.insertChecked)for(i=_iframeDoc.getElementsByName(n.insertName),s=i.length,o=0;o<s;o++)i[o].checked=!1,i[o].removeAttribute("checked");e.insertNode(t),e.selectNode(t),n.insertChecked&&(t.checked=!0,t.setAttribute("checked","checked"))}else{if("radio"==n.insertType&&n.insertChecked)for(i=_iframeDoc.getElementsByName(n.insertName),s=i.length,o=0;o<s;o++)i[o].checked=!1,i[o].removeAttribute("checked");t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" />'),e.pasteHtml(t)}e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertInputButton(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("input"),t.type=n.insertType,t.setAttribute("value",n.insertValue),t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,""!=n.insertAlign&&(t.style.textAlign=n.insertAlign),""!=n.insertWidth&&(t.style.width=n.insertWidth+"px"),""!=n.insertHeight&&(t.style.height=n.insertHeight+"px"),n.insertDisabled?t.disabled=!0:t.removeAttribute("disabled");var r=n.insertEventNameArr.length;if(0<r){for(var i="",s="",o=0;o<r;o++)0!=o&&(i+="",s+=""),i+=n.insertEventNameArr[o],s+=n.insertEventFunctionArr[o];r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(t,r)}e.deleteContents(),DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(t.setAttribute("name",n.insertName),e.insertNode(t),e.selectNode(t)):(t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" />'),e.pasteHtml(t)),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertInputSelect(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("select"),t.setAttribute("value",n.insertValue),t.multiple=n.insertMultiselect,t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,t.size=n.insertSize,""!=n.insertWidth&&(t.style.width=n.insertWidth+"px"),""!=n.insertHeight&&(t.style.height=n.insertHeight+"px"),n.insertDisabled?t.disabled=!0:t.removeAttribute("disabled");for(var r=n.insertOptionsArr.length,i=0;i<r;i++){var s=_iframeDoc.createElement("option");s.innerHTML=n.insertOptionsArr[i],s.setAttribute("value",n.insertOptionsValueArr[i]),s.selected=n.insertOptionsSelected[i],t.appendChild(s)}var o=n.insertEventNameArr.length;if(0<o){s=r="";for(i=0;i<o;i++)0!=i&&(r+="",s+=""),r+=n.insertEventNameArr[i],s+=n.insertEventFunctionArr[i];i={type:"event"},i.eventName=r,i.eventFunction=s,setDextCustomData(t,i)}e.deleteContents(),DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(t.setAttribute("name",n.insertName),e.insertNode(t),e.selectNode(t)):(t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" >'),e.pasteHtml(t)),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertInputTextarea(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("textarea"),t.value=n.insertValue,t.innerHTML=n.insertValue,t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,""!=n.insertRows&&(t.rows=n.insertRows),""!=n.insertCols&&(t.cols=n.insertCols),""!=n.insertWrap&&(t.wrap=n.insertWrap),""!=n.insertWidth&&(t.style.width=n.insertWidth+"px"),""!=n.insertHeight&&(t.style.height=n.insertHeight+"px"),""!=n.insertAlign&&(t.style.textAlign=n.insertAlign),n.insertDisabled?t.disabled=!0:t.removeAttribute("disabled"),n.insertReadonly?t.readOnly=!0:t.removeAttribute("readonly");var r=n.insertEventNameArr.length;if(0<r){for(var i="",s="",o=0;o<r;o++)0!=o&&(i+="",s+=""),i+=n.insertEventNameArr[o],s+=n.insertEventFunctionArr[o];r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(t,r)}e.deleteContents(),DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(t.setAttribute("name",n.insertName),e.insertNode(t),e.selectNode(t)):(t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" >'),e.pasteHtml(t)),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertInputHidden(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("input"),t.type="hidden",t.setAttribute("value",n.insertValue),t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,e.deleteContents(),DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(t.setAttribute("name",n.insertName),e.insertNode(t),e.selectNode(t)):(t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" />'),e.pasteHtml(t)),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,ReplaceRealObjectToImage(!1),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertInputImage(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,t=_iframeDoc.createElement("input"),t.type=n.insertType,t.setAttribute("value",n.insertValue),t.id=n.insertId,t.className=n.insertClass,t.title=n.insertTitle,t.src=n.insertSrc,n.insertAlign&&(t.align=n.insertAlign),""!=n.insertWidth&&(t.style.width=n.insertWidth+"px"),""!=n.insertHeight&&(t.style.height=n.insertHeight+"px"),n.insertDisabled?t.disabled=!0:t.removeAttribute("disabled");var r=n.insertEventNameArr.length;if(0<r){for(var i="",s="",o=0;o<r;o++)0!=o&&(i+="",s+=""),i+=n.insertEventNameArr[o],s+=n.insertEventFunctionArr[o];r={type:"event"},r.eventName=i,r.eventFunction=s,setDextCustomData(t,r)}e.deleteContents(),DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(t.setAttribute("name",n.insertName),e.insertNode(t),e.selectNode(t)):(t=t.outerHTML,t=t.replace(">",' name="'+n.insertName+'" />'),e.pasteHtml(t)),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function isDEXTContainerMode(){var e=!1;try{e=-1<DEXTTOP.DEXTWIN.location.href.indexOf("editor_container.html")}catch(t){}return e}function command_fullScreen(e,t){if(1==isDEXTContainerMode())return!1;var n=document.getElementById("ue_editor_holder_"+e);if(""==DEXTTOP.G_CURREDITOR.FrameStatus){for(var r=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID);r.parentNode&&"body"!=r.parentNode.tagName.toLowerCase()&&"html"!=r.parentNode.tagName.toLowerCase();)r=r.parentNode,"relative"==r.style.position&&"auto"==r.style.overflow?(r.style.overflow="",G_FullScreenCheckObject.push({flag:"1",object:r})):(r.style.overflow="visible",G_FullScreenCheckObject.push({flag:"2",object:r}));if(r=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+DEXTTOP.G_CURREDITOR.ID))r.style.display="none";originScrollSize=getWindowScrollPos(DEXTTOP.DEXTWIN),orginEditorSize=getClientSize(n);var r=document.getElementById("dext_topstatusbar_"+e),i=document.getElementById("dext_menu_"+e),s=document.getElementById("dext_toolbar_"+e),o=document.getElementById("dext_statusbar_"+e),u,a,f,l;r&&(u=getClientRect(r)),i&&(a=getClientRect(i)),s&&(f=getClientRect(s)),o&&(l=getClientRect(o)),r=0,a&&(r+=a.bottom-a.top),f&&(r+=f.bottom-f.top),r=u?r+(u.bottom-u.top):r+1,r=l?r+(l.bottom-l.top):r+1,t.baseMenuToolbarHeight=r,u=window.frameElement,originfull.margin1=DEXTTOP.DEXTDOC.documentElement.style.margin,originfull.padding1=DEXTTOP.DEXTDOC.documentElement.style.padding,originfull.border1=DEXTTOP.DEXTDOC.documentElement.style.border,originfull.height1=DEXTTOP.DEXTDOC.documentElement.style.height,originfull.overflow1=DEXTTOP.DEXTDOC.documentElement.style.overflow,originfull.margin2=DEXTTOP.DEXTDOC.body.style.margin,originfull.padding2=DEXTTOP.DEXTDOC.body.style.padding,originfull.border2=DEXTTOP.DEXTDOC.body.style.border,originfull.height2=DEXTTOP.DEXTDOC.body.style.height,originfull.overflow2=DEXTTOP.DEXTDOC.body.style.overflow,DEXTTOP.DEXTDOC.documentElement.style.overflow="hidden",DEXTTOP.DEXTDOC.documentElement.style.padding="0",DEXTTOP.DEXTDOC.documentElement.style.margin="0",DEXTTOP.DEXTDOC.documentElement.style.border="0",DEXTTOP.DEXTDOC.documentElement.style.height="100%",DEXTTOP.DEXTDOC.body.style.overflow="hidden",DEXTTOP.DEXTDOC.body.style.padding="0",DEXTTOP.DEXTDOC.body.style.margin="0",DEXTTOP.DEXTDOC.body.style.border="0",DEXTTOP.DEXTDOC.body.style.height="100%",originfull.overflow3=u.style.overflow,originfull.position3=u.style.position,originfull.zIndex=u.style.zIndex,getClientRect(u),u.style.overflow="hidden",u.style.position="absolute",u.style.width="100%",u.style.height="100%",u.style.zIndex=t._config.zIndex,a=getWindowClientSize(DEXTTOP.DEXTWIN),u.style.width=a[0]+"px",u.style.height=a[1]+"px",n.style.height=a[1]-t.baseMenuToolbarHeight+"px",u.style.left="0px",u.style.top="0px",n=getClientRect(u),relativePos=isRelativePosition(u),0<n.left||0<n.top?relativePos=!0:(u.style.left="0px",u.style.top="0px"),setBackupHiddenStyle(u,DEXTTOP.DEXTWIN),DEXTTOP.G_CURREDITOR.FrameStatus="full_size",setEditorHeight(t,!1),resizeDextWin(),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin)}else{if(G_FullScreenCheckObject&&0<G_FullScreenCheckObject.length){u=G_FullScreenCheckObject.length;for(a=0;a<u;a++)"1"==G_FullScreenCheckObject[a].flag?G_FullScreenCheckObject[a].object.style.overflow="auto":"2"==G_FullScreenCheckObject[a].flag&&(G_FullScreenCheckObject[a].object.style.overflow="");G_FullScreenCheckObject=[]}if(r=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+DEXTTOP.G_CURREDITOR.ID))r.style.display="";DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin),u=window.frameElement,DEXTTOP.DEXTDOC.documentElement.style.margin=originfull.margin1,DEXTTOP.DEXTDOC.documentElement.style.padding=originfull.padding1,DEXTTOP.DEXTDOC.documentElement.style.border=originfull.border1,DEXTTOP.DEXTDOC.documentElement.style.height=originfull.height1,DEXTTOP.DEXTDOC.documentElement.style.overflow=originfull.overflow1,DEXTTOP.DEXTDOC.body.style.margin=originfull.margin2,DEXTTOP.DEXTDOC.body.style.padding=originfull.padding2,DEXTTOP.DEXTDOC.body.style.border=originfull.border2,DEXTTOP.DEXTDOC.body.style.height=originfull.height2,DEXTTOP.DEXTDOC.body.style.overflow=originfull.overflow2,u.style.overflow=originfull.overflow3,u.style.position=originfull.position3,u.style.left="0px",u.style.top="0px",u.style.width="100%",u.style.height="100%",u.width="100%",u.height="100%",u.style.zIndex=originfull.zIndex,setRestorreHiddenStyle(),setEditorHeight(t,!0),n.style.height=t._defaultHeight+"px",DEXTTOP.DEXTWIN.scroll(originScrollSize[0],originScrollSize[1]),DEXTTOP.G_CURREDITOR.FrameStatus=""}n=[],"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?n.push("full_screen"):removeArrayItemByValue(n,"full_screen"),DEXTTOP.G_CURREDITOR._iconSelected(n),setRulerPositionForNode(DEXTTOP.G_CURREDITOR),setTimeout(function(){try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.fullScreen?DEXTTOP.G_CURREDITOR._config.event.fullScreen(e,DEXTTOP.G_CURREDITOR.FrameStatus):DEXTTOP.DEXTWIN.dext_full_screen_event(e,DEXTTOP.G_CURREDITOR.FrameStatus)}catch(t){}},100)}function command_grid(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(t._PageProp.bshowgrid&&1==t._PageProp.bshowgrid)changeBodyImageProperty(!0),t._PageProp.bshowgrid=!1;else{var n=t._config.webPath.image+"grid/bggrid_"+t._setting.grid_spans+"_"+t._setting.grid_color_nm.replace(" ","").toLowerCase()+"_"+t._setting.grid_form+".png";t._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(n)+")",t._PageProp.gridattachment="scroll",t._PageProp.gridrepeat="repeat",t._PageProp.bshowgrid=!0,changeBodyImageProperty(!1)}}function command_InsertPasteDialogHtml(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),e=DEXTTOP.DEXT5.util.officeClean(n,!1),e=DEXTTOP.DEXT5.util.htmlRevision(e),e=xssReplaceScript(null,e),"1"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjustInPaste&&/<table/i.test(e)&&(e=command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"paste",htmlData:e})),e=removeEditorAttribute(e);try{if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){t=e;try{t="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste(e):DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(e)}catch(r){t=e}if(t)e=t;else if(0==t||""==t)return}}catch(i){}pasteWordCount(e)&&(-1<e.indexOf("dext5customdata")&&(e=checkExistCustomData(e)),e=externalPageBreakDataRaplaceInEditor(e),_iframeDoc.execCommand("inserthtml",!1,e),0>e.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),xssReplaceScript(_iframeDoc)))}function command_tableIndentOutdent(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=GetParentbyTagName(parent.G_SELECTED_ELEMENT,"table",!0);try{if(null==e&&0<GetTableSelectionCells().length){var r=GetTableSelectionCells();e=GetParentbyTagName(r[0],"table",!0)}}catch(i){}var r=parseIntOr0(t._config.tableDefaultInoutdent),s=parseIntOr0(e.style.marginLeft,10);if("indent"==n)if("1"==t._config.limitTableInoutdent){t=0,n=getClientRect(e).right;if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))t=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width),n-=10;else{t=_iframeDoc.documentElement.clientWidth;if(0==t||null==t||void 0==t)t=_iframeDoc.body.clientWidth;t=Math.floor(t),t-=10}var o=n+r;0<t&&(o>=t&&n<t?s+=t-n:o<t&&(s+=r),0>s&&(s=0))}else s=989>=s?s+r:999;else"outdent"==n&&(s=s>=r?s-r:0);e.style.marginLeft=s+"px",doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}function command_loadAutoSave(e,t,n){t=function(){n&&""!=n&&DEXTTOP.DEXT5.setHtmlValueExWithDocType(n,e)},0==DEXTTOP.DEXT5.isEmpty(e)?1==confirm(dext5_lang.loadAutoSave.loadMsg)&&t():t()}function command_useRuler(e){e=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+e),getIframeDocument(e),"1"==DEXTTOP.G_CURREDITOR._config.ruler.view?(DEXTTOP.G_CURREDITOR._config.ruler.view="0",hideRuler(DEXTTOP.G_CURREDITOR)):(DEXTTOP.G_CURREDITOR._config.ruler.view="1",showRuler(DEXTTOP.G_CURREDITOR),moveRulerPosition(null))}function command_Direction(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=getFirstRange().range;var r=getFirstRange().sel,i=elems=null,s=[];if(e&&e.startContainer){if(1==e.startContainer.nodeType){var i=getMyElementNode(e.startContainer),o=rangy.dom.getBody(_iframeDoc).childNodes,u=o.length;for(t=0;t<u;t++)s.push(o[t])}else i=getMyElementNode(e.startContainer),s=getNodesInRange(e);elems=getDirectionNode(e,r,i,s),r=elems.length;for(t=0;t<r;t++)elems[t].dir=n.toLowerCase();setMenuIconRealable(getMyElementNode(e.startContainer))}}function command_tableCopy(e,t,n){if(1==n||1==getCopyCellData())if(dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion){if(n=DEXTTOP.DEXTDOC.getElementById("dext5_paste_temp_frame")){var r=getFirstRange().range;e=n.contentWindow,null==e.document.body&&(e.document.open("text/html","replace"),isCustomDomain(document)&&(e.document.domain=document.domain),e.document.write("<html><head></head><body></body></html>"),e.document.close()),e.document.body.innerHTML=DEXTTOP.G_COPIEDTABLE.outerHTML,n.style.display="",n=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;var i=e.document.createRange();i.selectNode(e.document.body.firstChild),n.removeAllRanges(),n.addRange(i);var s=function(e){e.preventDefault&&e.preventDefault(),e&&e.clipboardData&&e.clipboardData.setData&&e.clipboardData.setData("text/html",DEXTTOP.G_COPIEDTABLE.outerHTML),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"copy",s),_iframeWin.focus(),e=getFirstRange(),e.sel.removeAllRanges(),e.sel.addRange(r)};DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",s),e.document.execCommand("copy",!1,null)}}else{_iframeDoc.getElementById("dext_temp_copy_div")&&_iframeDoc.getElementById("dext_temp_copy_div").parentNode.removeChild(_iframeDoc.getElementById("dext_temp_copy_div"));var o=0,u=0;if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)try{o=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft),u=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop)}catch(a){}var f=_iframeDoc.createElement("div");f.style.position="absolute",f.style.left="-5000px",f.style.top=u+"px",f.id="dext_temp_copy_div",f.style.width="1px",f.style.height="1px",f.innerHTML=DEXTTOP.G_COPIEDTABLE.outerHTML,e=f.getElementsByTagName("table")[0],ClearDraggingTable(e),_iframeDoc.body.appendChild(f),setTimeout(function(){try{var e=saveSelection(t.ID,!0),n=getFirstRange(),r=n.range,i=n.sel;r.setStartBefore(f.firstChild),r.setEndAfter(f.firstChild),i.removeAllRanges(),i.addRange(r);if(DEXTTOP.DEXT5.browser.gecko){var s=function(e){e.preventDefault&&e.preventDefault(),e&&e.clipboardData&&e.clipboardData.setData&&e.clipboardData.setData("text/html",f.firstChild.outerHTML),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"copy",s)};DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",s)}_iframeDoc.execCommand("copy");if(e){restoreSelection(e,!0);try{DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&_iframeWin.scroll(o,u)}catch(a){}}f.parentNode.removeChild(f)}catch(l){_iframeDoc.getElementById("dext_temp_copy_div")&&_iframeDoc.getElementById("dext_temp_copy_div").parentNode.removeChild(_iframeDoc.getElementById("dext_temp_copy_div"))}},0)}}function command_tablePaste(e,t,n){try{dext_src_init(t._EDITOR.design);if(n){DEXTTOP.G_COPIEDTABLE=n,DEXTTOP.G_COPIEDCELLDATA=[];var r=n.rows.length;for(e=0;e<r;e++){var i=n.rows[e],s=i.cells.length;for(t=0;t<s;t++){var o=i.cells[t];void 0==DEXTTOP.G_COPIEDCELLDATA[e]&&(DEXTTOP.G_COPIEDCELLDATA[e]=[]);var u="",u=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==o.innerHTML?"&nbsp;":o.innerHTML;DEXTTOP.G_COPIEDCELLDATA[e].push(u)}}}var a,f=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?a=_iframeDoc.body.lastChild:f&&f.startContainer&&(a=getMyElementNode(f.startContainer)):f&&f.startContainer&&(a=getMyElementNode(f.startContainer)),null!=a&&doSetCaretPosition(a,0),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),1==setPasteCellData()&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(l){}}function command_intablePaste(e,t){try{dext_src_init(t._EDITOR.design);var n,r=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?n=_iframeDoc.body.lastChild:r&&r.startContainer&&(n=getMyElementNode(r.startContainer)):r&&r.startContainer&&(n=getMyElementNode(r.startContainer)),null!=n&&doSetCaretPosition(n,0),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DrageStartCell=null,1==setPasteCellData()&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(i){}}function command_listNumberBullets(e,t,n,r){restoreSelection(),setFocusToBody();if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)try{DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(i){}var s=function(e){e.style.listStyleType=r,"N"==n&&""!=t._config.orderListDefaultClass?e.setAttribute("class",t._config.orderListDefaultClass):"B"==n&&""!=t._config.unOrderListDefaultClass&&e.setAttribute("class",t._config.unOrderListDefaultClass)},o=function(e){for(var t=e.length,n=0;n<t;n++){var r=e[n].nodeName.toLowerCase();if("ol"==r||"ul"==r)r=e[n].parentNode,"p"==r.nodeName.toLowerCase()&&(r.parentNode.replaceChild(e[n],r),r=getFirstRange(),r.sel.removeAllRanges(),r.range.selectNodeContents(e[n]),r.sel.addRange(r.range))}};e=function(e){var t=getFirstRange().range,r=null;t&&t.startContainer&&(r=e?1!=t.startContainer.nodeType||"TD"!=t.startContainer.tagName&&"TH"!=t.startContainer.tagName?getMyElementNode(t.startContainer):t.startContainer.childNodes[t.startOffset]:"BODY"==t.startContainer.tagName?t.startContainer.childNodes[t.startOffset]:getMyElementNode(t.startContainer));var t=GetParentbyTagName(r,"ol",!0),i=GetParentbyTagName(r,"ul",!0);"N"==n&&i||"N"==n&&!t&&!i?_iframeDoc.execCommand("insertOrderedList",!1,null):("B"==n&&t||"B"==n&&!t&&!i)&&_iframeDoc.execCommand("insertUnOrderedList",!1,null);var u=getFirstRange().range,r=null;setMenuIconRealable(getMyElementNode(u.startContainer)),u&&u.startContainer&&(r="BODY"==u.startContainer.tagName?u.startContainer.childNodes[u.startOffset]:getMyElementNode(u.startContainer));if(e)for(var r=e.getElementsByTagName("N"==n?"ol":"ul"),u=r.length,a=0;a<u;a++)s(r[a]),o([r[a]]);else r&&(a=null,"N"==n?a=GetParentbyTagName(r,"ol"):"B"==n&&(a=GetParentbyTagName(r,"ul")),a&&s(a)),r=getFirstRange().range,0==!!r&&(r=u),r=getNodesInRange(r),o(r);null==t&&null==i&&setLiStyle(),removeDivInLiTag(e)};var u=GetTableSelectionCells(),a=u.length;if(0<a)for(var f=getFirstRange(),l=f.range,c=l.cloneRange(),h=0;h<a;h++){f.sel.removeAllRanges();var p=getMyFirstOrLastChildElementNode(u[h],!1),d=getMyFirstOrLastChildElementNode(u[h],!0);if(null==p&&null==d){var v=_iframeDoc.createElement("p");v.innerHTML="<br>",d=p=v,u[h].appendChild(v)}p&&d&&(l.setStartBefore(p),l.setEndAfter(d),f.sel.addRange(l),e(u[h]),f.sel.removeAllRanges(),f.sel.addRange(c))}else e();if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)try{DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(m){}setRulerPositionForNode(t),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}function command_setClassStyle(e,t){dext_src_init(e._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange(),r=n.range;0<e.UndoManager.charCount&&e.UndoManager.putUndo();try{if(0==r.toString().length){var i=GetTableSelectionCells();if(0!=i.length){var s=i.length,o="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,u=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==o||1==u))for(var a=0;a<s;a++){var f=i[a];"<p></p>"==f.innerHTML.toLowerCase()?f.innerHTML="<p>&nbsp;</p>":"<span></span>"==f.innerHTML.toLowerCase()?f.innerHTML="<span>&nbsp;</span>":""==f.innerHTML.toLowerCase()&&(f.innerHTML="&nbsp;")}for(a=0;a<s;a++){n.sel.removeAllRanges(),r.selectNode(i[a]),n.sel.addRange(r);var l=rangy.createCssClassApplier(t);l.applyToSelection(_iframeWin),rangy.getSelection(_iframeWin).removeAllRanges()}n.sel.removeAllRanges(),doSetCaretPosition(DrageEndCell.childNodes[0],1),!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=o&&1!=u||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else l=rangy.createCssClassApplier(t),l.applyToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(c){}}function command_removeClassStyle(e,t){dext_src_init(e._EDITOR.design),restoreSelection(),setFocusToBody();var n=getFirstRange(),r=n.range;0<e.UndoManager.charCount&&e.UndoManager.putUndo();try{if(0==r.toString().length){var i=GetTableSelectionCells();if(0!=i.length){for(var s=i.length,o=0;o<s;o++){n.sel.removeAllRanges(),r.selectNode(i[o]),n.sel.addRange(r);var u=rangy.createCssClassApplier(t);u.undoToSelection(_iframeWin),rangy.getSelection(_iframeWin).removeAllRanges()}n.sel.removeAllRanges(),doSetCaretPosition(DrageEndCell.childNodes[0],1),!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=iframeQuirks&&1!=browserQuirks||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else u=rangy.createCssClassApplier(t),u.undoToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(a){}}function command_custom(e,t,n,r){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.customAction?DEXTTOP.G_CURREDITOR._config.event.customAction(n,e,r):DEXTTOP.DEXTWIN.dext_editor_custom_action(n,e,r)}catch(i){}}function command_formatPainter(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();try{var n=getFirstRange().range;if(0==n.toString().length)if(0<GetTableSelectionCells().length)null!=t._formatPainterList&&(t._formatPainterList=null,t._iconEnable(""));else{t._formatPainterList=[];var r=t._config.applyFormatExceptStyle,i=n.endContainer,n=i;3==i.nodeType&&(n=i.parentNode);if(1==n.nodeType&&"BODY"!=n.tagName){var s=DEXTTOP.DEXT5.util.getStyle(n,"all"),o=getElementInParentStyleProperty(n,"lineHeight");""!=o&&0<r.length&&-1<r.indexOf("lineHeight")&&(o=""),t._formatPainterList.lineHeight=o;var u=getElementInParentStyleProperty(n,"fontFamily");""==u&&(u=s.fontFamily),t._formatPainterList.fontFamily=u;var a=getElementInParentStyleProperty(n,"fontSize");""==a&&(a=s.fontSize),t._formatPainterList.fontSize=a;var f=getElementInParentStyleProperty(n,"color");""==f&&(f=s.color),t._formatPainterList.color=f;var l=getElementInParentStyleProperty(n,"backgroundColor");t._formatPainterList.backgroundColor=l,t._formatPainterList.textAlign=s.textAlign;var c=getElementInParentStyleProperty(n,"paddingLeft");t._formatPainterList.paddingLeft=c;var h=s.fontWeight;""!=h&&("700"<=h||"bold"==h)&&(t._formatPainterList.b=!0),t._formatPainterList.i=""!=getElementInParentTag(n,["em","i"])?!0:!1;var p=GetParentbyTagName(n,"u");if(p){t._formatPainterList.u=!0;var d=getElementInParentStyleProperty(p,"color");""!=d&&(t._formatPainterList.u_has_color=!0)}else _iframeDoc.queryCommandState("underline")&&(t._formatPainterList.u=!0);(p=GetParentbyTagName(n,"s")||GetParentbyTagName(n,"strike"))?(t._formatPainterList.s=!0,d=getElementInParentStyleProperty(p,"color"),""!=d&&(t._formatPainterList.s_has_color=!0)):_iframeDoc.queryCommandState("strikeThrough")&&(t._formatPainterList.s=!0),t._formatPainterList.sup=""!=getElementInParentTag(n,["sup"])?!0:!1,t._formatPainterList.sub=""!=getElementInParentTag(n,["sub"])?!0:!1;if(""!=getElementInParentTag(n,["ol"])){var p=GetParentbyTagName(n,"ol"),v=p.style.listStyleType;t._formatPainterList.ol=v}""!=getElementInParentTag(n,["ul"])&&(p=GetParentbyTagName(n,"ul"),v=p.style.listStyleType,t._formatPainterList.ul=v)}else t._formatPainterList=null}}catch(m){t._formatPainterList=null}}function command_applyFormat(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(null!=t._formatPainterList)try{var n,r;DEXTTOP.DEXT5.browser.ie&&(n=0<_iframeDoc.body.scrollLeft?_iframeDoc.body.scrollLeft:_iframeDoc.documentElement.scrollLeft,r=0<_iframeDoc.body.scrollTop?_iframeDoc.body.scrollTop:_iframeDoc.documentElement.scrollTop);var i="";if("undefined"!=typeof _iframeWin.getSelection){var s=_iframeWin.getSelection();if(s.rangeCount){for(var o=_iframeDoc.createElement("div"),u=0,a=s.rangeCount;u<a;++u)o.appendChild(s.getRangeAt(u).cloneContents());i=o.innerHTML}}else"undefined"!=typeof _iframeDoc.selection&&"Control"!=_iframeDoc.selection.type&&(i=_iframeDoc.selection.createRange().htmlText);if(/<table|<td|<tr|<th/i.test(i))alert(dext5_lang.msg.apply_format_alert1);else{var f=t._formatPainterList;f.nowApplying="1";var l=getFirstRange(),c=l.range;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),command_removeCss2(e,t,i);try{setSelectionWithDextmark();var l=getFirstRange(),c=l.range,h=c.startContainer;3==h.nodeType&&(h=h.parentNode);var p=GetTDTHCell(h);if(h)if(p){if("700"<=p.style.fontWeight||"bold"<=p.style.fontWeight)setSelectionWithDextmark(),command_bold(e,t),setSelectionWithDextmark(),command_bold(e,t);"italic"==p.style.fontStyle&&(setSelectionWithDextmark(),command_italic(e,t),setSelectionWithDextmark(),command_italic(e,t))}else{var d=DEXTTOP.DEXT5.util.getStyle(h,"all");if(""==getElementInParentTag(h,["b","strong"])){var v=d.fontWeight;""!=v&&("700"<=v||"bold"==v)&&(setSelectionWithDextmark(),command_bold(e,t),setSelectionWithDextmark(),command_bold(e,t))}if(""==getElementInParentTag(h,["em","i"])){var m=d.fontStyle;""!=m&&"italic"==m&&(setSelectionWithDextmark(),command_italic(e,t),setSelectionWithDextmark(),command_italic(e,t))}}}catch(g){}setSelectionWithDextmark(),command_removeFormat(e,t);if(void 0!=f.ol)switch(setSelectionWithDextmark(),f.ol.toLowerCase()){case"decimal-leading-zero":command_listDecimalLeadingZero(e,t);break;case"lower-alpha":command_listLowerAlpha(e,t);break;case"lower-greek":command_listLowerGreek(e,t);break;case"lower-roman":command_listLowerRoman(e,t);break;case"upper-alpha":command_listUpperAlpha(e,t);break;case"upper-roman":command_listUpperRoman(e,t);break;default:command_listDecimal(e,t)}if(void 0!=f.ul)switch(setSelectionWithDextmark(),f.ul.toLowerCase()){case"circle":command_listCircle(e,t);break;case"square":command_listSquare(e,t);break;default:command_listDisc(e,t)}1==f.b&&(setSelectionWithDextmark(),command_bold(e,t)),1==f.i&&(setSelectionWithDextmark(),command_italic(e,t)),1==f.u&&1!=f.u_has_color&&(setSelectionWithDextmark(),command_underline(e,t)),1==f.s&&1!=f.s_has_color&&(setSelectionWithDextmark(),command_strikeThrough(e,t)),""!=f.color&&(setSelectionWithDextmark(),command_fontColor(e,t._EDITOR.design,f.color)),1==f.u&&1==f.u_has_color&&(setSelectionWithDextmark(),command_underline(e,t)),1==f.s&&1==f.s_has_color&&(setSelectionWithDextmark(),command_strikeThrough(e,t)),""!=f.fontFamily&&(setSelectionWithDextmark(),command_fontfamily(e,t._EDITOR.design,f.fontFamily)),""!=f.fontSize&&0>f.fontSize.indexOf("em")&&(setSelectionWithDextmark(),command_fontsize(e,t._EDITOR.design,f.fontSize)),""!=f.lineHeight&&(setSelectionWithDextmark(),command_lineHeight(e,t._EDITOR.design,f.lineHeight));var y=f.textAlign;""!=y&&-1<y.toLowerCase().indexOf("right")?(setSelectionWithDextmark(null,!0),command_align(e,t,"right")):-1<y.toLowerCase().indexOf("left")?(setSelectionWithDextmark(null,!0),command_align(e,t,"left")):-1<y.toLowerCase().indexOf("center")?(setSelectionWithDextmark(null,!0),command_align(e,t,"center")):-1<y.toLowerCase().indexOf("full")&&(setSelectionWithDextmark(null,!0),command_align(e,t,"justify")),""!=f.paddingLeft&&(setSelectionWithDextmark(),command_setIndentOutdent(e,t,f.paddingLeft)),""!=f.backgroundColor&&(setSelectionWithDextmark(),command_fontBgColor(e,t._EDITOR.design,f.backgroundColor)),1==f.sup&&(setSelectionWithDextmark(),command_superscript(e,t)),1==f.sub&&(setSelectionWithDextmark(),command_subscript(e,t)),f.nowApplying="0",void 0==n&&void 0==r||_iframeWin.scroll(n,r),removeDextmark(!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}catch(b){f.nowApplying="0",removeDextmark()}}function command_setIndentOutdent(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),t=getFirstRange().range;if(!(t&&GetTDTHCell(t.startContainer)&&0<t.toString().length)){e=getNodesInRange(t),null!=t.startContainer.previousSibling&&"HEAD"==t.startContainer.previousSibling.tagName&&null==t.endContainer.nextSibling&&(e=_iframeDoc.body.childNodes),t=e.length;for(var r=0;r<t;r++)null!=e[r].parentNode&&"body"==e[r].parentNode.nodeName.toLowerCase()&&"table"!=e[r].tagName.toLowerCase()&&(0<parseIntOr0(e[r].style.paddingLeft)&&(e[r].style.paddingLeft=""),e[r].style.marginLeft=n)}}function command_margin(e,t,n,r){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var i=getFirstRange().range;e=GetTableSelectionCells(),t=e.length;if(0==t)for(e=getNodesInRange(i),null!=i.startContainer.previousSibling&&"HEAD"==i.startContainer.previousSibling.tagName&&null==i.endContainer.nextSibling&&(e=_iframeDoc.body.childNodes),t=e.length,i=0;i<t;i++)null==e[i].parentNode||"body"!=e[i].parentNode.nodeName.toLowerCase()&&"td"!=e[i].parentNode.nodeName.toLowerCase()&&"td"!=e[i].parentNode.nodeName.toLowerCase()||!e[i].tagName||"table"==e[i].tagName.toLowerCase()||("margin"==n?e[i].style.margin=r:("marginTop"==n&&(e[i].style.marginTop=r),"marginBottom"==n&&(e[i].style.marginBottom=r),"marginLeft"==n&&(e[i].style.marginLeft=r),"marginRight"==n&&(e[i].style.marginRight=r)));else for(i=0;i<t;i++)for(var s=e[i].childNodes,o=s.length,u=0;u<o;u++)1!=s[u].nodeType||"P"!=s[u].tagName&&"SPAN"!=s[u].tagName||("margin"==n?s[u].style.margin=r:("marginTop"==n&&(s[u].style.marginTop=r),"marginBottom"==n&&(s[u].style.marginBottom=r),"marginLeft"==n&&(s[u].style.marginLeft=r),"marginRight"==n&&(s[u].style.marginRight=r)))}function command_textIndent(e,t,n,r){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var i=getFirstRange().range;e=GetTableSelectionCells(),t=e.length;if(0==t)for(e=getNodesInRange(i),null!=i.startContainer.previousSibling&&"HEAD"==i.startContainer.previousSibling.tagName&&null==i.endContainer.nextSibling&&(e=_iframeDoc.body.childNodes),t=e.length,i=0;i<t;i++)null==e[i].parentNode||"body"!=e[i].parentNode.nodeName.toLowerCase()&&"td"!=e[i].parentNode.nodeName.toLowerCase()&&"td"!=e[i].parentNode.nodeName.toLowerCase()||"table"==e[i].tagName.toLowerCase()||"textIndent"!=n||(e[i].style.textIndent=r);else for(i=0;i<t;i++)for(var s=e[i].childNodes,o=s.length,u=0;u<o;u++)1!=s[u].nodeType||"P"!=s[u].tagName&&"SPAN"!=s[u].tagName||"textIndent"!=n||(s[u].style.textIndent=r)}function command_imageAlign(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),getFirstRange(),e=DEXTTOP.G_SELECTED_IMAGE_ELEMENT,""==n?e.removeAttribute("align"):e.setAttribute("align",n)}function command_letterSpacing(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var r=getFirstRange().range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endOffset),3==r.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startContainer),3==r.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endContainer.parentNode):(DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endContainer),1==r.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(r.endContainer.innerText||r.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(r.toString().length)}catch(i){DEXTTOP.G_CURREDITOR.beforeOffset=null}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var s=e.length,o,u,a=GetTableSelectionCells();if(0==a.length){if(null!=r.startContainer.previousSibling&&"HEAD"==r.startContainer.previousSibling.tagName&&null==r.endContainer.nextSibling){for(t=0;t<s;t++){o=_iframeDoc.body.getElementsByTagName(e[t]),u=o.length;for(var f=0;f<u;f++)"span"==o[f].tagName.toLowerCase()?""!=o[f].style.letterSpacing&&(o[f].style.letterSpacing=n):o[f].style.letterSpacing=n}s=_iframeDoc.body.getElementsByTagName("table"),o=s.length;for(t=0;t<o;t++){u=s[t].rows;for(var l=u.length,f=0;f<l;f++)for(var a=u[f].cells,r=a.length,c=0;c<r;c++)setBlockTag(a[c].childNodes,e,"letterSpacing",n)}setBlockTag(_iframeDoc.body.childNodes,e,"letterSpacing",n),o=_iframeDoc.body.getElementsByTagName("div"),u=o.length;for(f=0;f<u;f++)setBlockTag(o[f].childNodes,e,"letterSpacing",n)}else{o=getNodesInRange(r),u=o.length,0==r.toString().length&&0==r.getNodes().length&&r.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(a=0;a<u;a++)if(1==o[a].nodeType&&(c=o[a].tagName.toLowerCase(),-1<e.indexOf(c))){if("div"!=c)for(t=0;t<s;t++)for(var l=o[a].getElementsByTagName(e[t]),h=l.length,f=0;f<h;f++)"span"==l[f].tagName.toLowerCase()?""!=l[f].style.letterSpacing&&(l[f].style.letterSpacing=n):l[f].style.letterSpacing=n;"span"==c?""!=o[a].style.letterSpacing&&(o[a].style.letterSpacing=n):o[a].style.letterSpacing=n}var p;0==r.toString().length&&1==r.getNodes().length&&(p=r.getNodes()[0],o.push(r.getNodes()[0])),setBlockTag(o,e,"letterSpacing",n)}(n=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(n,1),n.parentNode.removeChild(n)):p&&(n=getFirstRange().range,getFirstRange().sel.removeAllRanges(),n.selectNode(p),getFirstRange().sel.addRange(n))}else for(r=a.length,t=0;t<r;t++){for(f=0;f<s;f++)for(o=a[t].getElementsByTagName(e[f]),u=o.length,c=0;c<u;c++)"span"==o[c].tagName.toLowerCase()?""!=o[c].style.letterSpacing&&(o[c].style.letterSpacing=n):o[c].style.letterSpacing=n;setBlockTag(a[t].childNodes,e,"letterSpacing",n),o=a[t].getElementsByTagName("div"),u=o.length;for(f=0;f<u;f++)setBlockTag(o[f].childNodes,e,"letterSpacing",n)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR.beforeOffset=null}function command_InsertOpenFile(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),t=n.data,"html"!=n.fileExt&&"htm"!=n.fileExt&&"txt"==n.fileExt&&(t=htmlSpecialChars(n.data),t=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,t)),DEXTTOP.DEXT5.setHtmlContents(t,e)}function command_InsertBlockquote(e,t,n){var r="";switch(n.tagvalue){case"1":r="margin:0 0 30px 20px;padding:0 8px;border-left:2px solid #999999";break;case"2":r="margin:0 0 30px 13px;padding:0 8px 0 16px;background:url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/img_blockquote02.gif)  0 3px no-repeat;";break;case"3":r="BORDER-TOP: #7a7d83 1px dashed; BORDER-RIGHT: #7a7d83 1px dashed; BORDER-BOTTOM: #7a7d83 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px dashed; PADDING-RIGHT: 10px;";break;case"4":r="BORDER-TOP: #007ace 1px dashed; BORDER-RIGHT: #007ace 1px dashed; BORDER-BOTTOM: #007ace 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 1px dashed; PADDING-RIGHT: 10px;";break;case"5":r="BORDER-TOP: #7a7d83 1px dashed; BORDER-RIGHT: #7a7d83 1px dashed; background:#ebebeb; BORDER-BOTTOM: #7a7d83 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px dashed; PADDING-RIGHT: 10px";break;case"6":r="BORDER-TOP: #7a7d83 1px solid; BORDER-RIGHT: #7a7d83 1px solid; BORDER-BOTTOM: #7a7d83 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px solid; PADDING-RIGHT: 10px;";break;case"7":r="BORDER-TOP: #007ace 1px solid; BORDER-RIGHT: #007ace 1px solid; BORDER-BOTTOM: #007ace 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 1px solid; PADDING-RIGHT: 10px;";break;case"8":r="BORDER-TOP: #7a7d83 1px solid; BORDER-RIGHT: #7a7d83 1px solid; background:#ebebeb; BORDER-BOTTOM: #7a7d83 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px solid; PADDING-RIGHT: 10px";break;case"9":r="BORDER-TOP: #999 2px solid; BORDER-RIGHT: #999 2px solid; BORDER-BOTTOM: #999 2px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #999 2px solid; PADDING-RIGHT: 10px";break;case"10":r="BORDER-TOP: #007ace 2px solid; BORDER-RIGHT: #007ace 2px solid; background:#ebebeb; BORDER-BOTTOM: #007ace 2px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 2px solid; PADDING-RIGHT: 10px"}dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,e=function(e){try{var t=getFirstRange(),n=t.range,s=n.startContainer,u=n.endContainer;e&&(1!=s.nodeType||"TD"!=s.tagName&&"TH"!=s.tagName||(s=s.childNodes[n.startOffset]),1!=u.nodeType||"TD"!=u.tagName&&"TH"!=u.tagName||(u=u.childNodes[n.endOffset-1]));var a=GetParentbyTagName(s,"blockquote",!0),f=GetParentbyTagName(u,"blockquote",!0),l=a,c=!1;if(null!=a||null!=f)if(a==f)c=!0;else if(a!=f){var h=n.commonAncestorContainer;if(h&&h.tagName&&"blockquote"==h.tagName.toLowerCase())l=h;else{if(a)n.setStartBefore(a.firstChild);else{for(a=n.startContainer;!a.tagName;)a=a.parentNode;n.setStartBefore(a)}f||(f=n.endContainer);for(;f.parentNode!=h;)f=f.parentNode;for(;a.parentNode!=h;)a=a.parentNode;l=_iframeDoc.createElement("blockquote"),h.insertBefore(l,a),n.setStartAfter(l),n.setEndAfter(f),n.surroundContents(l),n.setStartBefore(l.firstChild),n.setEndAfter(l.lastChild),t.sel.removeAllRanges(),t.sel.addRange(n)}c=!0}if(c)l.style.cssText=r;else{f=!1,n&&0==n.toString().length&&s==u&&s.tagName&&"p"==s.tagName.toLowerCase()&&"<br>"==s.innerHTML&&(s.innerHTML=unescape("%u200B"),f=!0);var p=getParentbyTagNameEx(s,"ol,ul"),v=getParentbyTagNameEx(u,"ol,ul");if(p||v){p&&(p=i(p,"ol,ul"),n.setStartBefore(p)),v&&(v=i(v,"ol,ul"),n.setEndAfter(v));for(var m=_iframeDoc.createElement("blockquote"),y=n.extractContents();y.firstChild;)m.appendChild(y.firstChild);n.insertNode(m),n.setStartBefore(m.firstChild),n.setEndAfter(m.lastChild),t.sel.removeAllRanges(),t.sel.addRange(n)}else _iframeDoc.execCommand("indent",!1,null);if(f){var b=getFirstRange().range,w=b.startContainer;if(3==w.nodeType)w=w.parentNode;else if("TD"==w.tagName||"TH"==w.tagName)w=w.getElementsByTagName("p")[0];w&&"P"==w.tagName&&w.innerHTML==unescape("%u200B")&&(w.innerHTML="<br>")}if(e)for(var E=e.getElementsByTagName("blockquote"),S=E.length,x=0;x<S;x++)E[x].style.cssText=r;else{b=getFirstRange().range,0==!!b&&(b=o);for(var x=getNodesInRange(b),T=x.length,E=0;E<T;E++)if("blockquote"==x[E].nodeName.toLowerCase()){x[E].style.cssText=r;break}}}}catch(N){}};var i=function(e,t){for(var n=e;;){var r=getParentbyTagNameEx(n.parentNode,t);if(!r)break;n=r}return n};t=GetTableSelectionCells(),n=t.length;if(0<n)for(var s=getFirstRange(),o=s.range,u=o.cloneRange(),a=0;a<n;a++){s.sel.removeAllRanges();var f=getMyFirstOrLastChildElementNode(t[a],!1),l=getMyFirstOrLastChildElementNode(t[a],!0);if(null==f&&null==l){var c=_iframeDoc.createElement("p");c.innerHTML="<br>",l=f=c,t[a].appendChild(c)}f&&l&&(o.setStartBefore(f),o.setEndAfter(l),s.sel.addRange(o),e(t[a]),s.sel.removeAllRanges(),s.sel.addRange(u))}else e();DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_CancelBlockquote(e,t){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;var n=getFirstRange(),r=n.range,i=function(e){for(;0<e.childNodes.length;)e.parentNode.insertBefore(e.childNodes[0],e);null!=e.previousSibling&&doSetCaretPosition(e.previousSibling,1),e.parentNode.removeChild(e)},s=function(e){if(e){e=e.getElementsByTagName("blockquote");for(var t=e.length-1;0<=t;t--)i(e[t])}else(e=GetParentbyTagName(r.startContainer,"blockquote",!0))&&i(e)},o=GetTableSelectionCells(),u=o.length;if(0<u)for(n=getFirstRange(),n=0;n<u;n++)s(o[n]);else s();DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_inputSameWidthHeight(e,t,n){"1"==t._config.formMode&&(dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),"width"==n?d5ApplySameWidth():"height"==n?d5ApplySameHeight():"widthheight"==n&&d5ApplySameWidthHeight(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}function command_setAccessibility(e,t,n,r,i){dext_src_init(t),e=!1;if(n.idSamMode)n.id!=n.sameOrgId&&(r.setAttribute("id",n.id),e=!0);else if(t=null,e=r.getAttribute("dext5customdata"),null!=e&&void 0!=e&&(t=getDextCustomData(e)),n.skip)r.setAttribute("dext5webaccskip","dext5webaccskip"),e=!0;else{r.removeAttribute("dext5webaccskip"),e=!1;var s=r.tagName.toLowerCase();if(-1<"frame,framset,a".indexOf(s)||t&&("iframe"==t.type||"iframe"==t.type2))t?t.title=n.title:r.title=n.title,""!=n.title&&(e=!0);else if("table"==s){if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_caption")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)if(r.caption)if(""==n.title){t=0;for(var s=r.childNodes.length,o=0;o<s;o++)if(r.childNodes[o].nodeName.match(/caption/i)){t=o;break}r.removeChild(r.childNodes[t])}else r.caption.innerHTML=n.title,e=!0;else""!=n.title&&(e=_iframeDoc.createElement("caption"),e.innerHTML=n.title,r.insertBefore(e,r.firstChild),e=!0);else e=!0;e=e&&""!=n.alt?!0:!1;if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_summary")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)r.summary=n.alt}else""!=n.alt&&(e=!0),r.alt=n.alt}n=_iframeDoc.createElement("img"),n.alt="web_accessibility_ok",n.src="../images/editor/dialog/check01.png",n.name="chkImg",r=i.getElementsByTagName("img"),t=i.getElementsByTagName("div"),e?0<t.length&&("chkImg"!=r[0].name&&i.insertBefore(n,t[0]),t[0].style.display="none"):("chkImg"==r[0].name&&i.removeChild(r[0]),0<t.length&&(t[0].style.display="")),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"accessibility_validation"})}function command_calculationFormula(e,t,n){t=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);if(null!=t){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r;switch(n){case"horizontal_sum":case"horizontal_avg":r=getLeftHorizontalCells(t);break;case"vertical_sum":case"vertical_avg":r=getTopVerticalCells(t)}for(var i=r.length,s=e=0,o=!1,u=0;u<i;u++){var a=r[u].innerHTML,a=a.replace(/\r/g,""),a=a.replace(/[\n|\t]/g,""),a=a.replace(/[\v|\f]/g,""),a=a.replace(/<p><br><\/p>/gi,"\n"),a=a.replace(/<P>&nbsp;<\/P>/gi,"\n"),a=a.replace(/<br(\s)*\/?>/gi,"\n"),a=a.replace(/<br(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");nIdx=a.lastIndexOf("\n"),-1<nIdx&&"\n"==a.substring(nIdx)&&(a=a.substring(0,nIdx)),a=removeStripTags(a,null),a=unhtmlSpecialChars(a),-1<a.indexOf(",")&&(o||(o=!0),a=a.replace(/,/gi,"")),isNaN(Number(a))||""==a||(e=command_NumCal(e,a,"+"),s++)}if("horizontal_avg"==n||"vertical_avg"==n)e=command_NumCal(e,s,"/");e||(e=0),e=e.toString(),o&&(e=-1<e.indexOf(".")?fnCommaExec(e.substring(0,e.indexOf(".")))+e.substring(e.indexOf("."),e.length):fnCommaExec(e));var f=null;if(null==t.firstChild)f=_iframeDoc.createElement("p"),f.innerHTML=e,t.innerHTML="",t.appendChild(f);else{for(f=t.firstChild;null!=f&&void 0!=f;)if(3==f.nodeType){if(n=f.nodeValue,n=n.replace(/\r\n/g,""),n=n.replace(/\n/g,""),n=n.replace(/\r/g,""),n=n.replace(/\t/g,""),n=n.replace(/ /g,""),n=n.replace(/\s/g,""),n=n.replace(/&nbsp;/g,""),""!=n||null==f.nextSibling){f=f.parentNode;break}f=f.nextSibling}else{if(1!=f.nodeType)break;if("IMG"==f.tagName||"BR"==f.tagName||"TABLE"==f.tagName||"HR"==f.tagName||"A"==f.tagName){f=f.parentNode;break}if(n=f.innerHTML,n=n.replace(/&nbsp;/g," "),f.innerHTML=n,!f.firstChild)break;if(f&&"TD"!=f.tagName&&"TH"!=f.tagName)for(;f.nextSibling;)f.parentNode.removeChild(f.nextSibling);f=f.firstChild}f.innerHTML=e}setTimeout(function(){doSetCaretPosition(f,1)},10),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}function command_NumCal(e,t,n){if(isNaN(Number(e))||isNaN(Number(t)))return!1;var r,i,s;i=/\./,i.test(e)?(e=e.toString(),r=e.split("."),r=r[1].length):r=0,i.test(t)?(t=t.toString(),i=t.split("."),i=i[1].length):i=0,r=r>i?r:i,i="1";for(var o=1;o<=r;o++)i+="0";switch(n){case"+":s=Math.round(Number(e)*i+Number(t)*i)/i;break;case"/":s=Number(e)/Number(t)}return s}function command_tableSelection(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(e=getFirstRange().range){if(!n){n=GetTDTHCell(e.startContainer);if(null==n||void 0==n)return;n=GetParentbyTagName(n,"table");if(null==n)return}if(getApplyDragResize(t))DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=n,clearInterval(DEXTTOP.G_CURREDITOR.dext_dragresize.dextResizeIconInterval),DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null);else{t=_iframeDoc.body.createControlRange();try{ClearDraggingTableCellSelected(),t.add(n),t.select(),DEXTTOP.G_SELECTED_ELEMENT=n,setMenuIconRealable(n),_iframeDoc_MouseUpMenu(null,n)}catch(r){}}}}function command_showBlocks(e,t){document.getElementById("ue_editor_holder_"+e);if(""==DEXTTOP.G_CURREDITOR.ShowBlocks){var n=DEXTTOP.G_CURREDITOR._config.webPath.css;DEXTTOP.DEXT5.isRelease||(n=DEXTTOP.G_CURREDITOR._config.webPath.css_dev),DEXTTOP.DEXT5.addUserCssUrl(n+"editor_showblocks.css?ver="+DEXTTOP.DEXT5.ReleaseVer),DEXTTOP.G_CURREDITOR.ShowBlocks="show_blocks"}else{for(var n=t._DOC.getElementsByTagName("link"),r=null,i=n.length-1;0<=i;i--)-1<n[i].href.indexOf("editor_showblocks.css")&&(r=n[i],r.parentNode.removeChild(r));DEXTTOP.G_CURREDITOR.ShowBlocks=""}n=[],"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?n.push("show_blocks"):removeArrayItemByValue(n,"show_blocks"),DEXTTOP.G_CURREDITOR._iconSelected(n)}function command_tableLock(e,t){var n=getFirstRange().range.startContainer;3==n.nodeType&&(n=n.parentNode);var r=getSelectionTable(t);if(r)if(checkLockAttr(r,!0))removeLockAttr(r),removeClassName(r,"DEXT_five_table_lock");else{var i=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,s=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,o=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode;setClassName(r,"DEXT_five_table_lock"),r.setAttribute(i,""),r.setAttribute("lock_mode",s),r.setAttribute("show_icon",o)}else{i=GetTableSelectionCells(),s=i.length,o=GetTDTHCell(n);if(0<s)r=GetParentbyTagName(i[0],"table");else{if(null==o||"TD"!=o.tagName&&"TH"!=o.tagName)return;r=GetParentbyTagName(o,"table")}r&&(checkLockAttr(r,!0)?(removeLockAttr(r),removeClassName(r,"DEXT_five_table_lock")):(i=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,s=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,o=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode,setClassName(r,"DEXT_five_table_lock"),r.setAttribute(i,""),r.setAttribute("lock_mode",s),r.setAttribute("show_icon",o)))}n&&1==n.nodeType&&setMenuIconRealable(n)}function command_cellLock(e,t){var n=GetTableSelectionCells(),r=n.length,i=getFirstRange().range.startContainer;3==i.nodeType&&(i=i.parentNode),currElem=GetTDTHCell(i);if(0<r){var s=!1;checkLockAttr(n[0],!0)&&(s=!0);for(var o=0;o<r;o++)s?(removeLockAttr(n[o]),removeClassName(n[o],"DEXT_five_cell_lock")):(n[o].setAttribute("dext_lock",""),setClassName(n[o],"DEXT_five_cell_lock"))}else{if(null==currElem||"TD"!=currElem.tagName&&"TH"!=currElem.tagName)return;checkLockAttr(currElem,!0)?(removeLockAttr(currElem),removeClassName(currElem,"DEXT_five_cell_lock")):(currElem.setAttribute("dext_lock",""),setClassName(currElem,"DEXT_five_cell_lock"))}i&&1==i.nodeType&&setMenuIconRealable(i)}function command_help(){var e="ko";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(e="en");var e=DEXTTOP.G_CURREDITOR._config.webPath.help+"index_"+e+".html",t=1200,n=screen.availHeight,r=40;DEXTTOP.DEXT5.browser.ie?r=40:DEXTTOP.DEXT5.browser.chrome?r=70:DEXTTOP.DEXT5.browser.gecko?r=40:DEXTTOP.DEXT5.browser.opera?r=80:DEXTTOP.DEXT5.browser.safari&&(r=100);var i=screen.availHeight;i<=n&&(n=i-r);try{t>parseInt(screen.width,10)&&(t=parseInt(screen.width,10)-50)}catch(s){}r=0;try{r=screen.width/2-t/2}catch(o){}var u=DEXTTOP.DEXTWIN.open(e,"DEXT5Help","width="+t+","+("height="+n)+","+("left="+r+"px")+",top=0px,resizable=yes");setTimeout(function(){u.focus()},100)}function command_wordTransform(e,t){if(G_dext5plugIn){setImageSizeForProperty();var n=_iframeDoc.getElementsByTagName("head")[0].getElementsByTagName("style")[0],r="";if(n){var r=n.innerHTML,i=r.replace("margin:0px 10px 10px 10px;","").replace("MARGIN: 0px 10px 10px","").replace("margin:10px;","").replace("MARGIN: 10px","");if(n.styleSheet){n.styleSheet.cssText=i;try{n.innerHTML=i}catch(s){}}else n.innerHTML=i}i=DEXTTOP.DEXT5.getHtmlValueEx(e);if("/"==DEXTTOP.G_CURREDITOR._config.serverDomain&&(i.match(RegExp("<body[^>]*>([\\w|\\W]*)<\\/body>","gi")),""!=RegExp.$1)){var o=_iframeDoc.createElement("div");o.innerHTML=RegExp.$1;for(var u=o.getElementsByTagName("img"),a=0;a<u.length;a++){var f=u[a];f.src=f.src}i=i.replace(RegExp.$1,o.innerHTML)}if(n)if(n.styleSheet){n.styleSheet.cssText=r;try{n.innerHTML=r}catch(l){}}else n.innerHTML=r;/<div.*class=.*DEXT_fiVe_Page_Break.*/gi.test(i)&&(n=null,n=RegExp("<div .*class=DEXT_fiVe_Page","gi").test(i)?RegExp("<div[^>]*class=DEXT_fiVe_Page*.+?<\\/div>","gi"):RegExp("<div[^>]*class=[\"']DEXT_fiVe_Page*.+?<\\/div>","gi"),i=i.replace(n,'<p><br clear="all" style="page-break-before: always;"></p>')),n=G_dext5plugIn.getHTMLValueFromApplication(i,0),""!=n&&(n=externalPageBreakDataRaplaceInEditor(n),DEXTTOP.DEXT5.setBodyValue(n,e))}}function command_InsertMiniPhotoEditor(e,t,n){if("1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var r=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(r=DEXTTOP.G_CURREDITOR.dialogWindow),r.KMINIPHOTO&&1==r.KMINIPHOTO.miniPhotoCreation?show_MiniPhotoEditor(e,t,n):create_MiniPhotoEditor(e,t,n)}}function create_MiniPhotoEditor(e,t,n){try{if("1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor){var r=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(r=DEXTTOP.G_CURREDITOR.dialogWindow);if(null==r.document.getElementById("k_mini_photo")){miniPhotoCallback=function(){r.KMINIPHOTO.isRelease=DEXTTOP.DEXT5.isRelease,new r.KMINIPhoto({Id:"kminiphoto",Lang:DEXTTOP.G_CURREDITOR._config.lang,PhotoHolder:"k_mini_photo",ZIndex:DEXTTOP.G_CURREDITOR._config.zIndex+5e3,AutoDestroy:DEXTTOP.G_CURREDITOR._config.autoDestroy.use,Width:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.width,Height:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.height,BackgroundColor:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.backgroundColor,BackgroundOpacity:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.backgroundOpacity,CreationCompleteEvent:function(){r.KMINIPHOTO.miniPhotoCreation=!0}})};var i=r.document.createElement("div");i.id="k_mini_photo",i.style.display="none",r.document.body.appendChild(i);var s=r.document.getElementsByTagName("head")[0],o=r.document.createElement("script");o.type="text/javascript";var u=!1;o.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||u||(u=!0,miniPhotoCallback())},o.onload=function(){u||(u=!0,miniPhotoCallback())},o.src=DEXTTOP.DEXT5.isRelease?DEXTTOP.DEXT5.rootPath+"imageEdit/js/kminiphoto.js":DEXTTOP.DEXT5.rootPath+"imageEdit/js_dev/kminiphoto.js",s.appendChild(o)}}}catch(a){}r=DEXTTOP.DEXTWIN,null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(r=DEXTTOP.G_CURREDITOR.dialogWindow);if(r.KMINIPHOTO&&1==r.KMINIPHOTO.miniPhotoCreation)show_MiniPhotoEditor(e,t,n);else var f=setInterval(function(){r.KMINIPHOTO&&r.KMINIPHOTO.miniPhotoCreation&&(clearInterval(f),show_MiniPhotoEditor(e,t,n))},1e3)}function show_MiniPhotoEditor(e,t,n){e=function(e){var n;e?(0==e.toLowerCase().indexOf("file://")&&G_dext5plugIn&&(e=G_dext5plugIn.getBase64ImageFromLocalImage(e)),t.miniPhotoLastMode="modify",n={url:e,width:DEXTTOP.G_SELECTED_IMAGE_ELEMENT.clientWidth,height:DEXTTOP.G_SELECTED_IMAGE_ELEMENT.clientHeight,dialogWindow:t.dialogWindow?t.dialogWindow:null,completeEvent:kMiniPhotoComplete}):(t.miniPhotoLastMode="new",n={url:null,width:"",height:"",dialogWindow:t.dialogWindow?t.dialogWindow:null,completeEvent:kMiniPhotoComplete});var r=getDialogWindow();setTimeout(function(){DEXTTOP.DEXT5.isClickedMiniPhoto=!1,r.KMINIPHOTO.ShowPhotoPopup(n)},20)},n?DEXTTOP.G_SELECTED_IMAGE_ELEMENT&&"IMG"==DEXTTOP.G_SELECTED_IMAGE_ELEMENT.tagName&&(n=DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src,e(n)):(n=getFirstRange().range,n.startOffset==n.endOffset&&0==n.toString().length?e(null):DEXTTOP.G_SELECTED_IMAGE_ELEMENT&&"IMG"==DEXTTOP.G_SELECTED_IMAGE_ELEMENT.tagName&&(n=DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src,e(n)))}function command_InsertImagePhotoEdit(e,t){var n=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.DEXT5.config.DialogWindow?""!=n?DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(n):DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup():""!=n?(DEXTTOP.DEXT5PHOTO.ShowPopup(n),DEXTTOP.DEXT5PHOTO.Reset(n),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0,n)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.Reset(),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0))}function kMiniPhotoComplete(e,t){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design),restoreSelection(),setFocusToBody();var n=t.src;if(G_dext5plugIn){if("base64"!=DEXTTOP.G_CURREDITOR._config.uploadMethod){var r="jpg";try{if("data:"==n.substring(0,5)){var i=n.split(",");2==i.length&&(r=getExtFromImageDataSrc(i[0]))}}catch(s){}n=G_dext5plugIn.getLocalImageFromBase64Image(n,r)}"new"==DEXTTOP.G_CURREDITOR.miniPhotoLastMode?(r=_iframeDoc.createElement("img"),r.src=n,r.alt="",n=getFirstRange().range,n.deleteContents(),n.collapse(!0),n.pasteHtml(r.outerHTML),n.collapse(!1)):(DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src=n,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.width=t.width,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.height=t.height)}else i=n.split(","),2==i.length&&(r=getExtFromImageDataSrc(i[0])),"new"==DEXTTOP.G_CURREDITOR.miniPhotoLastMode?postBase64ImageToServer(i[1],r,null,!0):(postBase64ImageToServer(i[1],r,DEXTTOP.G_SELECTED_IMAGE_ELEMENT,!0),DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.width=t.width,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.height=t.height);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;if(0<DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.imgTagRemoveAttribute.length&&null!=DEXTTOP.G_SELECTED_IMAGE_ELEMENT)for(n=DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.imgTagRemoveAttribute.length,r=0;r<n;r++)DEXTTOP.G_SELECTED_IMAGE_ELEMENT.removeAttribute(DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.imgTagRemoveAttribute[r]);try{contentChangeEventWrapper()}catch(o){}onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}function command_photoEditProperty(e,t){if(null!=DEXTTOP.G_SELECTED_ELEMENT){var n=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.DEXT5.config.DialogWindow?""!=n?(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(n),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,n),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,n)):(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1)):""!=n?(DEXTTOP.DEXT5PHOTO.ShowPopup(n),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,n),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,n)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1))}}function command_showTableBorder(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=_iframeDoc.body.getElementsByTagName("table"),r=n.length,i=[];if(1==DEXTTOP.G_CURREDITOR.ShowTableBorder){for(var s=0;s<r;s++)removeClassName(n[s],"DEXT_tableborder");removeArrayItemByValue(i,"table_border"),DEXTTOP.G_CURREDITOR.ShowTableBorder=!1}else{for(s=0;s<r;s++)checkExistClassName(n[s].className,"DEXT_tableborder")||setClassName(n[s],"DEXT_tableborder");i.push("table_border"),DEXTTOP.G_CURREDITOR.ShowTableBorder=!0}DEXTTOP.G_CURREDITOR._iconSelected(i)}function command_pasteToImage(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),t.bTextorHtmlData="image"==n.type?!1:!0,command_pasteHtml5(t,n)}function command_pasteHtml5(e,t){var n=e.clipData,r=e.pasteEvt;if(DEXTTOP.G_CURREDITOR.setTextPaste)for(var i="span font strong i em u strike s sub sup".split(" "),s=i.length,n=n.replace(/<b>/gi,""),n=n.replace(/<b ([^>?+])*>/gi,""),n=n.replace(/<\/b>/gi,""),o=0;o<s;o++)var u=new RegExp("</"+i[o]+">","gi"),n=n.replace(new RegExp("<"+i[o]+" *([^>?+])*>","gi"),""),n=n.replace(u,"");n=dummyTagClassClear(n);if(e.bTextorHtmlData)0<n.length&&("1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:e._config,callFn:"SetCorrectOfficeHtml",callFnParam:[n],callBackFn:command_pasteHtml5_After}),DEXTTOP.DEXT5.util.cancelEvent(r)):(n=SetCorrectOfficeHtml(n),command_pasteHtml5_After(n,e)));else{if("0"==e._config.paste_image_base64_remove&&setPasteImageFromClipboard(r,t),0!=DEXTTOP.DEXT5.browser.gecko&&!e.AccessClipboardForIEGecko)return!0;e.UndoManager.putUndo(),e.UndoManager.charCount=0,DEXTTOP.DEXT5.util.cancelEvent(r),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500)}}function command_pasteHtml5_After(e,t,n){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar(),"undefined"==typeof t&&(t=DEXTTOP.G_CURREDITOR),"undefined"!=typeof n&&""!=n&&(G_wordProcessorType=n);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||t.AccessClipboardForIEGecko)try{if(RegExp("<img[^>]+data:[^>]+>","gi").test(e)){var r=document.createElement("div");r.innerHTML=e;var i=r.getElementsByTagName("img"),s=i.length;for(n=0;n<s;n++){var o=i[n],u=o.src;if("data:"==u.substring(0,5))if(""==o.style.width&&o.width&&""!=o.width&&(o.style.width=DEXTTOP.DEXT5.util.parseIntOr0(o.width)+"px"),""==o.style.height&&o.height&&""!=o.height&&(o.style.height=DEXTTOP.DEXT5.util.parseIntOr0(o.height)+"px"),"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove)o.parentNode.removeChild(o);else{var a=u.split(",");if(2==a.length){var f=getExtFromImageDataSrc(a[0]);postBase64ImageToServer(a[1],f,o,!1,null,null,!0)}}}e=r.innerHTML}}catch(l){}e=SetCorrectOfficeHtmlForDOM(e),e=execReplaceMsoStyle(e)
,"1"==t._config.useHtmlCorrection&&(e=htmlTagRevision(e,!0)),e=removeTagStyle(e),e=repairPasteTextInCell(e),0<t.UndoManager.charCount&&(t.UndoManager.putUndo(),t._iconEnable("")),e=DEXTTOP.DEXT5.util.officeClean(e,!1),"1"==t._config.tableAutoAdjustInPaste&&(r=/<table/i,r.test(e)&&(e=command_AdjustTableAndCellWidth(t.ID,t,{type:"paste",htmlData:e}))),e=OfficePasteClean(e),"PPT"!=G_wordProcessorType&&(e=DEXTTOP.DEXT5.util.emptyTagRemove(e)),e=DEXTTOP.DEXT5.util.htmlRevision(e),e=xssReplaceScript(null,e),e=t._FRAMEWIN.DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(e),"1"==t._config.ie_BugFixed_Hyfont&&(e=DEXTTOP.DEXT5.util.replaceHyFont(e,t)),e=adjustSizeInContainer({strHtml:e}),n=!1,"base64"==t._config.uploadMethod&&e&&""!=e&&"-1"!=t._config.maxImageBase64fileCount&&(r=getBase64ImageCountEx(e),0<r&&getBase64ImageCount()+r>parseInt(t._config.maxImageBase64fileCount,10)&&(n=dext5_lang.msg.max_base64file_count,n=n.replace("{0}",t._config.maxImageBase64fileCount),alert(n),n=!0)),e=removeEditorAttribute(e);if(!n){try{if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){n=e;try{n="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?DEXTTOP.G_CURREDITOR._config.event.beforePaste(e):DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(e)}catch(c){n=e}if(n)e=n;else if(0==n||""==n){DEXTTOP.DEXT5.util.cancelEvent(t.pasteEvt),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(h){}if(!pasteWordCount(e)){DEXTTOP.DEXT5.util.cancelEvent(t.pasteEvt),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}-1<e.indexOf("dext5customdata")&&(e=checkExistCustomData(e)),e=externalPageBreakDataRaplaceInEditor(e),i=GetTableSelectionCells(),n=document.createElement("div"),n.innerHTML=e,r=n.childNodes;if(1==r.length&&r[0].tagName&&"table"==r[0].tagName.toLowerCase()&&0<i.length)command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,r[0]);else{i=!1;if("1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog){var s=getFirstRange().range,p=null;s.startContainer==s.endContainer&&(p=s.startContainer,3==p.nodeType&&(p=p.parentNode),p=GetTDTHCell(p)),p&&1==r.length&&r[0].tagName&&"table"==r[0].tagName.toLowerCase()&&(i=!0)}i?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=r[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=e,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=p,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(p,"table"),null!=dragPopup&&0!=(dragPopup&&"none"!=dragPopup.style.display)||DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):(r=/<h[0-9]/i,r.test(e)||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion||"TEXT"==G_wordProcessorType?pasteHtmlAtCaretHuge(e,!1,!1,!0):("1"==DEXTTOP.G_CURREDITOR._config.pasteWhenTableIsLast&&n.lastChild&&1==n.lastChild.nodeType&&"TABLE"==n.lastChild.tagName&&(e+="<p><br></p>"),_iframeDoc.execCommand("inserthtml",!1,e)))}if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)for(p=getElementsByClass("raon_placeholder",_iframeDoc.body,"span"),r=p.length,n=0;n<r;n++)p[n].getAttribute("contentEditable")||p[n].setAttribute("contentEditable","true");checkPasteImage(e);if(p=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(p);0>e.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),t._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable())}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground(),G_wordProcessorType="";if(t.AccessClipboardForIEGecko){t.UndoManager.putUndo(),t.UndoManager.charCount=0,DEXTTOP.DEXT5.util.cancelEvent(t.pasteEvt);try{contentChangeEventWrapper()}catch(d){}}else{if(0!=DEXTTOP.DEXT5.browser.gecko)return!0;t.UndoManager.putUndo(),t.UndoManager.charCount=0,DEXTTOP.DEXT5.util.cancelEvent(t.pasteEvt);try{contentChangeEventWrapper()}catch(v){}}}function command_insertLayer(e,t){try{dext_src_init(t._EDITOR.design),getApplyDragResize(t)&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),restoreSelection(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),getFirstRange();var n=_iframeDoc.createElement("div");n.style.display="block",n.className="DEXT_fiVe_Layer",n.style.width="150px",n.style.height="100px",n.style.border="#000000 1px solid",n.style.position="absolute";var r=getWindowScrollPos(_iframeWin);n.style.left=r[0]+30+"px",n.style.top=r[1]+30+"px",_iframeDoc.body.appendChild(n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(i){}}function command_elementZindex(e,t,n){try{if(DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem){var r=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem;r.style.position="absolute";var i=_iframeDoc.body.getElementsByTagName("*"),s=i.length;e=[];for(t=0;t<s;t++)1==i[t].nodeType&&-1<",img,iframe,table,embed,div,".indexOf(","+i[t].tagName.toLowerCase()+",")&&e.push(i[t]);var o=e.length;for(t=o-1;0<=t;t--)for(var u=1;u<=t;u++)if(e[u-1].style.zIndex>e[u].style.zIndex){var a=e[u-1];e[u-1]=e[u],e[u]=a}switch(n){case 1:r!=e[e.length-1]&&(r.style.zIndex=e[e.length-1].style.zIndex+1);break;case 2:if(r!=e[0])for(t=0;t<o;t++)r==e[t]?r.style.zIndex=0:e[t].style.zIndex+=1;break;case 3:if(r!=e[e.length-1])for(t=0;t<o;t++)if(r==e[t]){e[t]=e[t+1],e[t+1]=r;for(u=0;u<o;u++)e[u].style.zIndex=u;break}break;case 4:if(r!=e[0])for(t=0;t<o;t++)if(r==e[t]){e[t]=e[t-1],e[t-1]=r;for(u=0;u<o;u++)e[u].style.zIndex=u;break}}}}catch(f){}}function command_elementPosition(e,t){try{getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.style.position="absolute"==DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.style.position?"":"absolute",DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear())}catch(n){}}function command_insert_datetime(e,t,n){try{dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r=getFirstRange().range,i;if(n)i=n;else if("undefined"!=typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG||"undefined"!=typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG.dateTime){i=DEXTTOP.G_CURREDITOR.lastDateType;var s=DEXTTOP.G_CURREDITOR._config.lang,s=s.replace("-",""),o=new Date,u=n=t=e="",a="",f="",l="",c="",h="",p="",d="";e=o.getFullYear(),t=e.toString().substring(2,4),n=DEXTTOP.DEXT5.util.leadingZeros(o.getMonth()+1,2),u=DEXTTOP.DEXT5.util.leadingZeros(o.getDate(),2),a=o.getDay(),void 0!=DEXT_LANG_CONFIG.dateTime["date_"+s].Month[o.getMonth()]&&(f=DEXT_LANG_CONFIG.dateTime["date_"+s].Month[o.getMonth()]),void 0!=DEXT_LANG_CONFIG.dateTime["date_"+s].Day[a]&&(l=DEXT_LANG_CONFIG.dateTime["date_"+s].Day[a]),c=DEXTTOP.DEXT5.util.leadingZeros(o.getHours(),2),h=DEXTTOP.DEXT5.util.leadingZeros(o.getMinutes(),2),p=DEXTTOP.DEXT5.util.leadingZeros(o.getSeconds(),2),d=12<=o.getHours()?"PM":"AM",i=i.replace("YYYY",e),i=i.replace("YY",t),i=i.replace("MM",n),i=i.replace("DD",u),i=i.replace("Month",f),i=i.replace("Day",l),i=i.replace("hh",c),i=i.replace("mm",h),i=i.replace("ss",p),i=i.replace("AMPM",d)}else i="";r.deleteContents(),0<r.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),r.pasteHtml(i+'<span id="dext_datevalue">dext_datevalue</span>');var v=_iframeDoc.getElementById("dext_datevalue");doSetCaretPosition(v,1),v.parentNode.removeChild(v),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"insert_datetime"})}catch(m){}}function command_InsertConversion(e,t,n){try{dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r=getFirstRange().range;r.deleteContents();var i=r.getDocument().createTextNode(n.text);r.insertNode(i),r.selectNode(i),r.select();if(i.parentNode&&i.parentNode.tagName&&"BODY"==i.parentNode.tagName){var s=_iframeDoc.createElement("p");_iframeDoc.body.insertBefore(s,i),s.appendChild(i)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(o){}}function command_InsertVideo(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange(),t=e.range,0<t.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),t.pasteHtml(n),e.sel.collapseToEnd(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertCalculator(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange(),t=e.range,0<t.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1),t.pasteHtml(n),e.sel.collapseToEnd(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_zoom(e,t,n){try{var r=DEXTTOP.G_CURREDITOR.getEditorMode();t=null,"design"==r?t=_iframeDoc.body:"preview"==r&&(t=DEXTTOP.G_CURREDITOR._EDITOR.preview.contentDocument.body),r=0,"p"==n?r=10:"m"==n&&(r=-10);var i=document.getElementById("ue_"+e+"zoom_text").value,i=parseIntOr0(i)+r;0==i?(n=/\((.*)\)/i,t&&t.style.transform.match(n),i=""==RegExp.$1?100:100*parseFloat(RegExp.$1)):10>i&&(i=10),document.getElementById("ue_"+e+"zoom_text").value=i.toString()+"%",i/=100,DEXTTOP.DEXT5.browser.ie&&10>DEXTTOP.DEXT5.browser.ieVersion?t.style.zoom=100*i+"%":(t.style.transform="scale("+i+")",t.style.transformOrigin="0% 0% 0px")}catch(s){}}function command_InsertPlaceholder(e,t,n){try{dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r=getFirstRange(),i=r.range;0<i.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var s=document.createElement("span");s.className="raon_placeholder",s.setAttribute("placeholder",n.notice),s.setAttribute("contenteditable","true"),i.pasteHtml(s.outerHTML),r.sel.collapseToEnd(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(o){}}function command_removeBackgroundColor(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();var n=function(e,t){try{t||makeRangeSelectionMarkInDesign();var n=_iframeDoc.getElementsByTagName("dextmark"),r,i,s=n[0].parentNode;if(s){for(;;){if("P"==s.tagName||"DIV"==s.tagName||"BODY"==s.tagName||"TD"==s.tagName){r=s;break}s=s.parentNode}i=GetParentbyTagName(r,"table")}var o,u,a=n[1].parentNode;if(a){for(;;){if("P"==a.tagName||"DIV"==a.tagName||"BODY"==a.tagName||"TD"==a.tagName){o=a;break}a=a.parentNode}u=GetParentbyTagName(o,"table")}var f=dext5_lang.msg.error_remove_background_color,s=!1;if(i&&u)i!=u&&(s=!0);else if(i||u)s=!0;if(s)alert(f);else{u=function(e,t,n,r){t=t.childNodes;for(var i=t.length,s="",o=0;o<i;o++){var u="";1==t[o].nodeType?(u=t[o].outerHTML,u=CleanZeroChar(u)):3==t[o].nodeType&&(u=t[o].data),s+=u}n?(e.innerHTML=s,r?e.appendChild(r):e.innerHTML=s+'<dextmark class="dextmark"></dextmark>'):r?(e.innerHTML+=s,e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)):e.innerHTML+='<dextmark class="dextmark"></dextmark>'+s},f=function(e,t){return null==e.firstChild&&("xp"==DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?e.innerHTML=unescape("%uFEFF"):e.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u200B"):"<br>"),t.setStartBefore(e.firstChild),t.setEndAfter(e.lastChild),t.extractContents()},i=function(e,t,n){return n.setStartAfter(e),n.setEndBefore(t),n.extractContents()},"BODY"==r.tagName?e.setStartBefore(n[0]):e.setStartBefore(r.firstChild),e.setEndBefore(n[0]);var l=e.extractContents();e.setStartAfter(n[1]),"BODY"==o.tagName?e.setEndAfter(n[1]):e.setEndAfter(o.lastChild);var c=e.extractContents();if(r==o){removeDextMarkInFrame();var h=f(r,e);u(r,l,!0),u(o,c,!1);for(var p=removeBackgroundColorInNodes(h,"backgroundColor",",table,td,p,");p.firstChild;)n[1].parentNode.insertBefore(p.firstChild,n[1])}else{h=null,"BODY"!=r.tagName&&(_iframeDoc.body.firstChild?_iframeDoc.body.insertBefore(n[0],_iframeDoc.body.firstChild):_iframeDoc.body.appendChild(n[0]),h=f(r,e)),s=null,"BODY"!=o.tagName&&(_iframeDoc.body.appendChild(n[1]),s=f(o,e));if("BODY"!=r.tagName)for(u(r,l,!0,n[0]),p=removeBackgroundColorInNodes(h,"backgroundColor",",table,td,p,");p.firstChild;)r.appendChild(p.firstChild);if("BODY"!=o.tagName){u(o,c,!1,n[1]);for(var p=removeBackgroundColorInNodes(s,"backgroundColor",",table,td,p,"),d=o.getElementsByTagName("dextmark");p.firstChild;)d[0].parentNode.insertBefore(p.firstChild,d[0])}l=null,n=_iframeDoc.getElementsByTagName("dextmark"),"BODY"==r.tagName&&(r=n[0]),"BODY"==o.tagName&&(o=n[1]),l=i(r,o,e);for(p=removeBackgroundColorInNodes(l,"backgroundColor",",table,td,p,");p.firstChild;)o.parentNode.insertBefore(p.firstChild,o)}t||(n=_iframeDoc.getElementsByTagName("dextmark"),e.setStartAfter(n[0]),e.setEndBefore(n[1]),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e))}removeDextMarkInFrame()}catch(v){removeDextMarkInFrame()}};0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r=getFirstRange().range,i=GetTableSelectionCells(),s=i.length;if(0<s)for(var o=0;o<s;o++){var u=_iframeDoc.createElement("dextmark");i[o].insertBefore(u,i[o].firstChild),u=_iframeDoc.createElement("dextmark"),i[o].appendChild(u),r.setStartBefore(i[o].firstChild),r.setEndAfter(i[o].lastChild),n(r,!0)}else n(r);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_ParagraphAttribute(e,t,n){try{dext_src_init(t),restoreSelection(),setFocusToBody();var r=getFirstRange().range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endOffset),3==r.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(r.startContainer),3==r.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endContainer.parentNode):(DEXTTOP.G_CURREDITOR.beforeOffset.push(r.endContainer),1==r.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(r.endContainer.innerText||r.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(r.toString().length)}catch(i){DEXTTOP.G_CURREDITOR.beforeOffset=null}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var s=e.length,o,u,a=GetTableSelectionCells();if(0==a.length){if(null!=r.startContainer.previousSibling&&"HEAD"==r.startContainer.previousSibling.tagName&&null==r.endContainer.nextSibling){for(var f=0;f<s;f++){o=_iframeDoc.body.getElementsByTagName(e[f]),u=o.length;for(var l=0;l<u;l++)""!=n.marginLeft.toString()&&(o[l].style.marginLeft=n.marginLeft+"px"),""!=n.marginRight.toString()&&(o[l].style.marginRight=n.marginRight+"px"),""!=n.marginTop.toString()&&(o[l].style.marginTop=n.marginTop+"px"),""!=n.marginBottom.toString()&&(o[l].style.marginBottom=n.marginBottom+"px"),""!=n.letterSpacing.toString()&&(o[l].style.letterSpacing=n.letterSpacing+"px"),""!=n.wordSpacing.toString()&&(o[l].style.wordSpacing=n.wordSpacing+"px"),""!=n.textIndent.toString()&&(o[l].style.textIndent=n.textIndent+"px"),""!=n.fontSize.toString()&&(o[l].style.fontSize=n.fontSize+n.fontType),""!=n.fontFamily.toString()&&("default"==n.fontFamily?o[l].style.fontFamily="":o[l].style.fontFamily=n.fontFamily)}for(var c=_iframeDoc.body.getElementsByTagName("table"),h=c.length,f=0;f<h;f++)for(var p=c[f].rows,d=p.length,l=0;l<d;l++)for(var a=p[l].cells,v=a.length,m=0;m<v;m++)setBlockTag(a[m].childNodes,e,"paragraphAttribute",n);setBlockTag(_iframeDoc.body.childNodes,e,"paragraphAttribute",n);for(var g=_iframeDoc.body.getElementsByTagName("div"),y=g.length,l=0;l<y;l++)setBlockTag(g[l].childNodes,e,"paragraphAttribute",n)}else{o=getNodesInRange(r),u=o.length,0==r.toString().length&&0==r.getNodes().length&&r.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(s=0;s<u;s++)if(1==o[s].nodeType){var b=o[s].tagName.toLowerCase();-1<e.indexOf(b)&&(""!=n.marginLeft.toString()&&(o[s].style.marginLeft=n.marginLeft+"px"),""!=n.marginRight.toString()&&(o[s].style.marginRight=n.marginRight+"px"),""!=n.marginTop.toString()&&(o[s].style.marginTop=n.marginTop+"px"),""!=n.marginBottom.toString()&&(o[s].style.marginBottom=n.marginBottom+"px"),""!=n.letterSpacing.toString()&&(o[s].style.letterSpacing=n.letterSpacing+"px"),""!=n.wordSpacing.toString()&&(o[s].style.wordSpacing=n.wordSpacing+"px"),""!=n.textIndent.toString()&&(o[s].style.textIndent=n.textIndent+"px"),""!=n.fontSize.toString()&&(o[s].style.fontSize=n.fontSize+n.fontType),""!=n.fontFamily.toString()&&("default"==n.fontFamily?o[s].style.fontFamily="":o[s].style.fontFamily=n.fontFamily))}var w;0==r.toString().length&&1==r.getNodes().length&&(w=r.getNodes()[0],o.push(r.getNodes()[0])),setBlockTag(o,e,"paragraphAttribute",n)}var E=_iframeDoc.getElementById("_dextPosition");if(E)doSetCaretPosition(E,1),E.parentNode.removeChild(E);else if(w){var S=getFirstRange().range;getFirstRange().sel.removeAllRanges(),S.selectNode(w),getFirstRange().sel.addRange(S)}}else for(v=a.length,f=0;f<v;f++){for(l=0;l<s;l++)for(o=a[f].getElementsByTagName(e[l]),u=o.length,m=0;m<u;m++)""!=n.marginLeft.toString()&&(o[l].style.marginLeft=n.marginLeft+"px"),""!=n.marginRight.toString()&&(o[l].style.marginRight=n.marginRight+"px"),""!=n.marginTop.toString()&&(o[l].style.marginTop=n.marginTop+"px"),""!=n.marginBottom.toString()&&(o[l].style.marginBottom=n.marginBottom+"px"),""!=n.letterSpacing.toString()&&(o[l].style.letterSpacing=n.letterSpacing+"px"),""!=n.wordSpacing.toString()&&(o[l].style.wordSpacing=n.wordSpacing+"px"),""!=n.textIndent.toString()&&(o[l].style.textIndent=n.textIndent+"px"),""!=n.fontSize.toString()&&(o[l].style.fontSize=n.fontSize+n.fontType),""!=n.fontFamily.toString()&&("default"==n.fontFamily?o[l].style.fontFamily="":o[l].style.fontFamily=n.fontFamily);setBlockTag(a[f].childNodes,e,"paragraphAttribute",n),g=a[f].getElementsByTagName("div"),y=g.length;for(l=0;l<y;l++)setBlockTag(g[l].childNodes,e,"paragraphAttribute",n)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR.beforeOffset=null}catch(x){}}function command_BeforeSetCompleteSpellCheck(e){try{e._BODY&&"spellcheck"in e._BODY&&"1"==e._config.browserSpellCheck&&0==e._BODY.spellcheck&&e._BODY.removeAttribute("spellcheck")}catch(t){}}function command_AdjustTableAndCellWidth(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r];if("PPT"==getPasteFormatType())break;if(""!=i.style.width&&"fixed"!=i.style.tableLayout){if(1==t&&i.oWidth&&0<i.oWidth){for(var s=i.getElementsByTagName("colgroup"),o=s.length-1;0<=o;o--)s[o].parentNode.removeChild(s[o]);for(var n=i.clientWidth,r=i.rows,u=r.length,o=0;o<u;o++)for(var a=r[o],f=a.cells.length,s=0;s<f;s++){var l=a.cells[s];if(""!=l.style.width&&-1<l.style.width.indexOf("px")){var c=1*DEXTTOP.DEXT5.util.parseIntOr0(l.style.width)*n/i.oWidth;l.style.width=c+"px"}}i.oWidth="";break}o=0;if(i&&1!=i.raonAdjusted){for(var h=[],p=[],d=i.rows,v=d.length,m=0,s=l=0;s<v;s++)u=d[s].cells.length,u>l&&(l=u,m=s);for(var s=d[m].cells.length,g=0;g<s;g++){var l=d[m].cells[g],y={rect:null,width:null};h.push(y),y.rect=getClientRect(l),y.width=l.offsetWidth,o+=y.width}for(s=0;s<v;s++){a=d[s].cells,u=a.length,m=[];for(g=0;g<u;g++){for(var l=a[g],l=getClientRect(l),y=h.length,b=!1,w=!1,E=0;E<y;E++){var S=0,f=0;1>Math.abs(l.left-h[E].rect.left)&&1>Math.abs(l.right-h[E].rect.right)?(w=b=!0,S=l.right-l.left):l.left<=h[E].rect.left&&l.right>=h[E].rect.right&&(1>Math.abs(l.left-h[E].rect.left)?b=!0:1>Math.abs(l.right-h[E].rect.right)&&(w=!0),S+=l.right-l.left);if(b&&w){f=parseInt(S,10);break}}m.push(f)}p.push(m)}try{for(s=0;s<v;s++)for(a=d[s].cells,u=a.length,g=0;g<u;g++)c=p[s][g],a[g].style.width=0==c?"":c+"px"}catch(x){}1!=t&&(i.style.width=o+2+"px"),s=i.getElementsByTagName("colgroup");for(o=s.length-1;0<=o;o--)s[o].parentNode.removeChild(s[o]);i.raonAdjusted=!0}}}};var r=null;t=[];if(n){if("paste"==n.type)return t=n.htmlData,n=document.createElement("div"),n.style.width="2000px",n.style.height="2000px",n.style.position="absolute",n.style.left="-10000px",n.style.top="-10000px",document.body.appendChild(n),n.innerHTML=t,t=n.getElementsByTagName("table"),e(t),e=n.innerHTML,n.parentNode.removeChild(n),e;"setHtml"==n.type?(t=_iframeDoc.getElementsByTagName("table"),e(t)):"forceAdjust"==n.type&&(n=n.targetTable,1==n.raonAdjusted&&(n.raonAdjusted=!1),t.push(n),e(t,!0))}else r=DEXTTOP.G_SELECTED_ELEMENT,n=GetParentbyTagName(r,"table"),t.push(n),e(t),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_AdjustTableAndCellHeight(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),e=[];if(n&&"forceAdjust"==n.type){e.push(n.targetTable);try{var r=e.length;for(t=0;t<r;t++){var i=e[t];if(""!=i.style.height)for(var s=i.rows,o=s.length,u=parseInt(i.style.height,10),a=n.beforeHeight,f=0;f<o;f++)for(var l=s[f].cells,c=l.length,h=0;h<c;h++){var p=l[h],d=p.style.height;""!=d&&-1<d.indexOf("px")&&(d=parseInt(d,10),p.style.height=u*d/a+"px")}}}catch(v){}}}function command_PluginAction(e,t,n){switch(n.action){case"insert_image":plugin_insertImage(e,t,n);break;case"replace_image":plugin_replaceImage(e,t,n);break;case"insert_element":plugin_insertElement(e,t,n);break;case"replace_element":plugin_replaceElement(e,t,n)}}function plugin_insertImage(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range;try{0==selObjectText.toString().length&&setRestoreCaretPos(!1)}catch(r){}e.collapse(!0),e.insertNode(n.image),n.image.setAttribute("raon_plugin",n.pluginName),e.selectNode(n.image),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{if("function"==typeof DEXTTOP.dext_editor_contentsize_change_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange){var i=n.image.src;if("data:"==i.substring(0,5)){var s=i.split(",");if(2==s.length){var o=DEXTTOP.G_CURREDITOR._FRAMEWIN.getExtFromImageDataSrc(s[0]);DEXTTOP.G_CURREDITOR._FRAMEWIN.postBase64ImageToServer(s[1],o,n.image,!1),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500)}}}}catch(u){}}function plugin_replaceImage(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range;try{0==selObjectText.toString().length&&setRestoreCaretPos(!1)}catch(r){}e.selectNode(n.element),e.deleteContents(),e.collapse(!0),e.insertNode(n.image),n.image.setAttribute("raon_plugin",n.pluginName),e.selectNode(n.image),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{if("function"==typeof DEXTTOP.dext_editor_contentsize_change_event||"function"==typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange){var i=n.image.src;if("data:"==i.substring(0,5)){var s=i.split(",");if(2==s.length){var o=DEXTTOP.G_CURREDITOR._FRAMEWIN.getExtFromImageDataSrc(s[0]);DEXTTOP.G_CURREDITOR._FRAMEWIN.postBase64ImageToServer(s[1],o,n.image,!1),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(e){}},500)}}}}catch(u){}}function plugin_insertElement(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range;try{0==selObjectText.toString().length&&setRestoreCaretPos(!1)}catch(r){}e.collapse(!0),e.insertNode(n.newElement),n.newElement.setAttribute("raon_plugin",n.pluginName),e.selectNode(n.newElement),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function plugin_replaceElement(e,t,n){dext_src_init(t),restoreSelection(),setFocusToBody(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range;try{0==selObjectText.toString().length&&setRestoreCaretPos(!1)}catch(r){}e.selectNode(n.element),e.deleteContents(),e.collapse(!0),e.insertNode(n.newElement),n.newElement.setAttribute("raon_plugin",n.pluginName),e.selectNode(n.newElement),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertTableTopBottomParagraph(e,t,n){restoreSelection(),setFocusToBody();if(null!=n)n&&("insert_table_top_paragraph"==e?insertPtagTableNear(!0,n):insertPtagTableNear(!1,n));else{var r=getFirstRange().range;n=null,r&&r.startContainer&&(n=getMyElementNode(r.startContainer));if(n){r=GetTDTHCell(n);if(null==r&&"tr"==n.tagName.toLowerCase()){var i=n.cells.length;0<i&&(r=n.cells[i-1])}r&&(n=GetParentbyTagName(r,"table"))&&("insert_table_top_paragraph"==e?insertPtagTableNear(!0,n):insertPtagTableNear(!1,n))}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,t._iconEnable("default")}function command_fontSizeIncDec(e,t,n){var r="";"1"==n._config.useFontSizeKeyin?r=document.getElementById("txtara_"+e+"font_size").value:(r=document.getElementById("ue_"+e+"font_size").innerHTML,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(r=r.replace("<SPAN>",""),r=r.replace("</SPAN>","")):(r=r.replace("<span>",""),r=r.replace("</span>","")));if(""!=r&&r!=dext5_lang.icon.font_size){var i="",s="",s=1;""!=n._config.fontSizeIncDecGap&&(s=parseInt(n._config.fontSizeIncDecGap)),"font_size_dec"==t&&(s*=-1),n=parseInt(r);if(-1<r.indexOf("pt")||-1<r.indexOf("px")||-1<r.indexOf("em")||0<r.indexOf("%"))0<r.indexOf("pt")?i="pt":0<r.indexOf("px")?i="px":0<r.indexOf("em")?i="em":0<r.indexOf("%")&&(i="%",s*=10);r=n+s,"font_size_dec"==t&&1>r&&(r=n),s=r+i,"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+e+"font_size").value=s:document.getElementById("ue_"+e+"font_size").innerHTML="<span>"+s+"</span>",command_fontsize(e,document.getElementById("dext5_design_"+e),s)}}function command_lineHeightIncDec(e,t,n){var r="";"1"==n._config.useLineHeightKeyin?r=document.getElementById("txtara_"+e+"line_height").value:(r=document.getElementById("ue_"+e+"line_height").innerHTML,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(r=r.replace("<SPAN>",""),r=r.replace("</SPAN>","")):(r=r.replace("<span>",""),r=r.replace("</span>","")));if(""!=r&&r!=dext5_lang.icon.line_height){var i=r,s=1;""!=n._config.lineHeightIncDecGap&&(s=parseFloat(n._config.lineHeightIncDecGap)),"line_height_dec"==t&&(s*=-1),0<r.indexOf("%")?(s*=10,i=i.substring(0,i.length-1),s=parseInt(parseInt(i)+s),0<parseInt(i,10)&&0<=s&&(i=s),t="%"):(t="",0<r.indexOf("pt")||0<r.indexOf("px")||0<r.indexOf("em")?(s=parseFloat(parseFloat(i)+s).toFixed(2),0<r.indexOf("pt")?t="pt":0<r.indexOf("px")?t="px":0<r.indexOf("em")&&(t="em"),0<=s&&(i=s)):(s*=.1,s=parseFloat(parseFloat(i)+s).toFixed(2),i=0<=s?s:parseFloat(i))),i=parseFloat(i)+t,"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+e+"line_height").value=i:document.getElementById("ue_"+e+"line_height").innerHTML="<span>"+i+"</span>",command_lineHeight(e,document.getElementById("dext5_design_"+e),i)}}function command_letterSpacingIncDec(e,t,n){var r=document.getElementById("ue_"+e+"letter_spacing").innerHTML;DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(r=r.replace("<SPAN>",""),r=r.replace("</SPAN>","")):(r=r.replace("<span>",""),r=r.replace("</span>",""));if(""!=r&&r!=dext5_lang.icon.letter_spacing){var i=1;void 0!=n._config.letterSpacingIncDecGap&&""!=n._config.letterSpacingIncDecGap&&(i=parseFloat(n._config.letterSpacingIncDecGap)),"letter_spacing_dec"==t&&(i*=-1),t=r.substring(r.length,r.length-2),n=parseFloat(r);if(-1<r.indexOf("pt")||-1<r.indexOf("px")||-1<r.indexOf("em"))t="",0<r.indexOf("pt")?t="pt":0<r.indexOf("px")?t="px":0<r.indexOf("em")&&(t="em"),n=parseFloat(parseFloat(parseFloat(n)+i).toFixed(2))+t;document.getElementById("ue_"+e+"letter_spacing").innerHTML="<span>"+n+"</span>",command_letterSpacing(e,DEXTTOP.G_CURREDITOR,n)}}function command_bodyFit(e,t){if(!("2"==t._config.ruler.mode||DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks))){var n="";if(""==t._config.autoBodyFit||"0"==t._config.autoBodyFit){t._config.autoBodyFit="1",n=t._setting.word_wrap_type="break-word;";if("1"==t._config.ruler.use&&""!=t._config.ruler.rulerInitPosition&&"0"!=t._config.ruler.rulerInitPosition){var r=parseIntOr0(t._setting.ruler_position);"1"==t._config.defaultBodySpace.use&&(r-=parseIntOr0(t._config.defaultBodySpace.configValue.left)),t._BODY.style.width=r+"px"}setBodyFitStyle(t,!0)}else t._config.autoBodyFit="0",n=t._setting.word_wrap_type="normal;","1"==t._config.ruler.use&&""!=t._config.ruler.rulerInitPosition&&"0"!=t._config.ruler.rulerInitPosition&&(t._BODY.style.width=""),setBodyFitStyle(t,!1);r=createEditorDefaultStyleInnerHTML(t._config,"","","",t._setting.word_break_type,n),n=_iframeDoc.createElement("style"),n.type="text/css",n.styleSheet?(n.styleSheet.cssText=r,""==n.innerHTML&&(n.innerHTML=r)):n.appendChild(_iframeDoc.createTextNode(r)),(r=getDefaultStyleTag(_iframeDoc,t))?(r.parentNode.insertBefore(n,r),r.parentNode.removeChild(r)):(r=_iframeDoc.getElementsByTagName("head")[0])&&r.appendChild(n)}}function command_forbidden_word(e,t,n){DEXT5_EDITOR.prototype.dialog.show(t._config.webPath.page,t._config.pages.forbidden_word)}function command_saveAsImage(e,t,n){try{dext_src_init(n._EDITOR.design);var r=t.src.split(/(\\|\/)/g).pop().substring(0,t.src.split(/(\\|\/)/g).pop().lastIndexOf("."));""==r&&(r="untitled");var i="",s=!1;e=function(){var e=t.src.split("?")[0].split(".");i=e[e.length-1].toLowerCase(),"jpg"!=i&&"gif"!=i&&"png"!=i&&"tif"!=i&&"tiff"!=i&&"bmp"!=i&&"jpeg"!=i&&"jpe"!=i&&"jfif"!=i&&(r="untitled",i="png",s=!0)},n=function(e){var n=new Image;n.src=t.src,n.onload=function(){var t=document.createElement("canvas");t.style.display="none",document.body.appendChild(t);var r=t.getContext("2d");t.id="saveCanvas",t.width=n.width,t.height=n.height,r.drawImage(n,0,0,n.width,n.height),e?(dataURL="jpg"==i||"jpeg"==i?t.toDataURL("image/jpeg"):t.toDataURL(),u(dataURL)):(dataURL=t.toDataURL(),o(dataURL))}};if(G_dext5plugIn&&-1==t.src.indexOf("data:image/"))e(),e="",e=0==t.src.indexOf("/")?location.protocol+"//"+location.host+t.src:t.src,""==G_dext5plugIn.DoSaveToImage(e,r+"."+i)&&alert(dext5_lang.msg.error_save_as_image);else{var o=function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",r+"."+i),document.createEvent?(e=document.createEvent("MouseEvents"),e.initEvent("click",!0,!0),t.dispatchEvent(e)):t.click()},u=function(e){if(DEXTTOP.navigator.msSaveOrOpenBlob){e=DEXTTOP.DEXT5.util.dataURItoBlob(e);var t="."+e.type.substring(e.type.indexOf("/")+1,e.type.length);".jpeg"==t&&(t=".jpg"),DEXTTOP.navigator.msSaveOrOpenBlob(e,r+t)}else alert(dext5_lang.msg.error_browser_save_as_image)};DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.safari?alert(dext5_lang.msg.error_browser_save_as_image):-1<t.src.indexOf("data:image/")?DEXTTOP.DEXT5.browser.ie?u(t.src):(i=getExtFromImageDataSrc(t.src),o(t.src)):t.src.match(/:\/\/(.[^\/]+)/)[1]!=window.location.host?alert(dext5_lang.msg.error_cors_save_as_image):(e(),DEXTTOP.DEXT5.browser.ie?s?DEXTTOP.DEXT5.browser.canvasSupported?n(!0):alert(dext5_lang.msg.error_browser_save_as_image):n(!0):s?n(!1):o(t.src))}}catch(a){alert(dext5_lang.msg.error_save_as_image)}}function createTableResizeBar(e){e=document.getElementById("table_resizebar");if(null==e){e=document.createElement("div");try{e.innerHTML='<div id="table_resizebar" style="position:absolute; overflow:hidden; z-index: 99; "><div onmousedown="return false" style="background-color:#000000;filter:alpha(opacity=0);opacity:0.0;-moz-opacity:0.0;-khtml-opacity:0.0;cursor: col-resize; left: 0px; top: 0px; width: 100%; height: 100%;font-size:1px;z-index: 999; "></div></div>',elResizeBar=e.firstChild,elResizeBarCover=elResizeBar.firstChild}catch(t){}document.body.appendChild(elResizeBar),DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover),DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"dblclick",dbclick_ResizeBarCover),nPageLeftRightMargin=parseIntOr0(document.body.marginLeft)+parseIntOr0(document.body.marginRight),nPageTopBottomMargin=parseIntOr0(document.body.marginTop)+parseIntOr0(document.body.marginBottom)}}function dbclick_ResizeBarCover(){if(3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode){var e=getFirstRange().sel;e&&e.docSelection&&"Control"==e.docSelection.type?(e=GetParentbyTagName(ResizeInfo.currCell,"table"),DEXTTOP.G_SELECTED_ELEMENT=e,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,e)):(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount&&(e=GetParentbyTagName(ResizeInfo.currCell,"table"),DEXTTOP.G_SELECTED_ELEMENT=e,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,e)))}}function coverResizeLayer(){elResizeBarCover.style.position="absolute";var e=getClientSize();elResizeBarCover.style.width=e.width-nPageLeftRightMargin+"px",elResizeBarCover.style.height=e.height-nPageTopBottomMargin+"px",document.body.appendChild(elResizeBarCover)}function uncoverResizeLayer(){elResizeBar.appendChild(elResizeBarCover),elResizeBarCover.style.position="",elResizeBarCover.style.width="100%",elResizeBarCover.style.height="100%"}function _mousedown_ResizeBarCover(e){e=getElementPos(e),nStartHeight=e.clientY,DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover),DEXTTOP.DEXT5.util.addEvent(document,"mouseup",mouseup_ResizeBarCover),coverResizeLayer(),parseIntOr0(elResizeBar.style.width)>parseIntOr0(elResizeBar.style.height)?elResizeBar.style.height="1px":elResizeBar.style.width="1px",elResizeBar.style.border="1px dotted black",elResizeBar.style.fontSize="1pt",nStartWidth=e.clientX,nStartHeight=e.clientY,onCellResize({cmd:"start"})}function mousemove_ResizeBarCover(e){e=getElementPos(e),1==ResizeInfo.nResizeMode?elResizeBar.style.left=e.pageX-parseIntOr0(elResizeBar.style.width)/2+"px":elResizeBar.style.top=e.pageY-parseIntOr0(elResizeBar.style.height)/2+"px"}function mouseup_ResizeBarCover(e){hideResizeBar(),uncoverResizeLayer(),elResizeBar.style.border="",DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover),DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",mouseup_ResizeBarCover);var t=getElementPos(e),n=0,r=0,i=getCurrentZoomValue(DEXTTOP.G_CURREDITOR);2==ResizeInfo.nResizeMode&&(n=(t.clientY-nStartHeight)/i),1==ResizeInfo.nResizeMode&&(r=(t.clientX-nStartWidth)/i),t=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=t){for(var i=[],s=0,o=t.rows.length,u=0;u<o;u++)for(var a=t.rows[u],f=a.cells.length,l=0;l<f;l++){var c=a.cells[l],h=getClientRect(c),p=getElementOffset(_iframeWin.frameElement);1==ResizeInfo.nResizeMode?nStartWidth<=h.right+p.left+2*nDraggableCellEdge&&nStartWidth>h.right+p.left-2*nDraggableCellEdge&&(p={},p.cell=c,p.right=h.right,i[s]=p,s+=1):2==ResizeInfo.nResizeMode&&nStartHeight<=h.bottom+p.top+2*nDraggableCellEdge&&nStartHeight>h.bottom+p.top-2*nDraggableCellEdge&&(p={},p.cell=c,p.right=h.bottom,i[s]=p,s+=1)}setResizeCells(r,n,i),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0}),onCellResize({cmd:"end",event:e})}}function setResizeCells(e,t,n){var r=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=r&&!(0>=n.length||0==e&&0==t)){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var i=getCurrentZoomValue(DEXTTOP.G_CURREDITOR);try{if(0!=t)for(var s=n.length,o=0;o<s;o++){var u=n[o].cell.parentNode;if(1==u.nodeType&&("TR"==u.tagName||"TH"==u.tagName)&&""!=u.style.height){for(var a=u.cells.length,f=0;f<a;f++)u.cells[f].style.height=u.style.height;u.style.removeProperty?u.style.removeProperty("height"):u.style.removeAttribute("height")}}}catch(l){}G_ResizeFixedTable.resizeFixedTable({nNewWidth:e,targetCell:ResizeInfo.currCell});for(var u=[],s=0,a=r.rows.length,o=0;o<a;o++)for(var c=r.rows[o],h=c.cells.length,f=0;f<h;f++){var p=c.cells[f],d=getClientRect(p);1==ResizeInfo.nResizeMode&&isSameRect(n[0].right,d.left)&&(u[s]=p,s+=1)}var v=0;if(1==ResizeInfo.nResizeMode){0<e&&0<u.length&&(d=getClientRect(u[0]),v=d.right-d.left,v-e<MIN_CELL_WIDTH&&(e=v-MIN_CELL_WIDTH)),0>e&&0<n.length&&(d=getClientRect(n[0].cell),v=d.right-d.left,v+e<MIN_CELL_WIDTH&&(e=MIN_CELL_WIDTH-v));if(0==u.length){o=parseIntOr0(r.style.width);if(""==r.style.width||""!=r.style.width&&-1<r.style.width.indexOf("%"))d=getClientRect(r),o=d.right-d.left;0<o+e&&0==G_ResizeFixedTable.isModifiedTable(r)&&(r.style.width=o+e+"px")}s=n.length;for(o=0;o<s;o++)getClientRect(n[o].cell),v=getElemAdjustWidthHeight(n[o].cell).width,i=e,v+e<MIN_CELL_WIDTH&&(i=MIN_CELL_WIDTH-v),n[o].newWidth=v+i+"px";for(o=0;o<s;o++)n[o].cell.style.width=n[o].newWidth;s=u.length,n=[];for(o=0;o<s;o++)getClientRect(u[o]),v=getElemAdjustWidthHeight(u[o]).width,v-e<MIN_CELL_WIDTH&&(e=v-MIN_CELL_WIDTH),n[o]=v-e+"px";for(o=0;o<s;o++)u[o].style.width=n[o]}else{s=n.length;for(o=0;o<s;o++)d=getClientRect(n[o].cell),v=getElemAdjustWidthHeight(n[o].cell).height,v+t<MIN_CELL_HEIGHT&&(t=MIN_CELL_HEIGHT-v),n[o].newHeight=v+t+"px";for(o=0;o<s;o++)n[o].cell.style.height=n[o].newHeight;try{if(0<s){e=[];for(var m=getClientRect(n[0].cell),a=r.rows.length,o=0;o<a;o++)for(c=r.rows[o],h=c.cells.length,f=0;f<h;f++)if(p=c.cells[f],d=getClientRect(p),d.top<=m.top&&d.bottom>=m.bottom){t=!1;for(u=0;u<s;u++)if(p==n[u].cell){t=!0;break}t||e.push(p)}for(var g=e.length,o=0;o<g;o++)e[o].style.height="";r.removeAttribute("height"),r.style.height="";if("1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight){var y=getClientRect(r);r.style.height=(y.bottom-y.top)/i+"px"}for(o=0;o<g;o++){var b=getClientRect(e[o]);e[o].style.height=(b.bottom-b.top)/i+"px"}}}catch(w){}}setAdjustTableWidthHeight(r),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(r=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=r,clearInterval(DEXTTOP.G_CURREDITOR.dext_dragresize.dextResizeIconInterval),DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null));try{setFocusToBody()}catch(E){}}}function setAdjustTableWidthHeight(e){if("0"!=DEXTTOP.G_CURREDITOR._config.tableAutoAdjust){var t,n,r;t=null,n=e.rows.length;if(0<n){var i=e.rows[0];r=i.cells.length,0<r&&(t=i.cells[0])}if(null!=t){var s,o;o=s=0;var u=[],a=[],f=getClientRect(t);for(t=0;t<n;t++){i=e.rows[t],r=i.cells.length;for(var l=0;l<r;l++){var c=i.cells[l],h=getClientRect(c);if(f.left==h.left){var p=h.bottom-h.top-1;o+=p}p=parseIntOr0(e.cellPadding),p=h.bottom-h.top-2-2*p+"px",u.push(p),f.top==h.top&&(p=h.right-h.left,s+=p),p=h.right-h.left-1,1<c.colSpan&&(p=1*p/c.colSpan),p+="px",a.push(p)}}0<s&&0<o&&(e.style.width=s+"px",removeAttribute(e.style,"height"));for(t=s=0;t<n;t++)for(i=e.rows[t],r=i.cells.length,l=0;l<r;l++)c=i.cells[l],c.style.width=a[s],c.style.height=u[s],s++}}}function getPosition(e){for(var t=0,n=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,n+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:n}}function hideResizeBar(){elResizeBar.style.display="none"}function showResizeBar(){elResizeBar.style.display="block";var e=getElementOffset(_iframeWin.frameElement);if(1==ResizeInfo.nResizeMode||3==ResizeInfo.nResizeMode){setResizeBarSize(2*(ResizeInfo.nBorderSize+nDraggableCellEdge),parseIntOr0(_iframeWin.frameElement.offsetHeight));var t=e.left+ResizeInfo.nBorderLeftPos+ResizeInfo.Pos.clientX-ResizeInfo.Pos.offsetX-parseIntOr0(elResizeBar.style.width);if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks))var n=getWindowScrollPos(_iframeWin),t=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<n[0]?t+2:t+n[0];3==ResizeInfo.nResizeMode&&(t+=2),setElementOffset(elResizeBar,e.top,t)}else setResizeBarSize(parseIntOr0(_iframeWin.frameElement.offsetWidth+"px"),2*(ResizeInfo.nBorderSize+nDraggableCellEdge)),t=e.top+ResizeInfo.Pos.clientY+ResizeInfo.nBorderTopPos-ResizeInfo.Pos.offsetY-parseIntOr0(elResizeBar.style.height),DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(n=getWindowScrollPos(_iframeWin),t=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<n[1]?t+nDraggableCellEdge:t+n[1]),4==ResizeInfo.nResizeMode&&(t+=2),setElementOffset(elResizeBar,t,e.left);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover),DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"click",setTableSelectEvt),3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode?getApplyDragResize(DEXTTOP.G_CURREDITOR)||(elResizeBarCover.style.cursor="move",DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"click",setTableSelectEvt)):(DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover),elResizeBarCover.style.cursor=1==ResizeInfo.nResizeMode?"col-resize":"row-resize")}function setTableSelectEvt(){var e=GetParentbyTagName(ResizeInfo.currCell,"table");command_tableSelection(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,e)}function setResizeBarSize(e,t){elResizeBar.style.width=e+"px",elResizeBar.style.height=t+"px"}function IsMousePointOnBorder(e){if(dragMove.dragStart)return!1;ResizeInfo.nResizeMode=0,ResizeInfo.currCell=e.target?e.target:e.srcElement;var t=ResizeInfo.currCell.tagName;if("TD"!=ResizeInfo.currCell.tagName&&"TH"!=ResizeInfo.currCell.tagName&&(ResizeInfo.currCell=GetTDTHCell(ResizeInfo.currCell),null==ResizeInfo.currCell))return!1;var n=GetParentbyTagName(ResizeInfo.currCell,"table");if(null==n)return!1;var r=DEXTTOP.G_CURREDITOR._config.tableNoResizeClass;if(""!=r&&n.className&&""!=n.className){for(var i=n.className.split(" "),s=i.length,o=!1,u=0;u<s;u++)if(i[u]==r){o=!0;break}if(o)return!1}ResizeInfo.currTable=n,ResizeInfo.nBorderLeftPos=0,ResizeInfo.nBorderTopPos=-1,ResizeInfo.Pos="contextmenu"==e.type?getClientRect(ResizeInfo.currCell):getElementPos(e,!0),ResizeInfo.nBorderSize=parseIntOr0(n.border),DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.opera?(e=ResizeInfo.nBorderSize+nDraggableCellEdge,n=nDraggableCellEdge):(e=nDraggableCellEdge,n=ResizeInfo.nBorderSize+nDraggableCellEdge),r=ResizeInfo.Pos.offsetX,i=ResizeInfo.Pos.offsetY,DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(s=getWindowScrollPos(_iframeWin),r-=s[0],i-=s[1]),i<=e&&ResizeInfo.currCell.parentNode.previousSibling&&("td"==t.toLowerCase()||"th"==t.toLowerCase())&&(ResizeInfo.nResizeMode=2),ResizeInfo.currCell.offsetHeight-n<=i&&(ResizeInfo.nBorderTopPos=ResizeInfo.currCell.offsetHeight+e-1,ResizeInfo.nResizeMode=2),t=1,9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&(s=getWindowScrollPos(_iframeWin),t=s[0]);if(ResizeInfo.currCell.offsetWidth-n<=r+t||DEXTTOP.DEXT5.browser.chrome&&0==ResizeInfo.Pos.offsetX)ResizeInfo.nBorderLeftPos=ResizeInfo.currCell.offsetWidth+e-1,ResizeInfo.nResizeMode=1;return t=getClientRect(ResizeInfo.currTable),r=!1,i=!0,"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use&&(s=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode,ResizeInfo.currTable.getAttribute("lock_mode")&&""!=ResizeInfo.currTable.getAttribute("lock_mode")&&(s=ResizeInfo.currTable.getAttribute("lock_mode")),"1"==s&&(r=!0),checkLockAttr(ResizeInfo.currTable,r)&&(i=!1)),i&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(t.left+e>=ResizeInfo.Pos.clientX?ResizeInfo.nResizeMode=3:t.top+n>=ResizeInfo.Pos.clientY&&(ResizeInfo.nResizeMode=4)),0===ResizeInfo.nResizeMode?!1:!0}function parseIntOr0(e){return e=parseInt(e,10),isNaN(e)?0:e}function getClientSize(){var e={};return"number"==typeof window.innerWidth?(e.width=window.innerWidth,e.height=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(e.width=document.body.clientWidth,e.height=document.body.clientHeight):(e.width=0,e.height=0),e}function setElementOffset(e,t,n){if("number"==typeof t&&"number"==typeof n){isNaN(parseInt(e.style.top,10))&&(e.style.top="0px"),isNaN(parseInt(e.style.left,10))&&(e.style.left="0px");var r=getElementOffset(e);t-=r.top,n-=r.left,e.style.top=parseInt(e.style.top,10)+t+"px",e.style.left=parseInt(e.style.left,10)+n+"px"}}function getElementPos(e,t){var n=e.target?e.target:e.srcElement,r=(n.ownerDocument||_iframeDoc).body,i=(n.ownerDocument||_iframeDoc).documentElement,i=[r.scrollLeft||i.scrollLeft,r.scrollTop||i.scrollTop],r={clientX:e.clientX,clientY:e.clientY,pageX:"pageX"in e?e.pageX:e.clientX+i[0]-r.clientLeft,pageY:"pageY"in e?e.pageY:e.clientY+i[1]-r.clientTop};return t&&(n=getElementOffset(n),i=getCurrentZoomValue(DEXTTOP.G_CURREDITOR),r.offsetX=(r.pageX-n.left)/i,r.offsetY=(r.pageY-n.top)/i),r}function getElementOffset(e){var t={left:0,top:0},n=e.ownerDocument||e.document||_iframeDoc,r=n.documentElement,i=n.body,s;return"undefined"!=typeof n.defaultView?s=n.defaultView:"undefined"!=typeof n.parentWindow&&(s=n.parentWindow),box=e.getBoundingClientRect(),e=r.clientTop||i.clientTop||0,n=s.pageYOffset&&r.scrollTop||i.scrollTop,t.left=box.left+(s.pageXOffset&&r.scrollLeft||i.scrollLeft)-(r.clientLeft||i.clientLeft||0),t.top=box.top+n-e,t}function GetParentInTag(e,t){for(var n=e;null!=n&&(!n.tagName||"html"!=n.tagName.toLowerCase());){if(n.tagName.toLowerCase()==t)return n;n=n.parentNode}return null}function GetParentTagPath(e){for(var t="";null!=e&&(!e.tagName||"html"!=e.tagName.toLowerCase());)t=e.tagName.toLowerCase()+"&nbsp;"+t,e=e.parentNode;return t}function getMyElementNode(e){if(1==e.nodeType)return e;for(;null!=e;){if(1==e.nodeType)return e;e=e.parentNode}return null}function getMyChildElementNode(e){if(3==e.nodeType)return e.parentNode;for(;null!=e.childNodes&&0<e.childNodes.length;){e=e.lastChild;if(3==e.nodeType)return e.parentNode;if("BR"==e.tagName||"IMG"==e.tagName)return e.previousSibling?getMyChildElementNode(e.previousSibling):e.parentNode}return 1==e.nodeType&&e.parentNode&&"BODY"!=e.parentNode.tagName?e.parentNode:null}function getElementInParentStyleProperty(e,t){for(var n="",r=e;null!=r&&(!r.tagName||"body"!=r.tagName.toLowerCase());){var i="";if("fontSize"==t)if(r.tagName&&"FONT"==r.tagName){if(i=r.size,0==!!i||""==i)i=r.style[t]}else r.style&&(i=r.style[t]);else r.style&&(i=r.style[t]);if(""!=i&&(n=i,void 0!=n&&0<n.length))return n=n.replace(/"/gi,""),n=n.replace(/'/gi,""),"backgroundColor"!=t&&"color"!=t&&(n=n.split(",")[0]),("backgroundColor"==t||-1<t.indexOf("margin")||-1<t.indexOf("padding"))&&-1<",TD,TH,TABLE,TR,".indexOf(","+r.tagName+",")&&(n=""),n;r=r.parentNode}return"fontFamily"==t?n=getElementInParentProperty(e,"face"):"fontSize"==t&&(n=getElementInParentProperty(e,"size")),void 0==n?"":n}function getElementInParentProperty(e,t){for(var n="",r=e;null!=r&&(!r.tagName||"body"!=r.tagName.toLowerCase());){if(void 0!=r[t]&&(n=r[t],0<n.length))return n=n.replace(/"/gi,""),n=n.replace(/'/gi,""),n=n.split(",")[0];r=r.parentNode}return void 0==n?"":n}function getElementInParentTag(e,t){for(var n="",r=e,i="";null!=r&&(!(i=r.nodeName.toLowerCase())||"body"!=i);){for(var s=0;s<t.length;s++)if(i==t[s]){switch(i){case"b":case"strong":n="blod";break;case"em":case"i":n="italic";break;case"u":n="underline";break;case"s":case"strike":n="strike_through";break;case"sup":n="superscript";break;case"sub":n="subscript";break;case"ol":n="list_number";break;case"ul":n="list_bullets";break;case"h1":case"h2":case"h3":case"h4":case"h5":n=i}return n}r=r.parentNode}return n}function _iframeDoc_MouseDown(e){G_dext5plugIn&&1==G_dext5plugIn.hasContainer&&G_dext5plugIn.DEXT5SetFocus(0);var t=null,t=e?e:_iframeWin.event,t=t.target?t.target:t.srcElement,n=t.tagName?t.tagName.toLowerCase():null;setDEXTWINDOC();var r=getEditrFromEvent(e);r._RangeBlurBug=!0,r._LastRange=null;if(DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem)DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&(checkClickOnScrollBar(e)?DEXTTOP.G_CURREDITOR.isMouseDownOnScrollBar=!0:DEXTTOP.G_CURREDITOR.isMouseDownOnScrollBar=!1);else{if(getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&("div"==n||"img"==n))return DEXTTOP.DEXT5.util.cancelEvent(e),!1;if(0!=checkContentEditable(r,t)){if(isRightClick(e))return DEXTTOP.DEXT5.util.cancelEvent(e),!1;if(!isViewMode(r)&&null!=t&&null!=n){setTimeout(function(){if(!G_dextResize_Elem_Flag){var e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode),G_CURSOR_ELEMENT=e,onChange({editor:r})}},10);if("1"!=r._config.formMode&&"1"==r._config.userTableLock.use){var i=GetTDTHCell(t),s;i&&(s=GetParentbyTagName(t,"table"));var o=r._config.userTableLock.defaultTableLockMode;s&&("2"==r._config.userTableLock.tableLockMode?checkLockAttr(s,!0)&&checkLockAttr(i,!0)?s.getAttribute("lock_mode")&&""!=s.getAttribute("lock_mode")&&(o=s.getAttribute("lock_mode")):o="0":s.getAttribute("lock_mode")&&""!=s.getAttribute("lock_mode")&&(o=s.getAttribute("lock_mode")));var u=!0;"1"==o?u=!1:"0"==o&&(u=!1,i=null);if(i){if(u&&checkLockAttr(s)){r.lastElemForLock?setFocusForLock(r.lastElemForLock):(t=findNoLockElem(s))?setFocusForLock(t):(window.focus(),document.body.focus()),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(i,!u)){r.lastElemForLock?setFocusForLock(r.lastElemForLock):setFocusForLock(findNoLockCell(s)),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}}}if("1"==r._config.formMode){if(e.ctrlKey)return setFormControlSelected(t),DEXTTOP.DEXT5.util.cancelEvent(e),!1;clearAllFormControlSelected()}if("1"==r._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("mousedown",e,t):DEXTTOP.DEXTWIN.dext_mouse_event("mousedown",e,t)}catch(a){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if(!(!n||"textarea"!=n&&"input"!=n&&"select"!=n))return!1;if("1"==r._config.adjustCursorInRelative&&(s=null,s=t.tagName&&"BODY"==t.tagName?t:getBlockContainer(t)))for(s=s.getElementsByTagName("span"),n=s.length,i=0;i<n;i++)"relative"==s[i].style.position&&(s[i].style.position="",r.relativeNode.push(s[i]));s=GetTDTHCell(t),null==s&&null!=ActiveCurrTable&&ClearDraggingTableCellSelected();if(s){ActiveCurrTable=GetParentbyTagName(s,"table");try{ActiveLastTable?ActiveLastTable!=ActiveCurrTable&&(ClearDraggingTable(ActiveLastTable),ActiveLastTable=ActiveCurrTable):ActiveLastTable=ActiveCurrTable}catch(f){ActiveLastTable=ActiveCurrTable}"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&1==t.nodeType&&"TD"==t.nodeName&&(RegExp("<p([^>?+]*)></p>","gi").test(t.innerHTML),s=ReplaceAll(t.innerHTML,RegExp.$1,""),""!=RegExp.$1&&"<p></p>"==s?t.innerHTML="<p "+RegExp.$1+"><br /></p>":"<p></p>"==t.innerHTML&&(t.innerHTML="<p><br /></p>"))}null!=ActiveCurrTable&&t==ActiveCurrTable?Mouse_Status=Mouse_IsTableDragging:(n=t.tagName.toLowerCase(),"img"==n||"hr"==n?("img"==n&&(DEXTTOP.G_SELECTED_IMAGE_ELEMENT=t),Mouse_Status=Mouse_IsControlSelecting):(n=null,n=GetTDTHCell(t),null==n?(Mouse_Status=Mouse_IsPlain,ClearDraggingTableCellSelected(),DrageStartCell=null,DEXTTOP.G_SELECTED_ELEMENT=t):(s=!1,i=DEXTTOP.G_CURREDITOR._config.tableNoSelectionClass,""!=i&&(s=GetParentbyTagName(t,"table"),s=checkContainClass(s,i)),0==s&&(Mouse_Status=Mouse_IsCellDragging,e.shiftKey?(e=getFirstRange().range.startContainer,DrageStartCell=GetTDTHCell(e),SelectedCellRange(DrageStartCell,n)):(ClearDraggingTableCellSelected(),removeCellDefValue(n,!1),mouseStartPos=getMousePosition(e),DrageStartCell=n,DrageEndCell=null,DEXTTOP.G_SELECTED_ELEMENT=t)))))}}}}function _iframeDoc_MouseUp(e){if(!dragMove.dragStart){setDEXTWINDOC();var t=getEditrFromEvent(e);t._RangeBlurBug=!1;if(isRightClick(e))return DEXTTOP.DEXT5.util.cancelEvent(e),!1;if(!isViewMode(t)){var n=null,r=e?e:_iframeWin.event,n=r.target?r.target:r.srcElement;if("1"==t._config.adjustCursorInRelative){for(r=t.relativeNode.length-1;0<=r;r--)t.relativeNode[r].style.position="relative";t.relativeNode=[]}if(0==checkContentEditable(t,n))DEXTTOP.DEXT5.util.cancelEvent(e),t._iconEnable("editableFalse");else{G_dextResize_Elem_Flag||(r=getFirstRange().range.startContainer,3==r.nodeType&&(r=r.parentNode),G_CURSOR_ELEMENT=r,set_ruler_vertical_height(t)),G_dextResize_Elem_Flag=!1;if(t.useFocusDivForIOS&&(t.useFocusDivForIOS=!1,r=document.getElementById("ue_editor_holder_"+t.ID))){var i=getClientRect(r),s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="absolute",s.style.left=i.left+"px",s.style.top=i.top+"px",s.style.zIndex=t._config.zIndex+10,i=document.createElement("textarea"),i.style.width="100%",i.style.height="100%",s.appendChild(i),r.appendChild(s),i.focus(),i.blur(),r.firstChild.contentWindow.document.body.focus(),r.removeChild(s)}if("1"!=t._config.formMode&&"1"==t._config.userTableLock.use){var s=GetTDTHCell(n),o;s&&(o=GetParentbyTagName(n,"table")),i=t._config.userTableLock.defaultTableLockMode,o&&("2"==t._config.userTableLock.tableLockMode?checkLockAttr(o,!0)&&checkLockAttr(s,!0)?o.getAttribute("lock_mode")&&""!=o.getAttribute("lock_mode")&&(i=o.getAttribute("lock_mode")):i="0":o.getAttribute("lock_mode")&&""!=o.getAttribute("lock_mode")&&(i=o.getAttribute("lock_mode"))),r=!0,"1"==i?r=!1:"0"==i&&(r=!1,s=null);if(s){i=!1;if(i=r?!checkLockAttr(s)&&!checkLockAttr(o):!checkLockAttr(s,!r))"TABLE"==n.tagName?checkLockAttr(n,!r)?t.lastElemForLock=findNoLockElem(n):(s=findNoLockCell(n),t.lastElemForLock=s):t.lastElemForLock=n;if(r&&checkLockAttr(o)){t.lastElemForLock?setFocusForLock(t.lastElemForLock):(t=findNoLockElem(o))?setFocusForLock(t):(window.focus(),document.body.focus()),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}}else"0"!=i&&("BODY"!=n.tagName&&("TABLE"==n.tagName?checkLockAttr(n,!r)?t.lastElemForLock=findNoLockElem(n):(s=findNoLockCell(n),t.lastElemForLock=s):t.lastElemForLock=n),checkLockElemInSelectionRange());r||(r=getFirstRange().range.startContainer,3==r.nodeType&&(r=r.parentNode),(s=GetParentbyTagName(r,"td"))&&checkLockAttr(s,!0)&&(t.lastElemForLock?setFocusForLock(t.lastElemForLock):(o=GetParentbyTagName(s,"td"),setFocusForLock(findNoLockCell(o))))),s=GetTableSelectionCells(),i=s.length;if(0<i){for(var u=!1,r=0;r<i;r++){if(checkLockAttr(s[r],!0)){u=!0;break}var a=[];a.push(s[r].getElementsByTagName("table")),a.push(s[r].getElementsByTagName("td"));var f=a.length;for(j=0;j<f;j++){var l=a[j].length;for(k=0;k<l;k++)if(checkLockAttr(a[j][k],!0)){u=!0;break}if(u)break}if(u)break}u&&(t.lastElemForLock?setFocusForLock(t.lastElemForLock):setFocusForLock(findNoLockCell(o)),ClearDraggingTableCellSelected())}(o=getSelectionTable(t))&&checkLockAttr(o)&&(t.lastElemForLock?setFocusForLock(t.lastElemForLock):setFocusForLock(findNoLockCell(o)))}o=n.tagName?n.tagName.toLowerCase():null;if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(i=GetParentbyTagName(n,"li")))if(r=getFirstRange().range,s=i.innerHTML,s=s.replace(/(<([^>]+)>)/ig,""),""==s)i.innerHTML=unescape("%u200B");else if(0==r.toString().length){s=r.endContainer;if(GetParentbyTagName(3==s.nodeType?s.parentNode:s,"li")!=i){s=i;try{var c=s.innerHTML.toLowerCase(),h=c.indexOf("ol"),p=c.indexOf("ul"),c="";-1<h&&0>p?c="ol":0>h&&-1<p?c="ul":-1<h&&-1<p&&(c=h<p?"ol":"ul");if(""!=c){var d=s.getElementsByTagName(c)[0],v=_iframeDoc.createTextNode(unescape("%u200B"));s.insertBefore(v,d),r.setStartBefore(v),r.setEndBefore(v),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(r)}}catch(m){}}for(h=null;;){if(!(!s.nextSibling||"OL"!=s.nextSibling.tagName&&"UL"!=s.nextSibling.tagName)){h=s.nextSibling;break}if(0==!!s.parentNode||"LI"==s.parentNode.tagName||"BODY"==s.parentNode.tagName)break;s=s.parentNode}h&&((v=h.previousSibling)&&3==v.nodeType&&v.data==unescape("%u200B")?(r.setStartBefore(v),r.setEndBefore(v),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(r)):(v=_iframeDoc.createTextNode(unescape("%u200B")),h.parentNode.insertBefore(v,h)))}if("input"==o&&(v=!1,DEXTTOP.DEXT5.browser.ie&&(v=n.disabled?!1:!0),v&&(DEXTTOP.G_SELECTED_ELEMENT=n,"checkbox"==n.type.toLowerCase()||"radio"==n.type.toLowerCase())))if(1==n.checked)n.checked=!1,n.removeAttribute("checked");else{if("radio"==n.type.toLowerCase())for(v=_iframeDoc.getElementsByName(n.name),h=v.length,r=0;r<h;r++)v[r].checked=!1,v[r].removeAttribute("checked");n.checked=!0,n.setAttribute("checked","checked")}if(!(!o||"textarea"!=o&&"input"!=o&&"select"!=o||"1"==DEXTTOP.G_CURREDITOR._config.formMode))return!1;if("1"==t._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("mouseup",e,n):DEXTTOP.DEXTWIN.dext_mouse_event("mouseup",e,n)}catch(g){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if(Mouse_Status==Mouse_IsCellDragging){if(DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.releaseCapture()}catch(y){}Mouse_Status=Mouse_IsPlain;try{var b,w=GetTDTHCell(n);w?"true"==w.getAttribute("dext_select")?b=""==ReplaceAll(w.innerHTML," ","")||1==checkCellDefValue(w.innerHTML)?1:2:(ClearDraggingTableCellSelected(),DrageEndCell=null,b=3):DrageEndCell&&(b=""==ReplaceAll(DrageEndCell.innerHTML," ","")||1==checkCellDefValue(DrageEndCell.innerHTML)?1:2);switch(b){case 1:setTimeout(function(){DEXTTOP.G_CURREDITOR._iconSelected();try{DrageEndCell?DrageEndCell.firstChild&&"P"==DrageEndCell.firstChild.tagName?doSetCaretPosition(DrageEndCell.firstChild,0):doSetCaretPosition(DrageEndCell,0):w&&(w.firstChild&&"P"==w.firstChild.tagName?doSetCaretPosition(w.firstChild,0):doSetCaretPosition(w,0))}catch(e){}},0);break;case 2:setTimeout(function(){try{var e;DrageEndCell?(e=getMyChildElementNode(DrageEndCell.lastChild),doSetCaretPosition(e,1)):w&&(e=getMyChildElementNode(w.lastChild),doSetCaretPosition(e,1)),DEXTTOP.G_CURREDITOR._iconSelected()}catch(t){}},0);break;case 3:break;default:DEXTTOP.G_CURREDITOR._iconSelected();try{DrageEndCell?doSetCaretPosition(DrageEndCell,0):w&&doSetCaretPosition(w,0)}catch(E){}}}catch(S){}}if(b=n.tagName)if(b=b.toLowerCase(),"img"==b)0==Mouse_Status&&(n.getAttribute("raon_chart")&&n.setAttribute("raon_plugin","chart"),onResize({cmd:"end",isResize:getApplyDragResize(DEXTTOP.G_CURREDITOR),target:n}),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0);else if("html"==b){if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&(DEXTTOP.G_CURREDITOR.isMouseDownOnScrollBar||checkClickOnScrollBar(e)))return;setFocusToBody()}setRulerPositionForNode(t);if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{setTimeout(function(){var e,t=getFirstRange().range;t&&t.startContainer==t.endContainer&&1==t.collapsed&&(e=getMyElementNode(t.startContainer));if(0==t.toString().length&&("undefined"==typeof e&&"a"==getMyElementNode(t.startContainer).tagName.toLowerCase()&&(e=getMyElementNode(t.startContainer)),null==e)){var r=!1;try{var i;t.startContainer&&t.startContainer.tagName&&(i=t.startContainer.tagName.toLowerCase());var s=getElementsFromSelection(i);i?DEXTTOP.DEXT5.browser.ie&&(8>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)?1==s.length&&"IMG"==s[0].tagName&&(r=!0):2==s.length&&"IMG"==s[1].tagName&&(r=!0):3==s.length&&"IMG"==s[2].tagName&&(r=!0)}catch(o){}!r&&n&&0>",div,img,table,input,textarea,select,hr,".indexOf(","+n.tagName.toLowerCase()+",")&&(n.tagName&&"P"==n.tagName&&"TD"==n.parentNode.tagName?doSetCaretPosition(n,1):n.tagName&&"SPAN"==n.tagName&&"raon_placeholder"==n.className||("VIDEO"==n.tagName?(setFocusToBody(),r=getFirstRange().sel,t.setStartBefore(n),t.setEndBefore(n),r.removeAllRanges(),r.addRange(t)):(setFocusToBody(),setFocusChildForStyle(DEXTTOP.G_CURREDITOR._BODY),(t=getFirstRange().range)&&t.startContainer==t.endContainer&&1==t.collapsed&&(e=getMyElementNode(t.startContainer)))))}if(11<=DEXTTOP.DEXT5.browser.ieVersion){if("undefined"==typeof e&&t.endContainer&&(e=getMyElementNode(t.endContainer)),e&&"P"==e.nodeName&&e.lastChild&&"BR"==e.lastChild.nodeName&&e.lastChild.previousSibling&&(t=t.getBoundingDocumentRect(),Math.round(t.right)==Math.round(getClientRect(e.lastChild).right))){for(e=e.lastChild.previousSibling;e&&e.lastChild;)e=e.lastChild;e=getMyElementNode(e)}}else if(e)if(e=getFirstRange().sel.focusNode)for(;1!=e.nodeType;)e=e.parentNode;else e=getMyElementNode(t.startContainer);e&&setMenuIconRealable(e)},10)}catch(x){}onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}}}}function CheckNoWhere(e,t,n){var r=t.Y,i=_iframeDoc.body.clientHeight,s=_iframeDoc.body.firstChild,o=_iframeDoc.body.lastChild;t=!1,e="spanTag_NoWhere_"+DEXTTOP.G_CURREDITOR.ID;if(10>=r&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+s.tagName.toLowerCase()+","))t=!0;else if(r>=i&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+o.tagName.toLowerCase()+","))t=!0;else if(10<r&&r<i){t=!1,r=" table hr div ul ol dl form blockquote ".split(" "),s=i=null;for(o=0;o<r.length&&(i=GetParentInTag(n,r[o]),null==i);o++);if(null!=i)if(null==i.previousSibling)t=!0,getElementOffset(i);else{for(o=0;o<r.length&&(s=GetParentInTag(i.previousSibling,r[o]),null==s);o++);null!=i&&null!=s&&(t=!0,getElementOffset(i))}}else if(s.id==e)return;0==t?(n=_iframeDoc.getElementById(e),null!=n&&_iframeDoc.body.removeChild(n)):(n=_iframeDoc.getElementById(e),null==n&&(n=_iframeDoc.createElement("span"),n.setAttribute("id",e),n.innerHTML="",_iframeDoc.body.insertBefore(n,_iframeDoc.body.firstChild)))}function _iframeDoc_MouseMove(e){var t=getEditrFromEvent(e);if(!isViewMode(t))if(getApplyDragResize(t)&&t.dext_dragresize&&t.dext_dragresize.G_dextResize_elem&&t.dext_dragresize.G_isDrag)DEXTTOP.G_CURREDITOR.dext_dragresize.dragElem(e,"doc"),DEXTTOP.DEXT5.util.cancelEvent(e);else{var n=null,r=e?e:_iframeWin.event,n=r.target?r.target:r.srcElement,i=n.tagName?n.tagName.toLowerCase():null;set_ruler_mouse_guide(t,r);if(null!=i&&Mouse_Status!=Mouse_IsCellResizing&&Mouse_Status!=Mouse_IsTableDragging&&null!=n){if("1"==t._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("mousemove",e,n):DEXTTOP.DEXTWIN.dext_mouse_event("mousemove",e,n)}catch(s){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if("1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink)if("a"==n.tagName.toLowerCase()||n.parentElement&&"a"==n.parentElement.tagName.toLowerCase()){DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&!e.ctrlKey&&hyperLinkOut(),t=n,"a"!=n.tagName.toLowerCase()&&(t=n.parentElement),r=null,"a"!=n.tagName.toLowerCase()&&(r=n);if(!t.getAttribute("href")||-1<t.getAttribute("href").indexOf("#"))return;if(DEXTTOP.G_CURREDITOR.isAOver.node!=t&&!DEXTTOP.G_CURREDITOR.isAOver.openHelp){var o=e.clientX,u=e.clientY;DEXTTOP.G_CURREDITOR.isAOver={over:!0,node:t,nodeChild:r,linkStyle:!1},DEXTTOP.G_CURREDITOR.isAOver.timer=setTimeout(function(){hyperHelpOpen(o,u)},500)}}else DEXTTOP.G_CURREDITOR.isAOver.timer&&(clearTimeout(DEXTTOP.G_CURREDITOR.isAOver.timer),DEXTTOP.G_CURREDITOR.isAOver.node=null,DEXTTOP.G_CURREDITOR.isAOver.nodeChild=null),DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose(),DEXTTOP.G_CURREDITOR.isAOver.timer=null;t=GetTDTHCell(n),mouseEndPos=getMousePosition(e);if(isLeftClick(e)&&Mouse_Status==Mouse_IsCellDragging){if(null!=t&&null!=DrageStartCell&&(DrageStartCell!=t||0!=GetTableSelectionCells().length)&&(GetParentbyTagName(n,"table")==ActiveCurrTable&&(DrageEndCell=t),SelectedCellRange(DrageStartCell,t),DEXTTOP.DEXT5.browser.ie&&setAutoScroll(mouseEndPos),DEXTTOP.DEXT5.browser.ie))try{_iframeDoc.body.setCapture(!1)}catch(a){}}else"img"!=i&&"hr"!=i&&"div"!=i&&"a"!=i&&(Mouse_Status=Mouse_IsPlain),DEXTTOP.DEXT5.browser.mobile||(null!=t?IsMousePointOnBorder(e)?t.isContentEditable&&showResizeBar():hideResizeBar():hideResizeBar())}}}function _iframeDoc_MouseOut(e){setDEXTWINDOC(),e=getEditrFromEvent(e),isViewMode(e)||(e.isAOver.linkStyle&&hyperLinkOut(),e.isAOver.openHelp&&hyperHelpClose())}function setAutoScroll(e){var t=getElementOffset(_iframeWin.frameElement),n,r;n=_iframeWin.frameElement.offsetHeight,r=_iframeWin.frameElement.offsetWidth;var t=t.left+r,i,s;DEXTTOP.DEXT5.browser.ie?(i=_iframeDoc.documentElement.scrollLeft+_iframeDoc.body.scrollLeft,s=_iframeDoc.documentElement.scrollTop+_iframeDoc.body.scrollTop):(i=_iframeWin.scrollX,s=_iframeWin.scrollY),e.X+20>t&&_iframeWin.scroll(i+30,s),0<i&&e.X-20<t-r&&_iframeWin.scroll(i-30,s),e.Y+20>n&&_iframeWin.scroll(i,s+30),0<s&&e.Y-20<n-n&&_iframeWin.scroll(i,s-30)}function isLeftClick(e){return e.which?1==e.which:e.button?1==e.button:!1}function isRightClick(e){var t=!1;e=e||window.event,e.which||void 0===e.button||(e.which=e.button&1?1:e.button&2?3:e.button&4?2:0);switch(e.which){case 1:t=!1;break;case 2:t=!1;break;case 3:t=!0;break;case 0:0==e.button&&(t=!0)}return t}function ClearDraggingTableCellSelected(){if(null!=ActiveCurrTable&&ActiveCurrTable.getAttribute("DEXT5CellSelected"))try{ActiveCurrTable.removeAttribute("DEXT5CellSelected");for(var e=ActiveCurrTable,t=e.rows.length,n=0;n<t;n++)for(var r=e.rows[n],i=r.cells.length,s=0;s<i;s++){var o=r.cells[s];"true"==o.getAttribute("dext_select")&&(o.style.backgroundColor=o.getAttribute("cellOrgBgColor"),removeAttribute(o,"cellOrgBgColor"),removeAttribute(o,"dext_select"),removeEmptyStyleTag(o))}}catch(u){}}function ClearDraggingTable(e){if(null!=e&&e.getAttribute("DEXT5CellSelected"))try{e.removeAttribute("DEXT5CellSelected");for(var t=e.rows.length,n=0;n<t;n++)for(var r=e.rows[n],i=r.cells.length,s=0;s<i;s++){var o=r.cells[s];"true"==o.getAttribute("dext_select")&&(o.style.backgroundColor=o.getAttribute("cellOrgBgColor"),removeAttribute(o,"cellOrgBgColor"),removeAttribute(o,"dext_select"),removeEmptyStyleTag(o))}}catch(u){}}function ClearDraggingTableAllTable(e){try{var t=_iframeDoc;e&&(t=e);for(var n=t.getElementsByTagName("TABLE"),r=n.length,i=t=null,s=0,o=0,u=0,a=0;a<r;a++)if(t=n[a],s=t.rows.length,t.getAttribute("DEXT5CellSelected")){try{if(e){var f=t.cloneNode();f.innerHTML=t.innerHTML,t.parentNode.replaceChild(f,t),t=f}}catch(l){}t.removeAttribute("DEXT5CellSelected");for(var c=0;c<s;c++)for(var o=t.rows[c],u=o.cells.length,h=0;h<u;h++)i=o.cells[h],"true"==i.getAttribute("dext_select")&&(i.style.backgroundColor=i.getAttribute("cellOrgBgColor"),removeAttribute(i,"cellOrgBgColor"),removeAttribute(i,"dext_select"),removeEmptyStyleTag(i))}}catch(p){}}function colorToHex(e){if(6>e.length)return"#tttttt";if("#"===e.substr(0,1))return e;e=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(e);if(null==e)return"#tttttt";var t=parseInt(e[2]),n=parseInt(e[3]),t=parseInt(e[4])|n<<8|t<<16;return e[1]+"#"+t.toString(16)}function removeAttribute(e,t){if(null!=e)try{e.removeProperty?e.removeProperty(t):e.removeAttribute(t)}catch(n){}}function getClientRect(e){var t={left:0,top:0,right:0,bottom:0};try{t=e.getBoundingClientRect()}catch(n){}return t}function getMousePosition(e){var t={};if(e.clientX||e.clientY)t.X=Math.round(e.clientX),t.Y=Math.round(e.clientY);else if(e.pageX||e.pageY)t.X=Math.round(e.pageX),t.Y=Math.round(e.pageY);return t}function SelectedCellRange(e,t,n){n=GetParentbyTagName(e,"tr");var r=GetParentbyTagName(t,"tr");if(null!=n&&null!=r&&(ActiveCurrTable=GetParentbyTagName(n,"table"),ClearDraggingTableCellSelected(),e!=t)){n=getClientRect(e);var i=getClientRect(t),r=function(e,t){return null==e?e={left:t.left,top:t.top,right:t.right,bottom:t.bottom}:(t.left<e.left&&(e.left=t.left),t.right>e.right&&(e.right=t.right),t.top<e.top&&(e.top=t.top),t.bottom>e.bottom&&(e.bottom=t.bottom)),e};e=function(e,t){var n=0;return t.left>=e.left&&t.right<=e.right&&t.top>=e.top&&t.bottom<=e.bottom?n=2:!(1>Math.abs(t.left-e.right))&&t.left<e.right&&!(1>Math.abs(t.right-e.left))&&t.right>e.left&&!(1>Math.abs(t.top-e.bottom))&&t.top<e.bottom&&!(1>Math.abs(t.bottom-e.top))&&t.bottom>e.top&&(n=1),n},n=r(null,n),n=r(n,i);for(i=ActiveCurrTable.rows.length;;){for(var s=0,o=0;o<i;o++){for(var u=ActiveCurrTable.rows[o],a=u.cells.length,f=0;f<a;f++){var s=u.cells[f],l=getClientRect(s),s=e(n,l);if(1==s){n=r(n,l);break}}if(1==s)break}if(1!=s)break}r=!1;for(o=0;o<i;o++)for(u=ActiveCurrTable.rows[o],a=u.cells.length,f=0;f<a;f++)s=u.cells[f],l=getClientRect(s),2==e(n,l)&&(null!=s.getAttribute("cellOrgBgColor")&&s.removeAttribute("cellOrgBgColor"),s.setAttribute("cellOrgBgColor",s.style.backgroundColor),s.style.backgroundColor=ColorCellBackColor,"1"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&setCellDefValue(s),s.setAttribute("dext_select","true"),r=!0);if(r)try{if(DrageEndCell=t,ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected"),"1"==DEXTTOP.G_CURREDITOR._config.cellSelectionMode){var c=getFirstRange().sel;c&&c.removeAllRanges&&c.removeAllRanges()}}catch(h){}}}function GetTDTHCell(e){3==e.nodeType&&(e=e.parentNode);if(e&&e.nodeName.match(/t[dh]/i))return e;for(;null!=e&&!e.nodeName.match(/t[dh]/i);)e=e.parentNode;return e}function CanMerge(){if(null==ActiveCurrTable)return 0;var e=0,t,n,r,i,s,o,u,a;t=n=1e7;for(var f=r=i=0;f<ActiveCurrTable.rows.length;f++)for(var l=ActiveCurrTable.rows[f],c=0;c<l.cells.length;c++){var h=l.cells[c];if("true"==h.getAttribute("dext_select")){u=h.colSpan;var p=h.rowSpan,e=e+u*p;a=getClientRect(h),s=a.left,o=a.top,u=a.right,a=a.bottom}t>s&&(t=parseInt(s,10)),n>o&&(n=parseInt(o,10)),r<u&&(r=parseInt(u,10)),i<a&&(i=parseInt(a,10))}for(f=o=s=0;f<ActiveCurrTable.rows.length;f++)for(l=ActiveCurrTable.rows[f],c=0;c<l.cells.length;c++)if(h=l.cells[c],a=getClientRect(h),t<=parseInt(a.left,10)&&n<=parseInt(a.top,10)&&r>=parseInt(a.right,10)&&i>=parseInt(a.bottom,10)||t>parseInt(a.left,10)&&n<=parseInt(a.top,10)&&t<parseInt(a.right,10)&&i>=parseInt(a.bottom,10)||r>parseInt(a.left,10)&&n<=parseInt(a.top,10)&&r<parseInt(a.right,10)&&i>=parseInt(a.bottom,10)||t<=parseInt(a.left,10)&&i>parseInt(a.top,10)&&r>=parseInt(a.right,10)&&i<parseInt(a.bottom,10)||t<=parseInt(a.left,10)&&n>parseInt(a.top,10)&&r>=parseInt(a.right,10)&&n<parseInt(a.bottom,10))u=h.colSpan,p=h.rowSpan,s+=u*p,r==a.right&&(o+=h.rowSpan);return t=0,0<o&&(t=e/o),"number"==typeof t&&0<t.toString().indexOf(".")?!1:s==e&&1<s?s:0}function command_mergeCell(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(0!=CanMerge()){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var n,r,i,s,o,u,a,f;n=r=1e7,i=s=0;var l="";ActiveCurrTable&&(l=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");for(var c=0;c<ActiveCurrTable.rows.length;c++)for(var h=ActiveCurrTable.rows[c],p=0;p<h.cells.length;p++){var d=h.cells[p];"true"==d.getAttribute("dext_select")&&(f=getClientRect(d),o=f.left,u=f.top,a=f.right,f=f.bottom),n>o&&(n=o),r>u&&(r=u),i<a&&(i=a),s<f&&(s=f)}a=u="";var v,m;v=m=0,o=null;for(c=0;c<ActiveCurrTable.rows.length;c++)for(h=ActiveCurrTable.rows[c],p=0;p<h.cells.length;p++)d=h.cells[p],f=getClientRect(d),n<=f.left&&r<=f.top&&i>=f.right&&s>=f.bottom&&(r==f.top&&n==f.left?(o=d,a=d.innerHTML):d.style.visibility="hidden",u+=removeCellDefValue(d,!0),1>Math.abs(n-f.left)&&(v+=d.rowSpan),1>Math.abs(r-f.top)&&(m+=d.colSpan));if(o){f=0,n=getClientRect(o);for(c=ActiveCurrTable.rows.length-1;0<=c;c--)for(h=ActiveCurrTable.rows[c],p=h.cells.length-1;0<=p;p--)d=h.cells[p],r=getClientRect(d),"hidden"==d.style.visibility&&(n.top==r.top&&(f+=parseIntOr0(d.style.width)),n.right==r.left&&n.top!=r.top&&parseIntOr0(d.style.height));0<f&&(o.style.width=parseIntOr0(o.style.width)+f+"px")}c=!1,o&&(c=!0);if(c){ActiveCurrTable.style.borderCollapse="",i=r=0,s=[],n=getClientRect(o);for(c=0;c<ActiveCurrTable.rows.length;c++)for(nTemp=0,h=ActiveCurrTable.rows[c],p=0;p<h.cells.length;p++)d=h.cells[p],f=getClientRect(d),(n.left!=f.left||n.right!=f.right)&&n.left<=f.left&&n.right>=f.right&&(0==nTemp&&s.push(d),nTemp+=d.colSpan),n.bottom==f.top&&(i=nTemp),n.top==f.bottom&&(r=nTemp);0<r||0<i?o.colSpan=r<i?i:r:removeAttribute(o,"colSpan");if(s.length==ActiveCurrTable.rows.length){for(c=0;c<s.length;c++)removeAttribute(s[c],"colSpan");removeAttribute(o,"colSpan")}}if(o){1<m&&(o.colSpan=m),1<v&&(o.rowSpan=v);for(c=ActiveCurrTable.rows.length-1;0<=c;c--){h=ActiveCurrTable.rows[c];for(p=h.cells.length-1;0<=p;p--)d=h.cells[p],"hidden"==d.style.visibility&&h.deleteCell(p);0==h.cells.length&&deleteRow(h)}o.innerHTML=0==u.length?""!=a?a:DEXTTOP.DEXT5.browser.ie?"":getCellDefValue():u;try{DEXTTOP.DEXT5.browser.gecko?0==u.length?doSetCaretPosition(o.childNodes[0],0):setGeckoCellCaretPosistion(o,!0):(doSetCaretPosition(o.childNodes[0],0),removeCellDefValue(o,!1))}catch(g){}ClearDraggingTableCellSelected();if(1==ActiveCurrTable.rows.length)for(h=ActiveCurrTable.rows[0],p=0;p<h.cells.length;p++)d=h.cells[p],removeAttribute(d,"rowSpan"),removeAttribute(d,"colSpan");1==ActiveCurrTable.rows.length&&1==ActiveCurrTable.rows[0].cells.length&&(removeAttribute(ActiveCurrTable.rows[0].cells[0],"width"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"height"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"colSpan"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"rowSpan"));if(o&&1<o.colSpan&&1<ActiveCurrTable.rows.length){a=0,u=[],n=getClientRect(o);for(c=0;c<ActiveCurrTable.rows.length;c++)for(h=ActiveCurrTable.rows[c],p=0;p<h.cells.length;p++)d=h.cells[p],f=getClientRect(d),n.left==f.left&&n.right==f.right&&parseIntOr0(o.colSpan)==parseIntOr0(d.colSpan)&&(f=parseIntOr0(d.rowSpan),a=1<f?a+f:a+1,u.push(d));if(a==ActiveCurrTable.rows.length)for(h=u.length,c=0;c<h;c++)removeAttribute(u[c],"colSpan")}}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=l),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}}function command_deleteTable(e,t){dext_src_init(t._EDITOR.design);if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var n=ActiveCurrTable.previousSibling;try{if(n){if(3==n.nodeType||1==n.nodeType&&"BR"==n.tagName)n="text"}else{var r=ActiveCurrTable.parentNode;1==r.nodeType&&"BODY"!=r.tagName&&(n=r)}}catch(i){n=null}ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null;if("text"!=n)if(null==n)""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default"));else if(doSetCaretPosition(n,1),n=GetParentbyTagName(n,"table")){var r=t._config.tableNoActionClass,s=!1;""!=r&&(s=checkContainClass(n,r)),ActiveCurrTable=n,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",s)}else DEXTTOP.G_CURREDITOR._iconEnable("default");DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_insertRowUp(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),InsertRowUpDown(!0,!1,n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}function command_insertRowDown(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),InsertRowUpDown(!1,!1,n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}function InsertRowUpDown(e,t,n,r){var i=getFirstRange().range;if(i){var s=null,s=r?r:GetTDTHCell(i.startContainer);if(null!=s&&(ActiveCurrTable=GetParentbyTagName(s,"table"),r=GetParentbyTagName(s,"tr"))){i=0,e?i=r.rowIndex:(i=1<s.rowSpan?r.rowIndex+s.rowSpan:r.rowIndex+1,i>ActiveCurrTable.rows.length&&(i=ActiveCurrTable.rows.length));for(var o=[],u=[],a=getClientRect(s),s=0;s<ActiveCurrTable.rows.length;s++)for(var f=ActiveCurrTable.rows[s],l=0;l<f.cells.length;l++){var c=f.cells[l],h=getClientRect(c);if(e){if(.1>Math.abs(a.top-h.top)||h.top<a.top&&h.bottom>a.top){var p={};p.left=h.left,p.cell=c,u.push(p)}}else if(.1>Math.abs(a.bottom-h.bottom)||h.bottom>a.bottom&&a.bottom>h.top)p={},p.left=h.left,p.cell=c,u.push(p)}u.sort(function(e,t){return e.left-t.left});for(s=0;s<u.length;s++)o.push(u[s].cell);u=[];for(s=0;s<o.length;s++)f=o[s],l=f.rowSpan,h=getClientRect(f),u[s]=1<l&&1==e&&h.top!=a.top||1<l&&0==e&&h.bottom!=a.bottom?f.rowSpan+1:1;n||(n=1);for(e=0;e<n;e++)for(a=ActiveCurrTable.insertRow(i),setCopyAllObjectAtributes(r,a,!1),s=0;s<o.length;s++)if(f=o[s],l=f.rowSpan,1<u[s])f.rowSpan=u[s],removeAttribute(f,"height");else if(h=a.insertCell(-1)){"th"==f.tagName.toLowerCase()&&(l=document.createElement("th"),h.parentNode.replaceChild(l,h),h=l),h.innerHTML=getCellDefValue();if(t){l=[],c=[];try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion)for(var l=f.getElementsByTagName("a"),d=l.length,v=0;v<d;v++)l[v].outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),c.push(RegExp.$2)}catch(m){l=[],c=[]}setCopyAllObjectAtributes(f,h,!0);try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(d=l.length,0<d))for(var g=h.getElementsByTagName("a"),y=g.length,v=0;v<y;v++)g[v].href&&0>g[v].href.toLowerCase().indexOf("javascript")&&0>g[v].href.indexOf("'")&&0>g[v].href.indexOf('"')&&""!=c[v]&&g[v].href!=c[v]&&(g[v].href=c[v],g[v].setAttribute("href",c[v]))}catch(b){h.innerHTML=f.innerHTML}}else setCopyAllObjectAtributes(f,h,!1);1<h.rowSpan&&removeAttribute(h,"rowSpan")}}}}function command_deleteRow(e,t){dext_src_init(t._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var n=null,r=-1,i=0,s=getFirstRange().range;if(s){s=GetTDTHCell(s.startContainer),n=ActiveCurrTable.previousSibling;try{if(n){if(3==n.nodeType||1==n.nodeType&&"BR"==n.tagName)n="text"}else{var o=ActiveCurrTable.parentNode;1==o.nodeType&&"BODY"!=o.tagName&&(n=o)}}catch(u){n=null}o=GetParentbyTagName(s,"tr");for(s=0;s<ActiveCurrTable.rows.length;s++)for(var a=ActiveCurrTable.rows[s],f=0;f<a.cells.length;f++)if("true"==a.cells[f].getAttribute("dext_select")){-1==r&&(r=a.rowIndex),i++;break}i=i||1;for(s=0;s<i;s++){-1!=r&&(o=ActiveCurrTable.rows[r]);if(null==o)return;deleteRow(o)}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):"text"!=n&&(null==n?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):(doSetCaretPosition(n,1),(n=GetParentbyTagName(n,"table"))?(r=t._config.tableNoActionClass,i=!1,""!=r&&(i=checkContainClass(n,r)),ActiveCurrTable=n,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",i)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}function deleteRow(e){if(null!=e){ActiveCurrTable=GetParentbyTagName(e,"table");var t=e.rowIndex;ActiveCurrTable.previousSibling&&doSetCaretPosition(ActiveCurrTable.previousSibling,0);for(var n=0;n<ActiveCurrTable.rows.length;n++){var r=ActiveCurrTable.rows[n],i=r.rowIndex;if(t==i)break;for(var s=0;s<r.cells.length;s++){var o=r.cells[s],u=o.rowSpan;1<u&&t<i+u&&(2==u?removeAttribute(o,"rowSpan"):o.rowSpan=u-1)}}for(s=0;s<e.cells.length;s++)if(o=e.cells[s],u=o.rowSpan,1<u){n=ActiveCurrTable.rows[e.rowIndex+1].insertCell(o.cellIndex);if(null==n)return;r=o.colSpan,i=o.style.width,n.innerHTML=o.innerHTML,n.style.border="1px solid #000000",n.style.width=i,2<u&&(n.rowSpan=u-1),1<r&&(n.colSpan=r)}1==ActiveCurrTable.rows.length?(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null):ActiveCurrTable.deleteRow(t)}}function command_insertCellLeft(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertCell(!0,n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}function command_insertCellRight(e,t,n){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertCell(!1,n),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}function insertCell(e,t){var n=getFirstRange().range;if(n){var r=GetTDTHCell(n.startContainer);if(null!=r&&(ActiveCurrTable=GetParentbyTagName(r,"table"),GetParentbyTagName(r,"tr"))){for(var n=[],i=[],s=getClientRect(r),r=0;r<ActiveCurrTable.rows.length;r++)for(var o=ActiveCurrTable.rows[r],u=0;u<o.cells.length;u++){var a=o.cells[u],f=getClientRect(a);e?1>Math.abs(s.left-f.left)?(f={},f.x=r,f.y=u,f.width=0<a.style.width.length?a.style.width:"",f.height=0<a.style.height.length?a.style.height:"",f.rowSpan=a.rowSpan,f.cell=a,n.push(f)):(s.top>=f.bottom||s.bottom<=f.top)&&.1<f.right-s.left&&.1<s.left-f.left&&i.push(a):1>Math.abs(s.right-f.right)?(f={},f.x=r,f.y=u+1,f.rowSpan=a.rowSpan,f.width=0<a.style.width.length?a.style.width:"",f.height=0<a.style.height.length?a.style.height:"",f.cell=a,n.push(f)):(s.top>=f.bottom||s.bottom<=f.top)&&.1<f.right-s.right&&.1<s.right-f.left&&i.push(a)}t||(t=1);for(r=0;r<n.length;r++)for(s=0;s<t;s++){a=n[r],o=ActiveCurrTable.rows[a.x].insertCell(a.y);if(null==o)return;"th"==a.cell.tagName.toLowerCase()&&(u=document.createElement("th"),o.parentNode.replaceChild(u,o),o=u),o.innerHTML=getCellDefValue(),setCopyAllObjectAtributes(a.cell,o,!1),1<a.rowSpan?o.rowSpan=a.rowSpan:removeAttribute(o,"rowSpan"),1<a.cell.colSpan&&removeAttribute(o,"colSpan"),0==r&&""!=ActiveCurrTable.style.width&&-1<ActiveCurrTable.style.width.indexOf("px")&&(o=DEXTTOP.DEXT5.util.parseIntOr0(ActiveCurrTable.style.width),u=0,""!=a.width&&-1<a.width.indexOf("px")&&(u=DEXTTOP.DEXT5.util.parseIntOr0(a.width)),ActiveCurrTable.style.width=o+u+"px")}for(r=0;r<i.length;r++)for(s=0;s<t;s++)a=i[r],a.colSpan+=1}}}function command_InsertSplitCell(e,t,n,r){dext_src_init(t),restoreSelection(),setFocusToBody(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range;var i,s,o;!DEXTTOP.G_SELECTED_ELEMENT||"TD"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&"TH"!=DEXTTOP.G_SELECTED_ELEMENT.tagName?e&&(o=GetTDTHCell(e.startContainer)):o=DEXTTOP.G_SELECTED_ELEMENT,o&&(i=GetTableSelectionCells(o),s=i.length);if(0==s)1<parseInt(n)&&splitCellByRow(n,!0,o),1<parseInt(r)&&splitCellByColumn(r,!0,o);else for(o=0;o<s;o++)1<parseInt(n)&&splitCellByRow(n,!0,i[o]),1<parseInt(r)&&splitCellByColumn(r,!0,i[o]);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,n="focusInCell";try{i=GetTableSelectionCells(),0<i.length&&(n=1==i.length?"selectedSingleCell":"selectedMultiCell")}catch(u){}DEXTTOP.G_CURREDITOR._iconEnable(n)}function splitCellByRow(e,t,n){if(t=null==n||void 0==n?getFirstRange().range:n)if(t=null==n||void 0==n?GetTDTHCell(t.startContainer):GetTDTHCell(t),null!=t){ActiveCurrTable=GetParentbyTagName(t,"table");var r=GetParentbyTagName(t,"tr"),i="";ActiveCurrTable&&(i=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");var s=null;if("1"==DEXTTOP.G_CURREDITOR._config.splitCellStyle){var o=[];if(t.firstChild){var u=t.firstChild.nodeName.toLowerCase();if("p"==u||"span"==u||"ol"==u||"ul"==u||"li"==u){var a=function(e){o.push(e.cloneNode());if(e.firstChild){u=e.firstChild.nodeName.toLowerCase();for(var t="span b strong i em strike u sup sub font ul ol li".split(" "),n=!1,r=0;r<t.length;r++)if(t[r]==u){n=!0;break}return n?a(e.firstChild):!0}return!0};if(a(t.firstChild)){for(var s=null,f=o.length-1;0<=f;f--)s?o[f].appendChild(s):o[f].innerHTML=getCellDefValue().replace(/<p>|<\/p>/gi,""),s=o[f];s=s.outerHTML}}}}if(r){whereRowIdx=r.rowIndex;if(1<t.rowSpan){--t.rowSpan;var r=t.style.width,l=t.style.height,c=ActiveCurrTable.rows[whereRowIdx+t.rowSpan],h=GetFirstIndexInRowByCurrCell(c,t);if(c=c.insertCell(h+1))c.innerHTML=s?s:getCellDefValue(),c.style.borderTop=t.style.borderTop,c.style.borderRight=t.style.borderRight,c.style.borderBottom=t.style.borderBottom,c.style.borderLeft=t.style.borderLeft,c.style.padding=t.style.padding,c.style.marginTop=t.style.marginTop,c.style.marginRight=t.style.marginRight,c.style.marginBottom=t.style.marginBottom,c.style.marginLeft=t.style.marginLeft,c.className=t.className,"true"==t.getAttribute("dext_select")?(c.setAttribute("cellOrgBgColor",t.getAttribute("cellOrgBgColor")),c.style.backgroundColor=ColorCellBackColor,c.setAttribute("dext_select","true")):""==t.style.backgroundColor||0!=t.style.backgroundColor.indexOf("#")&&0!=t.style.backgroundColor.indexOf("rgb")||(c.style.backgroundColor=t.style.backgroundColor),0<r.length&&(c.style.width=r),0<l.length&&(c.style.height=l),1<t.colSpan&&(c.colSpan=t.colSpan);--e,1==t.rowSpan&&removeAttribute(t,"rowSpan"),1<e&&splitCellByRow(e,!1,n),ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=i);return}n=[],f=0,l=getClientRect(t);for(r=0;r<ActiveCurrTable.rows.length;r++)for(c=ActiveCurrTable.rows[r],h=0;h<c.cells.length;h++){var p=c.cells[h],d=getClientRect(p);if(1>Math.abs(l.top-d.top)||1<=Math.abs(l.top-d.top)&&d.top<l.top&&1<=Math.abs(l.top-d.bottom)&&d.bottom>l.top)n[f]=p,f+=1}f=[];for(r=0;r<n.length;r++)l=n[r],d=getClientRect(l),l!=t&&(f[r]=l.rowSpan+(e-1));for(d=1;d<e;d++){c=ActiveCurrTable.insertRow(whereRowIdx+d),r=t.style.width,l=t.style.height,h=GetFirstIndexInRowByCurrCell(c,t);if(c=c.insertCell(h))c.innerHTML=s?s:getCellDefValue(),c.style.borderTop=t.style.borderTop,c.style.borderRight=t.style.borderRight,c.style.borderBottom=t.style.borderBottom,c.style.borderLeft=t.style.borderLeft,c.style.padding=t.style.padding,c.style.marginTop=t.style.marginTop,c.style.marginRight=t.style.marginRight,c.style.marginBottom=t.style.marginBottom,c.style.marginLeft=t.style.marginLeft,c.className=t.className,"true"==t.getAttribute("dext_select")?(c.setAttribute("cellOrgBgColor",t.getAttribute("cellOrgBgColor")),c.style.backgroundColor=ColorCellBackColor,c.setAttribute("dext_select","true")):""==t.style.backgroundColor||0!=t.style.backgroundColor.indexOf("#")&&0!=t.style.backgroundColor.indexOf("rgb")||(c.style.backgroundColor=t.style.backgroundColor),0<r.length&&(c.style.width=r),0<l.length&&(c.style.height=l),1<t.colSpan&&(c.colSpan=t.colSpan);for(r=0;r<n.length;r++)l=n[r],1<=f[r]&&(l.rowSpan=f[r],removeAttribute(l,"height"))}}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=i)}}function GetFirstIndexInRowByCurrCell(e,t){for(var n=-1,r=e.cells.length,i=getClientRect(t),r=r-1;0<=r;r--){var s=getClientRect(e.cells[r]);if(i.left>=s.right){n=r;break}}return n}function splitCellByColumn(e,t,n){if(t=null==n||void 0==n?getFirstRange().range:n)if(t=null==n||void 0==n?GetTDTHCell(t.startContainer):GetTDTHCell(t),null!=t){ActiveCurrTable=GetParentbyTagName(t,"table");var r=GetParentbyTagName(t,"tr"),i="";ActiveCurrTable&&(i=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");var s=null;if("1"==DEXTTOP.G_CURREDITOR._config.splitCellStyle){var o=[];if(t.firstChild){var u=t.firstChild.nodeName.toLowerCase();if("p"==u||"span"==u||"ol"==u||"ul"==u||"li"==u){var a=function(e){o.push(e.cloneNode());if(e.firstChild){u=e.firstChild.nodeName.toLowerCase();for(var t="span b strong i em strike u sup sub font ul ol li".split(" "),n=!1,r=0;r<t.length;r++)if(t[r]==u){n=!0;break}return n?a(e.firstChild):!0}return!0};if(a(t.firstChild)){for(var s=null,f=o.length-1;0<=f;f--)s?o[f].appendChild(s):o[f].innerHTML=getCellDefValue().replace(/<p>|<\/p>/gi,""),s=o[f];s=s.outerHTML}}}}if(r){if(1<t.colSpan){--t.colSpan;var l=parseInt(t.style.width),f=isNaN(parseInt(parseInt(t.style.width)/e))?"":parseInt(parseInt(t.style.width,10)/e,10)+"px",c=t.style.height,h=r.insertCell(t.cellIndex+1);h&&(h.innerHTML=s?s:getCellDefValue(),h.style.borderTop=t.style.borderTop,h.style.borderRight=t.style.borderRight,h.style.borderBottom=t.style.borderBottom,h.style.borderLeft=t.style.borderLeft,h.style.padding=t.style.padding,h.style.marginTop=t.style.marginTop,h.style.marginRight=t.style.marginRight,h.style.marginBottom=t.style.marginBottom,h.style.marginLeft=t.style.marginLeft,h.className=t.className,"true"==t.getAttribute("dext_select")?(h.setAttribute("cellOrgBgColor",t.getAttribute("cellOrgBgColor")),h.style.backgroundColor=ColorCellBackColor,h.setAttribute("dext_select","true")):""==t.style.backgroundColor||0!=t.style.backgroundColor.indexOf("#")&&0!=t.style.backgroundColor.indexOf("rgb")||(h.style.backgroundColor=t.style.backgroundColor),0<f.length&&(h.style.width=f),0<c.length&&(h.style.height=c),1<t.rowSpan&&(h.rowSpan=t.rowSpan)),--e,1==t.colSpan&&removeAttribute(t,"colSpan"),1<e?(f=l-parseInt(f),0<f&&(t.style.width=f+"px"),splitCellByColumn(e,!1,n)):0<f.length&&(t.style.width=f),ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=i);return}n=[],h=0,c=getClientRect(t);for(f=0;f<ActiveCurrTable.rows.length;f++)for(var p=ActiveCurrTable.rows[f],l=0;l<p.cells.length;l++){var d=p.cells[l],v=getClientRect(d);if(d!=t){if(c.left>=v.left&&c.right<=v.right){p={},p.x=f,p.y=l,p.width=0<d.style.width.length?d.style.width:"",p.colSpan=d.colSpan,n[h]=p,h+=1;break}}else if(d==t)break}for(f=0;f<n.length;f++){h=n[f],h=ActiveCurrTable.rows[h.x].cells[h.y];if(null==h)return;h.colSpan+=e-1}f=isNaN(parseInt(parseInt(t.style.width)/e))?"":parseInt(parseInt(t.style.width,10)/e,10)+"px",0>=f.length&&(f=isNaN(parseInt(parseInt(t.clientWidth)/e))?"":parseInt(parseInt(t.clientWidth,10)/e,10)+"px"),""==f&&1==ActiveCurrTable.rows.length&&(f=parseInt(parseInt(ActiveCurrTable.style.width,10)/e,10)+"px"),c=t.style.height,0<f.length&&(t.style.width=f),0<c.length&&(t.style.height=c);for(n=1;n<e;n++)if(h=r.insertCell(t.cellIndex+n))h.innerHTML=s?s:getCellDefValue(),h.style.borderTop=t.style.borderTop,h.style.borderRight=t.style.borderRight,h.style.borderBottom=t.style.borderBottom,h.style.borderLeft=t.style.borderLeft,h.style.padding=t.style.padding,h.style.marginTop=t.style.marginTop,h.style.marginRight=t.style.marginRight,h.style.marginBottom=t.style.marginBottom,h.style.marginLeft=t.style.marginLeft,h.className=t.className,"true"==t.getAttribute("dext_select")?(h.setAttribute("cellOrgBgColor",t.getAttribute("cellOrgBgColor")),h.style.backgroundColor=ColorCellBackColor,h.setAttribute("dext_select","true")):""==t.style.backgroundColor||0!=t.style.backgroundColor.indexOf("#")&&0!=t.style.backgroundColor.indexOf("rgb")||(h.style.backgroundColor=t.style.backgroundColor),0<f.length&&(h.style.width=f),0<c.length&&(h.style.height=c),1<t.rowSpan&&(h.rowSpan=t.rowSpan)}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=i)}}function command_deleteCell(e,t){dext_src_init(t._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection(),setFocusToBody();var n=null;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var r=getFirstRange().range;if(r){var i="";ActiveCurrTable&&(i=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse=""),n=ActiveCurrTable.previousSibling;try{if(n){if(3==n.nodeType||1==n.nodeType&&"BR"==n.tagName)n="text"}else{var s=ActiveCurrTable.parentNode;1==s.nodeType&&"BODY"!=s.tagName&&(n=s)}}catch(o){n=null}var s=0,u=!1;"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",u=!0),"1"==DEXTTOP.G_CURREDITOR._config.adjustCellSizeAfterDeleteCell&&setAdjustTableWidthHeight(ActiveCurrTable),u&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"),u=GetTableSelectionCells();for(0==u.length&&u.push(GetTDTHCell(r.startContainer));0<u.length;){var r=0,a=u[u.length-1],f=getClientRect(a);if(a){for(var l=[],u=0;u<ActiveCurrTable.rows.length;u++){var c=ActiveCurrTable.rows[u];if(a.parentNode.rowIndex==u){var h={};h.x=u,h.y=a.cellIndex,h.isDel=!0,l.push(h)}else for(var p=0;p<c.cells.length;p++){var h=c.cells[p],d=getClientRect(h),h={};h.x=u,h.y=p,f.left<=d.left&&f.right>=d.right?(h.isDel=!0,l.push(h)):f.left>=d.left&&f.right<=d.right&&(h.isDel=!1,l.push(h))}}for(u=l.length;0<u;u--){c=l[u-1],p=ActiveCurrTable.rows[c.x].cells[c.y];if(null==p){ActiveCurrTable.style.borderCollapse=i;return}c.isDel?(p=parseIntOr0(p.style.width),r<p&&(r=p),ActiveCurrTable.rows[c.x].deleteCell(c.y)):2<p.colSpan?--p.colSpan:removeAttribute(p,"colSpan")}for(u=ActiveCurrTable.rows.length-1;0<=u;u--)if(0==ActiveCurrTable.rows[u].cells.length){l=ActiveCurrTable.rows[u].rowIndex;for(p=0;p<u;p++){c=ActiveCurrTable.rows[p],a=c.rowIndex;if(l==a)break;for(f=0;f<c.cells.length;f++)h=c.cells[f],d=h.rowSpan,1<d&&l<a+d&&(2==d?removeAttribute(h,"rowSpan"):h.rowSpan=d-1)}ActiveCurrTable.deleteRow(u)}0==ActiveCurrTable.rows.length&&(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null)}s+=r,u=GetTableSelectionCells()}ActiveCurrTable&&(r=parseIntOr0(ActiveCurrTable.style.width),0<r&&(ActiveCurrTable.style.width=r-s+"px"),ActiveCurrTable.style.borderCollapse=i)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):"text"!=n&&(null==n?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):(doSetCaretPosition(n,1),(n=GetParentbyTagName(n,"table"))?(i=t._config.tableNoActionClass,s=!1,""!=i&&(s=checkContainClass(n,i)),ActiveCurrTable=n,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",s)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}function GetTableSelectionCells(e){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(e,"table"));if(null==ActiveCurrTable)return[];e=[];for(var t=0,n=0;n<ActiveCurrTable.rows.length;n++)for(var r=ActiveCurrTable.rows[n],i=0;i<r.cells.length;i++){var s=r.cells[i];"true"==s.getAttribute("dext_select")&&(e[t]=s,t+=1)}return e}function GetTableSelectionCellsPosition(e,t){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(e,"table"));if(null==ActiveCurrTable)return[];for(var n={arrOutSideLeft:[],arrOutSideRight:[],arrOutSideTop:[],arrOutSideBottom:[],arrSelected:[],rowCnt:0,colCnt:0},r,i=[],s=[],o=ActiveCurrTable.rows.length,u=[],a=0,f=0;f<o;f++){for(var l=ActiveCurrTable.rows[f],s=[],c=0,h=l.cells.length,p=0;p<h;p++){var d=l.cells[p];t?(s.push(d),n.arrSelected.push(d),r=f,c+=1):"true"==d.getAttribute("dext_select")&&(s.push(d),n.arrSelected.push(d),r=f,c+=1,void 0==u[a]&&(u[a]=[]),u[a].push(d))}u[a]&&0<u[a].length&&a++,0<s.length&&i.push(s),c>n.colCnt&&(n.colCnt=c)}n.virtualSelectionsCellTable=u;if(0!=i.length||null!=e&&void 0!=e){if(0==i.length)return n.arrOutSideLeft.push(e),n.arrOutSideRight.push(e),n.arrOutSideTop.push(e),n.arrOutSideBottom.push(e),n.rowCnt=1,n.colCnt=1,n.virtualSelectionsCellTable=[[e]],n;n.arrOutSideTop=i[0].slice(),s=i.length,n.rowCnt=s;if(0<s)for(n.arrOutSideBottom=i[s-1].slice(),f=l=a=u=o=0;f<s;f++){c=i[f],p=c.length,d=0,h=p;if(0==o||c[0].parentNode.rowIndex==u+o)n.arrOutSideLeft.push(c[0]),d=1,1<c[0].rowSpan&&(o=parseIntOr0(c[0].rowSpan),u=c[0].parentNode.rowIndex,1<o&&o+u-1>=r&&n.arrOutSideBottom.push(c[0]));if(0==a||c[p-1].parentNode.rowIndex==l+a)n.arrOutSideRight.push(c[p-1]),--h,1<c[p-1].rowSpan&&(a=parseIntOr0(c[p-1].rowSpan),l=c[p-1].parentNode.rowIndex),1<a&&a+l-1>=r&&n.arrOutSideBottom.push(c[p-1]);c[0].parentNode.rowIndex==u+o&&(o=u=0),c[p-1].parentNode.rowIndex==l+a&&(a=l=0);if(f<s-1)for(p=d;p<h;p++){var d=c[p].rowSpan,v=c[p].parentNode.rowIndex;1<d&&v+d-1>=r&&n.arrOutSideBottom.push(c[p])}}return n}return n}function CellSelectedCopy(e){var t={all:!0,selected:!1,cellValue:[],Table:null},n=l=0,r,i="",s=0;if(null==e||void 0==e)return!1;for(var o=e.rows.length,u=!1,a=0;a<o;a++){for(var f=e.rows[a],c=f.cells.length,i=i+"<tr>",h=0;h<c;h++){var p=f.cells[h];if("true"==p.getAttribute("dext_select")){t.selected=!0,void 0==t.cellValue[n]&&(t.cellValue[n]=[]),r=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==p.innerHTML?"&nbsp;":p.innerHTML,t.cellValue[n].push(r),i+=p.outerHTML;try{var d=isNaN(parseInt(p.style.width,10))?d=parseInt(p.width,10):parseInt(p.style.width,10);if(isNaN(d))var v=getClientRect(p),d=v.right-v.left;isNaN(d)&&(d=0)}catch(m){d=0}0==u&&(s+=parseInt(d,10)+1)}else t.all=!1}0!=s&&(u=!0),i+="</tr>",void 0!=t.cellValue[n]&&(n+=1)}if(0==t.all)for(table_tag=DEXTTOP.DEXT5.util.replaceAll(e.outerHTML,e.innerHTML,i),table_tag=DEXTTOP.DEXT5.util.replaceAll(table_tag,"<tr></tr>",""),a=document.createElement("div"),a.innerHTML=table_tag,e=a.getElementsByTagName("table")[0],e.style.width=s+"px",e.style.height="",e.height="",s=e.getElementsByTagName("td"),n=s.length,a=0;a<n;a++)""!=s[a].getAttribute("cellOrgBgColor")&&"undefined"!=typeof s[a].getAttribute("cellOrgBgColor")?(s[a].style.backgroundColor=s[a].getAttribute("cellOrgBgColor"),removeAttribute(s[a],"cellOrgBgColor"),removeAttribute(s[a],"dext_select")):s[a].style.backgroundColor="";return t.Table=e,t}function getTableBorderCells(e){var t={arrLeft:[],arrTop:[],arrRight:[],arrBottom:[]};if(null==e||void 0==e)return t;var n=e.tagName.toLowerCase(),r=e;"table"!=n&&(r=GetParentbyTagName(e,"table"));if(null==r)return t;e=r.rows.length;for(var i=getClientRect(r.rows[0].cells[0]),n=0;n<e;n++)for(var s=r.rows[n],o=s.cells.length,u=0;u<o;u++){var a=s.cells[u],f=getClientRect(a);i.left==f.left&&t.arrLeft.push(a),i.top==f.top&&t.arrTop.push(a)}for(var n=t.arrTop[t.arrTop.length-1],i=getClientRect(t.arrLeft[t.arrLeft.length-1]),l=getClientRect(n),n=0;n<e;n++)for(s=r.rows[n],o=s.cells.length,u=0;u<o;u++)a=s.cells[u],f=getClientRect(a),i.bottom==f.bottom&&t.arrBottom.push(a),l.right==f.right&&t.arrRight.push(a);return t}function getCellNearLeftTop(e,t){var n={arrLeft:[],arrRight:[],arrTop:[],arrBottom:[],arrSelected:[]},r=[];void 0==t&&(r=GetTableSelectionCells(e));if(0!=r.length||null!=e&&void 0!=e){0==r.length&&r.push(e),n.arrSelected=
r;var i=GetParentbyTagName(r[0],"table");getClientRect(i.rows[0].cells[0]);for(var s=0;s<r.length;s++)for(var o=getClientRect(r[s]),u=i.rows.length,a=0;a<u;a++)for(var f=i.rows[a],l=f.cells.length,c=0;c<l;c++){var h=f.cells[c],p=getClientRect(h);o.left==p.right&&(o.top<=p.top&&o.bottom>=p.bottom||o.top>=p.top&&o.bottom<=p.bottom&&1<h.rowSpan)&&n.arrLeft.push(h),o.right==p.left&&(o.top<=p.top&&o.bottom>=p.bottom||o.top>=p.top&&o.bottom<=p.bottom&&1<h.rowSpan)&&n.arrRight.push(h),o.top==p.bottom&&(o.left<=p.left&&o.right>=p.right||o.left>=p.left&&o.right<=p.right&&1<h.colSpan)&&n.arrTop.push(h),o.bottom==p.top&&(o.left<=p.left&&o.right>=p.right||o.left>=p.left&&o.right<=p.right&&1<h.colSpan)&&n.arrBottom.push(h)}return n}return n}function setTableRowSelect(e){if(null!=e&&void 0!=e){var t=GetParentbyTagName(e,"table"),n=GetParentbyTagName(e,"tr");if(null!=t&&null!=n){for(var t=null,r=0;r<n.cells.length;r++)t=n.cells[r],t.setAttribute("cellOrgBgColor",t.style.backgroundColor),t.style.backgroundColor=ColorCellBackColor,t.setAttribute("dext_select","true"),setCellDefValue(t);DrageEndCell=t,n=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]),doSetCaretPosition(n,0),setMenuIconRealable(DrageEndCell),_iframeDoc_MouseUpMenu(null,e)}}}function setTableColumnSelect(e){if(null!=e&&void 0!=e){var t=GetParentbyTagName(e,"table");if(null!=t){for(var n=t.rows.length,r=null,i=getClientRect(e),s=0;s<n;s++)for(var o=t.rows[s],u=o.cells.length,a=0;a<u;a++){cell=o.cells[a];var f=getClientRect(cell);i.left==f.left&&(cell.setAttribute("cellOrgBgColor",cell.style.backgroundColor),cell.style.backgroundColor=ColorCellBackColor,cell.setAttribute("dext_select","true"),setCellDefValue(cell),r=cell)}DrageEndCell=r,t=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]),doSetCaretPosition(t,0),setMenuIconRealable(DrageEndCell),_iframeDoc_MouseUpMenu(null,e)}}}function setTableCellSelect(e){if(null!=e&&void 0!=e){var t=e.tagName.toLowerCase();if("td"!=t||"th"!=t)e=GetTDTHCell(e);null!=e&&(e.setAttribute("cellOrgBgColor",e.style.backgroundColor),e.style.backgroundColor=ColorCellBackColor,e.setAttribute("dext_select","true"),setCellDefValue(e),DrageEndCell=e,_iframeDoc_MouseUpMenu(null,e))}}function setTableAllSelect(e){if(null!=e&&void 0!=e){var t=GetParentbyTagName(e,"table");if(null!=t){for(var n=t.rows.length,r=null,i=0;i<n;i++)for(var s=t.rows[i],o=s.cells.length,u=0;u<o;u++)r=s.cells[u],r.setAttribute("cellOrgBgColor",r.style.backgroundColor),r.style.backgroundColor=ColorCellBackColor,r.setAttribute("dext_select","true"),setCellDefValue(r);DrageEndCell=r,t=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]),doSetCaretPosition(t,1),setMenuIconRealable(DrageEndCell),_iframeDoc_MouseUpMenu(null,e)}}}function setTableWidthRemove(){for(var e=GetTableSelectionCells(),t=0;t<e.length;t++){var n=e[t];removeAttribute(n,"width"),removeAttribute(n.style,"width")}}function setTableHeightRemove(){for(var e=GetTableSelectionCells(),t=e.length,n=0;n<t;n++){var r=e[n];removeAttribute(r,"height"),removeAttribute(r.style,"height")}}function setTableWidthHeightRemove(){for(var e=GetTableSelectionCells(),t=e.length,n=0;n<t;n++){var r=e[n];removeAttribute(r,"width"),removeAttribute(r.style,"width"),removeAttribute(r,"height"),removeAttribute(r.style,"height")}}function setTableWidthSame(){var e=GetTableSelectionCells();if(0!=e.length){var t=GetParentbyTagName(e[0],"table");if(null!=t){G_ResizeFixedTable.setSameWidth();for(var n=GetTableSelectionCellsPosition(e[0],!1).virtualSelectionsCellTable,r=0,i=0,s=0;s<n.length;s++){var o=n[s].length;o>i&&(i=o,r=s)}for(var o=0,i=n[r],u=i.length,s=0;s<u;s++)r=0,n=i[s],""!=n.style.width&&-1<n.style.width.indexOf("%")?(r=getClientRect(n),r=r.right-r.left):r=parseIntOr0(n.style.width),0==r&&(r=parseIntOr0(n.width)),0==r&&(r=getClientRect(n),r=r.right-r.left),o+=r;for(var i=t.rows.length,o=Math.ceil(o/u),u=[],a=0;a<e.length;a++)for(r=getClientRect(e[a]),s=0;s<i;s++)for(var f=t.rows[s],l=f.cells.length,c=0;c<l;c++){var n=f.cells[c],h=getClientRect(n);r.left==h.left&&r.right==h.right&&u.push(n)}e=u.length;for(t=0;t<e;t++)n=u[t],n.style.width=o+"px",removeAttribute(n,"width")}}}function setTableHeightSame(){var e=GetTableSelectionCells(),t=e.length;if(0!=t){for(var n=[],r,i=0;i<t;i++)r?r==getClientRect(e[i]).left&&n.push(e[i]):(r=getClientRect(e[i]).left,n.push(e[i]));var e=n,i=t=e.length,s=GetParentbyTagName(e[0],"table");if(null!=s){for(var o=0,u=n=0;u<t;u++){var a=e[u],o=o+getCellSize(a).height;if(1<a.rowSpan)var f=parseInt(a.rowSpan,10),i=i+(f-1)}f=s.rows.length,r=0,r=parseInt(o/i,10),o=[];for(u=0;u<t;u++)for(var l=getClientRect(e[u]),i=0;i<f;i++)for(var c=s.rows[i],h=c.cells.length,p=0;p<h;p++){var a=c.cells[p],d=getClientRect(a);1<parseIntOr0(e[u].rowSpan)?l.top<=d.top&&l.bottom>=d.bottom&&o.push(a):1<parseIntOr0(a.rowSpan)||l.top==d.top&&l.bottom==d.bottom&&o.push(a)}e=o.length;for(i=0;i<e;i++)f=(f=parseIntOr0(o[i].rowSpan))?f:1,o[i].style.height=r*f+"px",removeAttribute(a,"height");t=!1;for(i=0;i<e;i++)s=getCellSize(o[i]).height,f=(f=parseIntOr0(o[i].rowSpan))?f:1,s/=f,r<s&&(n=s,t=!0);if(t)for(i=0;i<e;i++)f=(f=parseIntOr0(o[i].rowSpan))?f:1,o[i].style.height=n*f+"px",removeAttribute(a,"height")}}}function setTableRowClone(e){null!=e&&void 0!=e&&(GetTDTHCell(e),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),InsertRowUpDown(!1,!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}function command_convertTableToText(e,t){dext_src_init(t._EDITOR.design),restoreSelection(),setFocusToBody();if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var n="",r=ActiveCurrTable,i=r.rows.length,s=0;s<i;s++)for(var o=r.rows[s],u=o.cells.length,a=0;a<u;a++)var f=o.cells[a],l="",l="innerText"in f?f.innerText:"textContent"in f?f.textContent:"",n=n+l;r=ActiveCurrTable.parentNode,r.removeChild(ActiveCurrTable),ActiveCurrTable=null,n=n.replace("&nbsp;",""),i=_iframeDoc.createElement("p"),i.innerHTML=n,r.appendChild(i),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function _iframeDoc_MouseUpMenu(e,t){setDEXTWINDOC();var n=getEditrFromEvent(e);if(!isViewMode(n)){var r=null;try{var i=e?e:_iframeWin.event,r=void 0!=t||null!=t?t:i.target?i.target:i.srcElement;if(0==checkContentEditable(n,r))DEXTTOP.DEXT5.util.cancelEvent(e),n._iconEnable("editableFalse");else{DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(r=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem);if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var s=GetTDTHCell(r),o;s&&(o=GetParentbyTagName(r,"table"));var u=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;o&&("2"==DEXTTOP.G_CURREDITOR._config.userTableLock.tableLockMode?checkLockAttr(o,!0)&&checkLockAttr(s,!0)?o.getAttribute("lock_mode")&&""!=o.getAttribute("lock_mode")&&(u=o.getAttribute("lock_mode")):u="0":o.getAttribute("lock_mode")&&""!=o.getAttribute("lock_mode")&&(u=o.getAttribute("lock_mode"))),n=!0,"1"==u?n=!1:"0"==u&&(n=!1,s=null);if(s){if(n&&checkLockAttr(o)){if(currEditor.lastElemForLock)setFocusForLock(currEditor.lastElemForLock);else{var a=findNoLockElem(o);a?setFocusForLock(a):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(s,!n)){currEditor.lastElemForLock?setFocusForLock(currEditor.lastElemForLock):setFocusForLock(findNoLockCell(o)),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e);return}}}var f=r.tagName.toLowerCase();if(!(!f||"textarea"!=f&&"input"!=f&&"select"!=f||"1"==DEXTTOP.G_CURREDITOR._config.formMode))return!1;if(f&&"img"==f){var l=r.getAttribute("dext5customdata");if(null!=l&&void 0!=l&&"hidden"==getDextCustomData(l).type)return!1}var c=function(){var e=getFirstRange(),t=e.range;if(t){var n=GetTableSelectionCells(),i=!1,s=DEXTTOP.G_CURREDITOR._config.tableNoActionClass;if(0<n.length)""!=s&&(i=GetParentbyTagName(n[0],"table"),i=checkContainClass(i,s)),1==n.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell",i):DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell",i);else{n=GetTDTHCell(t.startContainer);try{r.toString()||(r=null)}catch(o){r=null}var u=GetParentbyTagName(r,"div");if(u&&"DEXT_fiVe_Page_Break"==u.className&&t.startContainer==t.endContainer)e.sel.removeAllRanges(),t.selectNode(u),e.sel.addRange(t),DEXTTOP.G_CURREDITOR._iconEnable("focusPageBreak");else if("table"==f)""!=s&&(i=checkContainClass(r,s)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",i);else if(t&&0<t.toString().length){var a;"body"==f&&1==t.startContainer.nodeType&&(a=getSelectionTable(DEXTTOP.G_CURREDITOR)),a?(""!=s&&(i=checkContainClass(a,s)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",i)):n?DEXTTOP.G_CURREDITOR._iconEnable("cellSelectText"):DEXTTOP.G_CURREDITOR._iconEnable("selectArea")}else if(a=getSelectionTable(DEXTTOP.G_CURREDITOR))""!=s&&(i=checkContainClass(a,s)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",i);else if(e=GetTDTHCell(r),"img"==f)DEXTTOP.G_SELECTED_ELEMENT=r,GetParentbyTagName(r,"figure")?DEXTTOP.G_CURREDITOR._iconEnable("focusFigure"):DEXTTOP.G_CURREDITOR._iconEnable("focusImage");else if(e){if("1"!=DEXTTOP.G_CURREDITOR._config.formMode||"input"!=f&&"textarea"!=f&&"select"!=f)""!=s&&(i=GetParentbyTagName(e,"table"),i=checkContainClass(i,s)),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",i),DEXTTOP.G_SELECTED_ELEMENT=e}else"a"!=f&&"table"!=f&&"video"!=f&&("embed"==f?DEXTTOP.G_CURREDITOR._iconEnable("focusEmbed"):"span"==f&&r&&"raon_placeholder"==r.className?DEXTTOP.G_CURREDITOR._iconEnable("placeholder"):DEXTTOP.G_CURREDITOR._iconEnable("default"))}}};0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable?(s=r,DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&(s=getFirstRange().range.startContainer,3==s.nodeType&&(s=s.parentNode)),0==s.isContentEditable?DEXTTOP.G_CURREDITOR._iconEnable("editableFalse"):"2"==DEXTTOP.G_CURREDITOR._config.toolBarEnableDisableMode?c():setTimeout(function(e){c(e)},10)):"2"==DEXTTOP.G_CURREDITOR._config.toolBarEnableDisableMode?c():setTimeout(function(e){c(e)},10)}}catch(h){}}}function _iframeBody_Select(e){_iframeDoc_MouseUpMenu(e)}function setGeckoCellCaretPosistion(e,t){if(0<e.childNodes.length){var n=e.childNodes[e.childNodes.length-1];n.childNodes?t?doSetCaretPosition(n.childNodes[0],1):doSetCaretPosition(n.childNodes[0],0):doSetCaretPosition(n,0)}else doSetCaretPosition(e,0)}function setTableShortcut(e){var t="which"in e?e.which:e.keyCode,n=!1,r=getEditrFromEvent(e);if(null==r)return n;try{if(e.ctrlKey){e=null;var i=getFirstRange().range;i&&0==i.toString().length&&i.startContainer&&(e=getMyElementNode(i.startContainer));if(e){if(e=GetTDTHCell(e))switch(ActiveCurrTable=GetParentbyTagName(e,"table"),t){case 116:ClearDraggingTableCellSelected(),r._dextCommands(r.ID,"table_select_cell"),n=!0;break;case 117:ClearDraggingTableCellSelected(),r._dextCommands(r.ID,"table_select_row"),n=!0;break;case 118:ClearDraggingTableCellSelected(),r._dextCommands(r.ID,"table_select_column"),n=!0;break;case 119:ClearDraggingTableCellSelected(),r._dextCommands(r.ID,"table_select_all"),n=!0;break;case 120:r._dextCommands(r.ID,"merge_cell"),n=!0;break;case 121:r._dextCommands(r.ID,"table_same_width"),n=!0;break;case 122:r._dextCommands(r.ID,"table_same_height"),n=!0}n&&_iframeDoc_MouseUpMenu(null,e)}}}catch(s){}return n}function getElemAdjustWidthHeight(e){var t={width:0,height:0},n=getCurrentZoomValue(DEXTTOP.G_CURREDITOR);if(e.style.width&&""!=e.style.width)if(-1<e.style.width.indexOf("%")||-1<e.style.width.indexOf("in")){var r=getClientRect(e);t.width=r.right-r.left}else t.width=parseInt(e.style.width);else e.width&&""!=e.width?t.width=parseInt(e.width):(r=getClientRect(e),t.width=r.right-r.left);if(e.style.height&&""!=e.style.height)if(r=getClientRect(e),-1<e.style.height.indexOf("%")||-1<e.style.width.indexOf("in"))t.height=(r.bottom-r.top)/n;else{t.height=parseInt(e.style.height);try{var i=r.bottom-r.top,i=i/n;20<i-t.height&&(t.height=i)}catch(s){}}else e.height&&""!=e.height?t.height=parseInt(e.height):(r=getClientRect(e),t.height=r.bottom-r.top);return t}function setCopyAllObjectAtributes(e,t,n){try{for(var r=e.attributes.length,i=0;i<r;i++){var s=e.attributes[i];s.specified&&"id"!=s.name&&("style"==s.name?t.style.cssText=e.style.cssText:"class"==s.name?t.className=s.value:t.setAttribute(s.name,s.value))}1==n&&(t.innerHTML=e.innerHTML)}catch(o){}}function setCopyAllObjectAtributesForInput(e,t,n){try{for(var r=e.attributes.length,i=0;i<r;i++){var s=e.attributes[i];s.specified&&"type"!=name&&("style"==s.name?t.style.cssText=e.style.cssText:"type"!=s.name&&("class"==s.name?t.className=s.value:t.setAttribute(s.name,s.value)))}1==n&&(t.innerHTML=e.innerHTML)}catch(o){}}function getTopVerticalCells(e){var t=GetParentbyTagName(e,"table");if(GetParentbyTagName(e,"tr")){var n=[];e=getClientRect(e);for(var r=0;r<t.rows.length;r++)for(var i=t.rows[r],s=0;s<i.cells.length;s++){var o=i.cells[s],u=getClientRect(o);e.top>u.top&&(e.left==u.left?n.push(o):(e.top>=u.bottom||e.bottom<=u.top)&&.1<u.right-e.left&&.1<e.left-u.left&&n.push(o))}return n}}function getLeftHorizontalCells(e){var t=GetParentbyTagName(e,"table");if(GetParentbyTagName(e,"tr")){var n=[],r=[];e=getClientRect(e);for(var i=0;i<t.rows.length;i++)for(var s=t.rows[i],o=0;o<s.cells.length;o++){var u=s.cells[o],a=getClientRect(u);if(e.left>a.left&&(e.top==a.top||a.top<e.top&&a.bottom>e.top)){var f={};f.left=a.left,f.cell=u,r.push(f)}}r.sort(function(e,t){return e.left-t.left});for(i=0;i<r.length;i++)n.push(r[i].cell);return n}}function getHorizontalCells(e,t){var n=[],r=GetParentbyTagName(e,"table"),i=GetParentbyTagName(e,"tr");if(t)for(var s=0;s<r.rows.length;s++)for(var o=r.rows[s],u=0;u<o.cells.length;u++){var a=o.cells[u];i.rowIndex==o.rowIndex?n.push(a):1<a.rowSpan?i.rowIndex>o.rowIndex&&i.rowIndex<o.rowIndex+a.rowSpan?n.push(a):1<e.rowSpan&&(i.rowIndex>o.rowIndex&&i.rowIndex<o.rowIndex+a.rowSpan?n.push(a):i.rowIndex<o.rowIndex&&i.rowIndex+e.rowSpan>o.rowIndex&&n.push(a)):1<e.rowSpan&&i.rowIndex<o.rowIndex&&i.rowIndex+e.rowSpan>o.rowIndex&&n.push(a)}else n=i.cells;return n}function getCellSize(e){var t={height:0};if(e){var n=getClientRect(e),n=Math.round(n.bottom-n.top);if(parseIntOr0(e.style.height)>=n)return t.height=parseIntOr0(e.style.height),t;var r=parseIntOr0(e.style.paddingTop)+parseIntOr0(e.style.paddingBottom),i=0,s=GetParentbyTagName(e,"table"),o="collapse"==s.style.borderCollapse,u=getCellNearLeftTop(e,!0),a=function(e,t){var n=e.parentElement,r=t.parentElement;return n.rowIndex==r.rowIndex?0:n.rowIndex>r.rowIndex?1:-1},f=function(e,t){var n=e.parentElement,r=t.parentElement;if(1<e.rowSpan)return 1<t.rowSpan?n.rowIndex+e.rowSpan==r.rowIndex+t.rowSpan?0:n.rowIndex+e.rowSpan>r.rowIndex+t.rowSpan?1:-1:n.rowIndex+e.rowSpan==r.rowIndex+1?0:n.rowIndex+e.rowSpan>r.rowIndex+1?1:-1;if(1<t.rowSpan)return n.rowIndex+1==r.rowIndex+t.rowSpan?0:n.rowIndex+1>r.rowIndex+t.rowSpan?1:-1;if(n.rowIndex==r.rowIndex)return 0;if(n.rowIndex>r.rowIndex)return 1;if(n.rowIndex>r.rowIndex)return-1},l=0;if(u.arrTop[0]){if(o)for(var c=u.arrTop[0],h=getHorizontalCells(c,!0),p=0;p<h.length;p++)if(0===f(c,h[p]))var d=parseIntOr0(h[p].style.borderBottomWidth),l=l>d?l:d;h=getHorizontalCells(e),p=0}else{o&&(l=parseIntOr0(s.style.borderTopWidth));var h=getHorizontalCells(e),p=0}for(;p<h.length;p++)c=parseIntOr0(h[p].style.borderTopWidth),l=l>c?l:c;c=0;if(u.arrBottom[0]){h=getHorizontalCells(e,!0);for(p=0;p<h.length;p++)0===f(e,h[p])&&(d=parseIntOr0(h[p].style.borderBottomWidth),c=c>d?c:d);if(o)for(u=getHorizontalCells(u.arrBottom[0]),p=0;p<u.length;p++)h=parseIntOr0(u[p].style.borderTopWidth),c=c>h?c:h}else for(o&&(c=parseIntOr0(s.style.borderBottomWidth)),h=getHorizontalCells(e,!0),p=0;p<h.length;p++)0===f(e,h[p])&&(d=parseIntOr0(h[p].style.borderBottomWidth),c=c>d?c:d);h=u=0;if(1<parseIntOr0(e.rowSpan)){for(var d={},v={},m=getHorizontalCells(e,!0),p=0;p<m.length;p++){var g=m[p].parentElement.rowIndex;if(-1===a(e,m[p])){var y=parseIntOr0(m[p].style.borderTopWidth),b=parseIntOr0(m[p].style.paddingTop),w="posTop"+g;d[w]?(d[w]=d[w]>y?d[w]:y,v[w]=v[w]>b?v[w]:b):(d[w]=y,v[w]=b)}1===f(e,m[p])&&(y=parseIntOr0(m[p].style.borderBottomWidth),b=parseIntOr0(m[p].style.paddingBottom),w="pos"+(o?"Top"+(g+1):"Bottom"+g),d[w]?(d[w]=d[w]>y?d[w]:y,v[w]=v[w]>b?v[w]:b):(d[w]=y,v[w]=b))}for(w in d)u+=d[w],h+=v[w];o||(h+=parseIntOr0(s.style.borderSpacing))}o&&(l=Math.ceil(l/2),c=Math.floor(c/2)),i=i+l+c,i+=u,t.height=n-i-(r+h)}return t}function command_AddTableLeftAndRight(e,t,n){dext_src_init(e._EDITOR.design),restoreSelection(),setFocusToBody();var r=-1;e=-1;for(var i=t.currTableNode.rows.length,s=0;s<i;s++){for(var o=t.currTableNode.rows[s].cells.length,u=0;u<o;u++)if(t.currTableNode.rows[s].cells[u]==t.currCellNode){r=s,e=u;break}if(-1<r)break}if(-1<r&&-1<e){"right"==n&&(e+=1),r=0,i=[];for(s=0;s<t.tableNode.rows.length;s++)i.push(t.tableNode.rows[s].cells);for(s=i.length-1;0<=s;s--)for(o=i[s].length,u=o-1;0<=u;u--)0==s&&(r+=DEXTTOP.DEXT5.util.parseIntOr0(i[s][0].style.width)),o=t.currTableNode.rows[s],"right"==n&&0==!!o.cells[e]?o.appendChild(i[s][u]):o.insertBefore(i[s][u],o.cells[e]);n=t.currTableNode.style.width,-1<n.indexOf("px")&&(n=DEXTTOP.DEXT5.util.parseIntOr0(n),t.currTableNode.style.width=n+r+"px"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}function command_AddTableUpAndDown(e,t,n){dext_src_init(e._EDITOR.design),restoreSelection(),setFocusToBody(),e=-1;for(var r=t.currTableNode.rows.length,i=0;i<r;i++){for(var s=t.currTableNode.rows[i].cells.length,o=0;o<s;o++)if(t.currTableNode.rows[i].cells[o]==t.currCellNode){e=i;break}if(-1<e)break}if(-1<e){"down"==n&&(e+=1),r=t.tableNode.getElementsByTagName("tr");if("down"==n&&0==!!t.currTableNode.rows[e])for(;0<r.length;)t.currTableNode.rows[e-1].parentNode.appendChild(r[0]);else for(;0<r.length;)t.currTableNode.rows[e].parentNode.insertBefore(r[r.length-1],t.currTableNode.rows[e]);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}function dragMoveStart(e,t){if(!(t||"0"!=DEXTTOP.G_CURREDITOR._config.dragMove&&DEXTTOP.DEXT5.browser.chrome))return!0;var n=_iframeDoc.body.getAttribute("contenteditable");if(""!=n&&"true"!=n)return DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e),!1;Mouse_Status=0,n=getFirstRange(),n=n.range;if(t||!n.collapsed)return _iframeDoc.body.contentEditable="false",_iframeDoc.body.style.cursor="move",_iframeDoc.documentElement.style.cursor="move",hideResizeBar(),dragMove.dragStart=!0,t?(dragMove.dragTarget=t,n.selectNode(t)):dragMove.target=null,dragMove.dragRange=n,dragMove.dragData=n.toHtml(),createDragDummy(e),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"selectstart",dragMoveSelect),DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",dragStop),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",dragStop)):DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",dragMoving),DEXTTOP.DEXT5.util.addEvent(document,"mousemove",dragStop),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mousemove",dragStop),dragMove.bodyRect=_iframeDoc.body.getBoundingClientRect(),dragMove.dragCursorOffsetX=_iframeDoc.defaultView.frameElement.offsetLeft,dragMove.dragCursorOffsetY=_iframeDoc.defaultView.frameElement.offsetTop,DEXTTOP.DEXT5.browser.ie&&(dragMove.ieButton=1),DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e),!1}function dragMoveSelect(e){DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e)}function createDragDummy(e){DEXTTOP.DEXT5.browser.ie||(dragMove.dragDummyBack?dragMove.dragDummyBack.style.display="":(dragMove.dragDummyBack=document.createElement("div"),dragMove.dragDummyBack.id="drag_dummy_back",dragMove.dragDummyBack.style.position="absolute",dragMove.dragDummyBack.style.top="0px",dragMove.dragDummyBack.style.left="0px",dragMove.dragDummyBack.style.width="100%",dragMove.dragDummyBack.style.height="100%",dragMove.dragDummyBack.style.zIndex="10100",DEXTTOP.DEXT5.util.addEvent(dragMove.dragDummyBack,"mousemove",dragStop),dragMove.dragDummy=document.createElement("div"),dragMove.dragDummy.style.position="absolute",dragMove.dragDummy.style.border="0px solid black",dragMove.dragDummy.style.width="20px",dragMove.dragDummy.style.height="10px",dragMove.dragDummyBack.appendChild(dragMove.dragDummy),document.body.appendChild(dragMove.dragDummyBack)))}function createSelectionFromPoint(e,t){var n=_iframeDoc,r=null;"undefined"!=typeof n.caretPositionFromPoint?r=n.caretPositionFromPoint(e,t):"undefined"!=typeof n.caretRangeFromPoint&&(r=n.caretRangeFromPoint(e,t)),r&&dragMove.dragRange.containsNode(r.startContainer)&&(r=null);if(null!==r&&"undefined"!=typeof window.getSelection)n=getFirstRange().sel,n.removeAllRanges(),n.addRange(r);else if("undefined"!=typeof n.body.createTextRange){var i=n.body.createTextRange();try{var s=dragMove.bodyRect.left,o=dragMove.bodyRect.right,u=dragMove.bodyRect.top,a=n.body.lastElementChild.getBoundingClientRect().bottom;e<s?e=s+1:e>o&&(e=o-1),t<u?t=u+1:t>a&&(t=a-1),i.moveToPoint(e,t),i.select();var f=getFirstRange(),r=f.range;dragMove.dragRange.containsNode(r.startContainer)?(f.sel.removeAllRanges(),r=null):r.collapse(!1)}catch(l){}}return r}function dragMoving(e){if(dragMove.dragStart){var t=!0,n=e.target?e.target:e.srcElement;if(n==dragMove.dragDummyBack||n==dragMove.dragDummy){var r=_iframeWin.frameElement.getBoundingClientRect();dragMove.backX=r.left,dragMove.backY=r.top}else n.ownerDocument==_iframeDoc?(dragMove.backX=0,dragMove.backY=0):(dragMove.dragDummy&&(dragMove.dragDummy.style.display="none"),t=!1);r=e.clientX-dragMove.backX,e=e.clientY-dragMove.backY,dragMove.dragCaret&&dragMove.dragCaret.parentNode&&n!=dragMove.dragCaret.parentNode&&dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret);if(t=t&&createSelectionFromPoint(r,e))if(targetNode=t.startContainer,offset=t.startOffset,targetNode!=dragMove.dragCaret&&"html"!=targetNode.nodeName.toLowerCase()&&(3!=targetNode.nodeType||"false"!=targetNode.parentNode.getAttribute("contenteditable"))){if(targetNode&&3!=targetNode.nodeType&&targetNode.childNodes[offset]&&3==targetNode.childNodes[offset].nodeType&&targetNode.childNodes[offset].wholeText.charAt(0)==unescape("%uFEFF"))return;t.setStart(targetNode,offset),t.collapse(!1),null==dragMove.dragCaret&&(dragMove.dragCaret=_iframeDoc.createElement("span"),dragMove.dragCaret.style.display="inline-block",dragMove.dragCaret.style.width="0px",dragMove.dragCaret.style.height="1em",dragMove.dragCaret.style.borderLeft="1px solid black",dragMove.dragCaret.style.marginLeft="-0.5px"),t.insertNode(dragMove.dragCaret),t=targetNode.parentNode.childNodes;for(n=t.length-1;-1<n;n--){var i=t[n];3==i.nodeType&&""==i.nodeValue&&dragMove.dragRange.startContainer!=i&&dragMove.dragEndContainer!=i&&i.parentNode.removeChild(i)}}dragMove.dragCaret&&dragMove.dragCaret.parentNode?(dragMove.dragCaretValid=!0,_iframeDoc.body.style.cursor="move",_iframeDoc.documentElement.style.cursor="move"):(dragMove.dragCaretValid=!1,_iframeDoc.body.style.cursor="no-drop",_iframeDoc.documentElement.style.cursor="no-drop"),null!=dragMove.dragDummy&&(dragMove.dragDummy.style.left=r-10+dragMove.dragCursorOffsetX+"px",dragMove.dragDummy.style.top=e-5+dragMove.dragCursorOffsetY+"px",dragMove.dragDummy.style.display="")}}function dragEnd(e){if(DEXTTOP.DEXT5.browser.ie||dragMove.dragCaret&&dragMove.dragCaret.parentNode){var t=getFirstRange();e=t.sel;var n=t.range;if((DEXTTOP.DEXT5.browser.ie||!n.containsNode(dragMove.dragCaret))&&dragMove.dragCaret&&dragMove.dragCaretValid){dragMove.dragTarget?(n.selectNode(dragMove.dragTarget),n.deleteContents(),n.collapseBefore(dragMove.dragCaret),dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret)):(dragMove.dragRange.deleteContents(),n.deleteContents(),dragMove.dragCaret.parentNode&&(n.collapseAfter(dragMove.dragCaret),dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret))),dragMove.dragCaret=null,e.focusNode.parentNode&&(t=e.focusNode.parentNode,t.nextSibling&&""==t.nextSibling.innerHTML&&t.nextSibling.parentNode&&t.nextSibling.parentNode.removeChild(t.nextSibling),""==t.innerHTML&&t.parentNode&&t.parentNode.removeChild(t)),dragMove.dragData=dragMove.dragData.replace(/<p><\/p>/gi,""),e.removeAllRanges(),e.addRange(n);var r='<span name="raon_drag_mark"></span>'+dragMove.dragData+'<span name="raon_drag_mark"></span>';pasteHtmlAtCaretHuge(r,!1,!0,!1,!0),t=_iframeDoc.getElementsByName("raon_drag_mark");if(1<t.length)if(DEXTTOP.DEXT5.browser.ie){if(-1<r.indexOf("<table"))try{var i=t[0].parentNode.nextSibling.rows[0].cells[0],i=i.childNodes[0]||i;n.setStart(i,0)}catch(s){}else n.setStartBefore(t[1]);n.collapse(!0)}else i=_iframeDoc.createTextNode(""),t[0].parentNode.insertBefore(i,t[0]),n.setStart(i,0),dragMove.dragEndContainer=_iframeDoc.createTextNode(""),t[1].parentNode.insertBefore(dragMove.dragEndContainer,t[1]),n.setEnd(dragMove.dragEndContainer,0);e.removeAllRanges(),e.addRange(n),_iframeDoc.body.focus();for(e=t.length-1;-1<e;e--)i=t[e].parentNode,i.removeChild(t[e]),(0==i.childNodes.length||1==i.childNodes.length&&3==i.childNodes[0].nodeType&&""==i.childNodes[0].nodeValue&&i.parentNode)&&i.parentNode.removeChild(i);DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}}function dragStop(e){0==dragMove.ieButton&&1!=e.buttons?(_iframeDoc.body.contentEditable="true",_iframeDoc.body.style.cursor="",_iframeDoc.documentElement.style.cursor="",dragEnd(e),dragMove.dragStart=!1,dragMove.dragDummy&&(dragMove.dragDummyBack.style.display="none",dragMove.dragDummy.style.display="none",DEXTTOP.DEXT5.util.removeEvent(dragMove.dragDummyBack,"mousemove",dragStop)),dragMove.dragCaret&&dragMove.dragCaret.parentNode&&dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"selectstart",dragMoveSelect),DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"mousemove",dragStop),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"mouseup",dragStop)):DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"mousemove",dragMoving),DEXTTOP.DEXT5.util.removeEvent(document,"mousemove",dragStop),DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mousemove",dragStop)):(DEXTTOP.DEXT5.browser.ie&&(dragMove.ieButton=0),dragMoving(e))}function isSameRect(e,t,n){var r=!1,i=1;return"number"==typeof n&&(i=n+.99),Math.abs(e-t)<i&&(r=!0),r}function splitTable(e,t){for(var n={table1:null,table2:null},r=e.parentNode,i=r.cells,s=i.length,o=!0,u=getClientRect(t),a=0;a<s;a++){var f=i[a],l=getClientRect(f);if(0==a){var f=DEXTTOP.DEXT5.util.parseIntOr0(f.style.borderLeftWidth),c=DEXTTOP.DEXT5.util.parseIntOr0(t.style.borderLeftWidth),f=Math.abs((f-c)/2+1);if(Math.abs(l.left-u.left)>f){o=!1;break}}else{c=getClientRect(i[a-1]);if(0==isSameRect(l.top,c.top)){o=!1;break}if(0==isSameRect(l.left,c.right)){o=!1;break}if(a==s-1&&(f=DEXTTOP.DEXT5.util.parseIntOr0(f.style.borderRightWidth),c=DEXTTOP.DEXT5.util.parseIntOr0(t.style.borderRightWidth),f=Math.abs((f-c)/2+1),Math.abs(l.right-u.right)>f)){o=!1;break}}}if(o)if(0==r.rowIndex)n.table1=null,n.table2=t;else{i=t.rows,o=i.length,s=t.cloneNode(),u=t.getElementsByTagName("colgroup"),l=u.length;for(a=0;a<l;a++)f=u[a].cloneNode(!0),s.appendChild(f);u=(a=t.getElementsByTagName("tbody")[0])?a.cloneNode():_iframeDoc.createElement("tbody"),l=[];for(a=o-1;0<=a&&(o=i[a],l.push(o.cloneNode(!0)),o.parentNode.removeChild(o),o!=r);a--);for(a=l.length-1;0<=a;a--)u.appendChild(l[a]);s.appendChild(u),t.nextSibling?t.parentNode.insertBefore(s,t.nextSibling):t.parentNode.appendChild(s),n.table1=t,n.table2=s}return n}function removeEmptyStyleTag(e){try{if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion){var t=new RegExp("(<"+e.tagName+" [^>]*>)","i");t.test(e.outerHTML);var n=RegExp.$1,t=/style="[^"](.*)"/i;t.test(n)||removeAttribute(e,"style")}}catch(r){}}function setTopMenu(e,t,n,r){DEXTTOP.G_CURREDITOR=t,DEXT5_TOPMENU.show(e,t.ID,n,r)}function hideTopMenu(){DEXT5_TOPMENU.hide()}function hideTopMenuAndFocus(){DEXT5_TOPMENU.hide_focus()}function between(e,t,n){result=!1,e<n&&t>e&&t<n&&(result=!0),e>n&&t>n&&t<e&&(result=!0);if(t==e||t==n)result=!0;return result}function point_in_rectagnle(e,t,n,r,i,s){return result=!1,between(n,e,i)&&between(r,t,s)&&(result=!0),result}function DextResize(e){resizebar_props&&(resizebar_props.editor=e,resizebar_props.editorMinTop=parseInt(e._config.style.defaultMinHeight))}function dextResizeMouseDownEvt(e){try{DextResize.prototype.mouseDown(e)}catch(t){}}function dextResizeMouseMoveEvt(e){try{DextResize.prototype.mouseMove(e)}catch(t){}}function dextResizeMouseUpEvt(e){try{DextResize.prototype.mouseUp(e)}catch(t){}}function dextResizeBlurEvt(e){try{DextResize.prototype.blur(e)}catch(t){}}function setFormControlSelected(e){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var t=["INPUT","TEXTAREA","SELECT","BUTTON"],n=t.length,r=!1;if(e&&1==e.nodeType)for(var i=0;i<n;i++)if(e.tagName==t[i]){r=!0;break}if(0==r)clearAllFormControlSelected();else{rangy.getSelection(_iframeWin).removeAllRanges();for(var s=[],o=_iframeDoc.body,i=0;i<n;i++)for(var u=o.getElementsByTagName(t[i]),a=u.length,f=0;f<a;f++)u[f].className!=g_d5selectedCName&&u[f].className!=g_d5selectedFocusCName||e==u[f]||s.push(u[f]);if(r)if(e.className==g_d5selectedCName)d5RemoveSelectedClassName(e,g_d5selectedCName);else if(e.className==g_d5selectedFocusCName)d5RemoveSelectedClassName(e,g_d5selectedFocusCName),0<s.length&&(s[0].className=g_d5selectedFocusCName);else for(d5AddSelectedClassName(e,g_d5selectedFocusCName),e=s.length,i=0;i<e;i++)d5RemoveSelectedClassName(s[i],g_d5selectedFocusCName),d5AddSelectedClassName(s[i],g_d5selectedCName)}}}function getFormControlSelectedItem(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){for(var e={count:0,arrNodes:[]},t=["INPUT","TEXTAREA","SELECT","BUTTON"],n=t.length,r=_iframeDoc.body,i=0;i<n;i++)for(var s=r.getElementsByTagName(t[i]),o=s.length,u=0;u<o;u++)if(s[u].className==g_d5selectedCName||s[u].className==g_d5selectedFocusCName)e.count+=1,e.arrNodes.push(s[u]);return e}}function clearAllFormControlSelected(e){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var t=_iframeDoc;e&&(t=e),e=["INPUT","TEXTAREA","SELECT","BUTTON"];for(var n=e.length,t=t.body,r=0;r<n;r++)for(var i=t.getElementsByTagName(e[r]),s=i.length,o=0;o<s;o++)if(i[o].className==g_d5selectedCName||i[o].className==g_d5selectedFocusCName)d5RemoveSelectedClassName(i[o],g_d5selectedCName),d5RemoveSelectedClassName(i[o],g_d5selectedFocusCName)}}function d5AddSelectedClassName(e,t){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var n=e.className,r="";if(0<n.length){for(var n=n.split(" "),i=n.length,s=0;s<i;s++)t!=n[s]&&(r+=n[s]+" ");r+=t}else r=t;e.className=r}}function d5RemoveSelectedClassName(e,t){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var n=e.className,r="";if(0<n.length)for(var n=n.split(" "),i=n.length,s=0;s<i;s++)n[s]!=t&&(r=s<i-1?r+(n[s]+" "):r+n[s]);else r="";e.className=r}}function d5ApplyAlignLeft(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var e=getFormControlSelectedItem();if(!(1>=e.count)){for(var t=null,n=0;n<e.count;n++)if(e.arrNodes[n].className==g_d5selectedFocusCName){t=e.arrNodes[n];break}if(t)for(n=0;n<e.count;n++)e.arrNodes[n]!=t&&(e.arrNodes[n].style.left=getClientRect(t).left+"px")}}}function d5ApplySameWidth(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var e=getFormControlSelectedItem();if(!(1>=e.count)){for(var t=null,n=0;n<e.count;n++)if(e.arrNodes[n].className==g_d5selectedFocusCName){t=e.arrNodes[n];break}if(t)for(t=""==t.style.width?getClientRect(t).right-getClientRect(t).left+"px":t.style.width,n=0;n<e.count;n++)e.arrNodes[n].style.width=t}}}function d5ApplySameHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var e=getFormControlSelectedItem();if(!(1>=e.count)){for(var t=null,n=0;n<e.count;n++)if(e.arrNodes[n].className==g_d5selectedFocusCName){t=e.arrNodes[n];break}if(t)for(t=""==t.style.height?getClientRect(t).bottom-getClientRect(t).top+"px":t.style.height,n=0;n<e.count;n++)e.arrNodes[n].style.height=t}}}function d5ApplySameWidthHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var e=getFormControlSelectedItem();if(!(1>=e.count)){for(var t=null,n=0;n<e.count;n++)if(e.arrNodes[n].className==g_d5selectedFocusCName){t=e.arrNodes[n];break}if(t)for(var r=""==t.style.width?getClientRect(t).right-getClientRect(t).left+"px":t.style.width,t=""==t.style.height?getClientRect(t).bottom-getClientRect(t).top+"px":t.style.height,n=0;n<e.count;n++)e.arrNodes[n].style.width=r,e.arrNodes[n].style.height=t}}}function getRangeCorrectly(e,t){var n=[];try{for(var r=t.startContainer,i=t.endContainer,s=e.length,o=!1,u=0;u<s;u++)o=!1,0==u&&1<s?3==r.nodeType&&t.startOffset==r.length&&(o=!0):u==s-1&&1<s&&3==i.nodeType&&0==t.endOffset&&(o=!0),0==o&&n.push(e[u])}catch(a){return e}return n}function convertRgbToHex(e){return"black"==e.toLowerCase()?"#000000":e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(e,t,n,r){e=[t,n,r];for(t=0;3>t;t++)e[t]=("0"+parseInt(e[t],10).toString(16)).slice(-2);return"#"+e.join("")})}function getChildToArray(e){var t=[];e=e.childNodes;for(var n=0,r=e.length;n<r;n++)t.push(e[n]);return t}function checkSameParent(e){var t=null,n=!1;e&&e[0].parentNode&&"span"==e[0].parentNode.nodeName.toLowerCase()&&(n=!0);if(n)for(var r=0,i=e.length;r<i;++r){if(t&&t!=e[r].parentNode){n=!1;break}t=e[r].parentNode}if(n)for(var s=t.childNodes,r=0,i=s.length;r<i;++r)if((1!=s[r].nodeType||"br"!=s[r].nodeName.toLowerCase())&&-1==e.indexOf(s[r])){n=!1;break}return n?(e=[],e.push(t),e):null}var G_ICON_FULL_SET="new save save_as print undo redo copy cut paste text_paste find replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail full_screen bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height line_height_inc line_height_dec indent outdent list_number list_bullets detail_list_number detail_list_bullets top_design top_source top_preview top_text design source preview text formatting font_family font_size font_size_inc font_size_dec about select_all insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom template grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent load_auto_save ruler pagebreak layout dirltr dirrtl insert_file file_open format_painter apply_format letter_spacing letter_spacing_inc letter_spacing_dec image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property help tool_bar_grouping list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property shortcut detail_font_color detail_font_bg_color detail_cell_bg_color table_border insert_layer element_position order_of_objects order_of_objects_detail insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator zoom zoom_plus zoom_minus mini_photo_editor placeholder paragraph_attribute table_adjust insert_table_top_paragraph insert_table_bottom_paragraph clean_nested_tag body_fit hyperlink_open manually_temp_save status_source status_preview status_text save_as_image filelink_open".split(" "),G_ICON_READONLY_ACTIVATION_SET="save print find full_screen help about".split(" "),G_ICON_CUSTOM_ADD_DISABLED_SET=[],G_FORMATTING=" h1 h2 h3 h4 h5".split(" "),DEXTTOP=parent;try{DEXTTOP.IsCrossDomain=!1}catch(e$$4){alert("cross domain error")}setDEXTWINwindow(),setDEXTDOCdocument(),DEXTTOP.G_SELECTED_ELEMENT=null,DEXTTOP.G_CURREDITOR=null,DEXTTOP.G_COPIEDTABLE=null,DEXTTOP.G_COPIEDCELLDATA=null;var G_CURSOR_ELEMENT=DEXTTOP.G_SELECTED_IMAGE_ELEMENT=null,G_dextResize_Elem_Flag=!1;DEXTTOP.DEXT5=parent.DEXT5,parent.DEXTTOP=DEXTTOP;var G_dext5plugIn=null,G_dialogHelper=null,G_SUB_DIALOG=null,G_CURRENT_IFRAME=null,G_CURRENT_IFRAME_HOLDER=null,G_USE_EDITOR_ID=null,G_LAST_CMD=null,G_MAIN_ZINDEX=1e4,G_PutUndoCharCount=20,G_Progress_LoadTime=100,G_TIMEOUT_CNT=0,G_ShortCutClose=!1,G_ShortCutClick=!1,xmlHttpReqeust_Config,SIL=[],Z=[],___=DEXTTOP.DEXTWIN.location,_0_,_1_,_7_;DEXTTOP.DEXT5.util.overrideFn(window);var G_BASE_COLOR_PICKER="#ffffff #f7f7f7 #e2e2e2 #c2c2c2 #9c9c9c #858585 #404040 #272727 #000000 #ffb39b #ffd4a7 #fff599 #c5dd9c #7ec89d #85ddff #87c5ff #bd8fbf #f69fc1 #ff0000 #ff9c23 #f4d400 #7bb423 #00a350 #00afef #0076c8 #93338f #f02c8c #9f190d #a46206 #a79a00 #568228 #007036 #0077a4 #0000ff #63155f #a01a5c".split(" "),_R_O_="c",R=[],T=[],K__="zu",C1=[],C2=[],ALS=[],S1=[],S2=[],M1="UklFbHVkbUZzYVdRZ1VISnZaSFZqZENCTFpYa3VJQT09",M2="UklFeHBZMlZ1YzJVZ1JYaHdhWEpsWkM0Zw==",M3="UklFbHVkbUZzYVdRZ1JHOXRZV2x1TGlBPQ==",M4="UklFbHVkbUZzYVdRZ1ZVa2dUVzlrZFd4bElFeHBZMlZ1YzJVdUlBPT0=",M5="UklFbHVkbUZzYVdRZ1UzQmxiR3dnUTJobFkydGxjaUJNYVdObGJuTmxMZz09",G_DEPlugin={},G_SC="",G_KeydownNode=null,G_BODY_DEFAULT_VALUE="";SIL[0]="t",K__+="vw",K__+="CDE",DEXT5_EDITOR.prototype={_Design2Source:function(){var e="table tbody tr td th ol ul li div".split(" ");if("0"==this._config.sourceViewtype||"3"==this._config.sourceViewtype)e=[];var t="";removeFakeLineHeight(this._BODY),setMatchSelectedValue(this._BODY),setMatchInputValue(this._BODY),adjustInputNodeForFF(this._DOC,!1),setEmptyTagWhiteSpace(this);if("1"==this._config.keepOriginalHtml)t=this._BODY.innerHTML;else if(this._BODY.hasChildNodes())for(var n=this._BODY.childNodes.length,r=0;r<n;r++){var i=this._BODY.childNodes[r];if(i)if(1===i.nodeType){var s=i.tagName.toLowerCase(),o=i.outerHTML;if("script"==s)o=o.replace(/<script([^>]+?)>[\s]+/gi,"<script$1>\r\n"),o=o.replace(/\;[\s]+/gi,";\r\n");else if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)o=removeCRLFChar(o);if("table"==s||"ol"==s||"ul"==s||"dextmark"==s)t+=o;else{if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"p"==s&&""==(i.innerText||i.textContent))for(;i="(<span[^>]*>)(?:\\s|<br>|<br />|  | |)(</span>)","0"==this._config.removeEmptyTagReplaceDefaultParagraphValue&&(i="(<span[^>]*>)(?:\\s|  | |)(</span>)"),i=new RegExp(i,"gim"),o=o.replace(i,"$1"+unescape("%u200B")+"</span>"),0!=i.test(o););t+=(""!=t?"\r\n":"")+o}}else{o=i.nodeValue;if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)o="#comment"!=i.nodeName?removeCRLFChar(o):"0"==this._config.removeComment?void 0!=i.data?"<!--"+i.data+"-->":void 0!=i.nodeValue?"<!--"+i.nodeValue+"-->":"":"";t+=(""!=t?"\r\n":"")+o}else if(t=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)t=removeCRLFChar(t)}else if(t=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)t=removeCRLFChar(t);t=replaceLineBreak(this,t),"0"==this._config.applyStyleEmptyTag&&(t=RemoveUnnecessaryChar(t),t=CleanZeroChar(t)),"1"==this._config.sourceViewtypeEmptyTagMode&&(t=DEXTTOP.DEXT5.util.replaceBrOrSpaceToNbspString(t,"p")),"0"==this._config.keepOriginalHtml&&(t=t.replace(/\t/g,"")),"3"==this._config.sourceViewtype&&(t=DEXTTOP.DEXT5.util.pretty.html(t,{indent_with_tabs:!0,unformatted:this._config.sourceViewtype_unformatted})),n="";if("0"==this._config.keepOriginalHtml)for(r=0,o=e.length;r<o;r++)n=e[r],i=new RegExp("(<"+n+"(\"[^\"]*\"|'[^']*'|[^'\">])*>)","gi"),s=new RegExp("</"+n+">","ig"),"tbody"==n?(t=t.replace(i,function(e,t){return"\r\n	"+t+"\r\n"}),t=t.replace(s,"\r\n	</"+n+">")):"li"==n?t=t.replace(i,function(e,t){return"\r\n	"+t}):"tr"==n?(t=t.replace(i,function(e,t){return"\r\n		"+t+""}),t=t.replace(s,"\r\n		</"+n+">")):"td"==n||"th"==n?(t=t.replace(i,function(e,t){return"\r\n			"+t+"\r\n				"}),t=t.replace(s,"\r\n			</"+n+">")):"table"==n||"ol"==n||"ul"==n?(t=t.replace(i,function(e,t){return"\r\n"+t+""}),t=t.replace(s,"\r\n</"+n+">\r\n")):t=t.replace(i,function(e,t){return"\r\n"+t+""});t=changeRealTagToReplaceString(t),"0"==this._config.keepOriginalHtml&&(t=DEXTTOP.DEXT5.browser.ie&&9<=DEXTTOP.DEXT5.browser.ieVersion?t.replace(/\r?\n?\r?\n/g,"\r\n"):t.replace(/\r?\n?\r?\n/g,"\n")),t=changeReplaceStringToRealTag(t),t=DEXTTOP.DEXT5.util.trim(t),"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(t=DEXTTOP.DEXT5.util.ImageSrcConvert(t,!0,DEXTTOP.G_CURREDITOR.ID)),"1"==DEXTTOP.G_CURREDITOR._config.xhtml_value&&(t=DEXTTOP.DEXT5.util.html2xhtml(t)),this._EDITOR.source.value=t,e=this._EDITOR.source,e.focus(),"setSelectionRange"in e?e.setSelectionRange(0,0):"createTextRange"in e&&e.createTextRange().moveStart("character",0)},_Design2Preview:function(){changeBodyImageProperty(!0),setHtmlToPreview(),setFocusTopWindow()},_Design2Text:function(){for(var e=["style","title"],t=e.length,n=0;n<t;n++)for(var r=this._BODY.getElementsByTagName(e[n]),i=r.length-1;0<=i;i--)r[i].parentNode.removeChild(r[i]);e=this._BODY.innerHTML,e=e.replace(/\r/g,""),e=e.replace(/[\n|\t]/g,""),e=e.replace(/[\v|\f]/g,""),e=e.replace(/<p><br><\/p>/gi,"\n"),e=e.replace(/<P>&nbsp;<\/P>/gi,"\n"),e=e.replace(/<br(\s)*\/?>/gi,"\n"),e=e.replace(/<br(\s[^\/]*)?>/gi,"\n"),e=e.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),e=e.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),e=e.replace(/<\/tr(\s[^\/]*)?>/gi,"\n"),e=e.replace(/<\/h[1-5](\s[^\/]*)?>/gi,"\n"),nIdx=e.lastIndexOf("\n"),-1<nIdx&&"\n"==e.substring(nIdx)&&(e=e.substring(0,nIdx)),e=removeStripTags(e,null),e=unhtmlSpecialChars(e),this._EDITOR.text.value=e,e=this._EDITOR.text;try{e.focus()}catch(s){}},getEditorMode:function(){return this._currentMode},setChangeMode:function(e){clearAllFormControlSelected();var t=this.getEditorMode();if(t!=e)if(this._newMode=e,"1"!=this._config.formMode&&"0"!=this._config.userTableLock.use&&IsExistTableLock(this)&&"0"==this._config.userTableLock.allowChangeMode&&(-1<e.indexOf("text")||-1<e.indexOf("source")))alert(dext5_lang.msg.notChangeMode);else{"1"==this._config.useSelectionMark&&(-1<t.indexOf("design")&&-1<e.indexOf("source")?makeRangeSelectionMarkInDesign():-1<t.indexOf("source")&&-1<e.indexOf("design")&&makeRangeSelectionMarkInSource(this._EDITOR.source));var n=!0;("top_text"==e||"text"==e)&&DEXTTOP.DEXT5.ShowTextChangeAlert&&(n=confirm(dext5_lang.msg.changeTextMode));if(n){var n=this._setting.word_break_type,r=this._setting.word_wrap_type;if(null==this._EDITOR.preview){var i=document.getElementById("ue_editor_holder_"+this.ID),n=createEditorIframe(this._config,i,"dext5_preview_"+this.ID,dext5_lang.iframe_title.preview,this._docType[this._setting.doctype],this._setting.encoding,this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height,n,r);n.style.width="0px",n.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(n.style.display="none"),this._EDITOR.preview=document.getElementById("dext5_preview_"+this.ID)}ClearDraggingTableCellSelected(),Mouse_Status=Mouse_IsPlain,g_findRepalceRange=ActiveCurrTable=DrageStartCell=null,this._iconSelected();for(var i=null,s=["top_design","top_source","top_preview","top_text"],n=0,r=s.length;n<r;n++)i=document.getElementById("ue_"+this.ID+s[n]),null!=i&&((0>e.indexOf("top_")?"top_"+e:e)==s[n]?i.className="on":i.className="");var o=null,s=null,i=["design","source","preview","text"];e=e.replace("top_",""),"design"!=e&&this._iconEnable("allDisable"),n=0;for(r=i.length;n<r;n++)if(o=document.getElementById("ue_"+this.ID+i[n]),s=document.getElementById("dext5_"+i[n]+"_"+this.ID),null!=o||-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_")){if(e==i[n]){null!=o&&(o.className=this._config.style.skinName,o.getElementsByTagName("A")[0].className="color_on",o.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)");if("source"==e||"text"==e){try{s.focus()}catch(u){}o=this._defaultHeight,DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks?o-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(o-=3),s.style.height=o+"px",s.height=o+"px"}else s.style.height="100%";s.style.width="100%",DEXTTOP.DEXT5.browser.gecko||(s.style.display="",s.style.overflow=""),"design"==e&&(this._LastRange=null,setFocusToBody())}else null!=o&&(o.className="",o.getElementsByTagName("A")[0].className="",o.style.backgroundImage=""),s.style.width="0px",s.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(s.style.display="none",s.style.overflow="hidden"),s.blur();s=document.getElementById("ue_diabled_div_"+this.ID),"BackCompat"==document.compatMode&&(s.style.height=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollHeight+"px"),document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative","design"==e?-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_")?"1"==this._config.top_menu||isViewMode(this)||(s=document.getElementById("ue_top_menu_diabled_div_"+this.ID),s.style.width="0px"):s.style.width="0px":-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_")?"1"==this._config.top_menu||isViewMode(this)||(s=document.getElementById("ue_top_menu_diabled_div_"+this.ID),s.style.width=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollWidth+"px"):s.style.width=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollWidth+"px",s=document.getElementById("dext_ruler_vertical_disabled_"+this.ID),null!=s&&(s.style.display="design"==e?"":"block")}getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),"design"==t&&"design"!=e&&DEXTTOP.G_CURREDITOR.ShowTableBorder&&command_showTableBorder(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);var a=this,n=function(e){null!=a._config.zoomList&&(e?(document.getElementById("zoom_"+a.ID+"_holder").style.display="","1"==a._config.wordCount.use&&(document.getElementById("word_count_"+a.ID+"_holder").style.textAlign="")):(document.getElementById("zoom_"+a.ID+"_holder").style.display="none","1"==a._config.wordCount.use&&(document.getElementById("word_count_"+a.ID+"_holder").style.textAlign="right")))};"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose());try{for(var f in G_DEPlugin)"function"==typeof G_DEPlugin[f].onLoaded&&G_DEPlugin[f].onBeforeEditorChangeMode({currMode:t,newMode:e})}catch(l){}switch(t){case"design":setRemoveClass(["td","th"],["DEXT_dot"]);switch(e){case"source":ReplaceImageToRealObject(),"1"==this._config.formMode&&ReplaceCustomDataToRealEvent(),this._Design2Source(),n(!1);break;case"preview":ReplaceImageToRealObject(),"1"==this._config.formMode&&ReplaceCustomDataToRealEvent(),this._Design2Preview();break;case"text":this._Design2Text(),n(!1)}break;case"source":_value=this._EDITOR.source.value,"0"==this._config.keepOriginalHtml&&(_value=_value.replace(/\t/g,""),_value=removeCRLFChar(_value)),"1"!=DEXTTOP.G_CURREDITOR._config.plugInUse&&(_value=DEXTTOP.DEXT5.util.removeLocalFileImage(_value)),_value=xssReplaceScript(null,_value),"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(_value=DEXTTOP.DEXT5.util.ImageSrcConvert(_value,!1,DEXTTOP.G_CURREDITOR.ID));var c,h,p,d,v;"preview"==e&&"1"==this._config.tableAutoAdjustInSetHtml&&(c=document.getElementById("dext5_design_"+this.ID),h=c.style.width,p=c.style.height,c.style.width="100%",c.style.height="100%",DEXTTOP.DEXT5.browser.gecko||(d=c.style.display,v=c.style.overflow,c.style.display="",c.style.overflow="")),DEXTTOP.DEXT5.setBodyValue(_value,"",!0,!0),"preview"==e&&"1"==this._config.tableAutoAdjustInSetHtml&&(c.style.width=h,c.style.height=p,DEXTTOP.DEXT5.browser.gecko||(c.style.display=d,c.style.overflow=v)),c=this.Frame,showRuler(c.editor);switch(e){case"design":n(!0),"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage(),setAddClass(["td","th"],["DEXT_dot"]);break;case"preview":ReplaceImageToRealObject(),"1"==this._config.formMode&&ReplaceCustomDataToRealEvent(),setRemoveClass(["td","th"],["DEXT_dot"]),this._Design2Preview(),n(!0);break;case"text":this._Design2Text()}break;case"preview":c=this.Frame,showRuler(c.editor),ClearPreViewContent(c.editor);switch(e){case"design":FixFlashError(),"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage(),setAddClass(["td","th"],["DEXT_dot"]);try{this._iconEnable(""),setFocusToBody(),setFocusChildForStyle(this._BODY)}catch(m){}break;case"source":this._Design2Source(),n(!1);break;case"text":this._Design2Text(),n(!1)}break;case"text":switch(_value=this._EDITOR.text.value,_value=htmlSpecialChars(_value),_value=addLineBreaker(this._config.enterTag,_value),DEXTTOP.DEXT5.setBodyValue(_value,"",!0,!0,!0),c=this.Frame,showRuler(c.editor),e){case"design":n(!0);break;case"source":this._Design2Source();break;case"preview":this._Design2Preview(),n(!0)}}this._currentMode=e,null!=a._config.zoomList&&command_zoom(a.ID),"1"==this._config.useSelectionMark&&(-1<t.indexOf("design")&&-1<e.indexOf("source")?setRangeSelectionMarkInSource(this._EDITOR.source):-1<t.indexOf("source")&&-1<e.indexOf("design")&&setRangeSelectionMarkInDesign());if(-1<e.indexOf("design")){setFocusChildForStyle(DEXTTOP.G_CURREDITOR._BODY);try{contentChangeEventWrapper()}catch(g){}"2"==DEXTTOP.G_CURREDITOR._config.undoMode&&(DEXTTOP.G_CURREDITOR.UndoManager.reset(),"2"==DEXTTOP.G_CURREDITOR._config.undoMode&&setTimeout(function(){DEXTTOP.G_CURREDITOR.UndoManager.putUndo(!0)},1))}-1==e.indexOf("source")&&"1"==this._config.autoBodyFit&&setBodyFitStyle(this,!0);try{for(f in G_DEPlugin)"function"==typeof G_DEPlugin[f].onLoaded&&G_DEPlugin[f].onAfterEditorChangeMode({currMode:t,newMode:e})}catch(y){}setTimeout(function(){try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterChangeMode?DEXTTOP.G_CURREDITOR._config.event.afterChangeMode(e,t,DEXTTOP.G_CURREDITOR.ID):DEXTTOP.DEXTWIN.dext_editor_afterchangemode_event(e,t,DEXTTOP.G_CURREDITOR.ID)}catch(n){}},100)}(-1<this._config.toolBar1.indexOf("status_"+e)||-1<this._config.toolBar2.indexOf("status_"+e))&&this._statusToolBarIconSelect(a.ID,"status_"+e),"design"!=e&&(-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_"))&&this._topMenuDisbleCheck(),onChange({editor:DEXTTOP.G_CURREDITOR})}},start:function(){var e=this._config;if("1"==e.autoMoveInitFocus.use){this.autoMoveInitFocusData.targetDocument=document,e.autoMoveInitFocus.targetWindow&&(this.autoMoveInitFocusData.targetDocument=e.autoMoveInitFocus.targetWindow.document,e.autoMoveInitFocus.targetWindow=null);var t=this.autoMoveInitFocusData.targetDocument.activeElement;t&&(this.autoMoveInitFocusData.targetNode=t)}for(var n=e.toolBar1.length,r=e.toolBar2.length,i=[],n=e.toolBar1.length,r=e.toolBar2.length,s=0;s<n;s++)t=e.toolBar1[s],0==t.indexOf("p_")&&(t=t.split("_"),i.push(t[1]));for(n=0;n<r;n++)t=e.toolBar2[n],0==t.indexOf("p_")&&(t=t.split("_"),i.push(t[1]));r=0;for(n=e.pluginToolExArr.length;r<n;r++)t=e.pluginToolExArr[r],i.push(t);var o=i.length,u=0,a=function(){loadPluginJs(i[u],function(){u++,u<o?a():_dext_editor._setEditorIcon()})};0<o?a():_dext_editor._setEditorIcon()},_setEditorIcon:function(){var e=_dext_editor,t=e._config.style.skinName,n=e._config.webPath.image+"skin/"+t,r=e._config.toolBar1,i=e._config.toolBar2;e.____.p=e._config[R[28]+R[21]+R[18]+R[11]+"u"+R[17]+R[14]+String.fromCharCode(75)+R[12]+String.fromCharCode(121)],_7_=e._config[String.fromCharCode(76)+T[10]+R[17]+R[12]+T[11]+T[4]+String.fromCharCode(75)+T[2]+T[7]],e.____.l=_L__.DE(_7_);try{e.____.l=e.____.l.split("|"),_0_=e.____.l,_1_=e.____.p}catch(s){}e._dextSetting();if("1"==e._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported){var o=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_personal_setting");o&&""!=o.fontFamily&&void 0!=o.fontFamily&&(this._setting.font_family=o.fontFamily),o&&""!=o.fontSize&&void 0!=o.fontSize&&(this._setting.font_size=o.fontSize),o&&""!=o.lineHeight&&void 0!=o.lineHeight&&(this._setting.line_height=o.lineHeight),o&&""!=o.pasteToImage&&void 0!=o.pasteToImage&&(e._config.pasteToImage=o.pasteToImage),o&&""!=o.pasteToImagePopupMode&&void 0!=o.pasteToImagePopupMode&&(e._config.pasteToImagePopupMode=o.pasteToImagePopupMode)}e.remove_item=e._config.removeItem,-1<e._config.disableInsertImage.indexOf(",image,")&&null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)&&e.remove_item.push("image_create"),!getApplyDragResize(e)&&(0==DEXTTOP.DEXT5.browser.ie||11<DEXTTOP.DEXT5.browser.ieVersion)&&e.remove_item.push("table_selection"),DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(e.remove_item.push("format_painter"),e.remove_item.push("apply_format")),e.remove_item.push("grid"),"1"==e._config.paste_image_base64_remove&&(e.remove_item.push("paste_to_image"),e.remove_item.push("paste_to_image_detail")),e.remove_context_item=e._config.removeContextItem,(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)&&e.remove_item.push("full_screen"),DEXTTOP.DEXTWIN!=top&&"1"!=DEXTTOP.G_CURREDITOR._config.frameFullScreen&&e.remove_item.push("full_screen");if(""!=e._config.xss_remove_tags){var o=e._config.xss_remove_tags.toLowerCase(),u=0;-1<o.indexOf("iframe")&&(e.remove_item.push("iframe_create"),e.remove_item.push("insert_link_media"),u+=1);if(-1<o.indexOf("object")||-1<o.indexOf("embed"))e.remove_item.push("media_create"),e.remove_item.push("flash_create"),u+=1;2<=u&&e.remove_item.push("entity")}"0"==e._setting.auto_save&&"1"!=e._config.setAutoSave.useManuallySave&&e.remove_item.push("load_auto_save"),"0"==e._config.setAutoSave.useManuallySave&&e.remove_item.push("manually_temp_save"),0==e._config.ruler.use&&e.remove_item.push("ruler");if(""!=e._config.custom_code&&(o=DEXTTOP.DEXT5.util.CustomSetting("remove_item",e._config.custom_code),"undefined"!=typeof o))for(var u=o.length,a=0;a<u;a++)e.remove_item.push(o[a]);"0"==e._config.useMiniImageEditor&&e.remove_item.push("mini_photo_editor"),"1"==e._config.plugInUse&&"1"==e._config.imageEditorUse&&0!=DEXTTOP.DEXT5.browser.ie||e.remove_item.push("image_editor"),("ieplugin"==e._config.runtimes||DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion)&&e.remove_item.push("photo_editor"),"1"!=e._config.formMode&&(e.remove_item.push("table_lock"),e.remove_item.push("cell_lock"),e.remove_item.push("table_lock_property")),"1"!=e._config.plugInUse&&(e.remove_item.push("word_transform"),e.remove_item.push("save_as"));if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion||"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&DEXTTOP.DEXT5.browser.safari)e.remove_item.push("video"),e.remove_item.push("placeholder");if(!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion)e.remove_item.push("spell_check"),e.remove_item.push("text_paste");(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&10>DEXTTOP.DEXT5.browser.ieVersion&&"1"!=e._config.plugInUse)&&e.remove_item.push("save_as_image");var u=a="",f=isViewMode(e),u=u+('<div id="ue_editor_main_'+e.ID+'" class="DEXT_fiVe_EdiTor" style="z-index:'+G_MAIN_ZINDEX+'; width:100%; "  oncontextmenu="return false">'),o=e._config.statusBarItem.length;0==o&&(e._config.status_bar="1"),a="",a="1"==e._config.top_status_bar||f?a+"height:1px;":a+"height:28px;";if("1"==e._config.top_status_bar||f)a+="display:none;";""!=a&&(a=" style='"+a+"'");for(var u=u+("<div id='dext_topstatusbar_"+e.ID+"' class='ue_as DEXT_fiVe_EdiTor_TopStatusBar_"+t+"'"+a+">"),u=u+("    <ul class='"+t+"'>"),a=e._config.statusBarItem,l=0;l<a.length;l++){var c=a[l],c=DEXTTOP.DEXT5.util.trim(c).toLowerCase(),h="";e.getEditorMode()==c.replace("top_","")&&(h='class="on"'),u+=" <li "+h+' id="ue_'+e.ID+"top_"+c+'"><a href="javascript:void(0);">DEXT_Top_Status</a></li>'}u+="    </ul></div>",u+='<div onselectstart="return false;" id="ue_toolbar_'+e.ID+'" style="width:100%" class="ue_as">',a=e._makeEditorTopMenu(),u+=a,a="",DEXTTOP.DEXT5.browser.ie&&(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&(a="margin-bottom:-2px;"),u="3"==e._config.tool_bar||isViewMode(e)?u+('		<table id="dext_toolbar_'+e.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table" style="display:none; '+a+'">'):u+('		<table id="dext_toolbar_'+e.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table" style="'+a+'">'),u+="<caption><span class='blind'>Toolbar Area</span></caption>",u+="			<tr>",u="mono"==t?u+('				<td class="ue_tg_'+t+'" style="">'):u+('				<td class="ue_tg_'+t+'" style="background-image:url('+n+'/ue_tbg.gif);">'),u+='					<table id="table_gecko_'+e.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table01" ',u+=">",u+="<caption><span class='blind'>Toolbar Area - gecko</span></caption>",a=r.length,l=i.length,0==a&&0==l?e._config.tool_bar="3":0==a?e._config.tool_bar="1":0==l&&(e._config.tool_bar="2"),a=e._makeEditorIcon(r,"1"),u+=a,a=e._makeEditorIcon(i,"2"),u+=a,a=e._makeEditorFormBar(),u+=a;if("1"==e._config.ruler.use){var u=u+"<tr>",p=18;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(p+=1),u+='<td class="ue_tdb_'+t+'01" id="dext_tab_tool3_'+e.ID+'" style="border:0px; padding:0px; height:'+p+'px; background-image:url(../images/bg/ruler.gif); background-repeat:no-repeat; display:none; position:relative;">',p=this._setting.ruler_position.split(","),"2"!=e._config.ruler.mode&&(p=p.sort(function(e,t){return e-t})),this._setting.ruler_position=p.join(","),r=p.length,"2"==e._config.ruler.mode&&--r;for(a=0;a<r;a++)if("2"==e._config.ruler.mode)u=1==a?u+('<img id="dext_ruler_point_'+a+"_"+e.ID+'" src="../images/bg/point2.gif" title="'+dext5_lang.setting["ruler"+a+"_desc"]+'" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; top:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />'):u+('<img id="dext_ruler_point_'+a+"_"+e.ID+'" src="../images/bg/point3.gif" title="'+dext5_lang.setting["ruler"+a+"_desc"]+'" alt="" style="vertical-align:bottom; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; bottom:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />');else{if("1"==e._config.ruler.mode&&"1"==e._config.autoBodyFit&&a==r-1)break;u+='<img id="dext_ruler_point_'+a+"_"+e.ID+'" src="../images/bg/point.gif" title="'+dext5_lang.setting["ruler"+a+"_desc"]+'" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; top:-1px; z-index:'+(G_MAIN_ZINDEX+101)+';" />'}"2"==e._config.ruler.mode&&(u+='<div id="dext_ruler_area_0" style="background-color:#dddddd; background-color: rgba(0,0,0,0.18); filter:alpha(opacity=70); opacity:0.70; position:absolute; z-index:'+(G_MAIN_ZINDEX+100)+'; height:18px; position:absolute; width:10px; left:0px; top:0px;"></div>',r=DEXTTOP.DEXT5.util.parseIntOr0(p[2]),i=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXTWIN.document.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID).style.width)-r,u+='<div id="dext_ruler_area_1" style="background-color:#dddddd; background-color: rgba(0,0,0,0.18); filter:alpha(opacity=70); opacity:0.70; position:absolute; z-index:'+(G_MAIN_ZINDEX+100)+"; top:0px; height:18px; position:absolute; width:"+i+"px; left:"+r+'px;"></div>',"1"==e._config.ruler.useMouseGuide&&(u+='<div id="dext_ruler_mouse_guide_'+e.ID+'" class="ruler_mouse_guide" ></div>')),u+="</td>",u+="</tr>","2"==e._config.ruler.mode&&(u+="<tr>",u+='<td id="dext_tab_tool4_'+e.ID+'" style="border-top:1px solid #a1abb9; margin-top:-1px; padding:0px; height:6px; background-color:#ffffff; background-repeat:no-repeat; display:none; position:relative;">',u+='<img id="dext_ruler_point_3_'+e.ID+'" src="../images/bg/point_square.gif" title="'+dext5_lang.setting.ruler3_desc+'" alt="" style="vertical-align:bottom; border:0px; width:14px; height:7px; margin:0 0 0 -7; display:none; position:absolute; bottom:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />',u+="</td>",u+="</tr>")}u+="					</table>",u+="				</td>",u+="			</tr>",u+="		</table>",u+='	<div id="ue_diabled_div_'+e.ID+'" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+(G_MAIN_ZINDEX+1e3)+'; left:0px; top:0px; width:0px; height:100%;"></div>',"2"==e._config.ruler.mode&&(u+='	<div id="ue_ruler_back_div" style="background-color:#ffffff; filter:alpha(opacity=0); opacity:0; position:absolute; z-index:'+(G_MAIN_ZINDEX+100)+'; left:0px; top:0px; width:100%; height:100%; display:none;"></div>'),"1"==e._config.tool_bar_grouping&&(u+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box1" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',u+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+e._config.style.skinName+'" id="dext_tool_bar_grouping_list1">',u+='<ul id="ul_tool_bar_grouping_list1">',u+="</ul>",u+="</div>",u+="</div>",u+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box2" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',u+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+e._config.style.skinName+'" id="dext_tool_bar_grouping_list2">',u+='<ul id="ul_tool_bar_grouping_list2">',u+="</ul>",u+="</div>",u+="</div>"),u+="</div>","1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(u+='<div class="hyper_link_help_box" id="dext_div_hyper_link_help" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',u+='<div class="'+e._config.style.skinName+'">',u+='<p id="dext_div_hyper_link_help_content">',u+="</p>",u+='<p class="content">'+dext5_lang.hyperlink.open,u+="</p>",u+="</div>",u+="</div>");if("1"==e._config.ruler.use){p=this._setting.ruler_position.split(","),r=p.length,u+='<div id="dext_ruler_pointline_div">';for(a=0;a<r;a++)i=e._config.ruler.guideLineColor,l=e._config.ruler.guideLineStyle,"2"==e._config.ruler.mode&&(i=e._config.ruler.moveGuideLineColor,l=e._config.ruler.moveGuideLineStyle),u+='<div id="dext_ruler_pointline_'+a+"_"+e.ID+'" style="position:absolute; z-index: 9999; border-left:'+l+" 1px "+i+'; display:none;"></div>';u+="</div>"}"2"==e._config.ruler.mode&&"0"==e._config.useNoncreationAreaBackground&&(u+='<div id="dext_ruler_pointline_4_'+e.ID+'" style="position:absolute; left:'+p[2]+"px; z-index: 9999; border-left:"+e._config.ruler.guideLineStyle+" 1px "+e._config.ruler.guideLineColor+';"></div>'),"1"==e._config.ruler.useVertical&&(u+='<div id="dext_ruler_vertical_'+e.ID+'" class="ruler_vertical" style="height: '+e.height+'px;"><div id="dext_ruler_vertical_scroll_'+e.ID+'" class="ruler_vertical_scroll',DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(u+=" ie8"),u+='" ></div>',"2"==e._config.ruler.mode&&(u+='<div id="dext_ruler_vertical_area_0_'+e.ID+'" class="ruler_vertical_unfocused" ></div><div id="dext_ruler_vertical_area_1_'+e.ID+'" class="ruler_vertical_unfocused" style="height:100%;"></div>'),u+='<div id="dext_ruler_vertical_disabled_'+e.ID+'" class="ruler_vertical_disabled"></div>',u+="</div > "),"2"==e._config.horizontalLine.use&&(u+='<div id="dext_horizontal_line_'+e.ID+'"></div>'),p=e._config.style.height.replace("px",""),e._defaultHeight=p+"",u+='	<div id="ue_editor_holder_'+e.ID+'" class="ue_editor_'+t+'_lr" ';if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)u="view"==e._config.mode&&"1"==e._config.view_mode_auto_height?u+' style="overflow:hidden;"':u+' style="overflow:scroll; -webkit-overflow-scrolling:touch;"';u+="	></div>",u+='	<div id="status_'+e.ID+'" class="ue_as" style="width:100%;">',u="1"==e._config.status_bar||f||0==o?u+('		<table id="dext_statusbar_'+e.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+t+'" style="background-image:url('+n+"/ue_gbg.gif); display:none; "):u+('		<table id="dext_statusbar_'+e.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+t+'" style="background-image:url('+n+"/ue_gbg.gif); "),u+='">',u+="<caption><span class='blind'>Statusbar Area</span></caption>",u+='		    <tr id="status_tr_'+e.ID+'" ',u+=">",u+="				<td>",u+='					<ul class="ue_btn_'+t+'" id="dext_tab_status_'+e.ID+'">';if(0==o)u+=' <li class="" id="ue_'+e.ID+'design" style="visibility:hidden;"><a href="javascript:void(0);">DEXT_Status</a></li>';else for(a=e._config.statusBarItem,l=0;l<a.length;l++)c=a[l],c=DEXTTOP.DEXT5.util.trim(c).toLowerCase(),u+=' <li class="" id="ue_'+e.ID+c+'"><a href="javascript:void(0);">DEXT_Status</a></li>';u+="					</ul>",u+='<ul class="ue_btn_'+t+'" style="float: right;">',u+='<li id="editor_temporarily_message" style="width: 120px; text-align:right; cursor:default; border-right:none; display:none;">',u+="</li>","1"==e._config.wordCount.use&&(u+='<li id="word_count_'+e.ID+'_holder" style="width: 300px; ',null==DEXTTOP.G_CURREDITOR._config.zoomList&&(u+="text-align: right; "),u+='cursor:default;"><span id="count_line_span_'+e.ID+'" style="margin-right:10px;"></span><span id="count_characters_span_'+e.ID+'" style="margin-right:10px;"></span></li>'),null!=e._config.zoomList&&(u+='<li id="zoom_'+e.ID+'_holder" class="zoom_editor_holder"><span class="bottom_width_r"><textarea id="ue_'+e.ID+'zoom_text" title="'+dext5_lang.icon.zoom_text+'" maxlength="5" rows="1" wrap="soft"></textarea>',u+='<a class="z_arrow" id="ue_'+e.ID+'zoom" href="javascript:void(0);">',u+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',u+='		<span id="dext_pan_zoom_'+e.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc;"></span>',u+="	</span>",u+='</a><a class="z_plus" id="ue_'+e.ID+'zoom_plus" href="javascript:void(0);">',u+='</a><a class="z_minus" id="ue_'+e.ID+'zoom_minus" href="javascript:void(0);"></a></span></li>'),u+="</ul>",u+="				</td>",u+="			</tr>",u+="		</table>",u+="	</div>",u+="</div>",document.getElementById("editorContentArea").innerHTML=u;for(p=0;p<this.remove_item.length;p++)-1<this.remove_item[p].indexOf("detail")&&(u=document.getElementById("dext_span_"+e.ID+this.remove_item[p]))&&(u.style.display="none");u=this._setting.word_break_type,f=this._setting.word_wrap_type,""==u&&(u="normal"),""==f&&(f="normal"),p=document.getElementById("ue_editor_holder_"+e.ID),createEditorIframe(e._config,p,"dext5_design_"+e.ID,dext5_lang.iframe_title.design,e._docType[e._setting.doctype],e._setting.encoding,e._setting.lang,e._setting.xmlnsname,e._setting.font_family,e._setting.font_size,e._setting.line_height,u,f),setEditorBorder(e),u=document.createElement("label"),u.id="dext5_source_label_"+e.ID,u.setAttribute("for","dext5_source_"+e.ID),u.className="blind",u.innerText=dext5_lang.iframe_title.source,p.appendChild(u),u=document.createElement("textarea"),u.id="dext5_source_"+e.ID,u.title=dext5_lang.iframe_title.source,u.style.color="#111111",u.style.width="0px",u.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(u.style.display="none"),u.style.borderWidth="0px",u.style.margin="0px 0px",u.style.padding="0px",u.className="DEXT_fiVe_EdiTor_source_editor_font","1"==e._config.sourceViewtype&&("wrap"in u?u.wrap="off":"wordWrap"in u.style&&(u.style.wordWrap="normal")),p.appendChild(u),u=document.createElement("label"),u.id="dext5_text_label_"+e.ID,u.setAttribute("for","dext5_text_"+e.ID),u.className="blind",u.innerText=dext5_lang.iframe_title.text,p.appendChild(u),u=document.createElement("textarea"),u.id="dext5_text_"+e.ID,u.title=dext5_lang.iframe_title.text,u.style.color="#111111",u.style.width="0px",u.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(u.style.display="none"),u.style.borderWidth="0px",u.style.margin="0px 0px",u.style.padding="0px",u.className="DEXT_fiVe_EdiTor_text_editor_font",p.appendChild(u);if(p=document.getElementById("ue_"+e.ID+"design"))p.className=e._config.style.skinName,p.getElementsByTagName("A")[0].className="color_on",p.style.backgroundImage="url("+e._config.webPath.image+"skin/"+e._config.style.skinName+"/ue_btn_bg.gif)";setEditorHeight(e,!0),document.getElementById("ue_editor_holder_"+e.ID).style.height=0>e._defaultHeight?"0px":e._defaultHeight+"px",document.getElementById("dext_background")||(p=document.createElement("div"),p.setAttribute("id","dext_background"),p.style.zIndex=G_MAIN_ZINDEX+1e3,document.getElementsByTagName("body")[0].appendChild(p)),document.getElementById("dext_click_background")||(p=document.createElement("div"),p.setAttribute("id","dext_click_background"),p.style.zIndex=G_MAIN_ZINDEX+1e3,document.body.appendChild(p),DEXTTOP.DEXT5.util.addEvent(p,"click",function(){DEXT5_EDITOR.prototype.dialog._click_background()}),p.onmousedown=function(){return!1},p.unselectable="on"),e._dextFormatting.init(e.ID),e._dextLineHeight.init(e.ID),e._dextzoom.init(e.ID);if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.safari)p=null,0==!!DEXTTOP.DEXTDOC.getElementById("dext5_paste_temp_frame")&&(p=DEXTTOP.DEXTDOC.createElement("iframe"),p.id="dext5_paste_temp_frame",p.style.width="0px",p.style.height="0px",p.style.display="none",u="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",u=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(u)+"}())":"",p.src=u,DEXTTOP.DEXTDOC.body.appendChild(p));if(p=document.getElementById("ue_"+e.ID+"design"))p.style.backgroundImage="url("+n+"/ue_btn_bg.gif)";e._setTopMenuEvents(),e._setIconEvents(),setToolbarScroll(e,!0),e._iconEnable("default"),e._config.useServerLicense?DEXTTOP.DEXT5.util.checkServerLicense(e):(n=setTimeout(_fn_0,2e3),DEXTTOP.DEXT5.DEXTMULTIPLETIMEOUT.push(n)),"1"==e._config.resize_bar&&0<o&&DEXTTOP.DEXTWIN==top&&!DEXTTOP.DEXT5.browser.mobile&&!DEXTTOP.DEXT5.browser.iOS&&e._setEditorResizeBar();if("1"==e._config.tool_bar_grouping){groupingIcon(),n=document.getElementById("dext_span_"+e.ID+"tool_bar_grouping1"),"mono"==t?(n.style.height="38px",n.style.marginTop="-6px",7==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&(n.style.height="39px")):n.style.height=DEXTTOP.DEXT5.browser.quirks?"29px":"27px";var d=document.getElementById("dext_div_tool_bar_grouping_box1"),o=function(){return function(t){DEXTTOP.G_CURREDITOR=e,"block"==v.style.display&&hideGroupingBox();if("block"==d.style.display)hideGroupingBox();else{if(DEXTTOP.DEXT5.browser.mobile||"mobile"==DEXTTOP.DEXT5.UserAgent.device.type)d.style.top="0px",d.style.left="0px";d.style.display="block",showGroupingBackground(),setPositionGroupingDiv(1);var n=d.getElementsByTagName("a"),r=n.length;if(0<r)var i=setInterval(function(){e.groupingBoxOpen&&(n[0].focus(),setFocusFirstAndLast2(n[0],n[r-1]),e.groupingBoxOpen=!1,clearInterval(i))},100)}}}();DEXTTOP.DEXT5.util.addEvent(n,"click",o),n=document.getElementById("dext_span_"+e.ID+"tool_bar_grouping2"),"mono"==t?(n.style.height="37px",n.style.marginTop="-6px",7==DEXTTOP.DEXT5.browser.ieVersion&&(n.style.marginTop="-7px",DEXTTOP.DEXT5.browser.quirks&&(n.style.height="38px"))):(n.style.height="28px",10>DEXTTOP.DEXT5.browser.ieVersion&&(7==DEXTTOP.DEXT5.browser.ieVersion?(n.style.height="27px",n.style.marginTop="-2px",DEXTTOP.DEXT5.browser.quirks&&(n.style.marginTop="0px")):n.style.marginTop="-1px"));var v=document.getElementById("dext_div_tool_bar_grouping_box2"),t=function(){return function(t){DEXTTOP.G_CURREDITOR=e,"block"==d.style.display&&hideGroupingBox();if("block"==v.style.display)hideGroupingBox();else{if(DEXTTOP.DEXT5.browser.mobile||"mobile"==DEXTTOP.DEXT5.UserAgent.device.type)v.style.top="0px",v.style.left="0px";v.style.display="block",showGroupingBackground(),setPositionGroupingDiv(2);var n=v.getElementsByTagName("a"),r=n.length;if(0<r)var i=setInterval(function(){e.groupingBoxOpen&&(n[0].focus(),setFocusFirstAndLast2(n[0],n[r-1]),e.groupingBoxOpen=!1,clearInterval(i))},100)}}}();DEXTTOP.DEXT5.util.addEvent(n,"click",t);if(("1"==e._config.pluginInstallType||"2"==e._config.pluginInstallType)&&G_dext5plugIn&&!G_dext5plugIn.productKey&&void 0==G_dext5plugIn.productKey)if("0"==e._config.usePluginInstallGuide)requestPluginInstall(window,document,e._config);else{if("0"==e._config.pluginInstallGuideType){var t=getDialogWindow(),m=getDialogDocument(),n={},n=getWindowClientSize(t),p="CSS1Compat"==m.compatMode?m.documentElement.scrollWidth:m.body.scrollWidth,u="CSS1Compat"==m.compatMode?m.documentElement.scrollHeight:m.body.scrollHeight,o={},o=getWindowScrollPos(t);null==m.getElementById("d5editor_install_div_back")&&(f=m.createElement("div"),f.innerHTML='<div id="d5editor_install_div_back" style="background-color:white; filter:alpha(opacity=80); opacity:0.8; -moz-opacity:0.8; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=80); -khtml-opacity: 0.8; left: 0px; top: 0px; width: '+p+"px; height: "+u+"px; display: block; position: absolute; z-index: "+(e._config.pluginInstallGuideZIndex+1)+';"></div>',m.body.appendChild(f.firstChild)),null==m.getElementById("d5editor_install_div")&&(p=m.createElement("div"),u='<div id="d5editor_install_div" style="border:2px #0e639c solid; z-index:'+(e._config.pluginInstallGuideZIndex+5)+'; position:fixed; _position:absolute; overflow:hidden; width:600px; height:212px; background-color:white;">',u+='<iframe frameborder="0" src="'+e._config.webPath.pluginInstallGuide+'" style="position:absolute; width:600px; height:212px; border-width:0px;" title="Plugin Install Guide"></iframe>',p.innerHTML=u+"</div>",u=[0,0],DEXTTOP.DEXT5.browser.quirks&&(u=o),p.firstChild.style.left=u[0]+n[0]/2-300+"px",p.firstChild.style.top=u[1]+n[1]/2-106+"px",DEXTTOP.DEXT5.installGuideResizeEvt=function(){try{var e=m.getElementById("install_div_back");if(e){var t="CSS1Compat"==m.compatMode?m.documentElement.scrollHeight:m.body.scrollHeight;e.style.width=("CSS1Compat"==m.compatMode?m.documentElement.scrollWidth:m.body.scrollWidth)+"px",e.style.height=t+"px"}}catch(n){}},DEXTTOP.DEXT5.util.addEvent(t,"resize",DEXTTOP.DEXT5.installGuideResizeEvt),m.body.appendChild(p))}else t=640,DEXTTOP.DEXT5.browser.ie&&(t-=4),0==!!DEXTTOP.DEXT5.loadedPluginPopup&&(DEXTTOP.DEXT5.loadedPluginPopup=!0,e.pluginInstallGuidePopup=Dext5_PopupCenter(e._config.webPath.pluginInstallGuide,"DEXT5_Plugin_Install_Guide",t,208,void 0,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no"));var g=setInterval(function(){if(G_dext5plugIn&&(G_dext5plugIn.productKey||void 0!=G_dext5plugIn.productKey)){if(clearInterval(g),"1"==e._config.usePluginInstallGuide)if("1"==e._config.pluginInstallGuideType){if(null!=e.pluginInstallGuidePopup)try{e.pluginInstallGuidePopup.close()}catch(t){}}else try{closePluginInstall()}catch(n){}}else{var r=document.getElementById("dext5plugin");r&&(G_dext5plugIn=null,r.parentNode.removeChild(r),fn_createPluginObject(e._config)),document.getElementById("dext5plugin")&&(G_dext5plugIn=document.getElementById("dext5plugin"))}},200)}}if("2"==DEXTTOP.G_CURREDITOR._config.ruler.mode){var y=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),b=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),w=document.getElementById("dext_ruler_point_2_"+DEXTTOP.G_CURREDITOR.ID),E=document.getElementById("dext_ruler_point_3_"+DEXTTOP.G_CURREDITOR.ID);DEXTTOP.DEXT5.util.addEvent(y,"mouseover",function(){y.style.cursor="pointer"}),DEXTTOP.DEXT5.util.addEvent(b,"mouseover",function(){b.style.cursor="pointer"}),DEXTTOP.DEXT5.util.addEvent(w,"mouseover",function(){w.style.cursor="pointer"}),DEXTTOP.DEXT5.util.addEvent(E,"mouseover",function(){E.style.cursor="pointer"}),DEXTTOP.DEXT5.util.addEvent(y,"mousedown",rulerStartDrag),DEXTTOP.DEXT5.util.addEvent(b,"mousedown",rulerStartDrag),DEXTTOP.DEXT5.util.addEvent(w,"mousedown",rulerStartDrag),DEXTTOP.DEXT5.util.addEvent(E,"mousedown",rulerStartDrag)}"1"==e._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported&&(t=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+DEXTTOP.G_CURREDITOR.ID+"_ruler"))&&"0"==t.use&&(DEXTTOP.G_CURREDITOR._config.ruler.view="0",hideRuler(DEXTTOP.G_CURREDITOR)),"0"==e._config.ruler.defaultView&&(e._config.ruler.view="0",hideRuler(e))},_setLazyLoadFrame:function(e){"1"!=DEXTTOP.G_CURREDITOR._config.contextMenuDisable&&DEXT5_CONTEXT._create(e),"0"==DEXTTOP.G_CURREDITOR._config.top_menu&&DEXT5_TOPMENU._create(e)},_setEditorResizeBar:function(){DEXTTOP.G_CURREDITOR.dextResize=new DextResize(DEXTTOP.G_CURREDITOR),DEXTTOP.G_CURREDITOR.dextResize.createStatusResizeBar(),DEXTTOP.G_CURREDITOR.dextResize.apply(DEXTTOP.DEXTDOC)},_dextSetting:function(){this._setting.grid_color=this._config.gridColor,this._setting.grid_color_nm=this._config.gridColorName,this._setting.grid_spans=this._config.gridSpans,this._setting.grid_form=this._config.gridForm,this._setting.encoding=this._config.encoding,this._PageProp.encoding=this._setting.encoding,this._setting.word_break_type=DEXTTOP.DEXT5.util.getWordBreakStyle(this._config),this._setting.word_wrap_type=DEXTTOP.DEXT5.util.getWordWrapStyle(this._config),this._setting.page_title=this._config.document.docTitle,this._setting.page_title&&""!=this._setting.page_title||(this._setting.page_title=dext5_lang.document.no_title);var e="";"1"==this._config.enforceDoctype?e="None":"2"==this._config.enforceDoctype?DEXTTOP.DEXT5.browser.ie?e="Auto":(e="None",this._config.enforceDoctype="1"):e=this._config.docType,this._setting.doctype=this._setting_DocType(e),this._PageProp.doctype=this._setting.doctype,this._setting.xmlnsname=this._config.xmlnsname,this._PageProp.xmlnsname=this._setting.xmlnsname,this._setting.lang=this._config.lang;if((this._PageProp.lang=this._setting.lang)&&0<this._setting.lang.length){var e=document.getElementsByTagName("html")[0],t=this._setting.lang;-1<t.indexOf("-")&&(t=t.split("-")[0]),e.setAttribute("lang",t),e.setAttribute("xml:lang",t),0<this._setting.xmlnsname.length&&e.setAttribute("xmlns",this._setting.xmlnsname)}this._setting.font_family=this._config.defaultFontFamily,this._setting.font_size=this._config.defaultFontSize,this._setting.line_height=this._config.defaultLineHeight,this._setting.show_font_real=this._config.showRealFont,"CCODE_001"==this._config.custom_code&&(this._setting.show_font_real="1"),e=getAutoSave(DEXTTOP.G_CURREDITOR),"0"!=e&&("1"==DEXTTOP.G_CURREDITOR._config.setAutoSave.mode?e="1,"+this._config.setAutoSave.interval:"0"==this._config.setAutoSave.mode&&(e="2")),this._setting.auto_save=e,this._setting.auto_save_fn=null,"2"!=DEXTTOP.G_CURREDITOR._config.ruler.mode&&"1"==this._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported?(e=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+this.ID+"_ruler"))?(e=e.position,e=e.replace("10,10,",""),this._setting.ruler_position=e):this._setting.ruler_position=this._config.ruler.rulerInitPosition:this._setting.ruler_position=this._config.ruler.rulerInitPosition,this._docType.Auto=DEXTTOP.DEXT5.util.getDocType(DEXTTOP.document),this._docType.None="",this._docType["XHTML 1.1"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">',this._docType["XHTML 1.0 Transitional"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',this._docType["XHTML 1.0 Strict"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">',this._docType["XHTML 1.0 Frameset"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">',this._docType["HTML 5"]="<!DOCTYPE html>",this._docType["HTML 4.01 Transitional"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',this._docType["HTML 4.01 Strict"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">',this._docType["HTML 4.01 Frameset"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">',this._docType["HTML 3.2"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">',this._docType["HTML 2.0"]='<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'},_setting_DocType:function(e){for(var t="HTML 5",n="Auto;None;XHTML 1.1;XHTML 1.0 Transitional;XHTML 1.0 Strict;XHTML 1.0 Frameset;HTML 5;HTML 4.01 Transitional;HTML 4.01 Strict;HTML 4.01 Frameset;HTML 3.2;HTML 2.0".split(";"),r=n.length,i=0;i<r;i++)if(e==n[i]){t=e;break}return t},_makeEditorTopMenu:function(){var e=this._config.style.skinName,t="",n=this._config.topMenuItem.length;0==n&&(this._config.top_menu="1");if("1"==this._config.top_menu||isViewMode(this))t+='<table style="display:none; height:0px;" border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+e+'" id="dext_menu_'+this.ID+'" >';else if(t+='<table border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+e+'" id="dext_menu_'+this.ID+'" >',-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_"))t+='<div id="ue_top_menu_diabled_div_'+this.ID+'" class="ue_tm tm_'+e+'" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+(G_MAIN_ZINDEX+1e3)+'; left:0px; top:0px; width:0px;"></div>';t=t+"<caption><span class='blind'>Top Menu Area</span></caption>"+('<tr><td><ul id="dext_tab_menu_'+this.ID+'">');for(e=0;e<n;e++)var r=this._config.topMenuItem[e],r=DEXTTOP.DEXT5.util.trim(r).toLowerCase(),t=t+('<li id="ue_'+this.ID+r+'"><a href="javascript:void(0);" id="'+this.ID+":"+r+'">'+dext5_lang.top_menu[r]+"</a></li>");return t+="</ul></td></tr>",t+="</table>"},_makeEditorIcon:function(e,t){var n=this._config.style.skinName,r=this._config.webPath.image,i=r+"skin/"+n,s='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+i+'/separator.gif" alt="" /></span>',o="",u=0,u=e.length,a=isViewMode(this);if("0"==t)o=o+"<tr>"+('	<td class="ue_tdb_'+n+'" style="padding: 1px 5px 0px 5px;" >');else if("1"==t){var o=o+('<tr id="tool1_'+this.ID+'">'),f="";DEXTTOP.DEXT5.browser.mobile&&"1"==this._config.useAutoToolbar&&(f="position:relative;"),o="3"==this._config.tool_bar||"1"==this._config.tool_bar||a?"mono"==n?o+('	<td class="ue_tdb_'+n+' txt_ip_blue" style="padding: 5px 5px 5px 5px; display:none;'+f+'" id="dext_tab_tool1_'+this.ID+'">'):o+('	<td class="ue_tdb_'+n+' txt_ip_blue" style="padding: 1px 5px 0px 5px; display:none;'+f+'" id="dext_tab_tool1_'+this.ID+'">'):"mono"==n?o+('	<td class="ue_tdb_'+n+' txt_ip_blue" style="padding: 5px 5px 5px 5px;'+f+'" id="dext_tab_tool1_'+this.ID+'">'):o+('	<td class="ue_tdb_'+n+' txt_ip_blue" style="padding: 1px 5px 0px 5px;'+f+'" id="dext_tab_tool1_'+this.ID+'">')}else o+='<tr id="tool2_'+this.ID+'">',f="",DEXTTOP.DEXT5.browser.mobile&&"1"==this._config.useAutoToolbar&&(f="position:relative;"),o="3"==this._config.tool_bar||"2"==this._config.tool_bar||a?"mono"==n?o+('	<td class="ue_tdb_'+n+'01 txt_ip_blue" style="padding: 5px 5px 4px 5px; display:none;'+f+'" id="dext_tab_tool2_'+this.ID+'">'):o+('	<td class="ue_tdb_'+n+'01 txt_ip_blue" style="padding: 2px 5px 0px 5px; background-image:url('+i+"/ue_tbg01.gif); display:none;"+f+'" id="dext_tab_tool2_'+this.ID+'">'):"mono"==n?o+('	<td class="ue_tdb_'+n+'01 txt_ip_blue" style="padding: 5px 5px 4px 5px;'+f+'" id="dext_tab_tool2_'+this.ID+'">'):o+('	<td class="ue_tdb_'+n+'01 txt_ip_blue" style="padding: 2px 5px 0px 5px; background-image:url('+i+"/ue_tbg01.gif);"+f+'" id="dext_tab_tool2_'+this.ID+'">');for(i=0;i<u;i++){"0"==t?a=e[i]:(a=e[i],"apply_format"==a?this.isUseApplyFormat=!0:"text_paste"==a&&(this.setTextPasteMode=this._config.setTextPasteMode));for(var a=DEXTTOP.DEXT5.util.trim(a).toLowerCase(),f=this.remove_item.length,l=0;l<f;l++)if(this.remove_item[l].toLowerCase()==a){a="remove";break}if("0"==t)o+='<span class="uebutton_combo_on" id="dext_span_'+this.ID+a+'" >',o+="</span>",o+=s;else if(0==a.indexOf("p_")){var c=a.split("_"),f=c[1],l="icon";2<c.length&&(l=c[2]),o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',c="",DEXTTOP.DEXT5.browser.ie&&(c="vertical-align:bottom; "),o=null!=G_DEPlugin[f].lang||void 0!=G_DEPlugin[f].lang?o+('<a href="javascript:;" id="'+this.ID+":"+a+'" title="'+G_DEPlugin[f].lang.title+'"><img style="'+c+'margin: -1px; padding: 0px; width: 20px; height: 20px;" id="ue_'+this.ID+a+'" class="ue_H ue_M" title="'+G_DEPlugin[f].lang.title+'" alt="" src="'+this._config.webPath.plugin+f+"/images/"+l+'.png" /></a>'):o+('<a href="javascript:;" id="'+this.ID+":"+a+'"><img style="'+c+'margin: -1px; padding: 0px; width: 20px; height: 20px;" id="ue_'+this.ID+a+'" class="ue_H ue_M" title="" alt="" src="'+this._config.webPath.plugin+f+"/images/"+l+'.png" /></a>'),o+="</span>",G_ICON_FULL_SET.push(a)}else if(getCustomIconAttr(a).isCustom)f="custom",null!=DEXTTOP.DEXT5.ajax.load(r+"icon/"+getCustomIconAttr(a).command+".gif")&&(f=getCustomIconAttr(a).command),o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="'+this.ID+":"+a+'"><img style="margin: 2px 0px 0px 1.5px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+a+'" class="ue_H ue_M" title="" alt="" src="'+r+"icon/"+f+'.gif" /></a>',o+="</span>",G_ICON_FULL_SET.push(a);else switch(a){case"remove":break;case"separator":o+=s;break;case"font_family":case"font_size":case"line_height":case"formatting":case"letter_spacing":f=!1;switch(a){case"font_family":"1"==this._config.useFontFamilyKeyin&&(f=!0);break;case"font_size":"1"==this._config.useFontSizeKeyin&&(f=!0);break;case"line_height":"1"==this._config.useLineHeightKeyin&&(f=!0)}if(f){if(f="",DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks&&(f="22px"),o+='<span class="uebutton_combo_on',"font_size"==a&&"1"==this._config.useFontSizeIncDec?o+=" fontSize upDown":"line_height"==a&&"1"==this._config.useLineHeightIncDec&&(o+=" lineHeight upDown"),o+='" id="dext_span_'+this.ID+a+'" >',o+='	<textarea placeholder="" rows="1" wrap="soft" id="txtara_'+this.ID+a+'" style="height:'+f+';" title="'+dext5_lang.icon[a].replace("\uae30\ubcf8","")+'"></textarea>',o+='<a class="t_arrow" href="javascript:void(0);"  id="ue_'+this.ID+a+'"></a>',"font_size"==a&&"1"==this._config.useFontSizeIncDec||"line_height"==a&&"1"==this._config.useLineHeightIncDec)o+='<a class="t_arrow t_arrow_top" href="javascript:void(0);"  id="ue_'+this.ID+a+'_inc" style="cursor: pointer;">',o+="</a>",o+='<a class="t_arrow t_arrow_bottom" href="javascript:void(0);"  id="ue_'+this.ID+a+'_dec" style="cursor: pointer;"></a>'}else if(f="",f="line_height"==a?"Fsize_Btn_"+n:"Font_Btn_"+n,o+='<span class="uebutton_combo_on',"font_size"==a&&"1"==this._config.useFontSizeIncDec?o+=" fontSize upDown":"line_height"==a&&"1"==this._config.useLineHeightIncDec?o+=" lineHeight upDown":"letter_spacing"==a&&"1"==this._config.useLetterSpacingIncDec&&(o+=" spacing upDown"),o+='" id="dext_span_'+this.ID+a+'" >',o+='	<button unselectable="on" onmousedown="return false;" id="ue_'+this.ID+a+'" class="'+f+'" type="button" title="'+dext5_lang.icon[a].replace("\uae30\ubcf8","")+'" style="margin:0;"><span></span></button>',"line_height"==a&&"1"==this._config.useLineHeightIncDec||"letter_spacing"==a&&"1"==this._config.useLetterSpacingIncDec||"font_size"==a&&"1"==this._config.useFontSizeIncDec)o+='<a class="t_arrow t_arrow_top" href="javascript:void(0);"  id="ue_'+this.ID+a+'_inc" style="cursor: pointer;"></a>',o+='<a class="t_arrow t_arrow_bottom" href="javascript:void(0);"  id="ue_'+this.ID+a+'_dec" style="cursor: pointer;"></a>';o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_pan_'+a+"_"+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>',o+="	</span>",o+="</span>";break;case"table_insert":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="'+this.ID+":"+a+'" class="'+a+'"><span id="ue_'+this.ID+a+'" style="display:block;width:16px; height:16px;"></span></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_pan_'+a+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc;">',o+='			<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>',o+="		</span>",o+="	</span>",o+="</span>",a=!1;if(-1<(","+this._config.toolBar1.join(",")+",").indexOf(",detail_table_insert_new,")||-1<(","+this._config.toolBar2.join(",")+",").indexOf(",detail_table_insert_new,"))a=!0;0==a&&(o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_table_insert">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_table_insert" class="dialog"></a>',o+="</span>");break;case"detail_table_insert":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="'+this.ID+":"+a+'" class="'+a+'"><span id="ue_'+this.ID+a+'" style="display:block;width:16px; height:16px;"></span></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_pan_'+a+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc;">',o+='			<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>',o+="		</span>",o+="	</span>",o+="</span>";break;case"detail_table_insert_new":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="'+this.ID+":"+a+'" class="'+a+'"><span id="ue_'+this.ID+a+'" style="display:block;width:16px; height:16px;"></span></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_pan_'+a+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">',o+='			<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>',o+="		</span>",o+="	</span>",o+="</span>";break;case"font_color":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'">',o+='<em class="dext_font_color_basic dext_color_style1" id="dext_em_'+this.ID+'color_show"></em>',o+="</a>",o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_font_color">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_font_color" class="dialog"></a>',o+="</span>";break;case"detail_font_color":break;case"font_bg_color":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'">',o+='	<em class="dext_font_color_basic dext_color_style2" id="dext_em_'+this.ID+'bg_color_show"></em>',o+="</a>",o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_font_bg_color">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_font_bg_color" class="dialog"></a>',o+="</span>";break;case"detail_font_bg_color":break;case"cell_bg_color":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'">',o+='	    <em class="dext_font_color_basic dext_color_style2" id="dext_em_'+this.ID+'cell_bg_color_show"></em>',o+="    </a>",o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_cell_bg_color">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_cell_bg_color" class="dialog"></a>',o+="</span>";break;case"detail_cell_bg_color":break;case"list_number":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'"></a>',o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_list_number">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_list_number" class="dialog"></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_pan_detail_list_number_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc;"></span>',o+="	</span>",o+="</span>";break;case"detail_list_number":break;case"list_bullets":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'"></a>',o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_list_bullets">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_list_bullets" class="dialog"></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_pan_detail_list_bullets_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>',o+="	</span>",o+="</span>";break;case"detail_list_bullets":break;case"align_group":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'"></a>',o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'align_group_detail">',o+='	<a href="javascript:;" id="ue_'+this.ID+'align_group_detail" class="dialog"></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_span_align_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>',o+="	</span>",o+="</span>";break;case"align_group_detail":break;case"order_of_objects":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'"></a>',o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'order_of_objects_detail">',o+='	<a href="javascript:;" id="ue_'+this.ID+'order_of_objects_detail" class="dialog"></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_span_order_of_objects_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>',o+="	</span>",o+="</span>";break;case"order_of_objects_detail":break;case"table_group":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'"></a>',o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'table_group_detail">',o+='	<a href="javascript:;" id="ue_'+this.ID+'table_group_detail" class="dialog"></a>',o+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',o+='		<span id="dext_span_table_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>',o+="	</span>",o+="</span>";break;case"table_group_detail":break;case"insert_datetime":o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'">',o+="</a>",o+="</span>",o+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_insert_datetime">',o+='	<a href="javascript:;" id="ue_'+this.ID+'detail_insert_datetime" class="dialog"></a>',o+="</span>";break;case"detail_insert_datetime":break;default:o+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+a+'">',o+='	<a href="javascript:;" id="ue_'+this.ID+a+'" class="'+a+'"></a>',o+="</span>"}}if("1"==t){n=!1,f=this.remove_item.length;for(l=0;l<f;l++)if("about"==this.remove_item[l]){n=!0;break}0==n&&(o+='<span style="" class="uebutton_span_on">',o+='	<a href="javascript:;" id="'+this.ID+':about" class="about"><span id="ue_'+this.ID+'about" style="display:block;width:16px; height:16px;"></span></a>',o+="</span>")}return"1"==this._config.tool_bar_grouping&&("1"==t?(o+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping1">',o+='	<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping1" class=""><span style="display:none;">'+dext5_lang.icon.toolbar_grouping+" 1</span></a>",o+="</span>"):"2"==t&&(o+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping2">',o+='	<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping2" class=""><span style="display:none;">'+dext5_lang.icon.toolbar_grouping+" 2</span></a>",o+="</span>")),o+="	</td>",o+="</tr>"},_makeEditorFormBar:function(){var e="";if("1"==this._config.formMode){var t=this._config.style.skinName,n='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+(this._config.webPath.image+"skin/"+t)+'/separator.gif" alt="" /></span>',r=0,r=this._config.toolBarAdmin.length;if(0<r&&"1"==this._config.formMode)for(e=e+('<table id="" class="ue_table02 tm_'+t+'2" border="0" cellpadding="0" cellspacing="0">')+"<tbody>",e+='<tr id="tool3_'+this.ID+'">',e+='<td class="ue_tdb_ty ue_tdb_'+t+'">',t=0;t<r;t++){var i;i=this._config.toolBarAdmin[t],i=DEXTTOP.DEXT5.util.trim(i).toLowerCase();for(var s=this.remove_item.length,o=0;o<s;o++)if(this.remove_item[o]==i){i="remove";break}switch(i){case"remove":break;case"separator":e+=n;break;default:e+='<span id="dext_span_'+this.ID+i+'" class="uebutton_type_on"><a id="ue_'+this.ID+i+'" title="" href="javascript:;" class="'+i.replace("input_","type_")+'"></a></span>'}}e+="</td>",e+="</tr>",e+="</tbody>",e+="</table>"}return e},_div_pan_reset:function(e){},_iconEnableForTextInRange:function(){var e=getFirstRange(),t=e.range;e.sel.isCollapsed&&(e="",GetTDTHCell(t.startContainer)&&(e="focusInCell"),this._iconEnable(e))},_iconEnable:function(e,t){if(null==this.iconEnableCommandType||this.iconEnableCommandType!=e||"undo"==G_LAST_CMD||"redo"==G_LAST_CMD){this.iconEnableCommandType=e;if(0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(""==e||"default"==e))try{var n=getFirstRange().range.startContainer;3==n.nodeType&&(n=n.parentNode),0==n.isContentEditable&&(e="editableFalse")}catch(r){}for(var i=null,s=null,o="",n=i="",u=0,a=G_ICON_FULL_SET.length;u<a;u++)if(o=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[u]).toLowerCase(),i=document.getElementById("ue_"+this.ID+o),s=document.getElementById("dext_span_"+
this.ID+o),i&&(i.style.cursor="pointer"),s){switch(o){case"formatting":case"font_family":case"font_size":case"line_height":case"letter_spacing":i="font_size"==o&&"1"==this._config.useFontSizeIncDec?"fontSize upDown uebutton_combo_":"line_height"==o&&"1"==this._config.useLineHeightIncDec?"lineHeight upDown uebutton_combo_":"letter_spacing"==o&&"1"==this._config.useLetterSpacingIncDec?"spacing upDown uebutton_combo_":"uebutton_combo_";break;case"detail_table_insert":case"detail_list_number":case"detail_list_bullets":case"order_of_objects_detail":case"align_group_detail":case"table_group_detail":case"detail_font_color":case"detail_font_bg_color":case"detail_cell_bg_color":case"detail_insert_datetime":i="uebutton_dialog_";break;case"input_textfield":case"input_textarea":case"input_select":case"input_checkbox":case"input_radio":case"input_button":case"input_imagebutton":case"input_hiddenfield":case"input_align_left":case"input_align_right":case"input_valign_top":case"input_valign_bottom":case"input_same_width":case"input_same_height":case"input_word_spacing":case"input_line_height":case"input_same_width_height":case"table_lock":case"cell_lock":case"table_lock_property":case"placeholder":i="uebutton_type_";break;default:i="uebutton_span_"}if((n=DEXTTOP.DEXT5.util.getClass(s))&&-1<n.indexOf("_off"))if(DEXTTOP.DEXT5.util.setClass(s,i+"on"),0==o.indexOf("p_")){var f=o.split("_")[1];if(s=s.getElementsByTagName("img")[0])s.title=dext5_lang.plugins[f].icon[o]}else if(s=s.getElementsByTagName("a")[0])s.title=dext5_lang.icon[o]}n=[];switch(e){case"":case"default":n="copy cut table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property table_tool cell_border cell_bg_color table_group table_group_detail apply_format image_align_default image_align_left image_align_right table_lock cell_lock table_lock_property detail_cell_bg_color element_position order_of_objects order_of_objects_detail table_adjust insert_table_top_paragraph insert_table_bottom_paragraph table_copy_paste calculation_formula table_row_column delete_table_and_row_column table_row_column_cell_property".split(" ");break;case"selectedSingleCell":n="new save print pagebreak copy cut paste text_paste find replace template emoticon horizontal_line image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete insert_row_up insert_row_down insert_column_left insert_column_right merge_cell cell_size table_same_width table_same_height table_same_widthheight full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property indent outdent format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder insert_table_top_paragraph insert_table_bottom_paragraph table_selection table_indent table_outdent table_row_column table_row_clone insert_row_column insert_row_up insert_row_down insert_column_right insert_table_top_paragraph insert_table_bottom_paragraph table_delete row_property column_property table_property calculation_formula horizontal_sum vertical_sum horizontal_avg vertical_avg".split(" "),null==DEXTTOP.G_COPIEDCELLDATA&&(n.push("table_content_paste"),n.push("intable_paste")),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&n.push("apply_format");break;case"selectedMultiCell":n="new save print pagebreak copy cut paste text_paste find replace emoticon horizontal_line template image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete insert_row_up insert_row_down insert_column_left insert_column_right full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property indent outdent format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder insert_table_top_paragraph insert_table_bottom_paragraph table_indent table_outdent table_content_paste table_delete row_property column_property calculation_formula horizontal_sum vertical_sum horizontal_avg vertical_avg table_paste table_row_column".split(" "),null==DEXTTOP.G_COPIEDCELLDATA&&(n.push("table_content_paste"),n.push("intable_paste")),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&n.push("apply_format");break;case"focusInCell":n="copy cut merge_cell table_same_width table_same_height table_same_widthheight doc_bg_image cell_size apply_format image_align_default image_align_left image_align_right table_copy".split(" "),null==DEXTTOP.G_COPIEDCELLDATA&&(n.push("table_content_paste"),n.push("intable_paste")),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&n.push("apply_format");break;case"focusTable":n="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder insert_table_top_paragraph insert_table_bottom_paragraph calculation_formula table_copy_paste table_row_column delete_table_and_row_column table_row_column_cell_property".split(" "),"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign&&(n.push("align_left"),n.push("align_center"),n.push("align_right"),n.push("align_full"),n.push("align_group"),n.push("align_group_detail"));break;case"cellSelectText":n="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder table_copy_paste delete_table_and_row_column table_row_column table_row_column_cell_property calculation_formula".split(" "),"1"!=this._config.allowInoutdentText&&(n.push("indent"),n.push("outdent"));break;case"selectArea":n="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ");break;case"focusImage":n="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ");break;case"focusFigure":n="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator align_full placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ");break;case"focusEmbed":n="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets indent outdent insert_row_column insert_row insert_column table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ");break;case"editableFalse":n=G_ICON_FULL_SET,u=[],o=","+G_ICON_READONLY_ACTIVATION_SET.join(",")+",",a=0;for(s=n.length;a<s;a++)-1==o.indexOf(","+n[a]+",")&&u.push(n[a]);n=u;break;case"allDisable":n=G_ICON_FULL_SET;break;case"dextResize":n="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color table_lock cell_lock table_lock_property insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ");break;case"focusPageBreak":n="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ");break;case"placeholder":n="copy cut paste text_paste replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height indent outdent list_number list_bullets detail_list_number detail_list_bullets formatting font_family font_size select_all entity insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent ruler pagebreak dirltr dirrtl insert_file format_painter apply_format letter_spacing align image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property detail_cell_bg_color insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator mini_photo_editor table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column".split(" ")}for(f in G_DEPlugin)if(G_DEPlugin[f].onDisableToolIcon&&(u=G_DEPlugin[f].onDisableToolIcon(e)))for(o=0;o<u.length;o++)n.push(u[o]);a=0;for(s=G_ICON_CUSTOM_ADD_DISABLED_SET.length;a<s;a++)n.push(G_ICON_CUSTOM_ADD_DISABLED_SET[a]);n=n.concat(this.lockCommand),0==this.UndoManager.canUndo&&(n[n.length]="undo"),0==this.UndoManager.canRedo&&(n[n.length]="redo");if("editableFalse"!=e){t&&1==t&&(n=addDisalbeItemForNoActionTable(n)),f=this._setting.auto_save.toString().split(",");if("0"==this._config.setAutoSave.useManuallySave&&"2"==f[0]||void 0==getAutoSaveHtml_userID(this.ID,this._config.setAutoSave.unique_key,this._config.setAutoSave.maxCount)||""==getAutoSaveHtml_userID(this.ID,this._config.setAutoSave.unique_key))n[n.length]="load_auto_save";null==this._formatPainterList&&(n[n.length]="apply_format"),"focusImage"==e&&(f=DEXTTOP.G_SELECTED_IMAGE_ELEMENT)&&f.getAttribute("dext5customdata")&&""!=f.getAttribute("dext5customdata")&&(f=f.getAttribute("dext5customdata"),"iframe"!=getDextCustomData(f).type&&(n.push("image_align_default"),n.push("image_align_left"),n.push("image_align_right"))),(f=getFormControlSelectedItem())&&2>f.count&&(n.push("input_same_width"),n.push("input_same_height"),n.push("input_same_width_height"))}-1<n.indexOf("status_source")&&n.splice(n.indexOf("status_source"),1),-1<n.indexOf("status_preview")&&n.splice(n.indexOf("status_preview"),1),-1<n.indexOf("status_text")&&n.splice(n.indexOf("status_text"),1),u=0;for(a=n.length;u<a;u++)if(o=DEXTTOP.DEXT5.util.trim(n[u]).toLowerCase(),i=document.getElementById("ue_"+this.ID+o),s=document.getElementById("dext_span_"+this.ID+o),"zoom"!=o&&"zoom_plus"!=o&&"zoom_minus"!=o||"allDisable"!=e)if(i&&(i.style.cursor="default"),s){switch(o){case"formatting":case"font_family":case"font_size":case"line_height":case"letter_spacing":i="font_size"==o&&"1"==this._config.useFontSizeIncDec?"fontSize upDown uebutton_combo_":"line_height"==o&&"1"==this._config.useLineHeightIncDec?"lineHeight upDown uebutton_combo_":"letter_spacing"==o&&"1"==this._config.useLetterSpacingIncDec?"spacing upDown uebutton_combo_":"uebutton_combo_";break;case"detail_insert_datetime":case"detail_table_insert":case"detail_list_number":case"detail_list_bullets":case"table_group_detail":case"align_group_detail":case"order_of_objects_detail":case"detail_font_color":case"detail_font_bg_color":case"detail_cell_bg_color":i="uebutton_dialog_";break;case"input_textfield":case"input_textarea":case"input_select":case"input_checkbox":case"input_radio":case"input_button":case"input_imagebutton":case"input_hiddenfield":case"input_align_left":case"input_align_right":case"input_valign_top":case"input_valign_bottom":case"input_same_width":case"input_same_height":case"input_word_spacing":case"input_line_height":case"input_same_width_height":case"table_lock":case"cell_lock":case"table_lock_property":case"placeholder":i="uebutton_type_";break;default:i="uebutton_span_"}DEXTTOP.DEXT5.util.setClass(s,i+"off"),0==o.indexOf("p_")?(s=s.getElementsByTagName("img")[0])&&0>s.title.indexOf(dext5_lang.icon.inactive_button)&&(s.title=s.title+" "+dext5_lang.icon.inactive_button):(s=s.getElementsByTagName("a")[0])&&0>s.title.indexOf(dext5_lang.icon.inactive_button)&&(s.title=dext5_lang.icon[o]+" "+dext5_lang.icon.inactive_button)}if("1"==this._config.useAutoToolbar){document.getElementById("dext_tab_tool1_"+this.ID),f=document.getElementById("dext_tab_tool2_"+this.ID),hiddenIconForAutoToolbar(this),""==e&&(e="default"),o=this._config.autoToolbar[e]?this._config.autoToolbar[e]:[],a=o.length,s=this._config.webPath.image+"skin/"+this._config.style.skinName;for(u=0;u<a;u++)i=document.getElementById("dext_span_"+this.ID+o[u]),"separator"==o[u]&&(i=document.createElement("span"),i.className="ue_SM",i.innerHTML='<img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+s+'/separator.gif" alt="">'),i&&f.appendChild(i);f.scrollLeft="0px",setToolbarScroll(this)}DEXT5_TOPMENU._disabeld_menu=n}},_iconSelected:function(e){for(var t="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid list_number list_bullets dirltr dirrtl show_blocks table_lock cell_lock table_lock_property font_color font_bg_color table_border status_source status_preview status_text".split(" "),n=DEXTTOP.G_CURREDITOR,r="",i=0,s=t.length;i<s;i++)if(_icon_id=DEXTTOP.DEXT5.util.trim(t[i]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+n.ID+_icon_id))r=DEXTTOP.DEXT5.util.getClass(_icon_span),r=DEXTTOP.DEXT5.util.replaceAll(r,"uebutton_span_enter",""),r=DEXTTOP.DEXT5.util.trim(r),DEXTTOP.DEXT5.util.setClass(_icon_span,r),_icon_span.style.backgroundImage="";if(e)for(i=0,s=e.length;i<s;i++)if(_icon_id=DEXTTOP.DEXT5.util.trim(e[i]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+n.ID+_icon_id))r=DEXTTOP.DEXT5.util.getClass(_icon_span),r+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(_icon_span,r),-1<_icon_span.className.indexOf("uebutton_type")?_icon_span.style.backgroundImage="url("+n._config.webPath.image+"skin/"+n._config.style.skinName+"/form_skinback_release.gif)":_icon_span.style.backgroundImage="url("+n._config.webPath.image+"skin/"+n._config.style.skinName+"/skinback_release.gif)"},_setTopMenuEvents:function(){for(var e=this,t=null,n="",r=0,i=this._config.topMenuItem.length;r<i;r++)if(n=DEXTTOP.DEXT5.util.trim(this._config.topMenuItem[r]).toLowerCase(),t=document.getElementById("ue_"+e.ID+n)){switch(t){case"design":case"source":case"preview":case"text":"textContent"in t?t.textContent=dext5_lang.top_menu[n]:t.innerText=dext5_lang.top_menu[n]}var s=function(t){return function(n){var r=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+e._config.editor_id);null!=r&&(r.style.display="none"),t==e._top_menu_click_id?(e._top_menu_click_flag?(e._top_menu_click_flag=!1,e._top_menu_click_id="",hideTopMenuAndFocus()):(e._top_menu_click_id=t,e._top_menu_click_flag=!0,setTopMenu(n,e,t,e._config)),DEXTTOP.DEXT5.util.stopEvent(n)):t!=e._top_menu_click_id&&"design"==DEXTTOP.G_CURREDITOR._currentMode&&(e._top_menu_click_id=t,e._top_menu_click_flag=!0,setTopMenu(n,e,t,e._config),DEXTTOP.DEXT5.util.stopEvent(n)),n=0;for(r=e._config.topMenuItem.length;n<r;n++)_m_id=DEXTTOP.DEXT5.util.trim(e._config.topMenuItem[n]).toLowerCase(),_m=document.getElementById("ue_"+e.ID+_m_id),_m.childNodes[0].className=_m_id==e._top_menu_click_id?"on":""}}(n),o=function(t){return function(n){var r=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+e._config.editor_id);null!=r&&(r.style.display="none"),e._top_menu_click_flag?(e._top_menu_click_id=t,setTopMenu(n,e,t,e._config)):(e._top_menu_click_id="",hideTopMenu()),DEXTTOP.DEXT5.util.stopEvent(n),n=0;for(r=e._config.topMenuItem.length;n<r;n++)_m_id=DEXTTOP.DEXT5.util.trim(e._config.topMenuItem[n]).toLowerCase(),_m=document.getElementById("ue_"+e.ID+_m_id),_m.childNodes[0].className=_m_id==e._top_menu_click_id?"on":"";"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose())}}(n),n=function(t){return function(t){e._top_menu_click_flag&&(t=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+e._config.editor_id),null!=t&&(t.style.display=""))}}(n);DEXTTOP.DEXT5.util.addEvent(t,"click",s),DEXTTOP.DEXT5.util.addEvent(t,"mouseover",o),DEXTTOP.DEXT5.util.addEvent(t,"mouseout",n),t=t.getElementsByTagName("a")[0],s=function(e){return function(t){e.className="on"}}(t),o=function(e){return function(t){e.className=""}}(t),DEXTTOP.DEXT5.util.addEvent(t,"focus",s),DEXTTOP.DEXT5.util.addEvent(t,"blur",o)}},_setIconEvents:function(){for(var e=this,t=null,n="",r=0,i=G_ICON_FULL_SET.length,s;r<i;r++)if(n=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[r]).toLowerCase(),t=document.getElementById("ue_"+e.ID+n)){if(getCustomIconAttr(G_ICON_FULL_SET[r]).isCustom)t.setAttribute("title",getCustomIconAttr(G_ICON_FULL_SET[r])["desc_"+e._config.lang]),"A"==t.nodeName&&(s=document.createElement("span"),s.style.display="none",s.innerText=getCustomIconAttr(G_ICON_FULL_SET[r])["desc_"+e._config.lang],t.appendChild(s));else if(null!=dext5_lang.icon[n]&&void 0!=dext5_lang.icon[n])if("design"==n||"source"==n||"preview"==n||"text"==n)0<e._config.statusBarTitle.length&&void 0!=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?""!=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?t.setAttribute("title",e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]):t.setAttribute("title",dext5_lang.icon[n]):t.setAttribute("title",dext5_lang.icon[n]);else try{s=document.createElement("span"),s.style.display="none",s.innerText=dext5_lang.icon[n],"A"==t.nodeName?(t.setAttribute("title",dext5_lang.icon[n]),t.appendChild(s)):"SPAN"==t.nodeName&&t.parentNode&&"A"==t.parentNode.nodeName&&(t.parentNode.setAttribute("title",dext5_lang.icon[n]),t.parentNode.appendChild(s))}catch(o){}switch(n){case"top_design":case"top_source":case"top_preview":case"top_text":0<e._config.statusBarTitle.length&&void 0!=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]?(""!=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]?t.getElementsByTagName("A")[0].title=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]:t.getElementsByTagName("A")[0].title=dext5_lang.icon[n.replace("top_","")],DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx++):t.getElementsByTagName("A")[0].title=dext5_lang.icon[n.replace("top_","")],t.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[n.replace("top_","")]}switch(n){case"design":case"source":case"preview":case"text":0<e._config.statusBarTitle.length&&void 0!=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?(""!=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?t.getElementsByTagName("A")[0].title=e._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]:t.getElementsByTagName("A")[0].title=dext5_lang.icon[n],DEXTTOP.G_CURREDITOR.statusBarTitleIdx++):t.getElementsByTagName("A")[0].title=dext5_lang.icon[n],t.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[n]}var u=function(t){return function(n){e._dextCommands(e.ID,t),"shortcut"==t&&(G_ShortCutClick=!0),DEXTTOP.DEXT5.util.stopEvent(n)}}(n),a="";switch(n){case"font_family":case"font_size":case"letter_spacing":a="click";break;default:a="click"}DEXTTOP.DEXT5.util.addEvent(t,a,u),t.onmousedown=function(){return!1},t.unselectable="on",u=function(t){return function(n){if(!(-1<",detail_table_insert,detail_list_number,detail_list_bullets,align_group_detail,order_of_objects_detail,table_group_detail,detail_font_color,detail_font_bg_color,detail_cell_bg_color,detail_insert_datetime,".indexOf(","+t+","))){var r=document.getElementById("dext_span_"+e.ID+t);null!=r&&(""==r.style.backgroundImage&&-1<r.className.indexOf("_on")&&(r.style.backgroundImage="url("+e._config.webPath.image+"skin/"+e._config.style.skinName+"/icon_skinback.gif)"),DEXTTOP.DEXT5.util.stopEvent(n)),DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose()}}}(n),n=function(t){return function(n){var r=document.getElementById("dext_span_"+e.ID+t);null!=r&&(0<r.style.backgroundImage.indexOf("skinback.gif")&&(r.style.backgroundImage=""),DEXTTOP.DEXT5.util.stopEvent(n))}}(n),DEXTTOP.DEXT5.util.addEvent(t,"mouseover",u),DEXTTOP.DEXT5.util.addEvent(t,"mouseout",n)}t=function(){return function(t){document.getElementById("ue_toolbar_"+e.ID).onselectstart="",t=t.target||t.srcElement,t.selectionStart=0,t.selectionEnd=t.value.length}}(),r=function(){return function(t){document.getElementById("ue_toolbar_"+e.ID).onselectstart=new Function("return false")}}(),i=function(){return function(){DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0}}(),s=document.getElementById("txtara_"+e.ID+"font_family"),n=document.getElementById("txtara_"+e.ID+"font_size"),u=document.getElementById("txtara_"+e.ID+"line_height"),a=document.getElementById("ue_"+e.ID+"zoom_text"),s&&(DEXTTOP.DEXT5.util.addEvent(s,"focus",t),DEXTTOP.DEXT5.util.addEvent(s,"blur",r),DEXTTOP.DEXT5.util.addEvent(s,"mousedown",i)),n&&(DEXTTOP.DEXT5.util.addEvent(n,"focus",t),DEXTTOP.DEXT5.util.addEvent(n,"blur",r),DEXTTOP.DEXT5.util.addEvent(n,"mousedown",i)),u&&(DEXTTOP.DEXT5.util.addEvent(u,"focus",t),DEXTTOP.DEXT5.util.addEvent(u,"blur",r),DEXTTOP.DEXT5.util.addEvent(u,"mousedown",i)),a&&DEXTTOP.DEXT5.util.addEvent(a,"mousedown",i),this._load_editor_frame(!0)},_load_editor_frame:function(e){var t=this;void 0==t._EDITOR&&DEXTTOP.G_CURREDITOR&&""!=DEXTTOP.G_CURREDITOR._config.directEditHtmlUrl&&(t=DEXTTOP.G_CURREDITOR),t._EDITOR.design=document.getElementById("dext5_design_"+t.ID),t._EDITOR.source=document.getElementById("dext5_source_"+t.ID),t._EDITOR.preview=document.getElementById("dext5_preview_"+t.ID),t._EDITOR.text=document.getElementById("dext5_text_"+t.ID);var n=t._EDITOR.design;t._DOC=n.contentDocument?n.contentDocument:n.contentWindow.document,G_USE_EDITOR_ID=t.ID,DEXTTOP.G_CURREDITOR=t,t._BODY=t._DOC.body,"1"!=t._config.browserSpellCheck&&"spellcheck"in t._BODY&&(t._BODY.spellcheck=!1),"contentEditable"in t._BODY&&(isViewMode(t)?t._BODY.contentEditable=!1:t._BODY.contentEditable=e&&(""!=t._config.focusInitObjId||t.autoMoveInitFocusData.targetNode)?!1:!0,0==t._config.editorBodyEditable&&(t._BODY.contentEditable=!1)),LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID),LayerFrame.title=dext5_lang.iframe_title.layer,dext_src_init_once(n,t),dext_src_init(n),0<_iframeDoc.body.clientWidth&&(t._defTableWidth=_iframeDoc.body.clientWidth-30,t._defaultWidth=_iframeDoc.body.clientWidth-30),100>t._defTableWidth&&(t._defTableWidth=400,t._defaultWidth=400),"1"==t._config.useFontSizeKeyin?document.getElementById("txtara_"+t.ID+"font_size")&&("1"==t._setting.show_font_real?document.getElementById("txtara_"+t.ID+"font_size").value=t._setting.font_size:document.getElementById("txtara_"+t.ID+"font_size").value=dext5_lang.icon.font_size):document.getElementById("ue_"+t.ID+"font_size")&&("1"==t._setting.show_font_real?document.getElementById("ue_"+t.ID+"font_size").innerHTML="<span>"+t._setting.font_size+"</span>":document.getElementById("ue_"+t.ID+"font_size").innerHTML="<span>"+dext5_lang.icon.font_size+"</span>"),"1"==t._config.useFontFamilyKeyin?document.getElementById("txtara_"+t.ID+"font_family")&&("1"==t._setting.show_font_real?document.getElementById("txtara_"+t.ID+"font_family").value=getDisplayFontName(t._setting.font_family):document.getElementById("txtara_"+t.ID+"font_family").value=getDisplayFontName(dext5_lang.icon.font_family)):document.getElementById("ue_"+t.ID+"font_family")&&("1"==t._setting.show_font_real?document.getElementById("ue_"+t.ID+"font_family").innerHTML="<span>"+getDisplayFontName(t._setting.font_family)+"</span>":document.getElementById("ue_"+t.ID+"font_family").innerHTML="<span>"+getDisplayFontName(dext5_lang.icon.font_family)+"</span>"),document.getElementById("ue_"+t.ID+"letter_spacing")&&(document.getElementById("ue_"+t.ID+"letter_spacing").innerHTML="<span>"+dext5_lang.icon.letter_spacing+"</span>"),""!=t._config.defaultMessage&&(n=t._BODY.innerHTML,"<p></p>"==n||"<P></P>"==n?t._BODY.innerHTML="<p>"+t._config.defaultMessage+"</p>":t._config.defaultMessage="");if(e){e=function(){return function(e){try{if(e=_dext_editor,null==e&&"undefined"!=typeof DEXTTOP&&null!=DEXTTOP&&DEXTTOP.G_CURREDITOR&&(e=DEXTTOP.G_CURREDITOR),e&&e._config.isLoadedEditor){if(0==isDEXTContainerMode())try{resizeEditor(e,!1)}catch(t){}setToolbarScroll(e),"1"==e._config.tool_bar_grouping&&(groupingIcon(e),setPositionGroupingDiv(1),setPositionGroupingDiv(2)),"1"==e._config.ruler.useResizeEvent&&setRulerPositionForNode(e)}}catch(n){}}}(),DEXTTOP.DEXT5.util.addEvent(window,"resize",e);try{if(setTimeout(function(){var e=null;try{e=_dext_editor.Frame}catch(t){}if(null!=e){var n;if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var r=DEXTTOP.DEXTWIN.localStorage["dext_"+e.editor.ID+"_auto_list"];r&&(n=0<r?1<r?0:1:e.editor._config.autoList.use)}DEXTTOP.G_CURREDITOR.autoListUse=void 0!=n?n:e.editor._config.autoList.use;try{setAutoSave(e.editor,!0)}catch(i){}try{isViewMode(e.editor)?e.editor._BODY.style.cursor="auto":showRuler(e.editor)}catch(s){}try{if(""!=e.editor._config.setValueObjId){var o=DEXTTOP.DEXTDOC.getElementById(e.editor._config.setValueObjId);if(o){var u=o.value;""!=u&&DEXTTOP.DEXT5.setHtmlContents(u,e.editor.ID)}}}catch(a){}n=e.editor._config.statusBarInitMode;if("design"!=n){for(var r=!1,o=e.editor._config.statusBarItem,u=o.length,f=0;f<u;f++)if("design"==o[f]){r=!0;break}r||(e.editor._EDITOR.design.style.width="0px",e.editor._EDITOR.design.style.height="0px"),DEXTTOP.DEXT5.ShowTextChangeAlert=!1,e.editor._dextCommands(e.editor.ID,n),DEXTTOP.DEXT5.ShowTextChangeAlert=!0}var l=function(e){try{if("ieplugin"==e.editor._config.runtimes)try{for(var t in e.editor._config.addHttpHeader)G_dext5plugIn.AddHttpHeader(t,e.editor._config.addHttpHeader[t])}catch(n){}"2"==e.editor._config.undoMode&&e.editor.UndoManager.putUndo(!0),""!=e.editor._config.directEditHtmlUrl&&loadDirectEditHtmlUrl(e.editor._config),onChange({editor:DEXTTOP.G_CURREDITOR}),G_BODY_DEFAULT_VALUE=e.editor._BODY.innerHTML;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.loadedEvent?DEXTTOP.G_CURREDITOR._config.event.loadedEvent(e):"function"==typeof e.editor._config.LoadedEvent?DEXTTOP.DEXT5.config.LoadedEvent(e):DEXTTOP.DEXTWIN.dext_editor_loaded_event(e)}catch(r){}1==e.editor.isInitFocusHandler&&0==e.editor._config.initFocus?e.editor.isInitFocusHandler=!1:setRulerPositionForNode(e.editor,!0);if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&("0"!=e.editor._config.setAutoSave.mode||"1"==e.editor._config.setAutoSave.useManuallySave))for(var i=parseIntOr0(e.editor._config.setAutoSave.maxCount);8>i;i++)localStorage.removeItem("dext_"+e.editor.ID+"_"+i);"1"==e.editor._config.autoBodyFit&&setBodyFitStyle(e.editor,!0),setEditorIframeTitle(e.editor);if(DEXTTOP.DEXT5.InitEditorDataHashTable){var s=DEXTTOP.DEXT5.InitEditorDataHashTable.getItem(e.editor.ID);"undefined"!=typeof s&&("object"==typeof s?"setHtmlValueExWithDocType"==s.mode?DEXTTOP.DEXT5.setHtmlValueExWithDocType(s.value,e.editor.ID):"setHtmlValueEx"==s.mode?DEXTTOP.DEXT5.setHtmlValueEx(s.value,e.editor.ID):"setHtmlValue"==s.mode?DEXTTOP.DEXT5.setHtmlValue(s.value,e.editor.ID):"setBodyValueEx"==s.mode?DEXTTOP.DEXT5.setBodyValueEx(s.value,e.editor.ID):"setBodyValueExLikeDiv"==s.mode?DEXTTOP.DEXT5.setBodyValueExLikeDiv(s.value,e.editor.ID):"setBodyValue"==s.mode?DEXTTOP.DEXT5.setBodyValue(s.value,e.editor.ID):"loadHtmlValueExFromURL"==s.mode?DEXTTOP.DEXT5.loadHtmlValueExFromURL(s.value,e.editor.ID):"loadHtmlValueExFromServerURL"==s.mode?DEXTTOP.DEXT5.loadHtmlValueExFromServerURL(s.value,e.editor.ID):"setDirectEditHtmlUrl"==s.mode?DEXTTOP.DEXT5.setDirectEditHtmlUrl(s.value,e.editor.ID):"setOriginalHtmlValue"==s.mode?DEXTTOP.DEXT5.setOriginalHtmlValue(s.value,e.editor.ID):"setHtmlContents"==s.mode&&DEXTTOP.DEXT5.setHtmlContents(s.value,e.editor.ID):DEXTTOP.DEXT5.setHtmlContentsEw(s,e.editor.ID),DEXTTOP.DEXT5.InitEditorDataHashTable.removeItem(e.editor.ID))}}catch(o){}try{if(""!=e.editor._config.focusInitObjId||e.editor.autoMoveInitFocusData.targetNode){var u;""!=e.editor._config.focusInitObjId?(u=DEXTTOP.DEXTDOC.getElementById(e.editor._config.focusInitObjId),e.editor._config.focusInitObjIdEx=e.editor._config.focusInitObjId,e.editor._config.focusInitObjId=""):e.editor.autoMoveInitFocusData.targetNode&&(u=e.editor.autoMoveInitFocusData.targetNode,e.editor.autoMoveInitFocusData.targetNodeEx=e.editor.autoMoveInitFocusData.targetNode,e.editor.autoMoveInitFocusData.targetNode=null),u?setTimeout(function(){var t=DEXTTOP.DEXTDOC.getElementById(e.editor._config.tabIndexObjId);t&&(t.tabIndex=""!=e.editor._config.tabIndexObjValue?e.editor._config.tabIndexObjValue:"0",e.editor._config.tabIndexObjId=""),u.focus(),!isViewMode(e.editor)&&e.editor._config.editorBodyEditable&&(e.editor._BODY.contentEditable=!0)},100):0==isViewMode(e.editor)&&setTimeout(function(){!isViewMode(e.editor)&&e.editor._config.editorBodyEditable&&(e.editor._BODY.contentEditable=!0)},200)}}catch(a){}try{""!=e.editor._config.focusInitEditorObjId&&setTimeout(function(){DEXTTOP.DEXT5.setFocusToObject(e.editor._config.focusInitEditorObjId,!1,e.editor.ID),e.editor._config.focusInitEditorObjId=""},2e3)}catch(f){}try{"function"==typeof DEXTTOP.DEXTWIN.editor_loaded_event&&DEXTTOP.DEXTWIN.editor_loaded_event(e)}catch(l){}};try{try{DEXT5_EDITOR.prototype._setLazyLoadFrame(e.editor.ID)}catch(c){}try{var h=DEXTTOP.DEXTDOC.getElementById("dext_toolmenu_background"+e.editor.ID);h&&h.parentNode.removeChild(h)}catch(p){}try{var d=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+e.editor.ID);d&&d.parentNode.removeChild(d)}catch(v){}try{var m=DEXTTOP.DEXTDOC.getElementById("dext_context_background");m&&m.parentNode.removeChild(m)}catch(g){}try{var y=DEXTTOP.DEXTDOC.getElementById("dext_disabled");y&&y.parentNode.removeChild(y)}catch(b){}try{var w=DEXTTOP.DEXTDOC.getElementById("dext_dialog");w&&w.parentNode.removeChild(w)}catch(E){}DEXTTOP.DEXT5.setDirty(e.editor.ID),e.editor._config.isLoadedEditor=!0,setScrollStyleForIOS(e.editor),0!=e.editor._config.initFocus||DEXTTOP.DEXT5.browser.ie||(e.editor.isInitFocusHandler=!1),null==DEXTTOP.DEXT5.IsEditorLoadedHashTable&&(DEXTTOP.DEXT5.IsEditorLoadedHashTable=new DEXTTOP.DEXT5.util.hashTable),"1"!=DEXTTOP.DEXT5.IsEditorLoadedHashTable.getItem(e.editor.ID)&&DEXTTOP.DEXT5.IsEditorLoadedHashTable.setItem(e.editor.ID,"1"),showWordCount();try{for(var S in G_DEPlugin)"function"==typeof G_DEPlugin[S].onLoaded&&G_DEPlugin[S].onLoaded()}catch(x){}var T=function(){var e=!0;try{for(var t in G_DEPlugin)if("function"==typeof G_DEPlugin[t].isRequiredCheck&&(e=G_DEPlugin[t].isRequiredCheck(),!0!==e))break}catch(n){e=!0}return e};if(T())l(e);else var N=setInterval(function(){1==T()&&(clearInterval(N),l(e))},500)}catch(C){}}},100),0==this._config.style.InitVisible)try{this._config.visibility=!1,LayerFrame.parentElement.style.height="0px",LayerFrame.parentElement.style.display="none"}catch(r){}}catch(i){}}},_cmd_new:function(){0==DEXTTOP.DEXT5.isEmpty()?1==confirm(dext5_lang.msg.newDocument)&&(command_InsertDogBGImg(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._EDITOR.design,"Y","","","","",[]),DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter):(command_InsertDogBGImg(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._EDITOR.design,"Y","","","","",[]),DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter)},_dextCommands:function(e,t,n){setDEXTWINDOC(),G_USE_EDITOR_ID=e,DEXTTOP.G_CURREDITOR=this;var r=!1;if(!(-1<(","+this.lockCommand.join(",")+",").indexOf(","+t+","))){var i=null;0>",insert_layer,element_position,order_of_objects,order_of_objects_detail,bring_to_front,send_to_back,bring_forward,send_backward,".indexOf(","+t+",")&&getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&(i=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.selection(i));var s=!1;null!=G_LAST_CMD&&-1<G_LAST_CMD.indexOf("align_")&&-1<t.indexOf("align_")&&(s=!0),G_LAST_CMD=t,checkDefaultMessage();if("1"!=this._config.formMode&&"1"==this._config.userTableLock.use){var o=GetTableSelectionCells(),u=o.length;if(0<u){var a=GetParentbyTagName(o[0],"table"),f=this._config.userTableLock.defaultTableLockMode;"2"==this._config.userTableLock.tableLockMode?checkLockAttr(a,!0)&&checkLockAttr(o[0],!0)?a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(f=a.getAttribute("lock_mode")):f="0":a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(f=a.getAttribute("lock_mode"));var l=!0;"1"==f?l=!1:"0"==f&&(l=!1),f=!1;for(a=0;a<u;a++){if(checkLockAttr(o[a],!l)){f=!0;break}var c=[];c.push(o[a].getElementsByTagName("table")),c.push(o[a].getElementsByTagName("td"));var h=c.length;for(j=0;j<h;j++){var p=c[j].length;for(k=0;k<p;k++)if(checkLockAttr(c[j][k],!0)){f=!0;break}if(f)break}if(f)break}if(f)return}else if(l=getFirstRange().range.startContainer,3==l.nodeType&&(l=l.parentNode),o=GetTDTHCell(l),a=GetParentbyTagName(l,"table"),f=this._config.userTableLock.defaultTableLockMode,a&&("2"==this._config.userTableLock.tableLockMode?checkLockAttr(a,!0)&&checkLockAttr(o,!0)?a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(f=a.getAttribute("lock_mode")):f="0":a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(f=a.getAttribute("lock_mode"))),l=!0,"1"==f?l=!1:"0"==f&&(l=!1),u=!1,u=l?checkLockAttr(a,!l)||checkLockAttr(o,!l):checkLockAttr(o,!l))return}l=document.getElementById("ue_"+e+t);if(!l||!(l.parentNode&&null!=l.parentNode.className.match(/_off/gi)||l.parentNode.parentNode&&null!=l.parentNode.parentNode.className.match(/_off/gi)||l.parentNode.parentNode.parentNode&&null!=l.parentNode.parentNode.parentNode.className.match(/_off/gi))){AdjustDesignBodyWidth({editor:DEXTTOP.G_CURREDITOR,isApply:!0});if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&t&&("detail_table_insert_new"==t||"detail_table_insert"==t||0>t.indexOf("detail"))&&"table_insert"!=t&&"font_bg_color"!=t&&"font_color"!=t&&"font_family"!=t&&"font_size"!=t&&"line_height"!=t&&"formatting"!=t){o=!1,o=isGroupingIcon(e,t);if(!o)for(u=DEXTTOP.G_CURREDITOR.detailSubCmd,f=u.length,a=0;a<f;a++)if(u[a]==t){o=!0;break}o&&hideGroupingBox()}if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._RangeBlurBug=!0;try{var d=saveSelection(e);8<DEXTTOP.DEXT5.browser.ieVersion?0==(9==d.startContainer.nodeType||9==d.endContainer.nodeType)&&(DEXTTOP.G_CURREDITOR._LastRange=d):null==DEXTTOP.G_CURREDITOR._LastRange&&d&&0!=d.offsetLeft&&0!=d.offsetTop&&(DEXTTOP.G_CURREDITOR._LastRange=d)}catch(v){}}try{if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var m=getFirstRange().range;"design"==t||m.startContainer!=m.endContainer||m.startContainer!=m.commonAncestorContainer||9!=m.startContainer.nodeType&&"body"!=m.startContainer.nodeName.toLowerCase()||doSetCaretPosition(_iframeDoc.body.firstChild,0)}}catch(g){}switch(t){case"clean_nested_tag":DEXTTOP.DEXT5.cleanNestedTag(dext5_lang.msg.clean_nested_tag,"","1",this._config.cleanNestedTagOptions.nestedCount,"p,div",this.ID),r=!0;break;case"grid":command_grid(e,this),r=!0;break;case"insert_file":case"insert_file_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_file),r=!0;break;case"file_open":if(G_dext5plugIn)try{n&&n.hide(),file_open_plugin()}catch(y){DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open)}else DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open);break;case"new":this._cmd_new();break;case"save":command_saveAs(e,this);break;case"save_as":command_saveAs(e,this,!0);break;case"print":command_print(e,this);break;case"pagebreak":command_pagebreak(e,this);break;case"undo":command_undo(e,this),r=!0;break;case"redo":command_redo(e,this),r=!0;break;case"copy":command_copy(e,this);break;case"cut":command_cut(e,this);break;case"text_paste":case"paste":if(!checkCanPasteToIamge()||"1"!=this._config.pasteToImage&&"2"!=this._config.pasteToImage||"text_paste"==t){if("text_paste"==t&&"1"==DEXTTOP.G_CURREDITOR.setTextPasteMode){command_pastetext(e,this);break}"text_paste"==t&&(DEXTTOP.G_CURREDITOR.setTextPaste=!0),command_pastehtml(e,this)}else command_pastehtml(e,this,"");r=!0;break;case"paste_dialog":alert(dext5_lang.paste_dialog.msg),r=!0;break;case"paste_to_image":command_pastehtml(e,this,"jpg",!1),r=!0;break;case"paste_to_image_detail":command_pastehtml(e,this,"",n),r=!0;break;case"table_copy":command_tableCopy(e,this);break;case"table_content_paste":case"table_paste":command_tablePaste(e,this),r=!0;break;case"intable_paste":command_intablePaste(e,this),r=!0;break;case"find":g_findRepalceRange=null,DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.find);break;case"replace":g_findRepalceRange=null,DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.replace);break;case"emoticon":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_emoticon):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.emoticon),r=!0;break;case"setting":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.setting);break;case"horizontal_line":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.horizontal_line),r=!0;break;case"image_create":r=!0;if(G_dext5plugIn&&"base64"==this._config.uploadMethod&&"-1"!=this._config.maxImageBase64fileCount&&getBase64ImageCount()>=parseInt(this._config.maxImageBase64fileCount,10)){t=dext5_lang.msg.max_base64file_count,t=t.replace("{0}",this._config.maxImageBase64fileCount),alert(t);return}null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image):G_dext5plugIn?showSetImageProperty(null):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;case"image_property":r=!0;if(G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT)showSetImageProperty(DEXTTOP.G_SELECTED_ELEMENT);else{if(null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)){DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image);break}DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image)}break;case"image_editor":r=!0,G_dext5plugIn&&showImageEditor(null);break;case"image_editor_property":r=!0,G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT&&-1!=DEXTTOP.G_SELECTED_ELEMENT.src.search("file:///")&&showImageEditor(DEXTTOP.G_SELECTED_ELEMENT);break;case"flash_create":case"flash_property":r=!0,DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.flash);break;case"media_create":case"media_property":r=!0,DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.media);break;case"iframe_create":case"iframe_property":r=!0,DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.iframe);break;case"hyperlink_create":case"hyperlink_property":r=!0;if(null==DEXTTOP.G_SELECTED_ELEMENT)try{var b=getFirstRange().range,w=b.startContainer;3==w.nodeType&&(w=w.parentNode);var E=GetParentbyTagName(w,"a");E&&(DEXTTOP.G_SELECTED_ELEMENT=E)}catch(S){}try{if(DEXTTOP.G_SELECTED_ELEMENT&&"A"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&(E=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"a"))&&(DEXTTOP.G_SELECTED_ELEMENT=E),DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName){var x=getFirstRange().sel;x.removeAllRanges(),b=getFirstRange().range,b.selectNode(DEXTTOP.G_SELECTED_ELEMENT),x.addRange(b)}}catch(T){}DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.hyperlink);break;case"remove_hyperlink":r=!0;if(null==DEXTTOP.G_SELECTED_ELEMENT)try{if(b=getFirstRange().range,w=b.startContainer,3==w.nodeType&&(w=w.parentNode),E=GetParentbyTagName(w,"a"))DEXTTOP.G_SELECTED_ELEMENT=E}catch(N){}try{if(DEXTTOP.G_SELECTED_ELEMENT&&"A"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&(E=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"a"))&&(DEXTTOP.G_SELECTED_ELEMENT=E),DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName){if(DEXTTOP.G_SELECTED_ELEMENT.style.color&&""!=DEXTTOP.G_SELECTED_ELEMENT.style.color){var C=_iframeDoc.createElement("span");C.style.color=DEXTTOP.G_SELECTED_ELEMENT.style.color,C.innerHTML=DEXTTOP.G_SELECTED_ELEMENT.innerHTML,DEXTTOP.G_SELECTED_ELEMENT.parentNode.replaceChild(C,DEXTTOP.G_SELECTED_ELEMENT)}else{for(var L=DEXTTOP.G_SELECTED_ELEMENT.childNodes;0<L.length;)DEXTTOP.G_SELECTED_ELEMENT.parentNode.insertBefore(L[0],DEXTTOP.G_SELECTED_ELEMENT);DEXTTOP.G_SELECTED_ELEMENT.parentNode.removeChild(DEXTTOP.G_SELECTED_ELEMENT)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}catch(A){}break;case"bookmark":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.bookmark);break;case"symbol":m=getFirstRange().range,n=getMyElementNode(m.startContainer),i="",n&&1==n.nodeType&&(i=getElementInParentStyleProperty(n,"fontFamily"),""==i&&(i=DEXTTOP.DEXT5.util.getStyle(n,"fontFamily"))),""==i&&(i=this._setting.font_family),this._config.currFontFamily=i,DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.symbol);break;case"doc_bg_image":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.doc_bg_img),r=!0;break;case"detail_table_insert":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table),r=!0;break;case"detail_table_insert_new":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table),r=!0;break;case"table_insert":r=!0;if(DEXTTOP.DEXT5.browser.mobile)DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);else{if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(n=document.getElementById("ue_"+e+"table_insert"),(n=GetParentbyTagName(n,"ul"))&&-1<n.id.indexOf("ul_tool_bar_grouping"))){hideGroupingBox(),DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break}this._dextTable.show(e)}break;case"table_delete":command_deleteTable(e,this),r=!0;break;case"merge_cell":command_mergeCell(e,this),r=!0;break;case"split_cell":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.split_cell),r=!0;break;case"insert_row_up":command_insertRowUp(e,this),r=!0;break;case"insert_row_down":command_insertRowDown(e,this),r=!0;break;case"delete_row":command_deleteRow(e,this),r=!0;break;case"insert_column_left":command_insertCellLeft(e,this),r=!0;break;case"insert_column_right":command_insertCellRight(e,this),r=!0;break;case"delete_column":command_deleteCell(e,this),r=!0;break;case"table_indent":command_tableIndentOutdent(e,this,"indent"),r=!0;break;case"table_outdent":command_tableIndentOutdent(e,this,"outdent"),r=!0;break;case"table_selection":command_tableSelection(e,this);break;case"table_select_cell":command_TableSelect(e,this,"select_cell");break;case"table_select_row":command_TableSelect(e,this,"select_row");break;case"table_select_column":command_TableSelect(e,this,"select_column");break;case"table_select_all":command_TableSelect(e,this,"select_all");break;case"table_same_width":command_TableSameWidthheight(e,this,"same_width"),r=!0;break;case"table_same_height":command_TableSameWidthheight(e,this,"same_height"),r=!0;break;case"table_same_widthheight":command_TableSameWidthheight(e,this,"same_widthheight"),r=!0;break;case"table_row_clone":command_TableRowClone(e,this),r=!0;break;case"convert_table_to_text":command_convertTableToText(e,this),r=!0;break;case"cell_border":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_border,DEXTTOP.G_SELECTED_ELEMENT),r=!0;break;case"cell_bg_color":command_cellBGColor(e,this._EDITOR.design),r=!0;break;case"detail_cell_bg_color":showColorPopup(document,l,void 0,"detail_cell_bg_color");break;case"insert_row_column":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_row_column),r=!0;break;case"cell_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_property,DEXTTOP.G_SELECTED_ELEMENT),r=!0;break;case"row_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.row_property),r=!0;break;case"column_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.column_property),r=!0;break;case"table_property":ClearDraggingTableCellSelected(),DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT),r=!0;break;case"table_group":this._dextListTables.show(e),r=!0;break;case"table_group_detail":this._dextListTables.show(e),r=!0;break;case"table_adjust":command_AdjustTableAndCellWidth(e,this),r=!0;break;case"bold":command_bold(e,this),r=!0;break;case"underline":command_underline(e,this),r=!0;break;case"italic":command_italic(e,this),r=!0;break;case"strike_through":command_strikeThrough(e,this),r=!0;break;case"superscript":command_superscript(e,this),r=!0;break;case"subscript":command_subscript(e,this),r=!0;break;case"remove_format":command_removeFormat(e,this),r=!0;break;case"remove_css":command_removeCss(e,this),r=!0;break;case"font_color":command_fontColor(e,this._EDITOR.design),r=!0;break;case"detail_font_color":showColorPopup(document,l,void 0,"detail_font_color"),r=!0;break;case"font_bg_color":command_fontBgColor(e,this._EDITOR.design),r=!0;break;case"detail_font_bg_color":showColorPopup(document,l,void 0,"detail_font_bg_color"),r=!0;break;case"align_left":command_align(e,this,"left",s,i),r=!0;break;case"align_center":command_align(e,this,"center",s,i),r=!0;break;case"align_right":command_align(e,this,"right",s,i),r=!0;break;case"align_full":command_align(e,this,"justify",s,i),r=!0;break;case"align_group":this._dextListAligns.show(e),r=!0;break;case"align_group_detail":this._dextListAligns.show(e),r=!0;break;case"line_height":this._dextLineHeight.show(e),r=!0;break;case"line_height_inc":case"line_height_dec":command_lineHeightIncDec(e,t,this),r=!0;break;case"indent":command_indent(e,this),r=!0;break;case"outdent":command_outdent(e,this),r=!0;break;case"list_number":command_insertOrderedList(e,this),r=!0;break;case"list_bullets":command_insertUnOrderedList(e,this),r=!0;break;case"detail_list_number":this._dextListNumber.show(e),r=!0;break;case"detail_list_bullets":this._dextListBullets.show(e),r=!0;break;case"list_decimal":command_listDecimal(e,this),r=!0;break;case"list_decimal_leading_zero":command_listDecimalLeadingZero(e,this),r=!0;break;case"list_lower_alpha":command_listLowerAlpha(e,this),r=!0;break;case"list_lower_greek":command_listLowerGreek(e,this),r=!0;break;case"list_lower_roman":command_listLowerRoman(e,this),r=!0;break;case"list_upper_alpha":command_listUpperAlpha(e,this),r=!0;break;case"list_upper_roman":command_listUpperRoman(e,this),r=!0;break;case"list_disc":command_listDisc(e,this),r=!0;break;case"list_circle":command_listCircle(e,this),r=!0;break;case"list_square":command_listSquare(e,this),r=!0;break;case"list_none_N":command_listNone_N(e,this),r=!0;break;case"list_none_B":command_listNone_B(e,this),r=!0;break;case"full_screen":command_fullScreen(e,this),showRuler(this);break;case"formatting":this._dextFormatting.show(e),r=!0;break;case"font_family":this._dextFontFamily.show(e),r=!0;break;case"font_size":this._dextFontSize.show(e),r=!0;break;case"font_size_inc":case"font_size_dec":command_fontSizeIncDec(e,t,this),r=!0;break;case"letter_spacing":this._dextLetterSpacing.show(e),r=!0;break;case"letter_spacing_inc":case"letter_spacing_dec":command_letterSpacingIncDec(e,t,this),r=!0;break;case"top_design":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_design"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_design");break;case"top_source":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_source"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_source");break;case"top_preview":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_preview"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_preview");break;case"top_text":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_text"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_text");break;case"design":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("design"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("design");break;case"source":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("source"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("source");break;case"preview":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("preview"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("preview");break;case"text":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("text"),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("text");break;case"about":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.about);break;case"select_all":command_selectAll(e,this);break;case"valign_up":command_VerticalAlignExcute(e,this,"top"),r=!0;break;case"valign_center":command_VerticalAlignExcute(e,this,"middle"),r=!0;break;case"valign_baseline":command_VerticalAlignExcute(e,this,"baseline"),r=!0;break;case"valign_bottom":command_VerticalAlignExcute(e,this,"bottom"),r=!0;break;case"template":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.template),r=!0;break;case"tool_replace":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.tool_replace);break;case"insert_link_media":r=!0,null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_insert_link_media):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_link_media);break;case"shortcut":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.shortcut);break;case"load_auto_save":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.load_auto_save);break;case"ruler":command_useRuler(e);break;case"layout":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.layout),r=!0;break;case"dirltr":command_Direction(e,this,"LTR"),r=!0;break;case"dirrtl":command_Direction(e,this,"RTL"),r=!0;break;case"format_painter":command_formatPainter(e,this);break;case"apply_format":command_applyFormat(e,this),r=!0;break;case"image_align_default":command_imageAlign(e,this,""),r=!0;break;case"image_align_left":command_imageAlign(e,this,"left"),r=!0;break;case"image_align_right":command_imageAlign(e,this,"right"),r=!0;break;case"list_blockquote":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.blockquote),r=!0;break;case"placeholder":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.placeholder),r=!0;break;case"input_textfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_text),r=!0;break;case"input_radio":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_radio),r=!0;break;case"input_checkbox":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_checkbox),r=!0;break;case"input_button":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_button),r=!0;break;case"input_hiddenfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_hidden),r=!0;break;case"input_textarea_property":case"input_textarea":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_textarea),r=!0;break;case"input_select_property":case"input_select":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_select),r=!0;break;case"input_imagebutton":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_image),r=!0;break;case"input_same_width":command_inputSameWidthHeight(e,this,"width"),r=!0;break;case"input_same_height":command_inputSameWidthHeight(e,this,"height"),r=!0;break;case"input_same_width_height":command_inputSameWidthHeight(e,this,"widthheight"),r=!0;break;case"accessibility_validation":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.accessibility_validation);break;case"horizontal_sum":case"vertical_sum":case"horizontal_avg":case"vertical_avg":command_calculationFormula(e,this,t),r=!0;break;case"show_blocks":command_showBlocks(e,this);break;case"table_lock":command_tableLock(e,this),r=!0;break;case"cell_lock":command_cellLock(e,this),r=!0;break;case"table_lock_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table_lock_property),r=!0;break;case"help":command_help(e,this);break;case"word_transform":command_wordTransform(e,this),r=!0;break;case"photo_editor":command_InsertImagePhotoEdit(e,this),r=!0;break;case"mini_photo_editor":r=!0,n=n?!0:!1,0==!!DEXTTOP.DEXT5.isClickedMiniPhoto&&(DEXTTOP.DEXT5.isClickedMiniPhoto=!0,command_InsertMiniPhotoEditor(e,this,n));break;case"photo_editor_property":command_photoEditProperty(e,this),r=!0;break;case"table_border":command_showTableBorder(e,this),r=!0;break;case"pastetoimage":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.pastetoimage),r=!0;break;case"insert_layer":command_insertLayer(e,this),r=!0;break;case"element_position":command_elementPosition(e,this);break;case"order_of_objects":this._dextElementZindex.show(e),r=!0;break;case"order_of_objects_detail":this._dextElementZindex.show(e),r=!0;break;case"bring_to_front":command_elementZindex(e,this,1),r=!0;break;case"send_to_back":command_elementZindex(e,this,2),r=!0;break;case"bring_forward":command_elementZindex(e,this,3),r=!0;break;case"send_backward":command_elementZindex(e,this,4),r=!0;break;case"insert_datetime":command_insert_datetime(e,this),r=!0;break;case"detail_insert_datetime":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_datetime);break;case"conversion":canConversion()?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.conversion):alert(dext5_lang.conversion.msg2);break;case"personal_data":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.personal_data),r=!0;break;case"forbidden_word":command_forbidden_word(e,this,"ICON");break;case"video":case"video_property":r=!0,null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_video):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.video);break;case"spell_check":r=!0,this._LastRange=g_findRepalceRange=null,doSetCaretPosition(_iframeDoc.body.firstChild,0),null==this.DEXT5WordApp&&(this.DEXT5WordApp=new ActiveXObject("Word.Application"),this.DEXT5WordDoc=this.DEXT5WordApp.Documents.Add());var O=this;setTimeout(function(){DEXT5_EDITOR.prototype.dialog.show(O._config.webPath.page,O._config.pages.spell_check)},1e3);break;case"calculator":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.calculator);break;case"zoom":this._dextzoom.show(e);break;case"zoom_plus":command_zoom(e,this,"p");break;case"zoom_minus":command_zoom(e,this,"m");break;case"paragraph_attribute":restoreSelection(),n=getApplyNodes("p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ")),i=n.length,DEXTTOP.G_SELECTED_ELEMENT=null,1==i&&(DEXTTOP.G_SELECTED_ELEMENT=n[0]),DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.paragraph_attribute);break;case"insert_table_top_paragraph":case"insert_table_bottom_paragraph":command_InsertTableTopBottomParagraph(t,this),r=!0;break;case"body_fit":command_bodyFit(e,this),r=!0;break;case"hyperlink_open":case"filelink_open":window.open(DEXTTOP.G_SELECTED_ELEMENT.href);break;case"manually_temp_save":DEXTTOP.DEXT5.ManuallyTempSave(e);break;case"status_source":case"status_preview":case"status_text":G_LAST_CMD=-1<l.parentElement.className.indexOf("uebutton_span_enter")?"design":t.replace("status_",""),"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode(G_LAST_CMD),hideProcessingBackground()}catch(e){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode(G_LAST_CMD);break;case"save_as_image":command_saveAsImage(e,DEXTTOP.G_SELECTED_ELEMENT,this)}DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.G_CURREDITOR._RangeBlurBug=!1),t&&0==t.indexOf("p_")?(e=t.split("_"),i=n=e[1],2<e.length&&(i=e[2]),G_DEPlugin[n]&&G_DEPlugin[n].onClickToolIcon)&&G_DEPlugin[n].onClickToolIcon(i):t&&getCustomIconAttr(t).isCustom&&command_custom(e,this,getCustomIconAttr(t).command),0==DEXTTOP.G_CURREDITOR.backupWidthForIOS.isPopup&&AdjustDesignBodyWidth({editor:DEXTTOP.G_CURREDITOR,isApply:!1}),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:r}),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:t,tool:!0})}}},_dextzoom:{_zoomList:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(e){return document.getElementById("dext_pan_zoom_"+e)},init:function(e){document.getElementById("ue_"+e+"zoom_text")&&(document.getElementById("ue_"+e+"zoom_text").value="100%")},make:function(e,t){var n=DEXTTOP.DEXTDOC.getElementById("dext_zoom_iframe_"+e);n&&n.parentNode.removeChild(n),(n=DEXTTOP.DEXTDOC.getElementById("dext_zoom_iframe_holder_"+e))&&n.parentNode.removeChild(n);var r=this;if(null!=this._self(e)){r._editor_config=t,this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title=dext5_lang.iframe_title.zoom,this._iframe_id="dext_zoom_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_zoom_iframe_holder_"+e,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="75px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="75px",this._iframe.height="200px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe)),n="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",n=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(n)+"}())":"",this._iframe.src=n,this._iframe_doc=this._iframe.contentWindow.document,n="<html><head><title>"+dext5_lang.zoom.frame_title+"</title>",isCustomDomain(document)&&(n+='<script>document.domain = "'+document.domain+'";</script></head>'),n+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(n),this._iframe_doc.close(),this._zoomList[e]=[],0<DEXTTOP.G_CURREDITOR._config.zoomList.length&&(this._zoomList[e]=this._zoomList[e].concat(DEXTTOP.G_CURREDITOR._config.zoomList));for(var n=this._zoomList[e].length,i=0;i<n;i++){var s=this._zoomList[e][i],o="lh_"+e+"_"+i;_item=this._iframe_doc.createElement("div"),_item.setAttribute("id",o),_item.style.whiteSpace="nowrap",_item.style.fontSize="14px",_item.style.margin="3px",_item.style.padding="3px",_item.style.cursor="pointer",_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.innerHTML=s,_a_tag.style.textDecoration="none",_a_tag.style.color="black",_item.appendChild(_a_tag),s=function(t){return function(n){r.mouseover_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(o),o=function(t){return function(n){r.click_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(i),DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(_item,"click",o),_item.onmousedown=function(){return!1},_item.unselectable="on",this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(r._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(r.hide(e),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(e,t){this.reset(e),this._iframe_doc.getElementById(t).style.backgroundColor="#e7e7e7"},click_func:function(e,t){var n=this.get_value(e,t);document.getElementById("ue_"+e+"zoom_text").value=n,command_zoom(e,document.getElementById("dext5_design_"+e)),this.hide(e),onChange({editor:DEXTTOP.G_CURREDITOR})},show:function(e){if(null!=DEXTTOP.G_CURREDITOR._config.zoomList){null==this._iframe&&this.make(e,DEXTTOP.G_CURREDITOR._config),G_SUB_DIALOG=this._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id),this._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id)),this.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(!0);var t={},t=getWindowScrollPos(DEXTTOP.DEXTWIN),n=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement),e=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+e+"zoom"));var r=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(r=-2),this._iframeHolder?(this._iframeHolder.style.left=e.left+t[0]+n.left-60+"px",this._iframeHolder.style.top=e.bottom+t[1]+n.top+r-222+"px",this._iframeHolder.style.display=""):(this._iframe.style.left=e.left+t[0]+n.left-60+"px",this._iframe.style.top=e.bottom+t[1]+n.top+r-222+"px"),this._iframe.style.display="";var t=this._iframe.contentWindow,i=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&t.focus(),"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){i.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(i,i.getElementsByTagName("A")[0])}},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),DEXT5_EDITOR.prototype.dialog._click_background(!0),document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative",this._iframe.style.display="none",this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(e){for(var t=this._iframe_doc.getElementsByTagName("div").length,n,r=0;r<t;r++)n="lh_"+e+"_"+r,this._iframe_doc.getElementById(n).style.backgroundColor=""},get_value:function(e,t){return this._zoomList[e][t]}},_dextDialog:{make:function(e,t){getDialogWindow();var n=getDialogDocument(),r;try{r=n.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(i){r=n.createElement("iframe"),r.setAttribute("frameborder","0"),r.setAttribute("scrolling","no"),r.setAttribute("tabkey","-1")}r.title=dext5_lang.iframe_title.dialog,r.style.display="none",r.style.margin="0px",r.style.padding="0px",r.style.zIndex="1";var s=n.createElement("div");s.id="dext_dialog",s.style.display="none",s.style.position="absolute";var o=n.createElement("div");o.id="EdiTor_Popup_header",DEXTTOP.DEXT5.util.setClass(o,"EdiTor_Popup_header"),DEXTTOP.DEXT5.util.addEvent(s,"contextmenu",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)});var u=n.createElement("span");u.className="subject";var a=n.createElement("span");a.className="text",a.innerHTML=t.system_title;var f=n.createElement("div");f.className="closeDextDialog",f.id="dext_dialog_close";var l=n.createElement("a");l.title="close",l.href="javascript:void(0);";var c=n.createElement("span");c.style.display="none",c.innerText="close",l.appendChild(c),f.appendChild(l),o.appendChild(u),o.appendChild(a),o.appendChild(f),s.appendChild(o),o=n.createElement("div"),DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(o.style.backgroundColor="#eeeeee",o.style.backgroundRepeat="no-repeat",o.style.backgroundPosition="50% 50%",o.style.backgroundImage="url("+t.webPath.image+"dialog/dailogmove.png)"),o.appendChild(r),s.appendChild(o),f.onclick=function(){for(var e in G_DEPlugin)if(G_DEPlugin[e].isProcess)return!1;return hideDialog(s,{isCancel:!0}),!1},r.setAttribute("id","dext_dialog_"+e);var h;try{h=n.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(p){h=n.createElement("iframe"),h.setAttribute("frameborder","0"),h.setAttribute("scrolling","no"),r.setAttribute("tabkey","-1")}h.style.display="block",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.zIndex="-1",h.style.filter="alpha(opacity = 0)",h.style.width="100%",h.style.height="100%",h.title="Dialog Moving",s.appendChild(h),h.setAttribute("id","div_dlgmoveing_iframe_"+e),n.body.appendChild(s)}},_dextTable:{_getDextTable:function(e){return document.getElementById("dext_table_pan")},_self:function(e){return document.getElementById("dext_pan_table_insert_"+e)},make:function(e){var t=this;if(null!=this._self(e)){var n=document.createElement("table"),r=document.createElement("tbody");n.setAttribute("id","dext_table_pan");var i,s,o;i=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(",");var u=i[0],a=i[1];this._self(e).style.width=18*a+1+"px",this._self(e).style.height=18*u+20+"px";for(var f=1;f<=u;f++){i=document.createElement("tr");for(var l="",c=1;c<=a;c++){l="trd_"+e+"_"+f+"_"+c,s=document.createElement("td"),s.style.border="1px solid #000000",s.style.cursor="pointer",o=document.createElement("div"),o.style.width="12px",o.style.height="12px",o.style.fontSize="1pt";var h=document.createElement("a");h.href="javascript:void(0);",h.style.width="12px",h.style.height="12px",h.style.marginTop="0px",h.style.marginLeft="0px",h.style.display="inline",h.title="\ud45c \uc0bd\uc785 \uc140";var p=document.createElement("span");p.style.display="none",p.title="\ud45c \uc0bd\uc785 \uc140",h.appendChild(p),o.appendChild(h),s.appendChild(o),s.setAttribute("id",l),i.appendChild(s),o=function(n){return function(r){t.mouseover_func(e,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(l),l=function(n){return function(r){t.click_func(e,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(l),DEXTTOP.DEXT5.util.addEvent(s,"mouseover",o),DEXTTOP.DEXT5.util.addEvent(s,"click",l),l=function(n,i){return function(s){var o="which"in s?s.which:s.keyCode,u=function(e,t){r.childNodes[n-1+e]&&r.childNodes[n-1+e].childNodes[i-1+t]&&(r.childNodes[n-1+e].childNodes[i-1+t].getElementsByTagName("a")[0].focus(),is_next=!0,DEXTTOP.DEXT5.util.cancelEvent(s))};39==o?u(0,1):37==o?u(0,-1):40==o?u(1,0):38==o?u(-1,0):27==o&&(t.hide(e),setTimeout(function(){setFocusToBody()},1))}}(f,c),DEXTTOP.DEXT5.util.addEvent(h,"focus",o),DEXTTOP.DEXT5.util.addEvent(h,"keydown",l),s.onmousedown=function(){return!1},s.unselectable="on"}r.appendChild(i)}n.appendChild(r),this._self(e).appendChild(n)}},show:function(e){null==this._getDextTable(e)&&this.make(e),G_SUB_DIALOG=this._self(e);var t=G_SUB_DIALOG.getElementsByTagName("a").length,n=G_SUB_DIALOG.getElementsByTagName("a")[0],r=G_SUB_DIALOG.getElementsByTagName("a")[t-1];this.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(),setTimeout(function(){n.focus(),setFocusFirstAndLast(document,n,r)},1),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),DEXT5_EDITOR.prototype.dialog._click_background()},click_func:function(e,t){t=t.replace("trd_"+e+"_","");var n=t.split("_");command_InsertTablebyRowCol(e,document.getElementById("dext5_design_"+e),n[0],n[1]),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"table_insert"}),this.hide(e)},mouseover_func:function(e,t){t=t.replace("trd_"+e+"_","");for(var n=t.split("_"),r="",r=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(","),i=r[0],s=r[1],o=1;o<=i;o++)for(var u=1;u<=s;u++)r="trd_"+e+"_"+o+"_"+u,document.getElementById(r).style.backgroundColor="#ffffff";for(o=1;o<=n[0];o++)for(u=1;u<=n[1];u++)r="trd_"+e+"_"+o+"_"+u,document.getElementById(r).style.backgroundColor="#0697f7";document.getElementById("dext_table_rc_"+e).innerHTML=n[0]+" * "+n[1]},reset:function(e){for(var t="",t=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(","),n=t[0],r=t[1],i=1;i<=n;i++)for(var s=1;s<=r;s++)t="trd_"+e+"_"+i+"_"+s,document.getElementById(t).style.backgroundColor="#ffffff";document.getElementById("dext_table_rc_"+e).innerHTML="0 * 0"}},_dextFontFamily:{_fontFamily:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(e){return document.getElementById("dext_pan_font_family_"+e)},make:function(e,t){var n=DEXTTOP.DEXTDOC.getElementById("dext_fontfamily_iframe_"+e);n&&n.parentNode.removeChild(n),(n=DEXTTOP.DEXTDOC.getElementById("dext_fontfamily_iframe_holder_"+e))&&n.parentNode.removeChild(n);var r=this;null!=r._self(e)&&(r._editor_config=t,r._set_font_family(e),n=getIframeDocument(r._iframe),DEXTTOP.DEXT5.util.addEvent(n,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(r.hide(e),setTimeout(function(){setFocusToBody()},1))}))},_set_recently_font_family:function(e){var t=this;this._iframe_doc.getElementById("item_recently")&&this._iframe_doc.getElementById("item_recently").parentNode.removeChild(this._iframe_doc.getElementById("item_recently"));if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var n=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName);if(null!=n&&void 0!=n&&""!=n){for(var n=n.split(","),r=!1,i=0;i<n.length;i++)0>this._fontFamily[e].indexOf(n[i])&&(n.splice(n.indexOf(n[i]),1),r=!0,--i);r&&DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,n),r=this._iframe_doc.createElement("div"),r.setAttribute("id","item_recently"),i=this._iframe_doc.createElement("div"),i.setAttribute("id","item_recently_tit"),i.innerText=dext5_lang.font_family.recently_font,i.style.fontFamily="Tahoma,\ub3cb\uc6c0,Dotum,AppleGothic,sans-serif !important",i.style.fontSize="11px",i.style.whiteSpace="nowrap",i.style.padding="4px 3px 4px 6px",i.style.width="100%",i.style.backgroundColor="rgb(242, 242, 242)",i.style.color="rgb(138, 138, 138)",i.style.fontWeight="600",0==this._iframe_doc.body.childNodes.length?this._iframe_doc.body.appendChild(r):this._iframe_doc.body.insertBefore(r,this._iframe_doc.body.childNodes[0]),r.appendChild(i);for(var i=n.length,s=0;s<i;s++){_font_family=n[s];var o=this._fontFamily[e].indexOf(_font_family),u=n[s]+"_r";_item_rfont=this._iframe_doc.createElement("div"),_item_rfont.setAttribute("id",u),_item_rfont.style.fontSize="14px",_item_rfont.style.whiteSpace="nowrap",_item_rfont.style.margin="3px",_item_rfont.style.padding="3px",_item_rfont.style.cursor="pointer",_item_rfont.style.width="100%",_item_text=this._iframe_doc.createElement("span");var a=_font_family,a=getDisplayFontName(a);"textContent"in _item_text?_item_text.textContent=a:_item_text.innerText=a,_item_text.style.fontFamily=_font_family,_item_text.onmousedown=function(){return!1},_item_text.unselectable="on",_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.appendChild(_item_text),_a_tag.style.textDecoration="none",_a_tag.style.color="black",u=function(n){return function(r){t.mouseover_func(e,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(u),o=function(n,r){return function(r){t.click_func(e,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(o,_item_rfont),DEXTTOP.DEXT5.util.addEvent(_item_rfont,"mouseover",u),DEXTTOP.DEXT5.util.addEvent(_item_rfont,"click",o),_item_rfont.onmousedown=function(){return!1},_item_rfont.unselectable="on",_item_rfont.appendChild(_a_tag),r.appendChild(_item_rfont)}}}},_set_font_family:function(e){var t=this;if(null!=this._self(e)){var n,r;this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title=dext5_lang.iframe_title.font_family,this._iframe_id="dext_fontfamily_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",this._iframe.className="ue_combo_"+(""==DEXTTOP.DEXT5.config.SkinName?"blue":DEXTTOP.DEXT5.config.SkinName),DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_fontfamily_iframe_holder_"+e,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="180px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="180px",this._iframe.height="250px",this._iframe.style.width="180px",this._iframe.style.height="250px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));var i="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",i=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(i)+"}())":"";this._iframe.src=i,this._iframe_doc=this._iframe.contentWindow.document,i="<html><head><title>"+dext5_lang.font_family.frame_title+"</title>",isCustomDomain(document)&&(i+='<script>document.domain = "'+document.domain+'";</script></head>'),""!=DEXTTOP.G_CURREDITOR._config.webFontCssUrl&&(i+='<link href="'+DEXTTOP.G_CURREDITOR._config.webFontCssUrl+'" rel="stylesheet" type="text/css">'),i+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(i),this._iframe_doc.close(),this._fontFamily[e]=[];if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.useLocalFont&&G_dialogHelper&&G_dialogHelper.fonts&&0<G_dialogHelper.fonts.count){for(var i=dlgHelper.fonts.count,s=1;s<i+1;s++)this._fontFamily[e].push(G_dialogHelper.fonts(s));this._fontFamily[e].sort(),this._default_value=DEXTTOP.G_CURREDITOR._setting.font_family,0==this._default_value.length&&(this._default_value="gulim"),this._fontFamily[e].splice(0,0,this._default_value)}else this._default_value=DEXTTOP.G_CURREDITOR._setting.font_family,0==this._default_value.length&&(this._default_value="gulim"),this._fontFamily[e].push(this._default_value),0<DEXTTOP.G_CURREDITOR._config.fontFamilyList.length&&(this._fontFamily[e]=this._fontFamily[e].concat(DEXTTOP.G_CURREDITOR._config.fontFamilyList));i=this._fontFamily[e].length,"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&this._set_recently_font_family(e),s=this._iframe_doc.createElement("div"),s.setAttribute("id","item_all"),this._iframe_doc.body.appendChild(s),"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&(n=this._iframe_doc.createElement("div"),n.setAttribute("id","item_all_tit"),n.innerText=dext5_lang.font_family.all_font,n.style.fontFamily="Tahoma,\ub3cb\uc6c0,Dotum,AppleGothic,sans-serif !important",n.style.fontSize="11px",n.style.whiteSpace="nowrap",n.style.padding="4px 3px 4px 6px",n.style.width="100%",n.style.backgroundColor="rgb(242, 242, 242)",n.style.color="rgb(138, 138, 138)",n.style.fontWeight="600",s.appendChild(n));for(var o=0;o<i;o++){_font_family=this._fontFamily[e][o];var u="ff_"+e+"_"+o;n=this._iframe_doc.createElement("div"),n.setAttribute("id",u),n.style.fontSize="14px",n.style.whiteSpace="nowrap",n.style.margin="3px",n.style.padding="3px",n.style.cursor="pointer",n.style.width="100%",r=this._iframe_doc.createElement("span");var a=_font_family;0==o&&(a=dext5_lang.icon.font_family),a=getDisplayFontName(a),"textContent"in r?r.textContent=a:r.innerText=a,r.style.fontFamily=_font_family,r.onmousedown=function(){return!1},r.unselectable="on",_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.appendChild(r),_a_tag.style.textDecoration="none",_a_tag.style.color="black",n.appendChild(_a_tag),r=function(n){return function(r){t.mouseover_func(e,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(u),u=function(n){return function(r){t.click_func(e,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(o),DEXTTOP.DEXT5.util.addEvent(n,"mouseover",r),DEXTTOP.DEXT5.util.addEvent(n,"click",u),n.onmousedown=function(){return!1},n.unselectable="on",s.appendChild(n)}}},mouseover_func:function(e,t){this.reset(e),this._iframe_doc.getElementById(t).style.backgroundColor="#e7e7e7"},click_func:function(e,t,n){var r="",i=DEXTTOP.G_CURREDITOR._dextFontFamily;t=r=n&&0<n.length?n:i.get_value(e,t),t==i._default_value&&(t=dext5_lang.icon.font_family),"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(t=r),"1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin?document.getElementById("txtara_"+e+"font_family").value=getDisplayFontName(t):document.getElementById("ue_"+e+"font_family").innerHTML="<span>"+getDisplayFontName(t)+"</span>",r=getRealNameThroughDisplayName(r),command_fontfamily(e,document.getElementById("dext5_design_"+e),r),n||i.hide(e),"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&(e=r,DEXTTOP.DEXT5.browser.LocalStorageSupported&&(n=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName),null==n||void 0==n||""==n?DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,e):(n=n.split(","),-1<n.indexOf(e)&&n.splice(n.indexOf(e),1),n.unshift(e),5<n.length&&(n.reverse(),n.shift(),n.reverse()),DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,n.toString()))))},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextFontFamily;null!=t._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||t.make(e,DEXTTOP.G_CURREDITOR._config),"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&t._set_recently_font_family(e),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),t._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(t._iframeHolder.id)),t.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(!0);var n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=null,r="1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+e+"font_family")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+e+"font_family")),i=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(i=-2);var s=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement),t._iframeHolder?(t._iframeHolder.style.left=r.left+n[0]+s.left+"px",t._iframeHolder.style.top=r.bottom+n[1]+s.top+i+"px",t._iframeHolder.style.display=""):(t._iframe.style.left=r.left+n[0]+s.left+"px",t._iframe.style.top=r.bottom+n[1]+s.top+i+"px"),t._iframe.style.display="";var n=t._iframe.contentWindow,o=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&n.focus(),"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&(setTimeout(function(){o.getElementsByTagName("A")[0].focus()},1),n.scrollTo(0,0)),setFocusFirstAndLast(o,o.getElementsByTagName("A")[0]);try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(e,t._iframe,"fontfamily"):DEXTTOP.dext_editor_afterpopupshow_event(e,t._iframe,"fontfamily")}catch(u){}},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe&&(this._iframe.style.display="none"),this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(e){if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont){var t=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName);if(null!=t&&void 0!=t&&""!=t)for(var n=t.split(","),r,i=n.length,t=0;t<i;t++)r=n[t]+"_r",this._iframe_doc.getElementById(r).style.backgroundColor=""}n=0,n="0"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont?this._iframe_doc.getElementById("item_all").getElementsByTagName("div").length:this._iframe_doc.getElementById("item_all").getElementsByTagName("div").length-1;for(t=0;t<n;t++)r="ff_"+e+"_"+t,this._iframe_doc.getElementById(r).style.backgroundColor=""},get_value:function(e,t){return this._fontFamily[e][t]}},_dextFontSize:{_fontSize:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(e){return document.getElementById("dext_pan_font_size_"+e)},make:function(e,t){var n=DEXTTOP.DEXTDOC.getElementById("dext_fontsize_iframe_"+e);n&&n.parentNode.removeChild(n),(n=DEXTTOP.DEXTDOC.getElementById("dext_fontsize_iframe_holder_"+e))&&n.parentNode.removeChild(n);var r=this;if(null!=r._self(e)){r._editor_config=t,this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title=dext5_lang.iframe_title.font_size,this._iframe_id="dext_fontsize_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_fontsize_iframe_holder_"+e,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="150px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="150px",this._iframe.height="270px",this._iframe.style.width="150px",this._iframe.style.height="270px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe)),n="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",n=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(n)+"}())":"",this._iframe.src=n,this._iframe_doc=this._iframe.contentWindow.document,n="<html><head><title>"+dext5_lang.font_size.frame_title+"</title>",isCustomDomain(document)&&(n+='<script>document.domain = "'+document.domain+'";</script></head>'),n+='</head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(n),this._iframe_doc.close(),this._fontSize[e]=[],this._default_value=DEXTTOP.G_CURREDITOR._setting.font_size,0==this._default_value.length&&(this._default_value="12pt"),this._fontSize[e].push(this._default_value),0<DEXTTOP.G_CURREDITOR._config.fontSizeList.length&&(this._fontSize[e]=this._fontSize[e].concat(DEXTTOP.G_CURREDITOR._config.fontSizeList));for(var n=this._fontSize[e].length,i=0;i<n;i++){_font_size=this._fontSize[e][i];var s="fs_"+e+"_"+i;_item=this._iframe_doc.createElement("div"),_item.setAttribute("id",s),_item.style.whiteSpace="nowrap",_item.style.margin="3px",_item.style.padding="5px",_item.style.cursor="pointer",_item.style.width="100%";var o=""
,o=-1<_font_size.indexOf("pt")?_font_size.replace("pt","")+" pt":-1<_font_size.indexOf("px")?_font_size.replace("px","")+" px":_font_size;0==i&&(o=dext5_lang.icon.font_size),1==t.style.isFontSizeUse?_item.style.fontSize=_font_size:(_item.style.fontSize="10 pt",o="        "+_font_size),_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.innerHTML=o,_a_tag.style.textDecoration="none",_a_tag.style.color="black",_item.appendChild(_a_tag),s=function(t){return function(n){r.mouseover_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(s),o=function(t){return function(n){r.click_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(i),DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(_item,"click",o),_item.onmousedown=function(){return!1},_item.unselectable="on",this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(r._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(r.hide(e),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(e,t){this.reset(e),this._iframe_doc.getElementById(t).style.backgroundColor="#e7e7e7"},click_func:function(e,t,n){var r="",i=DEXTTOP.G_CURREDITOR._dextFontSize;if(n&&0<n.length){r=parseFloat(n);if(isNaN(r))return;r=n=0<n.indexOf("pt")?r+"pt":0<n.indexOf("px")?r+"px":0<n.indexOf("em")?r+"em":0<n.indexOf("%")?r+"%":r+"pt"}else r=i.get_value(e,t);t=r,t==i._default_value&&(t=dext5_lang.icon.font_size),"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(t=r),"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+e+"font_size").value=t:document.getElementById("ue_"+e+"font_size").innerHTML="<span>"+t+"</span>",command_fontsize(e,document.getElementById("dext5_design_"+e),r),n||i.hide(e)},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextFontSize;null!=t._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||t.make(e,DEXTTOP.G_CURREDITOR._config),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),t._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(t._iframeHolder.id)),t.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(!0);var n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var i=null,i="1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+e+"font_size")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+e+"font_size")),s=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(s=-2),t._iframeHolder?(t._iframeHolder.style.left=i.left+n[0]+r.left+"px",t._iframeHolder.style.top=i.bottom+n[1]+r.top+s+"px",t._iframeHolder.style.display=""):(t._iframe.style.left=i.left+n[0]+r.left+"px",t._iframe.style.top=i.bottom+n[1]+r.top+s+"px"),t._iframe.style.display="";var n=t._iframe.contentWindow,o=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&n.focus(),"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){o.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(o,o.getElementsByTagName("A")[0]);try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(e,t._iframe,"fontsize"):DEXTTOP.dext_editor_afterpopupshow_event(e,t._iframe,"fontsize")}catch(u){}},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none",this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(e){for(var t=this._iframe_doc.getElementsByTagName("div").length,n,r=0;r<t;r++)n="fs_"+e+"_"+r,this._iframe_doc.getElementById(n).style.backgroundColor=""},get_value:function(e,t){return this._fontSize[e][t]}},_dextFormatting:{_format:G_FORMATTING,_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_self:function(e){return document.getElementById("dext_pan_formatting_"+e)},init:function(e){document.getElementById("ue_"+e+"formatting")&&(document.getElementById("ue_"+e+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>")},make:function(e,t){var n=DEXTTOP.DEXTDOC.getElementById("dext_formatting_iframe_"+e);n&&n.parentNode.removeChild(n),(n=DEXTTOP.DEXTDOC.getElementById("dext_formatting_iframe_holder_"+e))&&n.parentNode.removeChild(n);var r=this;if(null!=r._self(e)){var i;0<DEXTTOP.G_CURREDITOR._config.formattingList.length&&(r._format=DEXTTOP.G_CURREDITOR._config.formattingList),n=r._format.length,this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title=dext5_lang.iframe_title.formatting,this._iframe_id="dext_formatting_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_formatting_iframe_holder_"+e,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="230px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.width="230px",this._iframe.height="200px",this._iframe.style.width="230px",this._iframe.style.height="200px",DEXTTOP.DEXTDOC.body.appendChild(this._iframe)),i="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",i=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(i)+"}())":"",this._iframe.src=i,this._iframe_doc=this._iframe.contentWindow.document,i="<html><head><title>"+dext5_lang.formatting.frame_title+"</title>",isCustomDomain(document)&&(i+='<script>document.domain = "'+document.domain+'";</script></head>'),i+='</head><body style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(i),this._iframe_doc.close();for(var s=null,o=0;o<n;o++){var u="fs_"+e+"_"+o;i=this._iframe_doc.createElement("div"),i.setAttribute("id",u),i.style.whiteSpace="nowrap",i.style.width="100%",i.style.cursor="pointer";var a="("+r._format[o]+") Heading";""==r._format[o]?(s=this._iframe_doc.createElement("span"),a=dext5_lang.icon.formatting):s=this._iframe_doc.createElement(r._format[o]),s.style.fontFamily="Dotum Arial",_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.innerHTML=a,_a_tag.style.textDecoration="none",_a_tag.style.color="black",s.appendChild(_a_tag),i.innerHTML=s.outerHTML,s=function(t){return function(n){r.mouseover_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(u),u=function(t){return function(n){r.click_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(o),DEXTTOP.DEXT5.util.addEvent(i,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(i,"click",u),i.onmousedown=function(){return!1},i.unselectable="on",this._iframe_doc.body.appendChild(i)}document.getElementById("ue_"+e+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>",DEXTTOP.DEXT5.util.addEvent(r._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(r.hide(e),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(e,t){this.reset(e),this._iframe_doc.getElementById(t).style.backgroundColor="#e7e7e7"},click_func:function(e,t){var n=DEXTTOP.G_CURREDITOR._dextFormatting,r=n.get_value(e,t),i=r;""==i&&(i=dext5_lang.icon.formatting),document.getElementById("ue_"+e+"formatting").innerHTML="<span>"+i+"</span>";try{if(DEXTTOP.DEXT5.browser.ie){var s=getFirstRange(),o=s.range.startContainer,u=s.range.endContainer;if(3==o.nodeType&&1==u.nodeType&&o.parentNode==u&&1==s.range.endOffset){var a=u.lastChild,i=1;3==a.nodeType&&(i=a.length),s.range.setEnd(a,i),s.sel.removeAllRanges(),s.sel.addRange(s.range),null!=DEXTTOP.G_CURREDITOR._LastRange&&(DEXTTOP.G_CURREDITOR._LastRange=s.range)}}}catch(f){}command_formatting(e,document.getElementById("dext5_design_"+e),r),n.hide(e)},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextFormatting;null!=t._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||t.make(e,DEXTTOP.G_CURREDITOR._config),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),t._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(t._iframeHolder.id)),t.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(!0);var n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var i=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+e+"formatting")),s=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(s=-2),t._iframeHolder?(t._iframeHolder.style.left=i.left+n[0]+r.left+"px",t._iframeHolder.style.top=i.bottom+n[1]+r.top+s+"px",t._iframeHolder.style.display=""):(t._iframe.style.left=i.left+n[0]+r.left+"px",t._iframe.style.top=i.bottom+n[1]+r.top+s+"px"),t._iframe.style.display="";var n=t._iframe.contentWindow,o=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&n.focus(),setTimeout(function(){o.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(o,o.getElementsByTagName("A")[0]),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(e,t._iframe,"formatting"):DEXTTOP.dext_editor_afterpopupshow_event(e,t._iframe,"formatting")}catch(u){}},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),this.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none",this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(e){for(var t=this._iframe_doc.getElementsByTagName("div").length,n,r=0;r<t;r++)n="fs_"+e+"_"+r,this._iframe_doc.getElementById(n).style.backgroundColor=""},get_value:function(e,t){return this._format[t]}},_dextLineHeight:{_lineHeight:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(e){return document.getElementById("dext_pan_line_height_"+e)},init:function(e){var t="";if("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real){var t=DEXTTOP.G_CURREDITOR._setting.line_height,n=!0,r=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];r&&0>r.indexOf("%")&&(n=!1),-1<t.indexOf("%")?n||(t=parseInt(t,10)/100):n&&(t=parseInt(100*t,10)+"%")}"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+e+"line_height")&&("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("txtara_"+e+"line_height").value=t:document.getElementById("txtara_"+e+"line_height").value=dext5_lang.icon.line_height):document.getElementById("ue_"+e+"line_height")&&("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("ue_"+e+"line_height").innerHTML="<span>"+t+"</span>":document.getElementById("ue_"+e+"line_height").innerHTML="<span>"+dext5_lang.icon.line_height+"</span>")},make:function(e,t){var n=DEXTTOP.DEXTDOC.getElementById("dext_lineheight_iframe_"+e);n&&n.parentNode.removeChild(n),(n=DEXTTOP.DEXTDOC.getElementById("dext_lineheight_iframe_holder_"+e))&&n.parentNode.removeChild(n);var r=this;if(null!=this._self(e)){r._editor_config=t,this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title=dext5_lang.iframe_title.line_height,this._iframe_id="dext_lineheight_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_lineheight_iframe_holder_"+e,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="75px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="75px",this._iframe.height="200px",this._iframe.style.width="75px",this._iframe.style.height="200px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe)),n="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",n=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(n)+"}())":"",this._iframe.src=n,this._iframe_doc=this._iframe.contentWindow.document,n="<html><head><title>"+dext5_lang.line_height.frame_title+"</title>",isCustomDomain(document)&&(n+='<script>document.domain = "'+document.domain+'";</script></head>'),n+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(n),this._iframe_doc.close(),this._lineHeight[e]=[],this._default_value=DEXTTOP.G_CURREDITOR._setting.line_height;var n=!0,i=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];i&&0>i.indexOf("%")&&(n=!1),-1<this._default_value.indexOf("%")?n||(this._default_value=parseInt(this._default_value,10)/100):n&&(this._default_value=parseInt(100*this._default_value,10)+"%"),0==this._default_value.length&&(this._default_value="1.2"),this._lineHeight[e].push(this._default_value),0<DEXTTOP.G_CURREDITOR._config.lineHeightList.length&&(this._lineHeight[e]=this._lineHeight[e].concat(DEXTTOP.G_CURREDITOR._config.lineHeightList)),1==this._lineHeight[e].length&&(this._lineHeight[e]=this._lineHeight[e].concat(DEXTTOP.G_CURREDITOR._config.lineHeightList)),n=this._lineHeight[e].length;for(i=0;i<n;i++){_line_height=this._lineHeight[e][i];var s="lh_"+e+"_"+i;_item=this._iframe_doc.createElement("div"),_item.setAttribute("id",s),_item.style.whiteSpace="nowrap",_item.style.fontSize="14px",_item.style.margin="3px",_item.style.padding="3px",_item.style.cursor="pointer";var o="",o=0==i?dext5_lang.icon.line_height:_line_height;_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.innerHTML=o,_a_tag.style.textDecoration="none",_a_tag.style.color="black",_item.appendChild(_a_tag),s=function(t){return function(n){r.mouseover_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(s),o=function(t){return function(n){r.click_func(e,t),DEXTTOP.DEXT5.util.stopEvent(n)}}(i),DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(_item,"click",o),_item.onmousedown=function(){return!1},_item.unselectable="on",this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(r._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(r.hide(e),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(e,t){this.reset(e),this._iframe_doc.getElementById(t).style.backgroundColor="#e7e7e7"},click_func:function(e,t,n){var r="",i=DEXTTOP.G_CURREDITOR._dextLineHeight;if(n&&0<n.length){r=parseFloat(n);if(isNaN(r))return;r=n}else r=i.get_value(e,t);t=r,t==i._default_value&&(t=dext5_lang.icon.line_height),"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(t=r),"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+e+"line_height").value=t:document.getElementById("ue_"+e+"line_height").innerHTML="<span>"+t+"</span>",command_lineHeight(e,document.getElementById("dext5_design_"+e),r),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"line_height"}),n||i.hide(e)},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextLineHeight;null!=t._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||t.make(e,DEXTTOP.G_CURREDITOR._config),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),t._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(t._iframeHolder.id)),t.reset(e),DEXT5_EDITOR.prototype.dialog._click_background(!0);var n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var i=null,i="1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+e+"line_height")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+e+"line_height")),s=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(s=-2),t._iframeHolder?(t._iframeHolder.style.left=i.left+n[0]+r.left+"px",t._iframeHolder.style.top=i.bottom+n[1]+r.top+s+"px",t._iframeHolder.style.display=""):(t._iframe.style.left=i.left+n[0]+r.left+"px",t._iframe.style.top=i.bottom+n[1]+r.top+s+"px"),t._iframe.style.display="";var n=t._iframe.contentWindow,o=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&n.focus(),"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){o.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(o,o.getElementsByTagName("A")[0]);try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(e,t._iframe,"lineheight"):DEXTTOP.dext_editor_afterpopupshow_event(e,t._iframe,"lineheight")}catch(u){}},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none",this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(e){for(var t=this._iframe_doc.getElementsByTagName("div").length,n,r=0;r<t;r++)n="lh_"+e+"_"+r,this._iframe_doc.getElementById(n).style.backgroundColor=""},get_value:function(e,t){return this._lineHeight[e][t]}},_dextLetterSpacing:{_letterSpacing:{},_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(e){return document.getElementById("dext_pan_letter_spacing_"+e)},make:function(e,t){var n=this;if(null!=n._self(e)){n._editor_config=t,this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title=dext5_lang.iframe_title.letter_spacing,this._iframe.width="85px",this._iframe.height="270px",this._iframe.style.width="85px",this._iframe.style.height="270px",this._iframe_id="dext_letterspacing_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe);var r="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",r=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(r)+"}())":"";this._iframe.src=r,this._iframe_doc=this._iframe.contentWindow.document,r="<html><head><title>"+dext5_lang.letter_spacing.frame_title+"</title>",isCustomDomain(document)&&(r+='<script>document.domain = "'+document.domain+'";</script></head>'),r+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(r),this._iframe_doc.close(),this._letterSpacing[e]=[],this._default_value="",this._letterSpacing[e].push(this._default_value);for(var r=t.letterSpacingList.length,i=0;i<r;i++)_letter_spacing=t.letterSpacingList[i],this._letterSpacing[e].push(_letter_spacing);r=this._letterSpacing[e].length;for(i=0;i<r;i++){_letter_spacing=this._letterSpacing[e][i];var s="ls_"+e+"_"+i;_item=this._iframe_doc.createElement("div"),_item.setAttribute("id",s),_item.style.whiteSpace="nowrap",_item.style.fontSize="14px",_item.style.margin="3px",_item.style.padding="3px",_item.style.cursor="pointer";var o="",o=0==i?dext5_lang.icon.letter_spacing:_letter_spacing;_a_tag=this._iframe_doc.createElement("a"),_a_tag.href="javascript:void(0);",_a_tag.innerHTML=o,_a_tag.style.textDecoration="none",_a_tag.style.color="black",_item.appendChild(_a_tag),s=function(t){return function(r){n.mouseover_func(e,t),DEXTTOP.DEXT5.util.stopEvent(r)}}(s),o=function(t){return function(r){n.click_func(e,t),DEXTTOP.DEXT5.util.stopEvent(r)}}(i),DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(_item,"click",o),_item.onmousedown=function(){return!1},_item.unselectable="on",this._iframe_doc.body.appendChild(_item)}}},mouseover_func:function(e,t){this.reset(e),this._iframe_doc.getElementById(t).style.backgroundColor="#e7e7e7"},click_func:function(e,t){var n=DEXTTOP.G_CURREDITOR._dextLetterSpacing,r=n.get_value(e,t),i=r;i==n._default_value&&(i=dext5_lang.icon.letter_spacing),document.getElementById("ue_"+e+"letter_spacing").innerHTML="<span>"+i+"</span>",command_letterSpacing(e,DEXTTOP.G_CURREDITOR,r),n.hide(e)},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextLetterSpacing;null!=t._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||t.make(e,DEXTTOP.G_CURREDITOR._config),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),t.reset(e),DEXT5_EDITOR.prototype.dialog._click_background();var n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var i=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+e+"letter_spacing")),s=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(s=-2),t._iframe.style.left=i.left+n[0]+r.left+"px",t._iframe.style.top=i.bottom+n[1]+r.top+s+"px",t._iframe.style.display="";var n=t._iframe.contentWindow,o=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&n.focus(),"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){o.getElementsByTagName("A")[0].focus()},1),DEXTTOP.DEXT5.util.addEvent(o,"keyup",function(n){27==("which"in n?n.which:n.keyCode)&&(t.hide(e),setTimeout(function(){setFocusToBody()},1))}),setFocusFirstAndLast(o,o.getElementsByTagName("A")[0])},hide:function(e){dialogCancel(),G_SUB_DIALOG=this._self(e),DEXT5_EDITOR.prototype.dialog._click_background(),this._iframe.style.display="none"},reset:function(e){for(var t=this._iframe_doc.getElementsByTagName("div").length,n,r=0;r<t;r++)n="ls_"+e+"_"+r,this._iframe_doc.getElementById(n).style.backgroundColor=""},get_value:function(e,t){return this._letterSpacing[e][t]}},_dextWorkProcessing:{_iframe:null,_iframe_id:"",_self:function(e){return document.getElementById("ue_editor_holder_"+e)},make:function(e,t){if(null!=this._self(e)){this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe.title="dext5 work processing...";var n=this._self(e);this._iframe.width=n.clientWidth-10+"px",this._iframe.height="200px",this._iframe_id="dext_workprocessing_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.display="none",this._iframe.style.border="0px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",DEXTTOP.DEXTDOC.body.appendChild(this._iframe),n="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",n=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(n)+"}())":"",this._iframe.src=n,this._iframe_doc=this._iframe.contentWindow.document,n="<html><head><title>"+this._iframe.title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"><div style="text-align:center;"></div></body></html>',getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),isCustomDomain(document)&&(this._iframe_doc.domain=document.domain),this._iframe_doc.write(n),this._iframe_doc.close()}},show:function(e){setFocusTopWindow(),G_SUB_DIALOG=this._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id),e={},e=getWindowScrollPos(DEXTTOP.DEXTWIN);var t=getClientRect(G_SUB_DIALOG),n=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement),this._iframe.style.left=t.left+e[0]+n.left+"px",this._iframe.style.top=t.top+e[1]+n.top+50+"px",this._iframe.style.display=""},hide:function(e){dialogCancel(),this._iframe.style.display="none"}},_dextListNumber:{_iframe:null,_iframe_id:"",_line_number_item:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman list_none".split(" "),_self:function(e){return document.getElementById("dext_pan_detail_list_number_"+e)},make:function(e){var t=DEXTTOP.DEXTDOC.getElementById("dext_detail_list_number_iframe_"+e);t&&t.parentNode.removeChild(t);var n=this;if(null!=this._self(e)){this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe_id="dext_detail_list_number_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.margin="0px",this._iframe.style.padding="0px",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.position="absolute",this._iframe.scrolling="no",this._iframe.style.overflow="auto",this._iframe.style.overflowX="hidden",this._iframe.style.display="none",this._iframe.allowTransparency="true",t=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)t=2;this._iframe.style.width=180+t+"px",t=this._line_number_item.length,7==DEXTTOP.DEXT5.browser.ieVersion&&(t-=2),this._iframe.style.height=24*t+2+"px",this._iframe.frameBorder="0",DEXTTOP.DEXTDOC.body.appendChild(this._iframe),t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",this._iframe.src=t,this._iframe_doc=this._iframe.contentWindow.document;var i="",i=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,s="editor_context.css";"3.5.1125677.1800.01"<=DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(s="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css"),t="<html><head>",isCustomDomain(document)&&(t+='<script>document.domain = "'+document.domain+'";</script></head>'),t+='<link rel="stylesheet" type="text/css" href="'+i+s+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',t+='<link rel="stylesheet" type="text/css" href="'+i+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',t+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_number_iframe_bg">',t+='<div class="DEXT_fiVe_ED_popup">',t+='<div class="DEXT_fiVe_EDP">',t+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',t+='<dl id="div_line_number_main"><dt>number_group</dt></dl>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+="</body></html>",getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(t),this._iframe_doc.close(),t=this._iframe_doc.getElementById("div_line_number_main"),i=n._line_number_item.length;for(s=0;s<i;s++){var o=n._line_number_item[s],u=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<u;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==o)return;if(7!=DEXTTOP.DEXT5.browser.ieVersion||"list_decimal_leading_zero"!=o&&"list_lower_greek"!=o){u=this._iframe_doc.createElement("dd"),u.id=o;var a=n.getImageIconUrl(o),f=n.getText(o),l=this._iframe_doc.createElement("div"),c=this._iframe_doc.createElement("div"),h=this._iframe_doc.createElement("span");0<a.length&&(h.className=o,l.appendChild(h)),"textContent"in c?c.textContent=f:c.innerText=f,l.className="s_left",c.className="s_right";var p=this._iframe_doc.createElement("a");p.href="javascript:void(0);",p.title=f,p.style.textDecoration="none",p.style.color="#545454",p.style.cursor="pointer",p.appendChild(l),p.appendChild(c),u.appendChild(p);var a=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(p,"focus",d),DEXTTOP.DEXT5.util.removeEvent(p,"blur",v),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),f=function(e){return function(t){DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),d=function(e){return function(t){"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),v=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),n=this,l=function(e){return function(t){"list_none"==e.id&&(e.id+="_N"),_dext_editor._dextCommands(_dext_editor.ID,e.id),n.hide(_dext_editor.ID),DEXTTOP.DEXT5.util.stopEvent(t)}}(u);DEXTTOP.DEXT5.util.addEvent(u,"mouseover",a),DEXTTOP.DEXT5.util.addEvent(u,"mouseout",f),DEXTTOP.DEXT5.util.addEvent(u,"click",l),DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),0<o.length&&(u.id=o),u.unselectable="on",t.appendChild(u)}}DEXTTOP.DEXT5.util.addEvent(n._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(n.hide(e),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(e){var t="";return""!=e&&(t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif"),t},getText:function(e){var t="";return""!=e&&(t=dext5_lang.icon[e]),t},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextListNumber;null==t._iframe&&t.make(e),setFocusTopWindow(),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),DEXT5_EDITOR.prototype.dialog._click_background(!0),e={},e=getWindowScrollPos(DEXTTOP.DEXTWIN);var n=getClientRect(G_SUB_DIALOG),r=getClientRect(_iframeWin.parent.frameElement),i=getClientRect(_iframeWin.frameElement),s=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)s+=2;var o=0;n.left+s>=i.right&&(o=n.left+s-i.right+30),i=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(i=-15),s=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(s=6),t._iframe.style.left=n.left+e[0]+r.left+i-o+"px",t._iframe.style.top=n.bottom+e[1]+r.top+s+"px",t._iframe.style.display="",e=t._iframe.contentWindow;var u=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&e.focus(),setTimeout(function(){u.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(u,u.getElementsByTagName("A")[0]),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(e){DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none"}},_dextListBullets:{_iframe:null,_iframe_id:"",_line_bullets_item:["list_disc","list_circle","list_square","list_none"],_self:function(e){return document.getElementById("dext_pan_detail_list_bullets_"+e)},make:function(e){var t=DEXTTOP.DEXTDOC.getElementById("dext_detail_list_bullets_iframe_"+e);t&&t.parentNode.removeChild(t);var n=this;if(null!=this._self(e)){this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe_id="dext_detail_list_bullets_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.margin="0px",this._iframe.style.padding="0px",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.position="absolute",this._iframe.scrolling="no",this._iframe.style.overflow="auto",this._iframe.style.overflowX="hidden",this._iframe.style.display="none",this._iframe.allowTransparency="true",t=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)t=2;this._iframe.style.width=180+t+"px",this._iframe.style.height=24*this._line_bullets_item.length+2+"px",this._iframe.frameBorder="0",DEXTTOP.DEXTDOC.body.appendChild(this._iframe),t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",this._iframe.src=t,this._iframe_doc=this._iframe.contentWindow.document;var i="",i=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,s="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(s="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css"),t="<html><head>",isCustomDomain(document)&&(t+='<script>document.domain = "'+document.domain+'";</script></head>'),t+='<link rel="stylesheet" type="text/css" href="'+i+s+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',t+='<link rel="stylesheet" type="text/css" href="'+i+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',t+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">',t+='<div class="DEXT_fiVe_ED_popup">',t+='<div class="DEXT_fiVe_EDP">',t+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',t+='<dl id="div_line_bullets_main"><dt>bullets_group</dt></dl>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+="</body></html>",getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(t),this._iframe_doc.close(),t=this._iframe_doc.getElementById("div_line_bullets_main"),i=n._line_bullets_item.length;for(s=0;s<i;s++){var o=n._line_bullets_item[s],u=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<u;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==o)return;u=this._iframe_doc.createElement("dd"),u.id=o;var a=n.getImageIconUrl(o),f=n.getText(o),l=this._iframe_doc.createElement("div"),c=this._iframe_doc.createElement("div"),h=this._iframe_doc.createElement("span");0<a.length&&(h.className=o,l.appendChild(h)),"textContent"in c?c.textContent=f:c.innerText=f,l.className="s_left",c.className="s_right";var p=this._iframe_doc.createElement("a");p.href="javascript:void(0);",p.title=f,p.style.textDecoration="none",p.style.color="#545454",p.style.cursor="pointer",p.appendChild(l),p.appendChild(c),u.appendChild(p);var a=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(p,"focus",d),DEXTTOP.DEXT5.util.removeEvent(p,"blur",v),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),f=function(e){return function(t){DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),d=function(e){return function(t){"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),v=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),n=this,l=function(e){return function(t){"list_none"==e.id&&(e.id+="_B"),_dext_editor._dextCommands(_dext_editor.ID,e.id),n.hide(),DEXTTOP.DEXT5.util.stopEvent(t)}}(u);DEXTTOP.DEXT5.util.addEvent(u,"mouseover",a),DEXTTOP.DEXT5.util.addEvent(u,"mouseout",f),DEXTTOP.DEXT5.util.addEvent(u,"click",l),DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),0<o.length&&(u.id=o),u.unselectable="on",t.appendChild(u)}DEXTTOP.DEXT5.util.addEvent(n._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(n.hide(e),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(e){var t="";return""!=e&&(t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif"),t},getText:function(e){var t="";return""!=e&&(t=dext5_lang.icon[e]),t},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextListBullets;null==t._iframe&&t.make(e),setFocusTopWindow(),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),DEXT5_EDITOR.prototype.dialog._click_background(!0),e={},e=getWindowScrollPos(DEXTTOP.DEXTWIN);var n=getClientRect(G_SUB_DIALOG),r=getClientRect(_iframeWin.parent.frameElement),i=getClientRect(_iframeWin.frameElement),s=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)s+=2;var o=0;n.left+s>=i.right&&(o=n.left+s-i.right+30),i=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(i=-15),s=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(s=6),t._iframe.style.left=n.left+e[0]+r.left+i-o+"px",t._iframe.style.top=n.bottom+e[1]+r.top+s+"px",t._iframe.style.display="",e=t._iframe.contentWindow;var u=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&e.focus(),setTimeout(function(){u.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(u,u.getElementsByTagName("A")[0]),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(e){DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none"}},_dextListAligns:{_iframe:null,_iframe_id:"",_line_align_item:["align_left","align_center","align_right","align_full"],_self:function(e){return document.getElementById("dext_span_align_group_detail_"+e)},make:function(e){var t=DEXTTOP.DEXTDOC.getElementById("dext_detail_align_group_iframe_"+e);t&&t.parentNode.removeChild(t);var n=this;if(null!=this._self(e)){this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe_id="dext_detail_align_group_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.margin="0px",this._iframe.style.padding="0px",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.position="absolute",this._iframe.scrolling="no",this._iframe.style.overflow="auto",this._iframe.style.overflowX="hidden",this._iframe.style.display="none",this._iframe.allowTransparency="true",t=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)t=2;this._iframe.style.width=180+t+"px",this._iframe.style.height=24*this._line_align_item.length+2+"px",this._iframe.frameBorder="0",DEXTTOP.DEXTDOC.body.appendChild(this._iframe),t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",this._iframe.src=t,this._iframe_doc=this._iframe.contentWindow.document;var t="",t=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,i="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(i="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var s;s="<html><head>",isCustomDomain(document)&&(s+='<script>document.domain = "'+document.domain+'";</script></head>'),s+='<link rel="stylesheet" type="text/css" href="'+t+i+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',s+='<link rel="stylesheet" type="text/css" href="'+t+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',s+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">',s+='<div class="DEXT_fiVe_ED_popup">',s+='<div class="DEXT_fiVe_EDP">',s+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',s+='<dl id="div_align_group_main"><dt>align_group</dt></dl>',s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</body></html>",getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(s),this._iframe_doc.close(),t=this._iframe_doc.getElementById("div_align_group_main"),i=n._line_align_item.length;for(s=0;s<i;s++){var o=n._line_align_item[s],u=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<u;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==o)return;u=this._iframe_doc.createElement("dd"),u.id=o;var a=n.getImageIconUrl(o),f=n.getText(o),l=this._iframe_doc.createElement("div"),c=this._iframe_doc.createElement("div"),h=this._iframe_doc.createElement("span");0<a.length&&(h.className=o,l.appendChild(h)),"textContent"in c?c.textContent=f:c.innerText=f,l.className="s_left",c.className="s_right";var p=this._iframe_doc.createElement("a");p.href="javascript:void(0);",p.title=f,p.style.textDecoration="none",p.style.color="#545454",p.style.cursor="pointer",p.appendChild(l),p.appendChild(c),u.appendChild(p);var a=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(p,"focus",d),DEXTTOP.DEXT5.util.removeEvent(p,"blur",v),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),f=function(e){return function(t){DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),d=function(e){return function(t){"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),v=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),n=this,l=function(e){return function(t){_dext_editor._dextCommands(_dext_editor.ID,e.id),n.hide(),DEXTTOP.DEXT5.util.stopEvent(t)}}(u);DEXTTOP.DEXT5.util.addEvent(u,"mouseover",a),DEXTTOP.DEXT5.util.addEvent(u,"mouseout",f),DEXTTOP.DEXT5.util.addEvent(u,"click",l),DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),0<o.length&&(u.id=o),u.unselectable="on",t.appendChild(u)}DEXTTOP.DEXT5.util.addEvent(n._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(n.hide(e),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(e){var t="";return""!=e&&(t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif"),t},getText:function(e){var t="";return""!=e&&(t=dext5_lang.icon[e]),t},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextListAligns;null==t._iframe&&t.make(e),setFocusTopWindow(),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),DEXT5_EDITOR.prototype.dialog._click_background(!0),e={},e=getWindowScrollPos(DEXTTOP.DEXTWIN);var n=getClientRect(G_SUB_DIALOG),r=getClientRect(_iframeWin.parent.frameElement),i=getClientRect(_iframeWin.frameElement),s=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)s+=2;var o=0;n.left+s>=i.right&&(o=n.left+s-i.right+30),i=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(i=-15),s=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(s=6),t._iframe.style.left=n.left+e[0]+r.left+i-o+"px",t._iframe.style.top=n.bottom+e[1]+r.top+s+"px",t._iframe.style.display="",e=t._iframe.contentWindow;var u=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&e.focus(),setTimeout(function(){u.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(u,u.getElementsByTagName("A")[0]),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(e){DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none"}},_dextListTables:{_iframe:null,_iframe_id:"",_table_item:"insert_row_up insert_row_down insert_column_right insert_column_left delete_row delete_column table_delete merge_cell split_cell table_same_width table_same_height".split(" "),_self:function(e){return document.getElementById("dext_span_table_group_detail_"+e)},make:function(e){var t=DEXTTOP.DEXTDOC.getElementById("dext_detail_table_group_iframe_"+e);t&&t.parentNode.removeChild(t);var n=this;if(null!=this._self(e)){this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe_id="dext_detail_table_group_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.margin="0px",this._iframe.style.padding="0px",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.position="absolute",this._iframe.scrolling="no",this._iframe.style.overflow="auto",this._iframe.style.overflowX="hidden",this._iframe.style.display="none",this._iframe.allowTransparency="true",t=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)t=2;this._iframe.style.width=180+t+"px",this._iframe.style.height=24*this._table_item.length+2+"px",this._iframe.frameBorder="0",DEXTTOP.DEXTDOC.body.appendChild(this._iframe),t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",this._iframe.src=t,this._iframe_doc=this._iframe.contentWindow.document;var t="",t=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,i="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(i="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var s;s="<html><head>",isCustomDomain(document)&&(s+='<script>document.domain = "'+document.domain+'";</script></head>'),s+='<link rel="stylesheet" type="text/css" href="'+t+i+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',s+='<link rel="stylesheet" type="text/css" href="'+t+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',s+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">',s+='<div class="DEXT_fiVe_ED_popup">',s+='<div class="DEXT_fiVe_EDP">',s+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',s+='<dl id="div_table_group_main"><dt>table_group</dt></dl>',s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</body></html>",getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(s),this._iframe_doc.close(),t=this._iframe_doc.getElementById("div_table_group_main"),i=n._table_item.length,s=DEXTTOP.G_CURREDITOR.remove_item.length;for(var o=0;o<i;o++){var u=n._table_item[o];for(r=0;r<s;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==u)return;var a=this._iframe_doc.createElement("dd");a.id=u;var f=n.getImageIconUrl(u),l=n.getText(u),c=this._iframe_doc.createElement("div"),h=this._iframe_doc.createElement("div"),p=this._iframe_doc.createElement("span");0<f.length&&(p.className=u,c.appendChild(p)),"textContent"in h?h.textContent=l:h.innerText=l,c.className="s_left",h.className="s_right";var d=this._iframe_doc.createElement("a");d.href="javascript:void(0);",d.title=l,d.style.textDecoration="none",d.style.color="#545454",d.style.cursor="pointer",d.appendChild(c),d.appendChild(h),a.appendChild(d);var f=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(d,"focus",v),DEXTTOP.DEXT5.util.removeEvent(d,"blur",m),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(a),l=function(e){return function(t){DEXTTOP.DEXT5.util.addEvent(d,"focus",v),DEXTTOP.DEXT5.util.addEvent(d,"blur",m),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(a),v=function(e){return function(t){"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(a),m=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(a),n=this,c=function(e){return function(t){"item_disabled"!=e.className&&(_dext_editor._dextCommands(_dext_editor.ID,e.id),n.hide(),DEXTTOP.DEXT5.util.stopEvent(t))}}(a);DEXTTOP.DEXT5.util.addEvent(a,"mouseover",f),DEXTTOP.DEXT5.util.addEvent(a,"mouseout",l),DEXTTOP.DEXT5.util.addEvent(a,"click",c),DEXTTOP.DEXT5.util.addEvent(d,"focus",v),DEXTTOP.DEXT5.util.addEvent(d,"blur",m),0<u.length&&(a.id=u),a.unselectable="on",t.appendChild(a)}DEXTTOP.DEXT5.util.addEvent(n._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(n.hide(e),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(e){var t="";return""!=e&&(t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif"),t},getText:function(e){var t="";return""!=e&&(t=dext5_lang.icon[e]),t},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextListTables;null==t._iframe&&t.make(e);try{DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID)}catch(n){}setFocusTopWindow(),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),DEXT5_EDITOR.prototype.dialog._click_background(!0),e={},e=getWindowScrollPos(DEXTTOP.DEXTWIN);var r=getClientRect(G_SUB_DIALOG),i=getClientRect(_iframeWin.parent.frameElement),s=getClientRect(_iframeWin.frameElement),o=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)o+=2;var u=0;r.left+o>=s.right&&(u=r.left+o-s.right+30),s=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(s=-15),o=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(o=6),t._iframe.style.left=r.left+e[0]+i.left+s-u+"px",t._iframe.style.top=r.bottom+e[1]+i.top+o+"px",t._iframe.style.display="",e=DEXT5_TOPMENU._disabeld_menu,i=t._table_item.length,r=e.length;for(u=0;u<i;u++)if(s=G_CURRENT_IFRAME.contentWindow.document.getElementById(t._table_item[u]))s.className="",removeAttribute(s,"class");for(i=0;i<r;i++)if(u=G_CURRENT_IFRAME.contentWindow.document.getElementById(e[i]))u.className="item_disabled";e=t._iframe.contentWindow;var a=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&e.focus(),setTimeout(function(){a.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(a,a.getElementsByTagName("A")[0]),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(e){DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none"}},_dextElementZindex:{_iframe:null,_iframe_id:"",_zindex_item:["bring_to_front","send_to_back","bring_forward","send_backward"],_self:function(e){return document.getElementById("dext_span_order_of_objects_detail_"+e)},make:function(e){var t=DEXTTOP.DEXTDOC.getElementById("dext_order_of_objects_detail_iframe_"+e);t&&t.parentNode.removeChild(t);var n=this;if(null!=this._self(e)){this._iframe=DEXTTOP.DEXT5.util.makeIframe(),this._iframe_id="dext_order_of_objects_detail_iframe_"+e,this._iframe.id=this._iframe_id,this._iframe.style.margin="0px",this._iframe.style.padding="0px",this._iframe.style.zIndex=G_MAIN_ZINDEX+2e3+"",this._iframe.style.position="absolute",this._iframe.scrolling="no",this._iframe.style.overflow="auto",this._iframe.style.overflowX="hidden",this._iframe.style.display="none",this._iframe.allowTransparency="true",t=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)t=2;this._iframe.style.width=180+t+"px",this._iframe.style.height=24*this._zindex_item.length+2+"px",this._iframe.frameBorder="0",DEXTTOP.DEXTDOC.body.appendChild(this._iframe),t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",this._iframe.src=t,this._iframe_doc=this._iframe.contentWindow.document;var t="",t=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,i="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(i="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var s;s="<html><head>",isCustomDomain(document)&&(s+='<script>document.domain = "'+document.domain+'";</script></head>'),s+='<link rel="stylesheet" type="text/css" href="'+t+i+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',s+='<link rel="stylesheet" type="text/css" href="'+t+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',s+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">',s+='<div class="DEXT_fiVe_ED_popup">',s+='<div class="DEXT_fiVe_EDP">',s+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',s+='<dl id="div_order_of_objects_main"><dt>Order of Objects</dt></dl>',s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</body></html>",getDocWindow(this._iframe_doc),this._iframe_doc.open("text/html","replace"),this._iframe_doc.write(s),this._iframe_doc.close(),t=this._iframe_doc.getElementById("div_order_of_objects_main"),i=n._zindex_item.length;for(s=0;s<i;s++){var o=n._zindex_item[s],u=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<u;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==o)return;u=this._iframe_doc.createElement("dd"),u.id=o;var a=n.getImageIconUrl(o),f=n.getText(o),l=this._iframe_doc.createElement("div"),c=this._iframe_doc.createElement("div"),h=this._iframe_doc.createElement("span");0<a.length&&(h.className=o,l.appendChild(h)),"textContent"in c?c.textContent=f:c.innerText=f,l.className="s_left",c.className="s_right";var p=this._iframe_doc.createElement("a");p.href="javascript:void(0);",p.title=f,p.style.textDecoration="none",p.style.color="#545454",p.style.cursor="pointer",p.appendChild(l),p.appendChild(c),u.appendChild(p);var a=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(p,"focus",d),DEXTTOP.DEXT5.util.removeEvent(p,"blur",v),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),f=function(e){return function(t){DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),d=function(e){return function(t){"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),v=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(u),n=this,l=function(e){return function(t){_dext_editor._dextCommands(_dext_editor.ID,e.id),n.hide(),DEXTTOP.DEXT5.util.stopEvent(t)}}(u);DEXTTOP.DEXT5.util.addEvent(u,"mouseover",a),DEXTTOP.DEXT5.util.addEvent(u,"mouseout",f),DEXTTOP.DEXT5.util.addEvent(u,"click",l),DEXTTOP.DEXT5.util.addEvent(p,"focus",d),DEXTTOP.DEXT5.util.addEvent(p,"blur",v),0<o.length&&(u.id=o),u.unselectable="on",t.appendChild(u)}DEXTTOP.DEXT5.util.addEvent(n._iframe_doc,"keyup",function(t){27==("which"in t?t.which:t.keyCode)&&(n.hide(e),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(e){var t="";return""!=e&&(t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif"),t},getText:function(e){var t="";return""!=e&&(t=dext5_lang.icon[e]),t},show:function(e){var t=DEXTTOP.G_CURREDITOR._dextElementZindex;null==t._iframe&&t.make(e),setFocusTopWindow(),G_SUB_DIALOG=t._self(e),G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(t._iframe_id),DEXT5_EDITOR.prototype.dialog._click_background(!0),e={},e=getWindowScrollPos(DEXTTOP.DEXTWIN);var n=getClientRect(G_SUB_DIALOG),r=getClientRect(_iframeWin.parent.frameElement),i=getClientRect(_iframeWin.frameElement),s=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)s+=2;var o=0;n.left+s>=i.right&&(o=n.left+s-i.right+30),i=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(i=-15),s=0,7==DEXTTOP.DEXT5.browser.ieVersion&&(s=6),t._iframe.style.left=n.left+e[0]+r.left+i-o+"px",t._iframe.style.top=n.bottom+e[1]+r.top+s+"px",t._iframe.style.display="",e=t._iframe.contentWindow;var u=getIframeDocument(t._iframe);0==DEXTTOP.DEXT5.browser.ie&&e.focus(),setTimeout(function(){u.getElementsByTagName("A")[0].focus()},1),setFocusFirstAndLast(u,u.getElementsByTagName("A")[0]),DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(e){DEXT5_EDITOR.prototype.dialog._click_background(!0),this._iframe.style.display="none"}},setFocusToBody:function(){setFocusToBody()},_topMenuDisbleCheck:function(){this._iconEnable("allDisable")},_statusToolBarIconSelect:function(e,t){var n=document.getElementById("ue_"+e+t),r=[];r.push(t),-1<n.parentElement.className.indexOf("uebutton_span_enter")&&removeArrayItemByValue(r,t),DEXTTOP.G_CURREDITOR._iconSelected(r)}},K__+="FA",R[0]="h",SIL[1]="u",K__+="BG",C1[0]="h",C2[0]="h",ALS[0]="D",S1[0]="h",S2[0]="h",DEXT5_EDITOR.prototype.full_screen={toggle:function(){}},K__+=R[0],R[1]="t",C1[1]="t",C2[1]="t",ALS[1]="E",S1[1]="t",S2[1]="t",K__+="i",DEXT5_EDITOR.prototype.dialog={_self:function(e){return document.getElementById("dext_dialog_"+e)},_selfTopWindow:function(e){return getDialogDocument().getElementById("dext_dialog_"+e)},_background:function(e){var t=document.getElementById("dext_background");null!=t&&void 0!=t?1==e?(this.set_full_size(t),t.style.display="block"):t.style.display="none":alert("ErrCode : 2000")},_click_background:function(e){if(e){e="dext_toolmenu_background"+DEXTTOP.G_CURREDITOR._config.editor_id;var t=DEXTTOP.DEXTDOC.getElementById(e);if(t)if("block"==t.style.display||""==t.style.display)t.style.display="none",dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none");else{t.style.display="block",document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",G_SUB_DIALOG.style.display="block",e=getClientRect(G_SUB_DIALOG);var n=getClientRect(_iframeWin.frameElement),r=parseInt(e.right,10)-parseInt(e.left,10);e.left+r>=n.right&&(e=e.left+r-n.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-e+"px")}else t=DEXTTOP.DEXTDOC.createElement("div"),t.id=e,t.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+(G_MAIN_ZINDEX+1e3)+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>',t.style.overflow="visible",e="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,t.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)-10+"px",t.firstChild.style.height=e-10+"px",DEXTTOP.DEXTDOC.body.appendChild(t),e=function(){return function(e){dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none",document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none"),t.style.display="none"}}(),DEXTTOP.DEXT5.util.addEvent(t,"click",e),DEXTTOP.DEXT5.util.addEvent(t,"contextmenu",e),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",DEXTTOP.G_CURREDITOR.toolmenu_bg_resize),document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",G_SUB_DIALOG.style.display="block",e=getClientRect(G_SUB_DIALOG),n=getClientRect(_iframeWin.frameElement),r=parseInt(e.right,10)-parseInt(e.left,10),e.left+r>=n.right&&(e=e.left+r-n.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-e+"px")}else e=document.getElementById("dext_click_background"),null!=e&&void 0!=e?"block"==e.style.display?(dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none"),e.style.display="none"):(document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",this.set_full_size(e),e.style.display="block",G_SUB_DIALOG.style.display="block",e=getClientRect(G_SUB_DIALOG),n=getClientRect(_iframeWin.frameElement),r=parseInt(e.right,10)-parseInt(e.left,10),e.left+r>=n.right&&(e=e.left+r-n.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-e+"px")):alert("ErrCode : 2001")},set_full_size:function(e){var t=0,n=0;"BackCompat"==document.compatMode?(t=document.body.scrollWidth,n=document.body.scrollHeight):(t=document.documentElement.scrollWidth,n=document.documentElement.scrollHeight),e.style.width=t+"px",e.style.height=n+"px"},_set_resize:function(e){getDialogWindow();var t=getDialogDocument();if(0==DEXTTOP.DEXT5.isPopUpCssLoaded){var n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=DEXTTOP.DEXT5.isRelease?"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?ver="+DEXTTOP.DEXT5.ReleaseVer:DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup.css?ver="+DEXTTOP.DEXT5.ReleaseVer:"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?DEXTTOP.G_CURREDITOR._config.webPath.css_dev+"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?ver="+DEXTTOP.DEXT5.ReleaseVer:DEXTTOP.G_CURREDITOR._config.webPath.css_dev+"editor_popup.css?ver="+DEXTTOP.DEXT5.ReleaseVer,t.getElementsByTagName("head")[0].appendChild(n),DEXTTOP.DEXT5.isPopUpCssLoaded=!0}var r;getElementsByClass("EdiTor_Popup_header",e.contentWindow.document)[0].style.display="none",e.contentWindow.document.body.getElementsByTagName("div")[0].style.border="0px",r="BackCompat"==document.compatMode?e.contentWindow.document.body:e.contentWindow.document.documentElement,t=r.scrollWidth,n=e.contentWindow.document.body.clientHeight,r=r.scrollHeight,0==(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion)&&0<n&&n<r&&(r=n),n=r,e.style.width=t+"px",e.style.height=n+"px",r=e.parentNode.parentNode;var i=r.firstChild,s=e.contentWindow.document.body.getElementsByTagName("div")[0].className,o=getElementsByClass("subject",e.contentWindow.document,"span")[0].innerHTML;r.className=s,i.className="EdiTor_Popup_header",i.firstChild.innerHTML=o,i=function(){return function(t){press_enter_esc_btn(t,e.contentWindow.document),DEXTTOP.DEXT5.util.stopEvent(t)}}(),DEXTTOP.DEXT5.util.addEvent(e.contentWindow.document,"keydown",i),r.style.width=t+"px",r.style.height=n+29+"px",locationDialog(r)},show:function(e,t){var n=this;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(DEXTTOP.G_CURREDITOR.dialogWindow.DEXTWIN=DEXTTOP.DEXTWIN,DEXTTOP.G_CURREDITOR.dialogWindow.DEXTDOC=DEXTTOP.DEXTDOC,DEXTTOP.G_CURREDITOR.dialogWindow.G_CURREDITOR=DEXTTOP.G_CURREDITOR);var r=this._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);if(null==r)DEXTTOP.G_CURREDITOR._dextDialog.make(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config),r=this._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);else if(null!=DEXTTOP.DEXT5.config.DialogWindow){var i=getDialogDocument();i.getElementById("dext_dialog_close").onclick=function(){return hideDialog(i.getElementById("dext_dialog")),!1}}for(var s=e+t,o=DEXTTOP.G_CURREDITOR._config.itemCustomUrl.item.length,u=0;u<o;u++)if(0==t.indexOf("editor_"+DEXTTOP.G_CURREDITOR._config.itemCustomUrl.item[u])){s=DEXTTOP.G_CURREDITOR._config.itemCustomUrl.url[u];break}DEXTTOP.G_CURREDITOR.backupWidthForIOS.isPopup=!0,o=r.contentWindow;try{o.location.replace(s)}catch(a){r.src=s}if("none"==r.parentNode.parentNode.style.display){r.parentNode.parentNode.style.display="block",r.parentNode.parentNode.style.left="-800px",r.parentNode.parentNode.style.top="-800px",r.style.display="block",r.style.position="relative",r.style.left="0px",r.style.top="0px",-1<t.indexOf("editor_split_cell.html")&&(r.style.height="112px");var f=function(e){DEXTTOP.DEXT5.util.removeEvent(r,"load",f),n._set_resize(r),AdjustDesignBodyWidth({editor:DEXTTOP.G_CURREDITOR,isApply:!1});try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(G_USE_EDITOR_ID,e.target,"dialog"):DEXTTOP.dext_editor_afterpopupshow_event(G_USE_EDITOR_ID,e.target,"dialog")}catch(t){}};DEXTTOP.DEXT5.util.addEvent(r,"load",f)}DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose()},hide:function(){this._background(!1);var e=document.getElementById("dext_dialog_"+G_USE_EDITOR_ID);e&&(e.style.display="none",e.src="about:blank")}},Z[0]="h",K__+="j",R[2]="t",C1[2]="t",C2[2]="t",ALS[2]="X",S1[2]="t",S2[2]="t",K__+="k",R[3]="p",C1[3]="p",C2[3]="p",ALS[3]="T",S1[3]="p",S2[3]="p",K__+="l",K__+="m",Z[1]="t",K__+="n",R[4]=":",C1[4]=":",C2[4]="s",ALS[4]="5",S1[4]=":",S2[4]="s",R[5]="/",C1[5]="/",C2[5]=":",ALS[5]="E",S1[5]="/",S2[5]=":",R[6]="/",C1[6]="/",C2[6]="/",ALS[6]="d",S1[6]="/",S2[6]="/",SIL[2]="o",Z[2]="t",R[7]="w",C1[7]="a",C2[7]="/",ALS[7]="i",S1[7]="a",S2[7]="/",R[8]="w",C1[8]="u",C2[8]="a",ALS[8]="t",S1[8]="u",S2[8]="a",R[9]="w",C1[9]="t",C2[9]="u",ALS[9]="o",S1[9]="t",S2[9]="u",R[10]=".",C1[10]="h",C2[10]="t",ALS[10]="r",S1[10]="h",S2[10]="t",T[0]="Li",R[11]="d",C1[11]=".",C2[11]="h",ALS[11]="_",S1[11]=".",S2[11]="h",T[1]="c",_R_O_+=R[11],R[12]="e",C1[12]="r",C2[12]=".",ALS[12]="R",S1[12]="r",S2[12]=".",Z[3]="p",_R_O_+="g",R[13]="x",C1[13]="a",C2[13]="r",ALS[13]="A",S1[13]="a",S2[13]="r",T[2]="e",_R_O_+="f",R[14]="t",C1[14]="o",C2[14]="a",ALS[14]="D",S1[14]="o",S2[14]="a",_R_O_+="e",T[3]="n",R[15]="5",C1[15]="n",C2[15]="o",S1[15]="n",S2[15]="o",_R_O_+="a",R[16]=".",C1[16]="w",C2[16]="n",S1[16]="w",S2[16]="n",T[4]="se",_R_O_+="b",R[17]="c",T[5]="k",C1[17]="i",C2[17]="w",S1[17]="i",S2[17]="w",_R_O_+="H",T[6]="e",SIL[3]="b",T[7]="y",_R_O_+="M",R[18]="o",T[8]=" i",C1[18]="z",C2[18]="i",S1[18]="z",S2[18]="i",T[9]="s ",_R_O_+="N",R[19]="m",T[10]="i",C1[19]=".",C2[19]="z",S1[19]=".",S2[19]="z",T[11]="n",R[20]="/",C1[20]="c",C2[20]=".",S1[20]="c",S2[20]=".",Z[4]=":",T[12]="c",R[21]="r",C1[21]="o",C2[21]="c",S1[21]="o",S2[21]="c",T[13]="o",_R_O_+="O",R[22]="a",C1[22]="m",C2[22]="o",S1[22]="m",S2[22]="o",Z[5]="/",Z[6]="/",_R_O_+="P",R[23]="o",C1[23]="/",C2[23]="m",S1[23]="/",S2[23]="m";var _startXY={};T[14]="r",Z[7]="w",T[15]="r",Z[8]="w",_R_O_+="Q",T[16]="e",Z[9]="w",R[24]="n",T[17]="c",C1[24]="c",C2[24]="/",S1[24]="s",S2[24]="/",Z[10]=".",Z[11]="d",_R_O_+="I",T[18]="t",_R_O_+="J",R[25]=".",C1[25]="2",C2[25]="c",S1[25]=".",S2[25]="s",Z[12]="e",T[19]=". P",T[20]="l",_R_O_+="K",Z[13]="x",R[26]="a",C1[26]=".",C2[26]="2",S1[26]="a",S2[26]=".",Z[14]="t",T[21]=T[2]+"a",Z[15]="5",_R_O_+="L",T[22]=T[4],Z[16]=".",_R_O_+="R",Z[17]="c",___=1==DEXTTOP.IsCrossDomain?___.href:top.location.href,R[27]="s",C1[27]="a",C2[27]=".",S1[27]="s",S2[27]="a",T[23]=",",___=1==DEXTTOP.IsCrossDomain?null!=DEXTTOP.DEXTDOC.referrer&&void 0!=DEXTTOP.DEXTDOC.referrer&&""!=DEXTTOP.DEXTDOC.referrer?DEXTTOP.DEXTDOC.referrer:___:___,Z[18]="o",Z[19]="m",K__+=Z[18],_R_O_+="S",T[24]=" c",_R_O_+="T",K__+="p",T[25]=T[13],K__+="XYZ",_R_O_+="x",_R_O_+="y",Z[20]="/",T[26]="n",K__+="qrstU",Z[21]="z",K__+="VW",K__+="67890",T[27]=T[18],T[28]="a",Z[25]=".",T[29]="c",K__+="123",T[30]="t ",Z[26]="a",K__+="45",SIL[4]="a",Z[27]="s",T[31]="u",R[28]="p",C1[28]="s",C2[28]="a",S1[28]="p",S2[28]="s",Z[28]="p",K__+="+",T[32]="s.",C1[29]="p",C2[29]="s",S2[29]="p";var K__=K__+"/",_L__={_K:_R_O_+K__,DE:function(e){var t="",n,r,i,s,o,u=0;if(void 0==e||null==e||""==e)return!1;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)n=this._K.indexOf(e.charAt(u++)),r=this._K.indexOf(e.charAt(u++)),s=this._K.indexOf(e.charAt(u++)),o=this._K.indexOf(e.charAt(u++)),n=n<<2|r>>4,r=(r&15)<<4|s>>2,i=(s&3)<<6|o,t+=String.fromCharCode(n),64!=s&&(t+=String.fromCharCode(r)),64!=o&&(t+=String.fromCharCode(i));return t=_L__._utf8_d(t)},_utf8_d:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)r=e.charCodeAt(n),128>r?(t+=String.fromCharCode(r),n++):191<r&&224>r?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}};C2[30]="p";var DEXT5_CONTEXT={_reverse:!1,_context_id:"",_context_iframe:null,_context_zIndex:0,_context_bg_zIndex:0,_context_document:null,_context_main:null,_context_sub:null,_context_bg:null,_context_bg_id:"",_width:"",_height:"0",_item_disabled_list:[],_item_sub_list:{table_copy_paste:["table_copy","","intable_paste","table_content_paste"],table_copy_paste2:["table_copy","table_content_paste"],table_copy_paste3:["intable_paste","table_content_paste"],table_insert:["insert_row_up","insert_row_down","insert_column_left","insert_column_right"],table_select:["table_select_cell","table_select_all","","table_select_row","table_select_column"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],table_row_column:"table_row_clone  insert_row_column insert_row_up insert_row_down insert_column_left insert_column_right  insert_table_top_paragraph insert_table_bottom_paragraph".split(" "),delete_table_and_row_column:["table_delete","delete_row","delete_column"],delete_row_column:["delete_row","delete_column"],table_row_column_cell_property:["table_property","cell_property","row_property","column_property"],table_row_column_cell_property2:["table_property","cell_property"],table_row_column_cell_property3:["cell_property"],table_tool:["table_adjust","convert_table_to_text"],calculation_formula:["horizontal_sum","vertical_sum","horizontal_avg","vertical_avg"]},_non_image_item:" cell_size insert_row insert_column align_vertical table_insert select_column select_row select_cell table_tool paste_to_image paste_to_image_detail calculation_formula table_copy_paste table_copy_paste2 table_row_column delete_table_and_row_column delete_row_column table_row_column_cell_property table_row_column_cell_property2 table_row_column_cell_property3".split(" "),_create:function(e){e&&""!=e&&(e=DEXTTOP.DEXT5.util._setDEXT5editor(e))&&(DEXTTOP.G_CURREDITOR=e),getDialogWindow();var t=getDialogDocument();(e=t.getElementById("dext_context_iframe"))&&e.parentNode.removeChild(e),this._context_id="dext_context_iframe",this._context_bg_id="dext_context_background",this._context_zIndex=G_MAIN_ZINDEX+2e3,this._context_bg_zIndex=G_MAIN_ZINDEX+1e3;if(e=t.getElementById(this._context_id))_context_document=e.contentWindow.document,this._context_iframe=e,this._context_document=_context_document,this._context_main=_context_document.getElementById("ul_context_main"),this._context_sub=_context_document.getElementById("ul_context_sub");else{try{e=t.createElement("iframe")}catch(n){e=t.createElement("<iframe>")}t.body.appendChild(e),e.id=this._context_id,e.title="DEXT5Editor Context",e.style.margin="0px",e.style.padding="0px",e.style.zIndex=this._context_zIndex,e.style.position="absolute",e.scrolling="no",e.style.overflow="auto",e.style.overflowX="hidden",e.style.display="none",e.allowTransparency="true",e.frameBorder="0",t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",e.src=t;var t="",t=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,r="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(r="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var i=DEXTTOP.G_CURREDITOR._config.lang;-1<i.indexOf("-")&&(i=i.split("-")[0]),i=""+('<html lang="'+i+'" xml:lang="'+i+'"><head>')+"<title>DEXT5Editor Context</title>",i+='<link rel="stylesheet" type="text/css" href="'+t+r+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',i+='<link rel="stylesheet" type="text/css" href="'+t+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',i+="</head>",i+='<body scroll="no" style="overflow-x:hidden; overflow-y:hidden; margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">',i+='<div onselectstart="return false;" style="width:100%; height:100%" id="context_iframe_bg">',i+='<div class="DEXT_fiVe_ED_popup">',i+='<div id="div_main_context" class="DEXT_fiVe_EDP">',i+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'" id="div_main_context_skin1">',i+='<dl id="ul_context_main"></dl>',i+="</div>",i+="</div>",i+='<div class="DEXT_fiVe_EDP_s" id="div_sub_context" style="display:none; position:relative;">',i+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'" id="div_main_context_skin2">',i+='<dl id="ul_context_sub"></dl>',i+="</div>",i+="</div>",i+="</div>",i+="</div>",i+='<iframe style="HEIGHT: 100%; WIDTH: 100%; POSITION: absolute; LEFT: 0px; FILTER: alpha(opacity = 0); Z-INDEX: -1; DISPLAY: block; TOP: 0px" frameBorder="0" scrolling="no" tabkey="-1" title="DEXT5Editor Context Iframe"></iframe>',i+="</body></html>",_context_document=e.contentWindow.document,_context_document.open("text/html","replace"),isCustomDomain(document)&&(_context_document.domain=document.domain),_context_document.write(i),_context_document.close(),this._context_iframe=e,this._context_document=_context_document,this._context_main=_context_document.getElementById("ul_context_main"),this._context_sub=_context_document.getElementById("ul_context_sub");var s=this;e=function(){return function(e){s.hide()}}(),DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"click",e),DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"contextmenu",e),DEXTTOP.DEXT5.util.addEvent(_context_document,"dragover",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1}),DEXTTOP.DEXT5.util.addEvent(_context_document,"drop",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1})}this._context_main.innerHTML="",this._context_sub.innerHTML=""},_setMenu:function(e){var t=e.tagName.toLowerCase(),n="default",r=getFirstRange(),i=r.range;if("a"==t||"video"==t){var s=getFirstRange().sel;s.removeAllRanges(),i.selectNode(e),s.addRange(i)}var o=!0;try{DEXTTOP.DEXTWIN!=top&&(o=!1)}catch(u){}o&&setFocusTopWindow();var o=!1,s=DEXTTOP.G_CURREDITOR._config.tableNoActionClass,a=GetTableSelectionCells();if(0<a.length)""!=s&&(o=GetParentbyTagName(a[0],"table"),o=checkContainClass(o,s)),n=1==a.length?"selectedSingleCell":"selectedMultiCell",DEXTTOP.DEXT5.browser.ie&&(r.sel.removeAllRanges(),setTimeout(function(){doSetCaretPosition(getMyFirstOrLastChildElementNode(a[a.length-1]),0)},1));else{var f=i?i.toString():"";"video"==t&&(f=""),0<f.length&&"select"!=t&&"textarea"!=t?"table"==t?(""!=s&&(o=checkContainClass(e,s)),n="focustable",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):"a"==t?(n=e.getAttribute("DEXT5InsertFile"),n=""==e.href&&e.name==e.id?"focusbookmark":""==n?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):(s=r.sel)&&s.docSelection&&"Control"==s.docSelection.type?n="selectTable":(n="selectArea",setSelectoinElement(null)):"img"==t?(t=e.getAttribute("dext5customdata"),null!=t&&void 0!=t?(t=getDextCustomData(t),"iframe"==t.type?(n="focusiframe",DEXTTOP.G_SELECTED_ELEMENT=e):"flash"==t.type?(n="focusflash",DEXTTOP.G_SELECTED_ELEMENT=e):"media"==t.type?(n="focusmedia",DEXTTOP.G_SELECTED_ELEMENT=e):"link_media"==t.type?(n="focuslinkmedia",DEXTTOP.G_SELECTED_ELEMENT=e):"hidden"==t.type?(n="input_hidden",DEXTTOP.G_SELECTED_ELEMENT=e):"video_media"==t.type&&(n="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=e)):(G_DEPlugin[e.getAttribute("raon_plugin")]?n="focusPluginImage":e.getAttribute("raon_chart")&&G_DEPlugin.chart?(n="focusPluginImage",e.setAttribute("raon_plugin","chart")):n="focusImage",DEXTTOP.G_SELECTED_ELEMENT=e,DEXTTOP.G_SELECTED_IMAGE_ELEMENT=e),setSelectoinElement(e)):"a"==t?(n=e.getAttribute("DEXT5InsertFile"),n=""==e.href&&e.name==e.id?"focusbookmark":""==n?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):"table"==t?(""!=s&&(o=checkContainClass(e,s)),n="focustable",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):"embed"==t?(n="focusEmbed",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):"td"==t||"th"==t?(""!=s&&(o=GetParentbyTagName(e,"table"),o=checkContainClass(o,s)),n="focustd"):"input"==t?(""==e.type||"text"==e.type||"password"==e.type?n="input_textfield":"radio"==e.type?n="input_radio":"checkbox"==e.type?n="input_checkbox":"button"==e.type||"reset"==e.type||"submit"==e.type?n="input_button":"hidden"==e.type?n="input_hidden":"image"==e.type&&(n="input_image"),setSelectoinElement(e),DEXTTOP.G_SELECTED_ELEMENT=e):"select"==t?(n="input_select",setSelectoinElement(e),DEXTTOP.G_SELECTED_ELEMENT=e):"textarea"==t?(n="input_textarea",setSelectoinElement(e),DEXTTOP.G_SELECTED_ELEMENT=e):"video"==t?(n="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):"span"==t?"raon_placeholder"==e.className&&(n="placeholder",DEXTTOP.G_SELECTED_ELEMENT=e,setSelectoinElement(e)):(n="default",s=getFirstRange().sel,s.removeAllRanges(),s.addRange(i))}t=[],this._item_disabled_list=[];switch(n){case"default":t="paste cut copy  table_paste  paragraph_attribute  select_all  hyperlink_create".split(" "),DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?(t.splice(1,0,"text_paste"),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(7,0,"format_painter")):DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(6,0,"format_painter"),checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&t.splice(1,0,"paste_to_image","paste_to_image_detail"),this._item_disabled_list=["cut","copy"],null==DEXTTOP.G_COPIEDCELLDATA&&this._item_disabled_list.push("table_paste"),this._height="150px",this._width="200px";break;case"selectArea":t="paste cut copy  paragraph_attribute  select_all".split(" "),DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?(t.splice(1,0,"text_paste"),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(5,0,"apply_format")):DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(4,0,"apply_format"),s=!0,f=!1;if(DEXTTOP.DEXT5.browser.ie)try{var l=getNodesInRange(i);if(9==l[0].nodeType){if(i.startContainer==i.endContainer&&3==i.startContainer.nodeType&&3==i.endContainer.nodeType){var c=GetParentbyTagName(i.startContainer,"a"),h=GetParentbyTagName(i.startContainer,"a");null==c&&null==h&&(f=!0)}}else if(1==l[0].nodeType&&i.startContainer!=i.endContainer&&3==i.startContainer.nodeType&&3==i.endContainer.nodeType){l=!1;if("A"==i.startContainer.parentNode.tagName){var l=!0,p=i.startContainer.parentNode.nextSibling;3==p.nodeType?i.setStart(p,0):1==p.nodeType?i.setStartAfter(p):i.setStartAfter(i.startContainer)}else"A"==i.endContainer.parentNode.tagName&&(l=!0,p=i.endContainer.parentNode.previousSibling,3==p.nodeType?i.setEnd(p,p.length):1==p.nodeType?i.setEndBefore(p):i.setEndBefore(i.endContainer));l&&(r.sel.removeAllRanges(),r.sel.addRange(i),i=getFirstRange().range,DEXTTOP.G_CURREDITOR._LastRange=i,DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&(DEXTTOP.G_SELECTED_ELEMENT=null))}}catch(d){f=!1}if(f)s=!0;else for(l=getNodesInRange(i),i=l.length,r=0;i>r;r++)if(l[r].tagName&&"a"==l[r].tagName.toLowerCase()){s=!1;break}s&&(t.push(""),t.push("hyperlink_create")),checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&t.splice(1,0,"paste_to_image","paste_to_image_detail"),this._item_disabled_list=[],DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format"),this._height="130px",this._width="200px";break;case"selectTable":t="paste cut copy  select_all  table_indent table_outdent  table_adjust  table_property".split(" "),DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&t.splice(1,0,"text_paste"),checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&t.splice(1,0,"paste_to_image","paste_to_image_detail"),this._item_disabled_list=[],this._height="130px",this._width="200px";break;case"selectedSingleCell":t="paste cut copy  paragraph_attribute  select_all  split_cell  table_tool table_copy_paste delete_row_column table_row_column_cell_property3  align_vertical".split(" "),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(11,0,"apply_format"),this._item_disabled_list=["cut","copy","paste"],null==DEXTTOP.G_COPIEDCELLDATA&&(this._item_disabled_list.push("table_content_paste"),this._item_disabled_list.push("intable_paste")),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format"),this._height="300px",this._width="400px";break;case"selectedMultiCell":t="paste cut copy  paragraph_attribute  select_all  merge_cell split_cell  table_tool table_copy_paste2 delete_row_column table_row_column_cell_property2 cell_size  align_vertical".split(" "),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(7,0,"apply_format"),this._item_disabled_list=["cut","copy","paste","table_content_paste"],DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format"),this._height="500px",this._width="400px";break;case"focusImage":t=DEXTTOP.G_SELECTED_ELEMENT&&DEXTTOP.G_SELECTED_ELEMENT.parentNode&&"A"==DEXTTOP.G_SELECTED_ELEMENT.parentNode.tagName?"paste cut copy  select_all  hyperlink_open hyperlink_property remove_hyperlink  save_as_image ".split(" "):"paste cut copy  select_all  hyperlink_create  save_as_image ".split(" "),DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile||t.push("image_property"),"1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor&&t.push("mini_photo_editor"),"ieplugin"!=DEXTTOP.G_CURREDITOR._config.runtimes&&DEXTTOP.DEXTWIN.DEXT5PHOTO&&"IMG"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&(l=DEXTTOP.G_SELECTED_ELEMENT.src,0>l.indexOf("file://")&&(4<l.length&&"http"==l.substring(0,4).toLowerCase()?l.match(/:\/\/(.[^\/]+)/)[1]==DEXTTOP.window.location.href.match(/:\/\/(.[^\/]+)/)[1]&&t.push("photo_editor_property"):t.push("photo_editor_property"))),this._item_disabled_list=["paste"],this._height="300px",this._width="200px";break;case"focusa":t="paste cut copy  select_all  hyperlink_open hyperlink_property remove_hyperlink".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="300px",this._width="200px";break;case"focusbookmark":t="paste cut copy  select_all  bookmark".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="300px",this._width="200px";break;case"focustable":t="paste cut copy  select_all  table_adjust  table_property".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="300px",this._width="200px";break;case"focusembed":t="paste cut copy  select_all  flash_property".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="300px",this._width="200px";break;case"focusVideo":t="paste cut copy  select_all  video_property".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="300px",this._width="200px";break;case"focustd":t="table_selection  table_indent table_outdent  cut copy paste  paragraph_attribute  split_cell  table_tool table_copy_paste3 table_row_column delete_table_and_row_column table_row_column_cell_property  table_select align_vertical  calculation_formula".split(" "),DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&t.splice(8,0,"text_paste"),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&t.splice(8,0,"format_painter"),checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&t.splice(3,0,"paste_to_image","paste_to_image_detail"),this._item_disabled_list=["cut","copy","table_copy"],null==DEXTTOP.G_COPIEDCELLDATA&&(this._item_disabled_list.push("table_content_paste"),this._item_disabled_list.push("intable_paste")),this._width="350px",this._height="500px";break;case"focusiframe":t="paste cut copy  select_all  iframe_property".split(" "),this._item_disabled_list=["paste"],this._height="300px",this._width="200px";break;case"focusflash":t="paste cut copy  select_all  flash_property".split(" "),this._item_disabled_list=["paste"],this._height="300px",this._width="200px";break;case"focusmedia":t="paste cut copy  select_all  media_property".split(" "),this._item_disabled_list=["paste"],this._height="300px",this._width="200px";break;case"focuslinkmedia":t="paste cut copy  select_all ".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"placeholder":t=["paste","cut","copy"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("placeholder")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_textfield":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_textfield")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_radio":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_radio")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_checkbox":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_checkbox")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_button":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_button")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_select":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_select_property")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_textarea":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_textarea_property")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_image":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_imagebutton")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"input_hidden":t=["paste","cut","copy","","select_all"],"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(t.push(""),t.push("input_hiddenfield")),this._item_disabled_list=["paste","cut","copy"],this._height="130px",this._width="200px";break;case"focusinsertfile":t="paste cut copy  select_all  insert_file_property filelink_open".split(" "),this._item_disabled_list=["paste","cut","copy"],this._height="300px",this._width="200px";break;default:this._height=this._width="1px"}"focusPluginImage"==n&&(l=e.getAttribute("raon_plugin"),G_DEPlugin[l]&&G_DEPlugin[l].onCreateContextMenu&&(r={items:t,disabledItems:this._item_disabled_list,width:this._width,height:this._height},G_DEPlugin[l].onCreateContextMenu(r),t=r.items,this._item_disabled_list=r.disabledItems,this._width=r.width,this._height=r.height)),"focustd"==n&&(e=GetParentbyTagName(e,"table"),0>=parseIntOr0(e.style.marginLeft)&&this._item_disabled_list.push("table_outdent")),o&&(this._item_disabled_list=addDisalbeItemForNoActionTable(this._item_disabled_list)),this._height="0px",e=this._context_document.createElement("dt"),e.innerHTML="context_main_menu",this._context_main.appendChild(e),e=t.length;for(r=0;r<e;r++)this._addItem(t[r]);e=this._context_main.getElementsByTagName("dd"),o=e.length;for(--o;0<=o;o--)0==o?"b_border"==e[o].className&&this._context_main.removeChild(e[o]):"b_border"==e[o].className&&"b_border"==e[o-1].className&&this._context_main.removeChild(e[o]);e=this._context_main.getElementsByTagName("dd"),o=e.length,1<o&&"b_border"==e[o-1].className&&this._context_main.removeChild(e[o-1]),this._height=parseInt(this._height,10)+2+"px",this._disableItem(this._item_disabled_list)},_disableItem:function(e){for(var t=e.length,n=0;n<t;n++){var r=this._context_document.getElementById("context_"+e[n]);r&&(r.className="item_disabled")}},_addItem:function(e){for(var t=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),n=t.length,r=0;r<n;r++)if(t[r]==e)return;var t=this._context_document.createElement("dd"),i=this,n=this._getImageUrl(e),r=this._getText(e),s=this._item_sub_list[e];if(""==r)t.className="b_border",this._height=parseInt(this._height,10)+1+"px";else{this._height=parseInt(this._height,10)+24+"px";var o=this._context_document.createElement("div"),u=this._context_document.createElement("div"),a=this._context_document.createElement("div"),f=this._context_document.createElement("span");0<n.length&&(f.className=e,o.appendChild(f),0==e.indexOf("p_")&&(f.style.background="url("+n+") transparent no-repeat")),"textContent"in u?u.textContent=r:u.innerText=r,o.className="s_left",u.className="s_right",t.appendChild(o),t.appendChild(u),s?(a.className="arrow",t.appendChild(a),n=function(e){return function(t){if("item_disabled"!=e.className){i._context_sub.innerHTML="";for(var n=s.length,r=0;r<n;r++){if(0==r){var o=i._context_document.createElement("dt");o.innerHTML="context_sub_menu",i._context_sub.appendChild(o)}i._addSubItem(s[r])}i._disableItem(i._item_disabled_list),n=t.target?t.target:t.srcElement,r=getClientRect(n),0==r.top&&(r=getClientRect(n)),i._context_document.getElementById("div_sub_context").style.display="";var o=getClientRect(i._context_document.getElementById("div_sub_context")),o=o.bottom-o.top,u=getClientRect(i._context_document.getElementById("div_main_context")),a=r.top;r.top+o>u.bottom&&(a=r.top-(r.top+o-u.bottom)),i._context_document.getElementById("div_sub_context").style.top=a+"px",1==i._reverse?(n=getClientRect(n.parentElement),r=getClientRect(i._context_document.getElementById("div_sub_context")),i._context_document.getElementById("div_sub_context").style.left=n.left-(r.right-r.left)+2+"px"):i._context_document.getElementById("div_sub_context").style.left="0px",n=getClientRect(i._context_document.getElementById("div_sub_context")),getClientRect(i._context_document.getElementById("div_main_context")),r=getClientRect(i._context_iframe),r=r.bottom-r.top,n.bottom>r&&(n=n.bottom-r,n=parseIntOr0(i._context_iframe.style.height)+n+2,i._context_iframe.style.height=n+"px"),e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t)}}}(t),r=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(t),o=function(e){return function(e){DEXTTOP.DEXT5.util.stopEvent(e)}}(t)):(n=function(e){return function(t){i._context_document.getElementById("div_sub_context").style.display="none","item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(t),r=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(t),i=this,o=function(t){return function(n){"on_mouseover"==t.className&&(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,e,i),i.hide())}}(t)),DEXTTOP.DEXT5.util.addEvent(t,"mouseover",n),DEXTTOP.DEXT5.util.addEvent(t,"mouseout",r),DEXTTOP.DEXT5.util.addEvent(t,"click",o)}0<e.length&&(t.id="context_"+e),t.unselectable="on",this._context_main.appendChild(t),t=this._context_main.getElementsByTagName("dd");for(n=t.length-1;0<=n;n--)0==n?"b_border"==t[n].className&&this._context_main.removeChild(t[n]):"b_border"==t[n].className&&"b_border"==t[n-1].className&&this._context_main.removeChild(t[n])},_addSubItem:function(e){for(var t=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),n=t.length,r=0;r<n;r++)if(t[r]==e)return;var t=this._context_document.createElement("dd"),i=this,n=this._getImageUrl(e),r=this._getText(e);if(""==r)t.className="b_border";else{var s=this._context_document.createElement("div"),o=this._context_document.createElement("div"),u=this._context_document.createElement("span");0<n.length&&(u.className=e,s.appendChild(u),0==e.indexOf("p_")&&(u.style.background="url("+n+") transparent no-repeat")),"textContent"in o?o.textContent=r:o.innerText=r,s.className="s_left",o.className="s_right",t.appendChild(s),t.appendChild(o),n=function(e){return function(t){"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(t),r=function(e){return function(t){"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(t),i=this,s=function(t){return function(n){"on_mouseover"==t.className&&(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,e),i.hide())}}(t),DEXTTOP.DEXT5.util.addEvent(t,"mouseover",n),DEXTTOP.DEXT5.util.addEvent(t,"mouseout",r),DEXTTOP.DEXT5.util.addEvent(t,"click",s),0<e.length&&(t.id="context_"+e),t.unselectable="on"}this._context_sub.appendChild(t)},_getImageUrl:function(e){var t="";if(0==e.indexOf("p_")){var t=e.split("_"),n=t[1],r="icon";2<t.length&&(r=t[2]),t=DEXTTOP.G_CURREDITOR._config.webPath.plugin+n+"/images/"+r+".png"}else t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif";n=this._non_image_item.length;for(r=0;r<n;r++)if(e==this._non_image_item[r]){t="";break}return t},_getText:function(e){var t="";return""!=e&&(0==e.indexOf("p_")?(t=e.split("_")[1],t=dext5_lang.plugins[t].context[e]):t=dext5_lang.context[e]),t},show:function(e){var t=getDialogWindow(),n=getDialogDocument();if(null==this._context_iframe)this._create();else{var n=n.getElementById(this._context_id),r=n.contentWindow.document;this._context_iframe=n,this._context_document=r,this._context_main=r.getElementById("ul_context_main"),this._context_sub=r.getElementById("ul_context_sub")}n=this._context_document.getElementById("div_main_context_skin1"),r=this._context_document.getElementById("div_main_context_skin2"),n.className="Dfe_popup DEXT_fiVe_"+DEXTTOP.G_CURREDITOR._config.style.skinName,r.className="Dfe_popup DEXT_fiVe_"+DEXTTOP.G_CURREDITOR._config.style.skinName,n=this._context_document.getElementsByTagName("link");for(r=0;r<n.length;r++){var i=n[r].href;if(-1<i.lastIndexOf("editor_icon")){"icon_mono"==DEXTTOP.G_CURREDITOR._config.style.iconName?-1==i.lastIndexOf("editor_icon_mono")&&(i=i.replace("editor_icon.css","editor_icon_mono.css")):-1<i.lastIndexOf("editor_icon_mono")&&(i=i.replace("editor_icon_mono.css","editor_icon.css")),n[r].href=i;break}}this._context_main.innerHTML="",this._context_sub.innerHTML="",n=e.target?e.target:e.srcElement;if(null!=n){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design),restoreSelection(),setFocusToBody(),r=n.tagName.toLowerCase(),"img"!=r&&"hr"!=r&&"a"!=r&&"input"!=r&&"textarea"!=r&&"select"!=r&&(i=GetParentbyTagName(n,"a"))&&(n=i,r=n.tagName.toLowerCase()),i=null;if("img"!=r&&"hr"!=r&&"a"!=r&&"input"!=r&&"textarea"!=r&&"select"!=r){if("table"!=r||"td"!=r||"th"!=r)i=GetTDTHCell(n);i&&(DEXTTOP.G_SELECTED_ELEMENT=i)}null==i?this._setMenu(n):this._setMenu(i),this._context_iframe.style.width=this._width,this._context_iframe.style.height=this._height;var r=Math.round(e.clientX),i=Math.round(e.clientY),n={},n=getWindowScrollPos(t),s=getClientRect(_iframeWin.parent.frameElement),o=getClientRect(_iframeWin.frameElement),u=0,a=0;if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(var f=_iframeWin.parent.parent;f!=t;)var l=getClientRect(f.frameElement),u=u+l.left,a=a+l.top,f=f.parent;this._context_iframe.style.left=r+n[0]+s.left+o.left+u+"px",this._context_iframe.style.top=i+n[1]+s.top+o.top+a+"px",this._reverse=!1,r=parseInt(this._context_iframe.style.left,10)+parseInt(this._width,10),i=parseInt(this._context_iframe.style.top,10)+parseInt(this._height,10),s=getWindowClientSize(t),t=n[0]+s[0]-20,n=n[1]+s[1]-10,r>=t?(s=r-t,s=parseInt(this._context_iframe.style.left,10)-s,r-t<parseInt(this._width,10)/2&&(s-=parseInt(this._width,10)/2),this._context_iframe.style.left=s+"px","cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat="right":this._context_document.getElementById("div_main_context").style.styleFloat="right",this._reverse=!0):"cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat="left":this._context_document.getElementById("div_main_context").style.styleFloat="left",i>=n&&(t=i-n,t=parseInt(this._context_iframe.style.top,10)-t,this._context_iframe.style.top=t+"px"),this._makeBackground(),this._context_iframe.style.display="";try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(DEXTTOP.G_CURREDITOR.ID,e.target,"contextmenu"):DEXTTOP.dext_editor_afterpopupshow_event(DEXTTOP.G_CURREDITOR.ID,e.target,"contextmenu")}catch(c){}}},hide:function(){this._context_document&&this._context_document.getElementById("div_sub_context")&&(this._context_document.getElementById("div_sub_context").style.display="none"),this._context_iframe&&(this._context_iframe.style.display="none"),this._context_bg&&(this._context_bg.style.display="none");var e=DEXTTOP.G_CURREDITOR._LastRange?DEXTTOP.G_CURREDITOR._LastRange:getFirstRange().range;restoreSelection(e,!0)},_makeBackground:function(){var e=this,t=getDialogWindow(),n=getDialogDocument();this._context_bg=n.getElementById(e._context_bg_id),DEXTTOP.G_CURREDITOR.dialogWindow&&this._context_bg&&(this._context_bg.parentNode.removeChild(this._context_bg),this._context_bg=null),this._context_bg&&(this._context_bg.style.display="",this._context_bg.style.overflow="visible");if(!this._context_bg){this._context_bg=n.createElement("div"),this._context_bg.id=this._context_bg_id,this._context_bg.style.overflow="visible",this._context_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0;  -khtml-opacity: 0.0; background-color:#ffffff; z-index:'+this._context_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; width:1px; height:1px; "></div>',n.body.appendChild(this._context_bg);var r=function(){return function(t){e.hide()}}();DEXTTOP.DEXT5.util.addEvent(this._context_bg,"click",r),DEXTTOP.DEXT5.util.addEvent(this._context_bg,"contextmenu",r),DEXTTOP.DEXT5.util.addEvent(t,"resize",DEXTTOP.G_CURREDITOR.context_bg_resize),t="CSS1Compat"==n.compatMode?n.documentElement.scrollHeight:n.body.scrollHeight,this._context_bg.firstChild.style.width=("CSS1Compat"==n.compatMode?n.documentElement.scrollWidth:n.body.scrollWidth)-10+"px",this._context_bg.firstChild.style.height=t-10+"px"}}},g_findRepalceRange=null,_iframeDoc,_iframeWin,G_CURSOR_BEFORE_INTABLE=!1,G_BEFORE_INTABLE=null,G_FIRST_CLICK_EVENT=!0,G_ImagesBase64Data=[],G_IMG_TOTAL_SIZE=-1,G_IMG_TOTAL_LIST={},G_IMG_CURRENT_LIST={},G_IMG_CURRENT_ARRAYLIST=[],G_IMG_TOTAL_COUNT=0,G_KEY_IMG_COUNT=-1,G_KeyDownUpSync=!1,G_HandleFilesCheck=!1,G_FullScreenCheckObject=[],G_IsPossibleDirty=!1,G_FormData=[],bCtrlKey=!1,startBookmark,endBookmark;Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){t=t||0;for(var n=this.length;t<n;){if(this[t]===e)return t;++t}return-1}),DEXTTOP.Array.prototype.indexOf||(DEXTTOP.Array.prototype.indexOf=function(e,t){t=t||0;for(var n=this.length;t<n;){if(this[t]===e)return t;++t}return-1});try{HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var r=this;setTimeout(function(){for(var i=atob(r.toDataURL(t,n).split(",")[1]),s=i.length,o=new Uint8Array(s),u=0;u<s;u++)o[u]=i.charCodeAt(u);e(new Blob([o],{type:t||"image/png"}))})}})}catch(e$$228){}var getNextNumber=function(){var e=0;return function(){return++e+""}
}(),dragPopup=null,currentScrollPos,originScrollSize=null,originfull={},relativePos=!1,originStylebackup=[],StringBuffer=function(){this.buffer=[]};StringBuffer.prototype.append=function(e){this.buffer[this.buffer.length]=e},StringBuffer.prototype.toString=function(){return this.buffer.join("")};var G_IsTouchMoved=!1,G_LastNodeForLi=null,G_IsMulitSelectionInLi=!1,G_RULER_OFFSET_X,G_RULER_COORD_X,G_RULER_DRAG=!1,G_CURR_DRAGGIN_RULER,G_RULER_MOVE_AREA={realX1:0,x1:0,realX2:0,x2:0},G_Toolbar_Scrolling,G_MIME_OBJ={_subject:"DEXT5 Editor Mime 1.0",_getDate:function(){var e=new Date,t=e.toDateString().split(" "),e=e.toTimeString().split(" "),n=[];return n.push(t[0]+","),n.push(1*t[2]),n.push(t[1]),n.push(t[3]),n.push(e[0]),n.push(e[1].substring(3)),n.join(" ")},_mimeVersion:"1.0",_contentType:"multipart/related",_boundary:"",_boundaryIndex:1,getBoundary:function(e){if(""==this._boundary||e)9<this._boundaryIndex&&(this._boundaryIndex=1),this._boundary="__=_Part_Boundary_00",this._boundary+=this._boundaryIndex++,this._boundary+="_",this._boundary+="0"+Math.random().toString().slice(2,7),this._boundary+=".",this._boundary+="0"+Math.random().toString().slice(2,7);return this._boundary},_xGenerator:"DEXT5 Editor MIME Control for HTML5 V1.0 by RAONWIZ Inc.",_EOL:"\r\n",getHeader:function(){var e=[];return e.push("Subject: "+this._subject),e.push("Date: "+this._getDate()),e.push("MIME-Version: "+this._mimeVersion),e.push("Content-Type: "+this._contentType+";"),e.push('	boundary="'+this.getBoundary()+'"'),e.push("X-Generator: "+this._xGenerator),e.push(""),e.push(""),e.join(this._EOL)},_body:"",getBody:function(e,t){var n=this,r=[];r.push("--"+n.getBoundary()),r.push("Content-Type: text/html;"),r.push('	charset="utf-8"'),r.push("Content-Transfer-Encoding: base64"),r.push(""),n._contentBuffer=[],n._createContentImage(e,function(e){r.push(DEXTTOP.DEXT5.util.base64_encode(e)),r.push("");for(e=0;e<n._contentBuffer.length;e++){var i=n._contentBuffer[e];r.push("--"+n.getBoundary()),r.push("Content-Type: "+i.type+";"),r.push('	name="'+i.name+'"'),r.push("Content-Transfer-Encoding: "+i.encoding),r.push("Content-ID: <"+i.id+">"),r.push("Content-Disposition: "+i.disposition+";"),r.push('	filename="'+i.filename+'"'),r.push(""),r.push(i.data),r.push("")}r.push("--"+n.getBoundary()+"--"),n._body=r.join(n._EOL),e=n._breakLine(n._body),"function"==typeof t&&t(e)})},_contentBuffer:[],_createContentImage:function(e,t){var n=this,r=document.createElement("div");r.innerHTML=e;var i=r.getElementsByTagName("img"),s=0,o=function(u){if("undefined"==typeof u)r.innerHTML="","function"==typeof t&&t(e);else{var l=u.src;if(0==l.indexOf("data:")){u=l.replace(/^data:image\/.+;base64,/,"");var h=l.match(/:.+;/)[0],p="."+h.substring(h.indexOf("/")+1,h.length-1);u={type:h.substring(1,h.length-1),name:n._makeRandomString()+p,encoding:"base64",id:n._makeRandomString()+"@raonwiz.com",disposition:"inline",filename:n._makeRandomString()+p,data:u},n._contentBuffer.push(u),p=e.indexOf(l),h=e.substring(0,p),p=e.substring(p+l.length),e=h+"cid:"+u.id+p}else if(0==l.indexOf("http://")||l.indexOf("https://"))if(u=l.replace(/https?:\/\//,"").split("/")[0],h=window.location.href.replace(/https?:\/\//,"").split("/")[0],0==l.indexOf("/")||u==h)try{var v=l.split("/"),v=v[v.length-1],m=new XMLHttpRequest;m.open("GET",l,!0),m.responseType="blob",m.onload=function(){try{var t=m.response.type.toLowerCase(),r="";switch(t){case"image/gif":r=".gif";break;case"image/jpeg":r=".jpg";break;case"image/png":r=".png";break;case"image/tiff":r=".tif";break;case"image/bmp":r=".bmp"}if(-1<",image/gif,image/jpeg,image/png,image/tiff,image/bmp,".indexOf(""+t+"")){var u=new FileReader;u.readAsDataURL(m.response),u.onload=function(t){var u=t.target.result.replace(/^data:image\/.+;base64,/,"");t=t.target.result.match(/:.+;/)[0],v=v.replace(/[<>:"/\\|?*]/g,""),250<v.length&&(v=n._makeRandomString()+r),u={type:t.substring(1,t.length-1),name:v,encoding:"base64",id:n._makeRandomString()+"@raonwiz.com",disposition:"inline",filename:n._makeRandomString()+r,data:u},n._contentBuffer.push(u);var h=e.indexOf(l);t=e.substring(0,h),h=e.substring(h+l.length),e=t+"cid:"+u.id+h,o(i[++s])}}else o(i[++s])}catch(h){o(i[++s])}},m.send();return}catch(y){o(i[++s]);return}o(i[++s])}};o(i[s])},_makeRandomString:function(){return Math.random().toString(16).substring(2,10)+Math.random().toString(16).substring(2,10)+Math.random().toString(16).substring(2,10)+Math.random().toString(16).substring(2,10)},_breakLine:function(e){var t=[];e=e.replace(/\r/g,"").split("\n");for(var n=0;n<e.length;n++)if(76<e[n].length){for(var r=e[n];76<r.length;)t.push(r.substring(0,76)),r=r.substring(76);t.push(r)}else t.push(e[n]);return t.join(this._EOL)},toMIME:function(e,t,n){var r="",r=r+this.getHeader();this.getBody(e,function(e){r+=e,"function"==typeof n&&n(r)})},toHTML:function(e){try{e=e.replace(/\r/g,"").replace(/;\n\s/g,";");var t=e.match(/boundary\=\".+\"\n/);if(!(t&&0<t.length))return"";t=t[0];var t=t.substring(t.indexOf('"')+1,t.lastIndexOf('"')),n=e.split("--"+t),r=this._parseObj(n[1],{"Content-Type":"","Content-Transfer-Encoding":""});r.data=DEXTTOP.DEXT5.util.base64_decode(r.data),e=[];if(3<n.length)for(var i=2;i<n.length-1;i++)e.push(n[i]);n={"Content-Type":"","Content-Transfer-Encoding":"","Content-ID":"","Content-Disposition":""};for(i=0;i<e.length;i++){var s=this._parseObj(e[i],n);if(s["Content-ID"]){var o="cid:"+s["Content-ID"].replace(/[\<\>]/g,"");if(-1<r.data.indexOf(o)){for(var u=s["Content-Type"].split(";"),t=0;t<u.length;t++)if(-1<u[t].indexOf("/")){u=u[t];break}r.data=r.data.replace(o,"data:"+u+";"+s["Content-Transfer-Encoding"]+","+s.data)}}}return r.data}catch(a){return"0"}},_parseObj:function(e,t){var n={},r;for(r in t){var i=e.match(r+":.+");0<i.length&&(n[r]=i[0].replace(r+":","").trim(),e=e.replace(i,""))}return n.data=e.replace(/\n/g,"").trim(),n}},ColorCellBackColor="#d0e6fd",ColorCellDefColor="#ffffff",Mouse_IsPlain=0,Mouse_IsTableSelecting=1,Mouse_IsTableDragging=2,Mouse_IsControlSelecting=3,Mouse_IsCellDragging=4,Mouse_IsCellResizing=5,Mouse_Status=Mouse_IsPlain,DrageStartCell=null,DrageEndCell=null,ActiveCurrTable=null,ActiveLastTable=null,mouseStartPos={},mouseEndPos={},elResizeBar,elResizeBarCover,ResizeInfo={},nDraggableCellEdge=4,nPageLeftRightMargin=0,nPageTopBottomMargin=0,MIN_CELL_WIDTH=10,MIN_CELL_HEIGHT=10,nStartHeight=0,nStartWidth=0,dragMove={dragStart:!1,dragData:null,dragRange:null,dragTarget:null,bodyRect:null,backX:0,backY:0,dragCursorOffsetX:0,dragCursorOffsetY:0,dragDummy:null,dragDummyBack:null,dragCaretValid:!1,dragCaret:null,dragEndContainer:null,ieButton:0},G_ResizeFixedTable={modifiedName:"d5col",changeColWidth:function(e,t){var n=this.getColWidth(e);this.setColWidth(e,n+t)},setColWidth:function(e,t){e.width=t+"px"},getColWidth:function(e){return parseFloat(""!=e.style.width?e.style.width:e.width)},getCellIndex:function(e){for(var t=0,n=this.getColgroup(e).childNodes.length,r=getClientRect(e),i=e.parentNode,s=GetParentbyTagName(i,"table");i;){for(var o=0,u=i.cells,a=u.length,f=0;f<a;f++)o+=this.getColSpanInt(u[f]);if(o==n)break;i=s.rows[i.rowIndex-1]}i=i.cells,s=i.length;for(f=0;f<s;f++){if(o=i[f],n=getClientRect(o),o=this.getColSpanInt(o),t+=o,this.isSameLeftRect(n,r)){t-=o;break}if(this.isSameRightRect(n,r)){t-=this.getColSpanInt(e);break}if(this.isContainedRect(n,r)){t-=o;for(e=e.previousSibling;e&&(r=getClientRect(e),t+=this.getColSpanInt(e),!this.isSameLeftRect(n,r));)e=e.previousSibling;break}}return t},getColIndex:function(e){var t=null,t=this.getCellIndex(e);return e=t+this.getColSpanInt(e)-1,t={start:t,end:e}},getColgroup:function(e){return GetParentbyTagName(e,"table").getElementsByTagName("colgroup")[0]},getColSpanInt:function(e){return e.colSpan?e.colSpan:1},isSameLeftRect:function(e,t){return 1>Math.abs(e.left-t.left)?!0:!1},isSameRightRect:function(e,t){return 1>Math.abs(e.right-t.right)?!0:!1},isContainedRect:function(e,t){return 1<=Math.abs(e.left-t.left)&&e.left<t.left&&1<=Math.abs(e.right-t.right)&&e.right>t.right?!0:!1},isExcute:function(e){var t=!1;return"fixed"==e.style.tableLayout&&-1!=e.innerHTML.indexOf("<col")&&(t=!0),t},isModifiedTable:function(e){var t=!1;return null!=e.getAttribute(this.modifiedName)&&(t=!0),t},setColgroupToTable:function(e){try{if(0==this.isModifiedTable(e)){for(var t=e.rows[0].cells,n=t.length,r=_iframeDoc.createElement("colgroup"),i=0;i<n;i++)for(var s=t[i],o=s.colSpan?parseInt(s.colSpan):1,u=s.clientWidth,a=0;a<o;a++){var f=_iframeDoc.createElement("col");this.setColWidth(f,(u/o).toFixed(1)),r.appendChild(f)}for(var l=e.getElementsByTagName("colgroup"),c=l.length-1;0<=c;c--)e==GetParentbyTagName(l[c],"table")&&l[c].parentNode.removeChild(l[c]);var h=e.getElementsByTagName("tbody")[0];e.insertBefore(r,h),e.setAttribute(this.modifiedName,"")}}catch(p){}},resizeFixedTable:function(e){try{var t=e.nNewWidth;if(0!=t){var n=e.targetCell,r=GetParentbyTagName(n,"table");if(0!=this.isExcute(r)){this.setColgroupToTable(r);var i=this.getColgroup(n).childNodes,s=this.getCellIndex(n)+(n.colSpan?n.colSpan:1);0<t&&--s,e=0>t?-1:1,t=Math.abs(t),i[s]&&this.changeColWidth(i[s],t),s+=e;if(i[s])for(;i[s];){var o=this.getColWidth(i[s]);o<=t?(t-=o-1,this.changeColWidth(i[s],-(o-1)),s+=e):(this.changeColWidth(i[s],-t),t=0);if(0==t)break}r.style.width="1px";var u=getClientRect(r);r.style.width=u.right-u.left+"px"}}}catch(a){}},setSameWidth:function(e){try{var t=GetTableSelectionCells(),n=GetParentbyTagName(t[0],"table");if(0!=this.isExcute(n)){this.setColgroupToTable(n),e=[];for(var r=t.length,i=-1,s=-1,n=0;n<r;n++)t[n].parentNode.rowIndex!=i&&(i=t[n].parentNode.rowIndex,s++,e[s]=[]),t[n].parentNode.rowIndex==i&&e[s].push(t[n]);e.sort(function(e,t){return t.length>e.length?1:t.length<e.length?-1:0});for(var o=e.length,u=this.getColgroup(t[0]).childNodes,t=0;t<o;t++){for(var r=0,i=[],a=e[t],f=a.length,n=0;n<f;n++){var l=this.getColIndex(a[n]);i.push(l);for(var c=l.start;c<=l.end;c++)r+=this.getColWidth(u[c])}for(var h=r/a.length,p=i.length,n=0;n<p;n++)for(var d=(h/(i[n].end-i[n].start+1)).toFixed(1),c=i[n].start;c<=i[n].end;c++)this.setColWidth(u[c],d)}}}catch(v){}}},DEXT5_TOPMENU={_topmenu_id:"",_topmenu_iframe:null,_topmenu_zIndex:0,_topmenu_bg_zIndex:0,_topmenu_document:null,_topmenu_main:null,_topmenu_sub:null,_topmenu_bg:null,_topmenu_bg_id:"",_width:"",_height:"0",_item_sub_list:{entity:["insert_link_media","iframe_create","flash_create","media_create","video"],align:["align_left","align_center","align_right","align_full"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left","insert_column_right"],table_select:["table_select_cell","table_select_all","","table_select_row","table_select_column"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],table_tool:["table_adjust","convert_table_to_text"],list_number:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman".split(" "),list_bullets:["list_disc","list_circle","list_square"],table_copy_paste:["table_copy","","intable_paste","table_content_paste"],table_row_column:"table_row_clone  insert_row_column insert_row_up insert_row_down insert_column_left insert_column_right  insert_table_top_paragraph insert_table_bottom_paragraph".split(" "),delete_table_and_row_column:["table_delete","delete_row","delete_column"],table_row_column_cell_property:["table_property","cell_property","row_property","column_property"],calculation_formula:["horizontal_sum","vertical_sum","horizontal_avg","vertical_avg"],cell_size:["table_same_width","table_same_height","table_same_widthheight"]},_non_image_item:" design source preview text entity align insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets".split(" "),_disabeld_menu:[],_create:function(e){if(e&&""!=e){var t=DEXTTOP.DEXT5.util._setDEXT5editor(e);t&&(DEXTTOP.G_CURREDITOR=t)}(e=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_iframe"+e))&&e.parentNode.removeChild(e),this._topmenu_id="dext_topmenu_iframe"+DEXTTOP.G_CURREDITOR._config.editor_id,this._topmenu_bg_id="dext_topmenu_background"+DEXTTOP.G_CURREDITOR._config.editor_id,this._topmenu_zIndex=G_MAIN_ZINDEX+2e3,this._topmenu_bg_zIndex=G_MAIN_ZINDEX+1e3;if(e=DEXTTOP.DEXTDOC.getElementById(this._topmenu_id))_topmenu_document=e.contentWindow.document,this._topmenu_iframe=e,this._topmenu_document=_topmenu_document,this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main"),this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");else{try{e=DEXTTOP.DEXTDOC.createElement("<iframe>")}catch(n){e=DEXTTOP.DEXTDOC.createElement("iframe")}DEXTTOP.DEXTDOC.body.appendChild(e),e.id=this._topmenu_id,e.title="DEXT5Editor Topmenu "+DEXTTOP.G_CURREDITOR._config.editor_id,e.style.margin="0px",e.style.padding="0px",e.style.zIndex=this._topmenu_zIndex,e.style.position="absolute",e.scrolling="no",e.style.overflow="auto",e.style.overflowX="hidden",e.style.display="none",e.allowTransparency="true",e.frameBorder="0",t="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",t=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(t)+"}())":"",e.src=t;var t="",t=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,r="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(r="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var i=DEXTTOP.G_CURREDITOR._config.lang;-1<i.indexOf("-")&&(i=i.split("-")[0]),i=""+('<html lang="'+i+'" xml:lang="'+i+'"><head>')+("<title>DEXT5Editor Topmenu "+DEXTTOP.G_CURREDITOR._config.editor_id+"</title>"),isCustomDomain(document)&&(i+='<script>document.domain = "'+document.domain+'";</script></head>'),i+='<link rel="stylesheet" type="text/css" href="'+t+r+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',i+='<link rel="stylesheet" type="text/css" href="'+t+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">',i+='</head><body scroll="no" style="overflow-x:hidden; overflow-y:hidden; margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">',i+='<div onselectstart="return false;" style="width:100%; height:100%" id="topmenu_iframe_bg">',i+='<div class="DEXT_fiVe_ED_popup">',i+='<div class="DEXT_fiVe_EDP">',i+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',i+='<dl id="div_topmenu_main"></dl>',i+="</div>",i+="</div>",i+='<div class="DEXT_fiVe_EDP_s" id="topmenu_sub" style="display:none; position:relative;">',i+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">',i+='<dl id="div_topmenu_sub"></dl>',i+="</div>",i+="</div>",i+="</div>",i+="</div>",i+="</body></html>",_topmenu_document=e.contentWindow.document,_topmenu_document.open("text/html","replace"),_topmenu_document.write(i),_topmenu_document.close(),this._topmenu_iframe=e,this._topmenu_document=_topmenu_document,this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main"),this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");var s=this;e=function(){return function(e){s._topmenu_bg.style.display=""}}(),DEXTTOP.DEXT5.util.addEvent(this._topmenu_main,"mousemove",e),DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"dragover",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1}),DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"drop",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1})}this._topmenu_main.innerHTML="",this._topmenu_sub.innerHTML=""},_setMenu:function(e){var t=[];switch(e){case"m_file":var t="new file_open  template layout  save save_as save_as_image manually_temp_save load_auto_save  print pagebreak".split(" "),n=290;-1<DEXTTOP.G_CURREDITOR.remove_item.indexOf("save_as")&&(n-=30),"0"==DEXTTOP.G_CURREDITOR._config.setAutoSave.useManuallySave&&(t.splice(t.indexOf("manually_temp_save"),1),n-=30),this._height=n+"px",this._width="200px";break;case"m_edit":t="undo redo  copy cut paste  select_all  find replace".split(" "),this._height="230px",this._width="200px";break;case"m_view":t="grid ruler body_fit full_screen  design source preview text".split(" "),DEXTTOP.DEXT5.browser.LocalStorageSupported&&(n=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+DEXTTOP.G_CURREDITOR.ID+"_ruler"),"1"==DEXTTOP.G_CURREDITOR._config.usePersonalSetting&&0==(!n||n&&"1"==n.use)&&(n=t.indexOf("ruler"),-1<n&&t.splice(n,n))),this._height="190px",this._width="200px";break;case"m_insert":t="doc_bg_image image_create entity  insert_file hyperlink_create bookmark  horizontal_line symbol emoticon".split(" "),this._height="250px",this._width="400px";break;case"m_form":t="bold italic underline strike_through superscript subscript  remove_format remove_css  list_number list_bullets  indent outdent  align".split(" "),this._height="420px",this._width="400px";break;case"m_table":t="detail_table_insert table_selection  table_indent table_outdent  merge_cell split_cell  table_tool table_copy_paste table_row_column delete_table_and_row_column table_row_column_cell_property  table_select cell_size align_vertical  calculation_formula".split(" "),this._height="513px",this._width="400px",0>=GetTableSelectionCells().length?(n=getFirstRange().range.startContainer,3==n.nodeType&&(n=n.parentNode),n=GetParentbyTagName(n,"table"),null!=n&&(0>=parseIntOr0(n.style.marginLeft)?0>this._disabeld_menu.indexOf("table_outdent")&&this._disabeld_menu.push("table_outdent"):this._disabeld_menu.splice(this._disabeld_menu.indexOf("table_outdent"),1))):this._disabeld_menu.push("table_outdent");break;case"m_tool":t=["clean_nested_tag","","tool_replace","","setting"],this._height="80px",this._width="200px";break;case"m_help":t=["shortcut","","help","","about"],this._height="80px",this._width="200px";break;default:this._height=this._width="1px"}if("m_file"==e){n=DEXTTOP.G_CURREDITOR._setting.auto_save.toString().split(","),"0"==DEXTTOP.G_CURREDITOR._config.setAutoSave.useManuallySave&&"2"==n[0]||void 0==getAutoSaveHtml_userID(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount)||""==getAutoSaveHtml_userID(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount)?this._disabeld_menu.push("load_auto_save"):-1<this._disabeld_menu.indexOf("load_auto_save")&&(this._disabeld_menu=this._disabeld_menu.slice(this._disabeld_menu.indexOf("load_auto_save"),1));var n=null,r=!1;_iframeWin.getSelection?(n=_iframeWin.getSelection())&&n.rangeCount&&n.getRangeAt&&(n=n.getRangeAt(0)):_iframeDoc.selection&&(n=_iframeDoc.selection.createRange());try{var i=null,i=n?n:getFirstRange().rng;if(i.startContainer!=i.endContainer||i.startOffset!=i.endOffset)r=!0}catch(s){r=!1}r?null!=DEXTTOP.G_SELECTED_ELEMENT&&"img"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()||this._disabeld_menu.push("save_as_image"):this._disabeld_menu.push("save_as_image")}for(var o in G_DEPlugin)G_DEPlugin[o].onShowTopMenu&&(n=G_DEPlugin[o].onShowTopMenu(e,t))&&(t=n);for(e=0;e<t.length;e++)0==e&&(o=this._topmenu_document.createElement("dt"),o.innerHTML="top_main_menu",this._topmenu_main.appendChild(o)),this._addItem(t[e]);this._disableItem(this._disabeld_menu)},_disableItem:function(e){for(var t=0;t<e.length;t++){var n=this._topmenu_document.getElementById("topmenu_"+e[t]);n&&(n.className="item_disabled")}},_addItem:function(e){for(r=0;r<DEXTTOP.G_CURREDITOR.remove_item.length;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==e)return;var t=this._topmenu_document.createElement("dd"),n=this,i=this._getImageIconUrl(e),s=this._getText(e),o=this._item_sub_list[e];if(""==s)t.className="b_border";else{var u=this._topmenu_document.createElement("div"),a=this._topmenu_document.createElement("div"),f=this._topmenu_document.createElement("div"),l=this._topmenu_document.createElement("span");0<i.length&&(l.className=e,u.appendChild(l),0==e.indexOf("p_")&&(l.style.background="url("+i+") transparent no-repeat")),u.className="s_left",a.className="s_right ellipsis";var c=this._topmenu_document.createElement("a");c.href="javascript:void(0);",c.title=s,c.style.textDecoration="none",c.style.color="#545454",c.style.cursor="pointer",c.innerHTML=s,a.appendChild(c),t.appendChild(u),t.appendChild(a);if(o)f.className="arrow",t.appendChild(f),s=function(e){return function(t){if("item_disabled"!=e.className){n._topmenu_sub.innerHTML="";for(var r=0;r<o.length;r++){if(0==r){var i=n._topmenu_document.createElement("dt");i.innerHTML="top_sub_menu",n._topmenu_sub.appendChild(i)}n._addSubItem(o[r])}n._disableItem(n._disabeld_menu),r=getClientRect(e),0==r.top&&(r=getClientRect(e)),n._topmenu_document.getElementById("topmenu_sub").style.display="",n._topmenu_document.getElementById("topmenu_sub").style.top=r.top-0+"px",e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t)}}}(t),i=function(e,t){return function(r){n.setFocusOutline(t,!0),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(r))}}(t,c),u=function(e){return function(t){"on_mouseover"==e.className&&DEXTTOP.DEXT5.util.stopEvent(t)}}(t),DEXTTOP.DEXT5.util.addEvent(t,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(t,"mouseout",i),DEXTTOP.DEXT5.util.addEvent(t,"click",u),s=function(e,t){return function(r){n.setFocusOutline(t);if("item_disabled"!=e.className){n._topmenu_sub.innerHTML="";for(var i=0;i<o.length;i++)n._addSubItem(o[i],t);var i=r.target?r.target:r.srcElement,s=getClientRect(i);0==s.top&&(s=getClientRect(i)),n._topmenu_document.getElementById("topmenu_sub").style.display="",n._topmenu_document.getElementById("topmenu_sub").style.top=s.top-0+"px",e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(r),r=function(e){return function(e){if(39==("which"in e?e.which:e.keyCode)){var t=n._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A").length,r=n._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[0],t=n._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[t-1];r.focus(),setFocusFirstAndLast(_topmenu_document,r,t),DEXTTOP.DEXT5.util.stopEvent(e)}}}(t),DEXTTOP.DEXT5.util.addEvent(t,"keyup",r)}}}(t,c),DEXTTOP.DEXT5.util.addEvent(c,"focus",s),DEXTTOP.DEXT5.util.addEvent(c,"blur",i);else{var s=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(c,"focus",h),DEXTTOP.DEXT5.util.removeEvent(c,"blur",p),n._topmenu_document.getElementById("topmenu_sub").style.display="none","item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(t),i=function(e,t){return function(n){DEXTTOP.DEXT5.util.addEvent(t,"focus",h),DEXTTOP.DEXT5.util.addEvent(t,"blur",p),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(n))}}(t,c),h=function(e,t){return function(r){n.setFocusOutline(t),n._topmenu_document.getElementById("topmenu_sub").style.display="none","item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(r))}}(t,c),p=function(e,t){return function(r){n.setFocusOutline(t,!0),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(r))}}(t,c),n=this,u=function(t){return function(r){"on_mouseover"==t.className&&(_dext_editor._dextCommands(_dext_editor.ID,e,n),n.hide_focus(_dext_editor.ID),DEXTTOP.DEXT5.util.stopEvent(r))}}(t);DEXTTOP.DEXT5.util.addEvent(t,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(t,"mouseout",i),DEXTTOP.DEXT5.util.addEvent(t,"click",u),DEXTTOP.DEXT5.util.addEvent(c,"focus",h),DEXTTOP.DEXT5.util.addEvent(c,"blur",p)}}0<e.length&&(t.id="topmenu_"+e),t.unselectable="on",this._topmenu_main.appendChild(t)},_addSubItem:function(e,t){for(r=0;r<DEXTTOP.G_CURREDITOR.remove_item.length;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==e)return;var n=this._topmenu_document.createElement("dd"),i=this,s=this._getImageIconUrl(e),o=this._getText(e);if(""==o)n.className="b_border";else{var u=this._topmenu_document.createElement("div"),a=this._topmenu_document.createElement("div"),f=this._topmenu_document.createElement("span"),l=this._topmenu_document.createElement("a");l.href="javascript:void(0);",l.title=o,l.style.textDecoration="none",l.style.color="#545454",l.style.cursor="pointer",0<s.length&&(f.className=e,u.appendChild(f),0==e.indexOf("p_")&&(f.style.background="url("+s+") transparent no-repeat")),u.className="s_left",a.className="s_right ellipsis",l.innerHTML=o,a.appendChild(l),n.appendChild(u),n.appendChild(a);var s=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(l,"focus",c),DEXTTOP.DEXT5.util.removeEvent(l,"blur",h),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(t))}}(n),o=function(e){return function(t){DEXTTOP.DEXT5.util.removeEvent(l,"focus",c),DEXTTOP.DEXT5.util.removeEvent(l,"blur",h),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(n),c=function(e,t){return function(n){i.setFocusOutline(t),"item_disabled"!=e.className&&(e.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(n))}}(n,l),h=function(e){return function(t){i.setFocusOutline(l,!0),"on_mouseover"==e.className&&(e.className="",DEXTTOP.DEXT5.util.stopEvent(t))}}(n),i=this,u=function(t){return function(n){"on_mouseover"==t.className&&(_dext_editor._dextCommands(_dext_editor.ID,e),i.hide_focus())}}(n);DEXTTOP.DEXT5.util.addEvent(n,"mouseover",s),DEXTTOP.DEXT5.util.addEvent(n,"mouseout",o),DEXTTOP.DEXT5.util.addEvent(n,"click",u),DEXTTOP.DEXT5.util.addEvent(l,"focus",c),DEXTTOP.DEXT5.util.addEvent(l,"blur",h),s=function(e){return function(e){37==("which"in e?e.which:e.keyCode)&&(t.focus(),DEXTTOP.DEXT5.util.stopEvent(e))}}(l),DEXTTOP.DEXT5.util.addEvent(l,"keyup",s),0<e.length&&(n.id="topmenu_"+e),n.unselectable="on",this._topmenu_sub.appendChild(n)}this._topmenu_sub.appendChild(n)},_getImageIconUrl:function(e){var t="";if(0==e.indexOf("p_")){var t=e.split("_"),n=t[1],r="icon";2<t.length&&(r=t[2]),t=DEXTTOP.G_CURREDITOR._config.webPath.plugin+n+"/images/"+r+".png"}else t=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+e+".gif";for(n=0;n<this._non_image_item.length;n++)if(e==this._non_image_item[n]){t="";break}return t},_getText:function(e){var t="";return""!=e&&(0==e.indexOf("p_")?(t=e.split("_")[1],t=dext5_lang.plugins[t].topmenu[e]):t=dext5_lang.topmenu[e]),t},show:function(e,t,n,r){null==this._topmenu_iframe&&this._create(),this._topmenu_main.innerHTML="",this._topmenu_sub.innerHTML="",this._setMenu(n),this._topmenu_iframe.style.width=this._width,this._topmenu_iframe.style.height=this._height,e=e?e:window.event,Math.round(e.clientX),Math.round(e.clientY),n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=getClientRect(_iframeWin.parent.frameElement),getClientRect(_iframeWin.frameElement);var i=getClientRect(e.target?e.target:e.srcElement);this._topmenu_iframe.style.left=i.left+n[0]+r.left+"px",this._topmenu_iframe.style.top=i.top+n[1]+r.top+19+"px",this._makeBackground(t),this._topmenu_iframe.style.display="";var s=this._topmenu_iframe.contentWindow;n=getIframeDocument(this._topmenu_iframe),0==DEXTTOP.DEXT5.browser.ie&&s.focus(),n.body.focus();try{n.getElementsByTagName("A")[0].focus()}catch(o){}n.onkeyup=function(e){var t=0;e=e||s.event,t="which"in e?e.which:e.keyCode,27==t&&(hideTopMenu(),setTimeout(function(){setFocusToBody()},1))},setFocusFirstAndLast(n,n.getElementsByTagName("A")[0]);try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(t,e.target,"topmenu"):DEXTTOP.dext_editor_afterpopupshow_event(t,e.target,"topmenu")}catch(u){}},hide:function(e){_dext_editor._top_menu_click_flag=!1,_dext_editor._top_menu_click_id="";var t=_dext_editor._config.topMenuItem.length;if(e&&0<t)for(var n=0;n<t;n++){var r=_dext_editor._config.topMenuItem[n],r=DEXTTOP.DEXT5.util.trim(r).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+e+r).childNodes[0].className=""}this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none"),this._topmenu_iframe&&(this._topmenu_iframe.style.display="none"),this._topmenu_bg&&(this._topmenu_bg.style.display="none")},hide_focus:function(e){if(0!=_dext_editor._top_menu_click_flag){_dext_editor._top_menu_click_flag=!1,_dext_editor._top_menu_click_id="";var t=_dext_editor._config.topMenuItem.length;if(e&&0<t)for(var n=0;n<t;n++){var r=_dext_editor._config.topMenuItem[n],r=DEXTTOP.DEXT5.util.trim(r).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+e+r).childNodes[0].className=""}this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none"),this._topmenu_iframe&&(this._topmenu_iframe.style.display="none"),this._topmenu_bg&&(this._topmenu_bg.style.display="none"),_dext_editor.isCloseTopMenu=!0,dialogCancel()}},_makeBackground:function(e){var t=this;if(this._topmenu_bg=DEXTTOP.DEXTDOC.getElementById(t._topmenu_bg_id))DEXTTOP.DEXTDOC.body.removeChild(this._topmenu_bg),this._topmenu_bg=null;if(!this._topmenu_bg){this._topmenu_bg=DEXTTOP.DEXTDOC.createElement("div"),this._topmenu_bg.style.display="none",this._topmenu_bg.id=this._topmenu_bg_id,this._topmenu_bg.style.overflow="visible",this._topmenu_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+this._topmenu_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>';var n="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;this._topmenu_bg.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)-10+"px",this._topmenu_bg.firstChild.style.height=n-10+"px",DEXTTOP.DEXTDOC.body.appendChild(this._topmenu_bg),n=function(){return function(n){t.hide_focus(e)}}(),DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"click",n),DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"contextmenu",n),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",DEXTTOP.G_CURREDITOR.topmenu_bg_resize),DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"click",n),DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"contextmenu",n),this._topmenu_bg.style.display="none",DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"mousemove",function(n){var r=_dext_editor._config.topMenuItem.length;if(0<r)for(var i=0;i<r;i++){var s=_dext_editor._config.topMenuItem[i],s=DEXTTOP.DEXT5.util.trim(s).toLowerCase(),s=_iframeWin.parent.document.getElementById("ue_"+e+s).getBoundingClientRect(),o=getClientRect(_iframeWin.parent.frameElement);point_in_rectagnle(n.clientX,n.clientY,o.left+s.left,o.top+s.top,o.left+s.right,o.top+s.bottom)&&(t._topmenu_bg.style.display="none")}})}},setFocusOutline:function(e,t){var n="border";0==DEXTTOP.DEXT5.browser.ie&&(n="outline"),e.style[n]=t?"":"1px dotted #B5B7BB"}},ImageHTML=function(e,t){this.htmlSource=e,this.range=t},UndoManager=function(){this.arrImageHTML=[],this.limitCount=50,this.currentImage=null,this.index=-1,this.canRedo=this.canUndo=!1,this.charCount=0,this.isInsertData=!1,this.tempRange=this.tempEContainer=this.tempSContainer=null};UndoManager.prototype={reset:function(){this.arrImageHTML=[],this.limitCount=50,this.currentImage=null,this.index=-1,this.canRedo=this.canUndo=!1,this.charCount=0,1==_iframeDoc.body.contentEditable&&DEXTTOP.G_CURREDITOR._iconEnable(""),DEXTTOP.G_CURREDITOR.isInitKeydownForSetApi=!0,this.isInsertData=!1,this.tempRange=this.tempEContainerText=this.tempSContainerText=null},putUndo:function(e){try{if(1!=DEXTTOP.G_CURREDITOR.disableUndoRedo){var t=null,n=null,r=null,i=null,s=null,o={},u=DEXTTOP.G_CURREDITOR._config.undoMode;if("2"==u)if(e&&0==DEXTTOP.G_CURREDITOR._config.initFocus){var a=getMyFirstOrLastChildElementNode(DEXTTOP.G_CURREDITOR._BODY),s=_iframeDoc.createElement("dextmark");s.id="_dext_caret",a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s)}else t=getFirstRange().range,n=getFirstRange().sel,r=t.cloneRange(),s=_iframeDoc.createElement("dextmark"),s.id="_dext_caret",t.collapse(!1),t.insertNode(s);else(t=getFirstRange().range)&&t.startContainer&&(i=getMyElementNode(t.startContainer)),i&&(o.id=i.id,o.undoId="_dext",i.id=o.id+o.undoId);var f=_iframeDoc.body.innerHTML,f=dummyTagClassClear(f);if("2"==u)s.parentNode.removeChild(s),n&&(t=!1,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&"0"!=DEXTTOP.G_CURREDITOR._config.autoUrlDetect&&(t=!0),t&&_iframeDoc.execCommand("AutoUrlDetect",!1,!1),DEXTTOP.DEXT5.browser.ie&&(n.removeAllRanges(),n.addRange(r)),t&&_iframeDoc.execCommand("AutoUrlDetect",!0,!0));else if(i)if(""==o.id)try{i.removeAttribute("id")}catch(l){}else i.id=o.id;var c="BackCompat"==_iframeDoc.compatMode;DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&11>DEXTTOP.DEXT5.browser.ieVersion&&1!=c&&(f=DEXTTOP.DEXT5.util.nbspRemove(f)),f=ReplaceAll(f,unescape("%uFEFF"),""),f=ReplaceAll(f,unescape("%u200B"),"");if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion||c)try{var h=f.match(RegExp("<td *([^>?+])*>","gi"));if(h){for(var p=h.length,n=0;n<p;n++){var d=h[n],v=/cellOrgBgColor=>/.exec(d);if(null!=v)var m=v[0].replace(RegExp("cellOrgBgColor=>","g"),">"),d=d.replace(v,m),f=f.replace(h[n],d)}for(n=0;n<p;n++)if(d=h[n],v=/cellOrgBgColor= /.exec(d))m=v[0].replace(RegExp("cellOrgBgColor= ","g"),""),d=d.replace(v,m),f=f.replace(h[n],d)}}catch(g){}if(!this.currentImage||this.currentImage.htmlSource.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")!=f.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")){"2"==u&&(this.isInsertData=!1,this.tempRange=this.tempEContainerText=this.tempSContainerText=null);var y=new ImageHTML(f,o);if("2"==u)for(var b=this.arrImageHTML.length-1;b>=this.index+1;b--)this.arrImageHTML.pop();else for(b=this.index+1;b<this.arrImageHTML.length;b++)this.arrImageHTML.pop();this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift(),this.index=this.arrImageHTML.push(y)-1,this.currentImage=y,this.canUndo=0<this.arrImageHTML.length?!0:!1,this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);if("2"==u){if(this.charCount=99,e&&(this.canUndo=!1),1<this.arrImageHTML.length){e="";try{var w=GetTableSelectionCells();0<w.length&&(e=1==w.length?"selectedSingleCell":"selectedMultiCell")}catch(E){}try{var S=DEXTTOP.G_CURREDITOR.dext_dragresize;S&&S.G_dextResizeDiv&&S.G_dextResize_elem&&(e="IMG"==S.G_dextResize_elem.tagName?"focusImage":"dextResize")}catch(x){}""!=e&&DEXTTOP.G_CURREDITOR._iconEnable(e)}}else this.charCount=0}}}catch(T){}},execUndo:function(){try{if(!DEXTTOP.G_CURREDITOR.disableUndoRedo)if(G_LAST_CMD="undo",0==this.canUndo)DEXTTOP.G_CURREDITOR._iconEnable("");else{var e=DEXTTOP.G_CURREDITOR._config.undoMode;"2"==e&&1==this.isInsertData&&this.putUndo(),--this.index;if(-1==this.index){if("2"!=e){this.canRedo=this.canUndo=!1,DEXTTOP.G_CURREDITOR._iconEnable("");return}1==this.arrImageHTML.length&&(this.index=0)}var t=this.arrImageHTML[this.index].htmlSource;if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion){for(var n="span strong em strike sup sub b i".split(" "),r=n.length,i=0;i<r;i++)var s="(<p[^>]*><"+n[i]+"[^>]*>)(?:\\s|  | |)(</"+n[i]+"></p>)",o=new RegExp(s,"gim"),t=t.replace(o,"$1"+unescape("%u200B")+"</"+n[i]+"></p>");s="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>",o=new RegExp(s,"gim"),t=t.replace(o,"$1</span>")}n="",n=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF"),o=RegExp("<a ([^>]+)></a>","gi"),t=t.replace(o,"<a $1>"+n+"</a>");if(!this.currentImage||this.currentImage.htmlSource.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")!=t.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")){_iframeDoc.body.innerHTML=t;var u=this.arrImageHTML[this.index].range,a=u.id+u.undoId,t=null;if("2"==DEXTTOP.G_CURREDITOR._config.undoMode){if(t=_iframeDoc.getElementById("_dext_caret")){var f=getFirstRange().range,l=getFirstRange().sel;f.setStartAfter(t),f.setEndAfter(t),DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!0),l.removeAllRanges(),l.addRange(f),DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!1),t.parentNode.removeChild(t),DEXTTOP.G_CURREDITOR._LastRange=f}}else if(t=_iframeDoc.getElementById(a)){t.id==u.undoId?removeAttribute(t,"id"):t.id=u.id;var c=getFirstRange();try{(t.nodeType=t.lastChild&&t.lastChild.tagName&&"br"==t.lastChild.tagName.toLowerCase())?doSetCaretPosition(t,0):(rangy.getSelection(_iframeWin).removeAllRanges(),c.range.selectNodeContents(t),c.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(c.range)),setMenuIconRealable(t)}catch(h){try{var p=_iframeDoc.body.childNodes,d=p.length;0<d&&(doSetCaretPosition(p[d-1],0),setMenuIconRealable(p[d-1]))}catch(v){}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,u),this.canRedo=!0,0==this.index&&(this.canUndo=!1),this.charCount="2"==e?99:0,DEXTTOP.G_CURREDITOR._iconEnableForTextInRange(),ClearDraggingTableAllTable();try{contentChangeEventWrapper()}catch(m){}}}}catch(g){}},execRedo:function(){try{if(!DEXTTOP.G_CURREDITOR.disableUndoRedo)if(G_LAST_CMD="redo",0==this.canRedo)DEXTTOP.G_CURREDITOR._iconEnable("");else{this.index+=1;var e=DEXTTOP.G_CURREDITOR._config.undoMode,t=null;"2"==e&&1==this.arrImageHTML.length&&(this.index=0),t=this.arrImageHTML[this.index].htmlSource;if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion){for(var n="span strong em strike sup sub b i".split(" "),r=n.length,i=0;i<r;i++)var s="(<p[^>]*><"+n[i]+"[^>]*>)(?:\\s|  | |)(</"+n[i]+"></p>)",o=new RegExp(s,"gim"),t=t.replace(o,"$1"+unescape("%u200B")+"</"+n[i]+"></p>");s="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>",o=new RegExp(s,"gim"),t=t.replace(o,"$1</span>")}n="",n=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF"),o=RegExp("<a ([^>]+)></a>","gi"),t=t.replace(o,"<a $1>"+n+"</a>");if(!this.currentImage||this.currentImage.htmlSource.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")!=t.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")){_iframeDoc.body.innerHTML=t;var u=this.arrImageHTML[this.index].range,a=u.id+u.undoId,t=null;if("2"==e){if(t=_iframeDoc.getElementById("_dext_caret")){var f=getFirstRange().range,l=getFirstRange().sel;f.setStartAfter(t),f.setEndAfter(t),DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!0),l.removeAllRanges(),l.addRange(f),DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!1),t.parentNode.removeChild(t),DEXTTOP.G_CURREDITOR._LastRange=f}}else if(t=_iframeDoc.getElementById(a)){t.id==u.undoId?removeAttribute(t,"id"):t.id=u.id;var c=getFirstRange();try{rangy.getSelection(_iframeWin).removeAllRanges(),c.range.selectNodeContents(t),c.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(c.range),setMenuIconRealable(t)}catch(h){try{var p=_iframeDoc.body.childNodes,d=p.length;0<d&&(doSetCaretPosition(p[d-1],1),setMenuIconRealable(p[d-1]))}catch(v){}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,u),this.canUndo=!0,this.index==this.arrImageHTML.length-1&&(this.canRedo=!1),this.charCount="2"==e?99:0,DEXTTOP.G_CURREDITOR._iconEnableForTextInRange(),ClearDraggingTableAllTable();try{contentChangeEventWrapper()}catch(m){}}}}catch(g){}},clearNextImgData:function(){for(var e=this.arrImageHTML.length-1;e>=this.index+1;e--)this.arrImageHTML.pop();this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift(),this.canUndo=0<this.arrImageHTML.length?!0:!1,this.index==this.arrImageHTML.length-1&&(this.canRedo=!1),this.charCount=99}},resizebar_props={editor:null,editorMinTop:0,editorHegiht:0,mouseTop:0,editorMinFlag:!1,mouseClickFlag:!1,mouseClickObj:null,mouseLeftBtnFlag:!1},DextResize.prototype.createStatusResizeBar=function(){if(resizebar_props){if(0==checkIfIncluded("editor_resize_bar.css",DEXTTOP.DEXTDOC)){var e=DEXTTOP.DEXTDOC.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=DEXTTOP.DEXT5.isRelease?resizebar_props.editor._config.webPath.css+"editor_resize_bar.css?ver="+DEXTTOP.DEXT5.ReleaseVer:resizebar_props.editor._config.webPath.css_dev+"editor_resize_bar.css?ver="+DEXTTOP.DEXT5.ReleaseVer,DEXTTOP.DEXTDOC.getElementsByTagName("head")[0].appendChild(e)}e=DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID),e.className="DEXT_frame_resizebar";var t=DEXTTOP.DEXTDOC.createElement("div");t.setAttribute("id","dext_resizebar_"+resizebar_props.editor.ID),t.className="DEXT_resizebar DEXT_resizebar_"+resizebar_props.editor._config.style.skinName,t.innerHTML='<div class="DEXT_resizebar_btn" id="dext_resizebar_btn_'+resizebar_props.editor.ID+'"><div class="DEXT_resizebar_horizon_line" id="DEXT_resizebar_horizon_line_'+resizebar_props.editor.ID+'"></div><button type="button" id="DEXT_resizebar_button_'+resizebar_props.editor.ID+'" title="'+dext5_lang.resizebar_button.title+'"></button></div>',e.appendChild(t)}},DextResize.prototype.mouseDown=function(e){try{if(resizebar_props)if(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID)){e=e?e:event;var t=e.target?e.target:e.srcElement,n=this.isLeftClick(e);resizebar_props.mouseLeftBtnFlag=n,resizebar_props.mouseLeftBtnFlag&&(t&&t.id&&t.id=="dext_resizebar_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=t:t&&t.id&&t.id=="dext_resizebar_btn_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=t.parentNode:t&&t.id&&(t.id=="DEXT_resizebar_horizon_line_"+resizebar_props.editor.ID||t.id=="DEXT_resizebar_button_"+resizebar_props.editor.ID)&&(resizebar_props.mouseClickObj=t.parentNode.parentNode)),resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&(resizebar_props.editorHegiht=parseInt(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID).style.height.replace("px","")),resizebar_props.mouseTop=e.clientY,resizebar_props.mouseClickFlag=!0)}else resizebar_props=null}catch(r){}},DextResize.prototype.mouseMove=function(e){try{if(resizebar_props&&(e=e?e:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&resizebar_props.mouseClickFlag)){DEXTTOP.DEXTDOC.body.style.cursor="row-resize";if(!DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var t=DEXTTOP.DEXTDOC.createElement("div");t.setAttribute("id","dext_disabled"),t.style.overflow="visible",t.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1e3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var n="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;t.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)+"px",t.firstChild.style.height=n+"px",DEXTTOP.DEXTDOC.body.appendChild(t)}var t=0,r=e.clientY,t=resizebar_props.editorHegiht+(r-resizebar_props.mouseTop),t=Math.max(resizebar_props.editorMinTop,t);resizebar_props.editorMinFlag=t==resizebar_props.editorMinTop?!0:!1,resizebar_props.editorMinFlag||(this.setHeight(t),resizebar_props.editorHegiht=t,resizebar_props.mouseTop=r)}}catch(i){}},DextResize.prototype.mouseUp=function(e){try{if(resizebar_props)if(e=e?e:event,DEXTTOP.DEXTDOC.body.style.cursor="",resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)){var t=0,t=resizebar_props.editorHegiht+(e.clientY-resizebar_props.mouseTop),t=Math.max(resizebar_props.editorMinTop,t);resizebar_props.editorMinFlag=t==resizebar_props.editorMinTop?!0:!1,resizebar_props.editorMinFlag||this.setHeight(t),resizebar_props.editorHegiht=0,resizebar_props.mouseTop=0,resizebar_props.editorMinFlag=!1,resizebar_props.mouseClickFlag=!1,resizebar_props.mouseClickObj=null,resizebar_props.mouseLeftBtnFlag=!1;if(DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var n=DEXTTOP.DEXTDOC.getElementById("dext_disabled");n.parentNode.removeChild(n)}try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.resized?DEXTTOP.G_CURREDITOR._config.event.resized(DEXTTOP.G_CURREDITOR.Frame):DEXTTOP.DEXTWIN.dext_editor_resized_event(DEXTTOP.G_CURREDITOR.Frame)}catch(r){}}else resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&(resizebar_props.editorHegiht=0,resizebar_props.mouseTop=0,resizebar_props.editorMinFlag=!1,resizebar_props.mouseClickFlag=!1,resizebar_props.mouseClickObj=null,resizebar_props.mouseLeftBtnFlag=!1,DEXTTOP.DEXTDOC.getElementById("dext_disabled")&&(n=DEXTTOP.DEXTDOC.getElementById("dext_disabled"),n.parentNode.removeChild(n)))}catch(i){}},DextResize.prototype.wheel=function(e){try{if(resizebar_props&&(e=e?e:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)))return e.returnValue=!1,e.preventDefault&&e.preventDefault(),!1}catch(t){}},DextResize.prototype.blur=function(e){try{if(resizebar_props&&resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var t=DEXTTOP.DEXTDOC.getElementById("dext_disabled");t.parentNode.removeChild(t)}}catch(n){}},DextResize.prototype.setHeight=function(e){var t=resizebar_props.editor.ID,n=DEXTTOP.DEXT5.util._setDEXT5editor(t);if(void 0==t||""==t)t=n.ID;var r=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+t),t=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+t).contentWindow.document.getElementById("ue_editor_holder_"+t),i=0,i=n.baseMenuToolbarHeight;isViewMode(n)?n._defaultHeight=parseInt(e,10)-4:n._defaultHeight=parseInt(e,10)-i,-1<e.toString().indexOf("%")||-1<e.toString().indexOf("px")?r.style.height=e:r.style.height=e+"px",t.style.height=n._defaultHeight+"px",n._config.style.height=e+"px","1"==resizebar_props.editor._config.ruler.view&&"design"==resizebar_props.editor._currentMode&&n._FRAMEWIN.showRuler(resizebar_props.editor),"1"==resizebar_props.editor._config.autoBodyFit&&(n._BODY.style.minHeight=(n._defaultHeight-parseIntOr0(resizebar_props.editor._config.defaultBodySpace.configValue.top))/n._defaultHeight*100+"%")},DextResize.prototype.isLeftClick=function(e){var t=!1;e=e||window.event,e.which||void 0===e.button||(e.which=e.button&1?1:e.button&2?3:e.button&4?2:0);switch(e.which){case 1:t=!0;break;case 2:t=!1;break;case 3:t=!1;break;case 0:0==e.button&&(t=!1)}return t},DextResize.prototype.apply=function(e){try{resizebar_props&&(DextResizeObj=this,DEXTTOP.DEXT5.util.addEvent(e,"mousedown",dextResizeMouseDownEvt,!0),DEXTTOP.DEXT5.util.addEvent(e,"mousemove",dextResizeMouseMoveEvt,!0),DEXTTOP.DEXT5.util.addEvent(e,"mouseup",dextResizeMouseUpEvt,!0),e.addEventListener&&(domMouseScrollEvent=function(e){DextResizeObj.wheel(e)},e.addEventListener("DOMMouseScroll",domMouseScrollEvent,!1),DEXTTOP.DEXT5.DEXTMULTIPLEEVENT[DEXTTOP.G_CURREDITOR.ID].push({element:e,event:"DOMMouseScroll",func:domMouseScrollEvent})),DEXTTOP.DEXT5.util.addEvent(e,"blur",dextResizeBlurEvt,!0))}catch(t){}},DextResize.prototype.remove=function(e){try{DEXTTOP.DEXT5.util.removeEvent(e,"mousedown",dextResizeMouseDownEvt,!0),DEXTTOP.DEXT5.util.removeEvent(e,"mousemove",dextResizeMouseMoveEvt,!0),DEXTTOP.DEXT5.util.removeEvent(e,"mouseup",dextResizeMouseUpEvt,!0),DEXTTOP.DEXT5.util.removeEvent(e,"blur",dextResizeBlurEvt,!0)}catch(t){}},function(){function e(e){var t={};e=e.split(",");for(var n=0;n<e.length;n++)t[e[n]]=!0;return t}var t=e("p,ul,ol,li,a,img,i,b,u,sup,sub,table,caption,col,colgroup,thead,tbody,tfoot,tr,td,th"),n=e("col");DEXT5_EDITOR.HWPFilter=function(t,n){function r(e,t,o,a){t=t.toLowerCase();if(h[t]){for("table"!=b.last()&&"tbody"!=b.last()||"td"!=t||r("","tr","","");b.last()&&p[b.last()];)i("",b.last());"p"!=b.last()||"table"!=t&&"hr"!=t&&"center"!=t||i("","p")}d[t]&&b.last()==t&&i("",t),(a=c[t]||!!a)||b.push(t);if(n.start){var f=[];e=s.test(e)?u:l,o.replace(e,function(e,t,n,r,i){n=n?n:r?r:i?i:v[t]?t:"",r="",""!=e&&(e=e.substring(e.indexOf(t)+t.length),e=e.substring(e.indexOf("=")+1),e=e.replace(/^\s+/,""),r=e.substring(0,1),"'"!=r&&'"'!=r&&(r="")),f.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"'),quotationmark:r})}),n.start&&n.start(t,f,a)}}function i(e,t){if(t)for(t=t.toLowerCase(),r=b.length-1;0<=r&&b[r]!=t;r--);else var r=0;if(0<=r){for(var i=b.length-1;i>=r;i--)n.end&&n.end(b[i]);b.length=r}}var s=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,o=/^<\/([-A-Za-z0-9_:]+)[^>]*>/,u=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,f=/^<([-A-Za-z0-9_:-]+)((?:\s+[a-zA-Z_0-9:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,l=/([-A-Za-z0-9_:-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,c=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");e("area,base,basefont,br,col,frame,img,input,isindex,link,meta,param,embed");var h=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul,h1,h2,h3,h4,h5,h6"),p=e("colgroup,a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),d=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),v=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),m=e(""),g,y,b=[],w=t;b.last=function(){return this[this.length-1]};for(t=t.replace(RegExp("<div( ?([^>?+])*>(\\s+)?(&nbsp;)+(\\s+)?)</ ?div>","gi"),"<p$1</p>");t;){y=!0;if(b.last()&&m[b.last()])t=t.replace(new RegExp("(.*)</"+b.last()+"[^>]*>"),function(e,t){return t=t.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1"),n.chars&&n.chars(t),""}),i("",b.last());else{var E=t.indexOf("<");g=t.indexOf(">")+1;var S=t.substring(E,g);if(0==t.indexOf("<!--"))g=t.indexOf("-->"),0<=g&&(n.comment&&n.comment(t.substring(4,g)),t=t.substring(g+3),y=!1);else if(0==t.indexOf("<?xml"))g=t.indexOf("/>"),0<=g&&(t=t.substring(g+2),y=!1);else if(0!=t.indexOf("<")&&"</"+b.last()+">"==S.replace(/ /ig,""))y=t.substring(0,E),g=t.substring(g),t=y+"</"+b.last()+">"+g,y=!0;else if(0==t.indexOf("</")){if(g=t.match(o))t=t.substring(g[0].length),g[0].replace(o,i),y=!1}else if(0==t.indexOf("<"))if(g=t.match(s))t=t.substring(g[0].length),g[0].replace(s,r),y=!1;else if(g=t.match(f))t=t.substring(g[0].length),g[0].replace(f,r),y=!1;else if("1"==DEXTTOP.G_CURREDITOR._config.removeIncorrectAttribute&&(g=t.indexOf("<"),S=t.indexOf(">"),0==g&&0<S)){var x=t.substring(0,S+1),T=E=g=0;0<x.indexOf('\ub9d1\uc740=""')?(g=x.indexOf('\ub9d1\uc740=""'),E=5,T=x.split('\ub9d1\uc740=""').length):0<x.indexOf("\ub9d1\uc740=''")&&(g=x.indexOf("\ub9d1\uc740=''"),E=5,T=x.split("\ub9d1\uc740=''").length);if(2==T&&0<g&&(S=t.substring(S+1),T=x.substring(0,g).lastIndexOf(" "),T<g+E))if(g=x.substring(T,g+E),x=x.replace(g,""),t=x+S,g=t.match(s))t=t.substring(g[0].length),g[0].replace(s,r),y=!1;else if(g=t.match(f))t=t.substring(g[0].length),g[0].replace(f,r),y=!1}y&&(g=t.indexOf("<"),y=0>g?t:t.substring(0,g),t=0>g?"":t.substring(g),n.chars&&(b.last()&&p[b.last()]&&"textarea"!=b.last()&&"script"!=b.last()&&(g=!1,E=RegExp("\\S\\n","g"),E.test(y)&&(g=!0),E=RegExp("\\n\\S","g"),E.test(y)&&(g=!0),E=RegExp("\\S\\n\\S","g"),E.test(y)&&(g=!0),g?y=y.replace(/\n/g," "):(E=RegExp("\\n\\n","g"),E.test(y)&&""==y.trim()?y=y.replace(/\n\n/g,""):y==unescape("%20%20")&&(g=new RegExp(unescape("%20"),"g"),y=y.replace(g,"&nbsp;")))),n.chars(y)))}if(t==w)throw"Parse Error: "+t;w=t}i()},DEXT5_EDITOR.HWPFilter.DOMProcess=function(t,n,r){n=t;try{var i=function(e,t){try{var n=DEXTTOP.DEXT5.util.getStyle(e,t);if(n&&""!=n){var r="",i=!1,s=parseFloat(n)+"";n==s&&(i=!0);if(-1<n.indexOf("px"))r=o(n);else if(-1<n.indexOf("pt"))var u=parseFloat(n),r=o(4*u/3);else if(-1<n.indexOf("em")||-1<n.indexOf("%")||i){var u=parseFloat(n),a=DEXTTOP.DEXT5.util.getStyle(e,"fontSize");a&&""!=a&&(-1<a.indexOf("px")?(u*=parseFloat(a),r=o(u)):-1<a.indexOf("pt")&&(u*=4*parseFloat(a)/3,r=o(u)))}""!=r&&(e.style[t]=r)}}catch(f){}},s=function(e,t){var n=DEXTTOP.DEXT5.util.getStyle(e,t);""==n&&(n=e.style[t]),""!=n&&(n=DEXTTOP.DEXT5.util.parseIntOr0(n),0<n&&e.setAttribute(t,n))},o=function(e){var t=!1,n;return n=e+"",n=n.replace(/^\s*|\s*$/g,""),n=""==n||isNaN(n)?!1:!0,n?t=!0:-1<e.indexOf("px")&&(e=parseInt(e),t=!0),t&&(e=.264583*e+"mm"),e},u=function(e){""!=e.align&&-1==",left,center,right,justify,char,".indexOf(","+e.align.toLowerCase()+",")&&(e.align=""),""!=e.vAlign&&-1==",top,middle,bottom,baseline,".indexOf(","+e.vAlign.toLowerCase()+",")&&(e.vAlign="")},f=function(e){for(var t=[],n=e.length>>>0;n--;)t[n]=e[n];return t},l=function(e){var t=[],n=0;e=e.attributes;for(var r=e.length;n<r;n++)t.push(e[n].nodeName);return t},c=document.createElement("div");try{c.style.visibility=!1}catch(h){}c.style.position="absolute",c.style.top="0px",c.style.left="-2000px",c.innerHTML=n,document.body.appendChild(c);for(var p="p ul ol li table caption col colgroup thead tfoot tbody tr th td a img i b u sub sup ".split(" "),d=j=k=0,v=p.length,m,g,y,b,w,E,S,x;d<v;d++)for(m=c.getElementsByTagName(p[d]),j=0,b=m.length;j<b;j++){g=m[j],y=l(g);switch(p[d]){case"p":""!=g.style.textAlign&&(S=",left,center,right,",x=-1==S.indexOf(","+g.style.textAlign.toLowerCase()+",")?"":g.style.textAlign,g.style.textAlign="",g.align=x),""==g.align&&removeAttribute(g,"align"),removeAttribute(g,"id"),E=e("id,style,align"),i(g,"lineHeight"),i(g,"marginLeft");break;case"ul":case"ol":if(0==g.getElementsByTagName("li").length){var T=f(g.childNodes),N=document.createElement("li");g.appendChild(N);for(var C=0,L=T.length;C<L;C++)N.appendChild(T[C])}E=e("id");break;case"a":E=e("id,name,href,rel,rev");break;case"img":""!=g.align&&(S=",top,middle,bottom,left,right,",-1==S.indexOf(","+g.align.toLowerCase()+",")&&(g.align="")),s(g,"width"),s(g,"height"),""==g.src?g.src="noImage":0==!!r.keepImgUrl&&(g.src.indexOf("/")?g.src=g.src.substring(g.src.lastIndexOf("/")+1):g.src.indexOf("\\")&&(g.src=g.src.substring(g.src.lastIndexOf("\\")+1))),""==g.alt&&(g.alt=""!=g.title?g.title:"untitled"),E=e("id,src,alt,name,longdesc,height,width,align,border,hspace,vspace");break;case"table":""!=g.align&&(S=",left,center,right,adjust,",-1==S.indexOf(","+g.align.toLowerCase()+",")&&(g.align="")),""==g.border&&g.setAttribute("border",g.style.borderWidth.replace("px","")),s(g,"width"),s(g,"height"),E=e("id,summary,width,height,border,cellspacing,cellpadding,align");break;case"caption":""!=g.align&&(S=",top,bottom,left,right,",-1==S.indexOf(","+g.align.toLowerCase()+",")&&(g.align="")),E=e("id,align");break;case"colgroup":case"col":u(g),E=e("id,span,width,align,char,charoff,valign");break;case"thead":case"tfoot":case"tbody":case"tr":u(g),E=e("id,align,char,charoff,valign");break;case"th":case"td":u(g),s(g,"width"),s(g,"height"),E=e("id,abbr,axis,headers,rowspan,colspan,align,char,charoff,nowrap,width,height");break;case"i":case"b":case"u":case"sub":case"sup":case"li":E=e("id");break;default:E=e("id")}k=0;for(w=y.length;k<w;k++)E[y[k].toLowerCase()]||removeAttribute(g,y[k])}c.parentNode.removeChild(c),n=DEXTTOP.DEXT5.util.html2xhtml(c.innerHTML);try{var A=!1,O=!1;n=n.replace(/ width=['\"](\d+)['\"]/ig,function(e,t){return A=!0,' width="'+o(t)+'"'}),n=n.replace(/ height=['\"](\d+)['\"]/ig,function(e,t){return O=!0,' height="'+o(t)+'"'}),0==A&&(n=n.replace(/ width=(\d+)/ig,function(e,t){return' width="'+o(t)+'"'})),0==O&&(n=n.replace(/ height=(\d+)/ig,function(e,t){return' height="'+o(t)+'"'}))}catch(M){n=t}}catch(_){c.parentNode.removeChild(c),n=t}return n},DEXT5_EDITOR.HWPFilter.HTMLtoXML=function(e,r,i){var s="",o=e,u=e.toLowerCase().indexOf("<body"),a=e.toLowerCase().lastIndexOf("</body>");-1<u&&-1<a&&(e=e.substring(u+1,a),u=e.indexOf(">"),e=e.substring(u+1)),e=DEXT5_EDITOR.HWPFilter.HtmlToDomProcess(e);if("undefined"!=typeof r)try{var f=_iframeDoc.getElementById(r);if(f)e=f.innerHTML;else{var l=_iframeDoc.createElement("div");l.style.display="none",l.innerHTML=e,_iframeDoc.body.appendChild(l);if(f=_iframeDoc.getElementById(r))e=f.innerHTML;l.innerHTML="",_iframeDoc.body.removeChild(l);try{delete null}catch(h){}}o=e}catch(p){e=o}try{e=e.replace(/<italic/gi,"<i"),e=e.replace(/<\/italic>/gi,"</i>"),e=e.replace(/<underline/gi,"<u"),e=e.replace(/<\/underline>/gi,"</u>"),e=e.replace(/<strong/gi,"<b"),o=e=e.replace(/<\/strong>/gi,"</b>"),DEXT5_EDITOR.HWPFilter(e,{start:function(e,n,r){if(t[e]){s+="<"+e;for(e=0;e<n.length;e++)s="href"==n[e].name||"src"==n[e].name?s+(" "+n[e].name+"="+n[e].quotationmark+n[e].value+n[e].quotationmark):""!=n[e].quotationmark?s+(" "+n[e].name+"="+n[e].quotationmark+n[e].value+n[e].quotationmark):s+(" "+n[e].name+'="'+n[e].escaped+'"');s+=(r?"/":"")+">"}},end:function(e){t[e]&&!n[e]&&(s+="</"+e+">")},chars:function(e){s+=e},comment:function(e){s+=""}}),o=e}catch(d){s=o}return s=DEXT5_EDITOR.HWPFilter.DOMProcess(s,r,i)},DEXT5_EDITOR.HWPFilter.HtmlToDomProcess=function(e){var t=e,n=!1;document.createTreeWalker&&(n=!0);if(n){var r=document.createElement("div");r.style.display="none",r.innerHTML=e,document.body.appendChild(r),e=r.getElementsByTagName("p");for(var t=e.length,i=0;i<t;i++)if(n)for(var s=e[i],o=void 0,u=document.createTreeWalker(s,NodeFilter.SHOW_TEXT,null,!1);o=u.nextNode();){var a=o.nodeValue,a=a.replace(/\n/g,""),a=a.replace(/\t/g,"");if(""!=a&&(o=o.parentNode)&&o.tagName&&"p"!=o.tagName.toLowerCase()){for(var a=["fontFamily","fontSize"],f=a.length,l=0,c=0;c<f;c++){var h=DEXTTOP.DEXT5.util.getStyle(o,a[c]);h&&(s.style[a[c]]=h,l++)}if(0<l)break}}t=r.innerHTML,r.parentNode.removeChild(r)}return t}}();var g_d5selectedCName="DEXT_selected_basic",g_d5selectedFocusCName="DEXT_selected_nofocus";"object"!=typeof JSON&&(JSON={}),function(){function a(e){return 10>e?"0"+e:e}function b(t){return e.lastIndex=0,e.test(t)?'"'+t.replace(e,function(e){var t=h[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function c(e,t){var n,r,i,s,o,u=f,a=t[e];switch(a&&"object"==typeof a&&"function"==typeof a.toJSON&&(a=a.toJSON(e)),"function"==typeof m&&(a=m.call(t,e,a)),typeof a){case"string":return b(a);case"number":return isFinite(a)?a+"":"null";case"boolean":case"null":return a+"";case"object":if(!a)return"null";if(f+=g,o=[],"[object Array]"===Object.prototype.toString.apply(a)){s=a.length;for(n=0;s>n;n+=1)o[n]=c(n,a)||"null";return i=0===o.length?"[]":f?"[\n"+f+o.join(",\n"+f)+"\n"+u+"]":"["+o.join(",")+"]",f=u,i}if(m&&"object"==typeof m)for(s=m.length,n=0;s>n;n+=1)"string"==typeof m[n]&&(r=m[n],i=c(r,a),i&&o.push(b(r)+(f?": ":":")+i));else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=c(r,a),i&&o.push(b(r)+(f?": ":":")+i));return i=0===o.length?"{}":f?"{\n"+f+o.join(",\n"+f)+"\n"+u+"}":"{"+o.join(",")+"}",f=u,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d,e,f,g,h,m;"function"!=typeof JSON.stringify&&(e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;if(f="",g="","number"==typeof n)for(r=0;n>r;r+=1)g+=" ";else"string"==typeof n&&(g=n);if(m=t,!t||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return c("",{"":e});throw Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(a,b){function c(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=c(i,n),void 0!==r?i[n]=r:delete i[n]);return b.call(e,t,i)}var e;if(a+="",d.lastIndex=0,d.test(a)&&(a=a.replace(d,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"==typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse")})}(),"undefined"==typeof JSON&&(this.JSON={}),function(){var a={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b=function(e){return a[e]||"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(e){return e=e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(e)},JSON.encode=JSON.stringify?function(e){return JSON.stringify(e)}:function(e){e&&e.toJSON&&(e=e.toJSON());switch(typeOf(e)){case"string":return'"'+e.replace(/[\x00-\x1f\\"]/g,b)+'"';case"array":return"["+e.map(JSON.encode).clean()+"]";case"object":case"hash":var t=[];return Object.each(e,function(e,n){var r=JSON.encode(e);r&&t.push(JSON.encode(n)+":"+r)}),"{"+t+"}";case"number":case"boolean":return""+e;case"null":return"null"}return null},JSON.secure=!0,JSON.decode=function(a,b){if(!a||"string"!=typeof a)return null;null==b&&(b=JSON.secure);if(b){if(JSON.parse)return JSON.parse(a);if(!JSON.validate(a))throw Error("JSON could not decode the input; security is enabled and the value is not secure.")}return eval("("+a+")")}}();var onChange=function(e){var t=e.editor;e=e.isPossibleDirty;try{for(var n in G_DEPlugin)"function"==typeof G_DEPlugin[n].onChange&&G_DEPlugin[n].onChange()}catch(r){}set_ruler_vertical_height(t),set_horizontal_line_2(t),e&&(G_IsPossibleDirty=e),""!=t._config.placeholder.content&&placeholderControl(t,"class")},onCommand=function(e){var t=e.editor,n=e.cmd,r=!1;1==e.tool&&(r=!0);try{for(var i in G_DEPlugin)"function"==typeof G_DEPlugin[i].onCommand&&G_DEPlugin[i].onCommand(e)}catch(s){}if("1"==t._config.returnEvent.command_event)try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.command?DEXTTOP.G_CURREDITOR._config.event.command(t.ID,{cmd:n,tool:r}):DEXTTOP.DEXTWIN.dext_command_event(t.ID,{cmd:n,tool:r})}catch(o){}},onResize=function(e){try{for(var t in G_DEPlugin)"function"==typeof G_DEPlugin[t].onResize&&G_DEPlugin[t].onResize(e)}catch(n){}},onInitOnce=function(e){try{for(var t in G_DEPlugin)"function"==typeof G_DEPlugin[t].onInitOnce&&G_DEPlugin[t].onInitOnce(e)}catch(n){}},onColorPicker=function(e){var t=null;try{for(var n in G_DEPlugin)"function"==typeof G_DEPlugin[n].onColorPicker&&(t=G_DEPlugin[n].onColorPicker(e))}catch(r){}return t},onCellResize=function(e){try{for(var t in G_DEPlugin)"function"==typeof G_DEPlugin[t].onCellResize&&G_DEPlugin[t].onCellResize(e)}catch(n){}},rangy;rangy=rangy||function(){function e(e,t){var n=typeof e[t];return n==v||n==d&&!!e[t]||n=="unknown"}function t(e,t){return typeof e[t]==d&&!!e[t]}function n(e,t){return typeof e[t]!=m}function r(e){return function(t,n){var r=n.length;while(r--)if(!e(t,n[r]))return!1;return!0}}function i(e){return e&&E(e,w)&&x(e,b)}function s(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function o(n){t(window,"console")&&e(window.console,"log")&&window.console.log(n)}function u(e,t){t?window.alert(e):o(e)}function a(e){N.initialized=!0,N.supported=!1,u("Rangy is not supported on this page in your browser. Reason: "+e,N.config.alertOnFail)}function f(e){u("Rangy warning: "+e,N.config.alertOnWarn)}function l(e){return e.message||e.description||String(e)}function c(){if(N.initialized)return;var t,n=!1,r=!1;e(document,"createRange")&&(t=document.createRange(),E(t,y)&&x(t,g)&&(n=!0),t.detach());var u=s(document);if(!u||u.nodeName.toLowerCase()!="body"){a("No body element found");return}u&&e(u,"createTextRange")&&(t=u.createTextRange(),i(t)&&(r=!0));if(!n&&!r){a("Neither Range nor TextRange are available");return}N.initialized=!0,N.features={implementsDomRange:n,implementsTextRange:r};var f,c;for(var h in T)(f=T[h])instanceof p&&f.init();for(var d=0,v=k.length;d<v;++d)try{k[d](N)}catch(m){c="Rangy init listener threw an exception. Continuing. Detail: "+l(m),o(c)}}function h(e){e=e||window,c();for(var t=0,n=L.length;t<n;++t)L[t](e)}function p(e,t){this.name=e,this.initialized=!1,this.supported=!1,this.init=t}var d="object",v="function",m="undefined",g=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],y=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],b=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],w=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],E=r(e),S=r(t),x=r(n),T={},N={version:"1.3alpha.772",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:E,areHostObjects:S,areHostProperties:x,isTextRange:i,getBody:s},features:{},modules:T,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1}};N.fail=a,N.warn=f,{}.hasOwnProperty?N.util.extend=function(e,t,n){var r,i;for(var s in t)t.hasOwnProperty(s)&&(r=e[s],i=t[s],n&&r!==null&&typeof r=="object"&&i!==null&&typeof i=="object"&&N.util.extend(r,i,!0),e[s]=i);return e}:a("hasOwnProperty not supported"),function(){var e=document.createElement("div");e.appendChild(document.createElement("span"));var t=[].slice,n;try{t.call(e.childNodes,0)[0].nodeType==1&&(n=function(e){return t.call(e,0)})}catch(r){}n||(n=function(e){var t=[];for(var n=0,r=e.length;n<r;++n)t[n]=e[n];return t}),N.util.toArray=n}();var C;e(document,"addEventListener")?C=function(e,t,n){e.addEventListener(t,n,!1)}:e(document,"attachEvent")?C=function(e,t,n){e.attachEvent("on"+t,n)}:a("Document does not have required addEventListener or attachEvent method"),N.util.addListener=C;var k=[];N.init=c,N.addInitListener=function(e){N.initialized?e(N):k.push(e)};var L=[];N.addCreateMissingNativeApiListener=function(e){L.push(e)},N.createMissingNativeApi=h,p.prototype={fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){N.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){N.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},N.createModule=function(e,t){var n=new p(e,function(){if(!n.initialized){n.initialized=!0;try{t(N,n),n.supported=!0}catch(r){var i="Module '"+e+"' failed to load: "+l(r);o(i)}}});T[e]=n},N.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t],r=T[i];if(!r||!(r instanceof p))throw new Error("required module '"+i+"' not found");r.init();if(!r.supported)throw new Error("required module '"+i+"' not supported")}};var A=!1,O=function(e){A||(A=!0,N.initialized||c())};if(typeof window==m){a("No window found");return}if(typeof document==m){a("No document found");return}return e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",O,!1),C(window,"load",O),N}(),rangy.createModule("DomUtil",function(e,t){function n(e){var t;return typeof e.namespaceURI==A||(t=e.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml"}function r(e){var t=e.parentNode;return t.nodeType==1?t:null}function i(e){var t=0;while(e=e.previousSibling)++t;return t}function s(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function o(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(D(n,r))return r;return null}function u(e,t,n){var r=n?t:t.parentNode;while(r){if(r===e)return!0;r=r.parentNode}return!1}function a(e,t){return u(e,t,!0)}function f(e,t,n){var r,i=n?e:e.parentNode;while(i){r=i.parentNode;if(r===t)return i;i=r}return null}function l(e){var t=e.nodeType;return t==3||t==4||t==8}function c(e){if(!e)return!1;var t=e.nodeType;return t==3||t==8}function h(e,t){var n=t.nextSibling,r=t.parentNode;return n?r.insertBefore(e,n):r.appendChild(e),e}function p(e,t,n){var r=e.cloneNode(!1);r.deleteData(0,t),e.deleteData(t,e.length-t),h(r,e);if(n)for(var s=0,o;o=n[s++];)o.node==e&&o.offset>t?(o.node=r,o.offset-=t):o.node==e.parentNode&&o.offset>i(e)&&++o.offset;return r}function d(e){if(e.nodeType==9)return e;if(typeof e.ownerDocument!=A)return e.ownerDocument;if(typeof e.document!=A)return e.document;if(e.parentNode)return d(e.parentNode);throw t.createError("getDocument: no document found for node")}function v(e){var n=d(e);if(typeof n.defaultView!=A)return n.defaultView;if(typeof n.parentWindow!=A)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function m(e){if(typeof e.contentDocument!=A)return e.contentDocument;if(typeof e.contentWindow!=A)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function g(e){if(typeof e.contentWindow!=A)return e.contentWindow;if(typeof e.contentDocument!=A)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function y(e){return e&&O.isHostMethod(e,"setTimeout")&&O.isHostObject(e,"document")}function b(e,t,n){var r;e?O.isHostProperty(e,"nodeType")?r=e.nodeType==1&&e.tagName.toLowerCase()=="iframe"?m(e):d(e):y(e)&&(r=e.document):r=document;if(!r)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return r}function w(e){var t;while(t=e.parentNode)e=t;return e}function E(e,n,r,s){var u,a,l,c,h;if(e==r)return n===s?0:n<s?-1:1;if(u=f(r,e,!0))return n<=i(u)?-1:1;if(u=f(e,r,!0))return i(u)<s?-1:1;a=o(e,r),l=e===a?a:f(e,a,!0),c=r===a?a:f(r,a,!0);if(l===c)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");h=a.firstChild;while(h){if(h===l)return-1;if(h===c)return 1;h=h.nextSibling}}function S(e){try{return e.parentNode,!1}catch(t){return!0}}function x(e){if(!e)return"[No node]";if(P&&S(e))return"[Broken node]";if(l(e))return'"'+e.data+'"';if(e.nodeType==1){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+e.childNodes.length+"]["+e.innerHTML.slice(0,20)+"]"}return e.nodeName}function T(e){var t=d(e).createDocumentFragment(),n;while(n=e.firstChild)t.appendChild(n);return t}function N(e){this.root=e,this._next=e}function C(e){return new N(e)}function k(e,t){this.node=e,this.offset=t}function L(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var A="undefined",O=e.util;O.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),O.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var M=document.createElement("div");O.areHostMethods(M,["insertBefore","appendChild","cloneNode"]||!O.areHostObjects(M,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),O.isHostProperty(M,"innerHTML")||t.fail("Element is missing innerHTML property");var _=document.createTextNode("test");O.areHostMethods(_,["splitText","deleteData","insertData","appendData","cloneNode"]||!O.areHostObjects(M,["previousSibling","nextSibling","childNodes","parentNode"])||!O.areHostProperties(_,["data"]))||t.fail("Incomplete Text Node implementation");var D=function(e,t){var n=e.length;while(n--)if(e[n]===t)return!0;return!1},P=!1;(function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br>",P=S(n),e.features.crashyTextNodes=P})();var H;typeof window.getComputedStyle!=A?H=function(e,t){return v(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=A?H=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found"),N.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t,n;if(this._current){t=e.firstChild;if(t)this._next=t;else{n=null;while(e!==this.root&&!(n=e.nextSibling))e=e.parentNode;this._next=n}}return this._current},detach:function(){this._current=this._next=this.root=null}},k.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},L.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},L.prototype.toString=function(){return this.message},e.dom={arrayContains:D,isHtmlNamespace:n,parentElement:r,getNodeIndex:i,getNodeLength:s,getCommonAncestor:o,isAncestorOf:u,isOrIsAncestorOf:a,getClosestAncestorIn:f,isCharacterDataNode:l,isTextOrCommentNode:c,insertAfter:h,splitDataNode:p,getDocument:d,getWindow:v,getIframeWindow:g,getIframeDocument:m,getBody:O.getBody,isWindow:y,getContentDocument:b,getRootContainer:w,comparePoints:E,isBrokenNode:S,inspectNode:x,getComputedStyleProperty:H,fragmentFromNodeChildren:T,createIterator:C,DomPosition:k},e.DOMException=L}),rangy.createModule("DomRange",function(e,t){function n(e,t){return e.nodeType!=3&&(W(e,t.startContainer)||W(e,t.endContainer))}function r(e){return e.document||X(e.startContainer)}function i(e){return new q(e.parentNode,z(e))}function s(e){return new q(e.parentNode,z(e)+1)}function o(e,t,n){var r=e.nodeType==11?e.firstChild:e;return U(t)?n==t.length?F.insertAfter(e,t):t.parentNode.insertBefore(e,n==0?t:$(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),r}function u(e,t,n){k(e),k(t);var r=V(e.startContainer,e.startOffset,t.endContainer,t.endOffset),i=V(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?r<=0&&i>=0:r<0&&i>0}function a(e){var t;for(var n,i=r(e.range).createDocumentFragment(),s;n=e.next();)t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(s=e.getSubtreeIterator(),n.appendChild(a(s)),s.detach(!0)),i.appendChild(n);return i}function f(e,t,n){var r,i;n=n||{stop:!1};for(var s,o;s=e.next();)if(e.isPartiallySelectedSubtree()){if(t(s)===!1){n.stop=!0;return}o=e.getSubtreeIterator(),f(o,t,n),o.detach(!0);if(n.stop)return}else{r=F.createIterator(s);while(i=r.next())if(t(i)===!1){n.stop=!0;return}}}function l(e){var t;while(e.next())e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),l(t),t.detach(!0)):e.remove()}function c(e){for(var t,n=r(e.range).createDocumentFragment(),i;t=e.next();)e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),i=e.getSubtreeIterator(),t.appendChild(c(i)),i.detach(!0)):e.remove(),n.appendChild(t);return n}function h(e,t,n){var r=!!t&&!!t.length,i,s=!!n;r&&(i=new RegExp("^("+t.join("|")+")$"));var o=[];return f(new d(e,!1),function(e){(!r||i.test(e.nodeType))&&(!s||n(e))&&o.push(e)}),o}function p(e){var t=typeof e.getName=="undefined"?"Range":e.getName();return"["+t+"("+F.inspectNode(e.startContainer)+":"+e.startOffset+", "+F.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function d(e,t){this.range=e,this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&U(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===n&&!U(this.sc)?this.sc.childNodes[this.so]:J(this.sc,n,!0),this._last=this.ec===n&&!U(this.ec)?this.ec.childNodes[this.eo-1]:J(this.ec,n,!0))}}function v(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function m(e){return function(t,n){var r,i=n?t:t.parentNode;while(i){r=i.nodeType;if(Q(e,r))return i;i=i.parentNode}return null}}function g(e,t){}function y(e){}function b(e,t){}function w(e,t){}function E(e,t){}function S(e){}function x(e,t){}function T(e){return Y&&F.isBrokenNode(e)||!Q(et,e.nodeType)&&!it(e,!0)}function N(e,t){return t<=(U(e)?e.length:e.childNodes.length)}function C(e){return!!e.startContainer&&!!e.endContainer&&!T(e.startContainer)&&!T(e.endContainer)&&N(e.startContainer,e.startOffset)&&N(e.endContainer,e.endOffset)}function k(e){y(e)}function L(e,t){k(e);var n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=n===i;U(i)&&s>0&&s<i.length&&$(i,s,t),U(n)&&r>0&&r<n.length&&(n=$(n,r,t),o?(s-=r,i=n):i==n.parentNode&&s>=z(n)&&s++,r=0),e.setStartAndEnd(n,r,i,s)}function A(){}function O(e){e.START_TO_START=ht,e.START_TO_END=pt,e.END_TO_END=dt,e.END_TO_START=vt,e.NODE_BEFORE=mt,e.NODE_AFTER=gt,e.NODE_BEFORE_AND_AFTER=yt,e.NODE_INSIDE=bt}function M(e){O(e),O(e.prototype)}function _(e,t){return function(){k(this);var n=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,o=new d(this,!0),u,a;n!==i&&(u=J(n,i,!0),a=s(u),n=a.node,r=a.offset),f(o,S),o.reset();var l=e(o);return o.detach(),t(this,n,r,n,r),l}}function D(e,t,r){function o(e,t){return function(n){y(this),b(n,Z),b(G(n),et);var r=(e?i:s)(n);(t?u:a)(this,r.node,r.offset)}}function u(e,n,r){var i=e.endContainer,s=e.endOffset;if(n!==e.startContainer||r!==e.startOffset){if(G(n)!=G(i)||V(n,r,i,s)==1)i=n,s=r;t(e,n,r,i,s)}}function a(e,n,r){var i=e.startContainer,s=e.startOffset;if(n!==e.endContainer||r!==e.endOffset){if(G(n)!=G(i)||V(n,r,i,s)==-1)i=n,s=r;t(e,i,s,n,r)}}e.prototype=new A,I.extend(e.prototype,{setStart:function(e,t){y(this),g(e,!0),w(e,t),u(this,e,t)},setEnd:function(e,t){y(this),g(e,!0),w(e,t),a(this,e,t)},setStartAndEnd:function(){y(this);var e=arguments,n=e[0],r=e[1],i=n,s=r;switch(e.length){case 3:s=e[2];break;case 4:i=e[2],s=e[3]}t(this,n,r,i,s)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(e){k(this),e?t(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):t(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){y(this),g(e,!0),t(this,e,0,e,K(e))},selectNode:function(e){y(this),g(e,!1),b(e,Z);var n=i(e),r=s(e);t(this,n.node,n.offset,r.node,r.offset)},extractContents:_(c,t),deleteContents:_(l,t),canSurroundContents:function(){k(this),S(this.startContainer),S(this.endContainer);var e=new d(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},detach:function(){r(this)},splitBoundaries:function(){L(this)},splitBoundariesPreservingPositions:function(e){L(this,e)},normalizeBoundaries:function(){k(this);var e=this.startContainer,n=this.startOffset,r=this.endContainer,i=this.endOffset,s=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(r=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},o=function(t){var s=t.previousSibling;if(s&&s.nodeType==t.nodeType){e=t;var o=t.length;n=s.length,t.insertData(0,s.data),s.parentNode.removeChild(s);if(e==r)i+=n,r=e;else if(r==t.parentNode){var u=z(t);i==u?(r=t,i=o):i>u&&i--}}},u=!0;if(U(r))r.length==i&&s(r);else{if(i>0){var a=r.childNodes[i-1];a&&U(a)&&s(a)}u=!this.collapsed}if(u){if(U(e))n==0&&o(e);else if(n<e.childNodes.length){var f=e.childNodes[n];f&&U(f)&&o(f)}}else e=r,n=i;t(this,e,n,r,i)},collapseToPoint:function(e,t){y(this),g(e,!0),w(e,t),this.setStartAndEnd(e,t)}}),M(e)}function P(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:F.getCommonAncestor(e.startContainer,e.endContainer)}function H(e,t,n,r,i){e.startContainer=t,e.startOffset=n,e.endContainer=r,e.endOffset=i,e.document=F.getDocument(t),P(e)}function B(e){y(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=e.document=null,e.collapsed=e.commonAncestorContainer=null}function j(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,P(this)}e.requireModules(["DomUtil"]);var F=e.dom,I=e.util,q=F.DomPosition,R=e.DOMException,U=F.isCharacterDataNode,z=F.getNodeIndex,W=F.isOrIsAncestorOf,X=F.getDocument,V=F.comparePoints,$=F.splitDataNode,J=F.getClosestAncestorIn,K=F.getNodeLength,Q=F.arrayContains,G=F.getRootContainer,Y=e.features.crashyTextNodes;d.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,U(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e=this._current,t,n;!U(e)||e!==this.sc&&e!==this.ec?e.parentNode&&e.parentNode.removeChild(e):(t=e===this.sc?this.so:0,n=e===this.ec?this.eo:e.length,t!=n&&e.deleteData(t,n-t))},isPartiallySelectedSubtree:function(){var e=this._current;return n(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new j(r(this.range));var t=this._current,n=t,i=0,s=t,o=K(t);W(t,this.sc)&&(n=this.sc,i=this.so),W(t,this.ec)&&(s=this.ec,o=this.eo),H(e,n,i,s,o)}return new d(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},v.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},v.prototype.toString=function(){return this.message};var Z=[1,3,4,5,7,8,10],et=[2,9,11],tt=[5,6,10,12],nt=[1,3,4,5,7,8,10,11],rt=[1,3,4,5,7,8],it=m([9,11]),st=m(tt),ot=m([6,10,12]),ut=document.createElement("style"),at=!1;try{ut.innerHTML="<b>x</b>",at=ut.firstChild.nodeType==3}catch(ft){}e.features.htmlParsingConforms=at;var lt=at?function(e){var t=this.startContainer,n=X(t),r=null;return t.nodeType==1?r=t:U(t)&&(r=F.parentElement(t)),r===null||r.nodeName=="HTML"&&F.isHtmlNamespace(X(r).documentElement)&&F.isHtmlNamespace(r)?r=n.createElement("body"):r=r.cloneNode(!1),r.innerHTML=e,F.fragmentFromNodeChildren(r)}:function(e){y(this);var t=r(this),n=t.createElement("body");return n.innerHTML=e,F.fragmentFromNodeChildren(n)},ct=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ht=0,pt=1,dt=2,vt=3,mt=0,gt=1,yt=2,bt=3;A.prototype={compareBoundaryPoints:function(e,t){k(this),E(this.startContainer,t.startContainer);var n,r,i,s,o=e==vt||e==ht?"start":"end",u=e==pt||e==ht?"start":"end";return n=this[o+"Container"],r=this[o+"Offset"],i=t[u+"Container"],s=t[u+"Offset"],V(n,r,i,s)},insertNode:function(e){k(this),b(e,nt),S(this.startContainer);var t=o(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){k(this);var e,t;if(this.collapsed)return r(this).createDocumentFragment();if(this.startContainer===this.endContainer&&U(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=r(this).createDocumentFragment(),t.appendChild(e),t;var n=new d(this,!0);return e=a(n),n.detach(),e},canSurroundContents:function(){k(this),S(this.startContainer),S(this.endContainer);var e=new d(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},surroundContents:function(e){b(e,rt);var t=this.extractContents();if(e.hasChildNodes())while(e.lastChild)e.removeChild(e.lastChild);o(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){k(this);var e=new j(r(this)),t=ct.length,n;while(t--)n=ct[t],e[n]=this[n];return e},toString:function(){k(this);var e=this.startContainer;if(e===this.endContainer&&U(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new d(this,!0);return f(n,function(e){(e.nodeType==3||e.nodeType==4)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){k(this);var t=e.parentNode,n=z(e),r=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return r<0?i>0?yt:mt:i>0?gt:bt},comparePoint:function(e,t){return k(this),x(e,"HIERARCHY_REQUEST_ERR"),E(e,this.startContainer),V(e,t,this.startContainer,this.startOffset)<0?-1:V(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:lt,toHtml:function(){k(this);var e=this.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){k(this),x(e,"NOT_FOUND_ERR");if(X(e)!==r(this))return!1;var n=e.parentNode,i=z(e);x(n,"NOT_FOUND_ERR");var s=V(n,i,this.endContainer,this.endOffset),o=V(n,i+1,this.startContainer,this.startOffset);return t?s<=0&&o>=0:s<0&&o>0},isPointInRange:function(e,t){return k(this),x(e,"HIERARCHY_REQUEST_ERR"),E(e,this.startContainer),V(e,t,this.startContainer,this.startOffset)>=0&&V(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return u(this,e,!1)},intersectsOrTouchesRange:function(e){return u(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=V(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=V(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();return t==-1&&r.setStart(e.startContainer,e.startOffset),n==1&&r.setEnd(e.endContainer,e.endOffset),r}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return V(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset),V(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(e.endContainer,e.endOffset),t}},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==bt},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,K(e))<=0},containsRange:function(e){var t=this.intersection(e);return t!==null&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();t.setEnd(r,r.length);var i=this.containsRange(t);return t.detach(),i}return this.containsNodeContents(e)},getNodes:function(e,t){return k(this),h(this,e,t)},getDocument:function(){return r(this)},collapseBefore:function(e){y(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){y(this),this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var n=r(this),i=e.createRange(n);t=t||F.getBody(n),i.selectNodeContents(t);var s=this.intersection(i),o=0,u=0;return s&&(i.setEnd(s.startContainer,s.startOffset),o=i.toString().length,u=o+s.toString().length,i.detach()),{start:o,end:u,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);var r=[t],i,s=!1,o=!1,u,a,f;while(!o&&(i=r.pop()))if(i.nodeType==3)u=n+i.length,!s&&e.start>=n&&e.start<=u&&(this.setStart(i,e.start-n),s=!0),s&&e.end>=n&&e.end<=u&&(this.setEnd(i,e.end-n),o=!0),n=u;else{f=i.childNodes,a=f.length;while(a--)r.push(f[a])}},getName:function(){return"DomRange"},equals:function(e){return j.rangesEqual(this,e)},isValid:function(){return C(this)},inspect:function(){return p(this)}},D(j,H,B),e.rangePrototype=A.prototype,I.extend(j,{rangeProperties:ct,RangeIterator:d,copyComparisonConstants:M,createPrototypeRange:D,inspect:p,getRangeDocument:r,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=j,e.RangeException=v}),rangy.createModule("WrappedRange",function(e,t){e.requireModules(["DomUtil","DomRange"]);var n,r,i=e.dom,s=e.util,o=i.DomPosition,u=e.DomRange,a=i.getBody,f=i.getContentDocument,l=i.isCharacterDataNode;e.features.implementsDomRange&&function(){function r(e){var t=h.length,n;while(t--)n=h[t],e[n]=e.nativeRange[n];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function o(e,t,n,r,i){var s=e.startContainer!==t||e.startOffset!=n,o=e.endContainer!==r||e.endOffset!=i,u=!e.equals(e.nativeRange);if(s||o||u)e.setEnd(r,i),e.setStart(t,n)}function l(e){e.nativeRange.detach(),e.detached=!0;var t=h.length;while(t--)e[h[t]]=null}var c,h=u.rangeProperties,p;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,r(this)},u.createPrototypeRange(n,o,l),c=n.prototype,c.selectNode=function(e){this.nativeRange.selectNode(e),r(this)},c.cloneContents=function(){return this.nativeRange.cloneContents()},c.surroundContents=function(e){this.nativeRange.surroundContents(e),r(this)},c.collapse=function(e){this.nativeRange.collapse(e),r(this)},c.cloneRange=function(){return new n(this.nativeRange.cloneRange())},c.refresh=function(){r(this)},c.toString=function(){return this.nativeRange.toString()};var d=document.createTextNode("test");a(document).appendChild(d);var v=document.createRange();v.setStart(d,0),v.setEnd(d,0);try{v.setStart(d,1),c.setStart=function(e,t){this.nativeRange.setStart(e,t),r(this)},c.setEnd=function(e,t){this.nativeRange.setEnd(e,t),r(this)},p=function(e){return function(t){this.nativeRange[e](t),r(this)}}}catch(m){c.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}r(this)},c.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}r(this)},p=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(i){this.nativeRange[t](n),this.nativeRange[e](n)}r(this)}}}c.setStartBefore=p("setStartBefore","setEndBefore"),c.setStartAfter=p("setStartAfter","setEndAfter"),c.setEndBefore=p("setEndBefore","setStartBefore"),c.setEndAfter=p("setEndAfter","setStartAfter"),v.selectNodeContents(d),v.startContainer==d&&v.endContainer==d&&v.startOffset==0&&v.endOffset==d.length?c.selectNodeContents=function(e){this.nativeRange.selectNodeContents(e),r(this)}:c.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},v.selectNodeContents(d),v.setEnd(d,3);var g=document.createRange();g.selectNodeContents(d),g.setEnd(d,4),g.setStart(d,2),v.compareBoundaryPoints(v.START_TO_END,g)==-1&&v.compareBoundaryPoints(v.END_TO_START,g)==1?c.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:c.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var y=document.createElement("div");y.innerHTML="123";var w=y.firstChild,E=a(document);E.appendChild(y),v.setStart(w,1),v.setEnd(w,2),v.deleteContents(),w.data=="13"&&(c.deleteContents=function(){this.nativeRange.deleteContents(),r(this)},c.extractContents=function(){var e=this.nativeRange.extractContents();return r(this),e}),E.removeChild(y),E=null,s.isHostMethod(v,"createContextualFragment")&&(c.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),a(document).removeChild(d),v.detach(),g.detach(),c.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=f(e,t,"createNativeRange"),e.createRange()}}();if(e.features.implementsTextRange){var c=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var r=n.parentElement();n=e.duplicate(),n.collapse(!1);var s=n.parentElement(),o=r==s?r:i.getCommonAncestor(r,s);return o==t?o:i.getCommonAncestor(t,o)},h=function(e){return e.compareEndPoints("StartToEnd",e)==0},p=function(e,t,n,r,s){var u=e.duplicate();u.collapse(n);var a=u.parentElement();i.isOrIsAncestorOf(t,a)||(a=t);if(!a.canHaveHTML){var f=new o(a.parentNode,i.getNodeIndex(a));return{boundaryPosition:f,nodeInfo:{nodeIndex:f.offset,containerElement:f.node}}}var c=i.getDocument(a).createElement("span");c.parentNode&&c.parentNode.removeChild(c);var h,p=n?"StartToStart":"StartToEnd",d,v,m,y,b=s&&s.containerElement==a?s.nodeIndex:0,w=a.childNodes.length,E=w,S=E;for(;;){S==w?a.appendChild(c):a.insertBefore(c,a.childNodes[S]),u.moveToElementText(c),h=u.compareEndPoints(p,e);if(h==0||b==E)break;if(h==-1){if(E==b+1)break;b=S}else E=E==b+1?b:S;S=Math.floor((b+E)/2),a.removeChild(c)}y=c.nextSibling;if(h==-1&&y&&l(y)){u.setEndPoint(n?"EndToStart":"EndToEnd",e);var x;if(/[\r\n]/.test(y.data)){var T=u.duplicate(),N=T.text.replace(/\r\n/g,"\r").length;x=T.moveStart("character",N);while((h=T.compareEndPoints("StartToEnd",T))==-1)x++,T.moveStart("character",1)}else x=u.text.length;m=new o(y,x)}else d=(r||!n)&&c.previousSibling,v=(r||n)&&c.nextSibling,v&&l(v)?m=new o(v,0):d&&l(d)?m=new o(d,d.data.length):m=new o(a,i.getNodeIndex(c));return c.parentNode.removeChild(c),{boundaryPosition:m,nodeInfo:{nodeIndex:S,containerElement:a}}},d=function(e,t){var n,r,s=e.offset,o=i.getDocument(e.node),u,f,c=a(o).createTextRange(),h=l(e.node);return h?(n=e.node,r=n.parentNode):(f=e.node.childNodes,n=s<f.length?f[s]:null,r=e.node),u=o.createElement("span"),u.innerHTML="&#feff;",n?r.insertBefore(u,n):r.appendChild(u),c.moveToElementText(u),c.collapse(!t),r.removeChild(u),h&&c[t?"moveStart":"moveEnd"]("character",s),c};r=function(e){this.textRange=e,this.refresh()},r.prototype=new u(document),r.prototype.refresh=function(){var e,t,n,r=c(this.textRange);h(this.textRange)?t=e=p(this.textRange,r,!0,!0).boundaryPosition:(n=p(this.textRange,r,!0,!1),e=n.boundaryPosition,t=p(this.textRange,r,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},r.prototype.getName=function(){return"WrappedTextRange"},u.copyComparisonConstants(r),r.rangeToTextRange=function(e){if(e.collapsed)return d(new o(e.startContainer,e.startOffset),!0);var t=d(new o(e.startContainer,e.startOffset),!0),n=d(new o(e.endContainer,e.endOffset),!1),r=a(u.getRangeDocument(e)).createTextRange();return r.setEndPoint("StartToStart",t),r.setEndPoint("EndToEnd",n),r},e.WrappedTextRange=r;if(!e.features.implementsDomRange||e.config.preferTextRange){var v=function(){return this}();typeof v.Range=="undefined"&&(v.Range=r),e.createNativeRange=function(e){return e=f(e,t,"createNativeRange"),a(e).createTextRange()},e.WrappedRange=r}}e.createRange=function(n){return n=f(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=f(e,t,"createRangyRange"),new u(e)},e.createIframeRange=function(n){return t.deprecationNotice("createIframeRange()","createRange(iframeEl)"),e.createRange(n)},e.createIframeRangyRange=function(n){return t.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),e.createRangyRange(n)},e.addCreateMissingNativeApiListener(function(t){var n=t.document;typeof n.createRange=="undefined"&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),rangy.createModule("WrappedSelection",function(e,t){function n(e){return typeof e=="string"?e=="backward":!!e}function r(e,n){if(!e)return window;if(T.isWindow(e))return e;if(e instanceof m)return e.win;var r=T.getContentDocument(e,t,n);return T.getWindow(r)}function i(e){return r(e,"getWinSelection").getSelection()}function s(e){return r(e,"getDocSelection").document.selection}function o(e,t,n){var r=n?"end":"start",i=n?"start":"end";e.anchorNode=t[r+"Container"],e.anchorOffset=t[r+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function u(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function a(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function f(t){var n;return t instanceof k?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof L?n=t.nativeRange:D.implementsDomRange&&t instanceof T.getWindow(t.startContainer).Range&&(n=t),n}function l(e){if(!e.length||e[0].nodeType!=1)return!1;for(var t=1,n=e.length;t<n;++t)if(!T.isAncestorOf(e[0],e[t]))return!1;return!0}function c(e){var n=e.getNodes();if(!l(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function h(e){return!!e&&typeof e.text!="undefined"}function p(e,t){var n=new L(t);e._ranges=[n],o(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function d(t){t._ranges.length=0;if(t.docSelection.type=="None")a(t);else{var n=t.docSelection.createRange();if(h(n))p(t,n);else{t.rangeCount=n.length;var r,i=H(n.item(0));for(var s=0;s<t.rangeCount;++s)r=e.createRange(i),r.selectNode(n.item(s)),t._ranges.push(r);t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed,o(t,t._ranges[t.rangeCount-1],!1)}}}function v(e,n){var r=e.docSelection.createRange(),i=c(n),s=H(r.item(0)),o=B(s).createControlRange();for(var u=0,a=r.length;u<a;++u)o.add(r.item(u));try{o.add(i)}catch(f){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}o.select(),d(e)}function m(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function g(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function y(e,t){var n=Y.length,r,i;while(n--){r=Y[n],i=r.selection;if(t=="deleteAll")g(i);else if(r.win==e)return t=="delete"?(Y.splice(n,1),!0):i}return t=="deleteAll"&&(Y.length=0),null}function b(e,n){var r=H(n[0].startContainer),i=B(r).createControlRange();for(var s=0,o;s<rangeCount;++s){o=c(n[s]);try{i.add(o)}catch(u){throw t.createError("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}i.select(),d(e)}function w(e,t){}function E(t){return function(n,r){var i;this.rangeCount?(i=this.getRangeAt(0),i["set"+(t?"Start":"End")](n,r)):(i=e.createRange(this.win.document),i.setStartAndEnd(n,r)),this.setSingleRange(i,this.isBackward())}}function S(e){var t=[],n=new O(e.anchorNode,e.anchorOffset),r=new O(e.focusNode,e.focusOffset),i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var s=0,o=e.rangeCount;s<o;++s)t[s]=k.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]),e.config.checkSelectionRanges=!0;var x="boolean",T=e.dom,N=e.util,C=N.isHostMethod,k=e.DomRange,L=e.WrappedRange,A=e.DOMException,O=T.DomPosition,M,_,D=e.features,P="Control",H=T.getDocument,B=T.getBody,j=k.rangesEqual,F=C(window,"getSelection"),I=N.isHostObject(document,"selection");D.implementsWinGetSelection=F,D.implementsDocSelection=I;var q=I&&(!F||e.config.preferTextRange);q?(M=s,e.isSelectionValid=function(e){var t=r(e,"isSelectionValid").document,n=t.selection;return n.type!="None"||H(n.createRange().parentElement())==t}):F?(M=i,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."
),e.getNativeSelection=M;var R=M(),U=e.createNativeRange(document),z=B(document),W=N.areHostProperties(R,["anchorNode","focusNode","anchorOffset","focusOffset"]);D.selectionHasAnchorAndFocus=W;var X=C(R,"extend");D.selectionHasExtend=X;var V=typeof R.rangeCount=="number";D.selectionHasRangeCount=V;var $=!1,J=!0;N.areHostMethods(R,["addRange","getRangeAt","removeAllRanges"])&&typeof R.rangeCount=="number"&&D.implementsDomRange&&function(){var e=window.getSelection();if(e){var t=B(document),n=t.appendChild(document.createElement("div"));n.contentEditable="false";var r=n.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")),i=document.createRange();i.setStart(r,1),i.collapse(!0),e.addRange(i),J=e.rangeCount==1,e.removeAllRanges();var s=i.cloneRange();i.setStart(r,0),s.setEnd(r,3),s.setStart(r,2),e.addRange(i),DEXTTOP.DEXT5.browser.chrome||e.addRange(s),$=e.rangeCount==2,t.removeChild(n),e.removeAllRanges(),i.detach(),s.detach()}}(),D.selectionSupportsMultipleRanges=$,D.collapsedNonEditableSelectionsSupported=J;var K=!1,Q;z&&C(z,"createControlRange")&&(Q=z.createControlRange(),N.areHostProperties(Q,["item","add"])&&(K=!0)),D.implementsControlRange=K,W?_=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:_=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var G;C(R,"getRangeAt")?G=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:W&&(G=function(t){var n=H(t.anchorNode),r=e.createRange(n);return r.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),r.collapsed!==this.isCollapsed&&r.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),r});var Y=[],Z=function(e){if(e&&e instanceof m)return e.refresh(),e;e=r(e,"getNativeSelection");var t=y(e),n=M(e),i=I?s(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh()):(t=new m(n,i,e),Y.push({win:e,selection:t})),t};e.getSelection=Z,e.getIframeSelection=function(n){return t.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),e.getSelection(T.getIframeWindow(n))};var et=m.prototype;if(!q&&W&&N.areHostMethods(R,["removeAllRanges","addRange"])){et.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),a(this)};var tt=function(t,n){var r=k.getRangeDocument(n),i=e.createRange(r);i.collapseToPoint(n.endContainer,n.endOffset),t.nativeSelection.addRange(f(i)),t.nativeSelection.extend(n.startContainer,n.startOffset),t.refresh()};V?et.addRange=function(t,r){if(K&&I&&this.docSelection.type==P)v(this,t);else if(n(r)&&X)tt(this,t);else{var i;$?i=this.rangeCount:(this.removeAllRanges(),i=0),this.nativeSelection.addRange(f(t).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==i+1){if(e.config.checkSelectionRanges){var s=G(this.nativeSelection,this.rangeCount-1);s&&!j(s,t)&&(t=new L(s))}this._ranges[this.rangeCount-1]=t,o(this,t,it(this.nativeSelection)),this.isCollapsed=_(this)}else this.refresh()}}:et.addRange=function(e,t){n(t)&&X?tt(this,e):(this.nativeSelection.addRange(f(e)),this.refresh())},et.setRanges=function(e){if(K&&e.length>1)b(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(C(R,"empty")&&C(U,"select")&&K&&q))return t.fail("No means of selecting a Range or TextRange was found"),!1;et.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode)e=H(this.anchorNode);else if(this.docSelection.type==P){var t=this.docSelection.createRange();t.length&&(e=H(t.item(0)))}if(e){var n=B(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(r){}a(this)},et.addRange=function(e){this.docSelection.type==P?v(this,e):(L.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,o(this,e,!1))},et.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?b(this,e):t&&this.addRange(e[0])}}et.getRangeAt=function(e){return this._ranges[e].cloneRange()};var nt;if(q)nt=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=B(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==P?d(t):h(n)?p(t,n):a(t)};else if(C(R,"getRangeAt")&&typeof R.rangeCount=="number")nt=function(t){if(K&&I&&t.docSelection.type==P)d(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));o(t,t._ranges[t.rangeCount-1],it(t.nativeSelection)),t.isCollapsed=_(t)}else a(t)}};else{if(!W||typeof R.isCollapsed!=x||typeof U.collapsed!=x||!D.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;nt=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=G(n,0),e._ranges=[t],e.rangeCount=1,u(e),e.isCollapsed=_(e)):a(e)}}et.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,r=this.anchorOffset;nt(this);if(e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=r)return!0;while(i--)if(!j(t[i],this._ranges[i]))return!0;return!1}};var rt=function(t,n){var r=t.getAllRanges();t.removeAllRanges();for(var i=0,s=r.length;i<s;++i)e.rangesEqual(n,r[i])||t.addRange(r[i]);t.rangeCount||a(t)};K?et.removeRange=function(e){if(this.docSelection.type==P){var t=this.docSelection.createRange(),n=c(e),r=H(t.item(0)),i=B(r).createControlRange(),s,o=!1;for(var u=0,a=t.length;u<a;++u)s=t.item(u),s!==n||o?i.add(t.item(u)):o=!0;i.select(),d(this)}else rt(this,e)}:et.removeRange=function(e){rt(this,e)};var it;!q&&W&&D.implementsDomRange?(it=function(e){var t=!1;return e.anchorNode&&(t=T.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1),t},et.isBackward=function(){return it(this)}):it=et.isBackward=function(){return!1},et.isBackwards=et.isBackward,et.toString=function(){var e=[];for(var t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},et.collapse=function(t,n){w(this,t);var r=e.createRange(t);r.collapseToPoint(t,n),this.setSingleRange(r),this.isCollapsed=!0},et.collapseToStart=function(){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},et.collapseToEnd=function(){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},et.selectAllChildren=function(t){w(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.removeAllRanges(),this.addRange(n)},et.deleteFromDocument=function(){if(K&&I&&this.docSelection.type==P){var e=this.docSelection.createRange(),t;while(e.length)t=e.item(0),e.remove(t),t.parentNode.removeChild(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var r=0,i=n.length;r<i;++r)n[r].deleteContents();this.addRange(n[i-1])}}},et.eachRange=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(e(this.getRangeAt(n)))return t},et.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},et.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},et.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(r){n.push(r[e].apply(r,t))}),n},et.setStart=E(!0),et.setEnd=E(!1),e.rangePrototype.select=function(e){Z(this.getDocument()).setSingleRange(this,e)},et.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&t.length==1?this.addRange(t[0],"backward"):this.setRanges(t)},et.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)},et.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},et.moveToBookmark=function(t){var n=[];for(var r=0,i,s;i=t.rangeBookmarks[r++];)s=e.createRange(this.win),s.moveToBookmark(i),n.push(s);t.backward?this.setSingleRange(n[0],"backward"):this.setRanges(n)},et.toHtml=function(){return this.callMethodOnEachRange("toHtml").join("")},et.getName=function(){return"WrappedSelection"},et.inspect=function(){return S(this)},et.detach=function(){y(this.win,"delete"),g(this)},m.detachAll=function(){y(null,"deleteAll")},m.inspect=S,m.isDirectionBackward=n,e.Selection=m,e.selectionPrototype=et,e.addCreateMissingNativeApiListener(function(e){typeof e.getSelection=="undefined"&&(e.getSelection=function(){return Z(e)}),e=null})}),rangy.createModule("TextRange",function(e,t){function n(e,t){function n(t,n,r){var i=e.slice(t,n),o={isWord:r,chars:i,toString:function(){return i.join("")}};for(var u=0,a=i.length;u<a;++u)i[u].token=o;s.push(o)}var r=e.join(""),i,s=[],o=0,u,a;while(i=t.wordRegex.exec(r)){u=i.index,a=u+i[0].length,u>o&&n(o,u,!1);if(t.includeTrailingSpace)while(Z.test(e[a]))++a;n(u,a,!0),o=a}return o<e.length&&n(o,e.length,!1),s}function r(e,t){if(!e)return t;var n={};return J(n,t),J(n,e),n}function i(e){var t,n;return e?(t=e.language||tt,n={},J(n,at[t]||at[tt]),J(n,e),n):at[tt]}function s(e){return r(e,ot)}function o(e){return r(e,ut)}function u(e,t){var n=pt(e,"display",t),r=e.tagName.toLowerCase();return n=="block"&&dt&&vt.hasOwnProperty(r)?vt[r]:n}function a(e){var t=d(e);for(var n=0,r=t.length;n<r;++n)if(t[n].nodeType==1&&u(t[n])=="none")return!0;return!1}function f(e){var t;return e.nodeType==3&&(t=e.parentNode)&&pt(t,"visibility")=="hidden"}function l(e){return e&&(e.nodeType==1&&!/^(inline(-block|-table)?|none)$/.test(u(e))||e.nodeType==9||e.nodeType==11)}function c(e){var t=e.lastChild;return t?c(t):e}function h(e){return V.isCharacterDataNode(e)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(e.nodeName)}function p(e){var t=[];while(e.parentNode)t.unshift(e.parentNode),e=e.parentNode;return t}function d(e){return p(e).concat([e])}function v(e){var t;return typeof (t=e.namespaceURI)==z||t===null||t=="http://www.w3.org/1999/xhtml"}function m(e,t){if(!e||e.nodeType!=1||!v(e))return!1;switch(typeof t){case"string":return e.tagName.toLowerCase()==t.toLowerCase();case"object":return(new RegExp("^("+t.join("|S")+")$","i")).test(e.tagName);default:return!0}}function g(e){while(e&&!e.nextSibling)e=e.parentNode;return e?e.nextSibling:null}function y(e,t){return!t&&e.hasChildNodes()?e.firstChild:g(e)}function b(e){var t=e.previousSibling;if(t){e=t;while(e.hasChildNodes())e=e.lastChild;return e}var n=e.parentNode;return n&&n.nodeType==1?n:null}function w(e){if(!e||e.nodeType!=3)return!1;var t=e.data;if(t==="")return!0;var n=e.parentNode;if(!n||n.nodeType!=1)return!1;var r=pt(e.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(t)&&/^(normal|nowrap)$/.test(r)||/^[\t\r ]+$/.test(t)&&r=="pre-line"}function E(e){if(e.data==="")return!0;if(!w(e))return!1;var t=e.parentNode;return t?a(e)?!0:!1:!0}function S(e){var t=e.nodeType;return t==7||t==8||a(e)||/^(script|style)$/i.test(e.nodeName)||f(e)||E(e)}function x(e,t){var n=e.nodeType;return n==7||n==8||n==1&&u(e,t)=="none"}function T(){this.store={}}function N(e,t,n){return function(r){var i=this.cache;if(i.hasOwnProperty(e))return mt++,i[e];gt++;var s=t.call(this,n?this[n]:this,r);return i[e]=s,s}}function C(e,t){this.node=e,this.session=t,this.cache=new T,this.positions=new T}function k(e,t){this.offset=t,this.nodeWrapper=e,this.node=e.node,this.session=e.session,this.cache=new T}function L(){return"[Position("+V.inspectNode(this.node)+":"+this.offset+")]"}function A(){return M(),kt=new Lt}function O(){return kt||A()}function M(){kt&&kt.detach(),kt=null}function _(e,n,r,i){function s(){var e=null,t=null;return n?(t=o,u||(o=o.previousVisible(),u=!o||r&&o.equals(r))):u||(t=o=o.nextVisible(),u=!o||r&&o.equals(r)),u&&(o=null),t}r&&(n?S(r.node)&&(r=e.previousVisible()):S(r.node)&&(r=r.nextVisible()));var o=e,u=!1,a,f=!1;return{next:function(){if(f)return f=!1,a;var e,t;while(e=s()){t=e.getCharacter(i);if(t)return a=e,e}return null},rewind:function(){if(!a)throw t.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");f=!0},dispose:function(){e=r=null}}}function D(e,t,n){function r(e){var t,n,r=[],i=e?s:o,u=!1,a=!1;while(t=i.next()){n=t.character;if(Y.test(n))a&&(a=!1,u=!0);else{if(u){i.rewind();break}a=!0}r.push(t)}return r}function i(e){var t=["["+e.length+"]"];for(var n=0;n<e.length;++n)t.push("(word: "+e[n]+", is word: "+e[n].isWord+")");return t}var s=_(e,!1,null,t),o=_(e,!0,null,t),u=n.tokenizer,a=r(!0),f=r(!1).reverse(),l=u(f.concat(a),n),c=a.length?l.slice(At(l,a[0].token)):[],h=f.length?l.slice(0,At(l,f.pop().token)+1):[];return{nextEndToken:function(){var e,t;while(c.length==1&&!(e=c[0]).isWord&&(t=r(!0)).length>0)c=u(e.chars.concat(t),n);return c.shift()},previousStartToken:function(){var e,t;while(h.length==1&&!(e=h[0]).isWord&&(t=r(!1)).length>0)h=u(t.reverse().concat(e.chars),n);return h.pop()},dispose:function(){s.dispose(),o.dispose(),c=h=null}}}function P(e,t,n,r,i){var s=0,o,u=e,a,f,l=Math.abs(n),c;if(n!==0){var h=n<0;switch(t){case W:a=_(e,h,null,r);while((o=a.next())&&s<l)++s,u=o;f=o,a.dispose();break;case X:var p=D(e,r,i),d=h?p.previousStartToken:p.nextEndToken;while((c=d())&&s<l)c.isWord&&(++s,u=h?c.chars[0]:c.chars[c.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+t+"' not implemented")}h?(u=u.previousVisible(),s=-s):u&&u.isLeadingSpace&&(t==X&&(a=_(e,!1,null,r),f=a.next(),a.dispose()),f&&(u=f.previousVisible()))}return{position:u,unitsMoved:s}}function H(e,t,n,r){var i=e.getRangeBoundaryPosition(t,!0),s=e.getRangeBoundaryPosition(t,!1),o=r?s:i,u=r?i:s;return _(o,!!r,u,n)}function B(e,t,n){var r=[],i=H(e,t,n),s;while(s=i.next())r.push(s);return i.dispose(),r}function j(t,n,r){var i=e.createRange(t.node);i.setStartAndEnd(t.node,t.offset,n.node,n.offset);var s=!i.expand("word",r);return i.detach(),s}function F(e,t,n,r,i){function s(e,t){var n=f[e].previousVisible(),r=f[t-1],s=!i.wholeWordsOnly||j(n,r,i.wordOptions);return{startPos:n,endPos:r,valid:s}}var o=nt(i.direction),u=_(e,o,e.session.getRangeBoundaryPosition(r,o),i),a="",f=[],l,c,h,p,d,v,m=null;while(l=u.next()){c=l.character,!n&&!i.caseSensitive&&(c=c.toLowerCase()),o?(f.unshift(l),a=c+a):(f.push(l),a+=c);if(n){d=t.exec(a);if(d)if(v){h=d.index,p=h+d[0].length;if(!o&&p<a.length||o&&h>0){m=s(h,p);break}}else v=!0}else if((h=a.indexOf(t))!=-1){m=s(h,h+t.length);break}}return v&&(m=s(h,p)),u.dispose(),m}function I(e){return function(){var t=!!kt,n=O(),r=[n].concat($.toArray(arguments)),i=e.apply(this,r);return t||M(),i}}function q(e,t){return I(function(n,o,u,a){typeof u=="undefined"&&(u=o,o=W),a=r(a,lt);var f=s(a.characterOptions),l=i(a.wordOptions),c=e;t&&(c=u>=0,this.collapse(!c));var h=P(n.getRangeBoundaryPosition(this,c),o,u,f,l),p=h.position;return this[c?"setStart":"setEnd"](p.node,p.offset),h.unitsMoved})}function R(e){return I(function(t,n){n=s(n);var r,i=H(t,this,n,!e),o=0;while((r=i.next())&&Y.test(r.character))++o;i.dispose();var u=o>0;return u&&this[e?"moveStart":"moveEnd"]("character",e?o:-o,{characterOptions:n}),u})}function U(e){return I(function(t,n){var r=!1;return this.changeEachRange(function(t){r=t[e](n)||r}),r})}e.requireModules(["WrappedSelection"]);var z="undefined",W="character",X="word",V=e.dom,$=e.util,J=$.extend,K=V.getBody,Q=/^[ \t\f\r\n]+$/,G=/^[ \t\f\r]+$/,Y=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,Z=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,et=/^[\n-\r\u0085\u2028\u2029]$/,tt="en",nt=e.Selection.isDirectionBackward,rt=!1,it=!1,st=!0;(function(){var t=document.createElement("div");t.contentEditable="true",t.innerHTML="<p>&nbsp; </p><p></p>";var n=K(document),r=t.firstChild,i=e.getSelection();n.appendChild(t),i.collapse(r.lastChild,2),i.setStart(r.firstChild,0),rt=(""+i).length==1,t.innerHTML="&nbsp; <br>",i.collapse(t,2),i.setStart(t.firstChild,0),it=(""+i).length==1,n.removeChild(t),i.removeAllRanges()})();var ot={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includePreLineTrailingSpace:!0},ut={includeBlockContentTrailingSpace:!st,includeSpaceBeforeBr:!it,includePreLineTrailingSpace:!0},at={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:n}},ft={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},lt={wordOptions:null,characterOptions:null},ct={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},ht={wordOptions:null,characterOptions:null,direction:"forward"},pt=V.getComputedStyleProperty,dt;(function(){var e=document.createElement("table"),t=K(document);t.appendChild(e),dt=pt(e,"display")=="block",t.removeChild(e)})(),e.features.tableCssDisplayBlock=dt;var vt={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};T.prototype={get:function(e){return this.store.hasOwnProperty(e)?this.store[e]:null},set:function(e,t){return this.store[e]=t}};var mt=0,gt=0;e.report=function(){console.log("Cached: "+mt+", uncached: "+gt)};var yt={getPosition:function(e){var t=this.positions;return t.get(e)||t.set(e,new k(this,e))},toString:function(){return"[NodeWrapper("+V.inspectNode(this.node)+")]"}};C.prototype=yt;var bt="EMPTY",wt="NON_SPACE",Et="UNCOLLAPSIBLE_SPACE",St="COLLAPSIBLE_SPACE",xt="TRAILING_SPACE_IN_BLOCK",Tt="TRAILING_SPACE_BEFORE_BR",Nt="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK";J(yt,{isCharacterDataNode:N("isCharacterDataNode",V.isCharacterDataNode,"node"),getNodeIndex:N("nodeIndex",V.getNodeIndex,"node"),getLength:N("nodeLength",V.getNodeLength,"node"),containsPositions:N("containsPositions",h,"node"),isWhitespace:N("isWhitespace",w,"node"),isCollapsedWhitespace:N("isCollapsedWhitespace",E,"node"),getComputedDisplay:N("computedDisplay",u,"node"),isCollapsed:N("collapsed",S,"node"),isIgnored:N("ignored",x,"node"),next:N("nextPos",y,"node"),previous:N("previous",b,"node"),getTextNodeInfo:N("textNodeInfo",function(e){var t=null,n=!1,r=pt(e.parentNode,"whiteSpace"),i=r=="pre-line";if(i)t=G,n=!0;else if(r=="normal"||r=="nowrap")t=Q,n=!0;return{node:e,text:e.data,spaceRegex:t,collapseSpaces:n,preLine:i}},"node"),hasInnerText:N("hasInnerText",function(e,t){var n=this.session,r=n.getPosition(e.parentNode,this.getNodeIndex()+1),i=n.getPosition(e,0),s=t?r:i,o=t?i:r;while(s!==o){s.prepopulateChar();if(s.isDefinitelyNonEmpty())return!0;s=t?s.previousVisible():s.nextVisible()}return!1},"node"),getTrailingSpace:N("trailingSpace",function(e){if(e.tagName.toLowerCase()=="br")return"";switch(this.getComputedDisplay()){case"inline":var t=e.lastChild;while(t){if(!x(t))return t.nodeType==1?this.session.getNodeWrapper(t).getTrailingSpace():"";t=t.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.hasInnerText(!0)?"\n":""}return""},"node"),getLeadingSpace:N("leadingSpace",function(e){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.hasInnerText(!1)?"\n":""}return""},"node")});var Ct={character:"",characterType:bt,isBr:!1,prepopulateChar:function(){var e=this;if(!e.prepopulatedChar){var t=e.node,n=e.offset,r="",i=bt,s=!1;if(n>0)if(t.nodeType==3){var o=t.data,u=o.charAt(n-1),a=e.nodeWrapper.getTextNodeInfo(),f=a.spaceRegex;a.collapseSpaces?f.test(u)?n>1&&f.test(o.charAt(n-2))||(a.preLine&&o.charAt(n)==="\n"?(r=" ",i=Nt):(r=" ",i=St)):(r=u,i=wt,s=!0):(r=u,i=Et,s=!0)}else{var l=t.childNodes[n-1];l&&l.nodeType==1&&!S(l)&&(l.tagName.toLowerCase()=="br"?(r="\n",e.isBr=!0,i=St,s=!1):e.checkForTrailingSpace=!0);if(!r){var c=t.childNodes[n];c&&c.nodeType==1&&!S(c)&&(e.checkForLeadingSpace=!0)}}e.prepopulatedChar=!0,e.character=r,e.characterType=i,e.isCharInvariant=s}},isDefinitelyNonEmpty:function(){var e=this.characterType;return e==wt||e==Et},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var e=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();e&&(this.isTrailingSpace=!0,this.character=e,this.characterType=St),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var t=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();t&&(this.isLeadingSpace=!0,this.character=t,this.characterType=St),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(e){var t=this,n;while(t=t.previousVisible()){n=t.getCharacter(e);if(n!=="")return t}return null},getCharacter:function(e){function t(){return a||(u=f.getPrecedingUncollapsedPosition(e),a=!0),u}this.resolveLeadingAndTrailingSpaces();if(this.isCharInvariant)return this.character;var n=["character",e.includeSpaceBeforeBr,e.includeBlockContentTrailingSpace,e.includePreLineTrailingSpace].join("_"),r=this.cache.get(n);if(r!==null)return r;var i="",s=this.characterType==St,o,u,a=!1,f=this;if(s){if(this.character!=" "||!!t()&&!u.isTrailingSpace&&u.character!="\n")if(this.character=="\n"&&this.isLeadingSpace)t()&&u.character!="\n"&&(i="\n");else{o=this.nextUncollapsed();if(o){o.isBr?this.type=Tt:o.isTrailingSpace&&o.character=="\n"&&(this.type=xt);if(o.character==="\n"){if(this.type!=Tt||!!e.includeSpaceBeforeBr)if(this.type!=xt||!o.isTrailingSpace||!!e.includeBlockContentTrailingSpace)if(this.type!=Nt||o.type!=wt||!!e.includePreLineTrailingSpace)this.character==="\n"?o.isTrailingSpace?this.isTrailingSpace||!this.isBr:i="\n":this.character===" "&&(i=" ")}else i=this.character}}}else this.character!=="\n"||!!(o=this.nextUncollapsed())&&!o.isTrailingSpace;return this.cache.set(n,i),i},equals:function(e){return!!e&&this.node===e.node&&this.offset===e.offset},inspect:L,toString:function(){return this.character}};k.prototype=Ct,J(Ct,{next:N("nextPos",function(e){var t=e.nodeWrapper,n=e.node,r=e.offset,i=t.session;if(!n)return null;var s,o,u;return r==t.getLength()?(s=n.parentNode,o=s?t.getNodeIndex()+1:0):t.isCharacterDataNode()?(s=n,o=r+1):(u=n.childNodes[r],i.getNodeWrapper(u).containsPositions()?(s=u,o=0):(s=n,o=r+1)),s?i.getPosition(s,o):null}),previous:N("previous",function(e){var t=e.nodeWrapper,n=e.node,r=e.offset,i=t.session,s,o,u;return r==0?(s=n.parentNode,o=s?t.getNodeIndex():0):t.isCharacterDataNode()?(s=n,o=r-1):(u=n.childNodes[r-1],i.getNodeWrapper(u).containsPositions()?(s=u,o=V.getNodeLength(u)):(s=n,o=r-1)),s?i.getPosition(s,o):null}),nextVisible:N("nextVisible",function(e){var t=e.next();if(!t)return null;var n=t.nodeWrapper,r=t.node,i=t;return n.isCollapsed()&&(i=n.session.getPosition(r.parentNode,n.getNodeIndex()+1)),i}),nextUncollapsed:N("nextUncollapsed",function(e){var t=e;while(t=t.nextVisible()){t.resolveLeadingAndTrailingSpaces();if(t.character!=="")return t}return null}),previousVisible:N("previousVisible",function(e){var t=e.previous();if(!t)return null;var n=t.nodeWrapper,r=t.node,i=t;return n.isCollapsed()&&(i=n.session.getPosition(r.parentNode,n.getNodeIndex())),i})});var kt=null,Lt=function(){function e(e){var t=new T;return{get:function(n){var r=t.get(n[e]);if(r)for(var i=0,s;s=r[i++];)if(s.node===n)return s;return null},set:function(n){var r=n.node[e],i=t.get(r)||t.set(r,[]);i.push(n)}}}function t(){this.initCaches()}var n=$.isHostProperty(document.documentElement,"uniqueID");return t.prototype={initCaches:function(){this.elementCache=n?function(){var e=new T;return{get:function(t){return e.get(t.uniqueID)},set:function(t){e.set(t.node.uniqueID,t)}}}():e("tagName"),this.textNodeCache=e("data"),this.otherNodeCache=e("nodeName")},getNodeWrapper:function(e){var t;switch(e.nodeType){case 1:t=this.elementCache;break;case 3:t=this.textNodeCache;break;default:t=this.otherNodeCache}var n=t.get(e);return n||(n=new C(e,this),t.set(n)),n},getPosition:function(e,t){return this.getNodeWrapper(e).getPosition(t)},getRangeBoundaryPosition:function(e,t){var n=t?"start":"end";return this.getPosition(e[n+"Container"],e[n+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},t}();J(V,{nextNode:y,previousNode:b});var At=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1};J(e.rangePrototype,{moveStart:q(!0,!1),moveEnd:q(!1,!1),move:q(!0,!0),trimStart:R(!0),trimEnd:R(!1),trim:I(function(e,t){var n=this.trimStart(t),r=this.trimEnd(t);return n||r}),expand:I(function(e,t,n){var o=!1;n=r(n,ct);var u=s(n.characterOptions);t||(t=W);if(t==X){var a=i(n.wordOptions),f=e.getRangeBoundaryPosition(this,!0),l=e.getRangeBoundaryPosition(this,!1),c=D(f,u,a),h=c.nextEndToken(),p=h.chars[0].previousVisible(),d,v;if(this.collapsed)d=h;else{var m=D(l,u,a);d=m.previousStartToken()}return v=d.chars[d.chars.length-1],p.equals(f)||(this.setStart(p.node,p.offset),o=!0),v&&!v.equals(l)&&(this.setEnd(v.node,v.offset),o=!0),n.trim&&(n.trimStart&&(o=this.trimStart(u)||o),n.trimEnd&&(o=this.trimEnd(u)||o)),o}return this.moveEnd(W,1,n)}),text:I(function(e,t){return this.collapsed?"":B(e,this,s(t)).join("")}),selectCharacters:I(function(e,t,n,r,i){var s={characterOptions:i};t||(t=K(this.getDocument())),this.selectNodeContents(t),this.collapse(!0),this.moveStart("character",n,s),this.collapse(!0),this.moveEnd("character",r-n,s)}),toCharacterRange:I(function(e,t,n){t||(t=K(this.getDocument()));var r=t.parentNode,i=V.getNodeIndex(t),s=V.comparePoints(this.startContainer,this.endContainer,r,i)==-1,o=this.cloneRange(),u,a;return s?(o.setStartAndEnd(this.startContainer,this.startOffset,r,i),u=-o.text(n).length):(o.setStartAndEnd(r,i,this.startContainer,this.startOffset),u=o.text(n).length),a=u+this.text(n).length,{start:u,end:a}}),findText:I(function(t,n,s){s=r(s,ft),s.wholeWordsOnly&&(s.wordOptions=i(s.wordOptions),s.wordOptions.includeTrailingSpace=!1);var o=nt(s.direction),u=s.withinRange;u||(u=e.createRange(),u.selectNodeContents(this.getDocument()));var a=n,f=!1;typeof a=="string"?s.caseSensitive||(a=a.toLowerCase()):f=!0;var l=t.getRangeBoundaryPosition(this,!o),c=u.comparePoint(l.node,l.offset);c===-1?l=t.getRangeBoundaryPosition(u,!0):c===1&&(l=t.getRangeBoundaryPosition(u,!1));var h=l,p=!1,d;for(;;){d=F(h,a,f,u,s);if(d){if(d.valid)return this.setStartAndEnd(d.startPos.node,d.startPos.offset,d.endPos.node,d.endPos.offset),!0;h=o?d.startPos:d.endPos}else{if(!s.wrap||!!p)return!1;u=u.cloneRange(),h=t.getRangeBoundaryPosition(u,!o),u.setBoundary(l.node,l.offset,o),p=!0}}}),pasteHtml:function(e){this.deleteContents();if(e){var t=this.createContextualFragment(e),n=t.lastChild;this.insertNode(t),this.collapseAfter(n)}}}),J(e.selectionPrototype,{expand:I(function(e,t,n){this.changeEachRange(function(e){e.expand(t,n)})}),move:I(function(e,t,n,r){var i=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var s=this.getRangeAt(0);r||(r={}),r.characterOptions=o(r.characterOptions),i=s.move(t,n,r),this.setSingleRange(s)}return i}),trimStart:U("trimStart"),trimEnd:U("trimEnd"),trim:U("trim"),selectCharacters:I(function(t,n,r,i,s,o){var u=e.createRange(n);u.selectCharacters(n,r,i,o),this.setSingleRange(u,s)}),saveCharacterRanges:I(function(e,t,n){var r=this.getAllRanges(),i=r.length,s=[],o=i==1&&this.isBackward();for(var u=0,a=r.length;u<a;++u)s[u]={characterRange:r[u].toCharacterRange(t,n),backward:o,characterOptions:n};return s}),restoreCharacterRanges:I(function(t,n,r){this.removeAllRanges();for(var i=0,s=r.length,o,u,a;i<s;++i)u=r[i],a=u.characterRange,o=e.createRange(n),o.selectCharacters(n,a.start,a.end,u.characterOptions),this.addRange(o,u.backward)}),text:I(function(e,t){var n=[];for(var r=0,i=this.rangeCount;r<i;++r)n[r]=this.getRangeAt(r).text(t);return n.join("")})}),e.innerText=function(t,n){var r=e.createRange(t);r.selectNodeContents(t);var i=r.text(n);return r.detach(),i},e.createWordIterator=function(e,t,n){var o=O();n=r(n,ht);var u=s(n.characterOptions),a=i(n.wordOptions),f=o.getPosition(e,t),l=D(f,u,a),c=nt(n.direction);return{next:function(){return c?l.previousStartToken():l.nextEndToken()},dispose:function(){l.dispose(),this.next=function(){}}}},e.noMutation=function(e){var t=O();e(t),M()},e.noMutation.createEntryPointFunction=I,e.textRange={isBlockNode:l,isCollapsedWhitespaceNode:E,createPosition:I(function(e,t,n){return e.getPosition(t,n)})}}),rangy.createModule("CssClassApplier",function(e,t){function n(e,t){return e.className&&RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e.className)}function r(e,t){e.className?n(e,t)||(e.className+=" "+t):e.className=t}function i(e){return e.split(/\s+/).sort().join(" ")}function s(e,t){return i(e.className)==i(t.className)}function o(e){for(var t=e.parentNode;e.hasChildNodes();)t.insertBefore(e.firstChild,e);t.removeChild(e)}function u(e,t){var n=e.cloneRange();n.selectNodeContents(t);var r=n.intersection(e);return r=r?r.toString():"",n.detach(),r!=""}function a(e){return e.getNodes([3],function(t){return u(e,t)})}function f(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n=0,r=e.attributes.length,i,s;n<r;++n){i=e.attributes[n],s=i.name;if(s!="class"){s=t.attributes.getNamedItem(s);if(i.specified!=s.specified)return!1;if(i.specified&&i.nodeValue!==s.nodeValue)return!1}}return!0}function l(e,t){for(var n=0,r=e.attributes.length,i;n<r;++n){i=e.attributes[n].name;if((!t||!b.arrayContains(t,i))&&e.attributes[n].specified&&i!="class")return!0}return!1}function c(e){var t;return e&&e.nodeType==1&&((t=e.parentNode)&&t.nodeType==9&&t.designMode=="on"||S(e)&&!S(e.parentNode))}function h(e){return(S(e)||e.nodeType!=1&&S(e.parentNode))&&!c(e)}function p(e){return e&&e.nodeType==1&&!x.test(E(e,"display"))}function d(e){if(e.data.length==0)return!0;if(T.test(e.data))return!1;switch(E(e.parentNode,"whiteSpace")){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return p(e.previousSibling)||p(e.nextSibling)}function v(e,n,r,i){var s,o=r==0;if(b.isAncestorOf(n,e))return e;if(b.isCharacterDataNode(n))if(r==0)r=b.getNodeIndex(n),n=n.parentNode;else{if(r!=n.length)throw t.createError("splitNodeAt should not be called with offset in the middle of a data node ("+r+" in "+n.data);r=b.getNodeIndex(n)+1,n=n.parentNode}var u;u=n;var a=r;u=b.isCharacterDataNode(u)?a==0?!!u.previousSibling:a==u.length?!!u.nextSibling:!0:a>0&&a<u.childNodes.length;if(u){if(!s){s=n.cloneNode(!1);for(s.id&&s.removeAttribute("id");o=n.childNodes[r];)s.appendChild(o);b.insertAfter(s,n)}return n==e?s:v(e,s.parentNode,b.getNodeIndex(s),i)}return e!=n?(s=n.parentNode,n=b.getNodeIndex(n),o||n++,v(e,s,n,i)):e}function m(e){var t=e?"nextSibling":"previousSibling";return function(n,r){var i=n.parentNode,o=n[t];if(o){if(o&&o.nodeType==3)return o}else if(r&&(o=i[t])&&o.nodeType==1&&i.tagName==o.tagName&&s(i,o)&&f(i,o))return o[e?"firstChild":"lastChild"];return null}}function g(e){this.firstTextNode=(this.isElementMerge=e.nodeType==1)?e.lastChild:e,this.textNodes=[this.firstTextNode]}function y(e,t,n){this.cssClass=e;var r,s,o=null;if(typeof t=="object"&&t!==null){n=t.tagNames,o=t.elementProperties;for(r=0;s=k[r++];)t.hasOwnProperty(s)&&(this[s]=t[s]);r=t.normalize}else r=t;this.normalize=typeof r=="undefined"?!0:r,this.attrExceptions=[],r=document.createElement(this.elementTagName),this.elementProperties={};for(var u in o)o.hasOwnProperty(u)&&(L.hasOwnProperty(u)&&(u=L[u]),r[u]=o[u],this.elementProperties[u]=r[u],this.attrExceptions.push(u));this.elementSortedClassName=this.elementProperties.hasOwnProperty("className")?i(this.elementProperties.className+" "+e):e,this.applyToAnyTagName=!1,e=typeof n;if(e=="string")n=="*"?this.applyToAnyTagName=!0:this.tagNames=n.toLowerCase().replace(/^\s\s*/,"").replace(/\s\s*$/,"").split(/\s*,\s*/);else if(e=="object"&&typeof n.length=="number"){this.tagNames=[],r=0;for(e=n.length;r<e;++r)n[r]=="*"?this.applyToAnyTagName=!0:this.tagNames.push(n[r].toLowerCase())}else this.tagNames=[this.elementTagName]}e.requireModules(["WrappedSelection","WrappedRange"]);var b=e.dom,w=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){t.className&&(t.className=t.className.replace(RegExp("(?:^|\\s)"+n+"(?:\\s|$)"),e))}}(),E;typeof window.getComputedStyle!="undefined"?E=function(e,t){return b.getWindow(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!="undefined"?E=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found");var S;(function(){S=typeof document.createElement("div").isContentEditable=="boolean"?function(e){return e&&e.nodeType==1&&e.isContentEditable}:function(e){return!e||e.nodeType!=1||e.contentEditable=="false"?!1:e.contentEditable=="true"||S(e.parentNode)}})();var x=/^inline(-block|-table)?$/i,T=/[^\r\n\t\f \u200B]/,N=m(!1),C=m(!0);g.prototype={doMerge:function(){for(var e=[],t,n,r=0,i=this.textNodes.length;r<i;++r)t=this.textNodes[r],n=t.parentNode,e[r]=t.data,r&&(n.removeChild(t),n.hasChildNodes()||n.parentNode.removeChild(n));return this.firstTextNode.data=e=e.join("")},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;t<n;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}};var k=["elementTagName","ignoreWhiteSpace","applyToEditableOnly"],L={"class":"className"};y.prototype={elementTagName:"span",elementProperties:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,hasClass:function(e){return e.nodeType==1&&b.arrayContains(this.tagNames,e.tagName.toLowerCase())&&n(e,this.cssClass)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e,this.cssClass))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||h(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&e.nodeType==3&&d(e)},postApply:function(e,t,n){for(var r=e[0],i=e[e.length-1],s=[],o,u=r,a=i,f=0,l=i.length,c,h,p=0,d=e.length;p<d;++p)c=e[p],(h=N(c,!n))?(o||(o=new g(h),s.push(o)),o.textNodes.push(c),c===r&&(u=o.firstTextNode,f=u.length),c===i&&(a=o.firstTextNode,l=o.getLength())):o=null;if(e=C(i,!n))o||(o=new g(i),s.push(o)),o.textNodes.push(e);if(s.length){p=0;for(d=s.length;p<d;++p)s[p].doMerge();t.setStart(u,f),t.setEnd(a,l)}},createContainer:function(t){return t=t.createElement(this.elementTagName),e.util.extend(t,this.elementProperties),r(t,this.cssClass),t},applyToTextNode:function(e){var t=e.parentNode;t.childNodes.length==1&&b.arrayContains(this.tagNames,t.tagName.toLowerCase())?r(t,this.cssClass):(t=this.createContainer(b.getDocument(e)),e.parentNode.insertBefore(t,e),t.appendChild(e))},isRemovable:function(e){var t;if(t=e.tagName.toLowerCase()==this.elementTagName){if(t=i(e.className)==this.elementSortedClassName){var n;e:{t=this.elementProperties;for(n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n]){n=!1;break e}n=!0}t=n&&!l(e,this.attrExceptions)&&this.isModifiable(e)}t=t}return t},undoToTextNode:function(e,t,n){t.containsNode(n)||(e=t.cloneRange(),e.selectNode(n),e.isPointInRange(t.endContainer,t.endOffset)&&(v(n,t.endContainer,t.endOffset,[t]),t.setEndAfter(n)),e.isPointInRange(t.startContainer,t.startOffset)&&(n=v(n,t.startContainer,t.startOffset,[t]))),this.isRemovable(n)?o(n):w(n,this.cssClass)},applyToRange:function(e){e.splitBoundaries();var t=a(e);if(t.length){for(var n,r=0,i=t.length;r<i;++r)n=t[r],!this.isIgnorableWhiteSpaceNode(n)&&!this.getSelfOrAncestorWithClass(n)&&this.isModifiable(n)&&this.applyToTextNode(n);e.setStart(t[0],0),n=t[t.length-1],e.setEnd(n,n.length),this.normalize&&this.postApply(t,e,!1)}},applyToSelection:function(t){t=t||window,t=e.getSelection(t);var n,r=t.getAllRanges();t.removeAllRanges();for(var i=r.length;i--;)n=r[i],this.applyToRange(n),t.addRange(n)},undoToRange:function(e){e.splitBoundaries();var t=a(e),n,r,i=t[t.length-1];if(t.length){for(var s=0,o=t.length;s<o;++s)n=t[s],(r=this.getSelfOrAncestorWithClass(n))&&this.isModifiable(n)&&this.undoToTextNode(n,e,r),e.setStart(t[0],0),e.setEnd(i,i.length);this.normalize&&this.postApply(t,e,!0)}},undoToSelection:function(t){t=t||window,t=e.getSelection(t);var n=t.getAllRanges(),r;t.removeAllRanges();for(var i=0,s=n.length;i<s;++i)r=n[i],this.undoToRange(r),t.addRange(r)},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var r=n.intersection(t);return r=r?r.toString():"",n.detach(),r},isAppliedToRange:function(e){if(e.collapsed)return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);for(var t=e.getNodes([3]),n=0,r;r=t[n++];)if(!this.isIgnorableWhiteSpaceNode(r)&&u(e,r)&&this.isModifiable(r)&&!this.getSelfOrAncestorWithClass(r))return!1;return!0},isAppliedToSelection:function(t){t=t||window,t=e.getSelection(t).getAllRanges();for(var n=t.length;n--;)if(!this.isAppliedToRange(t[n]))return!1;return!0},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},detach:function(){}},y.util={hasClass:n,addClass:r,removeClass:w,hasSameClasses:s,replaceWithOwnChildren:o,elementsHaveSameNonClassAttributes:f,elementHasNonClassAttributes:l,splitNodeAt:v,isEditableElement:S,isEditingHost:c,isEditable:h},e.CssClassApplier=y,e.createCssClassApplier=function(e,t,n){return new y(e,t,n)}}),rangy.createModule("Commands",function(e,t){function n(e){return e&&1==e.nodeType&&e.isContentEditable}function r(e,t){var r;return!(r=!t||!t.applyToEditableOnly)&&(r=n(e)||n(e.parentNode))&&(r=!e||!(9==e.nodeType&&"on"==e.designMode||n(e)&&!n(e.parentNode))),r}function i(e,t){var n=A.comparePoints(e,0,t.startContainer,t.startOffset),r=A.comparePoints(e,A.getNodeLength(e),t.endContainer,t.endOffset);return O(e)==O(t.startContainer)&&1==n&&-1==r}function s(e,t){if(i(e,t))return!0;var n=A.isCharacterDataNode(e);if(e==t.startContainer&&n&&A.getNodeLength(e)!=t.startOffset||e==t.endContainer&&n&&0!=t.endOffset)return!0;var n=e.childNodes,r=n.length;if(0!=r){for(var o=0;o<r;++o)if(!s(n[o],t))return!1;return!0}return!1}function o(e){var t;return"undefined"==typeof (t=e.namespaceURI)||null===t||"http://www.w3.org/1999/xhtml"==t}function u(e){return A.isCharacterDataNode(e)||1==e.nodeType&&P.test(M(e,"display"))}function a(e){return u(e)&&"br"!=e.nodeName.toLowerCase()}function f(e,t){if(!e||1!=e.nodeType||!o(e))return!1;switch(typeof t){case"string":return e.tagName.toLowerCase()==t.toLowerCase();case"object":return(new RegExp("^("+t.join(",")+")$","i")).test(e.tagName);default:return!0}}function l(e,t){return f(e)?u(e)&&r(e,t)?D.test(e.tagName):!0:!1}function c(e,t){return 8==e.nodeType||3==e.nodeType&&(e.parentNode&&/^(script|style)$/i.test(e.parentNode.tagName)||t.ignoreWhiteSpace&&!/[^\r\n\t ]/.test(e.data)&&(l(e.previousSibling,t)||l(e.nextSibling,t)))?!0:!1}function h(e,t){if(!f(e))return!1;if(t&&t.command.isModifiableElement)return t.command.isModifiableElement(el,t);var n=e.tagName.toLowerCase();if(H.test(n))n=["style","class"];else if("a"==n)n=["style","class","href"];else{if("font"!=n)return!1;n=["style","class","color","face","size"]}e:{for(var r=0,i=e.attributes.length,s;r<i;++r)if(s=e.attributes[r].name,e.attributes[r].specified&&(!n||!A.arrayContains(n,s))){n=!1;break e}n=!0}return n}function p(e,t){if(!f(e))return!1;if(t&&t.command.isSimpleModifiableElement)return t.command.isSimpleModifiableElement(e,t);var n=e.tagName.toLowerCase();if(!B.test(n))return!1;for(var r,i=!1,s=0,o=e.attributes.length;s<o;++s)if(e.attributes[s].specified){if(i)return!1;r=e.attributes[s].name,e.getAttribute(r),i=!0}return!i||"style"==r&&0==e.style.cssText.length||"a"==n&&"href"==r||"font"==n&&/^(color|face|size)$/.test(r)?!0:"style"!=r||"number"==typeof e.style.length&&1<e.style.length||!/^[a-z\-]+:[^;]+;?\s?$/i.test(e.style.cssText)?!1:("b"==n||"strong"==n)&&""!=e.style.fontWeight||("i"==n||"em"==n)&&""!=e.style.fontStyle||("sub"==n||"sup"==n)&&""!=e.style.verticalAlign||("span"==n||"font"==n)&&""!=e.style.fontSize||("a"==n||"font"==n||"span"==n)&&""==e.style.textDecoration||("h1"==n||"h2"==n||"h3"==n||"p"==n||"td"==n)&&""!=e.style.textAlign||/^(a|font|s|span|strike|u|del)$/.test(n)&&/^(line-through|underline|overline|none)$/.test(e.style.textDecoration)?!0:!1}function d(e,t,n,r){-1==n&&(n=t.childNodes.length);for(var i=e.parentNode,s=A.getNodeIndex(e),o=[],u=0,a=r.length;u<a;++u){var f=r[u],l=f.startContainer,c=f.startOffset,h=f.endContainer,p=f.endOffset,d=l,v=c,m=h,g=p;l==t&&c>n&&v++,h==t&&p>n&&g++,l!=i||c!=s&&c!=s+1||(d=t,v+=n-s),h!=i||p!=s&&p!=s+1||(m=t,g+=n-s),l==i&&c>s+1&&v--,h==i&&p>s+1&&g--,d==l&&v==c&&m==h&&g==p&&o.push([f,d,v,m,g])}t.childNodes.length==n?t.appendChild(e):t.insertBefore(e,t.childNodes[n]);for(e=0;t=o[e++];){try{t[0].setStart(t[1],t[2])}catch(y){}try{t[0].setEnd(t[3],t[4])}catch(b){}}}function v(e,t){t=t||[];for(var n;n=e.next();)e.isPartiallySelectedSubtree()?(n=e.getSubtreeIterator(),v(n,t),n.detach(!0)):t.push(n);return t}function m(e,t,n,r,i){for(var s,o=[];s=e.firstChild;)d(s,t,n++,i),o.push(s);return r&&e.parentNode.removeChild(e),o}function g(e,t){return m(e,e.parentNode,A.getNodeIndex(e),!0,t)}function y(e,t){for(var n=e.attributes,r=0,i=n.length;r<i;++r)n[r].specified&&("style"==n[r].name?t.style.cssText=t.style.cssText:t.setAttribute(n[r].name,n[r].value))}function b(e,t){var n=t.command,r=t.rangesToPreserve;return null===n.getSpecifiedValue(e,t)?[]:p(e,t)?g(e,r):(n.clearValue&&n.clearValue(e,t),null!==n.relevantCssProperty&&(e.style[n.relevantCssProperty]="",""==e.style.cssText&&e.removeAttribute("style")),null===n.getSpecifiedValue(e,t)?[]:(n=A.getDocument(e).createElement("span"),y(e,n),e.parentNode.insertBefore(n,e),m(e,n,0,!0,r),[n]))}function w(e,t,n){return null===t||null===n?t===n:e.valuesEqual(t,n)}function E(e,t){var n=1==e.nodeType;return n||e.parentNode&&1==e.parentNode.nodeType?n?t.command.getEffectiveValue(e,t):E(e.parentNode,t):null}function S(e,t,n,i){var s=e[0],o=i.options;i=i.rangesToPreserve;var a,l;if(!e.length||!r(s,o))return null;var c=e[e.length-1];u(c)&&!f(c,"br")&&f(c.nextSibling,"br")&&e.push(c.nextSibling);var h=s.previousSibling,p=c.nextSibling;n=r(h,o)&&t(h)?h:r(p,o)&&t(p)?p:n();if(!n)return null;var h=A.getDocument(n),v=n.parentNode,p=s.parentNode;if(!v)for(p.insertBefore(n,s),a=0;l=i[a++];)l.startContainer==v&&l.startOffset==A.getNodeIndex(n)&&l.setStart(l.startContainer,l.startOffset+1),l.endContainer==v&&l.endOffset==A.getNodeIndex(n)&&l.setEnd(l.endContainer,l.endOffset+1);a=n.parentNode,l=s.parentNode,a=a&&l?-1==A.comparePoints(n.parentNode,A.getNodeIndex(n),s.parentNode,A.getNodeIndex(s)):!a;if(a)for(!u(n)&&u(n.lastChild)&&u(s)&&!f(n.lastChild,"br")&&n.appendChild(h.createElement("br")),a=0,s=e.length;a<s;++a)d(e[a],n,-1,i);else for(!u(n)&&u(n.firstChild)&&u(c)&&!f(c,"br")&&n.insertBefore(h.createElement("br"),n.firstChild),a=e.length-1;0<=a;a--)d(e[a],n,0,i);r(p,o)&&!p.hasChildNodes()&&p.parentNode.removeChild(p),e=n.nextSibling;if(r(e,o)&&t(e)){for(!u(n)&&u(n.lastChild)&&u(e.firstChild)&&!f(n.lastChild,"br")&&n.appendChild(h.createElement("br"));e.hasChildNodes();)d(e.firstChild,n,-1,i);n.parentNode.removeChild(e)}if(n&&1==n.nodeType&&!u(n)){t=n.previousSibling;var m;f(t,"br")&&u(m=n.previousSibling.previousSibling)&&!f(m,"br")&&n.parentNode.removeChild(t)}if(n&&1==n.nodeType&&!u(n)){m=n.lastChild;var g;2<=n.childNodes.length&&f(n.lastChild,"br")&&u(g=n.lastChild.previousSibling)&&!f(g,"br")&&n.removeChild(m)}return n}function x(e,t,n,r,i){for(var s=e[i],o=r.rangesToPreserve;h(s,r)&&1==s.childNodes.length&&h(s.firstChild,r)&&(!p(s,r)||!w(t,t.getSpecifiedValue(s,r),n));)s=s.firstChild;p(s,r)&&w(t,t.getSpecifiedValue(s,r),n)&&w(t,E(s,r),n)&&s!=e[i]&&(m(s,s.parentNode,A.getNodeIndex(s),!1,o),e.parentNode.insertBefore(s,e[i]),d(s.nextSibling,s,s.childNodes.length,o))}function T(e,t,n){if(-1==",br,".indexOf(","+e.nodeName.toLowerCase()+",")){var r,i,s,o;o=e.nodeType;var u=n.command;r=n.rangesToPreserve,i=n.options;if(e.parentNode&&null!==t){/^(1|3|4|7)$/.test(""+o)&&!l(e,i)&&(x(e,u,t,n,"previousSibling"),x(e,u,t,n,"nextSibling"),S([e],function(e){return p(e,n)&&w(u,u.getSpecifiedValue(e,n),t)&&w(u,E(e,n),t)},function(){return null},n));var a=!1;try{if(s=!1,"fontSize"==u.relevantCssProperty&&(s=!0),0==s&&DEXTTOP.DEXT5.browser.ie&&"fontFamily"==u.relevantCssProperty&&(s=!0),s&&w(u,E(e,n),t)){s=!1;for(var f=e;;)if(3==f.nodeType)f=f.parentNode;else{if(1!=f.nodeType)break;if(""!=f.style[u.relevantCssProperty]){s=!0;break}if(f.tagName&&"BODY"==f.tagName)break;f=f.parentNode}a=1==s?!1:!0}}catch(c){a=!1}if(a||!w(u,E(e,n),t))if(l(e,i)){if("colgroup"!=e.tagName.toLowerCase()){o=[],i=0,s=e.childNodes.length;for(f=null;i<s;++i){r=e.childNodes[i];if(1==r.nodeType&&(f=u.getSpecifiedValue(r,n),null!==f&&(a||!w(u,t,f))))continue;o.push(r)}"1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag&&1>=e.childNodes.length&&(""==e.innerHTML||"<br>"==e.innerHTML)&&("<br>"==e.innerHTML?DEXTTOP.DEXT5.browser.safari||"windows"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()?e.childNodes[0]||(a=document.createElement("br"),e.appendChild(a)):(a=document.createTextNode("\u200b"),e.childNodes[0]?(r=e.childNodes[0],e.insertBefore(a,r),e.removeChild(r)):e.appendChild(a)):(a=document.createTextNode("\u200b"),e.appendChild(a)),o.push(e.childNodes[0]));for(i=0;r=o[i++];)T(r,t,n)}}else if(4!=o&&7!=o&&(a||!w(u,E(e,n),t)))if(s=null,1==o&&"span"==e.nodeName.toLowerCase()&&u.relevantCssProperty&&-1<",color,backgroundColor,fontFamily,fontSize,".indexOf(","+u.relevantCssProperty+","))e.style[u.relevantCssProperty]=t;else if(!i.styleWithCss&&u.createNonCssElement&&(s=u.createNonCssElement(e,t,n)),s||(s=u.createCssElement?u.createCssElement(A.getDocument(e),n):A.getDocument(e).createElement("span")),e.parentNode.insertBefore(s,e),i=u.relevantCssProperty,null===i||!a&&w(u,E(s,n),t)||(s.style[i]=t),u.styleCssElement&&u.styleCssElement(s,t),d(e,s,s.childNodes.length,r),1==o&&(a||!w(u,E(e,n),t)))if(d(e,s.parentNode,A.getNodeIndex(s),r),s.parentNode.removeChild(s),"span"==s.tagName.toLowerCase()&&(u.hasSpecialSpanStyling&&u.hasSpecialSpanStyling(t)||null!==i))null!==i&&(e.style[i]=t),u.styleSpanChildElement&&u.styleSpanChildElement(e,t);else{o=[],i=0;for(s=e.childNodes.length;i<s;++i){r=e.childNodes[i];if(1==r.nodeType&&(f=u.getSpecifiedValue(r,n),null!==f&&(a||!w(u,t,f))))continue;o.push(r)}i=0;for(s=o.length;i<s;++i)T(o[i],t,n)}}}}function N(e,t){for(var n=_(e.childNodes),r=0,i=n.length;r<i;++r)C(n[r],t)}function C(e,t){var n,i;n=e.nodeType;if(9==n){for(n=0;n<e.childNodes.length;++n)if(i=e.childNodes[n],1==i.nodeType){C(i,t);break}}else if(11==n)N(e,t);else if(e.parentNode&&10!=n&&!c(e,t.options)){if(r(e,t.options)){if(1==n){var s=b(e,t);n=0;for(i=s.length;n<i;++n)C(s[n],t);if(!e.parentNode)return}n=t.command;var o=t.value,s=t.options;if((i=e.parentNode)&&1==i.nodeType&&!w(n,E(e,t),o)){var u=i;for(i=[];r(u,s)&&1==u.nodeType&&!w(n,E(u,t),o);)i.push(u),u=u.parentNode;if(0!=i.length){var s=i[i.length-1],a=n.getSpecifiedValue(s,t);if(null!==a||a==o)if(null===o||w(n,E(s.parentNode,t),o))for(;i.length;){u=i.pop(),null!==n.getSpecifiedValue(u,t)&&(a=n.getSpecifiedValue(u,t)),o=_(u.childNodes),null!==n.getSpecifiedValue(u,t)&&b(u,t);for(var u=0,f;f=o[u++];)f!=e&&(1!=f.nodeType||null===n.getSpecifiedValue(f,t)||w(n,a,n.getSpecifiedValue(f,t)))&&f!=s&&T(f,a,t)}}}T(e,t.value,t)}N(e,t)}}function k(){}function L(e){var n=e.toLowerCase();if(j.hasOwnProperty(n))return j[n];throw t.createError("getCommand(): No command registered with the name '"+e+"'")}e.requireModules(["WrappedSelection","WrappedRange"]);var A=e.dom,O=A.getRootContainer,M;"undefined"!=typeof window.getComputedStyle?M=function(e,t){var n=A.getWindow(e).getComputedStyle(e,null)[t];if("fontSize"==t)try{-1<n.indexOf("px")&&"undefined"!=typeof document.documentElement.currentStyle?n=e.currentStyle[t]:e.style&&e.style.fontSize&&-1<e.style.fontSize.indexOf("pt")&&(n=e.style.fontSize)}catch(r){}else if("backgroundColor"==t&&"transparent"==n&&e.parentNode)try{if(1!=e.nodeType||"html"!=e.nodeName.toLowerCase()&&"body"!=e.nodeName.toLowerCase())n=A.getWindow(e.parentNode).getComputedStyle(e.parentNode,null)[t]}catch(i){}return n}:"undefined"!=typeof document.documentElement.currentStyle?M=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found");var _;(function(){var e=document.createElement("div");e.appendChild(document.createElement("span"));var t=Array.prototype.slice;try{1==t.call(e.childNodes,0)[0].nodeType&&(_=function(e){return t.call(e,0)})}catch(n){}_||(_=function(e){for(var t=0,n=e.length,r=[];t<n;++t)r[t]=e[t];return r})})();var D=/^(h[1-6]|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/i,P=/^inline(-block|-table)?$/i,H=/^(b|em|i|s|span|strike|strong|sub|sup|u|del)$/,B=/^(b|em|i|s|span|strike|strong|sub|sup|u|del|a|font|h1|h2|h3|h4|h5|h6|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/;k.prototype={relevantCssProperty:null,getSpecifiedValue:function(){return null},clearValue:function(){},getEffectiveValue:function(e,t){return M(e,this.relevantCssProperty)},createCssElement:null,createNonCssElement:null,styleCssElement:null,hasSpecialSpanStyling:null,styleSpanChildElement:null,isSimpleModifiableElement:null,defaultOptions:null,addDefaultOptions:null,valuesEqual:function(e,t){return e===t},createContext:function(e,t,n){var r=this.defaultOptions;if(r)for(var i in r)r.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=r[i]);return{command:this,value:e,rangesToPreserve:t||[],options:n||{}}},getSelectionValue:function(){return null},getNewRangeValue:function(){return null},getNewSelectionValue:function(){return null},applyToRange:function(e,t,n,r){e=this.createContext(t,[r],n),e.value=this.getNewRangeValue(r,e),this.applyValueToRange(r,e)},applyToSelection:function(t,n,r){t=A.getWindow(t),t=e.getSelection(t);var i=t.getAllRanges();n=this.createContext(n,i,r),n.value=this.getNewSelectionValue(t,n),r=0;for(var s=i.length;r<s;++r)this.applyValueToRange(i[r],n);t.setRanges(i)}},k.util={getComputedStyleProperty:M,getFurthestAncestor:function(e){for(;null!=e.parentNode;)e=e.parentNode;return e},isContained:i,isEffectivelyContained:s,isHtmlNode:o,isHtmlElement:f,isInlineNode:u,isUnwrappable:l,blockExtend:function(e){for(var t=e.startContainer,n=e.startOffset,r=e.endContainer,i=e.endOffset,s,o;;)if(A.isCharacterDataNode(t)||0==n)n=A.getNodeIndex(t),t=t.parentNode;else if(n==A.getNodeLength(t))n=1+A.getNodeIndex(t),t=t.parentNode;else{if(!((s=t.childNodes[n])&&a(s)&&a(s.previousSibling)))break;n--}for(;;)if(0==i)i=A.getNodeIndex(r),r=r.parentNode;else if(A.isCharacterDataNode(r)||i==A.getNodeLength(r))i=1+A.getNodeIndex(r),r=r.parentNode;else{if(!((o=r.childNodes[i])&&a(o)&&a(o.previousSibling)))break;i++}return e=e.cloneRange(),e.setStart(t,n),e.setEnd(r,i),e},isModifiableElement:h,isSimpleModifiableElement:p,moveChildrenPreservingRanges:m,replaceWithOwnChildren:g,copyAttributes:y,getEffectiveValue:E,getEffectiveTextNodes:function(e,t){return e.getNodes([3],function(n){return s(n,e)&&!c(n,t.options)})},setNodeValue:C,wrap:S,decomposeRange:function(e,t){if(e.startContainer==e.endContainer&&e.startOffset==e.endOffset)return[];e.splitBoundaries(t);for(var n=e.cloneRange();0==n.startOffset&&n.startContainer.parentNode;)n.setStart(n.startContainer.parentNode,A.getNodeIndex(n.startContainer));for(;n.endOffset==A.getNodeLength(n.endContainer)&&n.endContainer.parentNode;)n.setEnd(n.endContainer.parentNode,1+A.getNodeIndex(n.endContainer));var n=new rangy.DomRange.RangeIterator(n,!1),r=v(n);return n.detach(),r},setGlobalOption:function(e,t){}},k.create=function(e,t){var n=new k;e.prototype=n;if("object"==typeof t)for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])};var j={};e.registerCommand=function(e,n){if(!(n instanceof k))throw t.createError("registerCommand(): Object supplied is not a Command");j[e.toLowerCase()]=n},e.execCommand=function(e,t,n){t=t||{};var r=t.hasOwnProperty("document")?t.document:document,i=t.hasOwnProperty("value")?t.value:null;e=L(e),n?e.applyToRange(r,i,t,n):e.applyToSelection(r,i,t)},e.queryCommandValue=function(t,n,r){n=n||{};var i=n.hasOwnProperty("document")?A.getWindow(n.document):window;return r=n.hasOwnProperty("value")?n.value:null,t=L(t),i=e.getSelection(i),n=t.createContext(r,null,n),t.getSelectionValue(i,n)},e.getCommand=L,e.Command=k}),rangy.createModule("BoldCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"fontWeight",defaultOptions:{tagName:"b",ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.fontWeight||(/^(strong|b)$/i.test(e.tagName)?"bold":null)},valuesEqual:function(e,t){return e=(""+e).toLowerCase(),t=(""+t).toLowerCase(),e==t||"bold"==e&&"700"==t||"bold"==t&&"700"==e||"normal"==e&&"400"==t||"normal"==t&&"400"==e},createNonCssElement:function(e,t,n){return"bold"==t||"700"==t?r.getDocument(e).createElement(n.options.tagName):null},isBoldCssValue:function(e){return/^(bold|700|800|900)$/.test(e)},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return this.isBoldCssValue(i.getEffectiveValue(e.commonAncestorContainer,t));for(;r--;)if(s=i.getEffectiveValue(n[r],t),!this.isBoldCssValue(s))return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"normal":"bold"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"normal":"bold"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("bold",new n)}),rangy.createModule("ItalicCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"fontStyle",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.fontStyle||(/^(em|i)$/i.test(e.tagName)?"italic":null)},createNonCssElement:function(e,t){return"italic"==t?r.getDocument(e).createElement("i"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"italic"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"italic"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"normal":"italic"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"normal":"italic"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("italic",new n)}),rangy.createModule("UnderlineCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.textDecoration||(/^(u)$/i.test(e.tagName)?"underline":null)},createNonCssElement:function(e,t){return"underline"==t?r.getDocument(e).createElement("u"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"underline"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"underline"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"none":"underline"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"none":"underline"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("underline",new n)}),rangy.createModule("StrikeThroughCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.textDecoration||(/^(strike|del)$/i.test(e.tagName)?"line-through":null)},createNonCssElement:function(e,t){return"line-through"==t?r.getDocument(e).createElement("strike"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"line-through"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"line-through"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"none":"line-through"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"none":"line-through"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("strikeThrough",new n)}),rangy.createModule("SuperScriptCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.verticalAlign||(/^(sup|sub)$/i.test(e.tagName)?"super":null)},createNonCssElement:function(e,t){return"super"==t?r.getDocument(e).createElement("sup"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"super"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"super"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"baseline":"super"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"baseline":"super"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("superscript",new n)}),rangy.createModule("SubScriptCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.verticalAlign||(/^(sub|sup)$/i.test(e.tagName)?"sub":null)},createNonCssElement:function(e,t){return"sub"==t?r.getDocument(e).createElement("sub"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"sub"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"sub"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"baseline":"sub"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"baseline":"sub"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("subscript",new n)}),rangy.createModule("JustifyLeftCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.textAlign||(/^(p)$/i.test(e.tagName)?"left":null)},createNonCssElement:function(e,t){return"left"==t?r.getDocument(e).createElement("p"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"left"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"left"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"":"left"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"":"left"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("justifyLeft",new n)}),rangy.createModule("JustifyCenterCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.textAlign||(/^(p)$/i.test(e.tagName)?"center":null)},createNonCssElement:function(e,t){return"center"==t?r.getDocument(e).createElement("p"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"center"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"center"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"":"center"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"":"center"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("justifyCenter",new n)}),rangy.createModule("FontsizeCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"fontSize",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.fontSize||(/^(font)$/i.test(e.tagName)?"fontSize":null)},createNonCssElement:function(e,t){return"fontsize"!=t?r.getDocument(e).createElement("span"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"fontsize"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),s!=t.options.fontsize)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return t.options.fontsize},getNewSelectionValue:function(e,t){return t.options.fontsize},applyValueToRange:function(e,t){if(""!=t.value){var n=i.decomposeRange(e,t.rangesToPreserve);n&&1==n.length&&1==n[0].nodeType&&"body"==n[0].nodeName.toLowerCase()&&(n=getChildToArray(n[0]));var n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=checkSameParent(n);r&&(n=r);for(var r=0,s=n.length;r<s;++r)if(1==n[r].nodeType&&"p"==n[r].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var o=n[r].innerHTML,o=o.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==o||"<br />"==o||"<br>"==o||""==o)n[r].innerHTML="&nbsp;";else for(var u=n[r].childNodes.length,o=0;o<u;++o)if(1==n[r].childNodes[o].nodeType&&"BR"==n[r].childNodes[o].tagName){var a=n[r].childNodes[o],l=_iframeDoc.createElement("span");a.parentNode.insertBefore(l,a),l.appendChild(a)}}u=getChildToArray(n[r]),o=0;for(a=u.length;o<a;++o)i.setNodeValue(u[o],t)}else i.setNodeValue(n[r],t)}}}),e.registerCommand("fontsize",new n)}),rangy.createModule("FontfamilyCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"fontFamily",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.fontFamily||(/^(font)$/i.test(e.tagName)?"fontFamily":null)},createNonCssElement:function(e,t){return"fontFamily"!=t?r.getDocument(e).createElement("span"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"fontFamily"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),s!=t.options.fontfamily)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return t.options.fontfamily},getNewSelectionValue:function(e,t){return t.options.fontfamily},applyValueToRange:function(e,t){if(""!=t.value){var n=i.decomposeRange(e,t.rangesToPreserve);n&&1==n.length&&1==n[0].nodeType&&"body"==n[0].nodeName.toLowerCase()&&(n=getChildToArray(n[0]));var n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=checkSameParent(n);r&&(n=r);for(var r=0,s=n.length;r<s;++r)if(1==n[r].nodeType&&"p"==n[r].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var o=n[r].innerHTML,o=o.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==o||"<br />"==o||"<br>"==o||""==o)n[r].innerHTML="&nbsp;";else for(var u=n[r].childNodes.length,o=0;o<u;++o)if(1==n[r].childNodes[o].nodeType&&"BR"==n[r].childNodes[o].tagName){var a=n[r].childNodes[o],l=_iframeDoc.createElement("span");a.parentNode.insertBefore(l,a),l.appendChild(a)}}u=getChildToArray(n[r]),o=0;for(a=u.length;o<a;++o)i.setNodeValue(u[o],t)}else i.setNodeValue(n[r],t)}}}),e.registerCommand("fontfamily",new n)}),rangy.createModule("FontcolorCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"color",defaultOptions:{ignoreWhiteSpace:!0},valuesEqual:function(e,t){return e=convertRgbToHex(e),t=convertRgbToHex(t),e==t},getSpecifiedValue:function(e){return e.style.color||(/^(font)$/i.test(e.tagName)?"color":null)},createNonCssElement:function(e,t){return"color"!=t?r.getDocument(e).createElement("span"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"color"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),!this.valuesEqual(s,t.options.fontcolor))return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"":t.options.fontcolor},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"":t.options.fontcolor},applyValueToRange:function(e,t){if(""!=t.value){var n=i.decomposeRange(e,t.rangesToPreserve);n&&1==n.length&&1==n[0].nodeType&&"body"==n[0].nodeName.toLowerCase()&&(n=getChildToArray(n[0]));var n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=checkSameParent(n);r&&(n=r);for(var r=0,s=n.length;r<s;++r)if(1==n[r].nodeType&&"p"==n[r].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var o=n[r].innerHTML,o=o.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==o||"<br />"==o||"<br>"==o||""==o)n[r].innerHTML="&nbsp;";else for(var u=n[r].childNodes.length,o=0;o<u;++o)if(1==n[r].childNodes[o].nodeType&&"BR"==n[r].childNodes[o].tagName){var a=n[r].childNodes[o],l=_iframeDoc.createElement("span");a.parentNode.insertBefore(l,a),l.appendChild(a)}}u=getChildToArray(n[r]),o=0;for(a=u.length;o<a;++o)i.setNodeValue(u[o],t)}else i.setNodeValue(n[r],t)}}}),e.registerCommand("fontcolor",new n)}),rangy.createModule("FontBgcolorCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"backgroundColor",defaultOptions:{ignoreWhiteSpace:!0},valuesEqual:function(e,t){return e=convertRgbToHex(e),t=convertRgbToHex(t),e==t},getSpecifiedValue:function(e){return e.style.backgroundColor||(/^(font)$/i.test(e.tagName)?"backgroundColor":null)},createNonCssElement:function(e,t){return"backgroundColor"!=t?r.getDocument(e).createElement("span"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"backgroundColor"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),!this.valuesEqual(s,t.options.fontcolor))return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"":t.options.fontcolor},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"":t.options.fontcolor},applyValueToRange:function(e,t){if(""!=t.value){var n=i.decomposeRange(e,t.rangesToPreserve);n&&1==n.length&&1==n[0].nodeType&&"body"==n[0].nodeName.toLowerCase()&&(n=getChildToArray(n[0]));var n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=checkSameParent(n);r&&(n=r);for(var r=0,s=n.length;r<s;++r)if(1==n[r].nodeType&&"p"==n[r].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var o=n[r].innerHTML,o=o.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==o||"<br />"==o||"<br>"==o||""==o)n[r].innerHTML="&nbsp;";else for(var u=n[r].childNodes.length,o=0;o<u;++o)if(1==n[r].childNodes[o].nodeType&&"BR"==n[r].childNodes[o].tagName){var a=n[r].childNodes[o],l=_iframeDoc.createElement("span");a.parentNode.insertBefore(l,a),l.appendChild(a)}}u=getChildToArray(n[r]),o=0;for(a=u.length;o<a;++o)i.setNodeValue(u[o],t)}else i.setNodeValue(n[r],t)}}}),e.registerCommand("fontbgcolor",new n)}),rangy.createModule("LineHeightCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{relevantCssProperty:"lineHeight",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return e.style.lineHeight?"lineHeight":null},createNonCssElement:function(e,t){return"lineHeight"!=t?r.getDocument(e).createElement("span"):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"lineHeight"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),s!=t.options.lineheight)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return t.options.lineheight},getNewSelectionValue:function(e,t){return t.options.lineheight},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("lineheight",new n)}),rangy.createModule("FormattingCommand",function(e,t){function n(){}e.requireModules(["Commands"]);var r=e.dom,i=e.Command.util;e.Command.create(n,{defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(e){return/^(h1|h2|h3|h4|h5)$/i.test(e.tagName)?"formatting":null},createNonCssElement:function(e,t,n){return"formatting"==t?r.getDocument(e).createElement(n.options.tagName):null},getRangeValue:function(e,t){var n=i.getEffectiveTextNodes(e,t),r=n.length,s;if(0==n.length)return"formatting"==i.getEffectiveValue(e.commonAncestorContainer,t);for(;r--;)if(s=i.getEffectiveValue(n[r],t),"formatting"!=s)return!1;return!0},getSelectionValue:function(e,t){for(var n=e.getAllRanges(),r=0,i=n.length;r<i;++r)if(!this.getRangeValue(n[r],t))return!1;return 0<i},getNewRangeValue:function(e,t){return this.getRangeValue(e,t)?"":"formatting"},getNewSelectionValue:function(e,t){return this.getSelectionValue(e,t)?"":"formatting"},applyValueToRange:function(e,t){for(var n=i.decomposeRange(e,t.rangesToPreserve),n=getRangeCorrectly(n,t.rangesToPreserve[0]),r=0,s=n.length;r<s;++r)i.setNodeValue(n[r],t)}}),e.registerCommand("formatting",new n)}),rangy.createModule("Util",function(e,t){e.requireModules(["WrappedSelection","WrappedRange"]);var n=e.rangePrototype,r=e.selectionPrototype;n.select=function(t){e.getSelection(this.getDocument()).setSingleRange(this,t)},r.pasteText=function(e){this.deleteFromDocument();var t=this.getRangeAt(0);e=t.getDocument().createTextNode(e),t.insertNode(e),this.setSingleRange(t)},n.pasteText=function(e){this.deleteContents(),e=this.getDocument().createTextNode(e),this.insertNode(e)},r.pasteHtml=function(e){this.deleteFromDocument();var t=this.getRangeAt(0);e=this.createContextualFragment(e);var n=e.lastChild;t.insertNode(e),n&&t.setStartAfter(n),this.setSingleRange(t)},n.pasteHtml=function(e){this.deleteContents(),e=this.createContextualFragment(e),this.insertNode(e)},r.selectNodeContents=function(t){var n=e.createRange(this.win);n.selectNodeContents(t),this.setSingleRange(n)},e.createRangeFromNode=function(t){var n=e.createRange(t);return n.selectNode(t),n},e.createRangeFromNodeContents=function(t){var n=e.createRange(t);return n.selectNodeContents(t),n}}),rangy.createModule("Position",function(e,t){function n(e){var t=0,n=0;if("number"==typeof e.pageXOffset&&"number"==typeof e.pageYOffset)t=e.pageXOffset,n=e.pageYOffset;else{e=e.document;var r=e.documentElement,i=e.compatMode;if((e="string"==typeof i&&0<=i.indexOf("CSS")&&r?r:w.getBody(e))&&"number"==typeof e.scrollLeft&&"number"==typeof e.scrollTop)try{t=e.scrollLeft,n=e.scrollTop}catch(s){}}return{x:t,y:n}}function r(e,t){for(t=t.toLowerCase();e;){if(1==e.nodeType&&e.tagName.toLowerCase()==t)return e;e=e.parentNode}return null}function i(e,t,n,r){this.top=e,this.right=t,this.bottom=n,this.left=r,this.width=t-r,this.height=n-e}function s(e,t,n){return new i(e.top+n,e.right+t,e.bottom+n,e.left+t)}function o(e,t){var n=0,r=0,i=t.documentElement,o=w.getBody(t),o=0===i.clientWidth&&"number"==typeof o.clientTop?o:i,i=o.clientLeft,o=o.clientTop;return i&&(n=-i),o&&(r=-o),s(e,n,r)}function u(e){for(var t=[],n=[],r=[],s=[],o=0,u=e.length,a;o<u;++o)if(a=e[o])t.push(a.top),n.push(a.bottom),r.push(a.left),s.push(a.right);return new i(Math.min.apply(Math,t),Math.max.apply(Math,s),Math.max.apply(Math,n),Math.min.apply(Math,r))}function a(t,n,r){return t=w.getBody(t).createTextRange(),t.moveToPoint(n,r),n=new e.WrappedTextRange(t),new S(n.startContainer,n.startOffset)}function f(e,t,n){return e=e.caretPositionFromPoint(t,n),new S(e.offsetNode,e.offset)}function l(e,t,n){return e=e.caretRangeFromPoint(t,n),new S(e.startContainer,e.startOffset)}function c(e){return e=(e.nativeRange||e).getClientRects(),0<e.length?e[e.length-1]:null}function h(t,n,r,i){var s=t.elementFromPoint(n,r);t=e.createRange(t),t.selectNodeContents(s),t.collapse(!0);var o=s.firstChild,u,a,f;if(o){e:for(;o;){if(3==o.nodeType){for(u=0,f=o.length;u<=f;++u)if(t.setEnd(o,u),(a=c(t))&&r<a.bottom&&n>=a.left&&n<=a.right){a.right-n>n-a.left&&--u;break e}}else if(t.setEndAfter(o),(a=c(t))&&r<a.bottom&&n>=a.left&&n<=a.right){u=w.getNodeIndex(o),o=s.parentNode,i||++u;break}o=o.nextSibling}o||(o=s,u=s.childNodes.length)}else o=s.parentNode,u=w.getNodeIndex(s),i||++u;return new S(o,u)}function p(t){if(e.features.implementsTextRange)return a;if("undefined"!=typeof t.caretPositionFromPoint)return f;if("undefined"!=typeof t.caretRangeFromPoint)return l;if("undefined"!=typeof t.elementFromPoint&&N)return h}function d(n,r,i,s,o){o=w.getContentDocument(o,t,"createRangeFromPoints");var u=p(o);return n=u(o,n,r,!1),i=u(o,i,s,!0),o=e.createRange(o),o.setStartAndEnd(n.node,n.offset,i.node,i.offset),o}function v(e,t){return e.compareBoundaryPoints(t.START_TO_START,t)}function m(e){return function(){for(var t="getBounding"+(e?"Document":"Client")+"Rect",n=[],r=0;r<this.rangeCount;++r)n.push(this.getRangeAt(r)[t]());return u(n)}}function g(e,t){return function(){if(0==this.rangeCount)return null;var n=t?"Document":"Client",r=this.getAllRanges();return 1<r.length&&r.sort(v),e?r[0]["getStart"+n+"Pos"]():r[r.length-1]["getEnd"+n+"Pos"]()}}e.requireModules(["WrappedSelection"]);var y=e.WrappedRange,b=e.WrappedTextRange,w=e.dom,E=e.util,S=w.DomPosition,x=document.createElement("span"),T=E.isHostMethod(x,"getBoundingClientRect"),x=null,N=!1,x=!1;e.features.implementsDomRange&&(x=e.createNativeRange(),N=E.isHostMethod(x,"getClientRects"),x=E.isHostMethod(x,"getBoundingClientRect")),E.extend(e.features,{rangeSupportsGetBoundingClientRect:x,rangeSupportsGetClientRects:N,elementSupportsGetBoundingClientRect:T});var C=function(e){return function(){var t=this.cloneRange();return t.collapse(e),t=t.getBoundingClientRect(),{x:t[e?"left":"right"],y:t[e?"top":"bottom"]}}},k=function(e){return function(){var t=this["get"+(e?"Start":"End")+"ClientPos"](),r=n(w.getWindow(this.startContainer));return{x:t.x+r.x,y:t.y+r.y}}},L=e.rangePrototype;if(e.features.implementsTextRange&&T)L.getBoundingClientRect=function(){var e=b.rangeToTextRange(this),t=this.getNodes([1],function(e){return/^t[dh]$/i.test(e.tagName)}),n=[];if(0<t.length){for(var i=r(this.startContainer,"table"),s=0,a,f,l;a=t[s];++s)f=r(a,"table"),i&&f==i||(l=this.cloneRange(),i&&l.setStartAfter(i),l.setEndBefore(f),n.push(b.rangeToTextRange(l).getBoundingClientRect())),this.containsNode(a)?n.push(a.getBoundingClientRect()):(i=e.duplicate(),i.moveToElementText(a),-1==i.compareEndPoints("StartToStart",e)?i.setEndPoint("StartToStart",e):1==i.compareEndPoints("EndToEnd",e)&&i.setEndPoint("EndToEnd",e),n.push(i.getBoundingClientRect())),i=f;!r(this.endContainer,"table")&&i&&(l=this.cloneRange(),l.setStartAfter(i),n.push(b.rangeToTextRange(l).getBoundingClientRect())),e=u(n)}else e=e.getBoundingClientRect();return o(e,w.getDocument(this.startContainer))};else if(e.features.implementsDomRange){var A=function(e){return e instanceof y?e:new y(e)};if(x)L.getBoundingClientRect=function(){var e=A(this).nativeRange,e=e.getBoundingClientRect()||e.getClientRects()[0];return o(e,w.getDocument(this.startContainer))},N&&(C=function(e){return function(){var t;t=A(this).nativeRange.getClientRects();if(0<t.length)return e?(t=t[0],{x:t.left,y:t.top}):(t=t[t.length-1],{x:t.right,y:t.bottom})}});else{var O=T?function(e){return o(e.getBoundingClientRect(),w.getDocument(e))}:function(e){for(var t=0,n=0,r=e,s=e.offsetWidth,u=e.offsetHeight;r;)t+=r.offsetLeft,n+=r.offsetTop,r=r.offsetParent;return o(new i(n,t+s,n+u,t),w.getDocument(e))},M=function(e){var t;e.splitBoundaries();var n=document.createElement("span");if(e.collapsed)e.insertNode(n),t=O(n),n.parentNode.removeChild(n);else{var r=e.cloneRange();r.collapse(!0),r.insertNode(n),t=O(n),n.parentNode.removeChild(n),r.collapseToPoint(e.endContainer,e.endOffset),r.insertNode(n),r=O(n),n.parentNode.removeChild(n),n=[t,r],t=e.getNodes([1],function(t){return e.containsNode(t)});for(var r=0,i=t.length;r<i;++r)n.push(O(t[r]));t=u(n)}return e.normalizeBoundaries(),t};L.getBoundingClientRect=function(e){return M(A(e))}}}E.extend(L,{getBoundingDocumentRect:function(){var e=n(w.getWindow(this.startContainer));return s(this.getBoundingClientRect(),e.x,e.y)},getStartClientPos:C(!0),getEndClientPos:C(!1),getStartDocumentPos:k(!0),getEndDocumentPos:k(!1)}),E.extend(e.selectionPrototype,{getBoundingClientRect:m(!1),getBoundingDocumentRect:m(!0),getStartClientPos:g(!0,!1),getEndClientPos:g(!1,!1),getStartDocumentPos:g(!0,!0),getEndDocumentPos:g(!1,!0)}),e.positionFromPoint=function(e,n,r){return r=w.getContentDocument(r,t,"positionFromPoint"),p(r)(r,e,n)},e.createRangeFromPoints=d,e.moveSelectionToPoints=function(e,t,n,r,i){var s,o;return r<t||t==r&&n<e?(s=n,o=r,r=t):(s=e,o=t,e=n),t=rangy.getSelection(i),i=d(s,o,e,r,i),t.setSingleRange(i),t}});