(function(){DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.util&&(DEXTTOP.DEXT5.util.pretty={_trim:function(e){return e.replace(/^\s+|\s+$/g,"")},_ltrim:function(e){return e.replace(/^\s+/g,"")},_rtrim:function(e){return e.replace(/\s+$/g,"")},_mergeOpts:function(e,t){var n={},r;for(r in e)r!==t&&(n[r]=e[r]);if(t in e)for(r in e[t])n[r]=e[t][r];return n},_style_html:function(e,t,n,r){var i=/\r\n|[\n\r\u2028\u2029]/,s=new RegExp(i.source,"g"),o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;t=t||{},t=DEXTTOP.DEXT5.util.pretty._mergeOpts(t,"html"),void 0!==t.wrap_line_length&&0!==parseInt(t.wrap_line_length,10)||void 0===t.max_char||0===parseInt(t.max_char,10)||(t.wrap_line_length=t.max_char),o=void 0===t.indent_inner_html?!1:t.indent_inner_html,u=void 0===t.indent_body_inner_html?!0:t.indent_body_inner_html,a=void 0===t.indent_head_inner_html?!0:t.indent_head_inner_html,f=void 0===t.indent_size?4:parseInt(t.indent_size,10),l=void 0===t.indent_char?" ":t.indent_char,h=void 0===t.brace_style?"collapse":t.brace_style,c=0===parseInt(t.wrap_line_length,10)?32786:parseInt(t.wrap_line_length||250,10),p=t.unformatted||"a abbr area audio b bdi bdo br button canvas cite code data datalist del dfn em embed i iframe img input ins kbd keygen label map mark math meter noscript object output progress q ruby s samp select small span strong sub sup svg template textarea time u var video wbr text acronym address big dt ins strike tt dextmark".split(" "),d=t.content_unformatted||["pre"],m=(v=void 0===t.preserve_newlines?!0:t.preserve_newlines)?isNaN(parseInt(t.max_preserve_newlines,10))?32786:parseInt(t.max_preserve_newlines,10):0,g=void 0===t.indent_handlebars?!1:t.indent_handlebars,y=void 0===t.wrap_attributes?"auto":t.wrap_attributes,b=isNaN(parseInt(t.wrap_attributes_indent_size,10))?f:parseInt(t.wrap_attributes_indent_size,10),w="force"===y.substr(0,5),E="force-expand-multiline"===y,S="force-aligned"===y,y=void 0===t.end_with_newline?!1:t.end_with_newline,x="object"==typeof t.extra_liners&&t.extra_liners?t.extra_liners.concat():"string"==typeof t.extra_liners?t.extra_liners.split(","):["head","body","/html"],T=t.eol?t.eol:"auto",t.indent_with_tabs&&(l="	",f=1),"auto"===T&&(T="\n",e&&i.test(e||"")&&(T=e.match(i)[0])),T=T.replace(/\\r/,"\r").replace(/\\n/,"\n"),e=e.replace(s,"\n"),i=new function(){function e(e){var t="";return{add:function(n){n=t+n.toLowerCase(),t=n.length<=e.length?n:n.substr(n.length-e.length,e.length)},doesNotMatch:function(){return-1===t.indexOf(e)}}}return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.token_text=this.last_token=this.last_text=this.token_type=this.tag_type="",this.newlines=0,this.indent_content=o,this.indent_body_inner_html=u,this.indent_head_inner_html=a,this.Utils={whitespace:["\n","\r","	"," "],single_token:"area base br col embed hr img input keygen link menuitem meta param source track wbr !doctype ?xml ?php basefont isindex".split(" "),extra_liners:x,in_array:function(e,t){for(var n=0;n<t.length;n++)if(e===t[n])return!0;return!1}},this.is_whitespace=function(e){for(var t=0;t<e.length;t++)if(!this.Utils.in_array(e.charAt(t),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var e="",e=this.input.charAt(this.pos);if(this.Utils.in_array(e,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(e,this.Utils.whitespace);)v&&"\n"===e&&this.newlines<=m&&(this.newlines+=1),this.pos++,e=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(e){return this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,e),this.print_indentation(e),!0):(this.line_char_count++,e.push(" "),!1)},this.get_content=function(){for(var e="",t=[],n=0;"<"!==this.input.charAt(this.pos)||2===n;){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(t);else{e=this.input.charAt(this.pos);if(g){"{"===e?n+=1:2>n&&(n=0);if("}"===e&&0<n&&0===n--)break;var r=this.input.substr(this.pos,3);if("{{#"===r||"{{/"===r)break;if("{{!"===r)return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}this.pos++,this.line_char_count++,t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos===this.input.length)return["","TK_EOF"];var t="";return e=new RegExp("</"+e+"\\s*>","igm"),e.lastIndex=this.pos,e=(e=e.exec(this.input))?e.index:this.input.length,this.pos<e&&(t=this.input.substring(this.pos,e),this.pos=e),t},this.record_tag=function(e){this.tags[e+"count"]?this.tags[e+"count"]++:this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level,this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1===this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.indent_to_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]])}},this.get_tag=function(e){var t="",n=[],t="",r=!1,i=!0,s=!1,o,u,a=this.pos,f=this.line_char_count,c=!1,h;e=void 0!==e?e:!1;do{if(this.pos>=this.input.length)return e&&(this.pos=a,this.line_char_count=f),n.length?n.join(""):["","TK_EOF"];t=this.input.charAt(this.pos),this.pos++;if(this.Utils.in_array(t,this.Utils.whitespace))r=!0;else{if("'"===t||'"'===t)t+=this.get_unformatted(t),r=!0;"="===t&&(r=!1),h=this.input.substr(this.pos-1),E&&s&&!c&&(">"===t||"/"===t)&&h.match(/^\/?\s*>/)&&(r=!1,c=!0,this.print_newline(!1,n),this.print_indentation(n));if(n.length&&"="!==n[n.length-1]&&">"!==t&&r){var v=this.space_or_wrap(n)&&"/"!==t&&!w,r=!1;if(w&&"/"!==t){var m=!1;E&&i&&(m=null===h.match(/^\S*(="([^"]|\\")*")?\s*\/?\s*>/));if(!i||m)this.print_newline(!1,n),this.print_indentation(n),v=!0}if(v)for(s=!0,h=b,S&&(h=n.indexOf(" ")+1),v=0;v<h;v++)n.push(l);if(i)for(h=0;h<n.length;h++)if(" "===n[h]){i=!1;break}}g&&"<"===u&&"{{"===t+this.input.charAt(this.pos)&&(t+=this.get_unformatted("}}"),n.length&&" "!==n[n.length-1]&&"<"!==n[n.length-1]&&(t=" "+t),r=!0),"<"!==t||u||(o=this.pos-1,u="<"),g&&!u&&2<=n.length&&"{"===n[n.length-1]&&"{"===n[n.length-2]&&(o="#"===t||"/"===t||"!"===t?this.pos-3:this.pos-2,u="{"),this.line_char_count++,n.push(t);if(!(!n[1]||"!"!==n[1]&&"?"!==n[1]&&"%"!==n[1])){n=[this.get_comment(o)];break}if(g&&n[1]&&"{"===n[1]&&n[2]&&"!"===n[2]){n=[this.get_comment(o)];break}if(g&&"{"===u&&2<n.length&&"}"===n[n.length-2]&&"}"===n[n.length-1])break}}while(">"!==t);return o=n.join(""),u=-1!==o.indexOf("\n")?o.indexOf("\n"):-1!==o.indexOf(" ")?o.indexOf(" "):"{"===o.charAt(0)?o.indexOf("}"):o.indexOf(">"),t="<"!==o.charAt(0)&&g?"#"===o.charAt(2)?3:2:1,u=o.substring(t,u).toLowerCase(),"/"===o.charAt(o.length-2)||this.Utils.in_array(u,this.Utils.single_token)?e||(this.tag_type="SINGLE"):g&&"{"===o.charAt(0)&&"else"===u?e||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(u,p)||this.is_unformatted(u,d)?(t=this.get_unformatted("</"+u+">",o),n.push(t),this.tag_type="SINGLE"):"script"===u&&(-1===o.search("type")||-1<o.search("type")&&-1<o.search(/\b(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/))?e||(this.record_tag(u),this.tag_type="SCRIPT"):"style"===u&&(-1===o.search("type")||-1<o.search("type")&&-1<o.search("text/css"))?e||(this.record_tag(u),this.tag_type="STYLE"):"!"===u.charAt(0)?e||(this.tag_type="SINGLE",this.traverse_whitespace()):e||("/"===u.charAt(0)?(this.retrieve_tag(u.substring(1)),this.tag_type="END"):(this.record_tag(u),"html"!==u.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(n),this.Utils.in_array(u,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),e&&(this.pos=a,this.line_char_count=f),n.join("")},this.get_comment=function(e){var t="",n=">",r=!1;this.pos=e,e=this.input.charAt(this.pos);for(this.pos++;this.pos<=this.input.length;){t+=e;if(t.charAt(t.length-1)===n.charAt(n.length-1)&&-1!==t.indexOf(n))break;!r&&10>t.length&&(0===t.indexOf("<![if")?(n="<![endif]>",r=!0):0===t.indexOf("<![cdata[")?(n="]]>",r=!0):0===t.indexOf("<![")?(n="]>",r=!0):0===t.indexOf("<!--")?(n="-->",r=!0):0===t.indexOf("{{!--")?(n="--}}",r=!0):0===t.indexOf("{{!")?5===t.length&&-1===t.indexOf("{{!--")&&(n="}}",r=!0):0===t.indexOf("<?")?(n="?>",r=!0):0===t.indexOf("<%")&&(n="%>",r=!0)),e=this.input.charAt(this.pos),this.pos++}return t},this.get_unformatted=function(t,n){if(n&&-1!==n.toLowerCase().indexOf(t))return"";var r="",i="",s=!0,o=e(t);do{if(this.pos>=this.input.length)break;r=this.input.charAt(this.pos),this.pos++;if(this.Utils.in_array(r,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"===r||"\r"===r){i+="\n",this.line_char_count=0;continue}}i+=r,o.add(r),this.line_char_count++,s=!0,g&&"{"===r&&i.length&&"{"===i.charAt(i.length-2)&&(i+=this.get_unformatted("}}"))}while(o.doesNotMatch());return i},this.get_token=function(){var e;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var t=this.last_token.substr(7);return e=this.get_contents_to(t),"string"!=typeof e?e:[e,"TK_"+t]}if("CONTENT"===this.current_mode)return e=this.get_content(),"string"!=typeof e?e:[e,"TK_CONTENT"];if("TAG"===this.current_mode)return e=this.get_tag(),"string"!=typeof e?e:[e,"TK_TAG_"+this.tag_type]},this.get_full_indent=function(e){return e=this.indent_level+e||0,1>e?"":Array(e+1).join(this.indent_string)},this.is_unformatted=function(e,t){if(!this.Utils.in_array(e,t))return!1;if("a"!==e.toLowerCase()||!this.Utils.in_array("a",t))return!0;var n=(this.get_tag(!0)||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!n||this.Utils.in_array(n,t)?!0:!1},this.printer=function(e,t,n,r,i){this.input=e||"",this.input=this.input.replace(/\r\n|[\r\u2028\u2029]/g,"\n"),this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=n,this.brace_style=i,this.indent_level=0,this.wrap_line_length=r;for(e=this.line_char_count=0;e<this.indent_size;e++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){this.line_char_count=0,t&&t.length&&(e||"\n"!==t[t.length-1])&&("\n"!==t[t.length-1]&&(t[t.length-1]=DEXTTOP.DEXT5.util.pretty._rtrim(t[t.length-1])),t.push("\n"))},this.print_indentation=function(e){for(var t=0;t<this.indent_level;t++)e.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(e){if(!this.is_whitespace(e)||this.output.length)(e||""!==e)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),e=DEXTTOP.DEXT5.util.pretty._ltrim(e)),this.print_token_raw(e)},this.print_token_raw=function(e){0<this.newlines&&(e=DEXTTOP.DEXT5.util.pretty._rtrim(e)),e&&""!==e&&(1<e.length&&"\n"===e.charAt(e.length-1)?(this.output.push(e.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(e));for(e=0;e<this.newlines;e++)this.print_newline(0<e,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){0<this.indent_level&&this.indent_level--}},this};for(i.printer(e,l,f,c,h);;){e=i.get_token(),i.token_text=e[0],i.token_type=e[1];if("TK_EOF"===i.token_type)break;switch(i.token_type){case"TK_TAG_START":i.print_newline(!1,i.output),i.print_token(i.token_text),i.indent_content&&(!i.indent_body_inner_html&&i.token_text.match(/<body(?:.*)>/)||!i.indent_head_inner_html&&i.token_text.match(/<head(?:.*)>/)||i.indent(),i.indent_content=!1),i.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":i.print_newline(!1,i.output),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_END":"TK_CONTENT"===i.last_token&&""===i.last_text&&(e=(i.token_text.match(/\w+/)||[])[0],f=null,i.output.length&&(f=i.output[i.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),(null===f||f[1]!==e&&!i.Utils.in_array(f[1],p))&&i.print_newline(!1,i.output)),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_SINGLE":(e=i.token_text.match(/^\s*<([a-z-]+)/i))&&i.Utils.in_array(e[1],p)||i.print_newline(!1,i.output),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":e=!1;for(f=i.output.length-1;0<=f&&"\n"!==i.output[f];f--)if(i.output[f].match(/{{#if/)){e=!0;break}e||i.print_newline(!1,i.output),i.print_token(i.token_text),i.indent_content&&(i.indent(),i.indent_content=!1),i.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":i.print_token(i.token_text),i.current_mode="TAG";break;case"TK_CONTENT":i.print_token(i.token_text),i.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==i.token_text){i.print_newline(!1,i.output),e=i.token_text;var N;c=1,"TK_SCRIPT"===i.token_type?N="function"==typeof n&&n:"TK_STYLE"===i.token_type&&(N="function"==typeof r&&r),"keep"===t.indent_scripts?c=0:"separate"===t.indent_scripts&&(c=-i.indent_level),f=i.get_full_indent(c),N?(c=function(){this.eol="\n"},c.prototype=t,c=new c,e=N(e.replace(/^\s*/,f),c)):(h=e.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(i.indent_string).length-1,c=i.get_full_indent(c-h),e=e.replace(/^\s*/,f).replace(/\r\n|\r|\n/g,"\n"+c).replace(/\s+$/,"")),e&&(i.print_token_raw(e),i.print_newline(!0,i.output))}i.current_mode="TAG";break;default:""!==i.token_text&&i.print_token(i.token_text)}i.last_token=i.token_type,i.last_text=i.token_text}return t=i.output.join("").replace(/[\r\n\t ]+$/,""),y&&(t+="\n"),"\n"!==T&&(t=t.replace(/[\n]/g,T)),t},html:function(e,t){return this._style_html(e,t)}})})();