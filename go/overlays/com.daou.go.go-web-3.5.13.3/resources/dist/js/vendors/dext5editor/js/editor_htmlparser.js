(function(){function e(e){var t={};e=e.split(",");for(var n=0;n<e.length;n++)t[e[n]]=!0;return t}var t=50,n=",span,strong,b,",r=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,i=/^<\/([-A-Za-z0-9_:@.]+)[^>]*>/,s=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,o=/^<([-A-Za-z0-9_:-]+)((?:\s+[a-zA-Z_0-9:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,u=/([-A-Za-z0-9_:-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,a=e("colgroup,col"),f=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");e("area,base,basefont,br,col,frame,img,input,isindex,link,meta,param,embed");var l=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul,h1,h2,h3,h4,h5,h6,figure,nav,section,article"),c=!1,h="a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var",p=e(h),d=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),v=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),m=e("");"undefined"==typeof DEXT5_EDITOR&&(DEXT5_EDITOR={}),DEXT5_EDITOR.HTMLParser=function(e,t,n){function a(e,t,i,o){t=t.toLowerCase();if(l[t]){for("table"!=b.last()&&"tbody"!=b.last()||"td"!=t||a("","tr","","");b.last()&&p[b.last()];)c("",b.last());"p"!=b.last()||"table"!=t&&"hr"!=t&&"center"!=t&&"figure"!=t||c("","p")}d[t]&&b.last()==t&&c("",t),(o=f[t]||!!o)||b.push(t);if(n.start){var h=[];e=r.test(e)?s:u,i.replace(e,function(e,t,n,r,i){n=n?n:r?r:i?i:v[t]?t:"",r="",""!=e&&(e=e.substring(e.indexOf(t)+t.length),e=e.substring(e.indexOf("=")+1),e=e.replace(/^\s+/,""),r=e.substring(0,1),"'"!=r&&'"'!=r&&(r="")),h.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"'),quotationmark:r})}),n.start&&n.start(t,h,o)}}function c(e,t){if(t)for(t=t.toLowerCase(),r=b.length-1;0<=r&&b[r]!=t;r--);else var r=0;if(0<=r){for(var i=b.length-1;i>=r;i--)n.end&&n.end(b[i]);b.length=r}}var h,g,b=[],S=e;for(b.last=function(){return this[this.length-1]};e;){g=!0;if(b.last()&&m[b.last()])e=e.replace(new RegExp("(.*)</"+b.last()+"[^>]*>"),function(e,t){return t=t.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1"),n.chars&&n.chars(t),""}),c("",b.last());else{var x=e.indexOf("<");h=e.indexOf(">")+1;var T=e.substring(x,h);if(0==e.indexOf("<!--"))h=e.indexOf("-->"),0<=h&&(n.comment&&("style"==b.last()?n.comment(e.substring(4,h),!0):n.comment(e.substring(4,h))),e=e.substring(h+3),g=!1);else if(0==e.toLowerCase().indexOf("<?xml"))h=e.indexOf("/>"),0<=h&&(e=e.substring(h+2),g=!1);else if(0!=e.indexOf("<")&&"</"+b.last()+">"==T.replace(/ /ig,""))g=e.substring(0,x),e=e.substring(h),e=g+"</"+b.last()+">"+e,g=!0;else if(0==e.indexOf("</")){if(h=e.match(i))e=e.substring(h[0].length),h[0].replace(i,c),g=!1}else if(0==e.indexOf("<"))if(h=e.match(r))e=e.substring(h[0].length),h[0].replace(r,a),g=!1;else if(h=e.match(o))e=e.substring(h[0].length),h[0].replace(o,a),g=!1;else{if("1"==DEXTTOP.G_CURREDITOR._config.removeIncorrectAttribute&&(h=e.indexOf("<"),T=e.indexOf(">"),0==h&&0<T)){var N=e.substring(0,T+1),C=x=h=0;0<N.indexOf('\ub9d1\uc740=""')?(h=N.indexOf('\ub9d1\uc740=""'),x=5,C=N.split('\ub9d1\uc740=""').length):0<N.indexOf("\ub9d1\uc740=''")&&(h=N.indexOf("\ub9d1\uc740=''"),x=5,C=N.split("\ub9d1\uc740=''").length);if(2==C&&0<h&&(T=e.substring(T+1),C=N.substring(0,h).lastIndexOf(" "),C<h+x))if(e=N.substring(C,h+x),N=N.replace(e,""),e=N+T,h=e.match(r))e=e.substring(h[0].length),h[0].replace(r,a),g=!1;else if(h=e.match(o))e=e.substring(h[0].length),h[0].replace(o,a),g=!1}x=/^<([-a-zA-Z._]*@[-a-zA-Z._]*)()>/;if(h=e.match(x))e=e.substring(h[0].length),h[0].replace(x,a),g=!1}g&&(h=e.indexOf("<"),g=0>h?e:e.substring(0,h),e=0>h?"":e.substring(h),n.chars&&(b.last()&&p[b.last()]&&"textarea"!=b.last()&&"script"!=b.last()&&0>b.indexOf("pre")&&0>b.indexOf("xmp")&&(h=!1,x=RegExp("\\S\\n","g"),x.test(g)&&(h=!0),x=RegExp("\\n\\S","g"),x.test(g)&&(h=!0),x=RegExp("\\S\\n\\S","g"),x.test(g)&&(h=!0),h?g=g.replace(/\n/g," "):(x=RegExp("\\n\\n","g"),x.test(g)&&""==g.trim()?g=g.replace(/\n\n/g,""):g==unescape("%20%20")&&(h=new RegExp(unescape("%20"),"g"),g=g.replace(h,"&nbsp;")))),"1"==DEXTTOP.G_CURREDITOR._config.replaceSpace&&t&&(h=new RegExp(unescape("%20%20"),"g"),g=g.replace(h,"&nbsp; ")),n.chars(g)))}if(e==S)throw"Parse Error: "+e;S=e}c()},DEXT5_EDITOR.HTMLParser.HTMLtoXML=function(t,n){var r="",i=DEXTTOP.G_CURREDITOR._config.skipTagInParser;if(""!=i&&0==c){h=h.replace(/,/g,",,"),h=","+h+",";for(var i=i.split(","),s=i.length,o=0;o<s;o++)h=h.replace(","+i[o]+",","");h=h.replace(/,,/g,","),h=h.replace(/^,/g,""),h=h.replace(/,$/g,""),p=e(h),c=!0}return DEXT5_EDITOR.HTMLParser(t,n,{start:function(e,t,n){r+="<"+e;for(e=0;e<t.length;e++)r="href"==t[e].name||"src"==t[e].name?r+(" "+t[e].name+"="+t[e].quotationmark+t[e].value+t[e].quotationmark):""!=t[e].quotationmark?r+(" "+t[e].name+"="+t[e].quotationmark+t[e].value+t[e].quotationmark):r+(" "+t[e].name+'="'+t[e].escaped+'"');r+=(n?"/":"")+">"},end:function(e){a[e]||(r+="</"+e+">")},chars:function(e){r+=e},comment:function(e,t){r="0"==DEXTTOP.G_CURREDITOR._config.removeComment||t?r+("<!--"+e+"-->"):r+""}}),r},DEXT5_EDITOR.HTMLParser.RemoveOfficeTag=function(e,t){return""==e||void 0==e?"":(e=DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(e),e=DEXTTOP.DEXT5.util.replaceOneSpaceToNbsp(e),t&&(e=e.replace(/(<span[^>]*>)\s<\/span>/gi,"$1&nbsp;</span>"),e=e.replace(/>\s+</g,"><")),e)},DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2=function(e){var t=RegExp("<o:p></o:p>","gi");return e=e.replace(t,""),t=RegExp("<o:p>\\s+</o:p>","gi"),e=e.replace(t,""),t=RegExp("<o:p ([^>]+)></o:p>","gi"),e=e.replace(t,""),t=RegExp("<o:p ([^>]+)>\\s+</o:p>","gi"),e=e.replace(t,""),t=RegExp("<w:sdt[^>]*>","gi"),e=e.replace(t,""),t=RegExp("</w:sdt>","gi"),e=e.replace(t,""),"1"==DEXTTOP.G_CURREDITOR._config.removeLangAttribute&&(t=RegExp('(<[^>]+)(lang=["]?en-us["])([^>]*>)',"gi"),t.test(e)&&(e=e.replace(t,"$1$3"))),"1"==DEXTTOP.G_CURREDITOR._config.removeMsoClass&&(t=RegExp('(<[^>]+\\sclass=[\\"]?)(mso\\w+)([\\"]?[^>]*>)',"gi"),t.test(e)&&(e=e.replace(t,"$1$3"))),t=RegExp("(<[^>]+)(mso-ascii-font-family\\s*:\\s*(&quot;)?[a-z\u3131-\ud7a3 ]*(&quot;)?;?)([^>]*>)","gi"),t.test(e)&&(e=e.replace(t,"$1$5")),t=RegExp("<v:shapetype ([^>]+)>[\\s\\S]*?</v:shapetype>","gi"),e=e.replace(t,""),t=RegExp("<v:shape [^>]+>[\\s\\S]*?(<img [^>]+>)*?</v:shape>","gi"),e=e.replace(t,"$1"),t=RegExp("<v:shape ([^>]+)>[\\s\\S]*?</v:shape>","gi"),e=e.replace(t,""),e=e.replace(/<\!\[if ppt\]>/gi,"")},DEXT5_EDITOR.HTMLParser.CheckNeedNestedHTML=function(e,n,r){var i=!1;"undefined"!=typeof n&&""!=n&&(t=n),n=[];var s="p";"undefined"!=typeof r&&""!=r&&(s=r),r=s.split(",");var o=r.length;if(1<o)for(s=0;s<o;s++){var u=e.getElementsByTagName(r[s]);try{n=n.concat(Array.prototype.slice.call(u,0))}catch(a){for(var f=u.length,l=0;l<f;l++)n.push(u[l])}}else n=e.getElementsByTagName(s);s=0;for(e=n.length;s<e;s++)if(DEXT5_EDITOR.HTMLParser.GetChildrenCount(n[s],!0)>t){i=!0;break}return i},DEXT5_EDITOR.HTMLParser.GetChildrenCount=function(e,t){var n=0;return e.childNodes&&(n=DEXT5_EDITOR.HTMLParser.getChildrenCountForNestedHTML(e,t)-e.childNodes.length),n},DEXT5_EDITOR.HTMLParser.getChildrenCountForNestedHTML=function(e,t){for(var r=0,i=e.childNodes.length,s=0;s<i;s++)1==e.childNodes[s].nodeType&&-1<n.indexOf(","+e.childNodes[s].tagName.toLowerCase()+",")&&(t&&(r+=DEXT5_EDITOR.HTMLParser.getChildrenCountForNestedHTML(e.childNodes[s],t)),r++);return r},DEXT5_EDITOR.HTMLParser.CleanNestedHtml=function(e,r,i,s,o){function u(e){for(var t="",n=Array(e.childNodes.length),r=0;r<n.length;r++){n[r]=[],n[r].push(e.childNodes[r]),a(e.childNodes[r],n[r]);var i=r,s=n[r],o=[],u=0;e:for(;u<s.length;u++){for(var f=0;f<o.length;f++)if(o[f]==s[u])continue e;o[o.length]=s[u]}n[i]=o,t+=n[r].join("")}return t}function a(e,t){for(var n=e.childNodes,r=0;r<n.length;r++)t.push(n[r]),n[r].hasChildNodes()&&1==n[r].nodeType&&"table"!=n[r].nodeName.toLowerCase()&&a(n[r],t);for(var n=0,i;n<t.length;n++){r=t[n];if(1==r.nodeType)if("table"==r.nodeName.toLowerCase())r=r.outerHTML;else{i=r.nodeName;if(-1==(" "+c.join(" ").toUpperCase()+" ").search(" "+i.toUpperCase()+" ")){t.splice(n,1),n--;continue}i=r;for(var s="",o=0,u=void 0;o<i.attributes.length;o++)u=i.attributes[o],1==u.specified&&("style"==u.name?(u=f(i),""!=u&&(s+=' style="'+f(i)+'"')):""!=u.value&&(s+=" "+u.name+'="'+u.value+'"'));i=s,r="<"+r.nodeName.toLowerCase()+i+">"}else 3==r.nodeType&&(r=r.nodeValue.replace(/\n/g,""),r=r.replace(/(\s)\s+/g,"$1"),r=r.replace(/</g,"&lt;"),r=r.replace(/>/g,"&gt;"));t[n]=r}return t}function f(e){for(var t="",n=0,r=l.length,i;n<r;n++)e.currentStyle?i=e.currentStyle[l[n]]:window.getComputedStyle&&(i=document.defaultView.getComputedStyle(e,null).getPropertyValue(l[n])),t+=l[n]+":"+i+";";return t}var l=[],c="p div a abbr acronym applet basefont bdo big br button cite code del dfn em font i iframe img input ins kbd label map object q s samp script select small strike sub sup textarea tt u var".split(" ");if(""!=e._config.cleanNestedTagOptions.removeTag){for(var h=e._config.cleanNestedTagOptions.removeTag.split(","),p=h.length-1;0<=p;p--){var d=c.indexOf(h[p]);-1<d&&c.splice(d,1)}n=","+e._config.cleanNestedTagOptions.removeTag+","}0<e._config.cleanNestedTagOptions.allowStyle.length&&(l=e._config.cleanNestedTagOptions.allowStyle),"undefined"!=typeof i&&""!=i&&(t=parseInt(i)),p="p","undefined"!=typeof s&&""!=s&&(p=s),s=e._DOC,"undefined"!=typeof o&&""!=o&&(s=o);var v=[];o=p.split(","),i=o.length;if(1<i)for(p=0;p<i;p++){h=s.getElementsByTagName(o[p]);try{v=v.concat(Array.prototype.slice.call(h,0))}catch(m){for(var d=h.length,g=0;g<d;g++)v.push(h[g])}}else v=s.getElementsByTagName(p);o=!1,p=0;for(i=v.length;p<i;p++)if(DEXT5_EDITOR.HTMLParser.GetChildrenCount(v[p],!0)>t){o=!0;break}if(o)if(s&&s!=e._DOC)try{p=0,i=v.length;for(var y;p<i;p++)DEXT5_EDITOR.HTMLParser.GetChildrenCount(v[p],!0)>t&&(y=u(v[p]),y=DEXT5_EDITOR.HTMLParser.HTMLtoXML(y),v[p].innerHTML=y);return s.innerHTML}catch(b){}else showProcessingBackground(),setTimeout(function(){e._BODY.contentEditable=!1;try{if("2"==r)DEXTTOP.DEXT5.DextCommands("select_all",e.ID),DEXTTOP.DEXT5.DextCommands("remove_css",e.ID),DEXTTOP.DEXT5.DextCommands("remove_format",e.ID),e._FRAMEWIN.setFocusToBody(),setTimeout(function(){e._FRAMEWIN.doSetCaretPosition(e._BODY.firstChild,0)},20);else for(var n=0,i=v.length,s;n<i;n++)DEXT5_EDITOR.HTMLParser.GetChildrenCount(v[n],!0)>t&&(s=u(v[n]),s=DEXT5_EDITOR.HTMLParser.HTMLtoXML(s),v[n].innerHTML=s)}catch(o){}hideProcessingBackground(),e._BODY.contentEditable=!0},G_Progress_LoadTime)},DEXT5_EDITOR.HTMLParser.makeMap=function(t){return e(t)}})();