var G_RW_GRID=function(e,t){var n=function(e){return e.replace(/[^-\.0-9]/g,"").replace(/(?!^.*)-/,"")};document.getElementsByTagName("head")[0].appendChild(document.createElement("style"));var r=document.styleSheets[document.styleSheets.length-1],i=function(e,t){"insertRule"in r?r.insertRule(".gridTable "+e+"{"+t+"}",0):"addRule"in r&&r.addRule(".gridTable "+e,t,1)},s=function(e){};t||(t={}),t.data||(t.rowSize||(t.rowSize=2),t.columnSize||(t.columnSize=4)),t.event||(t.event={});var o,u,a,f,l=[],c;this.setSaveInSession=function(e){t.saveInSession=e?!0:!1},this.isSaveInSession=function(){return t.saveInSession},this.setEditable=function(e){t.editable=e?!0:!1},this.isEditable=function(){return t.editable},this.setShowRowIndex=function(e){t.showRowIndex=e?!0:!1,this.fillTable()},this.isShowRowIndex=function(){return t.showRowIndex},this.getRowIndexFlag=function(){return this.isShowRowIndex()?1:0},this.setShowColumnIndex=function(e){t.showColumnIndex=e?!0:!1,u.refreshHead()},this.isShowColumnIndex=function(){return t.showColumnIndex},this.getColumnIndexFlag=function(){return this.isShowColumnIndex()?1:0},this.setIndexDraggable=function(e){t.indexDraggable=e?!0:!1},this.isIndexDraggable=function(){return t.indexDraggable},this.setShowRowTitle=function(e){t.showRowTitle=e?!0:!1;if(!e){e=this.getRowSize();for(var r=this.getColumnTitleFlag();r<e;r++)a[r][0]=n(a[r][0])}this.fillTable()},this.isShowRowTitle=function(){return t.showRowTitle},this.getRowTitleFlag=function(){return this.isShowRowTitle()?1:0},this.setShowColumnTitle=function(e){t.showColumnTitle=e?!0:!1;if(!e){e=this.getColumnSize();for(var r=this.getRowTitleFlag();r<e;r++)a[0][r]=n(a[0][r])}this.fillTable()},this.isShowColumnTitle=function(){return t.showColumnTitle},this.getColumnTitleFlag=function(){return this.isShowColumnTitle()?1:0},this.setColumnResizable=function(e){t.columnResizable=e?!0:!1},this.isColumnResizable=function(){return t.columnResizable},this.selectedCell=this.modifyingCell=null,this.setData=function(e){if(e){a=e,e=this.getRowSize();for(var t=this.getColumnSize(),n=0;n<e;n++)if(a[n].length<t)for(var r=a[n].length;r<t;r++)a[n][r]="";for(n=0;n<t;n++)l[n]=60}else a=[];return this.isSaveInSession()&&sessionStorage.setItem("gridData",a),a},this.getSessionData=function(){this.isSaveInSession()&&sessionStorage.getItem("gridData")},this.getData=function(){return a},this.getRowData=function(e){return a[e]},this.getColumnData=function(e){for(var t=[],n=0;n<this.getRowSize();n++)t.push(a[n][e]);return t},this.getRowSize=function(){return a.length},this.setRowSize=function(e){if(this.isShowRowTitle()&&this.isShowColumnTitle()&&2>e)return!1;for(var t=this.getRowSize(),n=this.getColumnSize();e!=t;){if(e<t)a.pop();else{a[t]=[];for(var r=0;r<n;r++)a[t][r]=""}t=this.getRowSize()}this.fillTable()},this.getColumnSize=function(){for(var e=a[0].length,t=this.getRowSize(),n=1;n<t;n++)e<a[n].length&&(e=a[n].length);return e},this.setColumnSize=function(e){if(this.isShowRowTitle()&&this.isShowColumnTitle()&&2>e)return!1;for(var t=this.getRowSize(),n=this.getColumnSize();e!=n;){if(e<n){l[n-1]&&l.pop();for(var r=0;r<t;r++)a[r].pop()}else for(l[n]||(l[n]=60),r=0;r<t;r++)a[r][n]="";n=this.getColumnSize()}this.fillTable()},this.insertRow=function(){var e=u.createRow();a[this.getRowSize()]=[""];for(var t=this.getColumnSize(),n=0;n<t;n++){var r=u.insertCell(e);this.setCellValue("",r)}},this.insertColumn=function(){for(var e=this.getRowSize(),t=this.getColumnSize(),n=0;n<e;n++){var r=u.insertCell(u.getRow(n));l[t]||(l[t]=60),r.style.width=l[n],this.setCellValue("",r)}},this.removeLastRow=function(){var e=this.getRowSize()-1;if(0==e)return!1;u.removeRow(e),a.pop()},this.removeLastColumn=function(){this.getColumnSize();for(var e=this.getRowSize(),t=0;t<e;t++){var n=u.getRow(t);n.removeChild(n.lastChild),a[t].pop()}},this.getCellValue=function(e,t){return a[e][t]?a[e][t]:""},this.setCellValue=function(e,t){var n=u.getRowIndex(t),r=u.getColumnIndex(t),i={value:e,rowIndex:n,columnIndex:r,afterCallback:function(e){}};if(a[n][r]!=e){if(0==this.onCellChange(i))return!1;e=i.value;if(n!=i.rowIndex||r!=i.columnIndex)n=i.rowIndex,r=i.columnIndex,t=u.getCell(n,r);this.isSaveInSession()&&sessionStorage.setItem("gridData",JSON.stringify(a))}a[n][r]=e,3<t.innerHTML.length&&(t.scrollLeft=0),t.innerHTML=e,t.title=e,i.afterCallback(i)},this.fillTable=function(e){if(!f&&!e)return!1;u.emptyBody(),e=this.getColumnSize();if(this.isShowColumnTitle()){var t=u.createRow();t.className+=" title",this.isShowRowTitle()&&(u.insertCell(t).className+=" blank");for(var n,r=this.getRowTitleFlag();r<e;r++)n=u.insertCell(t),n.innerHTML=a[0][r],n.title=a[0][r];n.className+=" end"}for(var t=this.getRowSize(),i,s,o=this.isShowRowTitle(),l=this.getRowTitleFlag(),r=this.getColumnTitleFlag();r<t;r++){i=u.createRow(),o&&(n=u.insertCell(i),n.className+=" title",n.innerHTML=a[r][0],n.title=a[r][0]);for(n=l;n<e;n++)if(s=u.insertCell(i),value=a[r][n])s.innerHTML=value,s.title=value;s.className+=" end"}i.className+=" end",this.isShowColumnIndex()&&u.refreshHead(!0)},this.modifyCell=function(e,t){(t.modifying=e)?(this.modifyingCell=t,this.selectCell(t)):this.modifyingCell=null},this.saveCell=function(){var e=this.modifyingCell;e&&(this.modifyCell(!1,e),this.setCellValue(e.childNodes[0].value,e))},this.selectCell=function(e){this.selectedCell&&(this.selectedCell.className=this.selectedCell.className.replace(/ selectedCell/g,""),this.selectedCell.tabIndex=-1),this.selectedCell=e,e.tabIndex=0,e.className+=" selectedCell",e.focus()},this.changeRow=function(e,t){var n=u.getRowIndex(e),r=u.getRowIndex(t);this.saveCell();for(var i=this.getColumnSize(),s=0;s<i;s++){var o=a[r][s];this.setCellValue(a[n][s],u.getCell(r,s)),this.setCellValue(o,u.getCell(n,s))}o=t.innerHTML,t.innerHTML=e.innerHTML,e.innerHTML=o},this.changeColumn=function(e,t){var n=u.getColumnIndex(e),r=u.getColumnIndex(t);this.saveCell();for(var i=this.getRowSize(),s=0;s<i;s++){var o=a[s][r];this.setCellValue(a[s][n],u.getCell(s,r)),this.setCellValue(o,u.getCell(s,n))}u.refreshHead()},this.rotateTable=function(){this.saveCell();for(var e=[],t=this.getRowSize(),n=this.getColumnSize(),r=0;r<t;r++)for(var i=0;i<n;i++)e[i]||(e[i]=[]),e[i][r]=a[r][i];this.setData(e),this.fillTable()},this.Table={createTable:function(){if(this.table)return!1;t.parent?(this.table=document.createElement("table"),this.table.id=e,t.parent.appendChild(this.table)):f?(this.table=document.createElement("table"),this.table.id=e,document.body.appendChild(this.table)):(document.write('<table id="'+e+'"></table>'),this.table=document.getElementById(e));if(!this.table)return!1;this.table.className="gridTable",this.table.tabIndex=0,this.table.createTHead(),o.isShowColumnIndex()&&this.table.tHead.insertRow(),this.table.appendChild(document.createElement("tbody")),this.table.onmousedown=this.tableMouseDown;var n=this.table.ownerDocument,r=this.documentMouseMove;return n.addEventListener?n.addEventListener("mousemove",r):n.attachEvent("onmousemove",r),n=this.table.ownerDocument,r=this.documentMouseUp,n.addEventListener?n.addEventListener("mouseup",r):n.attachEvent("onmouseup",r),this.table.onkeydown=this.tableKeyDown,this.table.onkeyup=this.tableKeyUp,this.table},createRow:function(){var e=document.createElement("tr");this.table.tBodies[0].appendChild(e);if(o.isShowRowIndex()){var t=document.createElement("th");t.innerHTML=e.rowIndex,e.appendChild(t),o.isIndexDraggable()&&(1==e.rowIndex&&o.isShowColumnTitle()||this.setDragHandler(t))}return e},insertCell:function(e){var t=document.createElement("td");return o.isEditable()&&(t.onclick=this.cellClick),e.appendChild(t),t},refreshHead:function(e){if(!f&&!e)return!1;this.table.tHead.deleteRow(0);if(o.isShowColumnIndex()){e=document.createElement("tr"),this.table.tHead.appendChild(e);if(o.isShowRowIndex()){var t=document.createElement("th");t.className+=" blank",t.style.width="40px",e.appendChild(t)}for(var t=o.getColumnSize(),n=0;n<t;n++){var r=document.createElement("th");r.style.width=l[n]+"px",e.appendChild(r);if(o.isColumnResizable()){var i=document.createElement("span");i.className+=" resize",i.draggable=!0,i.innerHTML="&nbsp;",r.appendChild(i)}o.isIndexDraggable()&&(1==r.cellIndex&&o.isShowRowTitle()||this.setDragHandler(r)),r.innerHTML+=n+1}}},emptyBody:function(){this.table.removeChild(this.table.tBodies[0]),o.selectedCell=null,this.table.appendChild(document.createElement("tbody"))},getRow:function(e){return this.table.tBodies[0].childNodes[e]},getCell:function(e,t){return this.table.tBodies[0].childNodes[e].childNodes[t+o.getRowIndexFlag()]},getRowIndex:function(e){return e.parentElement.rowIndex-o.getColumnIndexFlag()},getColumnIndex:function(e){return e.cellIndex-o.getRowIndexFlag()},removeRow:function(e){this.table.tBodies[0].removeChild(this.getRow(e))},editCell:function(e){if(e.modifying)return!1;o.saveCell();if(-1<e.className.indexOf("blank"))return o.selectCell(e),!1;var t=e.clientWidth-9+"px",n=e.clientHeight-10+"px";o.modifyCell(!0,e),e.cellValue=e.innerHTML,e.innerHTML="<input/>";var r=e.childNodes[0];-1==e.className.indexOf("title")&&-1==e.parentElement.className.indexOf("title")&&(r.className+=" number"),r.style.width=t,r.style.height=n,r.onkeydown=this.inputKeyDown,r.onkeyup=this.inputKeyUp,r.onblur=this.inputBlur,r.focus(),r.value=e.cellValue},makeDragDummy:function(){switch(c.type){case"columnIndex":c.index=u.getColumnIndex(c.target);var e=c.dummy=document.createElement("table");e.id="dummyTable",e.className="gridTable",e.style.position="fixed",e.style.width=l[c.index]+"px",c.targetRect=c.target.getBoundingClientRect(),c.lastTarget=c.target,e.style.left=c.targetRect.left+"px",u.table.parentElement.insertBefore(e,u.table);var t=e.createTHead(),n=document.createElement("tr");t.appendChild(n),t=document.createElement("th"),t.style.cursor="move",t.innerHTML=c.target.innerHTML,t.style.backgroundColor="yellow",n.appendChild(t);var r=document.createElement("tbody");e.appendChild(r);for(var i=o.getRowSize(),s=o.isShowColumnTitle(),e=0;e<i;e++)t=u.getCell(e,c.index),t.innerHTML="",n=document.createElement("tr"),0==e&&s&&(n.className="title"),r.appendChild(n),t=document.createElement("td"),t.style.borderColor="transparent",t.innerHTML=a[e][c.index],n.appendChild(t);n.className+=" end",c.lastIndex=c.index;break;case"rowIndex":c.index=u.getRowIndex(c.target),e=c.dummy=document.createElement("table"),e.id="dummyTable",e.className="gridTable",e.style.position="fixed",c.targetRect=c.target.getBoundingClientRect(),c.lastTarget=c.target,e.style.top=c.targetRect.top+"px",u.table.parentElement.insertBefore(e,u.table),r=document.createElement("tbody"),e.appendChild(r),n=document.createElement("tr"),r.appendChild(n),t=document.createElement("th"),t.innerHTML=c.target.innerHTML,t.style.width="40px",t.style.backgroundColor="yellow",n.appendChild(t),r=o.getColumnSize(),i=o.isShowRowTitle();for(e=0;e<r;e++)t=u.getCell(c.index,e),t.innerHTML="",t=document.createElement("td"),0==e&&i&&(t.className="title"),t.style.border="0px",t.style.width=l[e]+"px",t.style.borderColor="transparent",t.innerHTML=a[c.index][e],n.appendChild(t);c.lastIndex=c.index;break;case"columnResize":c.index=u.getColumnIndex(c.target),e=c.dummy=document.createElement("div"),e.style.border="1px dashed black",e.style.position="fixed",c.tableRect=u.table.getBoundingClientRect(),c.targetRect=c.target.getBoundingClientRect(),e.style.height=c.tableRect.bottom-c.tableRect.top-2+"px",e.style.width="1px",e.style.left=c.targetRect.right-3+"px",u.table.parentElement.insertBefore(e,u.table)}},tableMouseDown:function(e){e=e||event;var t=e.target||e.srcElement;if("input"==t.tagName.toLowerCase())return!0;if(o.isIndexDraggable()&&t.draggable){o.modifyingCell&&o.saveCell(),c&&c.dummy&&c.dummy.parentElement.removeChild(c.dummy),c={target:t},c.action=e.altKey?"alt":"move";if("th"==c.target.tagName.toLowerCase())"thead"==c.target.parentElement.parentElement.tagName.toLowerCase()?c.type="columnIndex":c.type="rowIndex";else{if("span"!=c.target.tagName.toLowerCase())return c=!1;if(c.target=c.target.parentElement,"thead"!=c.target.parentElement.parentElement.tagName.toLowerCase())return c=!1;c.type="columnResize"}return u.makeDragDummy(),!1}return o.modifyingCell?(o.modifyingCell.childNodes[0].focus(),!1):(o.selectedCell?o.selectCell(o.selectedCell):o.selectCell(u.getCell(0,0)),!1)},documentMouseMove:function(e){if(c){e=e||event;var t=e.target||e.srcElement;switch(c.type){case"columnIndex":if("th"==c.target.tagName.toLowerCase()&&("th"==t.tagName.toLowerCase()||"td"==t.tagName.toLowerCase())&&t.parentElement.parentElement.parentElement==c.target.parentElement.parentElement.parentElement){e=u.getColumnIndex(t);if(e<o.getRowTitleFlag())return!1;var n=o.getRowSize(),t=t.getBoundingClientRect();c.dummy.style.top=c.targetRect.top+"px",c.dummy.style.left=t.left+"px",c.dummy.style.width=l[e]+"px";if(e==c.lastIndex)return!1;if("move"==c.action)if(c.lastIndex>e){for(t=c.lastIndex;t>e;t--){var r=u.table.tHead.childNodes[0].childNodes[t+o.getRowIndexFlag()],i=u.table.tHead.childNodes[0].childNodes[t-1+o.getRowIndexFlag()];r.innerHTML=i.innerHTML,i.innerHTML=""}for(var s=0;s<n;s++)for(t=c.lastIndex;t>e;t--)r=u.getCell(s,t),i=u.getCell(s,t-1),r.innerHTML=i.innerHTML,i.innerHTML=""}else{for(t=c.lastIndex;t<e;t++)r=u.table.tHead.childNodes[0].childNodes[t+o.getRowIndexFlag()],i=u.table.tHead.childNodes[0].childNodes[t+1+o.getRowIndexFlag()],r.innerHTML=i.innerHTML,i.innerHTML="";for(s=0;s<n;s++)for(t=c.lastIndex;t<e;t++)r=u.getCell(s,t),i=u.getCell(s,t+1),r.innerHTML=i.innerHTML,i.innerHTML=""}else if("alt"==c.action)for(r=u.table.tHead.childNodes[0].childNodes[e+o.getRowIndexFlag()],i=u.table.tHead.childNodes[0].childNodes[c.lastIndex+o.getRowIndexFlag()],t=r.innerHTML,r.innerHTML=i.innerHTML,e!=c.index?(r=u.table.tHead.childNodes[0].childNodes[c.index+o.getRowIndexFlag()],i.innerHTML=r.innerHTML,r.innerHTML=t):i.innerHTML=t,s=0;s<n;s++)r=u.getCell(s,e),i=u.getCell(s,c.lastIndex),t=r.innerHTML,r.innerHTML=i.innerHTML,e!=c.index?(r=u.getCell(s,c.index),i.innerHTML=r.innerHTML,r.innerHTML=t):i.innerHTML=t;c.lastIndex=e}break;case"rowIndex":if("th"==c.target.tagName.toLowerCase()&&("th"==t.tagName.toLowerCase()||"td"==t.tagName.toLowerCase())&&t.parentElement.parentElement==c.target.parentElement.parentElement){e=u.getRowIndex(t);if(e<o.getColumnTitleFlag())return!1;t=t.getBoundingClientRect(),c.dummy.style.top=t.top+"px";if(e==c.lastIndex)return!1;n=c.target.parentElement.parentElement;if("move"==c.action)if(c.lastIndex>e)for(t=c.lastIndex;t>e;t--)i=u.getRow(t),s=u.getRow(t-1),n.insertBefore(s,i.nextSibling);else for(t=c.lastIndex;t<e;t++)i=u.getRow(t),s=u.getRow(t+1),n.insertBefore(s,i);else"alt"==c.action&&(i=u.getRow(e),t=i.nextSibling,s=u.getRow(c.lastIndex),r=s.nextSibling,e<c.lastIndex?t?n.insertBefore(s,i):n.appendChild(s):t?n.insertBefore(s,t):n.appendChild(s),c.index!=c.lastIndex?e!=c.index?(t=u.getRow(c.index),s=t.nextSibling,n.insertBefore(t,i),s?n.insertBefore(i,s):n.appendChild(i)):r?n.insertBefore(i,r):n.appendChild(i):r?n.insertBefore(i,r):n.appendChild(i));c.lastIndex=e}break;case"columnResize":n=c.target.getBoundingClientRect(),c.dummy.style.top=n.top+"px",c.dummy.style.left=e.clientX>c.targetRect.left+16?e.clientX+"px":c.targetRect.left+16+"px"}}},documentMouseUp:function(e){if(c){switch(c.type){case"columnIndex":e=o.getColumnData(c.index);var t=o.getRowSize();if("move"==c.action)if(c.index>c.lastIndex)for(var n=0;n<t;n++){for(var r=c.index;r>c.lastIndex;r--)o.setCellValue(a[n][r-1],u.getCell(n,r));o.setCellValue(e[n],u.getCell(n,c.lastIndex))}else for(n=0;n<t;n++){for(r=c.index;r<c.lastIndex;r++)o.setCellValue(a[n][r+1],u.getCell(n,r));o.setCellValue(e[n],u.getCell(n,c.lastIndex))}else if("alt"==c.action)for(n=0;n<t;n++)o.setCellValue(a[n][c.lastIndex],u.getCell(n,c.index)),o.setCellValue(e[n],u.getCell(n,c.lastIndex));c.dummy.parentElement.removeChild(c.dummy),u.refreshHead();break;case"rowIndex":e=o.getRowData(c.index).slice(),t=o.getColumnSize();if("move"==c.action)if(c.index>c.lastIndex)for(r=0;r<t;r++){for(n=c.index;n>c.lastIndex;n--)o.setCellValue(a[n-1][r],u.getCell(n,r));o.setCellValue(e[r],u.getCell(c.lastIndex,r))}else for(r=0;r<t;r++){for(n=c.index;n<c.lastIndex;n++)o.setCellValue(a[n+1][r],u.getCell(n,r));o.setCellValue(e[r],u.getCell(c.lastIndex,r))}else if("alt"==c.action)for(r=0;r<t;r++)o.setCellValue(a[c.lastIndex][r],u.getCell(c.index,r)),o.setCellValue(e[r],u.getCell(c.lastIndex,r));c.dummy.parentElement.removeChild(c.dummy),o.fillTable();break;case"columnResize":l[c.index]=c.dummy.offsetLeft-c.targetRect.left,u.refreshHead(),c.dummy.parentElement.removeChild(c.dummy)}c=!1}},tableKeyDown:function(e){e=e||event;if("input"==(e.target||e.srcElement).tagName.toLowerCase())return!0;switch(e.keyCode){case 9:if(!o.selectedCell)return o.selectCell(u.getCell(0,0)),!1;var t=o.selectedCell,n=u.getRowIndex(t),t=u.getColumnIndex(t);if(e.shiftKey)if(--t,0>t){n--;if(0>n)break;e=u.getCell(n,o.getColumnSize()-1)}else e=u.getCell(n,t);else if(t+=1,t>=o.getColumnSize()){n++;if(n>=o.getRowSize())break;e=u.getCell(n,0)}else e=u.getCell(n,t);return o.selectCell(e),!1;case 13:if(!o.selectedCell)return!1;return t=o.selectedCell,u.editCell(t),!1;case 37:if(!o.selectedCell)return o.selectCell(u.getCell(0,0)),!1;t=o.selectedCell,n=u.getRowIndex(t),t=u.getColumnIndex(t)-1;if(e.ctrlKey)t=0;else if(0>t)return!1;return e=u.getCell(n,t),o.selectCell(e),!1;case 38:if(!o.selectedCell)return o.selectCell(u.getCell(0,0)),!1;t=o.selectedCell,n=u.getRowIndex(t)-1,t=u.getColumnIndex(t);if(e.ctrlKey)n=0;else if(0>n)return!1;return e=u.getCell(n,t),o.selectCell(e),!1;case 39:if(!o.selectedCell)return o.selectCell(u.getCell(0,0)),!1;t=o.selectedCell,n=u.getRowIndex(t),t=u.getColumnIndex(t)+1;if(e.ctrlKey)t=o.getColumnSize()-1;else if(t>=o.getColumnSize())return!1;return e=u.getCell(n,t),o.selectCell(e),!1;case 40:if(!o.selectedCell)return o.selectCell(u.getCell(0,0)),!1;t=o.selectedCell,n=u.getRowIndex(t)+1,t=u.getColumnIndex(t);if(e.ctrlKey)n=o.getRowSize()-1;else if(n>=o.getRowSize())return!1;return e=u.getCell(n,t),o.selectCell(e),!1;case 46:if(!o.selectedCell)return!1;return t=o.selectedCell,o.setCellValue("",t),t.focus(),!1}},tableKeyUp:function(e){e=e||event;switch(e.keyCode){case 27:e.stopImmediatePropagation()}},inputKeyDown:function(e){e=e||event,-1<this.className.indexOf("number")&&(this.value=n(this.value));var t=this.parentElement;switch(e.keyCode){case 9:var r=u.getRowIndex(t),t=u.getColumnIndex(t);if(e.shiftKey)if(t--,0>t){r--;if(0>r){o.saveCell();break}e=u.getCell(r,o.getColumnSize()-1)}else e=u.getCell(r,t);else if(t++,t>=o.getColumnSize()){r++;if(r>=o.getRowSize()){o.saveCell();break}e=u.getCell(r,0)}else e=u.getCell(r,t);return u.editCell(e),!1;case 13:return t.focus(),!1;case 27:return o.modifyCell(!1,t),t.innerHTML=t.cellValue,t.focus(),!1;case 38:return r=u.getRowIndex(t),t=u.getColumnIndex(t),0<=r-1&&(e=u.getCell(r-1,t),u.editCell(e)),!1;case 40:return r=u.getRowIndex(t),t=u.getColumnIndex(t),r+1<o.getRowSize()&&(e=u.getCell(r+1,t),u.editCell(e)),!1}if(-1<this.className.indexOf("number")){this.value=n(this.value);if(109==e.keyCode||173==e.keyCode||189==e.keyCode)return-1<this.value.indexOf("-")||(this.value=n("-"+this.value)),!1;if(107==e.keyCode||(61==e.keyCode||187==e.keyCode)&&e.shiftKey)this.value=this.value.replace(/-/g,"");if(110==e.keyCode||190==e.keyCode)return-1<this.value.indexOf(".")?!1:!0;switch(e.keyCode){case 8:case 9:case 13:case 27:case 35:case 36:case 37:case 38:case 39:case 40:case 46:return!0;case 65:case 67:case 86:case 88:case 90:if(e.ctrlKey||e.metaKey)return!0}if(!(47<e.keyCode&&58>e.keyCode||95<e.keyCode&&106>e.keyCode))return!1}},inputKeyUp:function(e){-1<this.className.indexOf("number")&&(this.value=n(this.value))},inputBlur:function(e){-1<this.className.indexOf("number")&&(this.value=n(this.value)),o.saveCell()},cellClick:function(e){u.editCell(this)},setDragHandler:function(e){e.draggable=!0,e.style.cursor="move"}},this.onCellChange=t.event.onCellChange||s,e||(e="grid"),this.id=e,o=this,u=this.Table,i("","width:50px; padding: 0px; border: 1px solid #d5d5d5; border-spacing: 0px; empty-cells: show; border-collapse: collapse; line-height:normal; table-layout: fixed;  text-align: left; vertical-align: middle; font-size: 12px; font-family: Tahoma,'\ub3cb\uc6c0',Dotum,AppleGothic,sans-serif !important;"),i("th","height: 20px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; text-indent: 3px; padding: 0px;"),i("td","height: 20px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; text-indent: 3px; padding: 0px;"),i("th","background-color: #f2f2f2; height: 20px; color: #bfbfbf; text-align: center; cursor: default;"),i("span.resize","float: right; width: 8px; height: 18px; cursor: col-resize; margin: -2px -2px -2px 0;"),i("thead .blank","border-right: 1px solid #ffffff; border-bottom: 1px solid #ffffff;"),i("tbody th","border-right: 1px solid #535353; width: 16px;"),i("tbody tr","border-right: 1px solid #535353;"),i("tr.title td","border-top: 1px solid #535353;"),i(".title","background-color: #d1d1d1;"),i("td","border-right: 1px solid #b4b4b4; border-bottom: 1px solid #b4b4b4; color: #252525; cursor: cell;"),i("td.end","border-right: 1px solid #535353;"),i("tr.end td","border-bottom: 1px solid #535353;"),i("input","border-color: transparent; margin: 0px; background-color: transparent; font-size: 11px; font-family: Tahoma, \ub3cb\uc6c0, Dotum, AppleGothic, sans-serif;"),i(".selectedCell","box-shadow: 0 0 4px 1px #80a2d9 inset;"),u.createTable(),this.setData(t.data),t.data||(this.setRowSize(t.rowSize),this.setColumnSize(t.columnSize)),this.fillTable(!0),f=!0};