function onlyNumber(e){window.netscape?34<e.which&&41>e.which||47<e.which&&58>e.which||95<e.which&&106>e.which||8==e.which||9==e.which||13==e.which||46==e.which||(e.preventDefault?e.preventDefault():e.returnValue=!1):34<e.keyCode&&41>e.keyCode||47<e.keyCode&&58>e.keyCode||95<e.keyCode&&106>e.keyCode||8==e.keyCode||9==e.keyCode||13==e.keyCode||46==e.keyCode||(e.preventDefault?e.preventDefault():e.returnValue=!1)}function GetNode(e,t){return GetNodeIdx(e,t,0)}function GetNodeIdx(e,t,n){return e.getElementsByTagName(t)[n]}function GetNodeValue(e,t){return GetNodeValueIdx(e,t,0)}function GetNodeValueIdx(e,t,n){return e=GetNodeIdx(e,t,n),GetValue(e)}function GetValue(e){var t="";try{0<e.childNodes.length&&(t=e.firstChild.nodeValue)}catch(n){t="error"}return t}function SetDivinnerHTML(e,t){try{document.getElementById(e).innerHTML=t}catch(n){}}function SetDivouterHTML(e,t){try{document.getElementById(e).outerHTML=t}catch(n){}}function SetDivText(e,t){try{document.getElementById(e).innertText=t}catch(n){}}function xmlhttpPostXML(d,g,e,a){var c=!1;window.XMLHttpRequest&&!window.ActiveXObject?(c=new XMLHttpRequest,c.overrideMimeType("text/xml")):window.ActiveXObject&&(c=new ActiveXObject("Microsoft.XMLHTTP")),c.open("GET",d,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.onreadystatechange=function(){4==c.readyState&&eval(e)(c.responseXML,a)},c.send();if(4==c.readyState)switch(g=c.responseXML,c.status){case 404:alert("Error: Not Found. The requested URL "+d+" could not be found.");break;case 500:handleErrFullPage(g);break;default:-1<g.indexOf("Error:")||-1<g.indexOf("Debug:")?alert(g):eval(e+"(strResponse);")}}function xmlAdmin(d,g){var e=document.getElementById("xml_value"),a,c,k=GetNode(d,"dext5");if("1"==g){var f=GetNode(k,"license"),b=GetNodeValue(f,"product_key");a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","product_key"),a.setAttribute("name","product_key"),a.setAttribute("value",b),e.appendChild(a),""!=b&&(a=b.split("-"),document.getElementById("product_key_1").value=a[0],document.getElementById("product_key_2").value=a[1],document.getElementById("product_key_3").value=a[2],document.getElementById("product_key_4").value=a[3]),b=GetNodeValue(f,"license_key"),document.getElementById("license_key").value=b,c=GetNodeValue(f,"plugin_use");for(b=0;b<dext5_admin_lang.plugin_use_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.plugin_use_value[b]),a.innerHTML=dext5_admin_lang.plugin_use_text[b],document.getElementById("plugin_use").appendChild(a),dext5_admin_lang.plugin_use_value[b]==c&&(a.selected=!0);b=GetNodeValue(f,"print_header"),c=GetNodeValue(f,"print_footer"),"1"==document.getElementById("plugin_use").value&&(document.getElementById("tr_mime_use").style.display="",document.getElementById("tr_print_preview").style.display="",document.getElementById("tr_print_header").style.display="",document.getElementById("tr_print_footer").style.display="",""!=b?(document.getElementById("chk_print_header").checked=!1,document.getElementById("print_header").disabled=!1,document.getElementById("print_header_desc").innerHTML=dext5_admin_lang.print_header_desc2,document.getElementById("print_header").value=b):(document.getElementById("print_header").disabled="disabled",document.getElementById("print_header_desc").innerHTML=dext5_admin_lang.print_header_desc1),""!=c?(document.getElementById("chk_print_footer").checked=!1,document.getElementById("print_footer").disabled=!1,document.getElementById("print_footer_desc").innerHTML=dext5_admin_lang.print_footer_desc2,document.getElementById("print_footer").value=c):(document.getElementById("print_footer").disabled="disabled",document.getElementById("print_footer_desc").innerHTML=dext5_admin_lang.print_footer_desc1)),b=GetNodeValue(f,"mime_use"),"1"==b?document.getElementById("mime_use").value="1":document.getElementById("mime_use").value="0",b=GetNodeValue(f,"print_preview"),"1"==b?document.getElementById("print_preview").value="1":document.getElementById("print_preview").value="0"}else f=GetNode(k,"license"),b=GetNodeValue(f,"product_key"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","product_key"),a.setAttribute("name","product_key"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"license_key"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","license_key"),a.setAttribute("name","license_key"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"plugin_use"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","plugin_use"),a.setAttribute("name","plugin_use"),"error"==c?a.setAttribute("value","0"):a.setAttribute("value",c),e.appendChild(a),b=GetNodeValue(f,"mime_use"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","mime_use"),a.setAttribute("name","mime_use"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"print_preview"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","print_preview"),a.setAttribute("name","print_preview"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"print_header"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","print_header"),a.setAttribute("name","print_header"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"print_footer"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","print_footer"),a.setAttribute("name","print_footer"),a.setAttribute("value",c),e.appendChild(a);GetNode(k,"work_config");if("2"==g){f=GetNode(k,"top_menu"),c=f.getElementsByTagName("menu").length;for(b=0;b<c;b++){var l=GetNodeValueIdx(f,"menu",b);a=document.createElement("option"),a.setAttribute("value",l),a.innerHTML=eval("dext5_admin_lang.top_menu."+l),document.getElementById("set_menu").appendChild(a),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","top_menu_pre"),a.setAttribute("name","top_menu_pre"),a.setAttribute("value",l),e.appendChild(a)}for(b=0;b<dext5_admin_lang.top_menu_value.length;b++){a=!1;for(f=0;f<document.getElementById("set_menu").length;f++)if(dext5_admin_lang.top_menu_value[b]==document.getElementById("set_menu").options[f].value){a=!0;break}a||(a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.top_menu_value[b]),a.innerHTML=dext5_admin_lang.top_menu_text[b],document.getElementById("all_menu").appendChild(a))}}else for(f=GetNode(k,"top_menu"),c=f.getElementsByTagName("menu").length,b=0;b<c;b++)l=GetNodeValueIdx(f,"menu",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","top_menu"),a.setAttribute("name","top_menu[]"),a.setAttribute("value",l),e.appendChild(a);if("3"==g){l=GetNode(k,"tool_bar_1"),c=l.getElementsByTagName("tool").length;for(b=0;b<c;b++)f=GetNodeValueIdx(l,"tool",b),a=document.createElement("option"),a.setAttribute("value",f),"c_"==f.substring(0,2)?a.innerHTML=f:a.innerHTML=eval("dext5_admin_lang.tool_bar."+f),document.getElementById("set_menu1").appendChild(a),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","tool_bar_1_pre"),a.setAttribute("name","tool_bar_1_pre"),a.setAttribute("value",f),e.appendChild(a);l=GetNode(k,"tool_bar_2"),c=l.getElementsByTagName("tool").length;for(b=0;b<c;b++)f=GetNodeValueIdx(l,"tool",b),a=document.createElement("option"),a.setAttribute("value",f),"c_"==f.substring(0,2)?a.innerHTML=f:a.innerHTML=eval("dext5_admin_lang.tool_bar."+f),document.getElementById("set_menu2").appendChild(a),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","tool_bar_2_pre"),a.setAttribute("name","tool_bar_2_pre"),a.setAttribute("value",f),e.appendChild(a);for(b=0;b<dext5_admin_lang.tool_bar_value.length;b++){a=!1;for(f=0;f<document.getElementById("set_menu1").length;f++)if(dext5_admin_lang.tool_bar_value[b]==document.getElementById("set_menu1").options[f].value){a="separator"==document.getElementById("set_menu1").options[f].value?!1:!0;break}for(f=0;f<document.getElementById("set_menu2").length;f++)if(dext5_admin_lang.tool_bar_value[b]==document.getElementById("set_menu2").options[f].value){a="separator"==document.getElementById("set_menu2").options[f].value?!1:!0;break}a||(a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.tool_bar_value[b]),a.innerHTML=dext5_admin_lang.tool_bar_text[b],document.getElementById("all_menu").appendChild(a))}}else{l=GetNode(k,"tool_bar_1"),c=l.getElementsByTagName("tool").length;for(b=0;b<c;b++)f=GetNodeValueIdx(l,"tool",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","tool_bar_1"),a.setAttribute("name","tool_bar_1[]"),a.setAttribute("value",f),e.appendChild(a);l=GetNode(k,"tool_bar_2"),c=l.getElementsByTagName("tool").length;for(b=0;b<c;b++)f=GetNodeValueIdx(l,"tool",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","tool_bar_2"),a.setAttribute("name","tool_bar_2[]"),a.setAttribute("value",f),e.appendChild(a)}if("4"==g){l=GetNode(k,"status_bar"),c=l.getElementsByTagName("status").length;for(b=0;b<c;b++)f=GetNodeValueIdx(l,"status",b),a=document.createElement("option"),a.setAttribute("value",f),a.innerHTML=eval("dext5_admin_lang.status_bar."+f),document.getElementById("set_menu").appendChild(a),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","status_bar_pre"),a.setAttribute("name","status_bar_pre"),a.setAttribute("value",f),e.appendChild(a);for(b=0;b<dext5_admin_lang.status_bar_value.length;b++){a=!1;for(f=0;f<document.getElementById("set_menu").length;f++)if(dext5_admin_lang.status_bar_value[b]==document.getElementById("set_menu").options[f].value){a=!0;break}a||(a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.status_bar_value[b]),a.innerHTML=dext5_admin_lang.status_bar_text[b],document.getElementById("all_menu").appendChild(a))}}else for(l=GetNode(k,"status_bar"),c=l.getElementsByTagName("status").length,b=0;b<c;b++)f=GetNodeValueIdx(l,"status",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","status_bar"),a.setAttribute("name","status_bar[]"),a.setAttribute("value",f),e.appendChild(a);if("5"==g){l=GetNode(k,"remove_item"),c=l.getElementsByTagName("item").length;for(b=0;b<c;b++)f=GetNodeValueIdx(l,"item",b),a=document.createElement("option"),a.setAttribute("value",f),a.innerHTML=eval("dext5_admin_lang.remove_item."+f),document.getElementById("set_menu").appendChild(a);for(b=0;b<dext5_admin_lang.remove_item_value.length;b++){a=!1;for(f=0;f<document.getElementById("set_menu").length;f++)if(dext5_admin_lang.remove_item_value[b]==document.getElementById("set_menu").options[f].value){a=!0;break}a||(a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.remove_item_value[b]),a.innerHTML=dext5_admin_lang.remove_item_text[b],document.getElementById("all_menu").appendChild(a))}}else for(l=GetNode(k,"remove_item"),c=l.getElementsByTagName("item").length,b=0;b<c;b++)f=GetNodeValueIdx(l,"item",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","remove_item"),a.setAttribute("name","remove_item[]"),a.setAttribute("value",f),e.appendChild(a);if("6"==g)for(l=GetNode(k,"font_size"),c=l.getElementsByTagName("size").length,b=0;b<c;b++){var h=GetNodeValueIdx(l,"size",b);a=document.createElement("option"),a.setAttribute("value",h),a.innerHTML=h,document.getElementById("set_font_size").appendChild(a)}else for(l=GetNode(k,"font_size"),c=l.getElementsByTagName("size").length,b=0;b<c;b++)h=GetNodeValueIdx(l,"size",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","font_size"),a.setAttribute("name","font_size[]"),a.setAttribute("value",h),e.appendChild(a);if("7"==g){l=GetNode(k,"font_family"),c=l.getElementsByTagName("font").length;for(b=0;b<c;b++)h=GetNodeValueIdx(l,"font",b),a=document.createElement("option"),a.setAttribute("value",h),a.innerHTML=h,document.getElementById("set_font_family").appendChild(a);for(b=0;b<dext5_admin_lang.font_family.length;b++){a=!1;for(f=0;f<document.getElementById("set_font_family").length;f++)if(dext5_admin_lang.font_family[b]==document.getElementById("set_font_family").options[f].value){a=!0;break}a||(a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.font_family[b]),a.innerHTML=dext5_admin_lang.font_family[b],document.getElementById("all_font_family").appendChild(a))}}else for(l=GetNode(k,"font_family"),c=l.getElementsByTagName("font").length,b=0;b<c;b++)h=GetNodeValueIdx(l,"font",b),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","font_family"),a.setAttribute("name","font_family[]"),a.setAttribute("value",h),e.appendChild(a);if("8"==g){f=GetNode(k,"setting"),b=GetNodeValue(f,"grid_color"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_color"),a.setAttribute("name","grid_color"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"grid_color_nm"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_color_nm"),a.setAttribute("name","grid_color_nm"),a.setAttribute("value",c),e.appendChild(a),""==b?(document.getElementById("grid_color_value").style.backgroundColor="#8b0000",document.getElementById("grid_color_text").innerHTML="Dark Red"):(document.getElementById("grid_color_value").style.backgroundColor=b,document.getElementById("grid_color_text").innerHTML=c),a=document.createElement("ul");for(b=0;b<dext5_admin_lang.grid_color_value.length;b++){var m=dext5_admin_lang.grid_color_value[b];c=dext5_admin_lang.grid_color_text[b],l=document.createElement("li"),l.onclick=function(e,t){return function(){document.getElementById("grid_color_value").style.backgroundColor=e,document.getElementById("grid_color_text").innerHTML=t,document.getElementById("grid_color").value=e,document.getElementById("grid_color_nm").value=t,document.getElementById("grid_color_flag").value="N",document.getElementById("grid_color_list").style.display="none"}}(m,c),h=document.createElement("a"),h.className="sebt",h.title=c;var n=document.createElement("span");n.className="cr",n.style.backgroundColor=m,m=document.createElement("span"),m.className="crn",m.innerHTML=c,h.appendChild(n),h.appendChild(m),l.appendChild(h),a.appendChild(l)}document.getElementById("grid_color_list").appendChild(a),c=GetNodeValue(f,"grid_spans");for(b=0;b<dext5_admin_lang.grid_spans.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.grid_spans[b]),a.innerHTML=dext5_admin_lang.grid_spans[b],document.getElementById("grid_spans").appendChild(a),dext5_admin_lang.grid_spans[b]==c&&(a.selected=!0);c=GetNodeValue(f,"grid_form"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_form"),a.setAttribute("name","grid_form"),a.setAttribute("value",c),e.appendChild(a);for(b=0;b<document.getElementsByName("grid_form_radio").length;b++)document.getElementsByName("grid_form_radio")[b].value==c&&(document.getElementsByName("grid_form_radio")[b].checked=!0);c=GetNodeValue(f,"encoding");for(b=0;b<dext5_admin_lang.encoding_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.encoding_value[b]),a.innerHTML=dext5_admin_lang.encoding_text[b],document.getElementById("encoding").appendChild(a),dext5_admin_lang.encoding_value[b]==c&&(a.selected=!0);c=GetNodeValue(f,"doctype");for(b=0;b<dext5_admin_lang.doctype_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.doctype_value[b]),a.innerHTML=dext5_admin_lang.doctype_text[b],document.getElementById("doctype").appendChild(a),dext5_admin_lang.doctype_value[b]==c&&(a.selected=!0);b=GetNodeValue(f,"xmlnsname"),document.getElementById("xmlnsname").value=b,c=GetNodeValue(f,"doc_lang");for(b=0;b<dext5_admin_lang.doc_lang.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.doc_lang[b]),a.innerHTML=dext5_admin_lang.doc_lang[b],document.getElementById("doc_lang").appendChild(a),dext5_admin_lang.doc_lang[b]==c&&(a.selected=!0);c=GetNodeValue(f,"lang");for(b=0;b<document.getElementById("lang").length;b++)document.getElementById("lang").options[b].value==c&&(document.getElementById("lang").options[b].selected=!0);b=GetNodeValue(f,"width"),-1<b.indexOf("%")?document.getElementById("width_unit").value="%":document.getElementById("width_unit").value="px",document.getElementById("width").value=parseInt(b,10),b=GetNodeValue(f,"height"),-1<b.indexOf("%")?document.getElementById("height_unit").value="%":document.getElementById("height_unit").value="px",document.getElementById("height").value=parseInt(b,10),c=GetNodeValue(f,"skinname"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","skinname"),a.setAttribute("name","skinname"),""==c?a.setAttribute("value","blue"):a.setAttribute("value",c),e.appendChild(a),a=0;if(""!=c)for(b=0;b<dext5_admin_lang.skinname_value.length;b++)dext5_admin_lang.skinname_text[b].toLowerCase()==c&&(a=b);document.getElementById("skinname_value").style.backgroundColor=dext5_admin_lang.skinname_value[a],document.getElementById("skinname_text").innerHTML=dext5_admin_lang.skinname_text[a],a=document.createElement("ul");for(b=0;b<dext5_admin_lang.skinname_value.length;b++)m=dext5_admin_lang.skinname_value[b],c=dext5_admin_lang.skinname_text[b],l=document.createElement("li"),l.onclick=function(e,t){return function(){document.getElementById("skinname_value").style.backgroundColor=e,document.getElementById("skinname_text").innerHTML=t,document.getElementById("skinname").value=t.toLowerCase(),document.getElementById("skinname_flag").value="N",document.getElementById("skinname_list").style.display="none"}}(m,c),h=document.createElement("a"),h.className="sebt",h.title=c,n=document.createElement("span"),n.className="cr",n.style.backgroundColor=m,m=document.createElement("span"),m.className="crn",m.innerHTML=c,h.appendChild(n),h.appendChild(m),l.appendChild(h),a.appendChild(l);document.getElementById("skinname_list").appendChild(a),l=GetNodeValue(f,"font_family"),n=GetNode(k,"font_family"),c=n.getElementsByTagName("font").length;for(b=0;b<c;b++)h=GetNodeValueIdx(n,"font",b),a=document.createElement("option"),a.setAttribute("value",h),a.innerHTML=h,document.getElementById("setting_font_family").appendChild(a),h==l&&(a.selected=!0);l=GetNodeValue(f,"font_size"),n=GetNode(k,"font_size"),c=n.getElementsByTagName("size").length;for(b=0;b<c;b++)h=GetNodeValueIdx(n,"size",b),a=document.createElement("option"),a.setAttribute("value",h),a.innerHTML=h,document.getElementById("setting_font_size").appendChild(a),h==l&&(a.selected=!0);l=GetNodeValue(f,"line_height"),h=dext5_admin_lang.line_height,c=h.length;for(b=0;b<c;b++)a=document.createElement("option"),a.setAttribute("value",h[b]),a.innerHTML=h[b],document.getElementById("line_height").appendChild(a),l==h[b]&&(a.selected=!0);b=GetNodeValue(f,"show_font_real"),"1"==b?document.getElementById("show_font_real").value="1":document.getElementById("show_font_real").value="0",c=GetNodeValue(f,"accessibility");for(b=0;b<dext5_admin_lang.accessibility_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.accessibility_value[b]),a.innerHTML=dext5_admin_lang.accessibility_text[b],document.getElementById("accessibility").appendChild(a),dext5_admin_lang.accessibility_value[b]==c&&(a.selected=!0);c=GetNodeValue(f,"topmenu");for(b=0;b<dext5_admin_lang.topmenu_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.topmenu_value[b]),a.innerHTML=dext5_admin_lang.topmenu_text[b],document.getElementById("topmenu").appendChild(a),dext5_admin_lang.topmenu_value[b]==c&&(a.selected=!0);c=GetNodeValue(f,"toolbar");for(b=0;b<dext5_admin_lang.toolbar_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.toolbar_value[b]),a.innerHTML=dext5_admin_lang.toolbar_text[b],document.getElementById("toolbar").appendChild(a),dext5_admin_lang.toolbar_value[b]==c&&(a.selected=!0);c=GetNodeValue(f,"statusbar");for(b=0;b<dext5_admin_lang.statusbar_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.statusbar_value[b]),a.innerHTML=dext5_admin_lang.statusbar_text[b],document.getElementById("statusbar").appendChild(a),dext5_admin_lang.statusbar_value[b]==c&&(a.selected=!0);c=GetNodeValue(f,"showdialog_pos");for(b=0;b<dext5_admin_lang.showdialog_pos_value.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.showdialog_pos_value[b]),a.innerHTML=dext5_admin_lang.showdialog_pos_text[b],document.getElementById("showdialog_pos").appendChild(a),dext5_admin_lang.showdialog_pos_value[b]==c&&(a.selected=!0);b=GetNodeValue(f,"source_viewtype"),"1"==b?document.getElementById("source_viewtype").value="1":document.getElementById("source_viewtype").value="0",b=GetNodeValue(f,"user_css_url"),""!=b?(document.getElementById("user_css_url").value=b,document.getElementById("user_css_url").disabled=!1,document.getElementById("chk_user_css_url").checked=!1,document.getElementById("user_css_url_desc").innerHTML=dext5_admin_lang.user_css_url_desc2):(document.getElementById("user_css_url").disabled="disabled",document.getElementById("user_css_url_desc").innerHTML=dext5_admin_lang.user_css_url_desc1),b=GetNodeValue(f,"xhtml_value"),"1"==b?document.getElementById("xhtml_value").value=b:document.getElementById("xhtml_value").value="0",b=GetNodeValue(f,"view_mode_auto_height"),"1"==b?document.getElementById("view_mode_auto_height").value=b:document.getElementById("view_mode_auto_height").value="0",b=GetNodeValue(f,"system_title"),""!=b&&"error"!=b?document.getElementById("system_title").value=b:document.getElementById("system_title").value="",b=GetNodeValue(f,"table_auto_adjust"),"1"==b?document.getElementById("table_auto_adjust").value=b:document.getElementById("table_auto_adjust").value="0"}else f=GetNode(k,"setting"),b=GetNodeValue(f,"grid_color"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_color"),a.setAttribute("name","grid_color"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"grid_color_nm"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_color_nm"),a.setAttribute("name","grid_color_nm"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"grid_spans"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_spans"),a.setAttribute("name","grid_spans"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"grid_form"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","grid_form"),a.setAttribute("name","grid_form"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"encoding"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","encoding"),a.setAttribute("name","encoding"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"doctype"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","doctype"),a.setAttribute("name","doctype"),a.setAttribute("value",c),e.appendChild(a),b=GetNodeValue(f,"xmlnsname"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","xmlnsname"),a.setAttribute("name","xmlnsname"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"doc_lang"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","doc_lang"),a.setAttribute("name","doc_lang"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"lang"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","lang"),a.setAttribute("name","lang"),a.setAttribute("value",c),e.appendChild(a),b=GetNodeValue(f,"width"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","width"),a.setAttribute("name","width"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"height"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","height"),a.setAttribute("name","height"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"skinname"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","skinname"),a.setAttribute("name","skinname"),a.setAttribute("value",c),e.appendChild(a),l=GetNodeValue(f,"font_family"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","setting_font_family"),a.setAttribute("name","setting_font_family"),a.setAttribute("value",l),e.appendChild(a),l=GetNodeValue(f,"font_size"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","setting_font_size"),a.setAttribute("name","setting_font_size"),a.setAttribute("value",l),e.appendChild(a),l=GetNodeValue(f,"line_height"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","line_height"),a.setAttribute("name","line_height"),a.setAttribute("value",l),e.appendChild(a),b=GetNodeValue(f,"show_font_real"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","show_font_real"),a.setAttribute("name","show_font_real"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"accessibility"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","accessibility"),a.setAttribute("name","accessibility"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"topmenu"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","topmenu"),a.setAttribute("name","topmenu"),a.setAttribute("value",c),e.appendChild(a),"2"==g&&("0"==c?document.getElementById("topmenu_none").checked=!1:"1"==c&&(document.getElementById("topmenu_none").checked=!0,document.getElementById("all_menu").disabled=!0,document.getElementById("set_menu").disabled=!0,document.getElementById("all_right").style.display="none",document.getElementById("right").style.display="none",document.getElementById("all_left").style.display="none",document.getElementById("left").style.display="none",document.getElementById("top").style.display="none",document.getElementById("bottom").style.display="none",e.appendChild(a))),c=GetNodeValue(f,"toolbar"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","toolbar"),a.setAttribute("name","toolbar"),a.setAttribute("value",c),e.appendChild(a),"3"==g&&("0"==c?(document.getElementById("toolbar1_none").checked=!1,document.getElementById("toolbar2_none").checked=!1):"1"==c?(document.getElementById("toolbar1_none").checked=!0,document.getElementById("toolbar2_none").checked=!1,document.getElementById("set_menu1").disabled=!0,document.getElementById("all_right1").style.display="none",document.getElementById("right1").style.display="none",document.getElementById("all_left1").style.display="none",document.getElementById("left1").style.display="none",document.getElementById("top1").style.display="none",document.getElementById("bottom1").style.display="none"):"2"==c?(document.getElementById("toolbar1_none").checked=!1,document.getElementById("toolbar2_none").checked=!0,document.getElementById("set_menu2").disabled=!0,document.getElementById("all_right2").style.display="none",document.getElementById("right2").style.display="none",document.getElementById("all_left2").style.display="none",document.getElementById("left2").style.display="none",document.getElementById("top2").style.display="none",document.getElementById("bottom2").style.display="none"):"3"==c&&(document.getElementById("toolbar1_none").checked=!0,document.getElementById("toolbar2_none").checked=!0,document.getElementById("all_menu").disabled=!0,document.getElementById("set_menu1").disabled=!0,document.getElementById("all_right1").style.display="none",document.getElementById("right1").style.display="none",document.getElementById("all_left1").style.display="none",document.getElementById("left1").style.display="none",document.getElementById("top1").style.display="none",document.getElementById("bottom1").style.display="none",document.getElementById("set_menu2").disabled=!0,document.getElementById("all_right2").style.display="none",document.getElementById("right2").style.display="none",document.getElementById("all_left2").style.display="none",document.getElementById("left2").style.display="none",document.getElementById("top2").style.display="none",document.getElementById("bottom2").style.display="none")),c=GetNodeValue(f,"statusbar"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","statusbar"),a.setAttribute("name","statusbar"),a.setAttribute("value",c),e.appendChild(a),"4"==g&&("0"==c?document.getElementById("statusbar_none").checked=!1:"1"==c&&(document.getElementById("statusbar_none").checked=!0,document.getElementById("all_menu").disabled=!0,document.getElementById("set_menu").disabled=!0,document.getElementById("all_right").style.display="none",document.getElementById("right").style.display="none",document.getElementById("all_left").style.display="none",document.getElementById("left").style.display="none",document.getElementById("top").style.display="none",document.getElementById("bottom").style.display="none",e.appendChild(a))),c=GetNodeValue(f,"showdialog_pos"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","showdialog_pos"),a.setAttribute("name","showdialog_pos"),a.setAttribute("value",c),e.appendChild(a),b=GetNodeValue(f,"source_viewtype"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","source_viewtype"),a.setAttribute("name","source_viewtype"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"user_css_url"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","user_css_url"),a.setAttribute("name","user_css_url"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"xhtml_value"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","xhtml_value"),a.setAttribute("name","xhtml_value"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"view_mode_auto_height"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","view_mode_auto_height"),a.setAttribute("name","view_mode_auto_height"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"system_title"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","system_title"),a.setAttribute("name","system_title"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"table_auto_adjust"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","table_auto_adjust"),a.setAttribute("name","table_auto_adjust"),a.setAttribute("value",b),e.appendChild(a);if("9"==g){f=GetNode(k,"uploader_setting"),c=GetNodeValue(f,"develop_langage");for(b=0;b<dext5_admin_lang.develop_langage.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.develop_langage[b]),a.innerHTML=dext5_admin_lang.develop_langage[b],document.getElementById("develop_langage").appendChild(a),dext5_admin_lang.develop_langage[b]==c&&(a.selected=!0);b=GetNodeValue(f,"handler_url"),""==b?(document.getElementById("chk_handler_url").checked="checked",document.getElementById("handler_url").disabled="disabled",document.getElementById("span_desc").innerHTML=dext5_admin_lang.upload_url_desc1):(document.getElementById("chk_handler_url").checked=!1,document.getElementById("handler_url").disabled=!1,document.getElementById("span_desc").innerHTML=dext5_admin_lang.upload_url_desc2),document.getElementById("handler_url").value=b,a=GetNodeValue(f,"server_domain"),""==a?(document.getElementById("chk_server_domain").checked="checked",document.getElementById("server_domain").disabled="disabled",document.getElementById("span_desc3").innerHTML=dext5_admin_lang.server_domain_desc1):(document.getElementById("chk_server_domain").checked=!1,document.getElementById("server_domain").disabled=!1,document.getElementById("span_desc3").innerHTML=dext5_admin_lang.server_domain_desc2),document.getElementById("server_domain").value=a,b=GetNodeValue(f,"to_save_path_url"),""==b?(document.getElementById("chk_to_save_path_url").checked="checked",document.getElementById("to_save_path_url").disabled="disabled",document.getElementById("span_desc2").innerHTML=dext5_admin_lang.save_path_desc1):(document.getElementById("chk_to_save_path_url").checked=!1,document.getElementById("to_save_path_url").disabled=!1,document.getElementById("span_desc2").innerHTML=dext5_admin_lang.save_path_desc2),document.getElementById("to_save_path_url").value=b,c=GetNodeValue(f,"save_foldername_rule");for(b=0;b<dext5_admin_lang.save_foldername_rule.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.save_foldername_rule[b]),a.innerHTML=""==dext5_admin_lang.save_foldername_rule[b]?"None":dext5_admin_lang.save_foldername_rule[b],document.getElementById("save_foldername_rule").appendChild(a),dext5_admin_lang.save_foldername_rule[b]==c&&(a.selected=!0);c=GetNodeValue(f,"save_filename_rule");for(b=0;b<dext5_admin_lang.save_filename_rule.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.save_filename_rule[b]),a.innerHTML=""==dext5_admin_lang.save_filename_rule[b]?"None":dext5_admin_lang.save_filename_rule[b],document.getElementById("save_filename_rule").appendChild(a),dext5_admin_lang.save_filename_rule[b]==c&&(a.selected=!0);c=GetNodeValue(f,"image_convert_format");for(b=0;b<dext5_admin_lang.image_convert_format.length;b++)a=document.createElement("option"),a.setAttribute("value",dext5_admin_lang.image_convert_format[b]),a.innerHTML=""==dext5_admin_lang.image_convert_format[b]?"None":dext5_admin_lang.image_convert_format[b],document.getElementById("image_convert_format").appendChild(a),dext5_admin_lang.image_convert_format[b]==c&&(a.selected=!0);b=GetNodeValue(f,"image_convert_width"),document.getElementById("image_convert_width").value=b,b=GetNodeValue(f,"image_convert_height"),document.getElementById("image_convert_height").value=b,b=GetNodeValue(f,"image_auto_fit"),"1"==b?document.getElementById("image_auto_fit").value=b:document.getElementById("image_auto_fit").value="0"}else f=GetNode(k,"uploader_setting"),c=GetNodeValue(f,"develop_langage"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","develop_langage"),a.setAttribute("name","develop_langage"),a.setAttribute("value",c),e.appendChild(a),b=GetNodeValue(f,"handler_url"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","handler_url"),a.setAttribute("name","handler_url"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"to_save_path_url"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","to_save_path_url"),a.setAttribute("name","to_save_path_url"),a.setAttribute("value",b),e.appendChild(a),c=GetNodeValue(f,"save_foldername_rule"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","save_foldername_rule"),a.setAttribute("name","save_foldername_rule"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"save_filename_rule"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","save_filename_rule"),a.setAttribute("name","save_filename_rule"),a.setAttribute("value",c),e.appendChild(a),c=GetNodeValue(f,"image_convert_format"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","image_convert_format"),a.setAttribute("name","image_convert_format"),a.setAttribute("value",c),e.appendChild(a),b=GetNodeValue(f,"image_convert_width"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","image_convert_width"),a.setAttribute("name","image_convert_width"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"image_convert_height"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","image_convert_height"),a.setAttribute("name","image_convert_height"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(f,"image_auto_fit"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","image_auto_fit"),a.setAttribute("name","image_auto_fit"),a.setAttribute("value",b),e.appendChild(a);if("10"==g){k=GetNode(k,"xss_protection"),b=GetNodeValue(k,"xss_use"),"1"==b?document.getElementById("xss_use").value="1":document.getElementById("xss_use").value="0",b=GetNodeValue(k,"xss_remove_tags");if(""!=b)for(e=b.split(","),b=0;b<e.length;b++)a=document.createElement("option"),a.value=e[b],a.innerHTML=e[b],document.getElementById("set_remove_tag").appendChild(a);k=GetNodeValue(k,"xss_remove_events");if(""!=k)if("all"==k)document.getElementById("chk_all_remove").checked=!0,check_event_all(!0);else for(e=k.split(","),b=0;b<e.length;b++)a=document.createElement("option"),a.value=e[b],a.innerHTML=e[b],document.getElementById("set_remove_event").appendChild(a)}else k=GetNode(k,"xss_protection"),b=GetNodeValue(k,"xss_use"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","xss_use"),a.setAttribute("name","xss_use"),a.setAttribute("value",b),e.appendChild(a),b=GetNodeValue(k,"xss_remove_tags"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","xss_remove_tags"),a.setAttribute("name","xss_remove_tags"),a.setAttribute("value",b),e.appendChild(a),k=GetNodeValue(k,"xss_remove_events"),a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("id","xss_remove_events"),a.setAttribute("name","xss_remove_events"),a.setAttribute("value",k),e.appendChild(a)}function move_all_option(e,t,n){for(var r=[],i=0;i<e.length;i++){if("design"!=e.options[i].value){r.push(e.options[i]);var s=document.createElement("option");s.value=e.options[i].value,s.innerHTML=e.options[i].innerHTML,t.appendChild(s)}if(i==e.length-1)for(s=0;s<r.length;s++)r[s].value!=n&&e.removeChild(r[s])}}function move_option(e,t,n){for(var r=[],i=0;i<e.length;i++){if(1==e.options[i].selected){var s=document.createElement("option");s.value=e.options[i].value,s.innerHTML=e.options[i].innerHTML,t.appendChild(s),r.push(e.options[i])}if(i==e.length-1)for(s=0;s<r.length;s++)r[s].value!=n&&e.removeChild(r[s])}}function upExcute(e){for(var t=e.length,n=[],r=0;r<t;r++)if(1==e.options[r].selected&&(n.push(e.options[r]),0<=r-1&&n[0]!=e.options[0])){var i=e.options[r-1].value,s=e.options[r-1].innerHTML;e.options[r-1].value=e.options[r].value,e.options[r-1].innerHTML=e.options[r].innerHTML,e.options[r].value=i,e.options[r].innerHTML=s,e.options[r-1].selected=!0,e.options[r].selected=!1}}function bottomExcute(e){for(var t=e.length,n=[],r=t-1;0<=r;r--)1==e.options[r].selected&&n.push(e.options[r]);for(r=t-1;0<=r&&n[0]!=e.options[t-1];r--)if(1==e.options[r].selected&&r+1<=t-1){var i=e.options[r+1].value,s=e.options[r+1].innerHTML;e.options[r+1].value=e.options[r].value,e.options[r+1].innerHTML=e.options[r].innerHTML,e.options[r].value=i,e.options[r].innerHTML=s,e.options[r+1].selected=!0,e.options[r].selected=!1}}function setCookieSave(e,t,n){var r=new Date;r.setDate(r.getDate()+n),document.cookie=e+"="+escape(t)+"; path=/; expires="+r.toGMTString()+";"}function getLoginCookei(){var e=document.cookie+";",t=e.indexOf("id",0),n="";-1!=t&&(e=e.substring(t,e.length),begin=e.indexOf("=",0)+1,end=e.indexOf(";",begin),n=unescape(e.substring(begin,end))),""!=n&&(document.getElementById("id").value=n,document.getElementById("id_check").checked=!0)}function templeteConfigSet(e){xmlhttpPostXML(e,"","xmlTempleteConfig","")}function xmlTempleteConfig(e,t){if(null==e)alert("\ufffd\u0537\ufffd\ufffd\u03fd\ufffd \ufffd\ufffd\ufffd\u00f8\ufffd Config \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\u03bf\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u02bd\ufffd\ufffd\u03f4\ufffd."),document.getElementById("prev_config_path").focus();else{var n=GetNode(e,"dext5"),r=document.getElementById("ul_class"),i=document.getElementById("ul_templete");r.innerHTML="",i.innerHTML="";for(var i=n.getElementsByTagName("FormList").length,s=0;s<i;s++){var o=GetNodeIdx(n,"FormList",s),u=o.getAttribute("Name"),a=document.createElement("li");a.setAttribute("onclick","javascript:classClick("+s+")");var f=document.createElement("span"),l=document.createElement("img");l.setAttribute("src","../../../images/editor/dialog/close_folder.gif"),l.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd"),f.appendChild(l),a.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",a.appendChild(f),f=document.createElement("span"),f.setAttribute("class","li_title"),f.innerHTML=u,a.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",a.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_modify.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),f.setAttribute("onclick","javascript:classModify("+s+")"),a.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",a.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_delete.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),f.setAttribute("onclick","javascript:classDelete("+s+")"),a.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",a.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_up.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),f.setAttribute("onclick","javascript:classUp("+s+")"),a.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",a.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_down.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("alt","\ufffd\u01b7\ufffd\ufffd\ufffd"),f.setAttribute("onclick","javascript:classDown("+s+")"),a.appendChild(f),f=document.createElement("input"),f.setAttribute("type","hidden"),f.setAttribute("name","class[]"),f.setAttribute("value",u),a.appendChild(f),u=document.createElement("input"),u.setAttribute("type","hidden"),u.setAttribute("value","0"),a.appendChild(u),r.appendChild(a),a=o.getElementsByTagName("FORM").length,templete_array[s]="";for(u=0;u<a;u++)l=GetNodeIdx(o,"FORM",u),f=l.getAttribute("FormName"),l=l.getAttribute("url"),templete_array[s]+=f+"\f"+l,u!=a-1&&(templete_array[s]+="")}templeteAreaSet()}}function templeteAreaSet(){var e=document.getElementById("ul_templete");e.innerHTML="";for(var t=templete_array.length,n=0;n<t;n++)if(""!=templete_array[n])for(var r=templete_array[n].split(""),i=r.length,s=0;s<i;s++){var o=r[s].split("\f"),u=o[0],a=o[1],o=document.createElement("li");o.setAttribute("id","templete_"+n),o.style.display="none";var f=document.createElement("span"),l=document.createElement("img");l.setAttribute("src","../../../images/editor/dialog/file.gif"),l.setAttribute("alt","\ufffd\ufffd\ufffd\u03fe\ufffd\ufffd\ufffd\ufffd\ufffd"),f.appendChild(l),o.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",o.appendChild(f),f=document.createElement("span"),f.setAttribute("class","li_title"),f.innerHTML=u,o.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",o.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_modify.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("onclick","javascript:templeteModify("+n+","+s+")"),f.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),o.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",o.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_delete.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("onclick","javascript:templeteDelete("+n+","+s+")"),f.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),o.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",o.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_up.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("onclick","javascript:templeteUp("+n+","+s+")"),f.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),o.appendChild(f),f=document.createElement("span"),f.innerHTML="&nbsp;",o.appendChild(f),f=document.createElement("img"),f.setAttribute("src","../../../images/admin/s_btn_down.png"),f.setAttribute("style","cursor:pointer;"),f.setAttribute("onclick","javascript:templeteDown("+n+","+s+")"),f.setAttribute("alt","\ufffd\u01b7\ufffd\ufffd\ufffd"),o.appendChild(f),f=document.createElement("input"),f.setAttribute("type","hidden"),f.setAttribute("name","templete_name_"+n+"[]"),f.setAttribute("value",u),o.appendChild(f),u=document.createElement("input"),u.setAttribute("type","hidden"),u.setAttribute("name","templete_url_"+n+"[]"),u.setAttribute("value",a),o.appendChild(u),u=document.createElement("input"),u.setAttribute("type","hidden"),u.setAttribute("value","0"),o.appendChild(u),e.appendChild(o)}}function classClick(e){if("0"==document.getElementById("selected_class_none").value){templeteModifyClear(),document.getElementById("selected_class").value=e;for(var t=document.getElementById("ul_class"),n=document.getElementById("ul_templete"),r=t.childNodes.length,i=0;i<r;i++)t.childNodes[i].className="",t.childNodes[i].childNodes[0].childNodes[0].src="../../../images/editor/dialog/close_folder.gif";t.childNodes[e].className="on",t.childNodes[e].childNodes[0].childNodes[0].src="../../../images/editor/dialog/open_folder.gif",t=n.childNodes.length;for(i=0;i<t;i++)n.childNodes[i].style.display="none";for(i=0;i<t;i++)n.childNodes[i].id=="templete_"+e&&(n.childNodes[i].style.display="")}else document.getElementById("selected_class_none").value="0"}function classAdd(e){if(""==e.value)alert("\ufffd\u07f0\ufffd\ufffd\u03f7\ufffd\ufffd\ufffd \u016c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u0537\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd."),e.focus();else if(confirm("\u016c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u07f0\ufffd\ufffd\u03fd\u00f0\u06bd\ufffd\ufffd\u03f1\ufffd?")){classModifyClear(),templeteModifyClear();var t=document.getElementById("ul_class"),n=t.childNodes.length,r=document.createElement("li");r.setAttribute("onclick","javascript:classClick("+n+")");var i=document.createElement("span"),s=document.createElement("img");s.setAttribute("src","../../../images/editor/dialog/close_folder.gif"),s.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd"),i.appendChild(s),r.appendChild(i),i=document.createElement("span"),i.innerHTML="&nbsp;",r.appendChild(i),i=document.createElement("span"),i.setAttribute("class","li_title"),i.innerHTML=e.value,r.appendChild(i),i=document.createElement("span"),i.innerHTML="&nbsp;",r.appendChild(i),i=document.createElement("img"),i.setAttribute("src","../../../images/admin/s_btn_modify.png"),i.setAttribute("style","cursor:pointer;"),i.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),i.setAttribute("onclick","javascript:classModify("+n+")"),r.appendChild(i),i=document.createElement("span"),i.innerHTML="&nbsp;",r.appendChild(i),i=document.createElement("img"),i.setAttribute("src","../../../images/admin/s_btn_delete.png"),i.setAttribute("style","cursor:pointer;"),i.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),i.setAttribute("onclick","javascript:classDelete("+n+")"),r.appendChild(i),i=document.createElement("span"),i.innerHTML="&nbsp;",r.appendChild(i),i=document.createElement("img"),i.setAttribute("src","../../../images/admin/s_btn_up.png"),i.setAttribute("style","cursor:pointer;"),i.setAttribute("alt","\ufffd\ufffd\ufffd\ufffd"),i.setAttribute("onclick","javascript:classUp("+n+")"),r.appendChild(i),i=document.createElement("span"),i.innerHTML="&nbsp;",r.appendChild(i),i=document.createElement("img"),i.setAttribute("src","../../../images/admin/s_btn_down.png"),i.setAttribute("style","cursor:pointer;"),i.setAttribute("alt","\ufffd\u01b7\ufffd\ufffd\ufffd"),i.setAttribute("onclick","javascript:classDown("+n+")"),r.appendChild(i),i=document.createElement("input"),i.setAttribute("type","hidden"),i.setAttribute("name","class[]"),i.setAttribute("value",e.value),r.appendChild(i),i=document.createElement("input"),i.setAttribute("type","hidden"),i.setAttribute("value","0"),r.appendChild(i),t.appendChild(r),e.value="",templete_array[n]=""}}function classModify(e){templeteModifyClear(),document.getElementById("selected_class_none").value="1";var t=document.getElementById("ul_class");if("0"==t.childNodes[e].childNodes[12].value)classModifyClear(),t.childNodes[e].childNodes[2].innerHTML='<input type="text" id="class_text_'+e+'" name="class_text_'+e+'" style="width:100%" value="'+t.childNodes[e].childNodes[2].innerHTML+'"/>',t.childNodes[e].childNodes[12].value="1";else{var n=t.childNodes[e].childNodes[2].childNodes[0].value;""==n?(alert("\ufffd\ufffd\ufffd\ufffd\ufffd\u03f7\ufffd\ufffd\ufffd \u016c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u0537\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd."),t.childNodes[e].childNodes[2].childNodes[0].focus()):confirm("\ufffd\ufffd\ufffd\ufffd\ufffd\u03fd\u00f0\u06bd\ufffd\ufffd\u03f1\ufffd?")&&(t.childNodes[e].childNodes[2].innerHTML=n,t.childNodes[e].childNodes[11].value=n,t.childNodes[e].childNodes[12].value="0")}}function classDelete(e){classModifyClear(),templeteModifyClear(),document.getElementById("selected_class_none").value="1";if(confirm("\ufffd\ufffd\ufffd\ufffd\ufffd\u03fd\u00f8\ufffd\n\u016c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\u0535\ufffd \ufffd\ufffd\ufffd\u00f8\ufffd\ufffd\ufffd\ufffd \ufffd\u0634\ufffd \ufffd\ufffd\ufffd\u03f5\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\u02f4\u03f4\ufffd.\n\n\ufffd\u05f7\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\u03fd\u00f0\u06bd\ufffd\ufffd\u03f1\ufffd?")){for(var t=templete_array.length,n=e;n<t;n++){if(n==e){var r=templete_array[n],i=document.all.dext5;document.getElementById("mode").value="DELETE_ALL",document.getElementById("delete_url").value=r,i.submit()}else templete_array[n-1]=templete_array[n];n==t-1&&templete_array.pop()}templeteAreaSet(),t=document.getElementById("ul_class"),r=t.childNodes.length;for(n=e+1;n<r;n++)t.childNodes[n].setAttribute("onclick","javascript:classClick("+(n-1)+")"),t.childNodes[n].childNodes[4].setAttribute("onclick","javascript:classModify("+(n-1)+")"),t.childNodes[n].childNodes[6].setAttribute("onclick","javascript:classDelete("+(n-1)+")"),t.childNodes[n].childNodes[8].setAttribute("onclick","javascript:classUp("+(n-1)+")"),t.childNodes[n].childNodes[10].setAttribute("onclick","javascript:classDown("+(n-1)+")");t.removeChild(t.childNodes[e])}}function classUp(e){if(0<e){classModifyClear(),templeteModifyClear();var t=document.getElementById("ul_class"),n=t.childNodes[e].childNodes[2].innerHTML,r=t.childNodes[e].childNodes[11].value;t.childNodes[e].childNodes[2].innerHTML=t.childNodes[e-1].childNodes[2].innerHTML,t.childNodes[e].childNodes[11].value=t.childNodes[e-1].childNodes[11].value,t.childNodes[e-1].childNodes[2].innerHTML=n,t.childNodes[e-1].childNodes[11].value=r,n=t.childNodes.length;for(r=0;r<n;r++)t.childNodes[r].className="",t.childNodes[r].childNodes[0].childNodes[0].src="../../../images/editor/dialog/close_folder.gif";t.childNodes[e-1].className="on",t.childNodes[e-1].childNodes[0].childNodes[0].src="../../../images/editor/dialog/open_folder.gif",t=templete_array[e],templete_array[e]=templete_array[e-1],templete_array[e-1]=t,templeteAreaSet(),classClick(e-1),document.getElementById("selected_class_none").value="1"}}function classDown(e){if(e<templete_array.length-1){classModifyClear(),templeteModifyClear();var t=document.getElementById("ul_class"),n=t.childNodes[e].childNodes[2].innerHTML,r=t.childNodes[e].childNodes[11].value;t.childNodes[e].childNodes[2].innerHTML=t.childNodes[e+1].childNodes[2].innerHTML,t.childNodes[e].childNodes[11].value=t.childNodes[e+1].childNodes[11].value,t.childNodes[e+1].childNodes[2].innerHTML=n,t.childNodes[e+1].childNodes[11].value=r,n=t.childNodes.length;for(r=0;r<n;r++)t.childNodes[r].className="",t.childNodes[r].childNodes[0].childNodes[0].src="../../../images/editor/dialog/close_folder.gif";t.childNodes[e+1].className="on",t.childNodes[e+1].childNodes[0].childNodes[0].src="../../../images/editor/dialog/open_folder.gif",t=templete_array[e],templete_array[e]=templete_array[e+1],templete_array[e+1]=t,templeteAreaSet(),classClick(e+1),document.getElementById("selected_class_none").value="1"}}function classModifyClear(){for(var e=document.getElementById("ul_class"),t=e.childNodes.length,n=0;n<t;n++)e.childNodes[n].childNodes[2].childNodes[0].tagName&&"input"==e.childNodes[n].childNodes[2].childNodes[0].tagName.toLowerCase()&&(e.childNodes[n].childNodes[2].innerHTML=e.childNodes[n].childNodes[2].childNodes[0].value,e.childNodes[n].childNodes[12].value="0")}function templeteAddConfirm(){var e=document.getElementById("templete_name"),t=document.getElementById("load_templete"),n=document.getElementById("selected_class"),r=document.getElementById("ul_class");if(""==n.value)return alert("\u016c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd."),r.focus(),!1;if(""==t.value)return alert("\ufffd\u07f0\ufffd\ufffd\u03f7\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\u00f8\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd."),t.focus(),!1;if(""==e.value)return alert("\ufffd\u07f0\ufffd\ufffd\u03f7\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\u00f8\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u0537\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd."),e.focus(),!1;r=t.value.slice(t.value.indexOf(".")+1).toLowerCase();if("html"!=r&&"htm"!=r)return alert("html \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd"),t.focus(),!1;if(!confirm("\ufffd\ufffd\ufffd\u00f8\ufffd\ufffd\ufffd \ufffd\u07f0\ufffd\ufffd\u03fd\u00f0\u06bd\ufffd\ufffd\u03f1\ufffd?"))return!1;t=document.all.dext5,document.getElementById("mode").value="ADD",document.getElementById("guid").value=getGuid(),t.submit(),t=e.value,r="pages/forms/"+document.getElementById("guid").value+".html",templete_array[n.value]=""==templete_array[n.value]?t+"\f"+r:templete_array[n.value]+""+t+"\f"+r,e.value="",templeteAreaSet(),classClick(n.value)}function templeteModify(e,t){classModifyClear();for(var n=0,r=0;r<e;r++)if(""!=templete_array[r])var i=templete_array[r].split(""),n=n+i.length;r=document.getElementById("ul_templete");if("0"==r.childNodes[n+t].childNodes[13].value)templeteModifyClear(),r.childNodes[n+t].childNodes[2].innerHTML='<input type="text" style="width:100%" value="'+r.childNodes[n+t].childNodes[2].innerHTML+'"/>',r.childNodes[n+t].childNodes[13].value="1";else{var s=r.childNodes[n+t].childNodes[2].childNodes[0].value;if(""==s)alert("\ufffd\ufffd\ufffd\ufffd\ufffd\u03f7\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\u00f8\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u0537\ufffd\ufffd\ufffd\ufffd\u05bc\ufffd\ufffd\ufffd."),r.childNodes[n+t].childNodes[2].childNodes[0].focus();else if(confirm("\ufffd\ufffd\ufffd\ufffd\ufffd\u03fd\u00f0\u06bd\ufffd\ufffd\u03f1\ufffd?")){for(var i=templete_array[e].split(""),n=i.length,o="",r=0;r<n;r++){if(r==t)var u=i[r].split("\f"),o=o+(s+"\f"+u[1]);else o+=i[r];r!=n-1&&(o+="")}templete_array[e]=o,templeteAreaSet(),classClick(e)}}}function templeteDelete(e,t){classModifyClear(),templeteModifyClear();if(confirm("\ufffd\ufffd\ufffd\ufffd\ufffd\u03fd\u00f8\ufffd \ufffd\ufffd\ufffd\u00f8\ufffd\ufffd\ufffd \ufffd\u0634\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\u02f4\u03f4\ufffd.\n\ufffd\u05f7\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\u03fd\u00f0\u06bd\ufffd\ufffd\u03f1\ufffd?")){for(var n="",r="",i=templete_array[e].split(""),s=i.length,o=0;o<s;o++)t==o?n=i[o].split("\f")[1]:(r+=i[o],t==s-1?o!=s-2&&(r+=""):t!=s-1&&o!=s-1&&(r+=""));i=document.all.dext5,document.getElementById("mode").value="DELETE",document.getElementById("delete_url").value=n,i.submit(),templete_array[e]=r,templeteAreaSet(),classClick(e)}}function templeteUp(e,t){if(0<t){classModifyClear(),templeteModifyClear();var n=templete_array[e].split(""),r=n.length,i=n[t];n[t]=n[t-1],n[t-1]=i,templete_array[e]="";for(i=0;i<r;i++)templete_array[e]+=n[i],i!=r-1&&(templete_array[e]+="");templeteAreaSet(),classClick(e)}}function templeteDown(e,t){var n=templete_array[e].split(""),r=n.length;if(t<r-1){classModifyClear(),templeteModifyClear();var n=templete_array[e].split(""),r=n.length,i=n[t];n[t]=n[t+1],n[t+1]=i,templete_array[e]="";for(i=0;i<r;i++)templete_array[e]+=n[i],i!=r-1&&(templete_array[e]+="");templeteAreaSet(),classClick(e)}}function templeteModifyClear(){for(var e=document.getElementById("ul_templete"),t=e.childNodes.length,n=0;n<t;n++)e.childNodes[n].childNodes[2].childNodes[0].tagName&&"input"==e.childNodes[n].childNodes[2].childNodes[0].tagName.toLowerCase()&&(e.childNodes[n].childNodes[2].innerHTML=e.childNodes[n].childNodes[2].childNodes[0].value,e.childNodes[n].childNodes[13].value="0")}function getGuid(){var e=0,t=(new Date).getTime().toString(32),n;for(n=0;5>n;n++)t+=Math.floor(65535*Math.random()).toString(32);return t+(e++).toString(32)}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",n,r,i,s,o,u,a=0;for(e=Base64._utf8_encode(e);a<e.length;)n=e.charCodeAt(a++),r=e.charCodeAt(a++),i=e.charCodeAt(a++),s=n>>2,n=(n&3)<<4|r>>4,o=(r&15)<<2|i>>6,u=i&63,isNaN(r)?o=u=64:isNaN(i)&&(u=64),t=t+this._keyStr.charAt(s)+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(u);return t},decode:function(e){var t="",n,r,i,s,o,u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)n=this._keyStr.indexOf(e.charAt(u++)),r=this._keyStr.indexOf(e.charAt(u++)),s=this._keyStr.indexOf(e.charAt(u++)),o=this._keyStr.indexOf(e.charAt(u++)),n=n<<2|r>>4,r=(r&15)<<4|s>>2,i=(s&3)<<6|o,t+=String.fromCharCode(n),64!=s&&(t+=String.fromCharCode(r)),64!=o&&(t+=String.fromCharCode(i));return t=Base64._utf8_decode(t)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):(127<r&&2048>r?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)r=e.charCodeAt(n),128>r?(t+=String.fromCharCode(r),n++):191<r&&224>r?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t},URLEncode:function(e){return escape(this._utf8_encode(e))},URLDecode:function(e){return this._utf8_decode(unescape(e))}},templete_array=[];