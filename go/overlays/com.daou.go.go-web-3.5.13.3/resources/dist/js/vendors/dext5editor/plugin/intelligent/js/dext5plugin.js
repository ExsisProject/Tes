(function(){try{var e=function(e,t){if(null!=x.intelligentClickIconRect){var n=x._intelligent_menu_iframe,r={},r=getWindowScrollPos(DEXTTOP.DEXTWIN),i=null,i=t?getClientRect(x._menu_document.getElementById("intel_ue_"+x._currEditor.ID+t)):x.intelligentClickIconRect,n=getClientRect(n),s=getClientRect(_iframeWin.parent.frameElement),o=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(o=-2);var u=0;n.left+i.left+s.left+180>=s.right&&(u=n.left+i.left+s.left+180-s.right+10),e._iframe.style.left=i.left+s.left+r[0]+n.left-u+"px",e._iframe.style.top=i.bottom+r[1]+n.top+o+s.top+"px"}},t=function(e,t){if(null!=x.intelligentClickIconRect){var n={},n=getWindowScrollPos(DEXTTOP.DEXTWIN),r=x.intelligentClickIconRect,i=r.left+x.intelligentLocationRectLeft,r=r.bottom+x.intelligentLocationRectBottom,s=getClientRect(_iframeWin.parent.frameElement),o=0;t&&i+s.left+180>=s.right&&(o=i+s.left+180-s.right+10);var u=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(u=-2),e._iframeHolder?(e._iframeHolder.style.left=i+n[0]+s.left-o+"px",e._iframeHolder.style.top=r+n[1]+s.top+u+"px",e._iframeHolder.style.display=""):(e._iframe.style.left=i+n[0]+s.left-o+"px",e._iframe.style.top=r+n[1]+s.top+u+"px"),e._iframe.style.display=""}},n=function(e,t){var n=x._menu_document.getElementById("intel_em_"+x._currEditor.ID+t);e&&(n.style.backgroundColor=e)},r=function(e,t){"none"!=x._intelligent_menu_iframe.style.display&&("1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin&&-1<e.indexOf("line_height")||"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin&&-1<e.indexOf("font_size")||"1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin&&-1<e.indexOf("font_family")?x._menu_document.getElementById("intel_txtarea_"+t+e).value=document.getElementById("txtara_"+t+e).value:x._menu_document.getElementById("intel_ue_"+t+e).innerHTML=document.getElementById("ue_"+t+e).innerHTML)},i=function(){var e=setMenuIconRealable;setMenuIconRealable=function(t){var n=e(t);if(n){var r=n.formattingVal,i=n.lineHeightVal,s=n.fontSizeVal;t=n.fontFamilyVal;var n=n.fontLetterSpacingVal,o=x._currEditor,u=o._config,a=x._menu_document.getElementById("intel_ue_"+o.ID+"formatting");a&&(a.innerHTML=r),r=null;if("1"==u.useLineHeightKeyin){if(r=x._menu_document.getElementById("intel_txtarea_"+o.ID+"line_height"))r.value=i}else if(r=x._menu_document.getElementById("intel_ue_"+o.ID+"line_height"))r.innerHTML=i;i=null;if(i="1"==u.useFontSizeKeyin?x._menu_document.getElementById("intel_txtarea_"+o.ID+"font_size"):x._menu_document.getElementById("intel_ue_"+o.ID+"font_size")){try{if(-1<s.indexOf(".")){r="",-1<s.indexOf("px")||-1<s.indexOf("pt")||-1<s.indexOf("em")?r=s.substring(s.length-2):-1<s.indexOf("%")&&(r=s.substring(s.length-1));var f=parseFloat(s),f=Math.round(f),s=f+r}}catch(l){}"1"==u.useFontSizeKeyin?i.value=s:i.innerHTML=s}f=null;if("1"==u.useFontFamilyKeyin){if(f=x._menu_document.getElementById("intel_txtarea_"+o.ID+"font_family"))f.value=getDisplayFontName(t)}else if(f=x._menu_document.getElementById("intel_ue_"+o.ID+"font_family"))f.innerHTML=getDisplayFontName(t);if(t=x._menu_document.getElementById("intel_ue_"+o.ID+"letter_spacing"))t.innerHTML=n}}},s=function(){var n=x._currEditor._dextFontFamily.show;x._currEditor._dextFontFamily.show=function(e){n(e),t(x._currEditor._dextFontFamily,!0)};var r=x._currEditor._dextFontSize.show;x._currEditor._dextFontSize.show=function(e){r(e),t(x._currEditor._dextFontSize,!0)};var i=x._currEditor._dextFormatting.show;x._currEditor._dextFormatting.show=function(e){i(e),t(x._currEditor._dextFormatting,!1)};var s=x._currEditor._dextLineHeight.show;x._currEditor._dextLineHeight.show=function(e){s(e),t(x._currEditor._dextLineHeight,!1)};var o=x._currEditor._dextLetterSpacing.show;x._currEditor._dextLetterSpacing.show=function(e){o(e),t(x._currEditor._dextLetterSpacing,!1)};var u=x._currEditor._dextListNumber.show;x._currEditor._dextListNumber.show=function(t){u(t),e(x._currEditor._dextListNumber)};var a=x._currEditor._dextListBullets.show;x._currEditor._dextListBullets.show=function(t){a(t),e(x._currEditor._dextListBullets)};var f=x._currEditor._dextListAligns.show;x._currEditor._dextListAligns.show=function(t){f(t),e(x._currEditor._dextListAligns,"align_group_detail")};var l=x._currEditor._dextListTables.show;x._currEditor._dextListTables.show=function(t){l(t),e(x._currEditor._dextListTables,"table_group_detail")};var c=x._currEditor._dextElementZindex.show;x._currEditor._dextElementZindex.show=function(t){c(t),e(x._currEditor._dextElementZindex)}},o=function(){var e=DEXTTOP.G_CURREDITOR._iconSelected;DEXTTOP.G_CURREDITOR._iconSelected=function(t){e(t);if("none"!=x._intelligent_menu_iframe.style.display){for(var n="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid list_number list_bullets dirltr dirrtl show_blocks table_lock cell_lock table_lock_property font_color font_bg_color table_border".split(" "),r=x._currEditor,i="",s=0,o=n.length;s<o;s++)if(_icon_id=DEXTTOP.DEXT5.util.trim(n[s]).toLowerCase(),_icon_a=x._menu_document.getElementById("intel_ue_"+r.ID+_icon_id))i=DEXTTOP.DEXT5.util.getClass(_icon_a),i=DEXTTOP.DEXT5.util.replaceAll(i,"Enter",""),i=DEXTTOP.DEXT5.util.trim(i),DEXTTOP.DEXT5.util.setClass(_icon_a,i),_icon_a.style.backgroundImage="";if(t)for(s=0,o=t.length;s<o;s++)if(_icon_id=DEXTTOP.DEXT5.util.trim(t[s]).toLowerCase(),_icon_a=x._menu_document.getElementById("intel_ue_"+r.ID+_icon_id))i=DEXTTOP.DEXT5.util.getClass(_icon_a),i+=" Enter",DEXTTOP.DEXT5.util.setClass(_icon_a,i)}}},u=function(){var e=hyperHelpOpen;hyperHelpOpen=function(t,n){"none"==x._intelligent_menu_iframe.style.display&&e(t,n)}},a=function(){var e=command_fontSizeIncDec;command_fontSizeIncDec=function(t,n,i){e(t,n,i),r("font_size",t)};var t=command_letterSpacingIncDec;command_letterSpacingIncDec=function(e,n,i){t(e,n,i),r("letter_spacing",e)};var n=command_lineHeightIncDec;command_lineHeightIncDec=function(e,t,i){n(e,t,i),r("line_height",e)}},f=function(){var e=x._currEditor._dextFontFamily.click_func;x._currEditor._dextFontFamily.click_func=function(t,n,i){e(t,n,i),r("font_family",t)};var t=x._currEditor._dextFontSize.click_func;x._currEditor._dextFontSize.click_func=function(e,n,i){t(e,n,i),r("font_size",e)};var n=x._currEditor._dextFormatting.click_func;x._currEditor._dextFormatting.click_func=function(e,t){n(e,t),r("formatting",e)};var i=x._currEditor._dextLetterSpacing.click_func;x._currEditor._dextLetterSpacing.click_func=function(e,t){i(e,t),r("letter_spacing",e)};var s=x._currEditor._dextLineHeight.click_func;x._currEditor._dextLineHeight.click_func=function(e,t,n){s(e,t,n),r("line_height",e)}},l=function(e,t,n){return null!=x.intelligentClickIconRect?x._menu_document.getElementById("dext_intel_pan"+t+x._currEditor.ID):n(e)},c=function(){var e=x._currEditor._dextFontFamily._self;x._currEditor._dextFontFamily._self=function(t){return l(t,"_font_family_",e)};var t=x._currEditor._dextFontSize._self;x._currEditor._dextFontSize._self=function(e){return l(e,"_font_size_",t)};var n=x._currEditor._dextFormatting._self;x._currEditor._dextFormatting._self=function(e){return l(e,"_formatting_",n)};var r=x._currEditor._dextLineHeight._self;x._currEditor._dextLineHeight._self=function(e){return l(e,"_line_height_",r)};var i=x._currEditor._dextLetterSpacing._self;x._currEditor._dextLetterSpacing._self=function(e){return l(e,"_letter_spacing_",i)};var s=x._currEditor._dextListNumber._self;x._currEditor._dextListNumber._self=function(e){return l(e,"_detail_list_number_",s)};var o=x._currEditor._dextListBullets._self;x._currEditor._dextListBullets._self=function(e){return l(e,"_detail_list_bullets_",o)};var u=x._currEditor._dextListAligns._self;x._currEditor._dextListAligns._self=function(e){return l(e,"_align_group_detail_",u)};var a=x._currEditor._dextListTables._self;x._currEditor._dextListTables._self=function(e){return l(e,"_table_group_detail_",a)};var f=x._currEditor._dextElementZindex._self;x._currEditor._dextElementZindex._self=function(e){return l(e,"_order_of_objects_detail_",f)}},h=function(){var e=command_fontColor;command_fontColor=function(t,r,i){e(t,r,i),n(i,"color_show")};var t=command_fontBgColor;command_fontBgColor=function(e,r,i){t(e,r,i),n(i,"bg_color_show")}},p=function(e,t){var n;return n=e,"selectarea"==n.toLowerCase()?n="selectArea":"selectedmulticell"==n.toLowerCase()?n="selectedMultiCell":"cellselecttext"==n.toLowerCase()?n="cellSelectText":"focusimage"==n.toLowerCase()?n="focusImage":"focusflash"==n.toLowerCase()?n="focusFlash":"focusvideo"==n.toLowerCase()?n="focusVideo":"focusiframe"==n.toLowerCase()?n="focusIframe":"focusmedia"==n.toLowerCase()?n="focusMedia":"focuslinkmedia"==n.toLowerCase()?n="focusLinkMedia":"focuschart"==n.toLowerCase()&&(n="focusChart"),n!=e&&(t[n]=t[e],delete t[e]),t[n]&&(t[n].tool1&&(t[n].tool1=t[n].tool1.toLowerCase().split(",")),t[n].tool2&&(t[n].tool2=t[n].tool2.toLowerCase().split(","))),n},d=function(){for(var e=x._currEditor,t=e._config,n=null,r="",i=0,s=G_ICON_FULL_SET.length;i<s;i++)if(r=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[i]).toLowerCase(),n=x._menu_document.getElementById("intel_ue_"+e.ID+r))r=function(n){return function(r){if("formatting"==n||"font_family"==n||"font_size"==n||"line_height"==n||"letter_spacing"==n||"align_group"==n||"table_group"==n||-1<n.indexOf("detail")){var i=!1;x._whatClick=!1;var s=null;switch(n){case"font_family":"1"==t.useFontFamilyKeyin&&(i=!0);break;case"font_size":"1"==t.useFontSizeKeyin&&(i=!0);break;case"line_height":"1"==t.useLineHeightKeyin&&(i=!0)}if(i)s=x._menu_document.getElementById("intel_txtarea_"+e.ID+n);else if(s=x._menu_document.getElementById("intel_"+e.ID+n),"align_group"==n||"table_group"==n)s=x._menu_document.getElementById("intel_ue_"+e.ID+n);x.intelligentClickIconRect=getClientRect(s)}else x._whatClick=!0;e._dextCommands(e.ID,n),DEXTTOP.DEXT5.util.stopEvent(r)}}(r),DEXTTOP.DEXT5.util.addEvent(n,"click",r)},v=function(e){var t=x._currEditor,n=t._config,r='<span class="cover" id="intel_span_'+t.ID+e+'">';switch(e){case"formatting":case"line_height":case"letter_spacing":case"font_family":case"font_size":var i=!1;switch(e){case"font_family":"1"==n.useFontFamilyKeyin&&(i=!0);break;case"font_size":"1"==n.useFontSizeKeyin&&(i=!0);break;case"line_height":"1"==n.useLineHeightKeyin&&(i=!0)}if(i){if(r+='<textarea class="textType" id = "intel_txtarea_'+t.ID+e+'" title = "'+dext5_lang.icon[e].replace("\uae30\ubcf8","")+'"></textarea >',r+='<a class="con_button textAreaDropDown" id = "intel_dropdown_'+t.ID+e+'" href="javascript:;">',r+='<span class="arrowToDrop" id="intel_ue_'+t.ID+e+'"></span>',r+="</a>","font_size"==e&&"1"==n.useFontSizeIncDec||"line_height"==e&&"1"==n.useLineHeightIncDec)r+='<span class="btn_upDown_Area" id="intel_'+t.ID+e+'IncDec">',r+='<a class="up" href="javascript:;" id="intel_ue_'+t.ID+e+'_inc" style="cursor: pointer;"></a>',r+='<a class="down" href="javascript:;" id="intel_ue_'+t.ID+e+'_dec" style="cursor: pointer;"></a>'}else if(r+='<a class="con_button btnType" id = "intel_'+t.ID+e+'"title = "'+dext5_lang.icon[e].replace("\uae30\ubcf8","")+'" href="javascript:;">',r+='<span class="txtArea" id="intel_ue_'+t.ID+e+'"></span>',r+="</a>","font_size"==e&&"1"==n.useFontSizeIncDec||"line_height"==e&&"1"==n.useLineHeightIncDec||"letter_spacing"==e&&"1"==n.useLetterSpacingIncDec)r+='<span class="btn_upDown_Area" id="intel_'+t.ID+e+'IncDec">',r+='<a class="up" href="javascript:;" id="intel_ue_'+t.ID+e+'_inc" style="cursor: pointer;" title = "'+dext5_lang.icon[e].replace("\uae30\ubcf8","")+'"></a>',r+='<a class="down" href="javascript:;" id="intel_ue_'+t.ID+e+'_dec" style="cursor: pointer;" title = "'+dext5_lang.icon[e].replace("\uae30\ubcf8","")+'"></a>';r+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',r+='		<span id="dext_intel_pan_'+e+"_"+t.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left:0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',r+="	</span></span>";break;case"font_color":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+='<em class="editor_font_color_basic" id="intel_em_'+t.ID+'color_show"></em>',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'detail_font_color">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'detail_font_color"></a>',r+="</span>",r+="</span>";break;case"font_bg_color":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+='<em class="editor_bg_color_basic" id="intel_em_'+t.ID+'bg_color_show"></em>',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'detail_font_bg_color">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'detail_font_bg_color"></a>',r+="</span>",r+="</span>";break;case"list_number":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'detail_list_number">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'detail_list_number"></a>',r+="</span>",r+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',r+='		<span id="dext_intel_pan_detail_list_number_'+t.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left:0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',r+="	</span>",r+="</span>";break;case"list_bullets":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'detail_list_bullets">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'detail_list_bullets"></a>',r+="</span>",r+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',r+='		<span id="dext_intel_pan_detail_list_bullets_'+t.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left:0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',r+="	</span>",r+="</span>";break;case"align_group":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'align_group_detail">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'align_group_detail"></a>',r+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',r+='		<span id="dext_intel_pan_align_group_detail_'+t.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left:0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',r+="	</span>",r+="</span>",r+="</span>";break;case"table_group":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'table_group_detail">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'table_group_detail"></a>',r+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',r+='		<span id="dext_intel_pan_table_group_detail_'+t.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left:0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',r+="	</span>",r+="</span>",r+="</span>";break;case"order_of_objects":r+='<span class="con_button"  title="'+dext5_lang.icon[e]+'">',r+='<a class="icon '+e+'" href="javascript:;" id="intel_ue_'+t.ID+e+'">',r+="</a>",r+='<span class="con_button" id="intel_'+t.ID+'order_of_objects_detail">',r+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+t.ID+'order_of_objects_detail"></a>',r+='	<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2e3)+'">',r+='		<span id="dext_intel_pan_order_of_objects_detail_'+t.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left:0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',r+="	</span>",r+="</span>",r+="</span>";break;default:if(0==e.indexOf("p_")){var s=e.split("_"),n=s[1],i="icon";2<s.length&&(i=s[2]),s="",DEXTTOP.DEXT5.browser.ie&&(s="vertical-align:bottom; "),r+='<a class="con_button" id="intel_ue_'+t.ID+e+'" href="javascript:;" title="'+dext5_lang.icon[e]+'">',r+='<span id="intel_ue_'+t.ID+e+'" href="javascript:;">',r+='<img style="'+s+'margin: 3px; width: 20px; height: 20px;" id="intel_ue_'+t.ID+e+'" title="" src="'+t._config.webPath.plugin+n+"/images/"+i+'.png" />'}else r+='<a class="con_button" id="intel_ue_'+t.ID+e+'" href="javascript:;" title="'+dext5_lang.icon[e]+'">',r+='<span class="icon '+e+'" id="intel_ue_'+t.ID+e+'" href="javascript:;">';r+="</span>",r+="</a>"}return r+="</span>"},m=function(e){var t=!0;void 0==x._intelligent_menu_iframe.style.opacity&&(t=!1),0==e?x.hide():t?x._intelligent_menu_iframe.style.opacity=e:x._intelligent_menu_iframe.style.filter="alpha(opacity="+100*e+")"},g=function(e){var t={};t.clientX=e.clientX,t.clientY=e.clientY,t.button=e.button,t.target=e.target,t.srcElement=e.srcElement;var n=x._intelligent_menu_iframe;setTimeout(function(){var r=e;"number"!=typeof e.button&&(r=t);if(2!=r.button&&"none"==n.style.display)e:{var i=x._currEditor.iconEnableCommandType,s=r,o=x._currEditor;"1"==o._config.clickCtrlHyperlink&&o.isAOver.openHelp&&o._FRAMEWIN.hyperHelpClose();var u=x.intelligentMenu,r=s.target?s.target:s.srcElement,a=r.tagName.toLowerCase();if(u[i]){"div"==a&&(r=DEXTTOP.G_SELECTED_ELEMENT,a=r.tagName.toLowerCase());if("img"==a){if("focusImage"==i){a=r.getAttribute("dext5customdata"),null!=a&&void 0!=a?(a=getDextCustomData(a),"iframe"==a.type?i="focusIframe":"flash"==a.type?i="focusFlash":"media"==a.type?i="focusMedia":"link_media"==a.type?i="focusLinkMedia":"video_media"==a.type&&(i="focusVideo")):r.getAttribute("raon_chart")&&G_DEPlugin.chart&&(i="focusChart");if(!u[i])break e;DEXTTOP.G_SELECTED_ELEMENT=r}}else"video"==a&&(i="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=r);var a=u[i].tool1,u=u[i].tool2,f=x._currEditor,l=x._menu_document.getElementById("first_intelligent"),c=x._menu_document.getElementById("last_intelligent"),h=!1,p=!1,d=null;if(a){var v=a.length;if(0<v)for(var h=!0,g=0;g<v;g++){var y=!1,d=DEXTTOP.DEXT5.util.trim(a[g]);"chart"==d&&(d="p_chart"),"separator"==d&&(y=!0);var b=x._menu_document.getElementById("intel_span_"+f.ID+d);y&&(b=x._menu_document.createElement("i"),b.className="separationVI");var E=x._menu_document.getElementById("intel_txtarea_"+f.ID+d);null!=E&&DEXTTOP.DEXT5.util.addEvent(E,"keydown",T),w(d,b),b&&(null==l.lastChild?0==y&&l.appendChild(b):"separationVI"==l.lastChild.className?0==y&&l.appendChild(b):l.appendChild(b))}}if(u){if(v=u.length,0<v){p=!0;for(g=0;g<v;g++)y=!1,d=DEXTTOP.DEXT5.util.trim(u[g]),"chart"==d&&(d="p_chart"),"separator"==d&&(y=!0),b=x._menu_document.getElementById("intel_span_"+f.ID+d),y&&(b=x._menu_document.createElement("i"),b.className="separationVI"),E=x._menu_document.getElementById("intel_txtarea_"+f.ID+d),null!=E&&DEXTTOP.DEXT5.util.addEvent(E,"keydown",T),w(d,b),b&&(null==c.lastChild?0==y&&c.appendChild(b):"separationVI"==c.lastChild.className?0==y&&c.appendChild(b):c.appendChild(b));l.className="inCon"}}else l.className="inCon inCon_last",c.style.display="none";h&&0==p&&(l.className="inCon inCon_last"),0<l.childNodes.length?"separationVI"==l.lastChild.className&&l.removeChild(l.lastChild):(a=null,l.style.display="none"),0<c.childNodes.length?"separationVI"==c.lastChild.className&&c.removeChild(c.lastChild):(u=null,c.style.display="none");if(null!=a||null!=u){x._intelligent_menu_iframe.style.width="100%",x._intelligent_menu_iframe.style.height="",x._intelligent_menu_iframe.style.display="",u=getClientRect(x._menu_document.body.firstChild),a=u.right-u.left,u=u.bottom-u.top,x._intelligent_menu_iframe.style.width=a+"px",x._intelligent_menu_iframe.style.height=u+"px",f=l=0,o=getClientRect(document.getElementById("dext5_design_"+o.ID));if("selectArea"==i||"cellSelectText"==i)l=s.clientX,f=s.clientY,l+=10,f+=o.top-40,f-=u/2,l+a>=o.right&&(i=l+a-o.right,l-=i+1),0>l&&(l=1),f<=o.top&&(f=o.top+1+35),f+u>=o.bottom&&(i=f+u-o.bottom+45,f-=i-1);else{s=GetTableSelectionCells();if(0<s.length){f=s.length,i={};for(l=0;l<f;l++)c=getClientRect(s[l]),0==l?(i.left=c.left,i.right=c.right,i.bottom=c.bottom,i.top=c.top):(c.left<i.left&&(i.left=c.left),c.top<i.top&&(i.top=c.top),c.bottom>i.bottom&&(i.bottom=c.bottom),c.right>i.right&&(i.right=c.right));i.height=i.bottom-i.top,i.width=i.right-i.left}else i=getClientRect(DEXTTOP.G_SELECTED_ELEMENT);l=i.right-i.left,f=i.bottom-i.top,h=c=!1,i.bottom+u+o.top<o.bottom&&(c=!0),0==c&&0<i.top-u&&(h=!0),s=null,c?(s=x._menu_document.getElementById("tooltip_up"),s.style.display="",f=i.bottom+o.top+10):h?(s=x._menu_document.getElementById("tooltip_down"),s.style.display="",f=i.top+o.top-u-10):f=f/2-u/2,l=i.left+l-l/2-a/2,u=a/2-5,0>l?(u+=l,l=1):l+a>o.right&&(i=l+a-o.right,u+=i,l-=i),s&&(s.style.left=u+"px")}x.intelligentLocationRectLeft=l-1,x.intelligentLocationRectBottom=f,x._intelligent_menu_iframe.style.left=l+"px",x._intelligent_menu_iframe.style.top=f+"px",x.intelligentLocationRectTop=parseInt(x._intelligent_menu_iframe.style.top);if(r.tagName&&"BODY"==r.tagName||"HTML"==r.tagName)try{var S=getFirstRange().range.endContainer;3==S.nodeType&&(S=S.parentNode),r=S}catch(N){}setMenuIconRealable(r),m(1)}}}},50)},y=function(){setTimeout(function(){"selectArea"!=x._currEditor.iconEnableCommandType&&"cellSelectText"!=x._currEditor.iconEnableCommandType?x.hide():DEXTTOP.G_SELECTED_ELEMENT&&"a"==DEXTTOP.G_SELECTED_ELEMENT.nodeName.toLowerCase()&&x.hide()},50)},b=function(){command_InsertTableTopBottomParagraph(x._paragraphLocation,x._currEditor,x._paragraphTargetTable),x.insertParagraphTable.style.display="none"},w=function(e,t){if(0==e.indexOf("p_")){var n=e.split("_")[1];t?t.getElementsByTagName("img")[0].title=dext5_lang.plugins[n].intelligentMenu[e]:G_DEPlugin[n]&&0>G_ICON_FULL_SET.indexOf(e)&&G_ICON_FULL_SET.push(e)}},E=function(e){var t=x._currEditor,n=x.intelligentMenu;e+='<div id="iconHouse" style="display:none;">';var r=[],i;for(i in n)r.push(p(i,n));i="";for(var t=t.remove_item,s=0;s<r.length;s++){var o=r[s];if(void 0!=n[o]){var u=n[o].tool1,o=n[o].tool2,a=null;if(u){var f=u.length;if(0<f)for(var l=0;l<f;l++)a=DEXTTOP.DEXT5.util.trim(u[l]),"chart"==a&&(a="p_chart"),0>t.indexOf(a)&&"separator"!=a&&-1==i.indexOf(","+a+",")&&(w(a),e+=v(a),i+=","+a+",")}if(o&&(f=o.length,0<f))for(l=0;l<f;l++)a=DEXTTOP.DEXT5.util.trim(o[l]),"chart"==a&&(a="p_chart"),0>t.indexOf(a)&&"separator"!=a&&-1==i.indexOf(","+a+",")&&(w(a),e+=v(a),i+=","+a+",")}}return e},S=function(e){e="which"in e?e.which:e.keyCode;if(46==e||e!=x.keyDownCode)x.keyDownCode=e,x.hide()},x={pluginName:"intelligent",_id:"",_zIndex:0,_currEditor:null,intelligentClickIconRect:null,intelligentLocationRectLeft:null,intelligentLocationRectBottom:null,intelligentLocationRectTop:null,_paragraphLocation:"",_paragraphTargetTable:null,_whatClick:!0,colorPicker:!1,_intelligent_menu_iframe:null,keyDownCode:null,_colorData:null,_hideCmdList:"cut table_delete merge_cell delete_row delete_column source preview design text insert_file_property replace emoticon setting horizontal_line image_create image_property flash_property flash_create media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property bookmark doc_bg_image detail_table_insert detail_table_insert_new table_insert split_cell cell_border insert_row_column cell_property row_property column_property table_property about insert_link_media shortcut list_blockquote table_lock_property pastetoimage detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check paragraph_attribute".split(" ")};G_DEPlugin.intelligent=x,x.onInit=function(){var e="../plugin/intelligent/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/config.js",e="1"==DEXTTOP.DEXT5.config.UseConfigTimeStamp?e+("?t="+DEXTTOP.DEXT5.util.getTimeStamp()):e+("?ver="+DEXTTOP.DEXT5.ReleaseVer),t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,t.appendChild(n);if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.mobile)x.intelligentMenu.Use="0",x.InsertParagraph="0"},x.onInitOnce=function(e){"1"==x.intelligentMenu.Use&&x.addEvent(e.editor)},x.onInit(),x.onLoaded=function(){this._currEditor=DEXTTOP.G_CURREDITOR;var e=this._currEditor._config;if("0"!=x.intelligentMenu.Use||"0"!=x.InsertParagraph){if("1"==x.intelligentMenu.Use){this._id="editor_intelligent_menu_iframe_"+this._currEditor.ID;var t=document.getElementById(this._id);t&&t.parentNode.removeChild(t),this._zIndex=G_MAIN_ZINDEX+900;if(t=document.getElementById(this._id))e=t.contentWindow.document,x._intelligent_menu_iframe=t,this._menu_document=e;else{try{t=document.createElement("iframe")}catch(n){t=document.createElement("<iframe>")}t.id=this._id,t.style.margin="0px",t.style.padding="0px",t.style.zIndex=this._zIndex,t.style.position="absolute",t.scrolling="no",t.style.overflow="auto",t.style.overflowX="hidden",t.style.display="none",t.allowTransparency="true",t.frameBorder="0",document.body.appendChild(t);var r="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",r=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(r)+"}())":"";t.src=r,r="",r=DEXTTOP.DEXT5.isRelease?e.webPath.plugin+"intelligent/css/":e.webPath.plugin+"intelligent/css_dev/",r="<!DOCTYPE html><html><head>"+('<link rel="stylesheet" type="text/css" href="'+r+"editor_intelligent.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">'),r+="</head>",r+="<body>",r+='<div class="intelligent_dext5 sKin_'+e.style.skinName+'">',r+='<div class="itelligent_con '+e.style.iconName+'" id="intelligent_holder">',r+='<div class="inCon{0}" id="first_intelligent"></div>',r+='<div class="inCon inCon_last" id="last_intelligent"></div>',r+="</div>",r+='<span id="tooltip_up" class="tooltipOnTop" style="left: 30%; display:none;"></span>',r+='<span id="tooltip_down" class="tooltipOnBottom" style="left: 30%; display:none;"></span>',r+="</div>",r=E(r),r+="</div>",r+="</body></html>",e=t.contentWindow.document,e.open("text/html","replace"),isCustomDomain(document)&&(e.domain=document.domain),e.write(r);for(r=0;r<this._currEditor.remove_item.length;r++)if(-1<this._currEditor.remove_item[r].indexOf("detail")){var l=e.getElementById("intel_"+this._currEditor.ID+this._currEditor.remove_item[r]);l&&(l.style.display="none")}e.close(),x._intelligent_menu_iframe=t,this._menu_document=e,d(),DEXTTOP.DEXT5.util.addEvent(e,"dragover",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1}),DEXTTOP.DEXT5.util.addEvent(e,"drop",function(e){return DEXTTOP.DEXT5.util.cancelEvent(e),!1})}h(),c(),f(),a(),u(),o(),s(),i()}"1"==x.InsertParagraph&&(null==document.getElementById("insert_paragraph_table")&&(t=document.createElement("div"),e='<div id="insert_paragraph_table" style="width: 100%; position: absolute; display:none;"><div style="position:relative; width: 100%; height:9px;"><div style="background-color:#6D90E0; width:98%; width:calc(100%); margin:9px auto; height:2px; *font-size:2px">',e+='<a href="javascript:;"><span id="insertParagraph_'+this._currEditor.ID+'"style="position: absolute; background:url(../plugin/intelligent/images/editor/intelligent/arrow.png) 38% 50% no-repeat #6D90E0; width:11px; height:11px; border:1px solid #4677DB; display:inline-block; margin:auto; *margin-left:-6px; left:0; right:0; *left:50%; top:-5px; *top:4px; bottom:0; *font-size:9px"></span></a>',e+="</div>",e+='<i style="position:absolute; display:block; top:-6px; *top:3px; left:0; width:0; height:0; border-top:7px solid transparent;border-bottom:7px solid transparent; border-left:8px solid #6D90E0; border-right:10px solid none; *font-size:0px"></i>',e+='<i style="position:absolute; display:block; top:-6px; *top:3px; right:0; width:0; height:0; border-top:7px solid transparent;border-bottom:7px solid transparent; border-left:8px solid none; border-right:10px solid #6D90E0; *font-size:0px"></i>',e+="</div>",e+="</div>",t.innerHTML=e,document.body.appendChild(t.firstChild),DEXTTOP.DEXT5.util.addEvent(document.getElementById("insertParagraph_"+this._currEditor.ID),"click",b),DEXTTOP.DEXT5.util.addEvent(this._currEditor._DOC,"mouseover",C,!0)),this.insertParagraphTable=document.getElementById("insert_paragraph_table"),this.insertParagraphTableGap=40),DEXTTOP.DEXT5.util.addEvent(this._currEditor._DOC,"mousedown",this.hide,!0),x.addEvent(this._currEditor)}},x.addEvent=function(e){x._currEditor&&("1"==x.intelligentMenu.Use&&(DEXTTOP.DEXT5.util.addEvent(e._DOC,"mousedown",this.hide,!0),DEXTTOP.DEXT5.util.addEvent(e._DOC,"keydown",S,!0),DEXTTOP.DEXT5.util.addEvent(e._DOC,"mouseup",g,!0),DEXTTOP.DEXT5.util.addEvent(e._DOC,"dblclick",y,!0),document.getElementById("ue_toolbar_"+e.ID)&&DEXTTOP.DEXT5.util.addEvent(document.getElementById("ue_toolbar_"+e.ID),"mousemove",this.hide,!0),document.getElementById("dext_topstatusbar_"+e.ID)&&DEXTTOP.DEXT5.util.addEvent(document.getElementById("dext_topstatusbar_"+e.ID),"mousemove",this.hide,!0),DEXTTOP.DEXT5.util.addEvent(e._DOC,"mousemove",N,!0)),"1"==x.insertParagraphTable&&DEXTTOP.DEXT5.util.addEvent(e._DOC,"mouseover",C,!0),DEXTTOP.DEXT5.browser.gecko?DEXTTOP.DEXT5.util.addEvent(e._DOC,"DOMMouseScroll",this.hide,!0):DEXTTOP.DEXT5.util.addEvent(e._DOC,"mousewheel",this.hide,!0))},x.hide=function(){if("1"==x.intelligentMenu.Use&&x._intelligent_menu_iframe&&"none"!=x._intelligent_menu_iframe.style.display){x._whatClick=!0,x._intelligent_menu_iframe&&"none"!=x._intelligent_menu_iframe.style.display&&(x._menu_document.getElementById("tooltip_up").style.display="none",x._menu_document.getElementById("tooltip_down").style.display="none",x._intelligent_menu_iframe.style.display="none",x.intelligentClickIconRect=null,x.intelligentLocationRectBottom=null,x.intelligentLocationRectLeft=null);for(var e=x._menu_document.getElementById("iconHouse"),t=x._menu_document.getElementById("first_intelligent"),n=x._menu_document.getElementById("last_intelligent");t.hasChildNodes();)"separationVI"!=t.firstChild.className?e.appendChild(t.firstChild):t.removeChild(t.firstChild);for(;n.hasChildNodes();)"separationVI"!=n.firstChild.className?e.appendChild(n.firstChild):n.removeChild(n.firstChild);"none"==t.style.display&&(t.style.display=""),"none"==n.style.display&&(n.style.display="")}"1"==x.InsertParagraph&&"none"!=x.insertParagraphTable.style.display&&(x.insertParagraphTable.style.display="none")},x.onCommand=function(e){e=e.cmd,x._currEditor.iconEnableCommandType=e,"1"==x.intelligentMenu.Use&&-1<this._hideCmdList.indexOf(e)&&x.hide()},x.onResize=function(e){var t=e.cmd;"1"==x.intelligentMenu.Use&&("start"==t?"none"!=x._intelligent_menu_iframe.style.display&&x.hide():"end"==t&&"none"==x._intelligent_menu_iframe.style.display&&(t=DEXTTOP.G_SELECTED_ELEMENT,DEXTTOP.G_SELECTED_ELEMENT=e.target,g(e.event),DEXTTOP.G_SELECTED_ELEMENT=t))},x.onCellResize=function(e){var t=e.cmd;"1"==x.intelligentMenu.Use&&("start"==t?"none"!=x._intelligent_menu_iframe.style.display&&x.hide():"end"==t&&"none"==x._intelligent_menu_iframe.style.display&&(t=DEXTTOP.G_SELECTED_ELEMENT,DEXTTOP.G_SELECTED_ELEMENT=e.target,g(e.event),DEXTTOP.G_SELECTED_ELEMENT=t))},x.onColorPicker=function(e){var t=e.cmd;if("1"==x.intelligentMenu.Use)if("before"==t){if(null!=x.intelligentClickIconRect)return t=e.clickedElem.id.replace("ue_"+x._currEditor.ID,""),e.clickedElem=x._menu_document.getElementById("intel_ue_"+x._currEditor.ID+t),x._colorData=e}else if("show"==t||"more"==t){if(null!=x.intelligentClickIconRect){var n=x._colorData.targetDoc,t=e.colorPopup,r=t.iframeDoc,i=getClientRect(_iframeWin.frameElement),s=x.intelligentClickIconRect,o=s.left+x.intelligentLocationRectLeft,s=s.bottom+x.intelligentLocationRectBottom,r=r.getElementsByTagName("div")[0],r=getClientRect(r),u=parseInt(r.right,10)-parseInt(r.left,10),r=parseInt(r.bottom,10)-parseInt(r.top,10);if("more"==e.cmd){var a=n.getElementById("popupCover"),a=getClientRect(a);146>i.bottom-r-a.top&&(t.layer.style.top=parseInt(t.layer.style.top)-146+"px",x.colorPicker=!0)}else{var f=x._colorData.leftX;e=x._colorData.topY;var l=x._colorData.clickedElem,c=getClientRect(l),l=l.ownerDocument||l.document||n;"undefined"!=typeof l.defaultView?a=l.defaultView:"undefined"!=typeof l.parentWindow&&(a=l.parentWindow),n=getDocWindow(n),l=null,a!==n&&(l=getClientRect(a.frameElement)),null==f&&(f=0),null==e&&(e=0);if(o+u>=i.right||s+r>i.bottom)t.layer.style.left=l.left+c.left+f+"px",t.layer.style.top=l.top+c.bottom+e+"px",o+u>=i.right&&(a=o+u-i.right,t.layer.style.left=parseInt(t.layer.style.left)-a+"px"),s+r>i.bottom&&(a=s+r-i.bottom,t.layer.style.top=parseInt(t.layer.style.top)+e-a+"px")}}}else"more_close"==t&&null!=x.intelligentClickIconRect&&x.colorPicker&&(t=document.getElementById("popupCover"),t.style.top=parseInt(t.style.top)+146+"px",x.colorPicker=!1)};var T=function(e){var t=e.target||e.srcElement,n="which"in e?e.which:e.keyCode;try{var r=x._currEditor,i=r.getEditorMode();if(t&&t.tagName&&"textarea"==t.tagName.toLowerCase()){if(13==n){var s=t.id;switch(s){case"intel_txtarea_"+r.ID+"font_family":case"intel_txtarea_"+r.ID+"font_size":case"intel_txtarea_"+r.ID+"line_height":DEXTTOP.DEXT5.util.stopEvent(e),DEXTTOP.DEXT5.util.cancelEvent(e),r.dextiframeKeydown=!0}switch(s){case"intel_txtarea_"+r.ID+"font_family":r._dextFontFamily.click_func(r.ID,null,t.value);break;case"intel_txtarea_"+r.ID+"font_size":r._dextFontSize.click_func(r.ID,null,t.value);break;case"intel_txtarea_"+r.ID+"line_height":r._dextLineHeight.click_func(r.ID,null,t.value)}}return}if(8==n&&"design"==i){DEXTTOP.DEXT5.util.cancelEvent(e);return}}catch(o){}evt.ctrlKey&&!evt.altKey&&nextTabKeyAccess(evt,n)&&DEXTTOP.DEXT5.util.cancelEvent(evt)},N=function(e){var t=x._currEditor,n=x._intelligent_menu_iframe,r=x._currEditor.iconEnableCommandType;if("none"!=n.style.display&&x._whatClick&&("selectArea"==r||"cellSelectText"==r)){var r=parseFloat(n.style.left),i=parseFloat(n.style.top),s=getClientRect(n),n=r+(s.right-s.left),s=i+(s.bottom-s.top),o=getClientRect(document.getElementById("dext5_design_"+t.ID)),t=e.clientX+o.left;e=e.clientY+o.top;var u=o=0;t<=r?o=r-t:t>=n&&(o=t-n),e<=i?u=i-e:e>=s&&(u=e-s),r=Math.max(o,u),r=30>r?1:120<=r?0:1-1*(r-30)/120,m(r)}},C=function(e){var t=GetTDTHCell(e.target?e.target:e.srcElement),n=x._currEditor;if(t){if(e=GetParentbyTagName(t,"table")){var r=!1,i=!1;e.previousSibling&&"P"==e.previousSibling.tagName&&(r=!0),e.nextSibling&&"P"==e.nextSibling.tagName&&(i=!0);var s=e.rows.length,o=t.parentNode.rowIndex,t=getClientRect(e),n=getClientRect(document.getElementById("dext5_design_"+n.ID));0==o&&0==r?(x.insertParagraphTable.style.display="",x.insertParagraphTable.title=dext5_lang.table.top_insert_paragraph,r=getClientRect(x.insertParagraphTable),r=(r.bottom-r.top)/2+1,x.insertParagraphTable.style.left=t.left+1+"px",x.insertParagraphTable.style.width=t.right-t.left+"px",x.insertParagraphTable.style.top=n.top+t.top-r+"px",x._paragraphLocation="insert_table_top_paragraph",x._paragraphTargetTable=e):o==s-1&&0==i?(x.insertParagraphTable.style.display="",x.insertParagraphTable.title=dext5_lang.table.bottom_insert_paragraph,r=getClientRect(x.insertParagraphTable),r=(r.bottom-r.top)/2,x.insertParagraphTable.style.left=t.left+1+"px",x.insertParagraphTable.style.width=t.right-t.left+"px",x.insertParagraphTable.style.top=n.top+t.bottom-r+"px",x._paragraphLocation="insert_table_bottom_paragraph",x._paragraphTargetTable=e):(x.addParagraphLocation="",x.targetTable=null,x.insertParagraphTable.style.display="none")}}else"none"!=x.insertParagraphTable.style.display&&(x.insertParagraphTable.style.display="none")}}catch(k){}})();