function setMiniPhotoWindow(){try{topURL=top.location.href,"undefined"==typeof topURL?(KMINIPHOTOTOP.KMINIPHOTOWIN=parent,KMINIPHOTOTOP.IsCrossDomain=!0):(KMINIPHOTOTOP.KMINIPHOTOWIN=parent,KMINIPHOTOTOP.IsCrossDomain=!1)}catch(e){KMINIPHOTOTOP.KMINIPHOTOWIN=parent,KMINIPHOTOTOP.IsCrossDomain=!0}}function setMiniPhotoDocument(){try{topURL=top.location.href,"undefined"==typeof topURL?(KMINIPHOTOTOP.KMINIPHOTODOC=parent.document,KMINIPHOTOTOP.IsCrossDomain=!0):(KMINIPHOTOTOP.KMINIPHOTODOC=parent.document,KMINIPHOTOTOP.IsCrossDomain=!1)}catch(e){KMINIPHOTOTOP.KMINIPHOTODOC=parent.document,KMINIPHOTOTOP.IsCrossDomain=!0}}function raonk_frame_loaded_event(e,t,n){_raonk_miniphoto=new K_MiniPhoto(e,t,n),_raonk_miniphoto.start(t,_raonk_miniphoto)}function K_MiniPhoto(e,t,n){this._config=t,this._frame=n,this.frameWin=window,this.ID=e,KMINIPHOTOTOP.KMINIPHOTO.RAONKMULTIPLE[n.frameID]=this,KMINIPHOTOTOP.G_CURRKMINIPHOTO=this,this.currDegree=0,this.flipY=this.flipX=!1,this.initImgHeight=this.initImgWidth=this.initImg=this.cropper=null,this.frameStatus=this.initImgExt="",this.arrBlobUrl=[];try{"function"==typeof KMINIPHOTOTOP.KMINIPHOTOWIN.KMINIPHOTO_OnLanguageDefinition&&KMINIPHOTOTOP.KMINIPHOTOWIN.KMINIPHOTO_OnLanguageDefinition(e,KMiniPhoto_Lang)}catch(r){}}function setPage(e){KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_header_"+e.ID).getElementsByTagName("h3")[0].innerHTML=KMiniPhoto_Lang.title,KMINIPHOTOTOP.document.getElementById("btn_fullscreen_"+e.ID).title=KMiniPhoto_Lang.fullScreen,KMINIPHOTOTOP.document.getElementById("btn_close_"+e.ID).title=KMiniPhoto_Lang.close,setImageArea();try{"function"==typeof e._config.creationCompleteEvent&&e._config.creationCompleteEvent(e.ID)}catch(t){}}function loadImage(e){null==e.src?(e.isInit&&setEvent(),displayOriginalSize()):(displayProcessing(!0),setTimeout(function(){var t=document.getElementById("miniPhoto_image").firstChild;t&&(t.style.width="0px",t.style.height="0px"),t.innerHTML="",KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage=null,KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage=void 0,KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree=0;var n=new Image;n.style.display="none",t.appendChild(n);var r=document.createElement("canvas");r.id="image_canvas",t.appendChild(r),n.crossOrigin="anonymous",n.onerror=function(){alert("error load image"),fn_close()},n.onload=function(){KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree=0,KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX=!1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY=!1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage=n;var t,i,s=n.naturalWidth,o=n.naturalHeight;t=e.width&&""!=e.width?e.width:s,i=e.height&&""!=e.height?e.height:o,r.width=parseInt(t,10),r.height=parseInt(i,10),r.parentNode.style.width=r.width+"px",r.parentNode.style.height=r.height+"px",r.getContext("2d").drawImage(n,0,0,s,o,0,0,r.width,r.height),n.style.display="none",setCanvasPostionCenter(),e.isInit?(setEvent(),G_HISTORY.reset(),KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImg=n,KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgWidth=e.width,KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgHeight=e.height,t=r.toDataURL("image/"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt,1),loadImage({src:t,isResized:!0})):e.isResized&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImg=n),e.isOpen&&(G_HISTORY.reset(),KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImg=n,KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgWidth=n.naturalWidth,KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgHeight=n.naturalHeight),displayProcessing(!1);try{n=void 0}catch(u){}},0==e.src.indexOf("blob")&&KMINIPHOTOTOP.G_CURRKMINIPHOTO.arrBlobUrl.push(e.src),t=document.getElementById("open_file"),t.value="",KMINIPHOTOTOP.KMINIPHOTO.browser.ie&&10==KMINIPHOTOTOP.KMINIPHOTO.browser.ieVersion&&(t.type="text",t.type="file"),n.src=e.src},50))}function displayOriginalSize(){var e=document.getElementById("original_size"),t=document.getElementById("image_canvas");e.innerHTML=t?t.width+" x "+t.height+" px":"0 x 0 px"}function getDialogWindow(){var e=KMINIPHOTOTOP.window;return null!=KMINIPHOTOTOP.G_CURRKMINIPHOTO.dialogWindow&&(e=KMINIPHOTOTOP.G_CURRKMINIPHOTO.dialogWindow),e}function getDialogDocument(){var e=KMINIPHOTOTOP.window.document;return null!=KMINIPHOTOTOP.G_CURRKMINIPHOTO.dialogWindow&&(e=KMINIPHOTOTOP.G_CURRKMINIPHOTO.dialogWindow.document),e}function getAreaSize(e,t,n){n.areaSize={headerHeight:30,toolHeight:56,imageAreaHeight:e-30-56-20-2,footerHeight:20}}function setImageArea(){var e=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(document.getElementById("miniPhoto_image").parentNode),e=e.right-e.left,t=document.getElementById("miniPhoto_image");t.style.width=e+"px",t.style.height=KMINIPHOTOTOP.G_CURRKMINIPHOTO.areaSize.imageAreaHeight+"px"}function setCanvasPostionCenter(){var e=document.getElementById("image_canvas");if(e){var t=e.parentNode.parentNode,n;t.clientWidth?(n=t.clientWidth,t=t.clientHeight):(t=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(t),n=t.width,t=t.height),t=Math.round(t/2-e.height/2),0>t&&(t=0),n=Math.round(n/2-e.width/2),0>n&&(n=0),e&&(e.parentNode.style.top=t+"px",e.parentNode.style.left=n+"px"),displayOriginalSize()}}function setEvent(){var e=document.getElementById("open_file");e.onchange=function(){var t=e.files[0];if(t){var n=getImageExtensionFromType(t.type),t=(window.URL||window.webkitURL||window).createObjectURL(t);KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt=n,loadImage({isInit:!1,isOpen:!0,src:t})}},document.getElementById("btn_open").onclick=function(){cropCancel(),fileOpen()},document.getElementById("btn_undo").onclick=function(){if(null!=document.getElementById("image_canvas")){cropCancel();var e=document.getElementById("image_canvas");G_HISTORY.undo(e,e.getContext("2d"))}},document.getElementById("btn_redo").onclick=function(){if(null!=document.getElementById("image_canvas")){cropCancel();var e=document.getElementById("image_canvas");G_HISTORY.redo(e,e.getContext("2d"))}},document.getElementById("img_rotate_r").onclick=function(){fn_imageChange({degree:90,flip:0})},document.getElementById("img_rotate_l").onclick=function(){fn_imageChange({degree:-90,flip:0})},document.getElementById("img_flip_h").onclick=function(){fn_imageChange({degree:0,flip:1})},document.getElementById("img_flip_v").onclick=function(){fn_imageChange({degree:0,flip:-1})},document.getElementById("btn_crop").onclick=function(){null!=document.getElementById("image_canvas")&&null==KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper&&(displayProcessing(!0),setTimeout(function(){var e=document.getElementById("image_canvas");e.style.left=e.parentNode.style.left,e.style.top=e.parentNode.style.top,e.parentNode.style.width=e.width+"px",e.parentNode.style.height=e.height+"px",KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper=new Cropper(e,{zoomOnWheel:!1,autoCrop:!1,toggleDragModeOnDblclick:!1,ready:function(){document.getElementById("crop_tools_area").className="",document.getElementById("crop_box_size").parentNode.style.display="",selectCropType(0),displayProcessing(!1)},crop:function(e){e=e.detail;if(KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper)try{var t=parseInt(e.width,10),n=parseInt(e.height,10);if(0==t){var r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData();"undefined"!=typeof r.width&&(t=r.width=1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(r))}0==n&&(r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData(),"undefined"!=typeof r.height&&(n=r.height=1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(r))),document.getElementById("crop_box_size").innerHTML=t+" x "+n+" px"}catch(i){}}})},50))},document.getElementById("crop_cancel").onclick=function(){cropCancel()},document.getElementById("crop_ok").onclick=function(){cropOk()},document.getElementById("crop_ratio_0").onclick=function(){setCropBox(0),selectCropType(0)},document.getElementById("crop_ratio_1").onclick=function(){setCropBox(4/3),selectCropType(1)},document.getElementById("crop_ratio_2").onclick=function(){setCropBox(16/9),selectCropType(2)},document.getElementById("crop_ratio_3").onclick=function(){setCropBox(1),selectCropType(3)},document.getElementById("crop_ratio_4").onclick=function(){setCropBox(2/3),selectCropType(4)},document.getElementById("crop_ratio_5").onclick=function(){setCropBox(.75),selectCropType(5)},document.getElementById("btn_reset").onclick=function(){fn_reset()},document.getElementById("btn_apply").onclick=function(){fn_apply()},KMINIPHOTOTOP.document.getElementById("btn_fullscreen_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).onclick=function(){fn_fullscreen()},KMINIPHOTOTOP.document.getElementById("btn_close_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).onclick=function(){fn_close()},KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(document,"keydown",document_keydown),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(document.body,"paste",fn_pasteEvt),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(document,"dragover",function(e){KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e)}),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(document,"drop",insertDropImage),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(window,"unload",_kminiphotoiframe_Unload)}function _kminiphotoiframe_Unload(e){try{var t=getPhotoFromUnloadEvent(e);if("1"==t._config.autoDestroy.use)try{KMINIPHOTOTOP.KMINIPHOTO.Destroy(t)}catch(n){}}catch(r){}}function document_keydown(e){var t="which"in e?e.which:e.keyCode,n=e.ctrlKey;if(KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper&&0==n)if(37==t){KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e);var r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData();--r.left,KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(r)}else 39==t?(KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e),r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData(),r.left+=1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(r)):38==t?(KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e),r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData(),--r.top,KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(r)):40==t?(KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e),r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData(),r.top+=1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(r)):27==t&&cropCancel();1==n&&(e.altKey||86!=t||(KMINIPHOTOTOP.KMINIPHOTO.browser.ie&&11<=KMINIPHOTOTOP.KMINIPHOTO.browser.ieVersion||KMINIPHOTOTOP.KMINIPHOTO.browser.gecko)&&fn_makePasteEvt(e))}function fileOpen(){document.getElementById("open_file").click()}function setCropBox(e){KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.options.aspectRatio=e;var t={};if(0!=e){var n=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCropBoxData();t.width=parseInt(n.height*e,10),t.height=parseInt(n.height,10)}KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.setCropBoxData(t)}function fn_imageChange(e){null!=document.getElementById("image_canvas")&&(displayProcessing(!0),setTimeout(function(){KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper&&cropCancel();var t=document.getElementById("image_canvas"),n=t.getContext("2d");G_HISTORY.saveState(t),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),fn_rotate(e.degree,t,n),fn_flip(e.flip,t,n),n.drawImage(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage,0,0),setCanvasPostionCenter(),displayProcessing(!1)},50))}function fn_rotate(e,t,n){e&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree+=e,360==KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree?KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree=0:0>KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree=360+KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree));switch(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree){case 90:t.width=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalHeight,t.height=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalWidth,t.parentNode.style.width=t.width+"px",t.parentNode.style.height=t.height+"px",n.rotate(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree*Math.PI/180),n.translate(0,-t.width);break;case 180:t.width=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalWidth,t.height=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalHeight,t.parentNode.style.width=t.width+"px",t.parentNode.style.height=t.height+"px",n.rotate(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree*Math.PI/180),n.translate(-1*t.width,-1*t.height);break;case 270:t.width=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalHeight,t.height=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalWidth,t.parentNode.style.width=t.width+"px",t.parentNode.style.height=t.height+"px",n.rotate(KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree*Math.PI/180),n.translate(-1*t.height,0);break;case 0:t.width=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalWidth,t.height=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalHeight,t.parentNode.style.width=t.width+"px",t.parentNode.style.height=t.height+"px",n.translate(0,0)}}function fn_flip(e,t,n){var r;r=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalWidth,t=KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage.naturalHeight,1==e?90==KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree||270==KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree?KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY=KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY?!1:!0:KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX=KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX?!1:!0:-1==e&&(90==KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree||270==KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree?KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX=KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX?!1:!0:KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY=KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY?!1:!0),e=KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX?-1*r:0,t=KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY?-1*t:0,n.scale(KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX?-1:1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY?-1:1),n.translate(e,t)}function fn_reset(){null!=document.getElementById("image_canvas")&&(cropCancel(),G_HISTORY.reset(),loadImage({isInit:!1,src:KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImg.src,width:KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgWidth,height:KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgHeight}))}function fn_apply(){if(null!=document.getElementById("image_canvas")){cropCancel();var e={src:"",width:"",height:""},t=document.getElementById("image_canvas");e.src=t.toDataURL("image/"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt,1),e.width=t.width+"px",e.height=t.height+"px",fn_close();try{"function"==typeof KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.saveCompleteEvent&&KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.saveCompleteEvent(KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID,e)}catch(n){}}}function closeCropArea(){KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper=null,document.getElementById("image_canvas"),document.getElementById("crop_tools_area").className="off";var e=document.getElementById("crop_box_size");e.innerHTML="0 x 0 px",e.parentNode.style.display="none"}function cropCancel(){KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.destroy(),closeCropArea())}function cropOk(){displayProcessing(!0),setTimeout(function(){G_HISTORY.saveState(document.getElementById("image_canvas"));var e=KMINIPHOTOTOP.G_CURRKMINIPHOTO.cropper.getCroppedCanvas();closeCropArea(),e=e.toDataURL("image/"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt,1),loadImage({isInit:!1,src:e})},50)}function displayProcessing(e){document.getElementById("span_processing").style.display=e?"":"none"}function fn_close(){displayProcessing(!1),cropCancel();var e=KMINIPHOTOTOP.G_CURRKMINIPHOTO.arrBlobUrl.length;if(0<e)for(var t=0;t<e;t++)try{(window.URL||window.webkitURL||window).revokeObjectURL(KMINIPHOTOTOP.G_CURRKMINIPHOTO.arrBlobUrl[t])}catch(n){}if(e=document.getElementById("image_canvas"))t=e.getContext("2d"),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),e=e.parentNode,e.style.width="0px",e.style.height="0px",e.innerHTML="";G_HISTORY.reset(),"fullscreen"==KMINIPHOTOTOP.G_CURRKMINIPHOTO.frameStatus&&fullSreenToOriginalSize(),KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.display="none",KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_body_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.display="none",(e=KMINIPHOTOTOP.document.getElementById("kminiphoto_popup_background"))&&KMINIPHOTOTOP.document.body.removeChild(e)}function fn_fullscreen(){var e=KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID),t=document.getElementById("miniPhoto_holder"),n=document.getElementById("miniPhoto_image");if(""==KMINIPHOTOTOP.G_CURRKMINIPHOTO.frameStatus){var r=KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.dialogWindow?KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.dialogWindow:KMINIPHOTOTOP.window;G_originScrollSize=getWindowScrollPos(r),G_originPhotoSize.push(e.style.width),G_originPhotoSize.push(e.style.height),G_originfull.margin1=KMINIPHOTOTOP.document.documentElement.style.margin,G_originfull.padding1=KMINIPHOTOTOP.document.documentElement.style.padding,G_originfull.border1=KMINIPHOTOTOP.document.documentElement.style.border,G_originfull.height1=KMINIPHOTOTOP.document.documentElement.style.height,G_originfull.overflow1=KMINIPHOTOTOP.document.documentElement.style.overflow,"1"==KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.fullscreenType&&(G_originfull.margin2=KMINIPHOTOTOP.document.body.style.margin,G_originfull.padding2=KMINIPHOTOTOP.document.body.style.padding,G_originfull.border2=KMINIPHOTOTOP.document.body.style.border,G_originfull.height2=KMINIPHOTOTOP.document.body.style.height,G_originfull.overflow2=KMINIPHOTOTOP.document.body.style.overflow),KMINIPHOTOTOP.document.documentElement.style.overflow="hidden",KMINIPHOTOTOP.document.documentElement.style.padding="0",KMINIPHOTOTOP.document.documentElement.style.margin="0",KMINIPHOTOTOP.document.documentElement.style.border="0",KMINIPHOTOTOP.document.documentElement.style.height="100%","1"==KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.fullscreenType&&(KMINIPHOTOTOP.document.body.style.overflow="hidden",KMINIPHOTOTOP.document.body.style.padding="0",KMINIPHOTOTOP.document.body.style.margin="0",KMINIPHOTOTOP.document.body.style.border="0",KMINIPHOTOTOP.document.body.style.height="100%"),G_originfull.overflow3=e.style.overflow,G_originfull.position3=e.style.position,G_originfull.zIndex=e.style.zIndex,KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(e),e.style.overflow="hidden",e.style.position="absolute",e.style.width="100%",e.style.height="100%";var i=getWindowClientSize(r);e.style.width=i[0]+"px",e.style.height=i[1]+"px",t.style.width=i[0]-2+"px",n.style.width=i[0]-2+"px",n.style.height=i[1]-30-56-20-2+"px",KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_header_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.width=i[0]-2+"px",G_origianPopupPos.push(e.style.left),G_origianPopupPos.push(e.style.top),e.style.left="0px",e.style.top="0px",t=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(e),G_relativePos=isRelativePosition(e),0<t.left||0<t.top?G_isRelativePos=!0:"0"==KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.fullscreenType&&(0<G_originScrollSize[0]&&(e.style.left=G_originScrollSize[0]+"px"),0<G_originScrollSize[1]&&(e.style.top=G_originScrollSize[1]+"px")),"1"==KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.fullscreenType&&adjustPopupPosition(),setBackupHiddenStyle(e,r),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(r,"resize",resizeForFullscreen),KMINIPHOTOTOP.G_CURRKMINIPHOTO.frameStatus="fullscreen",KMINIPHOTOTOP.document.getElementById("btn_fullscreen_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.backgroundPosition="0 -50px",KMINIPHOTOTOP.document.getElementById("btn_fullscreen_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).title=KMiniPhoto_Lang.originalScreen,setCanvasPostionCenter()}else fullSreenToOriginalSize()}function adjustPopupPosition(e){void 0==e&&(e=document.getElementById("miniPhoto_holder"));var t=KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_header_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID);t&&(t=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(t),0>t.top&&(e.style.top=KMINIPHOTOTOP.KMINIPHOTO.util.parseIntOr0(e.style.top)-KMINIPHOTOTOP.KMINIPHOTO.util.parseIntOr0(t.top)+"px"))}function getWindowScrollPos(e){return"number"==typeof e.pageYOffset?[e.pageXOffset,e.pageYOffset]:e.document.body&&(e.document.body.scrollLeft||e.document.body.scrollTop)?[e.document.body.scrollLeft,e.document.body.scrollTop]:e.document.documentElement&&(e.document.documentElement.scrollLeft||e.document.documentElement.scrollTop)?[e.document.documentElement.scrollLeft,e.document.documentElement.scrollTop]:[0,0]}function getWindowClientSize(e){var t=0,n=0;return"number"==typeof e.innerWidth?(t=e.innerWidth,n=e.innerHeight):e.document.documentElement&&(e.document.documentElement.clientWidth||e.document.documentElement.clientHeight)?(t=e.document.documentElement.clientWidth,n=e.document.documentElement.clientHeight):e.document.body&&(e.document.body.clientWidth||e.document.body.clientHeight)&&(t=e.document.body.clientWidth,n=e.document.body.clientHeight),[t,n]}function isRelativePosition(e){for(;null!=e&&(!e.tagName||"body"!=e.tagName.toLowerCase());)if(e=e.parentNode,"relative"==e.style.position)return!0;return!1}function setBackupHiddenStyle(e,t){G_originStylebackup=[];for(var n=e;null!=n&&(!n.tagName||"body"!=n.tagName.toLowerCase());){if(n!=e){var r;(r=t.getComputedStyle?t.getComputedStyle(n,""):n.currentStyle)&&r.overflow&&"hidden"==r.overflow&&(G_originStylebackup.push(n),n.style.setProperty?n.style.setProperty("overflow","visible",null):n.style.setAttribute("overflow","visible"))}n=n.parentNode}}function resizeForFullscreen(){var e=KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID),t=document.getElementById("miniPhoto_holder"),n=document.getElementById("miniPhoto_image"),r=KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.dialogWindow?KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.dialogWindow:KMINIPHOTOTOP.window,i=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(e);e.style.left=KMINIPHOTOTOP.KMINIPHOTO.util.parseIntOr0(e.style.left)+ -1*i.left+"px",e.style.top=KMINIPHOTOTOP.KMINIPHOTO.util.parseIntOr0(e.style.top)+ -1*i.top+"px",r=getWindowClientSize(r),e.style.width=r[0]+"px",e.style.height=r[1]+"px",KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_header_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.width=r[0]-2+"px",t.style.width=r[0]-2+"px",t.style.height=r[1]+"px",n.style.width=r[0]-2+"px",n.style.height=r[1]-30-56-20-2+"px",setCanvasPostionCenter()}function fullSreenToOriginalSize(){var e=KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID),t=document.getElementById("miniPhoto_holder"),n=document.getElementById("miniPhoto_image");KMINIPHOTOTOP.KMINIPHOTO.util.removeEvent(KMINIPHOTOTOP.window,"resize",resizeForFullscreen),KMINIPHOTOTOP.document.documentElement.style.margin=G_originfull.margin1,KMINIPHOTOTOP.document.documentElement.style.padding=G_originfull.padding1,KMINIPHOTOTOP.document.documentElement.style.border=G_originfull.border1,KMINIPHOTOTOP.document.documentElement.style.height=G_originfull.height1,KMINIPHOTOTOP.document.documentElement.style.overflow=G_originfull.overflow1,"1"==KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.fullscreenType&&(KMINIPHOTOTOP.document.body.style.margin=G_originfull.margin2,KMINIPHOTOTOP.document.body.style.padding=G_originfull.padding2,KMINIPHOTOTOP.document.body.style.border=G_originfull.border2,KMINIPHOTOTOP.document.body.style.height=G_originfull.height2,KMINIPHOTOTOP.document.body.style.overflow=G_originfull.overflow2),e.style.overflow=G_originfull.overflow3,e.style.position=G_originfull.position3,0<G_originPhotoSize.length&&(e.style.width=G_originPhotoSize[0],e.style.height=G_originPhotoSize[1],t.style.width=parseInt(G_originPhotoSize[0],10)-2+"px",KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_header_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.width=parseInt(G_originPhotoSize[0],10)-2+"px",n.style.width=parseInt(G_originPhotoSize[0],10)-2+"px",n.style.height=parseInt(G_originPhotoSize[1],10)-30-56-20-2+"px",G_originPhotoSize=[]),0<G_origianPopupPos.length&&(e.style.left=G_origianPopupPos[0],e.style.top=G_origianPopupPos[1],G_origianPopupPos=[]),setRestorreHiddenStyle(),G_toolHeight=0,null!=G_originScrollSize&&(KMINIPHOTOTOP.window.scroll(G_originScrollSize[0],G_originScrollSize[1]),G_originScrollSize=null),KMINIPHOTOTOP.G_CURRKMINIPHOTO.frameStatus="",KMINIPHOTOTOP.document.getElementById("btn_fullscreen_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.backgroundPosition="0 0",KMINIPHOTOTOP.document.getElementById("btn_fullscreen_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).title=KMiniPhoto_Lang.fullScreen,setCanvasPostionCenter()}function setRestorreHiddenStyle(){for(var e=G_originStylebackup.length,t=0;t<e;t++){var n=G_originStylebackup[t];n.style.setProperty?n.style.setProperty("overflow","hidden",null):n.style.setAttribute("overflow","hidden")}G_originStylebackup=[]}function showPhotoPopup(e){var t=KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID);t.parentNode.style.display="",document.getElementById("miniPhoto_holder"),document.getElementById("miniPhoto_image");var n=getWindowClientSize(KMINIPHOTOTOP.window),r=getWindowScrollPos(KMINIPHOTOTOP.window),i;if(null==document.getElementById("kminiphoto_popup_background")){i=document.createElement("div"),i.setAttribute("id","kminiphoto_popup_background");var s='<div style="'+KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.popupBackgroundStyle+" z-index:"+(KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.zIndex-1)+'; position:fixed; _position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>',s=s+('<iframe frameborder="0" scrolling="no" style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; left: 0px; top: 0px; width: 100%; height: 100%; display: block; position: absolute; z-index: '+(KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.zIndex-2)+';"></iframe>');i.innerHTML=s,KMINIPHOTOTOP.document.body.appendChild(i),i.getElementsByTagName("iframe")[0].style.height=n[1]+r[1]+"px"}t.style.display="",t.style.position="absolute",t.style.zIndex=KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.zIndex,i=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(t),s=i.bottom-i.top,t.style.left=r[0]+n[0]/2-(i.right-i.left)/2+"px",t.style.top=r[1]+n[1]/2-s/2+"px",adjustPopupPosition(),makeDragPopup(t),setImageArea(),null!=e.url&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt=getImageExtensionFromUrl(e.url)),loadImage({isInit:!0,src:e.url,width:e.width,height:e.height}),KMINIPHOTOTOP.KMINIPHOTO.browser.ie?setTimeout(function(){try{window.focus(),document.focus(),document.body.focus()}catch(e){}},0):setTimeout(function(){try{window.focus(),document.body.focus()}catch(e){}},0)}function makeDragPopup(e){G_drag=!1;var t=e.firstChild;KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(t,"mousedown",startDrag),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(t,"mouseover",function(){t.style.cursor="move"}),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(t,"mouseout",function(){t.style.cursor="default"}),G_dragPopup=e}function startDrag(e){""==KMINIPHOTOTOP.G_CURRKMINIPHOTO.frameStatus&&(e||(e=KMINIPHOTOTOP.window.event),G_offsetX=e.clientX,G_offsetY=e.clientY,G_dragPopup.style.left||(G_dragPopup.style.left="0px"),G_dragPopup.style.top||(G_dragPopup.style.top="0px"),G_coordX=parseInt(G_dragPopup.style.left),G_coordY=parseInt(G_dragPopup.style.top),G_drag=!0,KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_body_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.display="",KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(KMINIPHOTOTOP.document,"mousemove",dragDiv),KMINIPHOTOTOP.KMINIPHOTO.util.addEvent(KMINIPHOTOTOP.document,"mouseup",stopDrag)),KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e)}function dragDiv(e){if(G_drag){e||(e=KMINIPHOTOTOP.window.event);var t=getWindowClientSize(KMINIPHOTOTOP.window),n=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(G_dragPopup),n=[n.right-n.left||0,n.bottom-n.top||0];currentScrollPos=getWindowScrollPos(KMINIPHOTOTOP.window);var r=G_coordX+e.clientX-G_offsetX,i=G_coordY+e.clientY-G_offsetY;0>=r-currentScrollPos[0]&&(r=currentScrollPos[0]),0>=i-currentScrollPos[1]&&(i=currentScrollPos[1]),r+n[0]>=t[0]+currentScrollPos[0]&&(r=t[0]-n[0]+currentScrollPos[0]),i+n[1]>=t[1]+currentScrollPos[1]&&(i=t[1]-n[1]+currentScrollPos[1]),G_dragPopup.style.left=r+"px",G_dragPopup.style.top=i+"px",KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_header_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID),adjustPopupPosition(G_dragPopup),KMINIPHOTOTOP.KMINIPHOTO.util.stopEvent(e),KMINIPHOTOTOP.KMINIPHOTO.util.cancelEvent(e)}}function stopDrag(e){G_drag=!1,G_dragPopup.style.cursor="",KMINIPHOTOTOP.KMINIPHOTO.util.removeEvent(KMINIPHOTOTOP.document,"mousemove",dragDiv),KMINIPHOTOTOP.KMINIPHOTO.util.removeEvent(KMINIPHOTOTOP.document,"mouseup",stopDrag),KMINIPHOTOTOP.document.getElementById("kminiphoto_holder_body_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.ID).style.display="none"}function selectCropType(e){for(var t=0;6>t;t++)document.getElementById("crop_ratio_"+t).parentNode.style.backgroundColor=e==t?"#b5d0f1":""}function getImageExtensionFromType(e){var t="png";try{e&&""!=e&&(e=e.split("/")[1]),e&&0<e.length&&(t="gif"==e||"png"==e?"png":"jpeg")}catch(n){t="png"}return t}function getImageExtensionFromUrl(e){var t="";try{if(0==e.indexOf("data:")){var n=e.split(",");2==n.length&&(t=getExtFromImageDataSrc(n[0]))}else var r=e.split("?"),i=r[0].lastIndexOf("."),t=r[0].substring(i+1,r[0].length),t=t.toLowerCase();t="gif"==t||"png"==t?"png":"jpeg"}catch(s){t="png"}return t}function getExtFromImageDataSrc(e){var t="";return e=e.replace("data:","").split(";"),0<e.length&&(e=e[0].split("/"),2==e.length&&(t=e[1])),t}function getPhotoFromUnloadEvent(e){var t=null;try{if(null!=e){var n=e.target?e.target:e.srcElement;if(n)try{e="",n._raonk_miniphoto?e="kminiphoto_frame_"+n._raonk_miniphoto.ID:n.defaultView&&(e="kminiphoto_frame_"+KMINIPHOTOTOP.G_CURRKMINIPHOTO),t=KMINIPHOTOTOP.KMINIPHOTO.RAONKMULTIPLE[e]}catch(r){t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}else t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}else t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}catch(i){t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}return t}function fn_makePasteEvt(e){try{if(e&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO=getPhotoFromEvent(e)),KMINIPHOTOTOP.KMINIPHOTO.browser.ie){var t=document.createElement("div");t.id="pasteDiv",t.innerHTML=unescape("%uFEFF"),t.style.position="absolute",t.style.filter="alpha(opacity=0)",t.style.overflow="hidden",t.style.left="-1000px",t.style.top="-1000px",t.style.width="0px",t.style.height="0px",t.contentEditable=!0,document.body.appendChild(t),t.focus()}else if(KMINIPHOTOTOP.KMINIPHOTO.browser.gecko){var n=document.createElement("iframe");n.id="pasteIframe",n.frameBorder=0,n.style.width="0px",n.style.height="0px",n.style.position="absolute",n.style.left="0px",n.style.top="0px";if(KMINIPHOTOTOP.KMINIPHOTO.browser.mobile||KMINIPHOTOTOP.KMINIPHOTO.browser.iOS)n.style.overflow="hidden",n.style.display="inline-block";var r="document.open();"+(KMINIPHOTOTOP.KMINIPHOTO.browser.isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",r=KMINIPHOTOTOP.KMINIPHOTO.browser.ie?"javascript:void(function(){"+encodeURIComponent(r)+"}())":"";n.src=r,document.body.appendChild(n);var i=KMINIPHOTOTOP.KMINIPHOTO.util.getIframeDocument(n);i.open("text/html","replace"),KMINIPHOTOTOP.KMINIPHOTO.browser.isCustomDomain(document)&&(i.domain=document.domain),i.write('<body contenteditable="true">'+unescape("%uFEFF")+"</body>"),i.close(),i.body.contentEditable=!0,i.body.onpaste=fn_pasteEvt,i.body.focus()}}catch(s){}}function fn_pasteEvt(e){try{var t=KMINIPHOTOTOP.G_CURRKMINIPHOTO;document.createElement("canvas").getContext("2d");if(KMINIPHOTOTOP.KMINIPHOTO.browser.ie||KMINIPHOTOTOP.KMINIPHOTO.browser.gecko)setTimeout(function(){var e=null,n=null;if(KMINIPHOTOTOP.KMINIPHOTO.browser.ie)n=e=document.getElementById("pasteDiv");else if(KMINIPHOTOTOP.KMINIPHOTO.browser.gecko)try{var r=document.getElementById("pasteIframe");r&&(e=KMINIPHOTOTOP.KMINIPHOTO.util.getIframeDocument(r).body,n=r)}catch(i){e=null}e&&(e.blur(),e=e.getElementsByTagName("img"),0<e.length&&(t.initImgExt="png",loadImage({isInit:!1,isOpen:!0,src:e[0].src})),n.parentNode.removeChild(n))},0);else if(KMINIPHOTOTOP.KMINIPHOTO.browser.chrome||KMINIPHOTOTOP.KMINIPHOTO.browser.opera){var n=e.clipboardData.items,r=n.length;for(e=0;e<r;++e){var i=n[e].getAsFile(),s=new FileReader;s.onload=function(e){e=e.target.result,t.initImgExt="png",loadImage({isInit:!1,isOpen:!0,src:e}),s=void 0},s.readAsDataURL(i)}}}catch(o){}}function getPhotoFromEvent(e){var t=null;try{if(null!=e){var n=e.target?e.target:e.srcElement;if(n){e=null,e=9!=n.nodeType?n.ownerDocument:n;try{e=e.defaultView?e.defaultView:e.parentWindow,t=KMINIPHOTOTOP.KMINIPHOTO.RAONKMULTIPLE[e.frameElement.id]}catch(r){t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}}else t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}else t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}catch(i){t=KMINIPHOTOTOP.G_CURRKMINIPHOTO}return t}function insertDropImage(e){var t=e.dataTransfer.files;e.stopPropagation(),e.preventDefault();if(0<t.length&&t[0].type&&0==t[0].type.indexOf("image")){var n=getImageExtensionFromType(t[0].type),r=new FileReader;r.onload=function(e){e=e.target.result,"data:"==e.substring(0,5)&&2==e.split(",").length&&(KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt=n,loadImage({isInit:!1,isOpen:!0,src:e})),r=void 0},r.readAsDataURL(t[0])}}(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Cropper=t()})(this,function(){function e(e){return"number"==typeof e&&!isNaN(e)}function t(e){return"undefined"==typeof e}function n(e){return"object"===("undefined"==typeof e?"undefined":F(e))&&null!==e}function r(e){if(!n(e))return!1;try{var t=e.constructor,r=t.prototype;return t&&r&&K.call(r,"isPrototypeOf")}catch(i){return!1}}function i(e){return"function"===J.call(e).slice(8,-1).toLowerCase()}function s(e){return Array.isArray?Array.isArray(e):"array"===J.call(e).slice(8,-1).toLowerCase()}function o(e){return"string"==typeof e&&(e=e.trim?e.trim():e.replace(W,"$1")),e}function u(t,r){if(t&&i(r)){var o=void 0;if(s(t)||e(t.length))for(var u=t.length,o=0;o<u&&!1!==r.call(t,t[o],o,t);o+=1);else n(t)&&Object.keys(t).forEach(function(e){r.call(t,t[e],e,t)})}return t}function a(e){for(var t=arguments.length,r=Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(n(e)&&0<r.length){if(Object.assign)return Object.assign.apply(Object,[e].concat(r));r.forEach(function(t){n(t)&&Object.keys(t).forEach(function(n){e[n]=t[n]})})}return e}function f(e,t){for(var n=arguments.length,r=Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return function(){for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.apply(t,r.concat(i))}}function l(t,n){var r=t.style;u(n,function(t,n){z.test(n)&&e(t)&&(t+="px"),r[n]=t})}function c(e,t){return e.classList?e.classList.contains(t):-1<e.className.indexOf(t)}function h(t,n){if(n)if(e(t.length))u(t,function(e){h(e,n)});else if(t.classList)t.classList.add(n);else{var r=o(t.className);r?0>r.indexOf(n)&&(t.className=r+" "+n):t.className=n}}function p(t,n){n&&(e(t.length)?u(t,function(e){p(e,n)}):t.classList?t.classList.remove(n):0<=t.className.indexOf(n)&&(t.className=t.className.replace(n,"")))}function d(t,n,r){n&&(e(t.length)?u(t,function(e){d(e,n,r)}):r?h(t,n):p(t,n))}function v(e){return e.replace(q,"$1-$2").toLowerCase()}function m(e,t){return n(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-"+v(t))}function g(e,t,r){n(r)?e[t]=r:e.dataset?e.dataset[t]=r:e.setAttribute("data-"+v(t),r)}function y(e,t){if(n(e[t]))delete e[t];else if(e.dataset)try{delete e.dataset[t]}catch(r){e.dataset[t]=null}else e.removeAttribute("data-"+v(t))}function b(e,t,n){var r=o(t).split(U);1<r.length?u(r,function(t){b(e,t,n)}):e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function w(e,t,n,r){var i=o(t).split(U),s=n;1<i.length?u(i,function(t){w(e,t,n)}):(r&&(n=function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return b(e,t,n),s.apply(e,i)}),e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n))}function E(e,n,r){if(e.dispatchEvent){var s=void 0;return i(Event)&&i(CustomEvent)?s=t(r)?new Event(n,{bubbles:!0,cancelable:!0}):new CustomEvent(n,{detail:r,bubbles:!0,cancelable:!0}):t(r)?(s=document.createEvent("Event"),s.initEvent(n,!0,!0)):(s=document.createEvent("CustomEvent"),s.initCustomEvent(n,!0,!0,r)),e.dispatchEvent(s)}return e.fireEvent?e.fireEvent("on"+n):!0}function S(t){var n=t||window.event;n.target||(n.target=n.srcElement||document);if(!e(n.pageX)&&e(n.clientX)){var r=t.target.ownerDocument||document;t=r.documentElement,r=r.body,n.pageX=n.clientX+((t&&t.scrollLeft||r&&r.scrollLeft||0)-(t&&t.clientLeft||r&&r.clientLeft||0)),n.pageY=n.clientY+((t&&t.scrollTop||r&&r.scrollTop||0)-(t&&t.clientTop||r&&r.clientTop||0))}return n}function x(e){var t=document.documentElement;return e=e.getBoundingClientRect(),{left:e.left+((window.scrollX||t&&t.scrollLeft||0)-(t&&t.clientLeft||0)),top:e.top+((window.scrollY||t&&t.scrollTop||0)-(t&&t.clientTop||0))}}function T(e,t){return e.getElementsByClassName?e.getElementsByClassName(t):e.querySelectorAll("."+t)}function N(e){e.parentNode&&e.parentNode.removeChild(e)}function C(e){return(e=e.match(R))&&(e[1]!==location.protocol||e[2]!==location.hostname||e[3]!==location.port)}function k(e){var t="timestamp="+(new Date).getTime();return e+(-1===e.indexOf("?")?"?":"&")+t}function L(e,t){if(e.naturalWidth&&!$)t(e.naturalWidth,e.naturalHeight);else{var n=document.createElement("img");n.onload=function(){t(this.width,this.height)},n.src=e.src}}function A(t){var n=[],r=t.translateX,i=t.translateY,s=t.rotate,o=t.scaleX;return t=t.scaleY,e(r)&&0!==r&&n.push("translateX("+r+"px)"),e(i)&&0!==i&&n.push("translateY("+i+"px)"),e(s)&&0!==s&&n.push("rotate("+s+"deg)"),e(o)&&1!==o&&n.push("scaleX("+o+")"),e(t)&&1!==t&&n.push("scaleY("+t+")"),n=n.length?n.join(" "):"none",{WebkitTransform:n,msTransform:n,transform:n}}function O(e,t){var n=Math.abs(e.degree)%180,r=(90<n?180-n:n)*Math.PI/180,n=Math.sin(r),r=Math.cos(r),i=e.width,s=e.height,o=e.aspectRatio,u=void 0,a=void 0;return t?(u=i/(r+n/o),a=u/o):(u=i*r+s*n,a=i*n+s*r),{width:u,height:a}}function M(t,n,r){var i=document.createElement("canvas"),s=i.getContext("2d"),o=0,u=0,a=n.naturalWidth,f=n.naturalHeight,l=n.rotate,c=n.scaleX;n=n.scaleY;var h=e(c)&&e(n)&&(1!==c||1!==n),p=e(l)&&0!==l,d=p||h,v=a*Math.abs(c||1),m=f*Math.abs(n||1),g=void 0,y=void 0,b=void 0;return h&&(g=v/2,y=m/2),p&&(b=O({width:v,height:m,degree:l}),v=b.width,m=b.height,g=v/2,y=m/2),i.width=v,i.height=m,r.fillColor&&(s.fillStyle=r.fillColor,s.fillRect(0,0,v,m)),d&&(o=-a/2,u=-f/2,s.save(),s.translate(g,y)),p&&s.rotate(l*Math.PI/180),h&&s.scale(c,n),s.imageSmoothingEnabled=!!r.imageSmoothingEnabled,r.imageSmoothingQuality&&(s.imageSmoothingQuality=r.imageSmoothingQuality),s.drawImage(t,Math.floor(o),Math.floor(u),Math.floor(a),Math.floor(f)),d&&s.restore(),i}function _(e){e=e.replace(I,""),e=atob(e);for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=void 0,i=0;i<t;i+=1)r[i]=e.charCodeAt(i);return n}function D(e,t){var n=e.pageX,r=e.pageY,i={endX:n,endY:r};return t?i:a({startX:n,startY:r},i)}function P(e){var t=a({},e),n=[];return u(e,function(e,r){delete t[r],u(t,function(t){var r=Math.abs(e.startX-t.startX),i=Math.abs(e.startY-t.startY),s=Math.abs(e.endX-t.endX);t=Math.abs(e.endY-t.endY),r=Math.sqrt(r*r+i*i),s=(Math.sqrt(s*s+t*t)-r)/r,n.push(s)})}),n.sort(function(e,t){return Math.abs(e)<Math.abs(t)}),n[0]}function H(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function B(e){var t=0,n=0,r=0;return u(e,function(e){var i=e.startY;t+=e.startX,n+=i,r+=1}),t/=r,n/=r,{pageX:t,pageY:n}}var j={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!1,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:1,minContainerHeight:1,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I=/^data:.*,/,q=/([a-z\d])([A-Z])/g,R=/^(https?:)\/\/([^:/?#]+):?(\d*)/i,U=/\s+/,z=/^(width|height|left|top|marginLeft|marginTop)$/,W=/^\s+(.*)\s+$/,X=/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i,V="undefined"!=typeof window?window.navigator:null,$=V&&X.test(V.userAgent),X=Object.prototype,J=X.toString,K=X.hasOwnProperty,Q=String.fromCharCode,G=(X="undefined"!=typeof window?window.PointerEvent:null)?"pointerdown":"touchstart mousedown",Y=X?"pointermove":"touchmove mousemove",Z=X?" pointerup pointercancel":"touchend touchcancel mouseup",et=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,tt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),nt=/^data:/,rt=/^data:image\/jpeg;base64,/,it=void 0,X=function(){function e(t,n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.element=t,this.options=a({},j,r(n)&&n),this.isImg=this.wheeling=this.limited=this.replaced=this.disabled=this.cropped=this.rotated=this.complete=this.ready=this.loaded=!1,this.originalUrl="",this.previews=this.cropBoxData=this.canvasData=null,this.pointers={},this.init()}return tt(e,[{key:"init",value:function(){var e=this.element,t=e.tagName.toLowerCase(),n=void 0;if(!m(e,"cropper")){g(e,"cropper",this);if("img"===t){this.isImg=!0,this.originalUrl=n=e.getAttribute("src");if(!n)return;n=e.src}else"canvas"===t&&window.HTMLCanvasElement&&(n=e.toDataURL("image/"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt,1));this.load(n)}}},{key:"load",value:function(e){var t=this,n=t.options,r=t.element;if(e)if(t.url=e,t.imageData={},n.checkOrientation&&window.ArrayBuffer)if(nt.test(e))rt.test(e)?t.read(_(e)):t.clone();else{var i=new XMLHttpRequest;i.onerror=function(){t.clone()},i.onload=function(){t.read(i.response)},n.checkCrossOrigin&&C(e)&&r.crossOrigin&&(e=k(e)),i.open("get",e),i.responseType="arraybuffer",i.withCredentials="use-credentials"===r.crossOrigin,i.send()}else t.clone()}},{key:"read",value:function(e){var t=this.options,n;n=new DataView(e);var r=n.byteLength,i=void 0,s=void 0,o=void 0,u=s=void 0,a=o=s=void 0,f=s=void 0;if(255===n.getUint8(0)&&216===n.getUint8(1))for(s=2;s<r;){if(255===n.getUint8(s)&&225===n.getUint8(s+1)){o=s;break}s+=1}if(o){s=o+4,o+=10,r="",f=s;for(s=4+s;f<s;f+=1)r+=Q(n.getUint8(f));"Exif"===r&&(s=n.getUint16(o),!(u=18761===s)&&19789!==s||42!==n.getUint16(o+2,u)||(s=n.getUint32(o+4,u),8<=s&&(a=o+s)))}if(a)for(r=n.getUint16(a,u),f=0;f<r;f+=1)if(s=a+12*f+2,274===n.getUint16(s,u)){s+=8,i=n.getUint16(s,u),$&&n.setUint16(s,1,u);break}n=i,i=this.imageData,u=0,r=a=1;if(1<n){e=new Uint8Array(e),o=e.length,s="",f=void 0;for(f=0;f<o;f+=1)s+=Q(e[f]);this.url="data:image/jpeg;base64,"+btoa(s);switch(n){case 2:a=-1;break;case 3:u=-180;break;case 4:r=-1;break;case 5:u=90,r=-1;break;case 6:u=90;break;case 7:u=90,a=-1;break;case 8:u=-90}}t.rotatable&&(i.rotate=u),t.scalable&&(i.scaleX=a,i.scaleY=r),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,n=void 0,r=void 0;this.options.checkCrossOrigin&&C(t)&&((n=e.crossOrigin)?r=t:(n="anonymous",r=k(t))),this.crossOrigin=n,this.crossOriginUrl=r;var i=document.createElement("img");n&&(i.crossOrigin=n),i.src=r||t,t=f(this.start,this),n=f(this.stop,this),this.image=i,this.onStart=t,this.onStop=n,this.isImg?e.complete?this.start():w(e,"load",t):(w(i,"load",t),w(i,"error",n),h(i,"cropper-hide"),e.parentNode.insertBefore(i,e.nextSibling))}},{key:"start",value:function(e){var t=this,n=t.isImg?t.element:t.image;e&&(b(n,"load",t.onStart),b(n,"error",t.onStop)),L(n,function(e,n){a(t.imageData,{naturalWidth:e,naturalHeight:n,aspectRatio:e/n}),t.loaded=!0,t.build()})}},{key:"stop",value:function(){var e=this.image;b(e,"load",this.onStart),b(e,"error",this.onStop),N(e),this.image=null}},{key:"build",value:function(){var e=this,t=e.options,n=e.element,r=e.image;if(e.loaded){e.ready&&e.unbuild();var s=n.parentNode,o=document.createElement("div");o.innerHTML='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>';var o=T(o,"cropper-container")[0],u=T(o,"cropper-canvas")[0],a=T(o,"cropper-drag-box")[0],f=T(o,"cropper-crop-box")[0],l=T(f,"cropper-face")[0];e.container=s,e.cropper=o,e.canvas=u,e.dragBox=a,e.cropBox=f,e.viewBox=T(o,"cropper-view-box")[0],e.face=l,u.appendChild(r),h(n,"cropper-hidden"),s.insertBefore(o,n.nextSibling),e.isImg||p(r,"cropper-hide"),e.initPreview(),e.bind(),t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,(e.cropped=t.autoCrop)?t.modal&&h(a,"cropper-modal"):h(f,"cropper-hidden"),t.guides||h(T(f,"cropper-dashed"),"cropper-hidden"),t.center||h(T(f,"cropper-center"),"cropper-hidden"),t.background&&h(o,"cropper-bg"),t.highlight||h(l,"cropper-invisible"),t.cropBoxMovable&&(h(l,"cropper-move"),g(l,"action","all")),t.cropBoxResizable||(h(T(f,"cropper-line"),"cropper-hidden"),h(T(f,"cropper-point"),"cropper-hidden")),e.setDragMode(t.dragMode),e.render(),e.ready=!0,e.setData(t.data),e.completing=setTimeout(function(){i(t.ready)&&w(n,"ready",t.ready,!0),E(n,"ready"),E(n,"crop",e.getData()),e.complete=!0},0)}}},{key:"unbuild",value:function(){this.ready&&(this.complete||clearTimeout(this.completing),this.complete=this.ready=!1,this.cropBoxData=this.canvasData=this.containerData=this.initialCropBoxData=this.initialCanvasData=this.initialImageData=null,this.unbind(),this.resetPreview(),this.container=this.canvas=this.dragBox=this.cropBox=this.viewBox=this.previews=null,N(this.cropper),this.cropper=null)}}],[{key:"noConflict",value:function(){return window.Cropper=it,e}},{key:"setDefaults",value:function(e){a(j,r(e)&&e)}}]),e}();return a(X.prototype,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.options,t=this.element,n=this.container,r=this.cropper;h(r,"cropper-hidden"),p(t,"cropper-hidden"),this.containerData=e={width:Math.max(n.offsetWidth,Number(e.minContainerWidth)||200),height:Math.max(n.offsetHeight,Number(e.minContainerHeight)||100)},l(r,{width:e.width,height:e.height}),h(t,"cropper-hidden"),p(r,"cropper-hidden")},initCanvas:function(){var e=this.options.viewMode,t=this.containerData,n=this.imageData,r=90===Math.abs(n.rotate)%180,i=r?n.naturalHeight:n.naturalWidth,s=r?n.naturalWidth:n.naturalHeight,o=i/s,r=t.width,u=t.height;t.height*o>t.width?3===e?r=t.height*o:u=t.width/o:3===e?u=t.width/o:r=t.height*o,i={naturalWidth:i,naturalHeight:s,aspectRatio:o,width:r,height:u},i.left=(t.width-r)/2,i.top=(t.height-u)/2,i.oldLeft=i.left,i.oldTop=i.top,this.canvasData=i,this.limited=1===e||2===e,this.limitCanvas(!0,!0),this.initialImageData=a({},n),this.initialCanvasData=a({},i)},limitCanvas:function(e,t){var n=this.options,r=n.viewMode,i=this.containerData,s=this.canvasData,o=s.aspectRatio,u=this.cropBoxData,a=this.cropped&&u;if(e){var f=Number(n.minCanvasWidth)||0,n=Number(n.minCanvasHeight)||0;1<r?(f=Math.max(f,i.width),n=Math.max(n,i.height),3===r&&(n*o>f?f=n*o:n=f/o)):0<r&&(f?f=Math.max(f,a?u.width:0):n?n=Math.max(n,a?u.height:0):a&&(f=u.width,n=u.height,n*o>f?f=n*o:n=f/o)),f&&n?n*o>f?n=f/o:f=n*o:f?n=f/o:n&&(f=n*o),s.minWidth=f,s.minHeight=n,s.maxWidth=Infinity,s.maxHeight=Infinity}t&&(r?(o=i.width-s.width,f=i.height-s.height,s.minLeft=Math.min(0,o),s.minTop=Math.min(0,f),s.maxLeft=Math.max(0,o),s.maxTop=Math.max(0,f),a&&this.limited&&(s.minLeft=Math.min(u.left,u.left+(u.width-s.width)),s.minTop=Math.min(u.top,u.top+(u.height-s.height)),s.maxLeft=u.left,s.maxTop=u.top,2===r&&(s.width>=i.width&&(s.minLeft=Math.min(0,o),s.maxLeft=Math.max(0,o)),s.height>=i.height&&(s.minTop=Math.min(0,f),s.maxTop=Math.max(0,f))))):(s.minLeft=-s.width,s.minTop=-s.height,s.maxLeft=i.width,s.maxTop=i.height))},renderCanvas:function(e){var t=this.canvasData,n=this.imageData,r=n.rotate;if(this.rotated){this.rotated=!1;var i=O({width:n.width,height:n.height,degree:r}),s=i.width/i.height,o=1===n.aspectRatio;if(o||s!==t.aspectRatio){t.left-=(i.width-t.width)/2,t.top-=(i.height-t.height)/2,t.width=i.width,t.height=i.height,t.aspectRatio=s,t.naturalWidth=n.naturalWidth,t.naturalHeight=n.naturalHeight;if(o&&r%90||r%180)n=O({width:n.naturalWidth,height:n.naturalHeight,degree:r}),t.naturalWidth=n.width,t.naturalHeight=n.height;this.limitCanvas(!0,!1)}}if(t.width>t.maxWidth||t.width<t.minWidth)t.left=t.oldLeft;if(t.height>t.maxHeight||t.height<t.minHeight)t.top=t.oldTop;t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),this.limitCanvas(!1,!0),t.left=Math.min(Math.max(t.left,t.minLeft),t.maxLeft),t.top=Math.min(Math.max(t.top,t.minTop),t.maxTop),t.oldLeft=t.left,t.oldTop=t.top,l(this.canvas,a({width:t.width,height:t.height},A({translateX:t.left,translateY:t.top}))),this.renderImage(),this.cropped&&this.limited&&this.limitCropBox(!0,!0),e&&this.output()},renderImage:function(e){var t=this.canvasData,n=this.imageData,r=void 0,i=void 0,s=void 0,i=void 0;n.rotate&&(i=O({width:t.width,height:t.height,degree:n.rotate,aspectRatio:n.aspectRatio},!0),s=i.width,i=i.height,r={width:s,height:i,left:(t.width-s)/2,top:(t.height-i)/2}),a(n,r||{width:t.width,height:t.height,left:0,top:0}),l(this.image,a({width:n.width,height:n.height},A(a({translateX:n.left,translateY:n.top},n)))),e&&this.output()},initCropBox:function(){var e=this.options,t=e.aspectRatio,e=Number(e.autoCropArea)||.8,n=this.canvasData,r={width:n.width,height:n.height};t&&(n.height*t>n.width?r.height=r.width/t:r.width=r.height*t),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*e),r.height=Math.max(r.minHeight,r.height*e),r.left=n.left+(n.width-r.width)/2,r.top=n.top+(n.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=a({},r)},limitCropBox:function(e,t){var n=this.options,r=n.aspectRatio,i=this.containerData,s=this.canvasData,o=this.cropBoxData,u=this.limited;if(e){var a=Number(n.minCropBoxWidth)||0,n=Number(n.minCropBoxHeight)||0,f=Math.min(i.width,u?s.width:i.width),l=Math.min(i.height,u?s.height:i.height),a=Math.min(a,i.width),n=Math.min(n,i.height);r&&(a&&n?n*r>a?n=a/r:a=n*r:a?n=a/r:n&&(a=n*r),l*r>f?l=f/r:f=l*r),o.minWidth=Math.min(a,f),o.minHeight=Math.min(n,l),o.maxWidth=f,o.maxHeight=l}t&&(u?(o.minLeft=Math.max(0,s.left),o.minTop=Math.max(0,s.top),o.maxLeft=Math.min(i.width,s.left+s.width)-o.width,o.maxTop=Math.min(i.height,s.top+s.height)-o.height):(o.minLeft=0,o.minTop=0,o.maxLeft=i.width-o.width,o.maxTop=i.height-o.height))},renderCropBox:function(){var e=this.options,t=this.containerData,n=this.cropBoxData;if(n.width>n.maxWidth||n.width<n.minWidth)n.left=n.oldLeft;if(n.height>n.maxHeight||n.height<n.minHeight)n.top=n.oldTop;n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCropBox(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,e.movable&&e.cropBoxMovable&&g(this.face,"action",n.width===t.width&&n.height===t.height?"move":"all"),l(this.cropBox,a({width:n.width,height:n.height},A({translateX:n.left,translateY:n.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),this.complete&&E(this.element,"crop",this.getData())}}),a(X.prototype,{initPreview:function(){var e=this.options.preview,t=document.createElement("img"),n=this.crossOrigin,r=n?this.crossOriginUrl:this.url;n&&(t.crossOrigin=n),t.src=r,this.viewBox.appendChild(t),this.image2=t,e&&(this.previews=e=e.querySelector?[e]:document.querySelectorAll(e),u(e,function(e){var t=document.createElement("img");g(e,"preview",{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),n&&(t.crossOrigin=n),t.src=r;for(t.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t)}))},resetPreview:function(){u(this.previews,function(e){var t=m(e,"preview");l(e,{width:t.width,height:t.height}),e.innerHTML=t.html,y(e,"preview")})},preview:function(){var e=this.imageData,t=this.canvasData,n=this.cropBoxData,r=n.width,i=n.height,s=e.width,o=e.height,f=n.left-t.left-e.left,c=n.top-t.top-e.top;this.cropped&&!this.disabled&&(l(this.image2,a({width:s,height:o},A(a({translateX:-f,translateY:-c},e)))),u(this.previews,function(t){var n=m(t,"preview"),u=n.width,n=n.height,h=u,p=n,d=1;r&&(d=u/r,p=i*d),i&&p>n&&(d=n/i,h=r*d,p=n),l(t,{width:h,height:p}),l(t.getElementsByTagName("img")[0],a({width:s*d,height:o*d},A(a({translateX:-f*d,translateY:-c*d},e))))}))}}),a(X.prototype,{bind:function(){var e=this.options,t=this.element,n=this.cropper;i(e.cropstart)&&w(t,"cropstart",e.cropstart),i(e.cropmove)&&w(t,"cropmove",e.cropmove),i(e.cropend)&&w(t,"cropend",e.cropend),i(e.crop)&&w(t,"crop",e.crop),i(e.zoom)&&w(t,"zoom",e.zoom),w(n,G,this.onCropStart=f(this.cropStart,this)),e.zoomable&&e.zoomOnWheel&&w(n,"wheel mousewheel DOMMouseScroll",this.onWheel=f(this.wheel,this)),e.toggleDragModeOnDblclick&&w(n,"dblclick",this.onDblclick=f(this.dblclick,this)),w(document,Y,this.onCropMove=f(this.cropMove,this)),w(document,Z,this.onCropEnd=f(this.cropEnd,this)),e.responsive&&w(window,"resize",this.onResize=f(this.resize,this))},unbind:function(){var e=this.options,t=this.element,n=this.cropper;i(e.cropstart)&&b(t,"cropstart",e.cropstart),i(e.cropmove)&&b(t,"cropmove",e.cropmove),i(e.cropend)&&b(t,"cropend",e.cropend),i(e.crop)&&b(t,"crop",e.crop),i(e.zoom)&&b(t,"zoom",e.zoom),b(n,G,this.onCropStart),e.zoomable&&e.zoomOnWheel&&b(n,"wheel mousewheel DOMMouseScroll",this.onWheel),e.toggleDragModeOnDblclick&&b(n,"dblclick",this.onDblclick),b(document,Y,this.onCropMove),b(document,Z,this.onCropEnd),e.responsive&&b(window,"resize",this.onResize)}}),a(X.prototype,{resize:function(){var e=this.options,t=this.container,n=this.containerData,r=Number(e.minContainerWidth)||200,i=Number(e.minContainerHeight)||100;if(!this.disabled&&n.width!==r&&n.height!==i){var s=t.offsetWidth/n.width;if(1!==s||t.offsetHeight!==n.height){var o=void 0,a=void 0;e.restore&&(o=this.getCanvasData(),a=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(u(o,function(e,t){o[t]=e*s})),this.setCropBoxData(u(a,function(e,t){a[t]=e*s})))}}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(c(this.dragBox,"cropper-crop")?"move":"crop")},wheel:function(e){var t=this;e=S(e);var n=Number(t.options.wheelZoomRatio)||.1,r=1;t.disabled||(e.preventDefault(),t.wheeling||(t.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?r=0<e.deltaY?1:-1:e.wheelDelta?r=-e.wheelDelta/120:e.detail&&(r=0<e.detail?1:-1),t.zoom(-r*n,e)))},cropStart:function(e){if(!this.disabled){var t=this.options,n=this.pointers;e=S(e);var r=void 0;e.changedTouches?u(e.changedTouches,function(e){n[e.identifier]=D(e)}):n[e.pointerId||0]=D(e),r=1<Object.keys(n).length&&t.zoomable&&t.zoomOnTouch?"zoom":m(e.target,"action"),et.test(r)&&!1!==E(this.element,"cropstart",{originalEvent:e,action:r})&&(e.preventDefault(),this.action=r,this.cropping=!1,"crop"===r&&(this.cropping=!0,h(this.dragBox,"cropper-modal")))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var n=this.pointers;e=S(e),e.preventDefault(),!1!==E(this.element,"cropmove",{originalEvent:e,action:t})&&(e.changedTouches?u(e.changedTouches,function(e){a(n[e.identifier],D(e,!0))}):a(n[e.pointerId||0],D(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,n=this.pointers;e=S(e),e.changedTouches?u(e.changedTouches,function(e){delete n[e.identifier]}):delete n[e.pointerId||0],t&&(e.preventDefault(),Object.keys(n).length||(this.action=""),this.cropping&&(this.cropping=!1,d(this.dragBox,"cropper-modal",this.cropped&&this.options.modal)),E(this.element,"cropend",{originalEvent:e,action:t}))}}}),a(X.prototype,{change:function(e){var t=this.containerData,n=this.canvasData,r=this.cropBoxData,i=this.options.aspectRatio,s=this.action,o=r.width,a=r.height,f=r.left,l=r.top,c=f+o,h=l+a,d=0,v=0,m=t.width,g=t.height,y=!0,b=void 0;!i&&e.shiftKey&&(i=o&&a?o/a:1),this.limited&&(d=r.minLeft,v=r.minTop,m=d+Math.min(t.width,n.width,n.left+n.width),g=v+Math.min(t.height,n.height,n.top+n.height));var t=this.pointers,n=t[Object.keys(t)[0]],w=n.endX-n.startX,E=n.endY-n.startY;switch(s){case"all":f+=w,l+=E;break;case"e":if(0<=w&&(c>=m||i&&(l<=v||h>=g))){y=!1;break}c+w>m&&(w=m-c),o+=w,i&&(a=o/i,l-=w/i/2),0>o&&(s="w",o=0);break;case"n":if(0>=E&&(l<=v||i&&(f<=d||c>=m))){y=!1;break}l+E<v&&(E=v-l),a-=E,l+=E,i&&(o=a*i,f+=E*i/2),0>a&&(s="s",a=0);break;case"w":if(0>=w&&(f<=d||i&&(l<=v||h>=g))){y=!1;break}f+w<d&&(w=d-f),o-=w,f+=w,i&&(a=o/i,l+=w/i/2),0>o&&(s="e",o=0);break;case"s":if(0<=E&&(h>=g||i&&(f<=d||c>=m))){y=!1;break}h+E>g&&(E=g-h),a+=E,i&&(o=a*i,f-=E*i/2),0>a&&(s="n",a=0);break;case"ne":if(i){if(0>=E&&(l<=v||c>=m)){y=!1;break}a-=E,l+=E,o=a*i}else 0<=w?c<m?o+=w:0>=E&&l<=v&&(y=!1):o+=w,0>=E?l>v&&(a-=E,l+=E):(a-=E,l+=E);0>o&&0>a?(s="sw",o=a=0):0>o?(s="nw",o=0):0>a&&(s="se",a=0);break;case"nw":if(i){if(0>=E&&(l<=v||f<=d)){y=!1;break}a-=E,l+=E,o=a*i,f+=E*i}else 0>=w?f>d?(o-=w,f+=w):0>=E&&l<=v&&(y=!1):(o-=w,f+=w),0>=E?l>v&&(a-=E,l+=E):(a-=E,l+=E);0>o&&0>a?(s="se",o=a=0):0>o?(s="ne",o=0):0>a&&(s="sw",a=0);break;case"sw":if(i){if(0>=w&&(f<=d||h>=g)){y=!1;break}o-=w,f+=w,a=o/i}else 0>=w?f>d?(o-=w,f+=w):0<=E&&h>=g&&(y=!1):(o-=w,f+=w),0<=E?h<g&&(a+=E):a+=E;0>o&&0>a?(s="ne",o=a=0):0>o?(s="se",o=0):0>a&&(s="nw",a=0);break;case"se":if(i){if(0<=w&&(c>=m||h>=g)){y=!1;break}o+=w,a=o/i}else 0<=w?c<m?o+=w:0<=E&&h>=g&&(y=!1):o+=w,0<=E?h<g&&(a+=E):a+=E;0>o&&0>a?(s="nw",o=a=0):0>o?(s="sw",o=0):0>a&&(s="ne",a=0);break;case"move":this.move(w,E),y=!1;break;case"zoom":this.zoom(P(t),e),y=!1;break;case"crop":if(!w||!E){y=!1;break}b=x(this.cropper),f=n.startX-b.left,l=n.startY-b.top,o=r.minWidth,a=r.minHeight,0<w?s=0<E?"se":"ne":0>w&&(f-=o,s=0<E?"sw":"nw"),0>E&&(l-=a),this.cropped||(p(this.cropBox,"cropper-hidden"),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}y&&(r.width=parseInt(o,10),r.height=parseInt(a,10),r.left=f,r.top=l,this.action=s,this.renderCropBox()),u(t,function(e){e.startX=e.endX,e.startY=e.endY})}}),a(X.prototype,{crop:function(){return this.ready&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&h(this.dragBox,"cropper-modal"),p(this.cropBox,"cropper-hidden")),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=a({},this.initialImageData),this.canvasData=a({},this.initialCanvasData),this.cropBoxData=a({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(a(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),p(this.dragBox,"cropper-modal"),h(this.cropBox,"cropper-hidden")),this},replace:function(e,t){return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.image2.src=e,u(this.previews,function(t){t.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.load(e))),this},enable:function(){return this.ready&&(this.disabled=!1,p(this.cropper,"cropper-disabled")),this},disable:function(){return this.ready&&(this.disabled=!0,h(this.cropper,"cropper-disabled")),this},destroy:function(){var e=this.element,t=this.image;return this.loaded?(this.isImg&&this.replaced&&(e.src=this.originalUrl),this.unbuild(),p(e,"cropper-hidden")):this.isImg?b(e,"load",this.onStart):t&&N(t),y(e,"cropper"),this},move:function(e,n){var r=this.canvasData;return this.moveTo(t(e)?e:r.left+Number(e),t(n)?n:r.top+Number(n))},moveTo:function(n,r){var i=this.canvasData,s=!1;return t(r)&&(r=n),n=Number(n),r=Number(r),this.ready&&!this.disabled&&this.options.movable&&(e(n)&&(i.left=n,s=!0),e(r)&&(i.top=r,s=!0),s&&this.renderCanvas(!0)),this},zoom:function(e,t){var n=this.canvasData;return e=Number(e),this.zoomTo(n.width*(0>e?1/(1-e):1+e)/n.naturalWidth,t)},zoomTo:function(e,t){var n=this.options,r=this.canvasData,i=r.width,s=r.height,o=r.naturalWidth,u=r.naturalHeight;e=Number(e);if(0<=e&&this.ready&&!this.disabled&&n.zoomable){n=o*e,u*=e;if(!1===E(this.element,"zoom",{originalEvent:t,oldRatio:i/o,ratio:n/o}))return this;if(t){var a=this.pointers,o=x(this.cropper),a=a&&Object.keys(a).length?B(a):{pageX:t.pageX,pageY:t.pageY};r.left-=(a.pageX-o.left-r.left)/i*(n-i),r.top-=(a.pageY-o.top-r.top)/s*(u-s)}else r.left-=(n-i)/2,r.top-=(u-s)/2;r.width=n,r.height=u,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(t){return t=Number(t),e(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.rotated=!0,this.renderCanvas(!0)),this},scale:function(n,r){var i=this.imageData,s=!1;return t(r)&&(r=n),n=Number(n),r=Number(r),this.ready&&!this.disabled&&this.options.scalable&&(e(n)&&(i.scaleX=n,s=!0),e(r)&&(i.scaleY=r,s=!0),s&&this.renderImage(!0)),this},scaleX:function(t){var n=this.imageData.scaleY;return this.scale(t,e(n)?n:1)},scaleY:function(t){var n=this.imageData.scaleX;return this.scale(e(n)?n:1,t)},getData:function(e){var t=this.options,n=this.imageData,r=this.canvasData,i=this.cropBoxData,s=void 0,o=void 0;return this.ready&&this.cropped?(o={x:i.left-r.left,y:i.top-r.top,width:i.width,height:i.height},s=n.width/n.naturalWidth,u(o,function(t,n){t/=s,o[n]=e?Math.round(t):t})):o={x:0,y:0,width:0,height:0},t.rotatable&&(o.rotate=n.rotate||0),t.scalable&&(o.scaleX=n.scaleX||1,o.scaleY=n.scaleY||1),o},setData:function(t){var n=this.options,s=this.imageData,o=this.canvasData,u={},a=void 0,f=void 0,l=void 0;return i(t)&&(t=t.call(this.element)),this.ready&&!this.disabled&&r(t)&&(n.rotatable&&e(t.rotate)&&t.rotate!==s.rotate&&(s.rotate=t.rotate,this.rotated=a=!0),n.scalable&&(e(t.scaleX)&&t.scaleX!==s.scaleX&&(s.scaleX=t.scaleX,f=!0),e(t.scaleY)&&t.scaleY!==s.scaleY&&(s.scaleY=t.scaleY,f=!0)),a?this.renderCanvas():f&&this.renderImage(),l=s.width/s.naturalWidth,e(t.x)&&(u.left=t.x*l+o.left),e(t.y)&&(u.top=t.y*l+o.top),e(t.width)&&(u.width=t.width*l),e(t.height)&&(u.height=t.height*l),this.setCropBoxData(u)),this},getContainerData:function(){return this.ready?this.containerData:{}},getImageData:function(){return this.loaded?this.imageData:{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&u("left top width height naturalWidth naturalHeight".split(" "),function(n){t[n]=e[n]}),t},setCanvasData:function(t){var n=this.canvasData,s=n.aspectRatio;return i(t)&&(t=t.call(this.element)),this.ready&&!this.disabled&&r(t)&&(e(t.left)&&(n.left=t.left),e(t.top)&&(n.top=t.top),e(t.width)?(n.width=t.width,n.height=t.width/s):e(t.height)&&(n.height=t.height,n.width=t.height*s),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t=void 0;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var n=this.cropBoxData,s=this.options.aspectRatio,o=void 0,u=void 0;return i(t)&&(t=t.call(this.element)),this.ready&&this.cropped&&!this.disabled&&r(t)&&(e(t.left)&&(n.left=t.left),e(t.top)&&(n.top=t.top),e(t.width)&&t.width!==n.width&&(o=!0,n.width=t.width),e(t.height)&&t.height!==n.height&&(u=!0,n.height=t.height),s&&(o?n.height=parseInt(n.width/s,10):u&&(n.width=parseInt(n.height*s,10))),this.renderCropBox()),this},getCroppedCanvas:function(e){if(!this.ready||!window.HTMLCanvasElement)return null;r(e)||(e={});if(!this.cropped)return M(this.image,this.imageData,e);var t=this.getData(),n=t.width,i=t.height,s=n/i,o=void 0,u=void 0,a=void 0;r(e)&&(o=e.width,u=e.height,o?(u=o/s,a=o/n):u&&(o=u*s,a=u/i));var o=Math.floor(o||n),f=Math.floor(u||i),u=document.createElement("canvas"),s=u.getContext("2d");u.width=o,u.height=f,e.fillColor&&(s.fillStyle=e.fillColor,s.fillRect(0,0,o,f));var l=M(this.image,this.imageData,e),o=l.width,f=l.height,c=this.canvasData,l=[l],h=t.x+c.naturalWidth*(Math.abs(t.scaleX||1)-1)/2,t=t.y+c.naturalHeight*(Math.abs(t.scaleY||1)-1)/2,p=c=void 0,d=void 0,v=void 0,m=void 0,g=void 0;return h<=-n||h>o?m=d=c=h=0:0>=h?(d=-h,h=0,m=c=Math.min(o,n+h)):h<=o&&(d=0,m=c=Math.min(n,o-h)),0>=c||t<=-i||t>f?g=v=p=t=0:0>=t?(v=-t,t=0,g=p=Math.min(f,i+t)):t<=f&&(v=0,g=p=Math.min(i,f-t)),l.push(Math.floor(h),Math.floor(t),Math.floor(c),Math.floor(p)),a&&(d*=a,v*=a,m*=a,g*=a),0<m&&0<g&&l.push(Math.floor(d),Math.floor(v),Math.floor(m),Math.floor(g)),s.imageSmoothingEnabled=!!e.imageSmoothingEnabled,e.imageSmoothingQuality&&(s.imageSmoothingQuality=e.imageSmoothingQuality),s.drawImage.apply(s,H(l)),u},setAspectRatio:function(e){var n=this.options;return this.disabled||t(e)||(n.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,n=this.dragBox,r=this.face,i=void 0,s=void 0;return this.loaded&&!this.disabled&&(i="crop"===e,s=t.movable&&"move"===e,e=i||s?e:"none",g(n,"action",e),d(n,"cropper-crop",i),d(n,"cropper-move",s),t.cropBoxMovable||(g(r,"action",e),d(r,"cropper-crop",i),d(r,"cropper-move",s))),this}}),"undefined"!=typeof window&&(it=window.Cropper,window.Cropper=X),X});var KMINIPHOTOTOP=parent;setMiniPhotoWindow(),setMiniPhotoDocument(),KMINIPHOTOTOP.KMINIPHOTO=parent.KMINIPHOTO,parent.KMINIPHOTOTOP=KMINIPHOTOTOP,KMINIPHOTOTOP.KMINIPHOTO.util.overrideFn(window),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){t=t||0;for(var n=this.length;t<n;){if(this[t]===e)return t;++t}return-1}),String.prototype.insertAt||(String.prototype.insertAt=function(e,t){return this.substr(0,e)+t+this.substr(e)}),String.prototype.replaceAt||(String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)}),K_MiniPhoto.prototype={init:function(e){KMINIPHOTOTOP.KMINIPHOTO.util._setKMiniPhoto(e)},reset:function(e){KMINIPHOTOTOP.KMINIPHOTO.util._setKMiniPhoto(e)},start:function(e,t){var n=t._config;getDialogDocument();var r=parseInt(n.height);-1<n.height.indexOf("%")&&(r=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(KMINIPHOTOTOP.KMINIPHOTODOC.getElementById("kminiphoto_holder_"+t.ID)),r=r.bottom-r.top);var i=parseInt(n.width);-1<n.width.indexOf("%")&&(i=KMINIPHOTOTOP.KMINIPHOTO.util.getClientRect(KMINIPHOTOTOP.KMINIPHOTODOC.getElementById("kminiphoto_holder_"+t.ID)),i=i.right-i.left),getAreaSize(r,n,t),n=""+('<div id="miniPhoto_holder" class="wrap" style="width: '+(i-2)+'px;">')+'<div id="miniPhoto_header" class="header">',n+="<h3></h3>",n+='<div class="btn-right">',n+='<a id="btn_fullscreen" href="javascript:;" class="K_mini_photo_maximization" title="'+KMiniPhoto_Lang.fullScreen+'"><span class="blind"></span></a><a href="javascript:;" class="K_mini_photo_close" title="'+KMiniPhoto_Lang.close+'"><span class="blind"></span></a>',n+="</div>",n+="</div>",n+='<div class="toolbar">',n+='<input id="open_file" type="file" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff,.tif" style="display:none;"/>',n+='<a id="btn_open" href="javascript:;" class="btn-function"><span class="img-open"></span><em>'+KMiniPhoto_Lang.open+"</em></a>",n+='<i class="vertical"></i>',n+='<a id="btn_undo" href="javascript:;" class="btn-do" title="'+KMiniPhoto_Lang.undo+'"><i class="undo deact-u"></i><p class="blind"></p></a>',n+='<a id="btn_redo" href="javascript:;" class="btn-do" title="'+KMiniPhoto_Lang.redo+'"><i class="redo deact-r"></i><p class="blind"></p></a>',n+='<i class="vertical"></i>',n+='<a id="btn_crop" href="javascript:;" class="btn-function"><span class="img-crop"></span><em>'+KMiniPhoto_Lang.crop+"</em></a>",n+='<ul id="crop_tools_area" class="off">',n+='<li class="" title="Free"><a id="crop_ratio_0" href="javascript:;"><span class="img-ratio-free"></span><em>Free</em></a></li>',n+='<li class="" title="4:3"><a id="crop_ratio_1" href="javascript:;"><span class="img-ratio-4-3"></span><em>4:3</em></a></li>',n+='<li class="" title="16:9"><a id="crop_ratio_2" href="javascript:;"><span class="img-ratio-16-9"></span><em>16:9</em></a></li>',n+='<li class="" title="1:1"><a id="crop_ratio_3" href="javascript:;"><span class="img-ratio-1-1"></span><em>1:1</em></a></li>',n+='<li class="" title="2:3"><a id="crop_ratio_4" href="javascript:;"><span class="img-ratio-2-3"></span><em>2:3</em></a></li>',n+='<li class="" title="3:4"><a id="crop_ratio_5" href="javascript:;"><span class="img-ratio-3-4"></span><em>3:4</em></a></li>',n+='<li class="btnForCrop"><a id="crop_ok" href="javascript:;"><span class="btn-apply" title="'+KMiniPhoto_Lang.cropOk+'"></span><p class="blind"></p></a></li>',n+='<li class="btnForCrop"><a id="crop_cancel" href="javascript:;"><span class="btn-cancel" title="'+KMiniPhoto_Lang.cropCancel+'"></span><p class="blind"></p></a></li>',n+="</ul>",n+='<a id="img_rotate_l" href="javascript:;" class="btn-function" title="'+KMiniPhoto_Lang.rotate_l_detail+'"><span class="img-rotationL"></span><em>'+KMiniPhoto_Lang.rotate_l+"</em></a>",n+='<a id="img_rotate_r" href="javascript:;" class="btn-function" title="'+KMiniPhoto_Lang.rotate_r_detail+'"><span class="img-rotationR"></span><em>'+KMiniPhoto_Lang.rotate_r+"</em></a>",n+='<a id="img_flip_h" href="javascript:;" class="btn-function" title="'+KMiniPhoto_Lang.flip_x_detail+'"><span class="img-flipV"></span><em>'+KMiniPhoto_Lang.flip_x+"</em></a>",n+='<a id="img_flip_v" href="javascript:;" class="btn-function" title="'+KMiniPhoto_Lang.flip_y_detail+'"><span class="img-flipH"></span><em>'+KMiniPhoto_Lang.flip_y+"</em></a>",n+='<div class="buttonArea">',n+='<a id="btn_apply" href="javascript:;" class="btnApply" title="'+KMiniPhoto_Lang.apply+'"><span>'+KMiniPhoto_Lang.apply+'</span></a><a id="btn_reset" href="javascript:;" class="btnCancel" title="'+KMiniPhoto_Lang.reset+'"><span>'+KMiniPhoto_Lang.reset+"</span></a>",n+="</div>",n+="</div>",n+="<table>",n+="<tbody>",n+='<tr class="imageArea"><td><span id="span_processing" class="RAONK_photo_loading_img" style="display:none;">Processing...</span><div id="miniPhoto_image" style="height:'+t.areaSize.imageAreaHeight+'px; border:0; overflow:auto;"><div style="position:relative; background-image:url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC\')"></div></div></td></tr>',n+='<tr class="sizeArea">',n+="<td>",n+='<div class="t-l" style="display:none;">',n+="<span>"+KMiniPhoto_Lang.current_size+"</span>",n+='<em id="crop_box_size">0 x 0 px</em>',n+="</div>",n+='<div class="t-r">',n+='<span class="hhh">'+KMiniPhoto_Lang.original_size+"</span>",n+='<em id="original_size">0 x 0 px</em>',n+="</div>",n+="</td>",n+="</tr>",n+="</tbody>",n+="</table>",n+="</div>",n+="</div>",document.body.style.overflow="hidden",document.body.innerHTML=n,setPage(t)},_raonkCommands:function(e,t,n,r){G_LAST_CMD=t},_setLazyLoadFrame:function(e){"0"==KMINIPHOTOTOP.G_CURRKMINIPHOTO._config.hideContextMenu&&KMINIPHOTO_CONTEXT._create(e)}};var G_originScrollSize,G_originPhotoSize=[],G_originfull={},G_origianPopupPos=[],G_relativePos,G_isRelativePos,G_drag=!1,G_dragPopup,G_HISTORY={redo_list:[],undo_list:[],saveState:function(e,t,n,r){n||(this.redo_list=[]),r?(t||this.undo_list).push(r.src):(e=e.toDataURL("image/"+KMINIPHOTOTOP.G_CURRKMINIPHOTO.initImgExt,1),(t||this.undo_list).push(e)),this.displayBtn()},undo:function(e,t){this.restoreState(e,t,this.undo_list,this.redo_list)},redo:function(e,t){this.restoreState(e,t,this.redo_list,this.undo_list)},restoreState:function(e,t,n,r){var i=this;n.length&&(displayProcessing(!0),setTimeout(function(){i.saveState(e,r,!0);var t=n.pop(),s=new Image;s.onload=function(){document.getElementById("miniPhoto_image");var t=e.getContext("2d");t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),KMINIPHOTOTOP.G_CURRKMINIPHOTO.currDegree=0,KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipX=!1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.flipY=!1,KMINIPHOTOTOP.G_CURRKMINIPHOTO.currImage=s,e.width=s.naturalWidth,e.height=s.naturalHeight,e.parentNode.style.width=s.naturalWidth+"px",e.parentNode.style.height=s.naturalHeight+"px",t.drawImage(s,0,0),s.style.display="none",setCanvasPostionCenter(),displayProcessing(!1);try{s=void 0}catch(n){}},s.src=t,i.displayBtn()},50))},reset:function(){this.redo_list=[],this.undo_list=[],this.displayBtn()},displayBtn:function(){document.getElementById("btn_redo").firstChild.className=0<this.redo_list.length?"redo":"redo deact-r",document.getElementById("btn_undo").firstChild.className=0<this.undo_list.length?"undo":"undo deact-u"}};