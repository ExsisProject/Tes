function dext_setting(){var e=document.getElementById("grid_color").style.backgroundColor,t=document.getElementById("grid_color_name").innerHTML,n=document.getElementById("lang").value,r=document.getElementById("grid_spans").value,i=document.getElementsByName("grid_form")[0].checked?"line":"dot",s=document.getElementById("page_title").value,o=document.getElementById("encoding").value,u=document.getElementById("doctype").value,a=document.getElementById("xhtml").checked?document.getElementById("xhtml").value:"",f=document.getElementById("auto_list").value,l=document.getElementById("check_auto_save").checked,c=document.getElementById("input_auto_save").value,c="none"!=document.getElementById("div_auto_save").style.display?l?""!=c&&"0"!=c?"1,"+document.getElementById("input_auto_save").value:"2":"2":"0",l=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==l||-1<l.indexOf("setting_title"))if(l=LayerWin._dext_editor._config.accessibility,"1"==l)""==s&&alert(LayerWin.dext5_lang.msg.alert_page_title_access1);else if("2"==l&&""==s){alert(LayerWin.dext5_lang.msg.alert_page_title_access2),document.getElementById("page_title").focus();return}var l=document.getElementById("check_ruler").checked,h=document.getElementById("ruler_px").value;if(""!=h&&"0"!=h)"2"==LayerWin._dext_editor._config.ruler.mode?LayerWin._dext_editor.isInitBodyAutoFit=!0:(h=h.split(","),h=h.sort(function(e,t){return e-t}),h=h.join(","));else if(l){alert(LayerWin.dext5_lang.msg.alert_ruler_position),document.getElementById("ruler_px").focus();return}var l=l?"1":"0",p="",d="",v="",p="1"==LayerWin._dext_editor._config.personalSettingUseFontFamilyKeyin?""==document.getElementById("personal_font_family").value?document.getElementById("personal_font_family").value:LayerWin.getRealNameThroughDisplayName(document.getElementById("font_family_keyin").value):document.getElementById("personal_font_family").value,d="1"==LayerWin._dext_editor._config.personalSettingUseFontSizeKeyin?""==document.getElementById("personal_font_size").value?document.getElementById("personal_font_size").value:document.getElementById("font_size_keyin").value:document.getElementById("personal_font_size").value,v="1"==LayerWin._dext_editor._config.personalSettingUseLineHeightKeyin?""==document.getElementById("personal_line_height").value?document.getElementById("personal_line_height").value:document.getElementById("line_height_keyin").value:document.getElementById("personal_line_height").value,m=document.getElementById("word_break").value,g=document.getElementById("word_wrap").value,y=document.getElementById("check_apply_word_break_for_table").checked,b=document.getElementById("personal_paste_to_image").value,w=document.getElementById("personal_paste_to_image_popupMode").value;dext_json={grid_color:e,grid_color_nm:t,grid_spans:r,grid_form:i,page_title:s,encoding:o,lang:n,doctype:u,xhtml:a,auto_save:c,ruler:l,ruler_px:h,auto_list:f,personal_font_family:p,personal_font_size:d,personal_line_height:v,word_break_type:m,word_wrap_type:g,word_break_for_all_table:y,personal_paste_to_image:b,personal_paste_to_image_popupMode:w},LayerWin.event_dext_setting(dext_json,window.frameElement.parentNode.parentNode)}function dext_horizontal_line(e,t){var n;if(!e){n=document.getElementById("width_1").value;var r=document.getElementById("height").value,i=document.getElementById("align").value,s=document.getElementById("hr_color").style.borderTopColor;n={width:n,height:r,align:i,color:s}}LayerWin.event_dext_horizontal_line(n,e,t,window.frameElement.parentNode.parentNode)}function loading_image_show(e){var t=document.getElementById("dext_loading"),n="";0==e?(n="none",document.body.style.cursor="default"):document.body.style.cursor="wait",t&&(t.style.display=n),"1"==LayerWin._dext_editor._config.uploadUseHTML5&&e&&t&&t.childNodes&&(t.childNodes[1].nodeValue=" Uploading... ")}function web_url_remove_char(e){return e=DEXTTOP.DEXT5.util.trim(e),e=e.replace(/(\r\n|\r|\n)/gm,""),e=e.replace(/&#13;/g,""),e=e.replace(/&#10;/g,""),e=e.replace(/&#32;/g,"")}function dext_upload_image(){var e=document.dext_upload_form,t;t=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var n=document.getElementById("img_web_url"),r=document.getElementById("link_url"),i=LayerWin.getElementsByClass("EdiTor_Popup_contents",document),s=/^\s\s*$/;if(!s.exec(r.value)&&""!=r.value){var s=new RegExp(/^(http|ftp|https|news)/),o=s.test(r.value);if("http://"==r.value)r.value="";else if(o&&!DEXTTOP.DEXT5.util.checkUrl(r.value)){alert(LayerWin.dext5_lang.msg.alert_url),i[0].className="EdiTor_Popup_contents none",i[1].className="EdiTor_Popup_contents view",LayerWin.lastFocus(r);return}}if(document.getElementsByName("InputFlag")[0].checked)if(r=t.value,0<r.lastIndexOf(".")){n=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==n||-1<n.indexOf("img_alt"))if(n=LayerWin._dext_editor._config.accessibility,i=document.getElementById("img_alt").value,"1"==n)""==i&&alert(LayerWin.dext5_lang.msg.alert_image_alt_access1);else if("2"==n&&""==i){alert(LayerWin.dext5_lang.msg.alert_image_alt_access2),document.getElementById("img_alt").focus();return}for(var n=r.substring(r.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(n==s[a]){i=!0;break}if("base64"==LayerWin._dext_editor._config.uploadMethod){t="1"==LayerWin._dext_editor._config.uploadUseHTML5?G_dragDropFileObj[0]:t.files[0];var f=new FileReader;f.onload=function(){var e=f.result,t=new Image;t.onload=function(){e+="?"+t.width+"^"+t.height,event_dext_image_upload_completed(e)},t.src=e,f=void 0},f.readAsDataURL(t)}else 1==i?(i=LayerWin._dext_editor._config.image_convert_width,s=LayerWin._dext_editor._config.image_convert_height,"1"==LayerWin._dext_editor._config.imageAutoConvert&&(s=i="0"),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(i),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(s),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r.substring(r.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=n,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=i,document.getElementById("image_convert_height").value=s,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=r.substring(r.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(e=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&e.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),e.setItem("document_domain",document.getElementById("document_domain").value),e.setItem("proxy_url",document.getElementById("proxy_url").value),e.setItem("uploadtype",document.getElementById("uploadtype").value),e.setItem("savefilename",document.getElementById("savefilename").value),e.setItem("savefileext",document.getElementById("savefileext").value),e.setItem("serverdomain",document.getElementById("serverdomain").value),e.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),e.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),e.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),e.setItem("image_convert_format",document.getElementById("image_convert_format").value),e.setItem("image_convert_width",document.getElementById("image_convert_width").value),e.setItem("image_convert_height",document.getElementById("image_convert_height").value),e.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&e.setItem("originalfilename",document.getElementById("originalfilename").value),addParamHashTable(e),e.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.id,fileObj:G_dragDropFileObj,formData:e},event_dext_image_upload_completed)):(e.action=document.getElementById("upload_url").value,e.submit())):alert(o)}else""==r?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else r=n.value,s=new RegExp(/^(http|ftp|https|news)/),o=s.test(r),s=/^\s\s*$/,""==r||s.exec(r)||o&&!DEXTTOP.DEXT5.util.checkUrl(r)?(alert(LayerWin.dext5_lang.msg.alert_url),n.focus()):event_dext_image_upload_completed(r)}function event_dext_image_link(){var e=document.getElementById("img_web_url").value,t=document.getElementById("img_width").value,n=document.getElementById("img_height").value,r=document.getElementById("img_alt").value,i=document.getElementById("img_title").value,s=document.getElementById("img_v_space").value,o=document.getElementById("img_h_space").value,u=document.getElementById("img_align"),u=u.options[u.selectedIndex].value,a="";document.getElementById("img_border")&&(a=document.getElementById("img_border").value);var f=document.getElementById("link_url").value,l=document.getElementById("link_title").value,c=document.getElementById("link_target").value;LayerWin.event_dext_image_upload("","","","0",e,0,0,r,"",{srcURL:e,width:t,height:n,title:i,alt:r,vspace:s,hspace:o,align:u,border:a,linkurl:f,linktitle:l,linktarget:c},window.frameElement.parentNode.parentNode)}function event_dext_image_upload_completed(e,t){e&&(e=e.replace(/<.*?script.*\/?>/g,""));var n=!1;document.getElementsByName("InputFlag")[1]&&(n=document.getElementsByName("InputFlag")[1].checked),"base64"!=LayerWin._dext_editor._config.uploadMethod&&e&&(e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));if("CCODE_001"==LayerWin._dext_editor._config.custom_code){var r=e=web_url_remove_char(e),i=document.getElementById("img_alt").value,s=document.getElementById("img_title").value,o=document.getElementById("img_id").value,u=document.getElementById("img_class").value,a=document.getElementById("img_v_space").value,f=document.getElementById("img_h_space").value,l=document.getElementById("img_align"),l=l.options[l.selectedIndex].value,c="";document.getElementById("img_border")&&(c=document.getElementById("img_border").value);var h=document.getElementById("img_width").value,p=document.getElementById("img_height").value,d=document.getElementById("link_url").value,v=document.getElementById("link_title").value,m=document.getElementById("link_target").value,g="",y="",b="",w="";document.getElementById("line_style")&&(g=document.getElementById("line_style").style.borderTop,"none"!=g&&(y=document.getElementById("line_kind").value,b=document.getElementById("line_color").style.borderTopColor,w=document.getElementById("line_thickness").value)),n={srcURL:e,width:h,height:p,title:s,id:o,className:u,alt:i,vspace:a,hspace:f,align:l,border:c,linkurl:d,linktitle:v,linktarget:m,continueInsert:D,input_url_checked:n,borderStyle:g,borderKind:y,borderColor:b,borderThickness:w}}else{h=document.getElementById("img_width").value,p=document.getElementById("img_height").value;if(!n){var E=0,S=0;if(null!=e&&void 0!=e){try{r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=r&&void 0!=r&&(e=r)}catch(x){}a=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(a=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<a.length&&(e=a[0]));var T=e.split("?");2==T.length?(e=T[0],T=T[1].split("^"),2==T.length?(E=T[0],S=T[1]):3==T.length&&(E=T[0],S=T[1],e+="?"+T[2])):(""!=h&&(E=h),""!=p&&(S=p)),"1"==LayerWin._dext_editor._config.imageSizeToServer&&(0<E&&(h=E),0<S&&(p=S));if(elemModify&&"img"==elemModify.tagName.toLowerCase()){"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))?(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",n=e.indexOf("HTTP Error"),a=e.indexOf("HTTP Status"),-1<n?elemModify.setAttribute("alt",e.substring(n,errorIdx+16).replace(/"/g,"'")):-1<a&&elemModify.setAttribute("alt",e.substring(a,errorIdx+15).replace(/"/g,"'"))):"[FAIL]"==e.substring(0,6)?(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",elemModify.setAttribute("alt",e.substring(6,e.length).replace(/"/g,"'"))):elemModify.src=e,"function"==typeof G_UploadCompleteCallBackFn&&G_UploadCompleteCallBackFn();try{LayerWin.contentChangeEventWrapper()}catch(N){}return}T=!1,document.getElementById("original_size")&&(T=document.getElementById("original_size").checked);if(!T)if(T=LayerWin.getWidthForAutoBodyFit(LayerWin._dext_editor,"img"),"1"==LayerWin._dext_editor._config.imageAutoConvert){var T=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_width),C=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_height),i=r=!1,E=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(E),S=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(S);0!=T&&0==C?E>=T&&(r=!0):0==T&&0!=C?S>=C&&(i=!0):(D=1*T/E,s=1*C/S,D<s?1>D&&(r=!0):1>s&&(i=!0)),r?(r=T/E,E=T,S=DEXTTOP.DEXT5.util.parseIntOr0(r*S),h=E,p=S):i&&(r=C/S,S=C,h=E=DEXTTOP.DEXT5.util.parseIntOr0(r*E),p=S)}else"1"==LayerWin._dext_editor._config.image_auto_fit&&E>T?(r=T/E,E=T,S*=r,h>E&&(h=E,p=S)):"2"==LayerWin._dext_editor._config.image_auto_fit&&(E>T||S>LayerWin._dext_editor._defaultHeight)&&(h=LayerWin._dext_editor._defaultHeight,p=h/T,C=S/E,C>p?S>h?(p=h,h=Math.round(E*p/S)):(h=E,p=S):C<p?E>T?(h=T,p=Math.round(S*h/E)):(h=E,p=S):(h=E,p=S))}0==h.length&&0<E&&(h=parseInt(E),p=parseInt(S),S=E="",T=!1,document.getElementById("original_size")&&(T=document.getElementById("original_size").checked),T||(E=LayerWin._dext_editor._config.imgDefaultWidth,S=LayerWin._dext_editor._config.imgDefaultHeight),""!=E?DEXTTOP.DEXT5.util.parseIntOr0(h)>DEXTTOP.DEXT5.util.parseIntOr0(E)&&(h=DEXTTOP.DEXT5.util.parseIntOr0(p,10)*DEXTTOP.DEXT5.util.parseIntOr0(E,10)/DEXTTOP.DEXT5.util.parseIntOr0(h,10),p=isNaN(h)?p:Math.round(h),h=DEXTTOP.DEXT5.util.parseIntOr0(E)):""!=S&&DEXTTOP.DEXT5.util.parseIntOr0(p)>DEXTTOP.DEXT5.util.parseIntOr0(S)&&(p=DEXTTOP.DEXT5.util.parseIntOr0(h,10)*DEXTTOP.DEXT5.util.parseIntOr0(S,10)/DEXTTOP.DEXT5.util.parseIntOr0(p,10),h=isNaN(p)?h:Math.round(p),p=DEXTTOP.DEXT5.util.parseIntOr0(S))),loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response})))return}catch(k){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))){if(n=confirm(LayerWin.dext5_lang.msg.uploadFailed))n=e.indexOf("HTTP Error"),a=e.indexOf("HTTP Status"),-1<n?alert(e.substring(n,n+16)):-1<a&&alert(e.substring(a,a+15));return}if(!n&&"[FAIL]"==e.substring(0,6)&&"base64"!=LayerWin._dext_editor._config.uploadMethod){(n=confirm(LayerWin.dext5_lang.msg.uploadFailed))&&alert(e);return}e=web_url_remove_char(e)}var E=document.getElementById("savefilename").value,T=S="",C="0",r=e,i=document.getElementById("img_alt").value,s=document.getElementById("img_title").value,L=u=o="";try{o=document.getElementById("img_id").value,u=document.getElementById("img_class").value,L=document.getElementById("img_figure").checked}catch(A){}var f=document.getElementById("img_margin_left").value,O=document.getElementById("img_margin_right").value,M=document.getElementById("img_margin_top").value,_=document.getElementById("img_margin_bottom").value,f="-"==f?"":f,O="-"==O?"":O,M="-"==M?"":M,_="-"==_?"":_,l=document.getElementById("img_align"),l=l.options[l.selectedIndex].value,c="";document.getElementById("img_border")&&(c=document.getElementById("img_border").value);var D=!1;document.getElementById("continue_insert")&&(D=document.getElementById("continue_insert").checked),d=document.getElementById("link_url").value,v=document.getElementById("link_title").value,m=document.getElementById("link_target").value,w=b=y=g="",document.getElementById("line_style")&&(g=document.getElementById("line_style").style.borderTopStyle,"none"!=g&&(y=document.getElementById("line_kind").value,b=document.getElementById("line_color").style.borderTopColor,w=document.getElementById("line_thickness").value));var P=!1;document.getElementById("image_spacing")&&(P=document.getElementById("image_spacing").checked);var H="px",B="px",j=document.getElementById("img_width_unit"),F=document.getElementById("img_height_unit");j&&""!=j.value&&(H=j.value),F&&""!=F.value&&(B=F.value),n={srcURL:e,width:h,height:p,title:s,id:o,className:u,figure:L,alt:i,margin_left:f,margin_right:O,margin_top:M,margin_bottom:_,align:l,border:c,linkurl:d,linktitle:v,linktarget:m,continueInsert:D,input_url_checked:n,img_attr_info_arr:a,input_url_checked:n,borderStyle:g,borderKind:y,borderColor:b,borderThickness:w,imageSpacing:P,widthUnit:H,heightUnit:B},L=""+("<img style='width:"+h+"px; height:"+p+"px;"),0<M.length&&!isNaN(M)&&(L+=" margin-top:"+M+"px;"),0<O.length&&!isNaN(O)&&(L+=" margin-right:"+O+"px;"),0<_.length&&!isNaN(_)&&(L+=" margin-bottom:"+_+"px;"),0<f.length&&!isNaN(f)&&(L+=" margin-left:"+f+"px;"),L=L+" ' "+(" src='"+r+"'"),L+=" alt='"+i+"'",0<l.length&&(L+=" align='"+l+"'"),0<c.length&&!isNaN(c)&&(L+=" border='"+c+"'"),L+=" />"}LayerWin.event_dext_image_upload(E,S,T,C,r,h,p,i,L,n,window.frameElement.parentNode.parentNode)}function dext_upload_flash(){if(1==document.getElementById("cb_tag_insert").checked){var e=document.getElementById("ta_flash_tag").value,t=document.createElement("div");t.innerHTML=e,t=t.getElementsByTagName("EMBED")[0];if(null==t)alert(LayerWin.dext5_lang.flash.invalid_tag);else{var e=null,n=t.getAttribute("scale")?t.getAttribute("scale"):"",r=t.getAttribute("allowScriptAccess")?t.getAttribute("allowScriptAccess"):"",i=t.getAttribute("quality")?t.getAttribute("quality"):"",s=t.getAttribute("align")?t.getAttribute("align"):"",o,u,a,f;o=null==t.getAttribute("menu")||void 0==t.getAttribute("menu")?!0:0==t.getAttribute("menu")||"false"==t.getAttribute("menu")?!1:!0,u=null==t.getAttribute("play")||void 0==t.getAttribute("play")?!0:0==t.getAttribute("play")||"false"==t.getAttribute("play")?!1:!0,a=null==t.getAttribute("loop")||void 0==t.getAttribute("loop")?!0:0==t.getAttribute("loop")||"false"==t.getAttribute("loop")?!1:!0,null==t.getAttribute("allowFullScreen")||void 0==t.getAttribute("allowFullScreen")?f=!0:0==t.getAttribute("allowFullScreen")||"false"==t.getAttribute("allowFullScreen")?_allowFullScreenu=!1:f=!0;var l=t.getAttribute("flashvars")?t.getAttribute("flashvars"):"";"embed"==t.tagName.toLowerCase()&&(e={type:"flash",src:t.src,width:0==LayerWin.parseIntOr0(t.style.width)?LayerWin.parseIntOr0(t.width):LayerWin.parseIntOr0(t.style.width),height:0==LayerWin.parseIntOr0(t.style.height)?LayerWin.parseIntOr0(t.height):LayerWin.parseIntOr0(t.style.height),hspace:LayerWin.parseIntOr0(t.getAttribute("hspace")),vspace:LayerWin.parseIntOr0(t.getAttribute("vspace")),scale:n,allowScriptAccess:r,quality:i,align:s,menu:o,play:u,loop:a,allowFullScreen:f,flashvars:l},f=LayerWin.getLinkMediaType(e.src),0<f.length&&(e.type=f,e.type2="flash")),LayerWin.event_dext_media_upload("","","","","","",e,window.frameElement.parentNode.parentNode)}}else if(t=document.dext_upload_form,e="",e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),n=document.getElementById("web_url"),document.getElementsByName("InputFlag")[0].checked)if(f=e.value,0<f.lastIndexOf(".")){n=f.substring(f.lastIndexOf(".")+1).toLowerCase(),r=!1,i=LayerWin._dext_editor._config.allowFlashFileType,s=i.toString()+LayerWin.dext5_lang.msg.alert_exec_tail;for(o=0;o<i.length;o++)if(n==i[o]){r=!0;break}1==r?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(f.substring(f.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=n,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=f.substring(f.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(f=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&f.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),f.setItem("document_domain",document.getElementById("document_domain").value),f.setItem("proxy_url",document.getElementById("proxy_url").value),f.setItem("uploadtype",document.getElementById("uploadtype").value),f.setItem("savefilename",document.getElementById("savefilename").value),f.setItem("savefileext",document.getElementById("savefileext").value),f.setItem("serverdomain",document.getElementById("serverdomain").value),f.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),f.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),f.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),f.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&f.setItem("originalfilename",document.getElementById("originalfilename").value),f.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(f),uploadAjaxOnprogressStart({uploadType:"flash",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:f},event_dext_flash_upload_completed)):(t.action=document.getElementById("upload_url").value,t.submit())):alert(s)}else""==f?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else f=n.value,e=(new RegExp(/^(http|ftp|https|news)/)).test(f),t=/^\s\s*$/,""==f||t.exec(f)||e&&!DEXTTOP.DEXT5.util.checkUrl(f)?(alert(LayerWin.dext5_lang.msg.alert_url),n.focus()):event_dext_flash_upload_completed(f)}function dext_upload_flash_byFlash(){if(1==document.getElementById("cb_tag_insert").checked){var e=document.getElementById("ta_flash_tag").value;DEXTTOP.event_dext_media_upload("","","","","",e)}else{e=document.dext_upload_form,document.getElementById(file_field_id);var t=document.getElementById("web_url"),t=document.getElementsByName("InputFlag")[0].checked?"dext.swf":t.value;if(0<t.lastIndexOf(".")){for(var n=t.substring(t.lastIndexOf(".")+1).toLowerCase(),r=!1,i=LayerWin._dext_editor._config.allowFlashFileType,s=i.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,o=0;o<i.length;o++)if(n==i[o]){r=!0;break}1==r?document.getElementsByName("InputFlag")[0].checked?(document.getElementById("savefileext").value=n,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,e.action=document.getElementById("upload_url").value,document.getElementById("dext_flash_uploader").dext_upload()):event_dext_flash_upload_completed(t):alert(s)}else alert(LayerWin.dext5_lang.msg.alert_exec)}}function event_dext_flash_upload_completed(e,t){e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));var n=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=e&&void 0!=e){try{var r;r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=r&&void 0!=r&&(e=r)}catch(i){}n=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(n=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<n.length&&(e=n[0])),r=e.split("?"),2==r.length&&-1<r[1].indexOf("^")&&(e=r[0],r=r[1].split("^"),3==r.length&&(e+="?"+r[2]))}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"flashUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"flashUpload",message:e,response:t.response})))return}catch(s){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))){if(n=confirm(LayerWin.dext5_lang.msg.uploadFailed))n=e.indexOf("HTTP Error"),r=e.indexOf("HTTP Status"),-1<n?alert(e.substring(n,n+16)):-1<r&&alert(e.substring(r,r+15));return}if("[FAIL]"==e.substring(0,6)){(n=confirm(LayerWin.dext5_lang.msg.uploadFailed))&&alert(e);return}if(elemModify){elemData.src=e,"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}r=document.getElementById("savefilename").value;var o=document.getElementById("flash_width").value,u=document.getElementById("flash_height").value,a=document.getElementById("flash_margin_left").value,f=document.getElementById("flash_margin_right").value,l=document.getElementById("flash_margin_top").value,c=document.getElementById("flash_margin_bottom").value,h=document.getElementById("flash_scale").value,p=document.getElementById("flash_allowScriptAccess").value,d=document.getElementById("flash_quality").value,v=document.getElementById("flash_menu").checked,m=document.getElementById("flash_play").checked,g=document.getElementById("flash_loop").checked,y=document.getElementById("flash_allowFullScreen").checked,b=document.getElementById("flash_width_unit"),w=document.getElementById("flash_height_unit"),b=0==LayerWin.parseIntOr0(o)?"":o+b.value,w=0==LayerWin.parseIntOr0(u)?"":u+w.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,e),n={type:"flash",src:e,width:b,height:w,margin_left:a,margin_right:f,margin_top:l,margin_bottom:c,scale:h,allowScriptAccess:p,quality:d,img_attr_info_arr:n,menu:v,play:m,loop:g,allowFullScreen:y},o=""+("<embed style='width:"+o+"px; height:"+u+"px; "),""!=a&&(o+="margin-left:"+a+"; "),""!=f&&(o+="margin-right:"+f+"; "),""!=l&&(o+="margin-top:"+l+"; "),""!=c&&(o+="margin-bottom:"+c+"; "),o=o+"'"+("src='"+e+"'"),""!=h&&(o+="scale='"+h+"'"),""!=p&&(o+="allowScriptAccess='"+p+"'"),""!=d&&(o+="quality='"+d+"'"),0==v&&(o+="menu='false'"),0==m&&(o+="play='false'"),0==g&&(o+="loop='false'"),0==y&&(o+="allowFullScreen='false'"),o+='wmode="transparent"',o+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />",LayerWin.event_dext_media_upload(r,"","","",e,o,n,window.frameElement.parentNode.parentNode)}function dext_upload_media(){var e=document.dext_upload_form,t="",t="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),n,r=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(n=t.value,0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowMediaFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(n=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&n.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),n.setItem("document_domain",document.getElementById("document_domain").value),n.setItem("proxy_url",document.getElementById("proxy_url").value),n.setItem("uploadtype",document.getElementById("uploadtype").value),n.setItem("savefilename",document.getElementById("savefilename").value),n.setItem("savefileext",document.getElementById("savefileext").value),n.setItem("serverdomain",document.getElementById("serverdomain").value),n.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),n.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),n.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),n.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&n.setItem("originalfilename",document.getElementById("originalfilename").value),n.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(n),uploadAjaxOnprogressStart({uploadType:"media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.name,fileObj:G_dragDropFileObj,formData:n},event_dext_media_upload_completed)):(e.action=document.getElementById("upload_url").value,e.submit())):alert(o)}else""==n?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else n=r.value,t=new RegExp(/(http|https|mms):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/),e=(new RegExp(/^(http|https|mms)/)).test(n),i=/^\s\s*$/,""==n||i.exec(n)||e&&!t.test(n)?(alert(LayerWin.dext5_lang.msg.alert_url),r.focus()):event_dext_media_upload_completed(n)}function event_dext_flash_flash_upload_completed(e,t,n){LayerWin.event_dext_media_upload(e,"","","0",t,n,{type:"flash",src:t,width:300,height:300,hspace:"",vspace:"",scale:"",allowScriptAccess:"",quality:"",align:"",menu:"",play:"",loop:"",allowFullScreen:""},window.frameElement.parentNode.parentNode)}function event_dext_flash_media_upload_completed(e,t,n){LayerWin.event_dext_media_upload(e,"","","0",t,n,{type:"media",src:t,width:300,height:300,autoStart:!1,playCount:!1,showTracker:!1,showStatusBar:!1,showControls:!1,showAudioControls:!1,showDisplay:!1,showPositionControls:!1},window.frameElement.parentNode.parentNode)}function event_dext_media_upload_completed(e,t){null!=e&&void 0!=e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,"")),i=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=e&&void 0!=e){try{var n;n="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=n&&void 0!=n&&(e=n)}catch(r){}var i=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(i=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<i.length&&(e=i[0])),n=e.split("?"),2==n.length&&-1<n[1].indexOf("^")&&(e=n[0],n=n[1].split("^"),3==n.length&&(e+="?"+n[2]))}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:e,response:t.response})))return}catch(s){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))){if(i=confirm(LayerWin.dext5_lang.msg.uploadFailed))i=e.indexOf("HTTP Error"),n=e.indexOf("HTTP Status"),-1<i?alert(e.substring(i,i+16)):-1<n&&alert(e.substring(n,n+15));return}if("[FAIL]"==e.substring(0,6)){(i=confirm(LayerWin.dext5_lang.msg.uploadFailed))&&alert(e);return}if(elemModify){elemData.src=e,"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}n=document.getElementById("savefilename").value;var o=document.getElementById("media_width").value,u=document.getElementById("media_height").value,a=document.getElementById("media_width_unit"),f=document.getElementById("media_height_unit"),a=0==LayerWin.parseIntOr0(o)?"":o+a.value,f=0==LayerWin.parseIntOr0(u)?"":u+f.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,e),i={type:"media",src:e,width:a,height:f,autoStart:document.getElementById("cb_autostart").checked,playCount:document.getElementById("cb_loop").checked,showTracker:document.getElementById("cb_tracker").checked,showStatusBar:document.getElementById("cb_status").checked,showControls:document.getElementById("cb_controls").checked,showAudioControls:document.getElementById("cb_volumn").checked,showDisplay:document.getElementById("cb_display").checked,showPositionControls:document.getElementById("cb_position").checked,img_attr_info_arr:i},f="",o=""+("<embed style='width:"+o+"px; height:"+u+"px;' ")+" type=application/x-mplayer2 ",o+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ",o+=" src='"+e+"'",f=1==document.getElementById("cb_autostart").checked?"1":"0",o+=" AutoStart='"+f+"'",f=1==document.getElementById("cb_loop").checked?"1":"0",o+=" loop='"+f+"'",f=1==document.getElementById("cb_tracker").checked?"1":"0",o+=" ShowTracker='"+f+"'",f=1==document.getElementById("cb_status").checked?"1":"0",o+=" ShowStatusBar='"+f+"'",f=1==document.getElementById("cb_controls").checked?"1":"0",o+=" ShowControls='"+f+"'",f=1==document.getElementById("cb_volumn").checked?"1":"0",o+=" ShowAudioControls='"+f+"'",f=1==document.getElementById("cb_display").checked?"1":"0",o+=" ShowDisplay='"+f+"'",f=1==document.getElementById("cb_position").checked?"1":"0",o+=" ShowPositionControls='"+f+"'",o+=" />",LayerWin.event_dext_media_upload(n,"","","0",e,o,i,window.frameElement.parentNode.parentNode)}function dext_detail_table_upload_image(){var e=document.getElementById("tab_value").value,t=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==t||-1<t.indexOf("table_caption")||-1<t.indexOf("table_summary")||-1<t.indexOf("table_scope")){var n=LayerWin._dext_editor._config.accessibility,r=document.getElementById("table_caption").value,i=document.getElementById("table_summary").value,s="N";1==document.getElementById("scope").checked&&(s="Y");var o="N";1==document.getElementById("t_scope").checked&&(o="Y");var u=document.getElementById("title_cell").value;if("1"==n)"3"!=e&&"4"!=e?((""==t||-1<t.indexOf("table_caption"))&&""==r&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),(""==t||-1<t.indexOf("table_summary"))&&""==i&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),(""==t||-1<t.indexOf("table_scope"))&&"1"!=u&&"N"==s&&alert(LayerWin.dext5_lang.msg.alert_scope_access1)):"3"==e&&(""==t||-1<t.indexOf("table_scope"))&&"N"==o&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==n)if("3"!=e&&"4"!=e){if((""==t||-1<t.indexOf("table_caption"))&&""==r){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2),document.getElementById("table_caption").focus();return}if((""==t||-1<t.indexOf("table_summary"))&&""==i){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2),document.getElementById("table_summary").focus();return}if((""==t||-1<t.indexOf("table_scope"))&&"1"!=u&&"N"==s){alert(LayerWin.dext5_lang.msg.alert_scope_access2),document.getElementById("scope").focus();return}}else if("3"==e&&(""==t||-1<t.indexOf("table_scope"))&&"N"==o){alert(LayerWin.dext5_lang.msg.alert_scope_access2),document.getElementById("t_scope").focus();return}}n=document.dext_upload_form,t="",t="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),r="",t&&(r=t.value),i=r.lastIndexOf(".");if("3"!=e&&"4"!=e&&0<i){for(var e=r.substring(r.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(e==s[a]){i=!0;break}1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(e),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r.substring(r.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=e,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=r.substring(r.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(e=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&e.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),e.setItem("document_domain",document.getElementById("document_domain").value),e.setItem("proxy_url",document.getElementById("proxy_url").value),e.setItem("uploadtype",document.getElementById("uploadtype").value),e.setItem("savefilename",document.getElementById("savefilename").value),e.setItem("savefileext",document.getElementById("savefileext").value),e.setItem("serverdomain",document.getElementById("serverdomain").value),e.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),e.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),e.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),e.setItem("image_convert_format",document.getElementById("image_convert_format").value),e.setItem("image_convert_width",document.getElementById("image_convert_width").value),e.setItem("image_convert_height",document.getElementById("image_convert_height").value),e.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&e.setItem("originalfilename",document.getElementById("originalfilename").value),e.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(e),uploadAjaxOnprogressStart({uploadType:"table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.name,fileObj:G_dragDropFileObj,formData:e},event_dext_detail_table_completed)):(n.action=document.getElementById("upload_url").value,n.submit())):alert(o)}else""==r||"3"==e||"4"==e?event_dext_detail_table_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}function event_dext_detail_table_completed(e,t){null!=e&&void 0!=e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));var n=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)e=e.replace(/\s/g,"%20"),e=e.replace(/\'/g,"%27"),e=e.replace(/\(/g,"%28"),e=e.replace(/\)/g,"%29");else if(null!=e&&void 0!=e){try{if(0<e.toString().length){var r;r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=r&&void 0!=r&&(e=r)}}catch(i){}n=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(n=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<n.length&&(e=n[0])),r=e.split("?"),2==r.length&&(e=r[0],r=r[1].split("^"),3==r.length&&(e+="?"+r[2]))}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response})))return}catch(s){}e=web_url_remove_char(e),r=document.getElementById("tab_value").value;var o=document.getElementById("width_line").value,u=document.getElementById("height_line").value,a=document.getElementById("width").value,f="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(f=document.getElementById("width_type").value);var l=document.getElementById("height").value,c="";1==document.getElementById("table_edge_reduce").checked?c="Y":0==document.getElementById("table_edge_reduce").checked&&(c="N");var h=document.getElementById("range").value,p=document.getElementById("topcell1"),d=document.getElementById("topcell2"),v=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var m={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};m.outsideTop=p.style.borderTop,m.outsideLeft=p.style.borderLeft,m.outsideRight=d?d.style.borderRight:p.style.borderRight,m.outsideBottom=v?v.style.borderBottom:p.style.borderBottom,v&&(m.insideRow=v.style.borderTop),d&&(m.insideCol=p.style.borderRight);var p=document.getElementById("cell_gap").value,d=document.getElementById("cell_inside_margin").value,v=document.getElementById("table_caption").value,g=document.getElementById("table_summary").value,y=document.getElementById("add").value,b=document.getElementById("repeat").value,w=document.getElementById("horizontal").value,E=document.getElementById("vertical").value,S=document.getElementById("background_color").style.backgroundColor,x="N";1==document.getElementById("scope").checked&&(x="Y");var T=document.getElementById("title_cell").value,N=document.getElementById("t_width_line").value,C=document.getElementById("t_height_line").value,k=document.getElementById("t_width").value,L=document.getElementById("t_height").value,A="N";1==document.getElementById("t_scope").checked&&(A="Y");var O=document.getElementById("templet").value,M=LayerWin.parseIntOr0(document.getElementById("margin_left").value),_=document.getElementById("class_name").value,D=document.getElementById("table_id").value;"none"==document.getElementById("class_name").style.display&&(_=null);var P=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(P=!0);var H=document.getElementById("custom_templet").value;LayerWin.event_dext_detail_table_insert(r,o,u,a,l,c,h,m,p,d,v,g,e,y,b,w,E,S,x,T,N,C,k,L,A,O,M,window.frameElement.parentNode.parentNode,_,D,P,H,gXmlData,n,f)}function dext_table_property_upload_image(){var e=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==e||-1<e.indexOf("table_caption")||-1<e.indexOf("table_summary")||-1<e.indexOf("table_scope")){var t=LayerWin._dext_editor._config.accessibility,n=document.getElementById("table_caption").value,r=document.getElementById("table_summary").value,i="N";1==document.getElementById("scope").checked&&(i="Y");var s=document.getElementById("title_cell").value;if("1"==t)(""==e||-1<e.indexOf("table_caption"))&&""==n&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),(""==e||-1<e.indexOf("table_summary"))&&""==r&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),(""==e||-1<e.indexOf("table_scope"))&&"1"!=s&&"N"==i&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==t){if((""==e||-1<e.indexOf("table_caption"))&&""==n){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2),document.getElementById("table_caption").focus();return}if((""==e||-1<e.indexOf("table_summary"))&&""==r){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2),document.getElementById("table_summary").focus();return}if((""==e||-1<e.indexOf("table_scope"))&&"1"!=s&&"N"==i){alert(LayerWin.dext5_lang.msg.alert_scope_access2),document.getElementById("scope").focus();return}}}t=document.dext_upload_form,e="",e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),n="",e&&(n=e.value);if(0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(t=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&t.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),t.setItem("document_domain",document.getElementById("document_domain").value),t.setItem("proxy_url",document.getElementById("proxy_url").value),t.setItem("uploadtype",document.getElementById("uploadtype").value),t.setItem("savefilename",document.getElementById("savefilename").value),t.setItem("savefileext",document.getElementById("savefileext").value),t.setItem("serverdomain",document.getElementById("serverdomain").value),t.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),t.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),t.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),t.setItem("image_convert_format",document.getElementById("image_convert_format").value),t.setItem("image_convert_width",document.getElementById("image_convert_width").value),t.setItem("image_convert_height",document.getElementById("image_convert_height").value),t.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&t.setItem("originalfilename",document.getElementById("originalfilename").value),t.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(t),uploadAjaxOnprogressStart({uploadType:"p_table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:t},event_dext_table_property_completed)):(t.action=document.getElementById("upload_url").value,t.submit())):alert(o)}else""==n?event_dext_table_property_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}function event_dext_table_property_completed(e,t){null!=e&&void 0!=e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));var n=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)e=e.replace(/\s/g,"%20"),e=e.replace(/\'/g,"%27"),e=e.replace(/\(/g,"%28"),e=e.replace(/\)/g,"%29");else if(_init_image_url!=e&&null!=e&&void 0!=e){try{var r;r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=r&&void 0!=r&&(e=r)}catch(i){}n=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(n=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<n.length&&(e=n[0])),r=e.split("?"),2==r.length&&(e=r[0],r=r[1].split("^"),3==r.length&&(e+="?"+r[2])),"[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,e)}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response})))return}catch(s){}e=web_url_remove_char(e),r=document.getElementById("width").value;var o="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(o=document.getElementById("width_type").value);var u=document.getElementById("height").value,a="";1==document.getElementById("table_edge_reduce").checked?a="Y":0==document.getElementById("table_edge_reduce").checked&&(a="N");var f=document.getElementById("range").value,l=LayerWin.parseIntOr0(document.getElementById("margin_left").value),c=document.getElementById("topcell1"),h=document.getElementById("topcell2"),p=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var d={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};d.outsideTop=c.style.borderTop,d.outsideLeft=c.style.borderLeft,d.outsideRight=h?h.style.borderRight:c.style.borderRight,d.outsideBottom=p?p.style.borderBottom:c.style.borderBottom,p&&(d.insideRow=p.style.borderTop),h&&(d.insideCol=c.style.borderRight);var c=document.getElementById("cell_gap").value,h=document.getElementById("cell_inside_margin").value,p=document.getElementById("table_caption").value,v=document.getElementById("table_summary").value,m=document.getElementById("prev_background_remove").value,g=document.getElementById("add").value,y=document.getElementById("repeat").value,b=document.getElementById("horizontal").value,w=document.getElementById("vertical").value,E=document.getElementById("background_color").style.backgroundColor,S="N";1==document.getElementById("scope").checked&&(S="Y");var x=document.getElementById("title_cell").value,T=document.getElementById("table_id").value,N=document.getElementById("class_name").value;"none"==document.getElementById("class_name").style.display&&(N=null);var C=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(C=!0),LayerWin.event_dext_table_property(r,u,a,f,d,c,h,p,v,m,e,g,y,b,w,E,S,x,l,window.frameElement.parentNode.parentNode,N,T,C,n,o)}function dext_cell_property_upload_image(){var e=LayerWin._dext_editor._config.accessibility,t="";if("Y"==document.getElementById("title_cell").value||"N"==document.getElementById("title_cell").value)t=document.getElementById("title_cell").value;var n="";if("row"==document.getElementById("scope").value||"col"==document.getElementById("scope").value)n="row";if("1"==e)"Y"==t&&""==n&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==e&&"Y"==t&&""==n){alert(LayerWin.dext5_lang.msg.alert_scope_access2),document.getElementById("scope").focus();return}t=document.dext_upload_form,e="",e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),n="",e&&(n=e.value);if(0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(t=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&t.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),t.setItem("document_domain",document.getElementById("document_domain").value),t.setItem("proxy_url",document.getElementById("proxy_url").value),t.setItem("uploadtype",document.getElementById("uploadtype").value),t.setItem("savefilename",document.getElementById("savefilename").value),t.setItem("savefileext",document.getElementById("savefileext").value),t.setItem("serverdomain",document.getElementById("serverdomain").value),t.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),t.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),t.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),t.setItem("image_convert_format",document.getElementById("image_convert_format").value),t.setItem("image_convert_width",document.getElementById("image_convert_width").value),t.setItem("image_convert_height",document.getElementById("image_convert_height").value),t.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&t.setItem("originalfilename",document.getElementById("originalfilename").value),t.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(t),uploadAjaxOnprogressStart({uploadType:"cell_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:t},event_dext_cell_property_completed)):(t.action=document.getElementById("upload_url").value,t.submit())):alert(o)}else""==n?event_dext_cell_property_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}function event_dext_cell_property_completed(e,t){null!=e&&void 0!=e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));var n=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)e=e.replace(/\s/g,"%20"),e=e.replace(/\'/g,"%27"),e=e.replace(/\(/g,"%28"),e=e.replace(/\)/g,"%29");else if(_init_image_url!=e){try{var r;r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=r&&void 0!=r&&(e=r)}catch(i){}null!=e&&void 0!=e&&(n=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(n=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<n.length&&(e=n[0])),r=e.split("?"),2==r.length&&(e=r[0],r=r[1].split("^"),3==r.length&&(e+="?"+r[2])),"[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,e))}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response})))return}catch(s){}e=web_url_remove_char(e),r=document.getElementById("horizontal_align").value;var o=document.getElementById("vertical_align").value,u=document.getElementById("not_apply_class_name"),u=u?u.checked:!1,a=document.getElementById("not_apply_cell_id").checked,f="",f=document.getElementById("title_cell").value,l="",l=document.getElementById("scope").value,c="",c=document.getElementById("nowrap").value,h=document.getElementById("topcell1"),p=document.getElementById("topcell2"),d=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var v={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};v.outsideTop=h.style.borderTop,v.outsideLeft=h.style.borderLeft,v.outsideRight=p?p.style.borderRight:h.style.borderRight,v.outsideBottom=d?d.style.borderBottom:h.style.borderBottom,d&&(v.insideRow=d.style.borderTop),p&&(v.insideCol=h.style.borderRight);var h=document.getElementById("prev_background_remove").value,p=document.getElementById("add").value,d=document.getElementById("repeat").value,m=document.getElementById("horizontal").value,g=document.getElementById("vertical").value,y=document.getElementById("background_color").style.backgroundColor;document.getElementById("tab_value");var b=document.getElementById("class_name").value,w=document.getElementById("cell_id").value;"notapplicable"==p&&(p=null),"notapplicable"==d&&(d=null),"notapplicable"==r&&(r=null),"notapplicable"==o&&(o=null);if("none"==document.getElementById("class_name").style.display||"notapplicable"==b||u)b=null;"notapplicable"==f&&(f=null),"notapplicable"==l&&(l=null),"notapplicable"==c&&(c=null),a&&(w=null);var a=u="",E=document.getElementById("cell_width"),S=document.getElementById("cell_height");E&&S&&(E=E.value,S=S.value,""!=E&&G_preWidth!=E&&(u=E),""!=S&&G_preHeight!=S&&(a=S)),LayerWin.event_dext_cell_property(r,o,f,l,c,v,h,e,p,d,m,g,y,window.frameElement.parentNode.parentNode,b,w,n,u,a)}function dext_dog_bg_img_upload_image(){var e=document.dext_upload_form,t="",t="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),n="";t&&(n=t.value);if(0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(e=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&e.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),e.setItem("document_domain",document.getElementById("document_domain").value),e.setItem("proxy_url",document.getElementById("proxy_url").value),e.setItem("uploadtype",document.getElementById("uploadtype").value),e.setItem("savefilename",document.getElementById("savefilename").value),e.setItem("savefileext",document.getElementById("savefileext").value),e.setItem("serverdomain",document.getElementById("serverdomain").value),e.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),e.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),e.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),e.setItem("image_convert_format",document.getElementById("image_convert_format").value),e.setItem("image_convert_width",document.getElementById("image_convert_width").value),e.setItem("image_convert_height",document.getElementById("image_convert_height").value),e.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&e.setItem("originalfilename",document.getElementById("originalfilename").value),e.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(e),uploadAjaxOnprogressStart({uploadType:"doc_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.name,fileObj:G_dragDropFileObj,formData:e},event_dext_dog_bg_img_completed)):(e.action=document.getElementById("upload_url").value,e.submit())):alert(o)}else""==n?event_dext_dog_bg_img_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}function dext_upload_video_media(){var e=document.dext_upload_form,t;t=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var n,r=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(n=t.value,0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowVideoFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(n=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&n.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),n.setItem("document_domain",document.getElementById("document_domain").value),n.setItem("proxy_url",document.getElementById("proxy_url").value),n.setItem("uploadtype",document.getElementById("uploadtype").value),n.setItem("savefilename",document.getElementById("savefilename").value),n.setItem("savefileext",document.getElementById("savefileext").value),n.setItem("serverdomain",document.getElementById("serverdomain").value),n.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),n.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),n.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),n.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename")&&n.setItem("originalfilename",document.getElementById("originalfilename").value),n.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(n),uploadAjaxOnprogressStart({uploadType:"video_media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.id,fileObj:G_dragDropFileObj,formData:n},event_dext_video_upload_completed)):(e.action=document.getElementById("upload_url").value,e.submit())):alert(o)}else""==n?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else n=r.value,t=(new RegExp(/^(http|ftp|https|news)/)).test(n),e=/^\s\s*$/,""==n||e.exec(n)||t&&!DEXTTOP.DEXT5.util.checkUrl(n)?(alert(LayerWin.dext5_lang.msg.alert_url),r.focus()):event_dext_video_upload_completed(n)}function event_dext_video_upload_completed(e,t){null!=e&&void 0!=e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));if(document.getElementsByName("InputFlag")[0].checked){if(null!=e&&void 0!=e){try{var n;n="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=n&&void 0!=n&&(e=n)}catch(r){}n=e.split("?"),2==n.length&&-1<n[1].indexOf("^")&&(e=n[0],n=n[1].split("^"),3==n.length&&(e+="?"+n[2]))}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:e,response:t.response})))return}catch(i){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))){if(n=confirm(LayerWin.dext5_lang.msg.uploadFailed)){n=e.indexOf("HTTP Error");var s=e.indexOf("HTTP Status");-1<n?alert(e.substring(n,n+16)):-1<s&&alert(e.substring(s,s+15))}return}if("[FAIL]"==e.substring(0,6)){(n=confirm(LayerWin.dext5_lang.msg.uploadFailed))&&alert(e);return}if(elemModify){"0"==LayerWin._dext_editor._config.useReplaceImage?null!=elemModify.getAttribute("src")?(elemData.src=e,elemData.source=[]):0<elemModify.getElementsByTagName("source").length&&(elemData.source=[],elemData.source.push({src:e}),elemData.src=""):""!=elemData.src?(elemData.src=e,elemData.source=[]):0<elemData.source.length&&(elemData.source=[],elemData.source.push({src:e}),elemData.src=""),"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}n=document.getElementById("savefilename").value;var s=document.getElementById("media_width").value,o=document.getElementById("media_height").value,u=document.getElementById("media_width_unit"),a=document.getElementById("media_height_unit"),u=0==LayerWin.parseIntOr0(s)?"":s+u.value,a=0==LayerWin.parseIntOr0(o)?"":o+a.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,e),a={type:"video_media",src:e,width:u,height:a,autoPlay:document.getElementById("cb_autostart").checked,loop:document.getElementById("cb_loop").checked,controls:document.getElementById("cb_controls").checked,muted:document.getElementById("cb_muted").checked},s=""+("<video style='width:"+s+"px; height:"+o+"px;'"),1==a.autoPlay&&(s+=" autoplay=''"),1==a.loop&&(s+=" loop=''"),1==a.controls&&(s+=" controls=''"),1==a.muted&&(s+=" muted=''"),s=s+">"+("<source src='"+a.src.slice(0,a.src.lastIndexOf("."))+".mp4' type='video/mp4' />"),s+="<source src='"+a.src.slice(0,a.src.lastIndexOf("."))+".ogv' type='video/ogg' />",s+="<source src='"+a.src.slice(0,a.src.lastIndexOf("."))+".webm' type='video/webm' />",s+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800",s+="</video>",LayerWin.event_dext_media_upload(n,"","","0",e,s,a,window.frameElement.parentNode.parentNode)}function event_dext_cell_border_completed(){var e=document.getElementById("edge_border").style.borderTop,t=document.getElementById("edge_border").style.borderLeft,n=document.getElementById("edge_border").style.borderRight,r=document.getElementById("edge_border").style.borderBottom;LayerWin.event_dext_cell_border(e,t,n,r,window.frameElement.parentNode.parentNode)}function event_dext_dog_bg_img_completed(e,t){null!=e&&void 0!=e&&(e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""));var n=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)e=e.replace(/\s/g,"%20"),e=e.replace(/\'/g,"%27"),e=e.replace(/\(/g,"%28"),e=e.replace(/\)/g,"%29");else if(_init_image_url!=e){try{var r;r="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=r&&void 0!=r&&(e=r)}catch(i){}null!=e&&void 0!=e&&(n=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(n=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<n.length&&(e=n[0])),r=e.split("?"),2==r.length&&(e=r[0],r=r[1].split("^"),3==r.length&&(e+="?"+r[2])),"[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,e))}loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response})))return}catch(s){}e=web_url_remove_char(e),r=document.getElementById("prev_background_remove").value;var o=document.getElementById("add").value,u=document.getElementById("repeat").value,a=document.getElementById("background_color").style.backgroundColor;LayerWin.event_dext_dog_bg_img_insert(r,e,o,u,a,window.frameElement.parentNode.parentNode,n)}function event_dext_find_completed(){var e=document.getElementById("search_contents").value,t=document.getElementsByName("search_option")[0].checked,n=document.getElementsByName("search_option")[1].checked,r=document.getElementsByName("search_option")[2].checked,i;1==document.getElementsByName("search_direction")[0].checked?i=!1:1==document.getElementsByName("search_direction")[1].checked&&(i=!0),LayerWin.event_dext_find(e,t,n,r,i,window.frameElement.parentNode.parentNode)}function event_dext_replace_completed(){var e=document.getElementById("search_contents").value,t=document.getElementById("replace_contents").value,n=document.getElementsByName("search_option")[0].checked,r=document.getElementsByName("search_option")[1].checked,i=document.getElementsByName("search_option")[2].checked,s;1==document.getElementsByName("search_direction")[0].checked?s=!1:1==document.getElementsByName("search_direction")[1].checked&&(s=!0),LayerWin.event_dext_replace(e,t,n,r,i,s,window.frameElement.parentNode.parentNode)}function event_dext_all_replace_completed(){var e=document.getElementById("search_contents").value,t=document.getElementById("replace_contents").value,n=document.getElementsByName("search_option")[0].checked,r=document.getElementsByName("search_option")[1].checked,i=document.getElementsByName("search_option")[2].checked,s;1==document.getElementsByName("search_direction")[0].checked?s=!1:1==document.getElementsByName("search_direction")[1].checked&&(s=!0),LayerWin.event_dext_all_replace(e,t,n,r,i,s,window.frameElement.parentNode.parentNode,!0)}function event_dext_spellcheck_find_completed(e){return LayerWin.event_dext_spellcheck_find(e)}function event_dext_spellcheck_replace_completed(){var e=document.getElementById("wrong_word").value,t=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_replace(e,t)}function event_dext_spellcheck_all_replace_completed(){var e=document.getElementById("wrong_word").value,t=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_all_replace(e,t)}function event_dext_capital_small_letter_completed(){1==document.getElementsByName("capital_small_letter")[0].checked?_capital_small_letter="LOWER":1==document.getElementsByName("capital_small_letter")[1].checked?_capital_small_letter="UPPER":1==document.getElementsByName("capital_small_letter")[2].checked&&(_capital_small_letter="FIRSTUPPER"),LayerWin.event_dext_capital_small_letter(_capital_small_letter,window.frameElement.parentNode.parentNode)}function event_dext_emoticon_completed(e,t,n,r){LayerWin.event_dext_emoticon_insert({srcURL:e,width:"",height:"",title:t,alt:t,margin_left:"",margin_right:"",margin_top:"",margin_bottom:"",align_obj:"",align:"",border:"0",linkurl:"",borderStyle:"",borderKind:"",borderColor:"",borderThickness:""},window.frameElement.parentNode.parentNode)}function event_dext_insert_row_column_completed(){var e="",t="";1==document.getElementById("row").checked?(e="R",1==document.getElementById("up").checked?t="U":1==document.getElementById("down").checked&&(t="D")):1==document.getElementById("column").checked&&(e="C",1==document.getElementById("right").checked?t="R":1==document.getElementById("left").checked&&(t="L"));var n=document.getElementById("line_count").value;LayerWin.event_dext_insert_row_column(e,t,n,window.frameElement.parentNode.parentNode)}function event_dext_row_property_completed(){var e=document.getElementById("background_color").style.backgroundColor,t=document.getElementById("row_height").value,n=document.getElementById("horizontal_align").value,r=document.getElementById("vertical_align").value;LayerWin.event_dext_row_property(e,t,n,r,window.frameElement.parentNode.parentNode)}function event_dext_column_property_completed(){var e=document.getElementById("background_color").style.backgroundColor,t=document.getElementById("column_width").value,n=document.getElementById("horizontal_align").value,r=document.getElementById("vertical_align").value;LayerWin.event_dext_column_property(e,t,n,r,window.frameElement.parentNode.parentNode)}function dext_create_iframe(){var e=document.getElementById("input_url").value,t=(new RegExp(/^(http|ftp|https|news)/)).test(e),n=/^\s\s*$/;if(""==e||n.exec(e)||t&&!DEXTTOP.DEXT5.util.checkUrl(e))alert(LayerWin.dext5_lang.msg.alert_url),setCursorPos(document.getElementById("input_url"),!0,!1);else{e=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==e||-1<e.indexOf("iframe_title"))if(e=LayerWin._dext_editor._config.accessibility,t=document.getElementById("input_title").value,"1"==e)""==t&&alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access1);else if("2"==e&&""==t){alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access2),document.getElementById("input_title").focus();return}e=document.getElementById("input_width").value,n=document.getElementById("input_width_unit"),t=document.getElementById("input_height_unit"),n=0==LayerWin.parseIntOr0(e)?"":e+n.value,e=document.getElementById("input_height").value,e=0==LayerWin.parseIntOr0(e)?"":e+t.value,e={type:"iframe",src:document.getElementById("input_url").value,id:document.getElementById("input_id").value,name:document.getElementById("input_name").value,className:document.getElementById("input_class").value,title:document.getElementById("input_title").value,width:n,height:e,align:document.getElementById("select_align").value,scrolling:document.getElementById("select_scroll").value,frameBorder:document.getElementById("input_border").checked},t=LayerWin.getLinkMediaType(e.src),0<t.length&&(e.type=t,e.type2="iframe"),LayerWin.event_dext_create_iframe(e,window.frameElement.parentNode.parentNode)}}function dext_create_hyperlink_image(){var e=document.dext_upload_form,t="",t="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),n;n=t.value;if(""==n)alert(LayerWin.dext5_lang.background_image.msg_file_select),setCursorPos(t,!0,!1);else if(0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(e=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&e.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),e.setItem("document_domain",document.getElementById("document_domain").value),e.setItem("proxy_url",document.getElementById("proxy_url").value),e.setItem("uploadtype",document.getElementById("uploadtype").value),e.setItem("savefilename",document.getElementById("savefilename").value),e.setItem("savefileext",document.getElementById("savefileext").value),e.setItem("serverdomain",document.getElementById("serverdomain").value),e.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),e.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),e.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),e.setItem("image_convert_format",document.getElementById("image_convert_format").value),e.setItem("image_convert_width",document.getElementById("image_convert_width").value),e.setItem("image_convert_height",document.getElementById("image_convert_height").value),e.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&e.setItem("originalfilename",document.getElementById("originalfilename").value),e.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(e),uploadAjaxOnprogressStart({uploadType:"hyperlink_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.name,fileObj:G_dragDropFileObj,formData:e},dext_create_hyperlink)):(e.action=document.getElementById("upload_url").value,e.submit())):(alert(o),setCursorPos(t,!0,!1))}else alert(o),setCursorPos(t,!0,!1)}function dext_create_hyperlink(e,t){e&&(e=e.replace(/<.*?script.*\/?>/g,""));if("hyperlink"==document.getElementById("select_category").value||0>"bookmark,image".indexOf(document.getElementById("select_category").value)){var n=document.getElementById("input_url").value,r=(new RegExp(/^(http|https|ftp|news)/)).test(n),i=/^\s\s*$/;if(""==n||i.exec(n)||r&&!DEXTTOP.DEXT5.util.checkUrl(n)){alert(LayerWin.dext5_lang.msg.alert_url),setCursorPos(document.getElementById("input_url"),!0,!1);return}}else if("bookmark"==document.getElementById("select_category").value&&""==document.getElementById("select_bookmark").value){alert(LayerWin.dext5_lang.msg.alert_bookmark),setCursorPos(document.getElementById("select_bookmark"),!0,!1);return}n=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==n||-1<n.indexOf("a_title"))if(n=LayerWin._dext_editor._config.accessibility,r=document.getElementById("input_text").value,"1"==n)""==r&&alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access1);else if("2"==n&&""==r){alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access2),document.getElementById("input_text").focus();return}n=document.getElementById("select_category").value,0>"bookmark,image".indexOf(document.getElementById("select_category").value)&&(n="hyperlink"),n={type:n,url:document.getElementById("input_url").value,text:document.getElementById("input_text").value,title:document.getElementById("input_title").value,target:document.getElementById("select_target").value,bookname:document.getElementById("select_bookmark").value,id:document.getElementById("input_id").value,className:document.getElementById("input_class").value,attr_info_arr:[]};if(null!=e&&void 0!=e){e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,"");try{var s;s="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=s&&void 0!=s&&(e=s)}catch(o){}if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:e,response:t.response})))return}catch(u){}"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(n.attr_info_arr=e.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<n.attr_info_arr.length&&(e=n.attr_info_arr[0])),s=e.split("?"),2==s.length&&(e=s[0],s=s[1].split("^"),3==s.length&&(img_real_width=s[0],img_real_height=s[1],e+="?"+s[2])),!e||"[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,e);if(elemModify){if(n.attr_info_arr&&1<n.attr_info_arr.length)for(s=n.attr_info_arr.length,r=1;r<s;r++)i=n.attr_info_arr[r].split("^"),2==i.length&&elemModify.setAttribute(i[0],i[1]);document.getElementById("input_url").value=e,set_modify_ok();return}n.url=e}LayerWin.event_dext_create_hyperlink(n,window.frameElement.parentNode.parentNode)}function split_cell_ok(){var e=document.getElementById("input_row"),t=document.getElementById("input_column"),n=document.getElementsByName("radio_split")[0],r=document.getElementsByName("radio_split")[1];n.checked?t.value="0":r.checked&&(e.value="0"),LayerWin.event_dext_split_cell(e.value,t.value,window.frameElement.parentNode.parentNode)}function symbol_ok(){var e=document.getElementById("input_output");LayerWin.event_dext_symbol(e.innerHTML,window.frameElement.parentNode.parentNode)}function template_ok(){var e=document.getElementById("clicked_template").value,t=document.getElementById("template_print_header").value,n=document.getElementById("template_print_footer").value,e={url:e,print_header:t,print_footer:n};0==DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_template(e,window.frameElement.parentNode.parentNode):LayerWin.event_dext_template(e,window.frameElement.parentNode.parentNode)}function dext_insert_link_media(){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var e="",t=document.getElementById("ta_media_tag").value,n=document.getElementById("ta_media_caption").value,r=!1;document.getElementById("check_allow_full_screen")&&(r=document.getElementById("check_allow_full_screen").checked);var t=t.replace(/\r\n/g,""),t=t.replace(/\n/g,""),t=t.replace(/\r/g,""),e=t.match(/(<[\s]*embed [^>]+>)/gi),i=t.match(/(<[\s]*iframe [^>]+>)/gi),t=t.match(/(<[\s]*object [^>]+>)/gi),s=LayerWin._dext_editor._config.xss_remove_tags.toLowerCase();if(t&&-1<s.indexOf("object"))alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);else{if(e){if(-1<s.indexOf("embed")){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);return}e=e[0]}else{if(!i){alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}if(-1<s.indexOf("iframe")){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);return}e=i[0]}if("1"==LayerWin._dext_editor._config.allowLinkMediaCaption)if("1"==LayerWin._dext_editor._config.accessibility)""==n&&alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access1);else if("2"==LayerWin._dext_editor._config.accessibility&&""==n){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access2),document.getElementById("ta_media_caption").focus();return}LayerWin.event_dext_insert_link_media(e,n,r,window.frameElement.parentNode.parentNode)}}}function dext_modify_link_media(e){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin
.dext5_lang.insert_link_media.tag_null);else{var t="",n=document.getElementById("ta_media_tag").value,r=document.getElementById("ta_media_caption").value,i=!1;document.getElementById("check_allow_full_screen")&&(i=document.getElementById("check_allow_full_screen").checked),n=n.replace(/\r\n/g,""),n=n.replace(/\n/g,""),n=n.replace(/\r/g,""),t=n.match(/(<[\s]*embed [^>]+>)/gi),n=n.match(/(<[\s]*iframe [^>]+>)/gi);if(t)t=t[0];else{if(!n){alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}t=n[0]}LayerWin.event_dext_modify_link_media(t,r,i,e,window.frameElement.parentNode.parentNode)}}function dext_insert_paste_dialog_html(){var e=document.getElementById("pasteArea").contentWindow.document.body.innerHTML;LayerWin.event_dext_insert_paste_dialog_html(e,window.frameElement.parentNode.parentNode)}function dext_insert_input_text(){var e={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertReadonly:!1,insertType:"text",insertSize:"",insertMaxlength:"",insertEventNameArr:[],insertEventFunctionArr:[]};e.insertName=document.getElementById("input_name").value,e.insertValue=document.getElementById("input_value").value,e.insertId=document.getElementById("input_id").value,e.insertClass=document.getElementById("input_class").value,e.insertTitle=document.getElementById("input_title").value,e.insertAlign=document.getElementById("input_textalign").value,e.insertWidth="0"==document.getElementById("input_width").value?"":document.getElementById("input_width").value,e.insertHeight="0"==document.getElementById("input_height").value?"":document.getElementById("input_height").value,e.insertDisabled=document.getElementById("input_disabled").checked,e.insertReadonly=document.getElementById("input_readonly").checked,e.insertSize="0"==document.getElementById("input_size").value?"":document.getElementById("input_size").value,e.insertMaxlength="0"==document.getElementById("input_maxtext").value?"":document.getElementById("input_maxtext").value;for(var t=document.getElementsByName("input_type"),n=t.length,r=0;r<n;r++)if(1==t[r].checked){e.insertType=t[r].value;break}for(var t=document.getElementById("event_table"),n=t.childNodes.length,r=0;r<n;r++){var i=t.childNodes[r].getElementsByTagName("span");e.insertEventNameArr.push(i[0].innerHTML),e.insertEventFunctionArr.push(i[1].innerHTML)}LayerWin.event_dext_insert_input_text(e,window.frameElement.parentNode.parentNode)}function set_modify_field_input_text(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name),elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value")),""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id),""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className),""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title),""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign),""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10)),""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10)),elemModify.disabled&&(document.getElementById("input_disabled").checked=!0),elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0),elemModify.getAttribute("size")&&""!=elemModify.getAttribute("size")&&(document.getElementById("input_size").value=elemModify.getAttribute("size")),elemModify.getAttribute("maxlength")&&""!=elemModify.getAttribute("maxlength")&&(document.getElementById("input_maxtext").value=elemModify.getAttribute("maxlength")),"text"==elemModify.type?(document.getElementById("input_type_general").checked=!0,document.getElementById("input_type_password").checked=!1):"password"==elemModify.type&&(document.getElementById("input_type_general").checked=!1,document.getElementById("input_type_password").checked=!0);if(elemModify.getAttribute("dext5customdata")){var e=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==e.type){var t=e.eventFunction,e=e.eventName.split(""),t=t.split(""),n=e.length;for(i=0;i<n;i++){var r=document.getElementById("event_table"),s=document.createElement("tr"),o=document.createElement("td");o.className="type2";var u=document.createElement("a"),a=document.createElement("span");a.appendChild(document.createTextNode(e[i])),u.appendChild(a),u.title=e[i],a=document.createElement("td"),a.className="type2",a.style.width="65%";var f=document.createElement("a"),l=document.createElement("span");l.appendChild(document.createTextNode(t[i])),f.appendChild(l),f.title=t[i],o.appendChild(u),s.appendChild(o),a.appendChild(f),s.appendChild(a),r.appendChild(s)}}}}function dext_modify_input_text(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),""!=document.getElementById("input_value").value?(elemModify.setAttribute("value",document.getElementById("input_value").value),elemModify.value=document.getElementById("input_value").value):(elemModify.setAttribute("value",""),elemModify.value=""),""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id"),""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class"),""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title"),""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="",""!=document.getElementById("input_width").value&&"0"!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="",""!=document.getElementById("input_height").value&&"0"!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="",elemModify.disabled=document.getElementById("input_disabled").checked,elemModify.readOnly=document.getElementById("input_readonly").checked,""!=document.getElementById("input_size").value&&"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size"),""!=document.getElementById("input_maxtext").value&&"0"!=document.getElementById("input_maxtext").value?elemModify.maxLength=document.getElementById("input_maxtext").value:elemModify.removeAttribute("maxLength");for(var e=document.getElementsByName("input_type"),t=e.length,n=0;n<t;n++)if(1==e[n].checked){try{elemModify.type=e[n].value}catch(r){n='<input type="'+e[n].value+'" />',e=LayerWin._iframeDoc.createElement("div"),e.innerHTML=n,newElem=e.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(n=elemModify.outerHTML,n=n.replace('name="'+elemModify.name+'"',""),n=n.replace("name='"+elemModify.name+"'",""),n=n.replace("name="+elemModify.name,""),n=n.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=n):elemModify.removeAttribute("name");var i=document.getElementById("event_table"),s=i.childNodes.length;if(0<s){for(var t=e="",n=0;n<s;n++)0!=n&&(e+="",t+=""),e+=i.childNodes[n].getElementsByTagName("span")[0].innerHTML,t+=i.childNodes[n].getElementsByTagName("span")[1].innerHTML;""!=e&&(n={type:"event"},n.eventName=e,n.eventFunction=t,LayerWin.setDextCustomData(elemModify,n))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,event_dext_close()}function dext_insert_input_radio_or_checkbox(e){var t={insertType:"",insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertChecked:!1,insertEventNameArr:[],insertEventFunctionArr:[]};t.insertType=e,t.insertName=document.getElementById("input_name").value,t.insertValue=document.getElementById("input_value").value,t.insertId=document.getElementById("input_id").value,t.insertClass=document.getElementById("input_class").value,t.insertTitle=document.getElementById("input_title").value,t.insertWidth=document.getElementById("input_width").value,t.insertHeight=document.getElementById("input_height").value,t.insertDisabled=document.getElementById("input_disabled").checked;var n=document.getElementsByName("input_status"),r=n.length;for(e=0;e<r;e++)if(1==n[e].checked){t.insertChecked="true"==n[e].value?!0:!1;break}n=document.getElementById("event_table"),r=n.childNodes.length;for(e=0;e<r;e++){var i=n.childNodes[e].getElementsByTagName("span");t.insertEventNameArr.push(i[0].innerHTML),t.insertEventFunctionArr.push(i[1].innerHTML)}LayerWin.event_dext_insert_input_radio_or_checkbox(t,window.frameElement.parentNode.parentNode)}function set_modify_field_input_radio_or_checkbox(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name),elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value")),""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id),""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className),""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title),""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10)),""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10)),elemModify.disabled&&(document.getElementById("input_disabled").checked=!0),elemModify.checked?document.getElementById("input_checked").checked=!0:document.getElementById("input_not_checked").checked=!0;if(elemModify.getAttribute("dext5customdata")){var e=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==e.type){var t=e.eventFunction,e=e.eventName.split(""),t=t.split(""),n=e.length;for(i=0;i<n;i++){var r=document.getElementById("event_table"),s=document.createElement("tr"),o=document.createElement("td");o.className="type2";var u=document.createElement("a"),a=document.createElement("span");a.innerHTML=e[i],u.appendChild(a),u.title=e[i],a=document.createElement("td"),a.className="type2",a.style.width="65%";var f=document.createElement("a"),l=document.createElement("span");l.innerHTML=t[i],f.appendChild(l),f.title=t[i],o.appendChild(u),s.appendChild(o),a.appendChild(f),s.appendChild(a),r.appendChild(s)}}}}function dext_modify_input_radio_or_checkbox(e){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value"),""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id"),""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class"),""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title"),""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="",""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="",elemModify.disabled=document.getElementById("input_disabled").checked;var t=document.getElementsByName("input_status"),n=t.length;for(e=0;e<n;e++)if(1==t[e].checked){"true"==t[e].value?(elemModify.checked=!0,elemModify.setAttribute("checked","checked")):(elemModify.checked=!1,elemModify.removeAttribute("checked"));break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(e=elemModify.outerHTML,e=e.replace('name="'+elemModify.name+'"',""),e=e.replace("name='"+elemModify.name+"'",""),e=e.replace("name="+elemModify.name,""),e=e.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=e):elemModify.removeAttribute("name");var r=document.getElementById("event_table"),i=r.childNodes.length;if(0<i){n=t="";for(e=0;e<i;e++)0!=e&&(t+="",n+=""),t+=r.childNodes[e].getElementsByTagName("span")[0].innerHTML,n+=r.childNodes[e].getElementsByTagName("span")[1].innerHTML;""!=t&&(e={type:"event"},e.eventName=t,e.eventFunction=n,LayerWin.setDextCustomData(elemModify,e))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,event_dext_close()}function dext_insert_input_button(){var e={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"button",insertEventNameArr:[],insertEventFunctionArr:[]};e.insertName=document.getElementById("input_name").value,e.insertValue=document.getElementById("input_value").value,e.insertId=document.getElementById("input_id").value,e.insertClass=document.getElementById("input_class").value,e.insertTitle=document.getElementById("input_title").value,e.insertAlign=document.getElementById("input_textalign").value,e.insertWidth=document.getElementById("input_width").value,e.insertHeight=document.getElementById("input_height").value,e.insertDisabled=document.getElementById("input_disabled").checked;for(var t=document.getElementsByName("input_type"),n=t.length,r=0;r<n;r++)if(1==t[r].checked){e.insertType=t[r].value;break}for(var t=document.getElementById("event_table"),n=t.childNodes.length,r=0;r<n;r++){var i=t.childNodes[r].getElementsByTagName("span");e.insertEventNameArr.push(i[0].innerHTML),e.insertEventFunctionArr.push(i[1].innerHTML)}LayerWin.event_dext_insert_input_button(e,window.frameElement.parentNode.parentNode)}function set_modify_field_input_button(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name),elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value")),""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id),""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className),""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title),""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign),""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10)),""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10)),elemModify.disabled&&(document.getElementById("input_disabled").checked=!0),elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0),"button"==elemModify.type?(document.getElementById("input_general").checked=!0,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=!1):"reset"==elemModify.type?(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!0,document.getElementById("input_submit").checked=!1):"submit"==elemModify.type&&(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=!0);if(elemModify.getAttribute("dext5customdata")){var e=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==e.type){var t=e.eventFunction,e=e.eventName.split(""),t=t.split(""),n=e.length;for(i=0;i<n;i++){var r=document.getElementById("event_table"),s=document.createElement("tr"),o=document.createElement("td");o.className="type2";var u=document.createElement("a"),a=document.createElement("span");a.innerHTML=e[i],u.appendChild(a),u.title=e[i],a=document.createElement("td"),a.className="type2",a.style.width="65%";var f=document.createElement("a"),l=document.createElement("span");l.innerHTML=t[i],f.appendChild(l),f.title=t[i],o.appendChild(u),s.appendChild(o),a.appendChild(f),s.appendChild(a),r.appendChild(s)}}}}function dext_modify_input_button(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id"),""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class"),""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title"),""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="",""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="",""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="",elemModify.disabled=document.getElementById("input_disabled").checked;for(var e=document.getElementsByName("input_type"),t=e.length,n=0;n<t;n++)if(1==e[n].checked){try{elemModify.type=e[n].value}catch(r){n='<input type="'+e[n].value+'" />',e=LayerWin._iframeDoc.createElement("div"),e.innerHTML=n,newElem=e.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value"),""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(n=elemModify.outerHTML,n=n.replace('name="'+elemModify.name+'"',""),n=n.replace("name='"+elemModify.name+"'",""),n=n.replace("name="+elemModify.name,""),n=n.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=n):elemModify.removeAttribute("name");var i=document.getElementById("event_table"),s=i.childNodes.length;if(0<s){for(var t=e="",n=0;n<s;n++)0!=n&&(e+="",t+=""),e+=i.childNodes[n].getElementsByTagName("span")[0].innerHTML,t+=i.childNodes[n].getElementsByTagName("span")[1].innerHTML;""!=e&&(n={type:"event"},n.eventName=e,n.eventFunction=t,LayerWin.setDextCustomData(elemModify,n))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,event_dext_close()}function setInputSelectPageEvent(){var e=document.getElementById("input_value"),t=document.getElementById("btn_add"),n=document.getElementById("btn_modify"),r=document.getElementById("btn_delete"),i=document.getElementById("btn_up"),s=document.getElementById("btn_down");n.disabled=!0,n.className="non_btn",r.disabled=!0,r.className="non_btn",i.disabled=!0,i.className="non_btn",s.disabled=!0,s.className="non_btn";var o=document.getElementById("option_table");DEXTTOP.DEXT5.util.addEvent(t,"click",btn_select_add_click),DEXTTOP.DEXT5.util.addEvent(n,"click",btn_select_mod_click),DEXTTOP.DEXT5.util.addEvent(r,"click",btn_select_del_click),DEXTTOP.DEXT5.util.addEvent(i,"click",btn_select_up_click),DEXTTOP.DEXT5.util.addEvent(s,"click",btn_select_down_click),DEXTTOP.DEXT5.util.addEvent(o,"click",function(e){e=e||window.event;var t=e.target?e.target:e.srcElement;e=document.getElementById("input_option");var u=document.getElementById("input_option_value");if(t=Dext5LayerWin.GetParentbyTagName(t,"tr"))_clicked_options=t,t.style.background="#e5e5e5",e.value=t.getElementsByTagName("span")[0].innerHTML,u.value=t.getElementsByTagName("span")[1].innerHTML;for(e=0;e<o.childNodes.length;e++)o.childNodes[e]!=_clicked_options&&(o.childNodes[e].style.background="white");n.disabled=!1,n.className="in_btn",r.disabled=!1,r.className="in_btn",i.disabled=!1,i.className="in_btn",s.disabled=!1,s.className="in_btn"});var u=document.getElementById("input_multiselect");LayerWin.DEXTTOP.DEXT5.util.addEvent(u,"click",function(){if(0==u.checked)for(var t=o.getElementsByTagName("input"),n=t.length,r=!1,i=0;i<n;i++)t[i].checked&&(r?t[i].checked=!1:(e.value=o.childNodes[i].getElementsByTagName("span")[1].innerHTML,r=!0))})}function btn_select_add_click(){var e=document.getElementById("input_option"),t=document.getElementById("input_option_value");document.getElementById("btn_add");if(""!=e.value){var n=document.getElementById("option_table"),r=document.getElementById("input_value"),i=document.createElement("tr"),s=document.createElement("td");s.className="type";var o=document.createElement("input");o.type="checkbox";var u=document.createElement("td");u.className="type2",u.style.width="44%";var a=document.createElement("a"),f=document.createElement("span");f.innerHTML=e.value,a.appendChild(f),a.title=e.value,f=document.createElement("td"),f.className="type2",f.style.width="44%";var l=document.createElement("a"),c=document.createElement("span");c.innerHTML=t.value,l.appendChild(c),l.title=t.value,s.appendChild(o),i.appendChild(s),u.appendChild(a),i.appendChild(u),f.appendChild(l),i.appendChild(f),n.appendChild(i),e.value="",t.value="",LayerWin.DEXTTOP.DEXT5.util.addEvent(o,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==o.checked)for(var e=n.getElementsByTagName("input"),t=e.length,i=0;i<t;i++)e[i]!=o?e[i].checked=!1:r.value=c.innerHTML;else r.value="";else if(1==o.checked)r.value=c.innerHTML;else for(e=n.getElementsByTagName("input"),t=e.length,r.value="",i=0;i<t;i++)if(e[i].checked){r.value=n.childNodes[i].getElementsByTagName("span")[1].innerHTML;break}})}}function btn_select_mod_click(){if(_clicked_options){var e=document.getElementById("input_option"),t=document.getElementById("input_option_value");_clicked_options.getElementsByTagName("span")[0].innerHTML=e.value,_clicked_options.getElementsByTagName("span")[1].innerHTML=t.value}}function btn_select_del_click(){document.getElementById("option_table"),document.getElementById("btn_add");var e=document.getElementById("btn_modify"),t=document.getElementById("btn_delete"),n=document.getElementById("btn_up"),r=document.getElementById("btn_down");document.getElementById("input_option").value="",document.getElementById("input_option_value").value="",_clicked_options&&_clicked_options.parentNode.removeChild(_clicked_options),e.disabled=!0,e.className="non_btn",t.disabled=!0,t.className="non_btn",n.disabled=!0,n.className="non_btn",r.disabled=!0,r.className="non_btn"}function btn_select_up_click(){_clicked_options&&_clicked_options.previousSibling&&_clicked_options.parentNode.insertBefore(_clicked_options,_clicked_options.previousSibling)}function btn_select_down_click(){_clicked_options&&_clicked_options.nextSibling&&_clicked_options.parentNode.insertBefore(_clicked_options.nextSibling,_clicked_options)}function setInputCommonEventPageEvent(){var e=document.getElementById("btn_event_add"),t=document.getElementById("btn_event_modify"),n=document.getElementById("btn_event_delete");t.disabled=!0,t.className="non_btn",n.disabled=!0,n.className="non_btn";var r=document.getElementById("event_table");DEXTTOP.DEXT5.util.addEvent(e,"click",btn_common_event_add_click),DEXTTOP.DEXT5.util.addEvent(t,"click",btn_common_event_mod_click),DEXTTOP.DEXT5.util.addEvent(n,"click",btn_common_event_del_click),DEXTTOP.DEXT5.util.addEvent(r,"click",function(e){e=e||window.event;var i=e.target?e.target:e.srcElement;e=document.getElementById("input_event_name");var s=document.getElementById("input_event_function");if(i=Dext5LayerWin.GetParentbyTagName(i,"tr"))_clicked_event=i,i.style.background="#e5e5e5",e.value=i.getElementsByTagName("span")[0].innerHTML,s.value=i.getElementsByTagName("span")[1].innerHTML;for(e=0;e<r.childNodes.length;e++)r.childNodes[e]!=_clicked_event&&(r.childNodes[e].style.background="white");t.disabled=!1,t.className="in_btn",n.disabled=!1,n.className="in_btn"})}function btn_common_event_add_click(){var e=document.getElementById("input_event_name"),t=document.getElementById("input_event_function");document.getElementById("btn_event_add");if(""!=e.value){var n=document.getElementById("event_table"),r=n.childNodes.length;if(0<r)for(var i=0;i<r;i++)if(e.value==n.childNodes[i].getElementsByTagName("span")[0].innerHTML){alert(e.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}n=document.getElementById("event_table"),r=document.createElement("tr"),i=document.createElement("td"),i.className="type2";var s=document.createElement("a"),o=document.createElement("span");o.innerHTML=e.value,s.appendChild(o),s.title=e.value,e=document.createElement("td"),e.className="type2",e.style.width="65%";var o=document.createElement("a"),u=document.createElement("span");u.innerHTML=t.value,o.appendChild(u),o.title=t.value,i.appendChild(s),r.appendChild(i),e.appendChild(o),r.appendChild(e),n.appendChild(r),t.value=""}}function btn_common_event_mod_click(){if(_clicked_event){var e=document.getElementById("input_event_name"),t=document.getElementById("input_event_function"),n=document.getElementById("event_table"),r=n.childNodes.length;if(0<r)for(var i=0;i<r;i++)if("white"==n.childNodes[i].style.background&&e.value==n.childNodes[i].getElementsByTagName("span")[0].innerHTML){alert(e.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}_clicked_event.getElementsByTagName("span")[0].innerHTML=e.value,_clicked_event.getElementsByTagName("span")[1].innerHTML=t.value}}function btn_common_event_del_click(){document.getElementById("event_table"),document.getElementById("btn_event_add");var e=document.getElementById("btn_event_modify"),t=document.getElementById("btn_event_delete");document.getElementById("input_event_function").value="",_clicked_event&&_clicked_event.parentNode.removeChild(_clicked_event),e.disabled=!0,e.className="non_btn",t.disabled=!0,t.className="non_btn"}function dext_insert_input_select(){var e={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertSize:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertMultiselect:!1,insertOptionsArr:[],insertOptionsValueArr:[],insertOptionsSelected:[],insertEventNameArr:[],insertEventFunctionArr:[]};e.insertName=document.getElementById("input_name").value,e.insertValue=document.getElementById("input_value").value,e.insertId=document.getElementById("input_id").value,e.insertClass=document.getElementById("input_class").value,e.insertTitle=document.getElementById("input_title").value,e.insertSize="0"==document.getElementById("input_size").value?"":document.getElementById("input_size").value,e.insertWidth=document.getElementById("input_width").value,e.insertHeight=document.getElementById("input_height").value,e.insertDisabled=document.getElementById("input_disabled").checked,e.insertMultiselect=document.getElementById("input_multiselect").checked;for(var t=document.getElementById("option_table"),n=t.childNodes.length,r=0;r<n;r++){var i=t.childNodes[r].getElementsByTagName("span"),s=t.childNodes[r].getElementsByTagName("input")[0];e.insertOptionsArr.push(i[0].innerHTML),e.insertOptionsValueArr.push(i[1].innerHTML),e.insertOptionsSelected.push(s.checked)}t=document.getElementById("event_table"),n=t.childNodes.length;for(r=0;r<n;r++)i=t.childNodes[r].getElementsByTagName("span"),e.insertEventNameArr.push(i[0].innerHTML),e.insertEventFunctionArr.push(i[1].innerHTML);LayerWin.event_dext_insert_input_select(e,window.frameElement.parentNode.parentNode)}function set_modify_field_input_select(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name),elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value")),""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id),""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className),""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title),""!=elemModify.size&&(document.getElementById("input_size").value=elemModify.size),""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10)),""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10)),elemModify.disabled&&(document.getElementById("input_disabled").checked=!0),elemModify.multiple&&(document.getElementById("input_multiselect").checked=!0);for(var e=elemModify.getElementsByTagName("option"),t=e.length,n=0;n<t;n++){var r=e[n].innerHTML,i=e[n].value;document.getElementById("btn_add");var s=document.getElementById("option_table"),o=document.getElementById("input_value"),u=document.createElement("tr"),a=document.createElement("td");a.className="type";var f=document.createElement("input");f.type="checkbox";var l=document.createElement("td");l.className="type2",l.style.width="44%";var c=document.createElement("a"),h=document.createElement("span");h.innerHTML=r,c.appendChild(h),c.title=r,h=document.createElement("td"),h.className="type2",h.style.width="44%";var r=document.createElement("a"),p=document.createElement("span");p.innerHTML=i,r.appendChild(p),r.title=i,a.appendChild(f),u.appendChild(a),l.appendChild(c),u.appendChild(l),h.appendChild(r),u.appendChild(h),s.appendChild(u),LayerWin.DEXTTOP.DEXT5.util.addEvent(f,"click",function(e){e=e.target?e.target:e.srcElement;if(0==document.getElementById("input_multiselect").checked)if(1==e.checked)for(var t=s.getElementsByTagName("input"),n=t.length,r=0;r<n;r++)t[r]!=e?t[r].checked=!1:(e.checked=!0,o.value=p.innerHTML);else o.value="";else if(1==e.checked)o.value=p.innerHTML;else for(t=s.getElementsByTagName("input"),n=t.length,o.value="",r=0;r<n;r++)if(t[r].checked){o.value=s.childNodes[r].getElementsByTagName("span")[1].innerHTML;break}}),e[n].selected&&(f.checked=!0)}if(elemModify.getAttribute("dext5customdata")&&(u=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==u.type))for(n=u.eventFunction,e=u.eventName.split(""),t=n.split(""),i=e.length,n=0;n<i;n++)s=document.getElementById("event_table"),u=document.createElement("tr"),a=document.createElement("td"),a.className="type2",f=document.createElement("a"),l=document.createElement("span"),l.innerHTML=e[n],f.appendChild(l),f.title=e[n],l=document.createElement("td"),l.className="type2",l.style.width="65%",c=document.createElement("a"),h=document.createElement("span"),h.innerHTML=t[n],c.appendChild(h),c.title=t[n],a.appendChild(f),u.appendChild(a),l.appendChild(c),u.appendChild(l),s.appendChild(u)}function dext_modify_input_select(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value"),""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id"),""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class"),""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title"),""!=document.getElementById("input_size").value&&"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size"),""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="",""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="",elemModify.disabled=document.getElementById("input_disabled").checked,elemModify.multiple=document.getElementById("input_multiselect").checked,elemModify.innerHTML="";for(var e=document.getElementById("option_table"),t=e.childNodes.length,n=0;n<t;n++){var r=document.createElement("option");r.innerHTML=e.childNodes[n].getElementsByTagName("span")[0].innerHTML,r.setAttribute("value",e.childNodes[n].getElementsByTagName("span")[1].innerHTML),r.selected=e.childNodes[n].getElementsByTagName("input")[0].checked,elemModify.appendChild(r)}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(n=elemModify.outerHTML,n=n.replace('name="'+elemModify.name+'"',""),n=n.replace("name='"+elemModify.name+"'",""),n=n.replace("name="+elemModify.name,""),n=n.replace(">",' name="'+document.getElementById("input_name").value+'" >'),elemModify.outerHTML=n):elemModify.removeAttribute("name");var r=document.getElementById("event_table"),i=r.childNodes.length;if(0<i){t=e="";for(n=0;n<i;n++)0!=n&&(e+="",t+=""),e+=r.childNodes[n].getElementsByTagName("span")[0].innerHTML,t+=r.childNodes[n].getElementsByTagName("span")[1].innerHTML;""!=e&&(n={type:"event"},n.eventName=e,n.eventFunction=t,LayerWin.setDextCustomData(elemModify,n))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,event_dext_close()}function dext_insert_input_textarea(){var e={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertAlign:"",insertDisabled:!1,insertReadonly:!1,insertRows:"",insertCols:"",insertWrap:"",insertEventNameArr:[],insertEventFunctionArr:[]};e.insertName=document.getElementById("input_name").value,e.insertValue=document.getElementById("input_value").value,e.insertId=document.getElementById("input_id").value,e.insertClass=document.getElementById("input_class").value,e.insertTitle=document.getElementById("input_title").value,e.insertWidth=document.getElementById("input_width").value,e.insertHeight=document.getElementById("input_height").value,e.insertAlign=document.getElementById("input_textalign").value,e.insertDisabled=document.getElementById("input_disabled").checked,e.insertReadonly=document.getElementById("input_readonly").checked,e.insertRows="0"==document.getElementById("input_rows").value?"":document.getElementById("input_rows").value,e.insertCols="0"==document.getElementById("input_cols").value?"":document.getElementById("input_cols").value;for(var t=document.getElementById("event_table"),n=t.childNodes.length,r=0;r<n;r++){var i=t.childNodes[r].getElementsByTagName("span");e.insertEventNameArr.push(i[0].innerHTML),e.insertEventFunctionArr.push(i[1].innerHTML)}LayerWin.event_dext_insert_input_textarea(e,window.frameElement.parentNode.parentNode)}function set_modify_field_input_textarea(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name),""!=elemModify.value&&(document.getElementById("input_value").value=elemModify.value),""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id),""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className),""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title),""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10)),""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10)),""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign),elemModify.disabled&&(document.getElementById("input_disabled").checked=!0),elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0),""!=elemModify.rows&&(document.getElementById("input_rows").value=elemModify.rows),""!=elemModify.cols&&(document.getElementById("input_cols").value=elemModify.cols);if(elemModify.getAttribute("dext5customdata")){var e=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==e.type){var t=e.eventFunction,e=e.eventName.split(""),t=t.split(""),n=e.length;for(i=0;i<n;i++){var r=document.getElementById("event_table"),s=document.createElement("tr"),o=document.createElement("td");o.className="type2";var u=document.createElement("a"),a=document.createElement("span");a.innerHTML=e[i],u.appendChild(a),u.title=e[i],a=document.createElement("td"),a.className="type2",a.style.width="65%";var f=document.createElement("a"),l=document.createElement("span");l.innerHTML=t[i],f.appendChild(l),f.title=t[i],o.appendChild(u),s.appendChild(o),a.appendChild(f),s.appendChild(a),r.appendChild(s)}}}}function dext_modify_input_textarea(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),""!=document.getElementById("input_value").value?(elemModify.value=document.getElementById("input_value").value,elemModify.innerHTML=document.getElementById("input_value").value):(elemModify.value="",elemModify.innerHTML=""),""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id"),""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class"),""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title"),""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="",""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="",""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="",elemModify.disabled=document.getElementById("input_disabled").checked,elemModify.readOnly=document.getElementById("input_readonly").checked,""!=document.getElementById("input_rows").value&&"0"!=document.getElementById("input_rows").value?elemModify.rows=document.getElementById("input_rows").value:elemModify.removeAttribute("rows"),""!=document.getElementById("input_cols").value&&"0"!=document.getElementById("input_cols").value?elemModify.cols=document.getElementById("input_cols").value:elemModify.removeAttribute("cols");if(""!=document.getElementById("input_name").value)if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)elemModify.setAttribute("name",document.getElementById("input_name").value);else{var e=elemModify.outerHTML,e=e.replace('name="'+elemModify.name+'"',""),e=e.replace("name='"+elemModify.name+"'",""),e=e.replace("name="+elemModify.name,""),e=e.replace(">",' name="'+document.getElementById("input_name").value+'" >');elemModify.outerHTML=e}else elemModify.removeAttribute("name");var t=document.getElementById("event_table"),n=t.childNodes.length;if(0<n){for(var r=e="",i=0;i<n;i++)0!=i&&(e+="",r+=""),e+=t.childNodes[i].getElementsByTagName("span")[0].innerHTML,r+=t.childNodes[i].getElementsByTagName("span")[1].innerHTML;""!=e&&(t={type:"event"},t.eventName=e,t.eventFunction=r,LayerWin.setDextCustomData(elemModify,t))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,event_dext_close()}function dext_insert_input_hidden(){var e={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};e.insertName=document.getElementById("input_name").value,e.insertValue=document.getElementById("input_value").value,e.insertId=document.getElementById("input_id").value,e.insertClass=document.getElementById("input_class").value,e.insertTitle=document.getElementById("input_title").value,LayerWin.event_dext_insert_input_hidden(e,window.frameElement.parentNode.parentNode)}function set_modify_field_input_hidden(){var e=elemModify.getAttribute("dext5customdata");null!=e&&void 0!=e&&(e=LayerWin.getDextCustomData(e),""!=e.id&&(document.getElementById("input_id").value=e.id),""!=e.name&&(document.getElementById("input_name").value=e.name),""!=e.value&&(document.getElementById("input_value").value=e.value),""!=e.className&&(document.getElementById("input_class").value=e.className),""!=e.title&&(document.getElementById("input_title").value=e.title))}function dext_modify_input_hidden(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};e.insertName=document.getElementById("input_name").value,e.insertValue=document.getElementById("input_value").value,e.insertId=document.getElementById("input_id").value,e.insertClass=document.getElementById("input_class").value,e.insertTitle=document.getElementById("input_title").value,LayerWin.event_dext_insert_input_hidden(e,window.frameElement.parentNode.parentNode)}function dext_insert_input_image(){var e=document.dext_upload_form,t;t=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var n=document.getElementById("img_web_url"),n=document.getElementsByName("InputFlag")[0].checked?t.value:n.value;if(0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowImageFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}1==i?document.getElementsByName("InputFlag")[0].checked?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(e=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&e.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),e.setItem("document_domain",document.getElementById("document_domain").value),e.setItem("proxy_url",document.getElementById("proxy_url").value),e.setItem("uploadtype",document.getElementById("uploadtype").value),e.setItem("savefilename",document.getElementById("savefilename").value),e.setItem("savefileext",document.getElementById("savefileext").value),e.setItem("serverdomain",document.getElementById("serverdomain").value),e.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),e.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),e.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),e.setItem("image_convert_format",document.getElementById("image_convert_format").value),e.setItem("image_convert_width",document.getElementById("image_convert_width").value),e.setItem("image_convert_height",document.getElementById("image_convert_height").value),e.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&e.setItem("originalfilename",document.getElementById("originalfilename").value),e.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(e),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.id,fileObj:G_dragDropFileObj,formData:e},event_dext_input_image_upload_completed)):(e.action=document.getElementById("upload_url").value,e.submit())):event_dext_input_image_upload_completed(n):alert(o)}else alert(LayerWin.dext5_lang.msg.alert_exec)}function event_dext_input_image_upload_completed(e,t){var n=document.getElementById("input_width").value,r=document.getElementById("input_height").value,i=0,s=0;if(null!=e&&void 0!=e){e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,"");if((e=e.replace(/\t/g,""))&&""!=e)try{var o;o="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=o&&void 0!=o&&(e=o)}catch(u){}o=e.split("?"),2==o.length&&(e=o[0],o=o[1].split("^"),2==o.length?(i=o[0],s=o[1]):3==o.length&&(i=o[0],s=o[1],e+="?"+o[2]));if(elemModify&&"input"==elemModify.tagName.toLowerCase()&&"image"==elemModify.type){elemModify.src=e;return}if("1"==LayerWin._dext_editor._config.image_auto_fit&&i>LayerWin._dext_editor._defaultWidth)o=LayerWin._dext_editor._defaultWidth/i,i=LayerWin._dext_editor._defaultWidth,s*=o;else if("2"==LayerWin._dext_editor._config.image_auto_fit&&(i>LayerWin._dext_editor._defaultWidth||s>LayerWin._dext_editor._defaultHeight)){n=LayerWin._dext_editor._defaultWidth,r=LayerWin._dext_editor._defaultHeight,o=r/n;var a=s/i;a>o?s>r?n=Math.round(i*r/s):(n=i,r=s):a<o?i>n?r=Math.round(s*n/i):(n=i,r=s):(n=i,r=s)}}0==n.length&&0<i&&(n=parseInt(i),r=parseInt(s)),loading_image_show(!1);if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:e,response:t.response})))return}catch(f){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))){if(i=confirm(LayerWin.dext5_lang.msg.uploadFailed))i=e.indexOf("HTTP Error"),s=e.indexOf("HTTP Status"),-1<i?alert(e.substring(i,i+16)):-1<s&&alert(e.substring(s,s+15))}else if("[FAIL]"==e.substring(0,6))(i=confirm(LayerWin.dext5_lang.msg.uploadFailed))&&alert(e);else{e=web_url_remove_char(e),i={insertName:"",insertValue:"",insertSrc:e,insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"image",insertEventNameArr:[],insertEventFunctionArr:[]},i.insertName=document.getElementById("input_name").value,i.insertValue=document.getElementById("input_value").value,i.insertId=document.getElementById("input_id").value,i.insertClass=document.getElementById("input_class").value,i.insertTitle=document.getElementById("input_title").value,i.insertAlign=document.getElementById("input_textalign").value,i.insertWidth=n,i.insertHeight=r,i.insertDisabled=document.getElementById("input_disabled").checked,s=document.getElementById("event_table"),n=s.childNodes.length;for(r=0;r<n;r++)o=s.childNodes[r].getElementsByTagName("span"),i.insertEventNameArr.push(o[0].innerHTML),i.insertEventFunctionArr.push(o[1].innerHTML);LayerWin.event_dext_insert_input_image(i,window.frameElement.parentNode.parentNode)}}function set_modify_field_input_image(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name),elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value")),""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id),""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className),""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title),""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.align),""==elemModify.style.width.replace("px","")?document.getElementById("input_width").value=parseInt(elemModify.width,10):document.getElementById("input_width").value=elemModify.style.width.replace("px",""),""==elemModify.style.height.replace("px","")?document.getElementById("input_height").value=parseInt(elemModify.height,10):document.getElementById("input_height").value=elemModify.style.height.replace("px",""),elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);var e=elemModify.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")),t="";e&&0<e.length&&(t=e[0].replace("src=",""),t=t.replace(/\'/g,""),t=t.replace(/\"/g,""),t=t.replace(/\&amp;/g,"&")),document.getElementById("img_web_url").value=t;var n=document.getElementById("img_ratio"),r=document.getElementById("input_width"),s=document.getElementById("input_height"),o,u;o=r.value,u=s.value,r.value=Math.round(o),s.value=Math.round(u),"1"==LayerWin._dext_editor._config.allowImgSize&&(n.style.display="block",n.className="img_link_active_btn",n.setAttribute("ratio-checked","true")),DEXTTOP.DEXT5.util.addEvent(r,"keyup",function(){if("true"==n.getAttribute("ratio-checked")){var e=parseInt(u,10)*parseInt(r.value,10)/parseInt(o,10);s.value=isNaN(e)?s.value:Math.round(e)}}),DEXTTOP.DEXT5.util.addEvent(s,"keyup",function(){if("true"==n.getAttribute("ratio-checked")){var e=parseInt(o,10)*parseInt(s.value,10)/parseInt(u,10);r.value=isNaN(e)?r.value:Math.round(e)}});if(elemModify.getAttribute("dext5customdata")&&(e=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==e.type)){var t=e.eventFunction,e=e.eventName.split(""),t=t.split(""),a=e.length;for(i=0;i<a;i++){var f=document.getElementById("event_table"),l=document.createElement("tr"),c=document.createElement("td");c.className="type2";var h=document.createElement("a"),p=document.createElement("span");p.innerHTML=e[i],h.appendChild(p),h.title=e[i],p=document.createElement("td"),p.className="type2",p.style.width="65%";var d=document.createElement("a"),v=document.createElement("span");v.innerHTML=t[i],d.appendChild(v),d.title=t[i],c.appendChild(h),l.appendChild(c),p.appendChild(d),l.appendChild(p),f.appendChild(l)}}"1"==Dext5LayerWin._dext_editor._config.uploadUseHTML5&&(e=document.getElementById("radio_image_url"),document.getElementById("radio_image").removeAttribute("checked"),e.setAttribute("checked","checked"),InputFlag_change(e))}function dext_modify_input_image(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e=document.getElementById(file_field_id);e.value&&""!=e.value&&dext_insert_input_image(),e=document.getElementById(file_field_id),e.value&&""!=e.value||"1"==Dext5LayerWin._dext_editor._config.uploadUseHTML5&&G_dragDropFileObj?dext_insert_input_image():(e=document.getElementById("img_web_url"),elemModify.src=e.value),""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value"),""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id"),""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class"),""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title"),""!=document.getElementById("input_textalign").value?elemModify.align=document.getElementById("input_textalign").value:elemModify.removeAttribute("align"),""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="",""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="",elemModify.disabled=document.getElementById("input_disabled").checked,""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(e=elemModify.outerHTML,e=e.replace('name="'+elemModify.name+'"',""),e=e.replace("name='"+elemModify.name+"'",""),e=e.replace("name="+elemModify.name,""),e=e.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=e):elemModify.removeAttribute("name");var t=document.getElementById("event_table"),n=t.childNodes.length;if(0<n){for(var r=e="",i=0;i<n;i++)0!=i&&(e+="",r+=""),e+=t.childNodes[i].getElementsByTagName("span")[0].innerHTML,r+=t.childNodes[i].getElementsByTagName("span")[1].innerHTML;""!=e&&(t={type:"event"},t.eventName=e,t.eventFunction=r,LayerWin.setDextCustomData(elemModify,t))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,event_dext_close()}function event_dext_horizontal_line_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_image_upload_cancel(){"1"==LayerWin._dext_editor._config.uploadUseHTML5&&"function"==typeof uploadAjaxOnprogressCancel&&uploadAjaxOnprogressCancel(),LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode);if("undefined"!=typeof elemModify)try{LayerWin.contentChangeEventWrapper()}catch(e){}}function event_dext_bg_image_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_flash_upload_cancel(){clearWindow(window),LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_media_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_table_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_doc_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_emoticon_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_about_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_close(e){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_insert_datetime_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_insert_datetime(e){LayerWin.command_insert_datetime(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,e)}function clearWindow(e){e.document.open("text/html","replace"),isCustomDomain()&&(e.document.domain=LayerWin.document.domain),e.document.write("<html><head></head><body></body></html>"),e.document.close()}function isCustomDomain(){if(!DEXTTOP.DEXT5.browser.ie)return!1;var e=LayerWin.document.domain,t=window.location.hostname;return e!=t&&e!="["+t+"]"}function setCursorPos(e,t,n){null!=e&&void 0!=e&&null==navigator.userAgent.match(/iPhone|iPad/)&&setTimeout(function(){var r=0;e.value&&(r=e.value.length);try{if(0!=r&&0!=t)if("setSelectionRange"in e)n?e.setSelectionRange(0,r):e.setSelectionRange(r,r);else if("createTextRange"in e){var i=e.createTextRange();n||i.moveStart("character",r),i.select()}e.focus()}catch(s){}},0)}function event_tab(e,t){9==("which"in e?e.which:e.keyCode)&&"last"==(e.target?e.target:e.srcElement).getAttribute("last_cursor_obj")&&(setCursorPos(t,!0,!1),DEXTTOP.DEXT5.util.cancelEvent(e))}function edgeClick(e,t){LayerWin._dext_editor.applyEdgeMode="user",edgeSelectClick(4,"user");var n=document.getElementById("topcell1"),r=document.getElementById("topcell2"),i=document.getElementById("bottomcell1"),s=document.getElementById("bottomcell2");document.getElementById("edge_top"),document.getElementById("edge_horizon"),document.getElementById("edge_bottom"),document.getElementById("edge_left"),document.getElementById("edge_vertical"),document.getElementById("edge_right");var o=document.getElementById("edge_"+e).src.split("/");if(o[o.length-1]=="editor_line_"+e+"_d_img.gif")document.getElementById("edge_"+e).src="../images/editor/dialog/editor_line_"+e+"_img.gif",o="",o=""==document.getElementById("line_kind").value?o+(document.getElementById("line_thickness").value+"px"):o+document.getElementById("line_kind").value,o+=" "+document.getElementById("line_style").style.borderTopStyle,o+=" "+document.getElementById("line_color").style.borderTopColor,"top"==e?(n&&(n.style.borderTop=o,cellRemoveClass(n,"dext_cell_border_t")),r&&(r.style.borderTop=o,cellRemoveClass(r,"dext_cell_border_t"))):"horizon"==e?(i&&(n.style.borderBottom=o,i.style.borderTop=o,cellRemoveClass(n,"dext_cell_border_b"),cellRemoveClass(i,"dext_cell_border_t")),s&&(r.style.borderBottom=o,s.style.borderTop=o,cellRemoveClass(r,"dext_cell_border_b"),cellRemoveClass(s,"dext_cell_border_t"))):"bottom"==e?i?(i.style.borderBottom=o,cellRemoveClass(i,"dext_cell_border_b"),s&&(s.style.borderBottom=o,cellRemoveClass(s,"dext_cell_border_b"))):(n&&(n.style.borderBottom=o,cellRemoveClass(n,"dext_cell_border_b")),r&&(r.style.borderBottom=o,cellRemoveClass(r,"dext_cell_border_b"))):"left"==e?(n&&(n.style.borderLeft=o,cellRemoveClass(n,"dext_cell_border_l")),i&&(i.style.borderLeft=o,cellRemoveClass(i,"dext_cell_border_l"))):"vertical"==e?(r&&(n.style.borderRight=o,r.style.borderLeft=o,cellRemoveClass(n,"dext_cell_border_r"),cellRemoveClass(r,"dext_cell_border_l")),s&&(i.style.borderRight=o,s.style.borderLeft=o,cellRemoveClass(i,"dext_cell_border_r"),cellRemoveClass(s,"dext_cell_border_l"))):"right"==e&&(r?(r.style.borderRight=o,cellRemoveClass(r,"dext_cell_border_r"),s&&(s.style.borderRight=o,cellRemoveClass(s,"dext_cell_border_r"))):(n&&(n.style.borderRight=o,cellRemoveClass(n,"dext_cell_border_r")),i&&(i.style.borderRight=o,cellRemoveClass(i,"dext_cell_border_r"))));else if(o[o.length-1]=="editor_line_"+e+"_img.gif"){document.getElementById("edge_"+e).src="../images/editor/dialog/editor_line_"+e+"_d_img.gif";var u=o="";t||(o="1px solid rgb(0, 0, 0)",u="1px"),"top"==e?(n&&(n.style.borderTop=o,n.style.borderTopWidth=u,t&&cellAddClass(n,"dext_cell_border_t")),r&&(r.style.borderTop=o,r.style.borderTopWidth=u,t&&cellAddClass(r,"dext_cell_border_t"))):"horizon"==e?(i&&(n.style.borderBottom=o,i.style.borderTop=o,n.style.borderBottomWidth=u,i.style.borderTopWidth=u,t&&(cellAddClass(n,"dext_cell_border_b"),cellAddClass(i,"dext_cell_border_t"))),s&&(r.style.borderBottom=o,s.style.borderTop=o,r.style.borderBottomWidth=u,s.style.borderTopWidth=u,t&&(cellAddClass(r,"dext_cell_border_b"),cellAddClass(s,"dext_cell_border_t")))):"bottom"==e?i?(i.style.borderBottom=o,i.style.borderBottomWidth=u,t&&cellAddClass(i,"dext_cell_border_b"),s&&(s.style.borderBottom=o,s.style.borderBottomWidth=u,t&&cellAddClass(s,"dext_cell_border_b"))):(n&&(n.style.borderBottom=o,n.style.borderBottomWidth=u,t&&cellAddClass(n,"dext_cell_border_b")),r&&(r.style.borderBottom=o,r.style.borderBottomWidth=u,t&&cellAddClass(r,"dext_cell_border_b"))):"left"==e?(n&&(n.style.borderLeft=o,n.style.borderLeftWidth=u,t&&cellAddClass(n,"dext_cell_border_l")),i&&(i.style.borderLeft=o,i.style.borderLeftWidth=u,t&&cellAddClass(i,"dext_cell_border_l"))):"vertical"==e?(r&&(n.style.borderRight=o,r.style.borderLeft=o,n.style.borderRightWidth=u,r.style.borderLeftWidth=u,t&&(cellAddClass(n,"dext_cell_border_r"),cellAddClass(r,"dext_cell_border_l"))),s&&(i.style.borderRight=o,s.style.borderLeft=o,i.style.borderRightWidth=u,s.style.borderLeftWidth=u,t&&(cellAddClass(i,"dext_cell_border_r"),cellAddClass(s,"dext_cell_border_l")))):"right"==e&&(r?(r.style.borderRight=o,r.style.borderRightWidth=u,t&&cellAddClass(r,"dext_cell_border_r"),s&&(s.style.borderRight=o,s.style.borderRightWidth=u,t&&cellAddClass(s,"dext_cell_border_r"))):(n&&(n.style.borderRight=o,n.style.borderRightWidth=u,t&&cellAddClass(n,"dext_cell_border_r")),i&&(i.style.borderRight=o,i.style.borderRightWidth=u,t&&cellAddClass(i,"dext_cell_border_r"))))}}function cellRemoveClass(e,t){var n=e.className+" ",r=new RegExp(t+" ","g");r.test(n)&&(n=LayerWin.DEXTTOP.DEXT5.util.trim(n.replace(r," ")),n=n.replace(/\s{2,}/g," "),e.className=n),""==e.className&&e.removeAttribute("class")}function cellAddClass(e,t){0==(new RegExp(t+" ","g")).test(e.className+" ")&&(e.className+=" "+t)}function edgeNoneTotalClick(e,t){if("user"!=e){var n="";if(""==document.getElementById("line_kind").value){if(""==document.getElementById("line_thickness").value)return;n+=document.getElementById("line_thickness").value+"px"}else n+=document.getElementById("line_kind").value;var n=n+(" "+document.getElementById("line_style").style.borderTopStyle),n=n+(" "+document.getElementById("line_color").style.borderTopColor),r=document.getElementById("topcell1"),i=document.getElementById("topcell2"),s=document.getElementById("bottomcell1"),o=document.getElementById("bottomcell2"),u=document.getElementById("edge_top"),a=document.getElementById("edge_horizon"),f=document.getElementById("edge_bottom"),l=document.getElementById("edge_left"),c=document.getElementById("edge_vertical"),h=document.getElementById("edge_right");"total"==e?(u&&(u.src="../images/editor/dialog/editor_line_top_img.gif"),a&&(a.src="../images/editor/dialog/editor_line_horizon_img.gif"),f&&(f.src="../images/editor/dialog/editor_line_bottom_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_left_img.gif"),c&&(c.src="../images/editor/dialog/editor_line_vertical_img.gif"),h&&(h.src="../images/editor/dialog/editor_line_right_img.gif"),r&&(r.style.borderTop=n,r.style.borderBottom=n,r.style.borderRight=n,r.style.borderLeft=n,cellRemoveClass(r,"dext_cell_border_l"),cellRemoveClass(r,"dext_cell_border_r"),cellRemoveClass(r,"dext_cell_border_t"),cellRemoveClass(r,"dext_cell_border_b")),i&&(i.style.borderTop=n,i.style.borderLeft=n,i.style.borderRight=n,i.style.borderBottom=n,cellRemoveClass(i,"dext_cell_border_l"),cellRemoveClass(i,"dext_cell_border_r"),cellRemoveClass(i,"dext_cell_border_t"),cellRemoveClass(i,"dext_cell_border_b")),s&&(s.style.borderTop=n,s.style.borderBottom=n,s.style.borderRight=n,s.style.borderLeft=n,cellRemoveClass(s,"dext_cell_border_l"),cellRemoveClass(s,"dext_cell_border_r"),cellRemoveClass(s,"dext_cell_border_t"),cellRemoveClass(s,"dext_cell_border_b")),o&&(o.style.borderTop=n,o.style.borderLeft=n,o.style.borderRight=n,o.style.borderBottom=n,cellRemoveClass(o,"dext_cell_border_l"),cellRemoveClass(o,"dext_cell_border_r"),cellRemoveClass(o,"dext_cell_border_t"),cellRemoveClass(o,"dext_cell_border_b"))):"inside"==e?(u&&(u.src="../images/editor/dialog/editor_line_top_img.gif",edgeClick("top",t)),f&&(f.src="../images/editor/dialog/editor_line_bottom_img.gif",edgeClick("bottom",t)),l&&(l.src="../images/editor/dialog/editor_line_left_img.gif",edgeClick("left",t)),h&&(h.src="../images/editor/dialog/editor_line_right_img.gif",edgeClick("right",t)),edgeSelectClick(2,"inside"),a&&(a.src="../images/editor/dialog/editor_line_horizon_img.gif"),c&&(c.src="../images/editor/dialog/editor_line_vertical_img.gif"),r&&i&&(r.style.borderRight=n,i.style.borderLeft=n,cellRemoveClass(r,"dext_cell_border_r"),cellRemoveClass(i,"dext_cell_border_l")),s&&o&&(s.style.borderRight=n,o.style.borderLeft=n,cellRemoveClass(s,"dext_cell_border_r"),cellRemoveClass(o,"dext_cell_border_l")),r&&s&&(r.style.borderBottom=n,s.style.borderTop=n,cellRemoveClass(r,"dext_cell_border_b"),cellRemoveClass(s,"dext_cell_border_t")),i&&o&&(i.style.borderBottom=n,o.style.borderTop=n,cellRemoveClass(i,"dext_cell_border_b"),cellRemoveClass(o,"dext_cell_border_t"))):"outside"==e?(a&&(a.src="../images/editor/dialog/editor_line_horizon_img.gif",edgeClick("horizon",t)),c&&(c.src="../images/editor/dialog/editor_line_vertical_img.gif",edgeClick("vertical",t)),edgeSelectClick(1,"outside"),u&&(u.src="../images/editor/dialog/editor_line_top_img.gif"),f&&(f.src="../images/editor/dialog/editor_line_bottom_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_left_img.gif"),h&&(h.src="../images/editor/dialog/editor_line_right_img.gif"),r&&i?(r.style.borderTop=n,r.style.borderLeft=n,i.style.borderTop=n,i.style.borderRight=n,cellRemoveClass(r,"dext_cell_border_t"),cellRemoveClass(r,"dext_cell_border_l"),cellRemoveClass(i,"dext_cell_border_t"),cellRemoveClass(i,"dext_cell_border_r")):r&&(r.style.borderTop=n,r.style.borderLeft=n,r.style.borderRight=n,cellRemoveClass(r,"dext_cell_border_t"),cellRemoveClass(r,"dext_cell_border_l"),cellRemoveClass(r,"dext_cell_border_r")),s&&o?(s.style.borderLeft=n,s.style.borderBottom=n,o.style.borderRight=n,o.style.borderBottom=n,cellRemoveClass(s,"dext_cell_border_l"),cellRemoveClass(s,"dext_cell_border_b"),cellRemoveClass(o,"dext_cell_border_r"),cellRemoveClass(o,"dext_cell_border_b")):s?(s.style.borderLeft=n,s.style.borderRight=n,s.style.borderBottom=n,cellRemoveClass(s,"dext_cell_border_l"),cellRemoveClass(s,"dext_cell_border_r"),cellRemoveClass(s,"dext_cell_border_b")):(r&&(r.style.borderBottom=n,cellRemoveClass(r,"dext_cell_border_b")),i&&(i.style.borderBottom=n,cellRemoveClass(i,"dext_cell_border_b")))):"none"==e&&(u&&(u.src="../images/editor/dialog/editor_line_top_d_img.gif"),a&&(a.src="../images/editor/dialog/editor_line_horizon_d_img.gif"),f&&(f.src="../images/editor/dialog/editor_line_bottom_d_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_left_d_img.gif"),c&&(c.src="../images/editor/dialog/editor_line_vertical_d_img.gif"),h&&(h.src="../images/editor/dialog/editor_line_right_d_img.gif"),r&&(r.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),i&&(i.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),s&&(s.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),o&&(o.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"))}}function fnLineStyleToggle(){var e=document.getElementById("line_style_list");e.style.display="none"==e.style.display?"block":"none"}function lineStyleChange(){var e=document.getElementById("line_style"),t=document.getElementById("line_thickness");if("hidden"==e.style.borderTopStyle||"none"==e.style.borderTopStyle)t.value="0";else if("solid"!=e.style.borderTopStyle&&"dotted"!=e.style.borderTopStyle&&"dashed"!=e.style.borderTopStyle&&"hidden"!=e.style.borderTopStyle&&"none"!=e.style.borderTopStyle){if(isNaN(parseInt(t.value,10))||3>parseInt(t.value,10))t.value="3"}else if(isNaN(parseInt(t.value,10))||0>=parseInt(t.value,10))t.value="1";edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function lineKindChange(){var e=document.getElementById("line_kind"),t=document.getElementById("line_thickness"),n=document.getElementById("line_thickness_updn_btn");""!=e.value?(t.disabled=!0,n.style.display="none","medium"==e.value?t.value="3":"thin"==e.value?t.value="1":"thick"==e.value&&(t.value="5")):(t.disabled=!1,n.style.display="block"),edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function imgLineKindChange(){var e=document.getElementById("line_kind"),t=document.getElementById("line_thickness"),n=document.getElementById("line_thickness_updn_btn");""!=e.value?(t.disabled=!0,t.value="",n.style.display="none"):(t.disabled=!1,n.style.display="block")}function lineThicknessChange(){var e=document.getElementById("line_thickness");10<e.value&&(e.value=10),edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function cellGapChange(){var e=document.getElementById("cell_gap");10<e.value&&(e.value=10),edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function insideMarginChange(){var e=document.getElementById("cell_inside_margin");10<e.value&&(e.value=10),edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function tableEdgeReduceChange(){edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function getColorHex(e){return-1<e.indexOf("#")?e:LayerWin.DEXTTOP.DEXT5.util.rgb2hex(e)?LayerWin.DEXTTOP.DEXT5.util.rgb2hex(e):"#000000"}function setLineStyleEvt(){var e=document.getElementById("ul_line_style");LayerWin.DEXTTOP.DEXT5.util.addEvent(e,"click",function(e){var t=document.getElementById("line_style");e=LayerWin.getClickCell(e,"li").getElementsByTagName("SPAN")[0],t.style.border="","solid"==e.style.borderTopStyle||"dotted"==e.style.borderTopStyle||"dashed"==e.style.borderTopStyle||"double"==e.style.borderTopStyle||"hidden"==e.style.borderTopStyle||"none"==e.style.borderTopStyle?t.style.borderTop=e.style.borderTop:t.style.border=e.style.border,fnLineStyleToggle(),setCursorPos(document.getElementById("line_style_btn"),!1,!1),lineStyleChange()})}function setCellBorderModifyValue(e){var t=LayerWin.DEXTTOP.G_SELECTED_ELEMENT;if(e){e=LayerWin.GetTableSelectionCells(t);for(var t=e.length,n=!0,r=0;r<t-1;r++){if(e[r].style.borderTopStyle!=e[r+1].style.borderTopStyle||e[r].style.borderTopWidth!=e[r+1].style.borderTopWidth||e[r].style.borderTopColor!=e[r+1].style.borderTopColor){n=!1;break}if(e[r].style.borderRightStyle!=e[r+1].style.borderRightStyle||e[r].style.borderRightWidth!=e[r+1].style.borderRightWidth||e[r].style.borderRightColor!=e[r+1].style.borderRightColor){n=!1;break}if(e[r].style.borderBottomStyle!=e[r+1].style.borderBottomStyle||e[r].style.borderBottomWidth!=e[r+1].style.borderBottomWidth||e[r].style.borderBottomColor!=e[r+1].style.borderBottomColor){n=!1;break}if(e[r].style.borderLeftStyle!=e[r+1].style.borderLeftStyle||e[r].style.borderLeftWidth!=e[r+1].style.borderLeftWidth||e[r].style.borderLeftColor!=e[r+1].style.borderLeftColor){n=!1;break}}n?setModifyValue(e[0].style,!0):setModifyValue(null)}else setModifyValue(t.style,!0)}function setTableBorderModifyValue(e){if("separate"==e.style.borderCollapse)setModifyValue(e.style,!0);else{var t=!0,n=!0,r=!0,i=!0,s,o,u,a;e=LayerWin.getTableBorderCells(e);var f=e.arrTop.length;if(1==f)s=e.arrTop[0].style.borderTop;else for(var l=0;l<f;l++)0!=l&&(e.arrTop[l-1].style.borderTop!=e.arrTop[l].style.borderTop&&(t=!1),l==f-1&&t&&(s=e.arrTop[l].style.borderTop));f=e.arrLeft.length;if(1==f)u=e.arrLeft[0].style.borderLeft;else for(l=0;l<f;l++)0!=l&&(e.arrLeft[l-1].style.borderLeft!=e.arrLeft[l].style.borderLeft&&(i=!1),l==f-1&&i&&(u=e.arrLeft[l].style.borderLeft));f=e.arrRight.length;if(1==f)a=e.arrRight[0].style.borderRight;else for(l=0;l<f;l++)0!=l&&(e.arrRight[l-1].style.borderRight!=e.arrRight[l].style.borderRight&&(r=!1),l==f-1&&r&&(a=e.arrRight[l].style.borderRight));f=e.arrBottom.length;if(1==f)o=e.arrBottom[0].style.borderBottom;else for(l=0;l<f;l++)0!=l&&(e.arrBottom[l-1].style.borderBottom!=e.arrBottom[l].style.borderBottom&&(n=!1),l==f-1&&n&&(o=e.arrBottom[l].style.borderBottom));e=document.createElement("td"),e.style.borderTop=s?s:"1px solid #000000",e.style.borderBottom=o?o:"1px solid #000000",e.style.borderLeft=u?u:"1px solid #000000",e.style.borderRight=a?a:"1px solid #000000",s=!1,e.style.borderTop==e.style.borderRight&&e.style.borderRight==e.style.borderBottom&&e.style.borderBottom==e.style.borderLeft&&t&&n&&r&&i&&(s=!0),setModifyValue(e.style,s)}}function setModifyValue(e,t){if(e){var n=t,r,i,s,o;r=e.borderTopWidth,i=e.borderBottomWidth,s=e.borderRightWidth,o=e.borderLeftWidth,r==i&&i==s&&s==o?-1<r.indexOf("px")?document.getElementById("line_thickness").value=parseInt(r,10):document.getElementById("line_kind").value=r:(document.getElementById("line_thickness").value="1",document.getElementById("line_kind").value=""),r+=" ",i+=" ",s+=" ",o+=" ",e.borderTopStyle==e.borderRightStyle&&e.borderRightStyle==e.borderLeftStyle&&e.borderLeftStyle==e.borderBottomStyle?("solid"==e.borderStyle||"dotted"==e.borderStyle||"dashed"==e.borderStyle||"double"==e.borderStyle||"hidden"==e.borderStyle||"none"==e.borderStyle?document.getElementById("line_style").style.borderTopStyle=e.borderStyle:document.getElementById("line_style").style.borderStyle=e.borderStyle,"solid"!=e.borderTopStyle&&"dotted"!=e.borderTopStyle&&"dashed"!=e.borderTopStyle&&"hidden"!=e.borderTopStyle&&"none"!=e.borderTopStyle?(document.getElementById("line_style").style.borderWidth="3px","double"==e.borderTopStyle?document.getElementById("line_style").style.borderColor="#5d5d5d":document.getElementById("line_style").style.borderColor="#e1e1e1"):(document.getElementById("line_style").style.borderTopWidth="1px",document.getElementById("line_style").style.borderTopColor="#5d5d5d")):(document.getElementById("line_style").style.borderTopStyle="none",n=!1),r+=e.borderTopStyle+" ",i+=e.borderBottomStyle+" ",s+=e.borderRightStyle+" ",o+=e.borderLeftStyle+" ";var u=getColorHex(e.borderTopColor),a=getColorHex(e.borderBottomColor),f=getColorHex(e.borderRightColor),l=getColorHex(e.borderLeftColor);u==a&&a==f&&f==l&&(document.getElementById("line_color").style.borderTopColor=u),r+=u,i+=a,s+=f,o+=l,document.getElementById("edge_border").style.borderTop=r,document.getElementById("edge_border").style.borderBottom=i,document.getElementById("edge_border").style.borderRight=s,document.getElementById("edge_border").style.borderLeft=o,n||edgeNoneTotalClick("none")}else document.getElementById("line_style").style.borderTopStyle="none",edgeNoneTotalClick("none")}function setLayout(e){e=e.replace("te",""),e={num:e},0==LayerWin.DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_layout(e,window.frameElement.parentNode.parentNode):LayerWin.event_dext_layout(e,window.frameElement.parentNode.parentNode)}function event_dext_file_upload_completed(e,t){loading_image_show(!1);if(e&&""!=e){e=e.replace(/<.*?script.*\/?>/g,""),e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,"");try{var n;n="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,e):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,e),null!=n&&void 0!=n&&(e=n)}catch(r){}}if("[FAIL]"==e.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:e,response:t.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:e,response:t.response})))return}catch(i){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<e.indexOf("HTTP Error")||-1<e.indexOf("HTTP Status"))){if(n=confirm(LayerWin.dext5_lang.msg.uploadFailed)){n=e.indexOf("HTTP Error");var s=e.indexOf("HTTP Status");-1<n?alert(e.substring(n,n+16)):-1<s&&alert(e.substring(s,s+15))}}else if("[FAIL]"==e.substring(0,6))(n=confirm(LayerWin.dext5_lang.msg.uploadFailed))&&alert(e);else{n=document.getElementById("file_title").value;var o=document.getElementById("file_text").value;"0"!=LayerWin._dext_editor._config.security.encryptParam&&(o=DEXTTOP.DEXT5.util.makeDecryptReponseMessageFinal(o));var s=document.getElementById("input_id").value,u=document.getElementById("input_class").value;if(""==o)var a=document.getElementById(file_field_id).value,o=getFileName(a);a=e;if(null!=e&void 0!=e){var f=e.split("?");2==f.length&&(a=f[0],f=f[1].split("^"),3==f.length&&(a+="?"+f[2])),""==o&&(o=a.split("/"),o=o[o.length-1])}f=a.substring(a.lastIndexOf(".")+1).toLowerCase(),f=f.toLowerCase(),LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);var l=!1;document.getElementById("continue_insert")&&(l=document.getElementById("continue_insert").checked),n={text:o,url:a,target:"_blank",title:n,type:"hyperlink",type2:"insert_file",file_ext:f,id:s,className:u,continueInsert:l},elemModify&&"a"==elemModify.tagName.toLowerCase()?(elemModify.innerHTML=n.text,elemModify.title=n.title,elemModify.id=n.id,elemModify.className=n.className,elemModify.href=n.url,"1"==LayerWin._dext_editor._config.attachFileImage&&LayerWin.attachFileImage(elemModify,n),LayerWin._dext_editor.UndoManager.putUndo(),event_dext_close()):LayerWin.event_dext_insert_file(n,window.frameElement.parentNode.parentNode)}}function dext_upload_file(){var e=document.dext_upload_form,t;t=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var n=t.value;if(0<n.lastIndexOf(".")){for(var r=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=!1,s=LayerWin._dext_editor._config.allowInsertFileType,o=s.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,u=s.length,a=0;a<u;a++)if(r==s[a]){i=!0;break}s=document.getElementById("file_text_view").value,1==i?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(r),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("savafiletext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(s),document.getElementById("file_text").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(s),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n.substring(n.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=r,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("savafiletext").value=s,document.getElementById("file_text").value=s,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=n.substring(n.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(e=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&e.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),e.setItem("document_domain",document.getElementById("document_domain").value),e.setItem("proxy_url",document.getElementById("proxy_url").value),e.setItem("uploadtype",document.getElementById("uploadtype").value),e.setItem("savefilename",document.getElementById("savefilename").value),e.setItem("savefileext",document.getElementById("savefileext").value),e.setItem("serverdomain",document.getElementById("serverdomain").value),e.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),e.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),e.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),e.setItem("savafiletext",document.getElementById("savafiletext").value),e.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&e.setItem("originalfilename",document.getElementById("originalfilename").value),e.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(e),uploadAjaxOnprogressStart({uploadType:"insert_file",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:t.id,fileObj:G_dragDropFileObj,formData:e},event_dext_file_upload_completed)):(e.action=document.getElementById("upload_url").value,e.submit())):alert(o)}else""!=n?alert(LayerWin.dext5_lang.msg.alert_exec):alert(LayerWin.dext5_lang.msg.alert_no_file)}function getFileName(e){var t="";if(e&&0<e.length)return t=e,e=e.split("\\"),0<e.length&&(t=e[e.length-1]),t}function htmlSpecialChars(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}function dext_upload_open_file(){var e=document.dext_upload_form,t=document.getElementById(file_field_id),n=t.value;if(0<n.lastIndexOf(".")){for(var n=n.substring(n.lastIndexOf(".")+1).toLowerCase(),r=!1,i=["htm","html","txt"],s=i.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,o=i.length,u=0;u<o;u++)if(n==i[u]){r=!0;break}if(1==r){if(0!=DEXTTOP.DEXT5.isEmpty()||0!=confirm(LayerWin.dext5_lang.msg.newDocument))"1"==LayerWin._dext_editor._config.openDocument.useHtml5FileOpen?(loading_image_show(!0),handleFileSelect(t.files)):(t=DEXTTOP.DEXT5.util.makeGuid().toLowerCase(),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(n),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("savefileguid").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(t),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule)):(document.getElementById("savefileext").value=n,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("savefileguid").value=t,document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),loading_image_show(!0),e.action=document.getElementById("upload_url").value,e.submit())}else alert(s)}else alert(LayerWin.dext5_lang.msg.alert_exec)}function event_dext_open_file_upload_completed(e){var t=document.getElementById(file_field_id).value;e={fileExt:t.substring(t.lastIndexOf(".")+1).toLowerCase(),data:e},LayerWin.event_dext_insert_open_file(e,window.frameElement.parentNode.parentNode)}function dext_blockquote(){var e={tagvalue:document.getElementById("tempblockquote").value};LayerWin.event_dext_insert_blockquote(e,window.frameElement.parentNode.parentNode)}function dext_blockquoteCancel(){LayerWin.event_dext_cancel_blockquote(window.frameElement.parentNode.parentNode)}function dext_setAccessibility(e,t){var n=document.getElementById("input_title").value,r=document.getElementById("input_alt").value,i=document.getElementById("chk_skip").checked,s=document.getElementById("input_id").value,o;t.parentNode.cells[1].getElementsByTagName("span")[2]&&(o=t.parentNode.cells[1].getElementsByTagName("span")[2].innerHTML);var u=!1;""==document.getElementById("id_tr").style.display&&(u=!0),LayerWin.event_dext_setAccessibility({title:n,alt:r,skip:i,id:s,idSamMode:u,sameOrgId:o},e,t)}function fileOnchange(e,t){if(t&&(e&&e.files&&0<e.files.length||G_dragDropFileObj)&&DEXTTOP.DEXT5.browser.HTML5Supported){if(""==e.value)return;var n=!1,r=LayerWin.dext5_lang.msg.max_file_size,i=0,i=e&&e.files&&0<e.files.length?e.files[0].size:G_dragDropFileObj[0].size;("image"==t||"m_image"==t||"cell_bg_image"==t||"doc_bg_image"==t||"hyperlink_image"==t||"input_image"==t||"table_bg_image"==t||"p_table_bg_image"==t)&&0!=LayerWin._dext_editor._config.maxImageFileSize&&i>LayerWin._dext_editor._config.maxImageFileSize?(r=r.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxImageFileSize).toString),n=!0):"media"==t&&0!=LayerWin._dext_editor._config.maxMediaFileSize&&i>LayerWin._dext_editor._config.maxMediaFileSize?(r=r.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxMediaFileSize).toString),n=!0):"flash"==t&&0!=LayerWin._dext_editor._config.maxFlashFileSize&&i>LayerWin._dext_editor._config.maxFlashFileSize?(r=r.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxFlashFileSize).toString),n=!0):"insert_file"==t&&0!=LayerWin._dext_editor._config.maxInsertFileSize&&i>LayerWin._dext_editor._config.maxInsertFileSize?(r=r.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxInsertFileSize).toString),n=!0):"video_media"==t&&0!=LayerWin._dext_editor._config.maxVideoFileSize&&i>LayerWin._dext_editor._config.maxVideoFileSize&&(r=r.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxVideoFileSize).toString),n=!0);if(n)return alert(r),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content,G_dragDropFileObj=null):document.getElementById("image_url").value="",e.value="",!0}if(fileDataObj=document.getElementById(LayerWin._dext_editor._config.fileFieldID))fileDataObj&&fileDataObj.value?"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"!=t||void 0==t||(n=getFileName(fileDataObj.value),document.getElementById("file_text").value=n,document.getElementById("file_text_view")&&(document.getElementById("file_text_view").value=n),document.getElementById("input_text")&&(document.getElementById("input_text").value=n)):"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"==t&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)?document.getElementById("file_text").value="":"1"==LayerWin._dext_editor._config.uploadUseHTML5&&G_dragDropFileObj&&(n=G_dragDropFileObj[0].name,document.getElementById("file_text").value=n,document.getElementById("input_text")&&(document.getElementById("input_text").value=n));n=document.getElementById("img_alt"),r=document.getElementById("file_text"),null!=n&&null!=r&&n&&""!=r.value&&(n.value=LayerWin.getFileName(r.value,!0)),t&&e&&e.files&&0<e.files.length&&"1"==LayerWin._dext_editor._config.uploadUseHTML5&&(G_dragDropFileObj=e.files),G_dragDropFileObj&&(document.getElementById("drop_zone").innerHTML=G_dragDropFileObj[0].name,document.getElementById("drop_zone").className="DEXT_fiVe_ED_Popup_DropZoneNoneBackground");var s=!1;-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector&&(n=G_dragDropFileObj?G_dragDropFileObj[0]:e.files[0],r=n.name.split(".").pop(),i=function(){return function(t,n,r){0==r&&(s=!0,e.value="",G_dragDropFileObj=null,document.getElementById("img_alt")&&(document.getElementById("img_alt").value=""),document.getElementById("file_text")&&(document.getElementById("file_text").value=""),document.getElementById("file_text_view")&&(document.getElementById("file_text_view").value=""),document.getElementById("input_text")&&(document.getElementById("input_text").value=""),"1"==LayerWin._dext_editor._config.uploadUseHTML5?1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:document.getElementById("image_url").value="",alert(LayerWin.dext5_lang.msg.message_file_ext_detect))}}(),D5FileDetector(n,r,i));if(("image"==t||"m_image"==t)&&"base64"==LayerWin._dext_editor._config.uploadMethod&&null==elemModify&&(e&&e.files&&0<e.files.length||G_dragDropFileObj)&&"-1"!=LayerWin._dext_editor._config.maxImageBase64fileCount&&LayerWin.getBase64ImageCount()>=parseInt(LayerWin._dext_editor._config.maxImageBase64fileCount,10))r=LayerWin.dext5_lang.msg.max_base64file_count,r=r.replace("{0}",LayerWin._dext_editor._config.maxImageBase64fileCount),alert(r),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content,G_dragDropFileObj=null):document.getElementById("image_url").value="",e.value="";else{document.getElementById("image_url")&&(n=e.value.split("\\"),document.getElementById("image_url").value=n[n.length-1]);try{if(("image"==t||"m_image"==t)&&(e.files&&e.files[0]||e[0])){var o=(window.URL||window.webkitURL||window).createObjectURL(e[0]?e[0]:e.files[0]),u=new Image;u.onload=function(){if(s)document.getElementById("img_width")&&(document.getElementById("img_width").value=""),document.getElementById("img_height")&&(document.getElementById("img_height").value="");else{try{(window.URL||window.webkitURL||window).revokeObjectURL(this.src)}catch(e){}var t=document.getElementById("img_width_unit"),n=document.getElementById("img_height_unit"),r=!1,i=!1;t&&"%"==t.value&&(r=!0),n&&"%"==n.value&&(i=!0),!r&&!i&&(t=u.width,n=u.height,document.getElementById("original_image_width").value=t,document.getElementById("original_image_height").value=n,r=LayerWin._dext_editor._config.imgDefaultWidth,i=LayerWin._dext_editor._config.imgDefaultHeight,""!=r?DEXTTOP.DEXT5.util.parseIntOr0(t)>DEXTTOP.DEXT5.util.parseIntOr0(r)&&(t=DEXTTOP.DEXT5.util.parseIntOr0(n,10)*DEXTTOP.DEXT5.util.parseIntOr0(r,10)/DEXTTOP.DEXT5.util.parseIntOr0(t,10),n=isNaN(t)?n:Math.round(t),t=DEXTTOP.DEXT5.util.parseIntOr0(r)):""!=i&&DEXTTOP.DEXT5.util.parseIntOr0(n)>DEXTTOP.DEXT5.util.parseIntOr0(i)&&(n=DEXTTOP.DEXT5.util.parseIntOr0(t,10)*DEXTTOP.DEXT5.util.parseIntOr0(i,10)/DEXTTOP.DEXT5.util.parseIntOr0(n,10),t=isNaN(n)?t:Math.round(n),n=DEXTTOP.DEXT5.util.parseIntOr0(i)),document.getElementById("img_width").value=t,document.getElementById("img_height").value=n,r=document.getElementById("img_ratio"))&&("true"!=r.getAttribute("ratio-checked")&&r.click(),DEXTTOP.DEXT5.browser.mobile?(r.style.display="none",document.getElementById("img_ratio_view").style.display=""):r.style.display="",addEventImgWidthHeight(t,n)),u=null,u=void 0}},u.src=o}}catch(a){}}}function set_page_table_lock_property(){DEXTTOP.DEXT5.util.addEvent(document.getElementById("ok_btn"),"click",function(){applyTableLockProperty()});var e=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);if(e){var t=LayerWin.checkLockAttr(e,!0),n=document.getElementsByName("table_lock");t?(n[0].checked=!0,n[1].checked=!1):(n[0].checked=!1,n[1].checked=!0),e.getAttribute("lock_mode")&&(r=e.getAttribute("lock_mode")),t=document.getElementsByName("lock_mode"),"1"==r?(t[0].checked=!0,t[1].checked=!1):(t[0].checked=!1,t[1].checked=!0);var r=DEXTTOP.G_CURREDITOR._config.defaultTableLockMode;e.getAttribute("lock_mode")&&(r=e.getAttribute("lock_mode")),t=document.getElementsByName("lock_mode"),"1"==r?(t[0].checked=!0,t[1].checked=!1):(t[0].checked=!1,t[1].checked=!0),r=DEXTTOP.G_CURREDITOR._config.defaultShowLockIconUserMode,e.getAttribute("show_icon")&&(r=e.getAttribute("show_icon")),e=document.getElementsByName("lock_icon_option"),"0"==r?(e[1].checked=!0,e[0].checked=!1):(e[1].checked=!1,e[0].checked=!0)}}function applyTableLockProperty(){var e=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);e&&(document.getElementsByName("table_lock")[0].checked?(LayerWin.setClassName(e,"DEXT_five_table_lock"),e.setAttribute(DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,""),document.getElementsByName("lock_mode")[0].checked?e.setAttribute("lock_mode","1"):e.setAttribute("lock_mode","2"),document.getElementsByName("lock_icon_option")[0].checked?e.setAttribute("show_icon","1"):e.setAttribute("show_icon","0")):(LayerWin.removeLockAttr(e),LayerWin.removeClassName(e,"DEXT_five_table_lock"),e.removeAttribute("lock_mode"),e.removeAttribute("show_icon")),e=LayerWin.getFirstRange().range.startContainer,3==e.nodeType&&(e=e.parentNode),e&&1==e.nodeType&&LayerWin.setMenuIconRealable(e)),event_dext_close()}function setBorderListValue(e,t){switch(e){case"none":t.style.borderTopStyle="none";break;case"solid":t.style.borderTop="1px solid rgb(93, 93, 93)";break;case"dotted":t.style.borderTop="1px dotted rgb(93, 93, 93)";break;case"dashed":t.style.borderTop="1px dashed rgb(93, 93, 93)";break;case"double":t.style.border="3px double rgb(93, 93, 93)";break;case"groove":t.style.border="3px groove rgb(225, 225, 225)";break;case"ridge":t.style.border="3px ridge rgb(225, 225, 225)";break;case"inset":t.style.border="3px inset rgb(225, 225, 225)";break;case"outset":t.style.border="3px outset rgb(225, 225, 225)"}}function paste_to_image_loaded_event(){var e=LayerWin._dext_editor._config.style.skinName;document.getElementById("dext_dialog_box").className="DEXT_fiVe_ED_Popup_Type06 DEXT_fiVe_PUi_"+e;if("0"==LayerWin._dext_editor._config.pasteToImagePopupMode){for(var t=document.querySelectorAll(".con_right"),n=t.length,e=0;e<n;e++)if(t[e].className=t[e].className.replace("con_right","con_left"),t[e].style.width="500px",0==e){t[e].parentNode.style.height="270px";var r=t[e].querySelector("dd");r.style.width="496px",r.style.height="170px",r=t[e].querySelector("canvas"),r.width="496",r.height="170"}e=document.querySelectorAll("fieldset"),e[0].style.display="none",e[1].style.display="none",document.querySelector("#setting_img_format").style.marginTop="55px",t=e[2].querySelectorAll("li"),n=["22%","22%","30%","20%"],r=t.length;for(e=0;e<r;e++)t[e].style.display="inline-block",t[e].style.width=n[e]}for(var t=r=!1,n="",i=document.getElementById("formatList"),e=0;e<DEXTTOP.G_CURREDITOR._config.pasteToImageType.length;e++)0==e&&(n=DEXTTOP.G_CURREDITOR._config.pasteToImageType[e].toLowerCase()),"png"==DEXTTOP.G_CURREDITOR._config.pasteToImageType[e].toLowerCase()?(i.innerHTML+='<li class="Li" style="width:100%;"><input id="image_type_png" name="image_type" type="radio" value="png" /><label for="image_type_png">PNG</label></li>',r=!0):"jpg"==DEXTTOP.G_CURREDITOR._config.pasteToImageType[e].toLowerCase()&&(i.innerHTML+='<li class="Li"><input id="image_type_jpg" name="image_type" type="radio" value="jpg"/><label for="image_type_jpg" style="vertical-align:middle;">JPG</label></li><li class="Li" style = "position:relative;"><label for="image_quality" id="label_quality"></label><div class="no_a" style="position:absolute; right:0; top:0"><input class="con_input" id="image_quality" style="width: 30px; vertical-align:middle;" type="text" /><ul style="vertical-align:middle;"><li id="quality_spinUp"><a style="cursor: pointer; margin:0; padding:0; border:none;" href="javascript:void(0);"><img src="../images/editor/dialog/btn/editor_ta_btn.gif" width="15" height="10" style="margin:0; padding:0;" /></a></li><li id="quality_spinDown"><a style="cursor: pointer;  margin:0; padding:0; border:none;" href="javascript:void(0);"><img src="../images/editor/dialog/btn/editor_ba_btn.gif" width="15" height="10" style="margin:0; padding:0;" /></a></li></ul></div></li>',t=!0);"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&t&&r?"png"==n?(imageType="png",document.getElementById("image_type_png").checked=!0):(imageType="jpeg",document.getElementById("image_type_jpg").checked=!0):"Windows"!=DEXTTOP.DEXT5.UserAgent.os.name||!t&&r?(imageType="png",document.getElementById("image_type_png").checked=!0,t&&(document.getElementById("image_type_jpg").parentNode.style.display="none",document.getElementById("label_quality").parentNode.style.display="none")):t&&!r&&(imageType="jpeg",document.getElementById("image_type_jpg"
).checked=!0);var r=document.getElementById("html_btn"),s=document.getElementById("image_width"),o=document.getElementById("image_height"),u=document.getElementById("image_quality");document.getElementById("span_title").innerHTML=LayerWin.dext5_lang.paste_to_image.title,document.getElementById("span_save_client").innerHTML=LayerWin.dext5_lang.paste_to_image.save_client,document.getElementById("legent_format").innerHTML=LayerWin.dext5_lang.paste_to_image.format,t&&(document.getElementById("label_quality").innerHTML=LayerWin.dext5_lang.paste_to_image.quality),document.getElementById("rotate").innerHTML=LayerWin.dext5_lang.paste_to_image.rotate,document.getElementById("size").innerHTML=LayerWin.dext5_lang.paste_to_image.size,document.getElementById("label_width").innerHTML=LayerWin.dext5_lang.paste_to_image.width,document.getElementById("label_height").innerHTML=LayerWin.dext5_lang.paste_to_image.height,document.getElementById("lock_size_rate").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_size_rate,document.getElementById("span_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.origin_size,document.getElementById("dt_preview").innerHTML=LayerWin.dext5_lang.paste_to_image.preview,document.getElementById("label_lock_size_rate").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_size_rate,document.getElementById("label_lock_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_origin_size,""!=LayerWin._dext_editor._config.buttonText001?document.getElementById("span_insert_image").innerHTML=LayerWin._dext_editor._config.buttonText001:document.getElementById("span_insert_image").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_image,document.getElementById("span_insert_html").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_html,DEXTTOP.DEXT5.util.addEvent(u,"keydown",LayerWin.onlyNumber),DEXTTOP.DEXT5.util.addEvent(u,"blur",function(){100<DEXTTOP.DEXT5.util.parseIntOr0(u.value)?u.value="100":0==DEXTTOP.DEXT5.util.parseIntOr0(u.value)&&(u.value="1")}),DEXTTOP.DEXT5.util.addEvent(s,"keydown",LayerWin.onlyNumber),DEXTTOP.DEXT5.util.addEvent(o,"keydown",LayerWin.onlyNumber),DEXTTOP.DEXT5.util.addEvent(s,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var e=parseInt(v,10)*parseInt(s.value,10)/parseInt(d,10);o.value=isNaN(e)?o.value:Math.round(e)}}),DEXTTOP.DEXT5.util.addEvent(o,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var e=parseInt(d,10)*parseInt(o.value,10)/parseInt(v,10);s.value=isNaN(e)?s.value:Math.round(e)}}),DEXTTOP.DEXT5.util.addEvent(document.getElementById("span_origin_size").parentNode,"click",function(){s.value=d,o.value=v}),DEXTTOP.DEXT5.util.addEvent(document.getElementById("lock_origin_size"),"click",function(){document.getElementById("lock_origin_size").checked?(s.value=parseInt(document.getElementById("original_img_width").value,10),o.value=parseInt(document.getElementById("original_img_height").value,10),s.disabled=!0,o.disabled=!0):(s.disabled=!1,o.disabled=!1)}),DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinUp"),"click",function(){0==u.disabled&&LayerWin.click_plus_func(document.getElementById("image_quality"),100,10)}),DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinDown"),"click",function(){0==u.disabled&&LayerWin.click_minus_func(document.getElementById("image_quality"),1,10)});var a=document.getElementById("canvas_preview"),f=a.getContext("2d"),l=window.URL||window.webkitURL||window,i=l.createObjectURL(DEXTTOP.G_CURREDITOR.clipImageBlob),c=new Image,h,p,d,v,m=0,g=0,y=1,b={type:"",width:0,height:0,checkOriginSize:!1};0==DEXTTOP.G_CURREDITOR.bTextorHtmlData&&(document.getElementById("html_btn").style.display="none",r=document.getElementById("image_btn")),DEXTTOP.DEXT5.util.addEvent(document.getElementById("image_btn"),"click",function(){for(var e=0,t=document.getElementsByName("image_rotate"),n=t.length,r=0;r<n;r++)if(t[r].checked){e=DEXTTOP.DEXT5.util.parseIntOr0(t[r].value);break}t=1,"jpeg"==imageType&&0==u.disabled&&(t=1*DEXTTOP.DEXT5.util.parseIntOr0(u.value)/100);var i=function(e){e&&(DEXTTOP.G_CURREDITOR.clipImageBlob=e),b.type="image",b.width=DEXTTOP.DEXT5.util.parseIntOr0(s.value),b.height=DEXTTOP.DEXT5.util.parseIntOr0(o.value),b.checkOriginSize=document.getElementById("lock_origin_size").checked,e=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("original_img_width").value);var t=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("original_img_height").value);b.checkOriginSize&&(b.width=e,b.height=t),LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,b),c=void 0,event_dext_close()};0!=e||1!=t||"png"!=imageType?(a.style.display="none",90==e||270==e?(n=c.height,r=c.width):(n=c.width,r=c.height),a.width=n,a.height=r,f.save(),"png"!=imageType&&(f.fillStyle="white",f.fillRect(0,0,a.width,a.height)),f.translate(a.width/2,a.height/2),f.rotate(e*Math.PI/180),"png"==imageType&&f.clearRect(0,0,a.width,a.height),f.drawImage(c,-c.width/2,-c.height/2,c.width,c.height),f.restore(),a.toBlob(function(e){i(e)},"image/"+imageType,t)):i()}),DEXTTOP.DEXT5.util.addEvent(document.getElementById("html_btn"),"click",function(){b.type="html",LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,b),c=void 0,event_dext_close(),DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode&&LayerWin.DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)});for(var w=document.getElementsByName("image_rotate"),E=w.length,e=0;e<E;e++){var S=function(e){return function(t){t=DEXTTOP.DEXT5.util.parseIntOr0(w[e].value),f.save(),f.clearRect(0,0,a.width,a.height),f.translate(a.width/2,a.height/2),f.rotate(t*Math.PI/180),f.drawImage(c,-h/2,-p/2,h,p),f.restore();var n;90==t||270==t?(t=c.height,n=c.width,d=c.height,v=c.width):(t=c.width,n=c.height,d=c.width,v=c.height),s.value=t,o.value=n}}(e);DEXTTOP.DEXT5.util.addEvent(w[e],"click",S)}for(var x=document.getElementsByName("image_type"),E=x.length,e=0;e<E;e++)S=function(e){return function(t){t=x[e].value,"jpg"==t?(imageType="jpeg",u.disabled=!1):(imageType=t,u.disabled=!0)}}(e),DEXTTOP.DEXT5.util.addEvent(x[e],"click",S);t&&(u.value="100"),"jpg"==n?(setCursorPos(document.getElementById("image_type_jpg"),!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_jpg"),r)):(setCursorPos(document.getElementById("image_type_png"),!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_png"),r)),function(e){c.onload=function(){DEXTTOP.G_CURREDITOR=LayerWin._dext_editor,d=c.width,v=c.height,document.getElementById("original_img_width").value=c.width,document.getElementById("original_img_height").value=c.height;var t=LayerWin._dext_editor._config.imgDefaultWidth,n=LayerWin._dext_editor._config.imgDefaultHeight;""!=t?DEXTTOP.DEXT5.util.parseIntOr0(d)>DEXTTOP.DEXT5.util.parseIntOr0(t)&&(n=DEXTTOP.DEXT5.util.parseIntOr0(v,10)*DEXTTOP.DEXT5.util.parseIntOr0(t,10)/DEXTTOP.DEXT5.util.parseIntOr0(d,10),v=isNaN(n)?v:Math.round(n),d=DEXTTOP.DEXT5.util.parseIntOr0(t)):""!=n&&DEXTTOP.DEXT5.util.parseIntOr0(v)>DEXTTOP.DEXT5.util.parseIntOr0(n)&&(t=DEXTTOP.DEXT5.util.parseIntOr0(d,10)*DEXTTOP.DEXT5.util.parseIntOr0(n,10)/DEXTTOP.DEXT5.util.parseIntOr0(v,10),d=isNaN(t)?d:Math.round(t),v=DEXTTOP.DEXT5.util.parseIntOr0(n)),s.value=d,o.value=v,y=Math.min(a.width/d,a.height/v),1>y?(h=Math.round(d*y),p=Math.round(v*y)):(h=d,p=v,y=1),h<a.width&&(m=(a.width-h)/2),p<a.height&&(g=(a.height-p)/2),f.drawImage(c,m,g,h,p);try{l.revokeObjectURL(e)}catch(r){}},c.src=e}(i)}function dext_create_conversion(){var e={text:document.getElementById("targetContent").value};LayerWin.event_dext_create_conversion(e,window.frameElement.parentNode.parentNode)}function dext_calculator(){var e=document.getElementById("valueText");LayerWin.event_dext_calculator(e.value,window.frameElement.parentNode.parentNode)}function dext_insert_placeholder(){var e={notice:""};e.notice=document.getElementById("input_notice").value,LayerWin.event_dext_insert_placeholder(e,window.frameElement.parentNode.parentNode)}function dext_load_auto_save_open(e,t,n){return LayerWin.event_dext_load_auto_save_open(e,t,n)}function dext_load_auto_save(){LayerWin.event_dext_load_auto_save(g_currHtml,window.frameElement.parentNode.parentNode)}function dext_load_auto_save_del(e,t,n,r){e="dext_"+e,""!=t&&(e+="_"+t),LayerWin.event_dext_load_auto_save_del(e,n,window.frameElement.parentNode.parentNode,r)}function dext_load_auto_save_setDateList(){var e=dext_load_auto_save_open(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount);if(null!=e&&void 0!=e&&0<e.length)for(var t=document.getElementById("ul_date"),n=e.length-1;0<=n;n--){var r=document.createElement("li");r.style.cursor="pointer";var i=document.createElement("span");i.className="icon";var s=document.createElement("img");s.src="../images/bg/editor_popup_close_bg.gif",s.width="10",s.height="10",s.style.cursor="pointer",i.appendChild(s);var o=document.createElement("span");o.className="text";var s=e[n].date.split(" "),u=s[0].split("/");o.innerHTML=u[2]+"/"+u[0]+"/"+u[1]+" "+s[1],s=document.createElement("a"),s.appendChild(o),s.href="javascript:void(0)",s.style.textDecoration="none",o=document.createElement("a"),o.appendChild(i),o.href="javascript:void(0)",o.style.textDecoration="none",r.appendChild(s),r.appendChild(o),t.appendChild(r),i=function(t){return function(n){dext_load_auto_save_click_date(t,e),DEXTTOP.DEXT5.util.stopEvent(n)}}(n),DEXTTOP.DEXT5.util.addEvent(r,"click",i),DEXTTOP.DEXT5.util.addEvent(s,"focus",i),r=function(e){return function(e){13==("which"in e?e.which:e.keyCode)&&(DEXTTOP.DEXT5.util.cancelEvent(e),dext_load_auto_save())}}(s),DEXTTOP.DEXT5.util.addEvent(s,"keydown",r),"cssFloat"in s.style?s.style.cssFloat="left":s.style.styleFloat="left","cssFloat"in o.style?o.style.cssFloat="left":o.style.styleFloat="left",r=function(t){return function(n){dext_load_auto_save_click_date(t,e),dext_load_auto_save_click_del(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,t,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount),DEXTTOP.DEXT5.util.stopEvent(n)}}(n),DEXTTOP.DEXT5.util.addEvent(o,"click",r),setCursorPos(document.getElementById("ul_date").getElementsByTagName("a")[0],!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("ul_date").getElementsByTagName("a")[0])}else dext_load_auto_save_setHtml("<html><head></head><body></body></html>")}function dext_load_auto_save_click_date(e,t){for(var n=document.getElementById("ul_date"),r=n.getElementsByTagName("li").length-1,i=r;0<=i;i--){var s=r-i;i==e?n.getElementsByTagName("li")[s].style.backgroundColor="#dff1ff":n.getElementsByTagName("li")[s].style.backgroundColor="#ffffff",n.getElementsByTagName("li")[s].getElementsByTagName("img")[0].src="../images/bg/editor_popup_close_bg.gif"}0<n.getElementsByTagName("li").length&&dext_load_auto_save_setHtml(t[e].html)}function dext_load_auto_save_setHtml(e){var t=document.getElementById("content_frame").contentWindow.document;g_currHtml=e,"1"==DEXTTOP.G_CURREDITOR._config.enforceDoctype&&(g_currHtml=g_currHtml.replace(/<!doctype *([^>?+])*>/gi,"")),e=LayerWin.getRemoveHeadScript(g_currHtml),g_currHtml=e.html,t.open("text/html","replace"),LayerWin.isCustomDomain(LayerWin.document)&&(t.domain=LayerWin.document.domain),t.write(g_currHtml),t.close(),LayerWin.setHeadScriptSrc(t,e.scriptsAry),e=Math.max(t.body.scrollWidth,t.body.offsetWidth,t.documentElement.clientWidth,t.documentElement.scrollWidth,t.documentElement.offsetWidth);var n=Math.max(t.body.scrollHeight,t.body.offsetHeight,t.documentElement.clientHeight,t.documentElement.scrollHeight,t.documentElement.offsetHeight),r=document.getElementById("content_frame").parentNode,i=LayerWin.getClientRect(r),r=i.right-i.left,i=i.bottom-i.top,s=!0;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(s=!1),e>r?(t.body.style.width=DEXTTOP.G_CURREDITOR._config.style.width,s&&(t.body.style.overflowX="scroll")):s&&(t.body.style.overflowX="hidden"),n>i?s&&(t.body.style.overflowY="scroll"):s&&(t.body.style.overflowY="hidden"),DEXTTOP.DEXT5.util.addEvent(t,"contextmenu",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)})}function dext_load_auto_save_click_del(e,t,n,r){var i=document.getElementById("ul_date");if(confirm(LayerWin.dext5_lang.loadAutoSave.delMsg)){for(dext_load_auto_save_del(e,t,n,r);i.hasChildNodes();)i.removeChild(i.firstChild);dext_load_auto_save_setDateList()}}function dext_paragraph_attribute(){var e=document.getElementById("p_margin_left"),t=document.getElementById("p_margin_right"),n=document.getElementById("p_margin_top"),r=document.getElementById("p_margin_bottom"),i=document.getElementById("p_letter_spacing"),s=document.getElementById("p_word_spacing"),o=document.getElementById("p_text_indent"),u=document.getElementById("p_font_size"),a=document.getElementById("font_family_select"),f=document.getElementById("p_font_size_type");LayerWin.event_dext_paragraph_attribute({marginLeft:e.value,marginRight:t.value,marginTop:n.value,marginBottom:r.value,letterSpacing:i.value,wordSpacing:s.value,textIndent:o.value,fontSize:u.value,fontFamily:a.value,fontType:f.value},window.frameElement.parentNode.parentNode)}function dext_paste_table(){for(var e="",t=document.getElementsByName("radio_select"),n=t.length,r=0;r<n;r++)if(1==t[r].checked){e=t[r].value;break}LayerWin.event_dext_paste_table({type:e},window.frameElement.parentNode.parentNode)}function set_paste_table_button(){for(var e=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode,t=0,n=0,t=e.rows.length,r=0;r<t;r++){var i=e.rows[r].cells.length;n<i&&(n=i)}for(var e=DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode,s=0,o=0,s=e.rows.length,r=0;r<s;r++)i=e.rows[r].cells.length,o<i&&(o=i);s==t&&(document.getElementById("radio_3").removeAttribute("disabled"),document.getElementById("radio_4").removeAttribute("disabled")),o==n&&(document.getElementById("radio_5").removeAttribute("disabled"),document.getElementById("radio_6").removeAttribute("disabled"))}function dext5plugin_action(e){LayerWin.event_dext5plugin_action(e,window.frameElement.parentNode.parentNode)}function setInputBoxWidth(e,t){t=DEXTTOP.DEXT5.util.parseIntOr0(t),e.style.width=DEXTTOP.DEXT5.browser.mobile?DEXTTOP.DEXT5.browser.safari?t-10+"px":t+"px":t+"px"}function dext_spellcheck_set_popup(e,t){if(0==e.length)return!1;try{for(var n=LayerWin.rangy.createRange(document.getElementById("copycontent").contentDocument),r=0;r<e.length;r++)if(n.findText(e[r].word)){n.deleteContents();var i=document.createElement("span");i.setAttribute("id","cnt"+r),i.setAttribute("class","cnt"),i.setAttribute("onmouseover","parent.wrong_word_over(this)"),i.setAttribute("onmouseout","parent.wrong_word_out(this)");var s=document.createElement("span");s.setAttribute("class","cnt_modify"),s.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply),s.setAttribute("onclick","parent.above_word_click(this)"),s.innerHTML=e[r].suggestions[0],i.appendChild(s);var o=document.createElement("span");o.setAttribute("class","wordspan"),o.innerText=e[r].word;var u=document.createElement("sup"),a=document.createTextNode(r+1+")");u.appendChild(a),i.appendChild(u),i.appendChild(o),n.insertNode(i),n.selectNode(i),t?n.collapse(!1):n.collapse(!0);var f=document.createElement("dl");f.setAttribute("id","list"+r),f.setAttribute("value",r),-1!=LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word.indexOf("'")?f.innerHTML='<dt onclick="wrong_word_click(this)" title="'+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+'"><a href="javascript:void(0);" data-value="'+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+'">'+(r+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+"</a></dt>":f.innerHTML="<dt onclick='wrong_word_click(this)' title='"+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+"'><a href='javascript: void (0);' data-value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+"'>"+(r+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+"</a></dt>",document.getElementById("wordlist").appendChild(f);for(var l=0;l<LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].suggestions.length;l++){var c=document.createElement("dd");c.setAttribute("onclick","replace_word_click(this)"),c.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply),c.innerHTML="<a href='javascript: void (0);' value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].suggestions[l]+"'>"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].suggestions[l]+"</a></dt>",document.getElementById("list"+r).appendChild(c)}f.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else{var h=e[r].word,h=h.replace(/ /gi,"\u00a0");if(n.findText(h)){n.deleteContents(),i=document.createElement("span"),i.setAttribute("id","cnt"+r),i.setAttribute("class","cnt"),i.setAttribute("onmouseover","parent.wrong_word_over(this)"),i.setAttribute("onmouseout","parent.wrong_word_out(this)"),s=document.createElement("span"),s.setAttribute("class","cnt_modify"),s.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply),s.setAttribute("onclick","parent.above_word_click(this)"),s.innerHTML=e[r].suggestions[0],i.appendChild(s),o=document.createElement("span"),o.setAttribute("class","wordspan"),o.innerText=e[r].word,u=document.createElement("sup"),a=document.createTextNode(r+1+")"),u.appendChild(a),i.appendChild(u),i.appendChild(o),n.insertNode(i),n.selectNode(i),t?n.collapse(!1):n.collapse(!0),f=document.createElement("dl"),f.setAttribute("id","list"+r),f.setAttribute("value",r),-1!=LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word.indexOf("'")?f.innerHTML='<dt onclick="wrong_word_click(this)" title="'+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+'"><a href="javascript:void(0);" data-value="'+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+'">'+(r+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+"</a></dt>":f.innerHTML="<dt onclick='wrong_word_click(this)' title='"+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+"'><a href='javascript: void (0);' data-value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+"'>"+(r+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].word+"</a></dt>",document.getElementById("wordlist").appendChild(f);for(l=0;l<LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].suggestions.length;l++)c=document.createElement("dd"),c.setAttribute("onclick","replace_word_click(this)"),c.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply),c.innerHTML="<a href='javascript: void (0);' value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].suggestions[l]+"'>"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[r].suggestions[l]+"</a></dt>",document.getElementById("list"+r).appendChild(c);f.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else LayerWin.G_DEPlugin.spellcheck.chkWordArr.splice(r,1),r--}Dext5LayerWin.hideProcessingBackground()}catch(p){}}function imgSizeUnitChange(e,t){var n=document.getElementById("img_height_unit"),r=document.getElementById("img_width_unit"),i=document.getElementById("img_width"),s=document.getElementById("img_height"),o=document.getElementById("img_ratio");"true"==o.getAttribute("ratio-checked")?(r.value=e,n.value=e,"%"==e?"w"==t?(i.value="100",s.value="",s.setAttribute("disabled","true")):(s.value="100",i.value="",i.setAttribute("disabled","true")):(i.removeAttribute("disabled"),s.removeAttribute("disabled"))):r.value==n.value?o.removeAttribute("disabled"):(o.className="img_link_btn",o.setAttribute("ratio-checked",!1),o.setAttribute("disabled","true"),i.removeAttribute("disabled"),s.removeAttribute("disabled"))}function checkSameBorderWidthInCells(e,t){var n=["borderLeftWidth","borderTopWidth","borderRightWidth","borderBottomWidth"],r=n.length,i={isSame:!0,borderWidth:""};try{if(t){e=[];for(var s=["td","th"],o=s.length,u=0;u<o;u++){var a=t.getElementsByTagName(s[u]);try{e=e.concat(Array.prototype.slice.call(a,0))}catch(f){for(var l=a.length,c=0;c<l;c++)e.push(a[c])}}}var h=e.length;if(500>=h){for(var p=e[0].style.borderLeftWidth,u=0;u<h;u++){for(var d=e[u],c=0;c<r;c++)if(p!=d.style[n[c]]){i.isSame=!1;break}if(0==i.isSame)break}1==i.isSame&&(i.borderWidth=p)}else i={isSame:!1,borderWidth:""}}catch(v){i={isSame:!1,borderWidth:""}}return i}function changeStyleForiOS(e,t){if(DEXTTOP.DEXT5.browser.iOS)for(data in e.style.webkitAppearance="none",t){e.style[data]=t[data];break}}function addParamHashTable(e){for(var t=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,n=t.length,r=0;r<n;r++){var i=t[r].form_value,i=encodeURIComponent(t[r].form_value);e.setItem(t[r].form_name,i)}}function addParamForm(e){try{for(var t=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,n=t.length-1;0<=n;n--){var r=t[n].form_value,r=encodeURIComponent(t[n].form_value),i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("id","addFormData"+[n]),i.setAttribute("name",t[n].form_name),i.setAttribute("value",r),e.insertBefore(i,e.firstChild)}}catch(s){}}function postMessageEvent(e,t){if(window.postMessage){var n=function(e){try{var r=e.data.replace("*","?");_web_url=DEXTTOP.DEXT5.util.trim(r);switch(t){case"image":event_dext_image_upload_completed(r);break;case"cell_property":event_dext_cell_property_completed(_web_url);break;case"doc_bg_img":event_dext_dog_bg_img_completed(_web_url);break;case"flash":event_dext_flash_upload_completed(_web_url);break;case"hyperlink":dext_create_hyperlink(_web_url);break;case"insert_file":event_dext_file_upload_completed(_web_url);break;case"media":event_dext_media_upload_completed(_web_url);break;case"video":event_dext_video_upload_completed(_web_url);break;case"table":event_dext_detail_table_completed(_web_url);break;case"table_property":event_dext_table_property_completed(_web_url);break;case"input_image":event_dext_input_image_upload_completed(_web_url)}}catch(i){}DEXTTOP.DEXT5.util.removeEvent(window,"message",n)};DEXTTOP.DEXT5.util.addEvent(window,"message",n)}DEXTTOP.DEXT5.util.addEvent(e,"load",function(){e.contentWindow.postMessage("check","*")},!0)}function aboutShowInfo(){try{document.getElementById("dext_license_company").innerHTML=": "+LayerWin._dext_editor.____.l[1],document.getElementById("dext_license_system").innerHTML=": "+LayerWin._dext_editor.____.l[2],document.getElementById("dext_license_product").innerHTML=": "+LayerWin._dext_editor.____.l[7],"S"==LayerWin._dext_editor.____.l[3]?document.getElementById("dext_license_edition").innerHTML=": Standard Edition":document.getElementById("dext_license_edition").innerHTML=": Professional Edition",0==LayerWin._dext_editor.____.l[6]?document.getElementById("dext_license_user").innerHTML=": Unlimited.":document.getElementById("dext_license_user").innerHTML=": "+LayerWin._dext_editor.____.l[6],document.getElementById("dext_license_ver").innerHTML=": "+DEXTTOP.DEXT5.ReleaseVer}catch(e){}}var G_IMAGE_ALLOW_EXT=["jpg","jpeg","png","gif","bmp"],G_dragDropFileObj=null,LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID),LayerWin=LayerFrame.contentWindow,LayerDoc=LayerWin.document;DEXTTOP.DEXT5.util.overrideFn(window);try{HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var r=this;setTimeout(function(){for(var i=atob(r.toDataURL(t,n).split(",")[1]),s=i.length,o=new Uint8Array(s),u=0;u<s;u++)o[u]=i.charCodeAt(u);e(new Blob([o],{type:t||"image/png"}))})}})}catch(e$$4){}DEXTTOP.DEXT5.util.addEvent(window,"dragover",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),DEXTTOP.DEXT5.util.addEvent(document,"dragover",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),DEXTTOP.DEXT5.util.addEvent(window,"drop",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),DEXTTOP.DEXT5.util.addEvent(document,"drop",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)}),"undefined"==typeof useContextmenu&&DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(e){DEXTTOP.DEXT5.util.cancelEvent(e)});