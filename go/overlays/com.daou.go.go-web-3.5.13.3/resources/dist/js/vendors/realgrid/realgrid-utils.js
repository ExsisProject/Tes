function getMultiLevelColumns(e){function t(e){var t=r(e[0],e[1]);for(var n=2;n<e.length;n++)t=r(t,e[n]);return t}function n(e,t){while(t!=0){var n=e%t;e=t,t=n}return e}function r(e,t){return e*t/n(e,t)}var i=e.map(function(e){return e.length}),s=t(i),o={};o.direction="vertical",o.items=[],o.header={visible:!1};for(var u=0;u<e.length;u++){var a={};a.direction="horizontal",a.items=[],a.header={visible:!1};for(var f=0;f<e[u].length;f++){var l=s/e[u].length,c={};c.column=e[u][f],c.cellSpan=l,c.width=50,a.items.push(c);for(var h=0;h<l-1;h++)a.items.push(50)}o.items.push(a)}return[o]}function setFieldsNColumns(e,t,n){var r=[];for(var i in n){var s=n[i];s.fieldName||(s.fieldName=s.name,s.header=s.name);if(s&&!s.items){var o={};o.fieldName=s.name,s.tag&&s.tag.dataType&&(o.dataType=s.tag.dataType),r.push(o)}}e.setFields(r),t.setColumns(n)}function getColumnsToFormModel(e){var t={footer:{popupMenu:"menuForm"},items:[]},n=t.items,r=e.getColumns();for(var i in r){var s={};s.header=r[i].header.text,s.column=r[i].name,n.push(s)}return t}function exportExcel(e){e.exportGrid({type:"excel"})}function setContextMenu(e){var t=e.getColumnNames(),n=e.getCurrent().itemIndex+1,r=[];for(var i in t){var s={},o,u=e.columnByName(t[i]);u.fieldName&&(s.label=u.header.text,s.tag=u.name,s.checked=u.visible,r.push(s))}r.push({label:"-"},{label:"\uceec\ub7fc \ubaa8\ub450 \ubcf4\uae30",tag:"columnShow"},{label:"-"},{label:"\ud604\uc7ac \uceec\ub7fc \ud544\ud130 \uaca8\uae30",tag:"autoFilter"});var u=e.columnByName(e.getCurrent().column),a=[{label:"\uace0\uc815",children:[{label:"\ud589 1\uac1c",tag:"1rowFixed"},{label:"\ud589 2\uac1c",tag:"2rowFixed"},{label:"\ud604\uc7ac \ud589\uae4c\uc9c0("+n+")",tag:"rowFixed"},{label:"-"},{label:"\uccab\ubc88\uc9f8 \uceec\ub7fc",tag:"1colFixed"},{label:"\ub450\ubc88\uc9f8 \uceec\ub7fc",tag:"2colFixed"},{label:"\ud604\uc7ac \uceec\ub7fc\uae4c\uc9c0("+u.header.text+")",tag:"colFixed"},{label:"-"},{label:"\uace0\uc815 \ucde8\uc18c",tag:"cancelFixed",enabled:e.fixedOptions.rightCount+e.fixedOptions.colCount+e.fixedOptions.rowCount!=0}]},{label:"\uceec\ub7fc",tag:"columnMenu",children:r},{label:"\ud589 \ub192\uc774",children:[{label:"\ubcf4\ud1b5 (28px)",tag:"rowNormalHeight"},{label:"\uc881\uac8c (20px)",tag:"rowSmallHeight"},{label:"\ub113\uac8c (36px)",tag:"rowLargeHeight"}]},{label:"-"},{label:"ExcelExport",tag:"excelExport"}];e.setContextMenu(a)}function onContextMenuClick(e,t,n){var r=e.getCurrent(),i=e.columnByName(r.column);t.parent.label=="\uceec\ub7fc"&&e.setColumnProperty(t.tag,"visible",!t.checked);switch(t.tag){case"1rowFixed":e.setFixedOptions({rowCount:1});break;case"2rowFixed":e.setFixedOptions({rowCount:2});break;case"rowFixed":e.setFixedOptions({rowCount:r.itemIndex+1});break;case"1colFixed":e.setFixedOptions({colCount:1});break;case"2colFixed":e.setFixedOptions({colCount:2});break;case"colFixed":e.setFixedOptions({colCount:i.index+1});break;case"cancelFixed":e.setFixedOptions({colCount:0,rowCount:0});break;case"rowNormalHeight":e.displayOptions.rowHeight=28;break;case"rowSmallHeight":e.displayOptions.rowHeight=20;break;case"rowLargeHeight":e.displayOptions.rowHeight=36;break;case"excelExport":exportExcel(e);break;case"autoFilter":i.autoFilter=!0,e.refresh();break;case"columnHide":i.visible=!1;break;case"columnShow":var s=e.getColumns();for(var o in s)s[o].visible=!0}}function getSelectionSummary(e){var t=0,n=0,r=e.getSelectionData();for(var i in r)for(var s in r[i])e.columnByName(s).valueType=="number"&&(t+=r[i][s],n++);return t}function getMultiLevelColumns(e){function t(e){var t=r(e[0],e[1]);for(var n=2;n<e.length;n++)t=r(t,e[n]);return t}function n(e,t){while(t!=0){var n=e%t;e=t,t=n}return e}function r(e,t){return e*t/n(e,t)}var i=e.map(function(e){return e.length}),s=t(i),o={};o.direction="vertical",o.items=[],o.header={visible:!1};for(var u=0;u<e.length;u++){var a={};a.direction="horizontal",a.items=[],a.header={visible:!1};for(var f=0;f<e[u].length;f++){var l=s/e[u].length,c={};c.column=e[u][f],c.cellSpan=l,c.width=50,a.items.push(c);for(var h=0;h<l-1;h++)a.items.push(50)}o.items.push(a)}return[o]};