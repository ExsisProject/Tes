function selectCertificate(e){if(e==null||e=="")return setErrorCode("NO_USER_ID"),setErrorMessage(""),setErrorFunctionName("selectCertificate()"),!1;SetSessionID(e);var t=LoadUserKeyCertDlg(bUseKMCert);return t?t:(setErrorCode(GetLastErrMsg()),setErrorMessage(""),setErrorFunctionName("selectCertificate()"),!1)}function clearCertificateInfo(e){return e==null||e==""?(setErrorCode("NO_USER_ID"),setErrorMessage(""),setErrorFunctionName("clearCertificateInfo()"),!1):(SetSessionID(e),UnloadUserKeyCert(),!0)}function reselectCertificate(e){return clearCertificateInfo(e),selectCertificate(e)}function getUserSignCert(e){var t=selectCertificate(e);if(!t)return setErrorFunctionName("getUserSignCert()"),"";var n=GetUserSignCert();return n==""?(setErrorFunctionName("getUserSignCert()"),""):n}function getUserKMCert(e){var t=selectCertificate(e);if(!t)return setErrorFunctionName("getUserKMCert()"),"";var n=GetUserKMCert();return n==""?(setErrorFunctionName("getUserKMCert()"),""):n}function getUserKMKey(e){var t=selectCertificate(e);if(!t)return setErrorFunctionName("getUserKMKey()"),"";var n=GetUserKMKey();return n==""?(setErrorFunctionName("getUserKMKey()"),""):n}function getUserKMKeyWithNewPassword(e,t){var n=selectCertificate(e);if(!n)return setErrorFunctionName("getUserKMKeyWithNewPassword()"),"";var r=GetUserKMKeyWithNewPassword(t);return r==""?(setErrorFunctionName("getUserKMKeyWithNewPassword()"),""):r}function isLoadedCertificate(e){return e==null||e==""?(setErrorCode("NO_USER_ID"),setErrorMessage(""),setErrorFunctionName("isLoadedCertificate()"),!1):IsLoadedCert(e)?(SetSessionID(e),!0):!1}function getUserCertKey(e,t){if(e==null||e==""||t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getUserCertKey()"),"";var n=GetUserCertKey(e,t);return n==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getUserCertKey()"),""):n}function getUserPassword(e){return"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\u02b4\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\u0534\u03f4\ufffd."}function getCertPath(e){var t=selectCertificate(e);if(!t)return setErrorFunctionName("getCertPath()"),"";var n=GetCertPath();return n==""?(setErrorFunctionName("getCertPath()"),""):n}function getSerialFromCert(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertSerialNumber()"),"";var t=GetSerialNumberFromCert(e);return t<0?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getSerialFromCert()"),t):t}function getCertSerialNumber(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertSerialNumber()"),"";var t=GetCertInfoFromCert(e,2);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertSerialNumber()"),""):t}function getCertSubjectDN(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertSubjectDN()"),"";var t=GetSubjectDNFromCert(e);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertSubjectDN()"),""):t}function getCertIssuerDN(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertIssuerDN()"),"";var t=GetCertInfoFromCert(e,4);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertIssuerDN()"),""):t}function getCertNotBefore(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertNotBefore()"),"";var t=GetCertInfoFromCert(e,5);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertNotBefore()"),""):t}function getCertNotAfter(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertNotAfter()"),"";var t=GetCertInfoFromCert(e,6);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertNotAfter()"),""):t}function getCertPublicKey(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertPublicKey()"),"";var t=GetCertInfoFromCert(e,8);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertPublicKey()"),""):t}function getCertSignatureAlgorithm(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertSignatureAlgorithm()"),"";var t=GetCertInfoFromCert(e,3);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertSignatureAlgorithm()"),""):t}function getCertKeyUsage(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertKeyUsage()"),"";var t=GetCertInfoFromCert(e,9);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertKeyUsage()"),""):t}function getCertPolicy(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertPolicy()"),"";var t=GetCertInfoFromCert(e,10);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertPolicy()"),""):t}function getCertInfo(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertInfo()"),"";var t=GetCertInfoFromCert(e,0);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertInfo()"),""):t}function checkCertValidity(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("checkCertValidity()"),!1;var t=ValidateCert(e);return t?t:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("checkCertValidity()"),!1)}function checkCertValidityWithPolicy(e,t){var n=!1;return t==undefined||t==""?n=SetCertPolicy("ANY"):n=SetCertPolicy(t),n==0?!1:checkCertValidity(e)}function getRandomNumber(e){var t=selectCertificate(e);if(!t)return setErrorFunctionName("getRandomNumber()"),"";var n=GetUserKeyRNumber();return n==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getRandomNumber()"),""):removeCRLF(n)}function getEncryptedRandomNumber(e){var t=selectCertificate(e);if(!t)return setErrorFunctionName("getEncryptedRandomNumber()"),"";var n=GetUserKeyRNumber();if(n=="")return setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getEncryptedRandomNumber()"),"";var r=encryptDataString(e,n);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getEncryptedRandomNumber()"),""):removeCRLF(r)}function checkCertOwner(e,t,n){if(e==null||e==""||t==null||t==""||n==null||n=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("checkCertOwner()"),!1;var r=CheckCertOwner(e,t,n);return r?!0:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("checkCertOwner()"),!1)}function getCertPublicKeyAlgo(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getCertPolicy()"),"";var t=GetCertInfoFromCert(e,11);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getCertPolicy()"),""):t}function getUserSignCertEX(e,t){var n=selectCertificate(e);if(!n)return setErrorFunctionName("getUserSignCert()"),"";var r=GetUserSignCertEX(t);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getUserSignCert()"),""):r}function getUserKMCertEX(e,t){var n=selectCertificate(e);if(!n)return setErrorFunctionName("getUserKMCert()"),"";var r=GetUserKMCertEX(t);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getUserKMCert()"),""):r}function setSitePolicyForCertDlgPolicy(e,t){if(e==null||e==""||t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setSitePolicyForCertDlgPolicy()"),!1;var n=SetSiteIniPolicy(e,t);return n?!0:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setSitePolicyForCertDlgPolicy()"),!1)}function setSiteNameForCertDlgPolicy(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setSiteNameForCertDlgPolicy()"),!1;var t=SetSiteName(e);return t?!0:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setSiteNameForCertDlgPolicy()"),!1)}function setDefaultCertDlgModeMedia(e,t){var n=SetDefaultDlgParam(e,t);return n?!0:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setDefaultCertDlgModeMedia()"),!1)}function setCertDialogImage(e){var t=SetCertDialogImage(e);return t?!0:(setErrorCode("Failed to download Image:"),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setCertDialogImage()"),!1)}function setDefaultDlgPassword(e){return SetDefaultDlgPassword(e)}function setDefaultDlgDN(e){return SetDefaultDlgDN(e)}function setBioHSMInfo(e){return null==e||""==e?(setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setBioHSMInfo()"),!1):SetBioHSMInfo(e)}function getMediaType(e){return null==e||""==e?(setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getMediaType()"),0):GetMediaType(e)}function getDevManufature(e){if(null==e||""==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getDevManufature()"),"";var t=GetDevManufature(e);return""==t?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getDevManufature()"),""):t}function getDevCSN(e){if(null==e||""==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getDevCSN()"),"";var t=GetDevCSN(e);return""==t?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getDevCSN()"),""):t}function getDevAuth(e){if(null==e||""==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getDevAuth()"),"";var t=GetDevAuth(e);return""==t?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getDevAuth()"),""):t}function setDevAuthParam(e,t){if(null==e||""==e||null==t||""==t)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setDevAuthParam()"),!1;var n=SetDevAuthParam(e,t);return 0==n?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setDevAuthParam()"),!1):!0}function genDevAuth(e,t,n){if(null==e||""==e||null==t||""==t||null==n||""==n)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("genDevAuth()"),"";var r=GenDevAuth(e,t,n);return null==r||""==r?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("GenDevAuth()"),""):r}function getDevPID(e){if(null==e||""==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getDevPID()"),"";var t=GetDevPID(e);return""==t?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getDevPID()"),""):t}function getDevCID(e){if(null==e||""==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getDevCID()"),"";var t=GetDevCID(e);return""==t?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getDevCID()"),""):t}function setCertPolicy(e){return e==null||e==""?(setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setCertPolicy()"),!1):SetCertPolicy(e)==0?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setCertPolicy()"),!1):!0}function setDynamicMessage(e,t){if(e==null||e==""||e<0||e>3||t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setDynamicMessage()"),"";var n=SetDynamicMessage(e,t);return n?n:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setDynamicMessage()"),!1)}function mobileKeySetSettingInt(e,t){if(0!=e||0>t||1<t)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("setDynamicMessage()"),"";var n=MobileKeySetSettingInt(e,t);return n?n:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("mobileKeySetSettingInt"),!1)}function mobileKeySetSettingString(e){if(""==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("mobileKeySetSettingString"),"";var t=MobileKeySetSettingString(e);return t?t:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("mobileKeySetSettingString"),!1)}function CaCertSetSettingInt(e,t){if(2>e||3<e||null==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage("2: Save CaCert To Writable Path, 3: Do Not Save Root Ca Cert On Init"),setErrorFunctionName("CaCertSetSettingInt()"),!1;if(0>t||1<t||null==t)return setErrorCode("NO_DATA_VALUE"),setErrorMessage("1:Run Function, 0:Stop Function)"),setErrorFunctionName("CaCertSetSettingInt()"),!1;var n=SetSettingInt(e,t);return n?n:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("CaCertSetSettingInt"),!1)}function SetDefaultLocale(e){if(0>e||2<e||null==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage("1:Run Function, 0:Stop Function)"),setErrorFunctionName("SetDefaultLocale"),"";var t=DefaultLocaleSetSettingInt(SettingValue);return t?t:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("SetDefaultLocale"),!1)}function setPasswordMinimumSize(e,t){if(0>e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setPasswordMinimumSize"),!1;var n=SetPasswordMinimumSIze(e,t);return n?n:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("setPasswordMinimumSize"),!1)}function doNotUseDefaultFocus(e){return e==undefined||e<0||1<e?(setErrorCode("NO_DATA_VALUE"),setErrorMessage("1:Run Function, 0:Stop Function)"),setErrorFunctionName("doNotUseDefaultFocus"),!1):DoNotUseDefaultFocus(e)==0?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("doNotUseDefaultFocus"),!1):!0}function enableVerifyMPKI(e){if(0>e||1<e||null==e)return setErrorCode("NO_DATA_VALUE"),setErrorMessage("1:Run Function, 0:Stop Function)"),setErrorFunctionName("SetDefaultLocale"),"";var t=EnableVerifyMPKI(enable);return t?t:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("enableVerifyMPKI"),!1)};