function generatePKCS7SignedMsg(e,t){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedMsg()"),"";var n=selectCertificate(e);if(!n)return setErrorFunctionName("generatePKCS7SignedMsg()"),"";var r=GeneratePKCS7MsgSG(1,t,"","");return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7SignedMsg()"),""):r}function generatePKCS7SignedFile(e,t,n){if(t==null||t==""||n==null||n=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedFile()"),!1;var r=selectCertificate(e);return r?(r=GeneratePKCS7MsgFileSG(1,t,"","",n),r?r:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7SignedFile()"),!1)):(setErrorFunctionName("generatePKCS7SignedFile()"),!1)}function generatePKCS7SignedFromFile(e,t){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedFile()"),"";var n=selectCertificate(e);return n?(strPKCS7Message=GeneratePKCS7MsgFromFileSG(1,t,"",""),strPKCS7Message==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7SignedMsgFormFile()"),""):strPKCS7Message):(setErrorFunctionName("generatePKCS7SignedFile()"),"")}function addPKCS7SignMsg(e,t){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("addPKCS7SignMsg()"),"";var n=selectCertificate(e);if(!n)return setErrorFunctionName("addPKCS7SignMsg()"),"";var r=AddPKCS7Signature(t);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("addPKCS7SignMsg()"),""):r}function addPKCS7SignFile(e,t,n){if(t==null||t==""||n==null||n=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("addPKCS7SignFile()"),!1;var r=selectCertificate(e);return r?(r=AddPKCS7SignatureFile(t,n),r?r:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("addPKCS7SignFile()"),!1)):(setErrorFunctionName("addPKCS7SignFile()"),!1)}function addPKCS7SignFromFile(e,t){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("addPKCS7SignFile()"),"";var n=selectCertificate(e);if(!n)return setErrorFunctionName("addPKCS7SignFile()"),"";var r=AddPKCS7SignatureFromFile(t);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("addPKCS7SignFromFile()"),""):r}function generatePKCS7EnvelopedMsg(e,t,n){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7EnvelopedMsg()"),"";if(t!=null&&t!=""||n!=null&&n!=""){var r=GeneratePKCS7MsgSG(2,e,t,n);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7EnvelopedMsg()"),""):r}return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7EnvelopedMsg()"),""}function generatePKCS7EnvelopedFile(e,t,n,r){if(e==null||e==""||r==null||r=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7EnvelopedFile()"),!1;if(t!=null&&t!=""||n!=null&&n!=""){var i=GeneratePKCS7MsgFileSG(2,e,t,n,r);return i?i:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7EnvelopedFile()"),!1)}return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7EnvelopedFile()"),!1}function generatePKCS7EnvelopedFromFile(e,t,n){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7EnvelopedFromFile()"),"";if(t!=null&&t!=""||n!=null&&n!=""){var r=GeneratePKCS7MsgFromFileSG(2,e,t,n);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7EnvelopedFromFile()"),""):r}return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7EnvelopedFromFile()"),""}function generatePKCS7SignedEnvelopedMsg(e,t,n,r){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedEnvelopedMsg()"),"";if(n!=null&&n!=""||r!=null&&r!=""){var i=selectCertificate(e);if(!i)return setErrorFunctionName("generatePKCS7SignedEnvelopedMsg()"),"";var s=GeneratePKCS7MsgSG(3,t,n,r);return s==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7SignedEnvelopedMsg()"),""):s}return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedEnvelopedMsg()"),""}function generatePKCS7SignedEnvelopedFile(e,t,n,r,i){if(t==null||t==""||i==null||i=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),!1;if(n!=null&&n!=""||r!=null&&r!=""){var s=selectCertificate(e);return s?(s=GeneratePKCS7MsgFileSG(3,t,n,r,i),s?s:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),!1)):(setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),!1)}return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),!1}function generatePKCS7SignedEnvelopedFromFile(e,t,n,r){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),"";if(n!=null&&n!=""||r!=null&&r!=""){var i=selectCertificate(e);if(!i)return setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),"";var s=GeneratePKCS7MsgFromFileSG(3,t,n,r);return s==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7SignedEnvelopedFromFile()"),""):s}return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7SignedEnvelopedFile()"),""}function verifyPKCS7SignedMsg(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("verifyPKCS7SignedMsg()"),"";var t=VrfPKCS7Msg(e);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("verifyPKCS7SignedMsg()"),nSignerCount=0,""):(nSignerCount=GetPKCS7SignInfo(e),t)}function verifyPKCS7EnvelopedMsg(e,t){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("verifyPKCS7EnvelopedMsg()"),"";var n=selectCertificate(e);if(!n)return setErrorFunctionName("verifyPKCS7EnvelopedMsg()"),"";var r=VrfPKCS7Msg(t);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("verifyPKCS7EnvelopedMsg()"),nSignerCount=0,""):(nSignerCount=GetPKCS7SignInfo(t),r)}function verifyPKCS7SignedFile(e,t){if(e==null||e==""||t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("verifyPKCS7SignedFile()"),!1;var n=VrfPKCS7MsgFile(e,t);return n?(nSignerCount=GetPKCS7SignInfoFile(e),n):(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("verifyPKCS7SignedFile()"),nSignerCount=0,!1)}function verifyPKCS7EnvelopedFile(e,t,n){if(t==null||t==""||n==null||n=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("verifyPKCS7EnvelopedFile()"),!1;var r=selectCertificate(e);if(!r)return setErrorFunctionName("verifyPKCS7EnvelopedFile()"),!1;var r=VrfPKCS7MsgFile(t,n);return r?(nSignerCount=GetPKCS7SignInfoFile(t),r):(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("verifyPKCS7EnvelopedFile()"),nSignerCount=0,!1)}function getPKCS7SignerCount(){return nSignerCount}function getPKCS7SignerCert(e){if(isNaN(e))return setErrorCode("NOT_INDEX_VALUE"),setErrorMessage(""),setErrorFunctionName("getPKCS7SignerCert()"),"";var t=GetPKCS7SignCert(e);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getPKCS7SignerCert()"),""):t}function getPKCS7SigningTime(e){if(isNaN(e))return setErrorCode("NOT_INDEX_VALUE"),setErrorMessage(""),setErrorFunctionName("getPKCS7SigningTime()"),"";var t=GetPKCS7SignTime(e);return t==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getPKCS7SigningTime()"),""):t}function clearPKCS7MessageInfo(){nSignerCount=0,ClearPKCS7SignInfo();return}function getPKCS7TypeMsg(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getPKCS7TypeMsg()"),"";var t="",n=GetPKCS7MessageType(e);if(n==1)t="PKCS7SignedMessage";else if(n==2)t="PKCS7EnvelopedMessage";else{if(n!=3)return setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getPKCS7TypeMsg()"),"";t="PKCS7SignedAndEnvelopedMessage"}return t}function getPKCS7TypeFile(e){if(e==null||e=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("getPKCS7TypeFile()"),"";var t="",n=GetPKCS7MessageTypeFile(e);if(n==1)t="PKCS7SignedMessage";else if(n==2)t="PKCS7EnvelopedMessage";else{if(n!=3)return setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("getPKCS7TypeFile()"),"";t="PKCS7SignedAndEnvelopedMessage"}return t}function generatePKCS7DetachedMsg(e,t){if(t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7DetachedMsg()"),"";var n=selectCertificate(e);if(!n)return setErrorFunctionName("generatePKCS7DetachedMsg()"),"";var r=GenPKCS7DetachedMsg(t);return r==""?(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7DetachedMsg()"),""):r}function verifyPKCS7DetachedMsg(e,t){if(e==null||e==""||t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("verifyPKCS7DetachedMsg()"),!1;var n=VrfPKCS7DetachedMsg(e,t);return n?(nSignerCount=GetPKCS7SignInfo(e),!0):(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("verifyPKCS7DetachedMsg()"),nSignerCount=0,!1)}function generatePKCS7DetachedMsgFileEx(e,t,n){if(t==null||t==""||n==null||n=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("generatePKCS7DetachedMsgFileEx()"),!1;var r=selectCertificate(e);return r?(r=GenPKCS7DetachedMsgFileEx(t,n),r?r:(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("generatePKCS7DetachedMsgFileEx()"),!1)):(setErrorFunctionName("generatePKCS7DetachedMsgFileEx()"),!1)}function verifyPKCS7DetachedMsgFile(e,t){if(e==null||e==""||t==null||t=="")return setErrorCode("NO_DATA_VALUE"),setErrorMessage(""),setErrorFunctionName("verifyPKCS7DetachedMsgFile()"),!1;var n=VrfPKCS7DetachedMsgFile(e,t);return n?(nSignerCount=GetPKCS7SignInfoFile(e),n):(setErrorCode(""),setErrorMessage(GetLastErrMsg()),setErrorFunctionName("verifyPKCS7DetachedMsgFile()"),nSignerCount=0,!1)}var nSignerCount=0;