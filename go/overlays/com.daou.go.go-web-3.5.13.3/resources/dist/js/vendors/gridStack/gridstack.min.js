/**
 * gridstack.js 1.2.1
 * https://gridstackjs.com/
 * (c) 2014-2020 Alain Dumesny, Dylan Weiss, Pavel Reznikov
 * gridstack.js may be freely distributed under the MIT license.
 * @preserve
 */

Number.isNaN||(Number.isNaN=function(t){return t!==t}),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if(typeof window.CustomEvent=="function")return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}(),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(this==null)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError("predicate must be a function");var r=arguments[1],i=0;while(i<n){var s=t[i];if(e.call(r,s,i,t))return s;i++}return undefined}}),function(e){if(typeof define=="function"&&define.amd)define(["jquery","exports"],e);else if(typeof exports!="undefined"){var t;try{t=require("jquery")}catch(n){}e(t||window.jQuery,exports)}else e(window.jQuery,window)}(function(e,t){function u(e){this.grid=e}var n=function(e,t,n,r){var i=function(){return console.warn("gridstack.js: Function `"+t+"` is deprecated in "+r+" and has been replaced "+"with `"+n+"`. It will be **completely** removed in v1.0"),e.apply(this,arguments)};return i.prototype=e.prototype,i},r=function(e,t,n,r){e[t]!==undefined&&(e[n]=e[t],console.warn("gridstack.js: Option `"+t+"` is deprecated in "+r+" and has been replaced with `"+n+"`. It will be **completely** removed in v1.0"))},i=function(e,t,n,r){e[t]!==undefined&&console.warn("gridstack.js: Option `"+t+"` is deprecated in "+n+r)},s=function(e,t,n,r){var i=e.attr(t);i!==undefined&&(e.attr(n,i),console.warn("gridstack.js: attribute `"+t+"`="+i+" is deprecated on this object in "+r+" and has been replaced with `"+n+"`. It will be **completely** removed in v1.0"))},o={isIntercepted:function(e,t){return!(e.x+e.width<=t.x||t.x+t.width<=e.x||e.y+e.height<=t.y||t.y+t.height<=e.y)},sort:function(e,t,n){if(!n){var r=e.map(function(e){return e.x+e.width});n=Math.max.apply(Math,r)}return t===-1?o.sortBy(e,function(e){return-(e.x+e.y*n)}):o.sortBy(e,function(e){return e.x+e.y*n})},createStylesheet:function(e,t){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.setAttribute("data-gs-style-id",e),n.styleSheet?n.styleSheet.cssText="":n.appendChild(document.createTextNode("")),t||(t=document.getElementsByTagName("head")[0]),t.insertBefore(n,t.firstChild),n.sheet},removeStylesheet:function(t){e("STYLE[data-gs-style-id="+t+"]").remove()},insertCSSRule:function(e,t,n,r){typeof e.insertRule=="function"?e.insertRule(t+"{"+n+"}",r):typeof e.addRule=="function"&&e.addRule(t,n,r)},toBool:function(e){return typeof e=="boolean"?e:typeof e=="string"?(e=e.toLowerCase(),e!==""&&e!=="no"&&e!=="false"&&e!=="0"):Boolean(e)},_collisionNodeCheck:function(e){return e!==this.node&&o.isIntercepted(e,this.nn)},_didCollide:function(e){return o.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},e)},_isAddNodeIntercepted:function(e){return o.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},e)},parseHeight:function(e){var t=e,n="px";if(t&&typeof t=="string"){var r=t.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%)?$/);if(!r)throw new Error("Invalid height");n=r[2]||"px",t=parseFloat(r[1])}return{height:t,unit:n}},without:function(e,t){var n=e.indexOf(t);return n!==-1&&(e=e.slice(0),e.splice(n,1)),e},sortBy:function(e,t){return e.slice(0).sort(function(e,n){var r=t(e),i=t(n);return i===r?0:r>i?1:-1})},defaults:function(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(!Object.prototype.hasOwnProperty.call(e,n)||e[n]===undefined)&&(e[n]=t[n])}),e},clone:function(t){return e.extend({},t)},throttle:function(e,t){var n=!1;return function(){n||(e.apply(this,arguments),n=!0,setTimeout(function(){n=!1},t))}},removePositioningStyles:function(e){var t=e[0].style;t.position&&t.removeProperty("position"),t.left&&t.removeProperty("left"),t.top&&t.removeProperty("top"),t.width&&t.removeProperty("width"),t.height&&t.removeProperty("height")},getScrollParent:function(e){var t;return e===null?t=null:e.scrollHeight>e.clientHeight?t=e:t=o.getScrollParent(e.parentNode),t},updateScrollPosition:function(e,t,n){var r=e.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight;if(r.top<0||r.bottom>i){var s=r.bottom-i,u=r.top,a=o.getScrollParent(e);if(a!==null){var f=a.scrollTop;r.top<0&&n<0?e.offsetHeight>i?a.scrollTop+=n:a.scrollTop+=Math.abs(u)>Math.abs(n)?n:u:n>0&&(e.offsetHeight>i?a.scrollTop+=n:a.scrollTop+=s>n?n:s),t.position.top+=a.scrollTop-f}}}};u.registeredPlugins=[],u.registerPlugin=function(e){u.registeredPlugins.push(e)},u.prototype.resizable=function(e,t){return this},u.prototype.draggable=function(e,t){return this},u.prototype.droppable=function(e,t){return this},u.prototype.isDroppable=function(e){return!1},u.prototype.on=function(e,t,n){return this};var a=0,f=function(e,t,n,r,i){this.column=e||12,this.float=n||!1,this.maxRow=r||0,this.nodes=i||[],this.onchange=t||function(){},this._addedNodes=[],this._removedNodes=[],this._batchMode=!1};f.prototype.batchUpdate=function(){if(this._batchMode)return;this._batchMode=!0,this._prevFloat=this.float,this.float=!0},f.prototype.commit=function(){if(!this._batchMode)return;this._batchMode=!1,this.float=this._prevFloat,delete this._prevFloat,this._packNodes(),this._notify()},f.prototype.getNodeDataByDOMEl=function(e){return this.nodes.find(function(t){return e===t.el})},f.prototype._fixCollisions=function(e){var t=this;this._sortNodes(-1);var n=e,r=Boolean(this.nodes.find(function(e){return e.locked}));!this.float&&!r&&(n={x:0,y:e.y,width:this.column,height:e.height});for(;;){var i=this.nodes.find(o._collisionNodeCheck,{node:e,nn:n});if(!i)return;var s;i.locked?s=this.moveNode(e,e.x,i.y+i.height,e.width,e.height,!0):s=this.moveNode(i,i.x,e.y+e.height,i.width,i.height,!0);if(!s)return}},f.prototype.isAreaEmpty=function(e,t,n,r){var i={x:e||0,y:t||0,width:n||1,height:r||1},s=this.nodes.find(function(e){return o.isIntercepted(e,i)});return!s},f.prototype._sortNodes=function(e){this.nodes=o.sort(this.nodes,e,this.column)},f.prototype._packNodes=function(){this._sortNodes(),this.float?this.nodes.forEach(function(e,t){if(e._updating||e._packY===undefined||e.y===e._packY)return;var n=e.y;while(n>=e._packY){var r=this.nodes.slice(0,t).find(o._didCollide,{n:e,newY:n});r||(e._dirty=!0,e.y=n),--n}},this):this.nodes.forEach(function(e,t){if(e.locked)return;while(e.y>0){var n=e.y-1,r=t===0;if(t>0){var i=this.nodes.slice(0,t).find(o._didCollide,{n:e,newY:n});r=i===undefined}if(!r)break;e._dirty=e.y!==n,e.y=n}},this)},f.prototype._prepareNode=function(e,t){e=e||{};if(e.x===undefined||e.y===undefined||e.x===null||e.y===null)e.autoPosition=!0;var n={width:1,height:1,x:0,y:0};return e=o.defaults(e,n),e.x=parseInt(e.x),e.y=parseInt(e.y),e.width=parseInt(e.width),e.height=parseInt(e.height),e.autoPosition=e.autoPosition||!1,e.noResize=e.noResize||!1,e.noMove=e.noMove||!1,Number.isNaN(e.x)&&(e.x=n.x,e.autoPosition=!0),Number.isNaN(e.y)&&(e.y=n.y,e.autoPosition=!0),Number.isNaN(e.width)&&(e.width=n.width),Number.isNaN(e.height)&&(e.height=n.height),e.maxWidth!==undefined&&(e.width=Math.min(e.width,e.maxWidth)),e.maxHeight!==undefined&&(e.height=Math.min(e.height,e.maxHeight)),e.minWidth!==undefined&&(e.width=Math.max(e.width,e.minWidth)),e.minHeight!==undefined&&(e.height=Math.max(e.height,e.minHeight)),e.width>this.column?e.width=this.column:e.width<1&&(e.width=1),this.maxRow&&e.height>this.maxRow?e.height=this.maxRow:e.height<1&&(e.height=1),e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.x+e.width>this.column&&(t?e.width=this.column-e.x:e.x=this.column-e.width),this.maxRow&&e.y+e.height>this.maxRow&&(t?e.height=this.maxRow-e.y:e.y=this.maxRow-e.height),e},f.prototype._notify=function(){if(this._batchMode)return;var e=Array.prototype.slice.call(arguments,0);e[0]=e[0]===undefined?[]:Array.isArray(e[0])?e[0]:[e[0]],e[1]=e[1]===undefined?!0:e[1];var t=e[0].concat(this.getDirtyNodes());this.onchange(t,e[1])},f.prototype.cleanNodes=function(){if(this._batchMode)return;this.nodes.forEach(function(e){delete e._dirty})},f.prototype.getDirtyNodes=function(e){if(e){var t=[];return this.nodes.forEach(function(e){e._dirty&&(e.y===e._origY&&e.x===e._origX&&e.width===e._origW&&e.height===e._origH?delete e._dirty:t.push(e))}),t}return this.nodes.filter(function(e){return e._dirty})},f.prototype.addNode=function(e,t){e=this._prepareNode(e),e._id=e._id||++a;if(e.autoPosition){this._sortNodes();for(var n=0;;++n){var r=n%this.column,i=Math.floor(n/this.column);if(r+e.width>this.column)continue;if(!this.nodes.find(o._isAddNodeIntercepted,{x:r,y:i,node:e})){e.x=r,e.y=i,delete e.autoPosition;break}}}return this.nodes.push(e),t&&this._addedNodes.push(e),this._fixCollisions(e),this._packNodes(),this._notify(),e},f.prototype.removeNode=function(e,t){t=t===undefined?!0:t,this._removedNodes.push(e),e._id=null,this.nodes=o.without(this.nodes,e),this._packNodes(),this._notify(e,t)},f.prototype.removeAll=function(e){delete this._layouts;if(this.nodes.length===0)return;e=e===undefined?!0:e,this.nodes.forEach(function(e){e._id=null}),this._removedNodes=this.nodes,this.nodes=[],this._notify(this._removedNodes,e)},f.prototype.canMoveNode=function(t,n,r,i,s){if(!this.isNodeChangedPosition(t,n,r,i,s))return!1;var o=Boolean(this.nodes.find(function(e){return e.locked}));if(!this.maxRow&&!o)return!0;var u,a=new f(this.column,null,this.float,0,this.nodes.map(function(n){return n===t?(u=e.extend({},n),u):e.extend({},n)}));if(!u)return!0;a.moveNode(u,n,r,i,s);var l=!0;return o&&(l&=!Boolean(a.nodes.find(function(e){return e!==u&&Boolean(e.locked)&&Boolean(e._dirty)}))),this.maxRow&&(l&=a.getRow()<=this.maxRow),l},f.prototype.canBePlacedWithRespectToHeight=function(t){if(!this.maxRow)return!0;var n=new f(this.column,null,this.float,0,this.nodes.map(function(t){return e.extend({},t)}));return n.addNode(t),n.getRow()<=this.maxRow},f.prototype.isNodeChangedPosition=function(e,t,n,r,i){return typeof t!="number"&&(t=e.x),typeof n!="number"&&(n=e.y),typeof r!="number"&&(r=e.width),typeof i!="number"&&(i=e.height),e.maxWidth!==undefined&&(r=Math.min(r,e.maxWidth)),e.maxHeight!==undefined&&(i=Math.min(i,e.maxHeight)),e.minWidth!==undefined&&(r=Math.max(r,e.minWidth)),e.minHeight!==undefined&&(i=Math.max(i,e.minHeight)),e.x===t&&e.y===n&&e.width===r&&e.height===i?!1:!0},f.prototype.moveNode=function(e,t,n,r,i,s){if(e.locked)return null;typeof t!="number"&&(t=e.x),typeof n!="number"&&(n=e.y),typeof r!="number"&&(r=e.width),typeof i!="number"&&(i=e.height);var o=e.width!==r||e.height!==i,u={x:t,y:n,width:r,height:i,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:e.minHeight};return u=this._prepareNode(u,o),e.x===u.x&&e.y===u.y&&e.width===u.width&&e.height===u.height?null:(e._dirty=!0,e.x=e.lastTriedX=u.x,e.y=e.lastTriedY=u.y,e.width=e.lastTriedWidth=u.width,e.height=e.lastTriedHeight=u.height,this._fixCollisions(e),s||(this._packNodes(),this._notify()),e)},f.prototype.getRow=function(){return this.nodes.reduce(function(e,t){return Math.max(e,t.y+t.height)},0)},f.prototype.beginUpdate=function(e){if(e._updating)return;e._updating=!0,this.nodes.forEach(function(e){e._packY=e.y})},f.prototype.endUpdate=function(){var e=this.nodes.find(function(e){return e._updating});e&&(e._updating=!1,this.nodes.forEach(function(e){delete e._packY}))};var l=function(t,n){var a=this,l,c,h;n=n||{},this.$el=e(t),this.el=this.$el.get(0),r(n,"width","column","v0.5.3"),r(n,"height","maxRow","v0.5.3"),i(n,"oneColumnModeClass","v0.6.3",". Use class `.grid-stack-1` instead"),s(this.$el,"data-gs-width","data-gs-column","v0.5.3"),s(this.$el,"data-gs-height","data-gs-max-row","v0.5.3"),s(this.$el,"data-gs-current-height","data-gs-current-row","v1.0.0"),n.itemClass=n.itemClass||"grid-stack-item";var p=this.$el.closest("."+n.itemClass).length>0;n.row&&(n.minRow=n.maxRow=n.row,delete n.row);var d=parseInt(this.$el.attr("data-gs-row"));this.opts=o.defaults(n,{column:parseInt(this.$el.attr("data-gs-column"))||12,minRow:d?d:parseInt(this.$el.attr("data-gs-min-row"))||0,maxRow:d?d:parseInt(this.$el.attr("data-gs-max-row"))||0,itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,styleInHead:!1,cellHeight:30,verticalMargin:20,auto:!0,minWidth:768,"float":!1,staticGrid:!1,_class:"grid-stack-instance-"+(Math.random()*1e4).toFixed(0),animate:Boolean(this.$el.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:n.alwaysShowResizeHandle||!1,resizable:o.defaults(n.resizable||{},{autoHide:!n.alwaysShowResizeHandle&&!0,handles:"se"}),draggable:o.defaults(n.draggable||{},{handle:(n.handleClass?"."+n.handleClass:n.handle?n.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:n.disableDrag||!1,disableResize:n.disableResize||!1,rtl:"auto",removable:!1,removableOptions:o.defaults(n.removableOptions||{},{accept:"."+n.itemClass}),removeTimeout:2e3,verticalMarginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:n.disableOneColumnMode||!1,oneColumnModeDomSort:n.oneColumnModeDomSort,ddPlugin:null}),this.opts.ddPlugin===!1?this.opts.ddPlugin=u:this.opts.ddPlugin===null&&(this.opts.ddPlugin=u.registeredPlugins[0]||u),this.dd=new this.opts.ddPlugin(this),this.opts.rtl==="auto"&&(this.opts.rtl=this.$el.css("direction")==="rtl"),this.opts.rtl&&this.$el.addClass("grid-stack-rtl"),this.opts.isNested=p,h=this.opts.cellHeight==="auto",h?a.cellHeight(a.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.$el.addClass(this.opts._class),this._setStaticClass(),p&&this.$el.addClass("grid-stack-nested"),this._initStyles(),this.engine=new f(this.opts.column,function(t,n){n=n===undefined?!0:n;var r=0;this.nodes.forEach(function(e){r=Math.max(r,e.y+e.height)}),t.forEach(function(t){n&&t._id===null?t.el&&e(t.el).remove():e(t.el).attr("data-gs-x",t.x).attr("data-gs-y",t.y).attr("data-gs-width",t.width).attr("data-gs-height",t.height)}),a._updateStyles(r+10)},this.opts.float,this.opts.maxRow);if(this.opts.auto){var v=[],m=this;this.$el.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(t,n){n=e(n);var r=parseInt(n.attr("data-gs-x")),i=parseInt(n.attr("data-gs-y"));v.push({el:n.get(0),i:(Number.isNaN(r)?1e3:r)+(Number.isNaN(i)?1e3:i)*m.opts.column})}),o.sortBy(v,function(e){return e.i}).forEach(function(e){this._prepareElement(e.el)},this)}this.engine._saveInitial(),this.setAnimation(this.opts.animate),this.placeholder=e('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'">'+'<div class="placeholder-content">'+this.opts.placeholderText+"</div></div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=o.throttle(function(){a.cellHeight(a.cellWidth(),!1)},100),this.onResizeHandler=function(){h&&a._updateHeightsOnResize();if(!a.opts.disableOneColumnMode&&(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=a.opts.minWidth){if(a.oneColumnMode)return;a.oneColumnMode=!0,a.column(1)}else{if(!a.oneColumnMode)return;a.oneColumnMode=!1,a.column(a._prevColumn)}},e(window).resize(this.onResizeHandler),this.onResizeHandler();if(!a.opts.staticGrid&&typeof a.opts.removable=="string"){var g=e(a.opts.removable);this.dd.isDroppable(g)||this.dd.droppable(g,a.opts.removableOptions),this.dd.on(g,"dropover",function(t,n){var r=e(n.draggable),i=r.data("_gridstack_node");if(!i||i._grid!==a)return;r.data("inTrashZone",!0),a._setupRemovingTimeout(r)}).on(g,"dropout",function(t,n){var r=e(n.draggable),i=r.data("_gridstack_node");if(!i||i._grid!==a)return;r.data("inTrashZone",!1),a._clearRemovingTimeout(r)})}if(!a.opts.staticGrid&&a.opts.acceptWidgets){var y=null,b=function(e,t){var n=y,r=n.data("_gridstack_node"),i=a.getCellFromPixel({left:e.pageX,top:e.pageY},!0),s=Math.max(0,i.x),o=Math.max(0,i.y);r._added||(r._added=!0,r.el=n.get(0),r.autoPosition=!0,r.x=s,r.y=o,a.engine.cleanNodes(),a.engine.beginUpdate(r),a.engine.addNode(r),a.$el.append(a.placeholder),a.placeholder.attr("data-gs-x",r.x).attr("data-gs-y",r.y).attr("data-gs-width",r.width).attr("data-gs-height",r.height).show(),r.el=a.placeholder.get(0),r._beforeDragX=r.x,r._beforeDragY=r.y,a._updateContainerHeight());if(!a.engine.canMoveNode(r,s,o))return;a.engine.moveNode(r,s,o),a._updateContainerHeight()};this.dd.droppable(a.$el,{accept:function(t){t=e(t);var n=t.data("_gridstack_node");return n&&n._grid===a?!1:t.is(a.opts.acceptWidgets===!0?".grid-stack-item":a.opts.acceptWidgets)}}).on(a.$el,"dropover",function(t,n){var r=e(n.draggable),i,s,o=r.data("_gridstack_node");if(!o||!o.width||!o.height){var u=parseInt(r.attr("data-gs-width"));u>0&&(o=o||{},o.width=u);var f=parseInt(r.attr("data-gs-height"));f>0&&(o=o||{},o.height=f)}var l=a.cellWidth(),c=a.cellHeight(),h=a.opts.verticalMargin;i=o&&o.width?o.width:Math.ceil(r.outerWidth()/l),s=o&&o.height?o.height:Math.round((r.outerHeight()+h)/(c+h)),y=r;var p=a.engine._prepareNode({width:i,height:s,_added:!1,_temporary:!0});return p.isOutOfGrid=!0,r.data("_gridstack_node",p),r.data("_gridstack_node_orig",o),r.on("drag",b),!1}).on(a.$el,"dropout",function(t,n){var r=e(n.draggable);if(!r.data("_gridstack_node"))return;var i=r.data("_gridstack_node");if(!i.isOutOfGrid)return;return r.unbind("drag",b),i.el=null,a.engine.removeNode(i),a.placeholder.detach(),a._updateContainerHeight(),r.data("_gridstack_node",r.data("_gridstack_node_orig")),!1}).on(a.$el,"drop",function(t,n){a.placeholder.detach();var r=e(n.draggable).data("_gridstack_node");r.isOutOfGrid=!1,r._grid=a;var i=e(n.draggable).clone(!1);i.data("_gridstack_node",r);var s=e(n.draggable).data("_gridstack_node_orig");return s!==undefined&&s._grid!==undefined&&s._grid._triggerRemoveEvent(),e(n.helper).remove(),r.el=i.get(0),a.placeholder.hide(),o.removePositioningStyles(i),i.find("div.ui-resizable-handle").remove(),i.attr("data-gs-x",r.x).attr("data-gs-y",r.y).attr("data-gs-width",r.width).attr("data-gs-height",r.height).addClass(a.opts.itemClass).enableSelection().removeData("draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled").unbind("drag",b),a.$el.append(i),a._prepareElementsByNode(i,r),a._updateContainerHeight(),a.engine._addedNodes.push(r),a._triggerAddEvent(),a._triggerChangeEvent(),a.engine.endUpdate(),e(n.draggable).unbind("drag",b),e(n.draggable).removeData("_gridstack_node"),e(n.draggable).removeData("_gridstack_node_orig"),a.$el.trigger("dropped",[s,r]),!1})}};return l.prototype.getAll=function(){return this.engine.nodes},l.prototype.getByRid=function(e){return this.engine.nodes.find(function(t){return e===t.rid})},l.prototype.removeNode=function(e){this.engine.removeNode(this.getByRid(e))},l.prototype._triggerChangeEvent=function(){if(this.engine._batchMode)return;var e=this.engine.getDirtyNodes(!0);e&&e.length&&(this.engine._layoutsNodesChange(e),this._triggerEvent("change",e)),this.engine._saveInitial()},l.prototype._triggerAddEvent=function(){if(this.engine._batchMode)return;this.engine._addedNodes&&this.engine._addedNodes.length>0&&(this.engine._layoutsNodesChange(this.engine._addedNodes),this.engine._addedNodes.forEach(function(e){delete e._dirty}),this._triggerEvent("added",this.engine._addedNodes),this.engine._addedNodes=[])},l.prototype._triggerRemoveEvent=function(){if(this.engine._batchMode)return;this.engine._removedNodes&&this.engine._removedNodes.length>0&&(this._triggerEvent("removed",this.engine._removedNodes),this.engine._removedNodes=[])},l.prototype._triggerEvent=function(e,t){var n=new CustomEvent(e,{detail:t});this.el.dispatchEvent(n)},l.prototype._initStyles=function(){this._stylesId&&o.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(Math.random()*1e5).toFixed();var e=this.opts.styleInHead?undefined:this.el.parentNode;this._styles=o.createStylesheet(this._stylesId,e),this._styles!==null&&(this._styles._max=0)},l.prototype._updateStyles=function(e){if(this._styles===null||this._styles===undefined)return;var t="."+this.opts._class+" ."+this.opts.itemClass,n=this,r;e===undefined&&(e=this._styles._max),this._initStyles(),this._updateContainerHeight();if(!this.opts.cellHeight)return;if(this._styles._max!==0&&e<=this._styles._max)return;!this.opts.verticalMargin||this.opts.cellHeightUnit===this.opts.verticalMarginUnit?r=function(e,t){return n.opts.cellHeight*e+n.opts.verticalMargin*t+n.opts.cellHeightUnit}:r=function(e,t){return!e||!t?n.opts.cellHeight*e+n.opts.verticalMargin*t+n.opts.cellHeightUnit:"calc("+(n.opts.cellHeight*e+n.opts.cellHeightUnit)+" + "+(n.opts.verticalMargin*t+n.opts.verticalMarginUnit)+")"},this._styles._max===0&&o.insertCSSRule(this._styles,t,"min-height: "+r(1,0)+";",0);if(e>this._styles._max){for(var i=this._styles._max;i<e;++i)o.insertCSSRule(this._styles,t+'[data-gs-height="'+(i+1)+'"]',"height: "+r(i+1,i)+";",i),o.insertCSSRule(this._styles,t+'[data-gs-min-height="'+(i+1)+'"]',"min-height: "+r(i+1,i)+";",i),o.insertCSSRule(this._styles,t+'[data-gs-max-height="'+(i+1)+'"]',"max-height: "+r(i+1,i)+";",i),o.insertCSSRule(this._styles,t+'[data-gs-y="'+i+'"]',"top: "+r(i,i)+";",i);this._styles._max=e}},l.prototype._updateContainerHeight=function(){if(this.engine._batchMode)return;var e=this.engine.getRow();e<this.opts.minRow&&(e=this.opts.minRow);var t=parseInt(this.$el.css("min-height"));if(t>0){var n=this.opts.verticalMargin,r=Math.round((t+n)/(this.cellHeight()+n));e<r&&(e=r)}this.$el.attr("data-gs-current-row",e);if(!this.opts.cellHeight)return;this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.$el.css("height",e*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.$el.css("height","calc("+(e*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(e*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.$el.css("height",e*this.opts.cellHeight+this.opts.cellHeightUnit)},l.prototype._setupRemovingTimeout=function(t){var n=this,r=e(t).data("_gridstack_node");if(r._removeTimeout||!n.opts.removable)return;r._removeTimeout=setTimeout(function(){t.addClass("grid-stack-item-removing"),r._isAboutToRemove=!0},n.opts.removeTimeout)},l.prototype._clearRemovingTimeout=function(t){var n=e(t).data("_gridstack_node");if(!n._removeTimeout)return;clearTimeout(n._removeTimeout),n._removeTimeout=null,t.removeClass("grid-stack-item-removing"),n._isAboutToRemove=!1},l.prototype._prepareElementsByNode=function(t,n){var r=this,i,s,u=function(u,a){var f=Math.round(a.position.left/i),l=Math.floor((a.position.top+s/2)/s),c,h;if(u.type==="drag"){var p=a.position.top-n._prevYPix;n._prevYPix=a.position.top,o.updateScrollPosition(t[0],a,p);if(t.data("inTrashZone")||f<0||f>=r.engine.column||l<0||!r.engine.float&&l>r.engine.getRow()){if(!!n._temporaryRemoved)return;r.opts.removable===!0&&r._setupRemovingTimeout(t),f=n._beforeDragX,l=n._beforeDragY,r.placeholder.detach(),r.placeholder.hide(),r.engine.removeNode(n),r._updateContainerHeight(),n._temporaryRemoved=!0}else r._clearRemovingTimeout(t),n._temporaryRemoved&&(r.engine.addNode(n),r.placeholder.attr("data-gs-x",f).attr("data-gs-y",l).attr("data-gs-width",c).attr("data-gs-height",h).show(),r.$el.append(r.placeholder),n.el=r.placeholder.get(0),n._temporaryRemoved=!1)}else if(u.type==="resize"){if(f<0)return;c=Math.round(a.size.width/i),h=Math.round((a.size.height+r.verticalMargin())/s)}var d=c!==undefined?c:n.lastTriedWidth,v=h!==undefined?h:n.lastTriedHeight;if(!r.engine.canMoveNode(n,f,l,c,h)||n.lastTriedX===f&&n.lastTriedY===l&&n.lastTriedWidth===d&&n.lastTriedHeight===v)return;n.lastTriedX=f,n.lastTriedY=l,n.lastTriedWidth=c,n.lastTriedHeight=h,r.engine.moveNode(n,f,l,c,h),r._updateContainerHeight(),u.type==="resize"&&e(u.target).trigger("gsresize",n)},a=function(o,u){r.$el.append(r.placeholder);var a=e(this);r.engine.cleanNodes(),r.engine.beginUpdate(n),i=r.cellWidth();var f=r.cellHeight();s=(r.$el.height()+r.verticalMargin())/parseInt(r.$el.attr("data-gs-current-row")),r.placeholder.attr("data-gs-x",a.attr("data-gs-x")).attr("data-gs-y",a.attr("data-gs-y")).attr("data-gs-width",a.attr("data-gs-width")).attr("data-gs-height",a.attr("data-gs-height")).show(),n.el=r.placeholder.get(0),n._beforeDragX=n.x,n._beforeDragY=n.y,n._prevYPix=u.position.top;var l=n.minHeight||1,c=r.opts.verticalMargin;r.dd.resizable(t,"option","minWidth",i*(n.minWidth||1)),r.dd.resizable(t,"option","minHeight",f*l+(l-1)*c),o.type==="resizestart"&&a.find(".grid-stack-item").trigger("resizestart")},f=function(i,s){var u=e(this);if(!u.data("_gridstack_node"))return;r.placeholder.detach(),n.el=u.get(0),r.placeholder.hide();if(n._isAboutToRemove){var a=t.data("_gridstack_node")._grid;a._triggerRemoveEvent(),t.removeData("_gridstack_node"),t.remove()}else r._clearRemovingTimeout(t),n._temporaryRemoved?(o.removePositioningStyles(u),u.attr("data-gs-x",n._beforeDragX).attr("data-gs-y",n._beforeDragY).attr("data-gs-width",n.width).attr("data-gs-height",n.height),n.x=n._beforeDragX,n.y=n._beforeDragY,n._temporaryRemoved=!1,r.engine.addNode(n)):(o.removePositioningStyles(u),u.attr("data-gs-x",n.x).attr("data-gs-y",n.y).attr("data-gs-width",n.width).attr("data-gs-height",n.height));r._updateContainerHeight(),r._triggerChangeEvent(),r.engine.endUpdate();var f=u.find(".grid-stack");f.length&&i.type==="resizestop"&&(f.each(function(e,t){t.gridstack.onResizeHandler()}),u.find(".grid-stack-item").trigger("resizestop"),u.find(".grid-stack-item").trigger("gsresizestop")),i.type==="resizestop"&&r.$el.trigger("gsresizestop",u)};this.dd.draggable(t,{start:a,stop:f,drag:u}).resizable(t,{start:a,stop:f,resize:u}),(n.noMove||this.opts.disableDrag||this.opts.staticGrid)&&this.dd.draggable(t,"disable"),(n.noResize||this.opts.disableResize||this.opts.staticGrid)&&this.dd.resizable(t,"disable"),this._writeAttr(t,n)},l.prototype._prepareElement=function(t,n){n=n!==undefined?n:!1;var r=this;t=e(t),t.addClass(this.opts.itemClass);var i=this._readAttr(t,{el:t.get(0),_grid:r});i=r.engine.addNode(i,n),t.data("_gridstack_node",i),this._prepareElementsByNode(t,i)},l.prototype._writeAttr=function(t,n){if(!n)return;t=e(t),n.x!==undefined&&t.attr("data-gs-x",n.x),n.y!==undefined&&t.attr("data-gs-y",n.y),n.width!==undefined&&t.attr("data-gs-width",n.width),n.height!==undefined&&t.attr("data-gs-height",n.height),n.autoPosition!==undefined&&t.attr("data-gs-auto-position",n.autoPosition?!0:null),n.minWidth!==undefined&&t.attr("data-gs-min-width",n.minWidth),n.maxWidth!==undefined&&t.attr("data-gs-max-width",n.maxWidth),n.minHeight!==undefined&&t.attr("data-gs-min-height",n.minHeight),n.maxHeight!==undefined&&t.attr("data-gs-max-height",n.maxHeight),n.noResize!==undefined&&t.attr("data-gs-no-resize",n.noResize?!0:null),n.noMove!==undefined&&t.attr("data-gs-no-move",n.noMove?!0:null),n.locked!==undefined&&t.attr("data-gs-locked",n.locked?!0:null),n.resizeHandles!==undefined&&t.attr("data-gs-resize-handles",n.resizeHandles),n.id!==undefined&&t.attr("data-gs-id",n.id)},l.prototype._readAttr=function(t,n){return t=e(t),n=n||{},n.x=t.attr("data-gs-x"),n.y=t.attr("data-gs-y"),n.width=t.attr("data-gs-width"),n.height=t.attr("data-gs-height"),n.autoPosition=o.toBool(t.attr("data-gs-auto-position")),n.maxWidth=t.attr("data-gs-max-width"),n.minWidth=t.attr("data-gs-min-width"),n.maxHeight=t.attr("data-gs-max-height"),n.minHeight=t.attr("data-gs-min-height"),n.noResize=o.toBool(t.attr("data-gs-no-resize")),n.noMove=o.toBool(t.attr("data-gs-no-move")),n.locked=o.toBool(t.attr("data-gs-locked")),n.resizeHandles=t.attr("data-gs-resize-handles"),n.id=t.attr("data-gs-id"),n},l.prototype.setAnimation=function(e){e?this.$el.addClass("grid-stack-animate"):this.$el.removeClass("grid-stack-animate")},l.prototype.addWidget=function(t,n,r,i,s,u,a,f,l,c,h){if(n!==undefined&&typeof n!="object")return this.addWidget(t,{x:n,y:r,width:i,height:s,autoPosition:u,minWidth:a,maxWidth:f,minHeight:l,maxHeight:c,id:h});t=e(t);if(n){var p=this._readAttr(t);o.defaults(n,p),this.engine._prepareNode(n)}return this._writeAttr(t,n),this.$el.append(t),this.makeWidget(t)},l.prototype.makeWidget=function(t){return t=e(t),this._prepareElement(t,!0),this._updateContainerHeight(),this._triggerAddEvent(),this._triggerChangeEvent(!0),t.get(0)},l.prototype.willItFit=function(e,t,n,r,i){var s={x:e,y:t,width:n,height:r,autoPosition:i};return this.engine.canBePlacedWithRespectToHeight(s)},l.prototype.removeWidget=function(t,n){t=e(t);var r=t.data("_gridstack_node");r||(r=this.engine.getNodeDataByDOMEl(t.get(0)));if(!r||r.el.parentElement!==this.el)return;t.removeData("_gridstack_node"),this.dd.draggable(t,"destroy").resizable(t,"destroy"),this.engine.removeNode(r,n),this._triggerRemoveEvent(),this._triggerChangeEvent(!0)},l.prototype.removeAll=function(t){this.engine.nodes.forEach(function(t){var n=e(t.el);n.removeData("_gridstack_node"),this.dd.draggable(n,"destroy").resizable(n,"destroy")},this),this.engine.removeAll(t),this._triggerRemoveEvent()},l.prototype.destroy=function(t){e(window).off("resize",this.onResizeHandler),t===!1?(this.removeAll(!1),this.$el.removeClass(this.opts._class),delete this.$el.get(0).gridstack):this.$el.remove(),o.removeStylesheet(this._stylesId),this.engine&&(this.engine=null)},l.prototype.resizable=function(t,n){var r=this;return t=e(t),t.each(function(t,i){i=e(i);var s=i.data("_gridstack_node");if(!s)return;s.noResize=!n&&!0,s.noResize?r.dd.resizable(i,"disable"):r.dd.resizable(i,"enable")}),this},l.prototype.movable=function(t,n){var r=this;return t=e(t),t.each(function(t,i){i=e(i);var s=i.data("_gridstack_node");if(!s)return;s.noMove=!n&&!0,s.noMove?(r.dd.draggable(i,"disable"),i.removeClass("ui-draggable-handle")):(r.dd.draggable(i,"enable"),i.addClass("ui-draggable-handle"))}),this},l.prototype.enableMove=function(e,t){this.movable(this.$el.children("."+this.opts.itemClass),e),t&&(this.opts.disableDrag=!e)},l.prototype.enableResize=function(e,t){this.resizable(this.$el.children("."+this.opts.itemClass),e),t&&(this.opts.disableResize=!e)},l.prototype.disable=function(){this.movable(this.$el.children("."+this.opts.itemClass),!1),this.resizable(this.$el.children("."+this.opts.itemClass),!1),this.$el.trigger("disable")},l.prototype.enable=function(){this.movable(this.$el.children("."+this.opts.itemClass),!0),this.resizable(this.$el.children("."+this.opts.itemClass),!0),this.$el.trigger("enable")},l.prototype.locked=function(t,n){return t=e(t),t.each(function(t,r){r=e(r);var i=r.data("_gridstack_node");if(!i)return;i.locked=n||!1,r.attr("data-gs-locked",i.locked?"yes":null)}),this},l.prototype.maxHeight=function(t,n){return t=e(t),t.each(function(t,r){r=e(r);var i=r.data("_gridstack_node");if(!i)return;isNaN(n)||(i.maxHeight=n||!1,r.attr("data-gs-max-height",n))}),this},l.prototype.minHeight=function(t,n){return t=e(t),t.each(function(t,r){r=e(r);var i=r.data("_gridstack_node");if(!i)return;isNaN(n)||(i.minHeight=n||!1,r.attr("data-gs-min-height",n))}),this},l.prototype.maxWidth=function(t,n){return t=e(t),t.each(function(t,r){r=e(r);var i=r.data("_gridstack_node");if(!i)return;isNaN(n)||(i.maxWidth=n||!1,r.attr("data-gs-max-width",n))}),this},l.prototype.minWidth=function(t,n){return t=e(t),t.each(function(t,r){r=e(r);var i=r.data("_gridstack_node");if(!i)return;isNaN(n)||(i.minWidth=n||!1,r.attr("data-gs-min-width",n))}),this},l.prototype._updateElement=function(t,n){t=e(t).first();var r=t.data("_gridstack_node");if(!r)return;var i=this;i.engine.cleanNodes(),i.engine.beginUpdate(r),n.call(this,t,r),i._updateContainerHeight(),i._triggerChangeEvent(),i.engine.endUpdate()},l.prototype.resize=function(e,t,n){this._updateElement(e,function(e,r){t=t!==null&&t!==undefined?t:r.width,n=n!==null&&n!==undefined?n:r.height,this.engine.moveNode(r,r.x,r.y,t,n)})},l.prototype.move=function(e,t,n){this._updateElement(e,function(e,r){t=t!==null&&t!==undefined?t:r.x,n=n!==null&&n!==undefined?n:r.y,this.engine.moveNode(r,t,n,r.width,r.height)})},l.prototype.update=function(e,t,n,r,i){this._updateElement(e,function(e,s){t=t!==null&&t!==undefined?t:s.x,n=n!==null&&n!==undefined?n:s.y,r=r!==null&&r!==undefined?r:s.width,i=i!==null&&i!==undefined?i:s.height,this.engine.moveNode(s,t,n,r,i)})},l.prototype.compact=function(){if(this.engine.nodes.length===0)return;this.batchUpdate(),this.engine._sortNodes();var e=this.engine.nodes;this.engine.nodes=[],e.forEach(function(e){!e.noMove&&!e.locked&&(e.autoPosition=!0),this.engine.addNode(e,!1),e._dirty=!0},this),this.commit()},l.prototype.verticalMargin=function(e,t){if(e===undefined)return this.opts.verticalMargin;var n=o.parseHeight(e);if(this.opts.verticalMarginUnit===n.unit&&this.opts.maxRow===n.height)return;this.opts.verticalMarginUnit=n.unit,this.opts.verticalMargin=n.height,t||this._updateStyles()},l.prototype.cellHeight=function(e,t){if(e===undefined){if(this.opts.cellHeight&&this.opts.cellHeight!=="auto")return this.opts.cellHeight;var n=this.$el.children("."+this.opts.itemClass).first(),r=n.attr("data-gs-height"),i=this.opts.verticalMargin;return Math.round((n.outerHeight()-(r-1)*i)/r)}var s=o.parseHeight(e);if(this.opts.cellHeightUnit===s.unit&&this.opts.cellHeight===s.height)return;this.opts.cellHeightUnit=s.unit,this.opts.cellHeight=s.height,t||this._updateStyles()},l.prototype.cellWidth=function(){return Math.round(this.$el.outerWidth()/this.opts.column)},l.prototype.getCellFromPixel=function(e,t){var n=t!==undefined&&t?this.$el.offset():this.$el.position(),r=e.left-n.left,i=e.top-n.top,s=Math.floor(this.$el.width()/this.opts.column),o=Math.floor(this.$el.height()/parseInt(this.$el.attr("data-gs-current-row")));return{x:Math.floor(r/s),y:Math.floor(i/o)}},l.prototype.batchUpdate=function(){this.engine.batchUpdate()},l.prototype.commit=function(){this.engine.commit(),this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent()},l.prototype.isAreaEmpty=function(e,t,n,r){return this.engine.isAreaEmpty(e,t,n,r)},l.prototype.setStatic=function(e){this.opts.staticGrid=e===!0,this.enableMove(!e),this.enableResize(!e),this._setStaticClass()},l.prototype._setStaticClass=function(){var e="grid-stack-static";this.opts.staticGrid===!0?this.$el.addClass(e):this.$el.removeClass(e)},f.prototype._layoutsNodesChange=function(e){if(!this._layouts||this._ignoreLayoutsNodeChange)return;this._layouts.forEach(function(t,n){if(!t||n===this.column)return;n<this.column?this._layouts[n]=undefined:e.forEach(function(e){var r=t.find(function(t){return t._id===e._id});if(!r)return;var i=n/this.column;e.y!==e._origY&&(r.y+=e.y-e._origY),e.x!==e._origX&&(r.x=Math.round(e.x*i)),e.width!==e._origW&&(r.width=Math.round(e.width*i))},this)},this)},f.prototype._updateNodeWidths=function(e,t,n){if(!this.nodes.length||e===t)return;var r=[this.nodes.length];this.nodes.forEach(function(e,t){r[t]={x:e.x,y:e.y,width:e.width,_id:e._id}}),this._layouts=this._layouts||[],this._layouts[e]=r;if(t===1&&n&&n.length){var i=0;n.forEach(function(e){e.x=0,e.width=1,e.y=Math.max(e.y,i),i=e.y+e.height})}else n=o.sort(this.nodes,-1,e);var s=this._layouts[t]||[],u=this._layouts.length-1;s.length===0&&t>e&&t<u&&(s=this._layouts[u]||[],s.length&&(e=u,s.forEach(function(e){var t=n.findIndex(function(t){return t&&t._id===e._id});t!==-1&&(n[t].x=e.x,n[t].y=e.y,n[t].width=e.width)}),s=[]));var a=[];s.forEach(function(e){var t=n.findIndex(function(t){return t&&t._id===e._id});t!==-1&&(n[t].x=e.x,n[t].y=e.y,n[t].width=e.width,a.push(n[t]),n[t]=null)});var f=t/e;n.forEach(function(n){if(!n)return;n.x=t===1?0:Math.round(n.x*f),n.width=t===1||e===1?1:Math.round(n.width*f)||1,a.push(n)}),a=o.sort(a,-1,t),this._ignoreLayoutsNodeChange=!0,this.batchUpdate(),this.nodes=[],a.forEach(function(e){this.addNode(e,!1),e._dirty=!0},this),this.commit(),delete this._ignoreLayoutsNodeChange},f.prototype._saveInitial=function(){this.nodes.forEach(function(e){e._origX=e.x,e._origY=e.y,e._origW=e.width,e._origH=e.height,delete e._dirty})},l.prototype.column=function(t,n){if(t===undefined)return this.opts.column;if(this.opts.column===t)return;var r=this.opts.column;t===1?this._prevColumn=r:delete this._prevColumn,this.$el.removeClass("grid-stack-"+r),this.$el.addClass("grid-stack-"+t),this.opts.column=this.engine.column=t;if(n===!0)return;var i;this.opts.oneColumnModeDomSort&&t===1&&(i=[],this.$el.children("."+this.opts.itemClass).each(function(t,n){var r=e(n).data("_gridstack_node");r&&i.push(r)}),i.length||(i=undefined)),this.engine._updateNodeWidths(r,t,i),this.engine._ignoreLayoutsNodeChange=!0,this._triggerChangeEvent(),delete this.engine._ignoreLayoutsNodeChange},l.prototype.float=function(e){if(e===undefined)return this.opts.float||!1;if(this.opts.float===e)return;this.opts.float=this.engine.float=e||!1,e||(this.engine._packNodes(),this.engine._notify(),this._triggerChangeEvent())},l.prototype.getRow=function(){return this.engine.getRow()},l.prototype.on=function(e,t){if(e.indexOf(" ")!==-1){var n=e.split(" ");n.forEach(function(e){this.on(e,t)},this);return}e==="change"||e==="added"||e==="removed"?(this._gsEventHandler=this._gsEventHandler||{},this._gsEventHandler[e]=function(e){t(e,e.detail)},this.el.addEventListener(e,this._gsEventHandler[e])):this.$el.on(e,t)},l.prototype.off=function(e){if(e.indexOf(" ")!==-1){var t=e.split(" ");t.forEach(function(e){this.off(e,callback)},this);return}e==="change"||e==="added"||e==="removed"?this._gsEventHandler&&this._gsEventHandler[e]&&(this.el.removeEventListener(e,this._gsEventHandler[e]),delete this._gsEventHandler[e]):this.$el.off(e)},l.prototype.setGridWidth=n(l.prototype.column,"setGridWidth","column","v0.5.3"),l.prototype.setColumn=n(l.prototype.column,"setColumn","column","v0.6.4"),f.prototype.getGridHeight=n(f.prototype.getRow,"getGridHeight","getRow","v1.0.0"),t.GridStack=l,t.GridStack.Utils=o,t.GridStack.Engine=f,t.GridStack.DragDropPlugin=u,l.init=function(t,n){n||(n=".grid-stack");var r=e(n).get(0);if(!r)return;return r.gridstack||(r.gridstack=new l(r,o.clone(t))),r.gridstack},l.initAll=function(t,n){n||(n=".grid-stack");var r=[];return e(n).each(function(e,n){n.gridstack||(n.gridstack=new l(n,o.clone(t))),r.push(n.gridstack)}),r},t.GridStack});