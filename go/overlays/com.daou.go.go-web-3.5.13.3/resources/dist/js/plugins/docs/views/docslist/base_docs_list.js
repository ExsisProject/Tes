define("docs/views/docslist/base_docs_list",function(require){var e=require("backbone"),t=require("docs/views/docslist/doclist_item"),n=require("hgn!docs/templates/docslist/base_docs_list"),r=require("hgn!docs/templates/docslist/docslist_empty"),i=require("hgn!approval/templates/document/doclist_period"),s=require("i18n!approval/nls/approval"),o=require("i18n!docs/nls/docs"),u=require("docs/views/side"),a=e.View.extend({initialize:function(e){this.options=e||{},this.duration=this.options.duration,this.fromDate=this.options.fromDate,this.toDate=this.options.toDate},events:{"change #duration":"_changeDuration"},render:function(){var e={search_all:s["\uc804\uccb4\uae30\uac04"],search_month:s["\uac1c\uc6d4"],search_year:s["\ub144"],search_input:s["\uae30\uac04\uc785\ub825"]};return this.$el.prepend(i({lang:e})),this.initDatePicker(),this},initDatePicker:function(){var e=this;$.datepicker.setDefaults($.datepicker.regional[GO.config("locale")]),this.$("#fromDate").datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:"",onSelect:function(t){e.$("#toDate").datepicker("option","minDate",t)}}),this.$("#toDate").datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:"",onSelect:function(t){e.$("#fromDate").datepicker("option","maxDate",t)}})},_changeDuration:function(e){var t=this.$("#duration").val();t=="period"?this.$("#durationPeriod").show():this.$("#durationPeriod").hide()},_setDuration:function(){var e=this.duration,t=this.fromDate,n=this.toDate;this.$("#duration").val(e),e=="period"&&(this.$("#durationPeriod").show(),this.$("#fromDate").val(GO.util.toMoment(t).format("YYYY-MM-DD")),this.$("#toDate").val(GO.util.toMoment(n).format("YYYY-MM-DD")))}}),f=e.View.extend({checkboxColumn:null,initialize:function(e){this.options=e||{},this.collection=e.collection,this.initSearchtype=this.collection.searchtype,this.ckeyword=this.collection.keyword,this.initProperty=this.collection.property,this.initDirection=this.collection.direction,this.columns=e.columns,this.sorts=e.sorts,this.duration=this.options.duration,this.fromDate=this.options.fromDate,this.toDate=this.options.toDate,this.usePeriod=e.usePeriod?e.usePeriod:!1,this.usePage=e.usePage?e.usePage:!1,this.checkboxColumn=e.checkboxColumn,this.isCheckboxVisible=e.isCheckboxVisible?e.isCheckboxVisible:!1,this.collection.bind("reset",this.generateList,this),this.collection.fetch({reset:!0})},events:{"keypress input#keyword":"searchByEnter","click .btn_search2":"search","click .sorting":"sort","click .sorting_desc":"sort","click .sorting_asc":"sort","click input:checkbox":"toggleCheckbox"},render:function(){var e={};return this.$el.html(n({lang:e,columns:this.columns,sorts:this.sorts,usePage:this.usePage,checkboxColumn:this.checkboxColumn})),this.usePeriod&&this._renderPeriodView(),this.setInitSort(),this},_renderPeriodView:function(){this.periodView=new a({duration:this.duration||"all",fromDate:this.fromDate,toDate:this.toDate}),this.periodView.setElement($(".table_search")).render(),this.periodView._setDuration()},generateList:function(){var e=this.$el;e.find(".list_docs > tbody").empty();var n=this.columns,i=this.isCheckboxVisible,s="docs",u=this;this.collection.each(function(r){r.folderType=u.collection.folderType;var o=new t({model:r,listType:s,columns:n,isCheckboxVisible:i});e.find(".list_docs > tbody").append(o.render().el)}),this.collection.length==0&&e.find(".list_docs > tbody").html(r({columns:n,lang:{doclist_empty:o["\ubb38\uc11c\uc5c6\uc74c"]}}))},renderPages:function(){this.pageView=new PaginationView({pageInfo:this.collection.pageInfo()}),this.pageView.bind("paging",this.selectPage,this),this.$el.find("div.tool_absolute > div.dataTables_paginate").remove(),this.$el.find("div.tool_absolute").append(this.pageView.render().el)},search:function(){var e=$("#searchtype").val(),t=$.trim($("#keyword").val()),n,r,i;i=$("#duration").val();if(this.usePeriod){n=$("#fromDate").val()||"",r=$("#toDate").val()||"";if(i=="period"&&(n==""||r==""))return $.goMessage(s["\uac80\uc0c9\uae30\uac04\uc744 \uc785\ub825\ud558\uc138\uc694."]),n!=""&&r==""&&$("#toDate").focus(),n==""&&$("#fromDate").focus(),!1}$("input#keyword").attr("placeholder")===this.$el.find("input#keyword").val()&&(t="");if(!t)return $.goMessage(s["\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694."]),$("#keyword").focus(),!1;if(!$.goValidation.isCheckLength(2,64,t))return $.goMessage(GO.i18n(s["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"2",arg2:"64"})),$("#keyword").focus(),!1;this.usePeriod&&(i=="period"?this.collection.setDuration({duration:i,fromDate:GO.util.toISO8601(n),toDate:GO.util.searchEndDate(r)}):this.collection.setDuration({duration:i})),this.collection.setSearch(e,t),this.collection.fetch()},searchByEnter:function(e){if(e.keyCode!=13)return;e&&e.preventDefault(),$(e.currentTarget).focusout().blur(),this.search()},sort:function(e){var t="#"+$(e.currentTarget).attr("id"),n=$(t).attr("sort-id"),r="desc",i="",s="";$(t).hasClass("sorting")&&(i="sorting",s="sorting_desc"),$(t).hasClass("sorting_desc")&&(i="sorting_desc",s="sorting_asc",r="asc"),$(t).hasClass("sorting_asc")&&(i="sorting_asc",s="sorting_desc"),$(t).removeClass(i).addClass(s);var o=this.$el.find("th");o.each(function(){!$(this).hasClass("sorting_disabled")&&"#"+$(this).attr("id")!=t&&($(this).removeClass("sorting").addClass("sorting"),$(this).removeClass("sorting_desc").addClass("sorting"),$(this).removeClass("sorting_asc").addClass("sorting"))}),this.collection.setSort(n,r),this.collection.fetch()},setInitSort:function(){var e=this.initProperty,t=this.initDirection;if(e&&t){var n=null,r=this.$el.find("th");r.each(function(){$(this).attr("sort-id")==e&&(n=$(this).attr("id")),$(this).hasClass("sorting_disabled")||($(this).removeClass("sorting").addClass("sorting"),$(this).removeClass("sorting_desc").addClass("sorting"),$(this).removeClass("sorting_asc").addClass("sorting"))}),$("#"+n).removeClass("sorting").addClass("sorting_"+t),$("#keyword").val(this.ckeyword),this.initSearchtype&&$("#searchtype").val(this.initSearchtype)}},toggleCheckbox:function(e){var t=this.checkboxColumn.id,n=this.checkboxColumn.name,r=$(e.currentTarget),i=$("input#"+t),s=r.is(":checked");r.attr("id")==i.attr("id")&&$('input[type="checkbox"][name="checkbox"]').attr("checked",s),r.hasClass("doclist_item_checkbox")&&(s||i.attr("checked",s))},_renderSide:function(e){this.sideView=new u({}),e.getSideElement().find(".docs_side").length?this.sideView.refreshWaitingCount():(e.getSideElement().empty().append(this.sideView.el),this.sideView.render())}});return f});