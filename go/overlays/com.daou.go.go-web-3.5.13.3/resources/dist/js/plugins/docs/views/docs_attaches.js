define("docs/views/docs_attaches",function(require){var e=require("jquery"),t=require("backbone"),n=require("i18n!nls/commons"),r=require("hgn!docs/templates/docs_attaches"),i=null,s={save:n["\uc800\uc7a5"],preview:n["\ubbf8\ub9ac\ubcf4\uae30"],download:n["\ub2e4\uc6b4\ub85c\ub4dc"]},o=t.View.extend({initialize:function(e){this.options=e||{},this.options.el||(this.tagName="div"),this.attaches=this.options.attaches,this.docsId=this.options.docsId,this.images=[],this.files=[]},events:{"click li a.preview":"preview","click li a.imageview":"showImages","click li a.filedown":"showFiles"},render:function(){var t=this;return e.each(this.attaches,function(e,n){n.size=GO.util.getHumanizedFileSize(n.size),n.thumbSmall&&!GO.util.isMobile()?t.images.push(n):n.thumbSmall&&GO.util.isMobile()&&GO_config.__config__.mobileConfig.useMobilePreview?t.images.push(n):(GO.util.fileExtentionCheck(n.extention)||(n.extention="def"),t.files.push(n))}),this.$el.html(r({lang:s,hasFiles:this.files.length?!0:!1,files:this.files,useMobilePreview:GO_config.__config__.mobileConfig.useMobilePreview,useMobileSecurity:GO_config.__config__.mobileConfig.useMobileSecurity,isMobileApp:GO_config.__config__.isMobileApp,contextRoot:GO.contextRoot,hasImages:this.images.length?!0:!1,isGif:function(){return this.extention.toLowerCase()=="gif"?!0:!1},isMobile:GO.util.isMobile(),images:this.images,docsId:this.docsId})),this.$el.html()},preview:function(t){var n=e(t.currentTarget);return GO.util.preview(n.attr("data-id")),!1},resize:function(t){if(!t)return!1;var n=t.find(".feed_img:not(.length_1)>li[data-resize!=true]"),r=e(n[0]).width();n.length&&e(n).each(function(t,n){var i=e(n);i.height(r).attr("data-resize",!0)})},showImages:function(t){var n=[],r=0,i=e(t.currentTarget),s=i.attr("data-id"),o=i.attr("data-group");if(o){var u=i.parents("ul.img_wrap").find('a[data-group="'+o+'"]');e.each(u,function(t,i){var o=e(i);n.push({fileName:o.attr("title"),url:GO.contextRoot+"api/docs/"+o.attr("data-docsId")+"/download/"+o.attr("data-id")}),o.attr("data-id")==s&&(r=t)})}else n.push({fileName:i.attr("title"),url:GO.contextRoot+"api/docs/"+i.attr("data-docsId")+"/download/"+i.attr("data-id")});return GO.util.attachImages(n,r),!1},showFiles:function(t){var n=e(t.currentTarget),r=n.attr("data-id"),i=n.attr("data-group"),s=location.protocol+"//"+window.location.host,o=GO.contextRoot+"api/docs/"+n.attr("data-docsId")+"/download/"+n.attr("data-id"),u=n.attr("title"),a=n.attr("data-size");return GO.util.attachFiles(s+o,u,a),!1}});return{render:function(e){return i=new o(e),i.render()},resize:function(e){i&&i.resize(e)}}});