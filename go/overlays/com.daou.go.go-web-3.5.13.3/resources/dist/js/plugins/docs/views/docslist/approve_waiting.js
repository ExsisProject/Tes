define("docs/views/docslist/approve_waiting",function(require){var e=require("jquery"),t=require("underscore"),n=require("backbone"),r=require("when"),i=require("app"),s=require("docs/views/base_docs"),o=require("docs/views/docslist/base_docs_list"),u=require("views/pagesize"),a=require("views/pagination"),f=require("docs/views/docslist/doclist_item"),l=require("docs/views/side"),c=require("docs/collections/docs_base_list"),h=require("docs/models/docs_doc_item"),p=require("hgn!docs/templates/docslist/base_docslist"),d=require("hgn!docs/templates/docslist/docslist_empty"),v=require("i18n!nls/commons"),m=require("i18n!docs/nls/docs"),g=require("i18n!approval/nls/approval"),y={"\uc81c\ubaa9":m["\uc81c\ubaa9"],"\ub0b4\uc6a9":v["\ub0b4\uc6a9"],"\ub4f1\ub85d\uc790":m["\ub4f1\ub85d\uc790"],"\uac80\uc0c9":v["\uac80\uc0c9"],placeholder_search:v["\ud50c\ub808\uc774\uc2a4\ud640\ub354\uac80\uc0c9"],search_all:g["\uc804\uccb4\uae30\uac04"],search_month:g["\uac1c\uc6d4"],search_year:g["\ub144"],search_input:g["\uae30\uac04\uc785\ub825"],"\uc77c\uad04\uc2b9\uc778":m["\uc77c\uad04 \uc2b9\uc778"]},b=c.extend({initialize:function(e){c.prototype.initialize.apply(this,arguments),this.folderType=e.folderType},model:h,url:function(){return"/api/docs/folder/approvewaiting?"+this._makeParam()}}),w=n.Model.extend({url:function(){var e="/api/docs/approved";return e}});return s.extend({initialize:function(e){this.initProperty="requestDate",this.initDirection="desc",this.initPage=20,this.ckeyword="",this.collection=new b({folderType:"approvewaiting"}),this.collection.usePeriod=!0;var t=sessionStorage.getItem("list-history-baseUrl"),n=new RegExp("(#)?docs/folder/approvewaiting$");t&&n.test(t)?(this.initProperty=sessionStorage.getItem("list-history-property"),this.initDirection=sessionStorage.getItem("list-history-direction"),this.initSearchtype=sessionStorage.getItem("list-history-searchtype"),this.ckeyword=sessionStorage.getItem("list-history-keyword").replace(/\+/gi," "),this.duration=sessionStorage.getItem("list-history-duration"),this.fromDate=sessionStorage.getItem("list-history-fromDate"),this.toDate=sessionStorage.getItem("list-history-toDate"),this.collection.setListParam()):(this.collection.pageSize=this.initPage,this.collection.setDuration(),this.collection.setSort(this.initProperty,this.initDirection)),sessionStorage.clear(),this.collection.bind("reset",this.resetList,this),s.prototype.initialize.apply(this,arguments)},columns:{"\uc120\ud0dd":v["\uc120\ud0dd"],"\ub4f1\ub85d\uc694\uccad\uc77c":m["\ub4f1\ub85d \uc694\uccad\uc77c"],"\uc81c\ubaa9":m["\uc81c\ubaa9"],"\ucca8\ubd80":m["\ucca8\ubd80"],"\ubb38\uc11c\uc704\uce58":m["\uc704\uce58"],"\ub4f1\ub85d\uc790":m["\ub4f1\ub85d\uc790"],"\ubb38\uc11c\ubc88\ud638":m["\ubb38\uc11c\ubc88\ud638"],count:7},sorts:{"\ub4f1\ub85d\uc694\uccad\uc77c":"requestDate","\uc81c\ubaa9":"title","\ub4f1\ub85d\uc790":"creatorName"},render:function(){return s.prototype.render.apply(this,arguments),e("#content header h1").text(m["\uc2b9\uc778 \ub300\uae30 \ubb38\uc11c"]),this.$el.html(p({lang:y,usePage:!0,useToolbar:!0,isApproveWaiting:!0})),this._renderApproveWaitingList(),this._renderPageSize(),this._renderPages(),this},_renderPageSize:function(){this.pageSizeView=new u({pageSize:this.collection.pageSize}),this.pageSizeView.render(),this.pageSizeView.bind("changePageSize",this.selectPageSize,this)},_renderPages:function(){this.pageView=new a({pageInfo:this.collection.pageInfo()}),this.pageView.bind("paging",this.selectPage,this),this.$el.find("div.tool_absolute > div.dataTables_paginate").remove(),this.$el.find("div.tool_absolute").append(this.pageView.render().el)},selectPage:function(e){this.collection.setPageNo(e),this.collection.fetch()},selectPageSize:function(e){this.collection.setPageSize(e),this.collection.fetch()},_renderApproveWaitingList:function(){this.checkboxColumn={id:"checkedAllApproveWaitingDocs",name:"checkedAllApproveWaitingDocs"};var e=new o({collection:this.collection,columns:this.columns,sorts:this.sorts,usePeriod:!0,duration:this.duration,fromDate:this.fromDate,toDate:this.toDate,usePage:!0,isCheckboxVisible:!0,checkboxColumn:this.checkboxColumn});this.$el.find("#base_doclist").append(e.render().el),e.setInitSort(),this._bindEvent(e)},_bindEvent:function(e){var t=this;this.$el.find("input#keyword").keydown(function(t){e.searchByEnter(t)}),this.$el.find(".btn_search2").click(function(t){e.search()}),this.$el.find("input:checkbox").click(function(t){e.toggleCheckbox(t)}),this.$el.find("a#bulkApproved").click(function(e){t._bulkApproved(e)})},_bulkApproved:function(t){var n=e("input.doclist_item_checkbox:checked"),r=this;if(n.length<1){e.goMessage(m["\uc120\ud0dd\ubb38\uc11c\uc5c6\uc74c"]);return}var i=[];n.each(function(){i.push(e(this).attr("data-id"))});var s=new w;e.goConfirm(m["\uc77c\uad04\uc2b9\uc778\ud655\uc778"],"",function(){var t=e.goPreloader();s.set({ids:i}),s.save({},{silent:!0,type:"PUT",beforeSend:function(){t.render()},success:function(){e.goMessage(m["\uc77c\uad04\uc2b9\uc778\uc644\ub8cc"]),e("input:checkbox").attr("checked",!1),r.collection.fetch()},error:function(){e.goError(v["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."])},complete:function(){t.release()}})})},resetList:function(t){var n=this.collection.url().replace("/api/",""),r=i.router.getUrl().replace("#","");r.indexOf("?")<0?i.router.navigate(n,{replace:!0}):r!=n&&i.router.navigate(n,{trigger:!1,pushState:!0}),e(".list_docs > tbody").empty();var s=this.columns,o="docs",u=this;t.each(function(t){t.folderType=u.collection.folderType;var n=new f({model:t,listType:o,columns:s,isCheckboxVisible:!0});e(".list_docs > tbody").append(n.render().el)}),t.length==0&&e(".list_docs > tbody").html(d({columns:s,lang:{doclist_empty:m["\ubb38\uc11c\uc5c6\uc74c"]}})),this.renderPages(),this.renderSide()},renderSide:function(){this.sideView=new l({}),this.sideView.refreshWaitingCount()},renderPages:function(){this.pageView=new a({pageInfo:this.collection.pageInfo()}),this.pageView.bind("paging",this.selectPage,this),this.$el.find("div.tool_absolute > div.dataTables_paginate").remove(),this.$el.find("div.tool_absolute").append(this.pageView.render().el)}})});