define("docs/views/detail",function(require){var e=require("docs/views/base_docs"),t=require("docs/views/content_top"),n=require("docs/models/doc_folder_info"),r=require("docs/models/docs_doc_item"),i=require("hgn!docs/templates/detail"),s=require("docs/views/docs_action"),o=require("docs/views/docs_detail_body"),u=require("docs/views/docs_reply"),a=require("docs/views/docs_reject"),f=require("i18n!docs/nls/docs"),l=require("docs/views/side");return e.extend({events:{"click a#docsReason":"setDocsContents"},initialize:function(t){e.prototype.initialize.apply(this,arguments),this.options=t,this.docsId=this.options.docsId},dataFetch:function(){var e=$.Deferred(),t=$.Deferred(),i=this,s=sessionStorage.getItem("list-folderType");this.docsId?(this.docsModel=new r({id:this.docsId}),s!="undefined"&&s!=null&&(this.docsModel.folderType=s,this.docsModel.type="folderType"),this.docsModel.fetch({statusCode:{400:function(){GO.util.error("404",{msgCode:"400-common"})},403:function(){GO.util.error("403",{msgCode:"400-common"})},404:function(){GO.util.error("404",{msgCode:"400-common"})},500:function(){GO.util.error("500")}}}).done($.proxy(function(){t.resolve(),this.folderId=this.docsModel.getFolderId(),this.folderModel=new n({id:this.folderId}),this.folderModel.fetch({statusCode:{400:function(){GO.util.error("404",{msgCode:"400-common"})},403:function(){GO.util.error("403",{msgCode:"400-common"})},404:function(){GO.util.error("404",{msgCode:"400-common"})},500:function(){GO.util.error("500")}}}).done(function(){e.resolve()})},this))):(t.resolve(),e.resolve());var o=$.Deferred();return $.when(t,e).done(function(){o.resolve(i)}),o},render:function(){return e.prototype.render.apply(this,arguments),GO.EventEmitter.trigger("common","layout:setOverlay",!0),$(document.body).addClass("do_docs"),this.$el.html(i({})),this._renderAction(),this._renderBody(),this.$("#rejectArea").hide(),this.docsModel.isNeedState()?($("#bottomArea").hide(),this.docsModel.getDocsStatus()=="REJECT"&&($("#rejectArea").show(),this._renderReject())):($("#bottomArea").show(),this._renderReply()),GO.EventEmitter.trigger("common","layout:clearOverlay",!0),this},renderForPrint:function(){return $(document.body).addClass("do_docs"),this.$el.html(i({isPrint:!0})),this._renderBody(!0),this},_renderReject:function(){var e=this;this.rejectView=new a({docsModel:this.docsModel}),this.rejectView.rejectDataFetch().then(function(){e.$("#rejectArea").html(e.rejectView.render().el)})},_renderReply:function(){this.replyView=new u({docsModel:this.docsModel}),this.$("#bottomArea").html(this.replyView.render().el)},_renderBody:function(e,t){this.bodyView=new o({docsModel:this.docsModel,useDocNum:this.folderModel.useDocNum(),isPrint:e?e:!1,changeDocsContent:t?t:!1}),this.$("#bodyArea").html(this.bodyView.render().el),e||this.bodyView.renderAttachView()},_renderAction:function(){var e=this.docsModel.get("creatorId")==GO.session("id")&&this.docsModel.getDocsStatus()=="REJECT"?!0:!1;this.actionView=new s({folderId:this.folderId,isManageable:this.folderModel.isManagable(),isEditable:this.folderModel.isWritable(),isDeletable:this.folderModel.isRemovable()||e,docsModel:this.docsModel}),this.$("#actionArea").html(this.actionView.render().el)},isNormalFolderType:function(){return this.docsModel.folderType==undefined||this.docsModel.folderType=="undefined"?!0:!1},getFolderName:function(){return this.docsModel.folderType=="approvewaiting"?f["\uc2b9\uc778 \ub300\uae30 \ubb38\uc11c"]:this.docsModel.folderType=="registwaiting"?f["\ub4f1\ub85d \ub300\uae30 \ubb38\uc11c"]:this.docsModel.folderType=="latestread"?f["\ucd5c\uadfc \uc5f4\ub78c \ubb38\uc11c"]:this.docsModel.folderType=="latestupdate"?f["\ucd5c\uadfc \uc5c5\ub370\uc774\ud2b8 \ubb38\uc11c"]:this.folderModel.getName()},renderContentTop:function(e){var n=this,r=new t({});e.getContentElement().html(r.el),r.render(),e.setContent(n);var i="<span class='txt'>"+GO.util.escapeHtml(this.getFolderName())+"</span>";r.setTitle(i);if(this.isNormalFolderType()){var s=this.folderModel.isFavorite();r.setFavoriteTmpl(s,n.folderModel.get("id"))}},setDocsContents:function(e){GO.EventEmitter.trigger("common","layout:setOverlay",!0);var t=$(e.currentTarget).attr("data-id");this.docsId=t,this.actionView.setPrintDocsId(this.docsId);var n=this;this.dataFetch().then(function(){n._renderBody(!1,!0),n.replyView.refreshReadCount(n.docsModel.getReadCount())}),$(document).scrollTop(0),GO.EventEmitter.trigger("common","layout:clearOverlay",!0)},_renderSide:function(e){this.sideView=new l({}),e.getSideElement().find(".docs_side").length?this.sideView.refreshWaitingCount():(e.getSideElement().empty().append(this.sideView.el),this.sideView.render())}})});