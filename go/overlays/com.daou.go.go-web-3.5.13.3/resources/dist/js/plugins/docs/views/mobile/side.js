define("docs/views/mobile/side",function(require){var e=require("backbone"),t=require("when"),n=require("docs/views/mobile/side_item"),r=require("components/favorite/collections/favorite"),i=require("docs/collections/doc_folder_infos"),s=require("hgn!docs/templates/mobile/side"),o=require("i18n!docs/nls/docs"),u=require("i18n!nls/commons"),a={folder:o["\ubb38\uc11c\ud568"],latestRead:o["\ucd5c\uadfc \uc5f4\ub78c \ubb38\uc11c"],latestUpdate:o["\ucd5c\uadfc \uc5c5\ub370\uc774\ud2b8 \ubb38\uc11c"],approveWaiting:o["\uc2b9\uc778 \ub300\uae30 \ubb38\uc11c"],completeWaiting:o["\ub4f1\ub85d \ub300\uae30 \ubb38\uc11c"],favorite:u["\uc990\uaca8\ucc3e\uae30"]},f=e.View.extend({events:{"click span[name=sideItem]":"moveToFolder"},initialize:function(){this.docFolderList=new i,this.favorites=r.get({url:GO.contextRoot+"api/docs/folder/favorite"})},refreshWaitingCount:function(){var e=this;return $.when(e.getRegistwaiting(),e.getApprovewaiting()).done($.proxy(function(){this.registwaitingCnt>0?$("#registwaitingCnt").show().empty().append(this.registwaitingCnt):$("#registwaitingCnt").hide(),this.approvewaitingCnt>0?$("#approvewaitingCnt").show().empty().append(this.approvewaitingCnt):$("#approvewaitingCnt").hide()},this))},render:function(){var e=this,t=$.Deferred();this.packageName=this.options.packageName;var n=this.favorites.fetch();this.docFolderList.comparator="seq";var r=this.docFolderList.fetch();return $.when(e.getRegistwaiting(),e.getApprovewaiting(),r,n).done(function(){e.$el.html(s({lang:a,hasFavorite:e.favorites.hasFavorite(),favorites:e.favorites.toJSON(),isNew:function(){return this.lastDocsCompleteDate?GO.util.isCurrentDate(this.lastDocsCompleteDate,1):!1},hasRegistwaiting:e.registwaitingCnt?e.registwaitingCnt>0:!1,hasApprovewaiting:e.approvewaitingCnt?e.approvewaitingCnt>0:!1,registwaitingCnt:e.registwaitingCnt,approvewaitingCnt:e.approvewaitingCnt}));var n=new i;e.docFolderList.each(function(e){n.get(e)?n.get(e).attributes=e.attributes:n.push(e),e.attributes.parent=_.sortBy(e.attributes.parent,"depth");var t=0;for(var r=0;r<e.getParent().length;r++)r>0&&(e.getParent()[r].parentId=t),n.push(n.getExistModel(e.getParent()[r])),t=e.getParent()[r].id}),_.each(n.getRootFolders(),function(t){e.renderItemsView(t,n,e.$el.find("#allFolderList"),{className:"ic_work"})}),e.setSideApp(),t.resolveWith(e,[e])}),t},renderItemsView:function(e,t,r,i){var s=new n({root:!0,model:e,depth:e.getDepth(),className:i.className});r.append(s.render().el),this.renderSideChildItem(t,e,!1,r,i)},renderSideChildItem:function(e,t,r,i,s){var o=e._getChildrenFolder(t.id);o.length>0&&_.each(o,$.proxy(function(t){var o=new n({root:r,model:t,depth:t.getDepth()==0?t.get("depth")-2:t.getDepth(),className:s.className});i.append(o.render().el),e._getChildrenFolder(t.id).length>0&&this.renderSideChildItem(e,t,!1,i,s)}),this)},moveToFolder:function(e){var t=$(e.currentTarget).attr("data-id");t||(t=$(e.currentTarget).attr("data-navi"));if(t){var n="/docs/folder/"+t;GO.router.navigate(n,!0)}},setSideApp:function(){$("body").data("sideApp",this.packageName)},getRegistwaiting:function(){var e=this,n=t.defer();return $.ajax({type:"GET",dataType:"json",url:GO.config("contextRoot")+"api/docs/registwaiting/count",success:function(t){n.resolve(),e.registwaitingCnt=t.data.count},error:function(){return n.reject(),0}})},getApprovewaiting:function(){var e=this,n=t.defer();return $.ajax({type:"GET",dataType:"json",url:GO.config("contextRoot")+"api/docs/approvewaiting/count",success:function(t){n.resolve(),e.approvewaitingCnt=t.data.count},error:function(){return n.reject(),0}})}},{__instance__:null,create:function(e){return this.__instance__=new this.prototype.constructor({packageName:e}),this.__instance__}});return f});