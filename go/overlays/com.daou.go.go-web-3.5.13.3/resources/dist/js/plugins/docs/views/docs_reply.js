define("docs/views/docs_reply",function(require){var e=require("backbone"),t=require("hgn!docs/templates/docs_reply"),n=require("hgn!docs/templates/docs_reader_list"),r=require("comment"),i=require("i18n!nls/commons");require("jquery.go-grid");var s=e.View.extend({events:{"click a#listDocsReader":"showPostReader"},initialize:function(e){this.options=e,this.docsModel=this.options.docsModel},render:function(){this.$el.html(t({replyCnt:this.docsModel.getCommentCount(),readCnt:this.docsModel.getReadCount(),lang:{"\ub313\uae00":i["\ub313\uae00"],"\uc870\ud68c":i["\uc870\ud68c"]}})),this.commentView=r.init({el:this.$el.find("#replyArea"),typeUrl:"docs/docsInfo",typeId:this.docsModel.getDocsInfoId(),isPrintMode:!1,rootId:this.docsModel.id,rootUrl:"docs",isReply:!0,isWritable:!0}),this.commentView.render(),this.commentView.fetchComments(!1);var e=this;return this.commentView.$el.on("comment:change",function(t,n,r){e.$("#replyCnt").text(r)}),this},refreshReadCount:function(e){$("#listDocsReader").empty().append(e)},isCurrentLayer:function(e){return $(e.currentTarget).hasClass("on")},showPostReader:function(e){if(this.isCurrentLayer(e))return;var t=null,r=['<ul class="tab_nav tab_nav2"><li class="first on"><span>',"\uc870\ud68c","</span></li></ul>"];t=$.goPopup({pclass:"layer_normal layer_reader",headerHtml:r.join(""),contents:n(),buttons:[{btype:"confirm",btext:i["\ud655\uc778"]}]}),$.goGrid({el:"#readerList",url:GO.contextRoot+"api/docs/docsInfo/"+this.docsModel.getDocsInfoId()+"/reader",displayLength:5,displayLengthSelect:!1,emptyMessage:"",numbersShowPages:5,method:"GET",defaultSorting:[],sDom:'rt<"tool_bar"<"critical custom_bottom">p>',bProcessing:!1,columns:[{mData:null,bSortable:!1,sClass:"align_l",fnRender:function(e){var t=e.aData,n=[t.reader.name," ",t.reader.positionName,'&nbsp;<span class="date">',GO.util.basicDate(t.updatedAt),"</span>"];return n.join("")}},{mData:null,sWidth:"80px",sClass:"align_l",bSortable:!1,fnRender:function(e){var t=e.aData;return['<span class="plus_num">',i["\uc870\ud68c"],t.count,"</span>&nbsp;"].join("")}}],fnDrawCallback:function(e,n,r){var i=t.find(".tool_bar");n._iRecordsTotal<n._iDisplayLength?($(this.el).find("tr:last-child>td").css("border-bottom",0),i.hide()):(i.show(),i.find("div.dataTables_paginate").css("margin-top",0)),t.find(".dataTables_wrapper").css("margin-bottom",0),t.reoffset()}})}});return s});