define("docs/views/docs_action",function(require){var e=require("backbone"),t=require("hgn!docs/templates/docs_action"),n=require("hgn!docs/templates/reject_form"),r=require("docs/views/select_folder_popup"),i=require("components/backdrop/backdrop"),s=require("i18n!nls/commons"),o=require("i18n!docs/nls/docs"),u=e.Model.extend({url:function(){var e=["/api/docs/foler/"+this.folderId+"/docs/move/"+this.targetFolderId].join("/");return e},setFolderId:function(e){this.folderId=e},setTargetFolderId:function(e){this.targetFolderId=e}}),a={"\uc218\uc815":s["\uc218\uc815"],"\uc5c5\ub370\uc774\ud2b8":o["\uc5c5\ub370\uc774\ud2b8"],"\uc0ad\uc81c":s["\uc0ad\uc81c"],"\ubaa9\ub85d":s["\ubaa9\ub85d"],"\uc774\ub3d9":s["\uc774\ub3d9"],"\uc778\uc1c4":s["\uc778\uc1c4"],"\uc774\uc804":s["\uc704"],"\ub2e4\uc74c":s["\uc544\ub798"],"\ubcf5\uc0ac":s["URL \ubcf5\uc0ac"],"\uc694\uccad\ucde8\uc18c":o["\uc694\uccad\ucde8\uc18c"],"\uc2b9\uc778":o["\uc2b9\uc778"],"\ubc18\ub824":o["\ubc18\ub824"],"\ubc18\ub824\uc758\uacac":o["\ubc18\ub824\uc758\uacac"],"\uc758\uacac\uc791\uc131":o["\uc758\uacac\uc744 \uc791\uc131\ud574 \uc8fc\uc138\uc694"],"\ud604\uc7ac\ubc84\uc804\uc0ad\uc81c":o["\ud604\uc7ac \ubc84\uc804 \uc0ad\uc81c"],"\ubaa8\ub4e0\ubc84\uc804\uc0ad\uc81c":o["\ubaa8\ub4e0 \ubc84\uc804 \uc0ad\uc81c"]};return e.View.extend({initialize:function(e){this.options=e||{},this.folderId=e.folderId,this.isManageable=e.isManageable,this.isEditable=e.isEditable,this.isDeletable=e.isDeletable,this.docsModel=e.docsModel,this.docsId=this.docsModel.id,this.printDocsId=this.docsModel.id,this.docsInfoId=this.docsModel.getDocsInfoId(),this.isApproveWaiting=this.docsModel.getDocsStatus()=="APPROVEWAITING",this.isReject=this.docsModel.getDocsStatus()=="REJECT",this.PrevDocsId=this.docsModel.getPrevDocsId(),this.NextDocsId=this.docsModel.getNextDocsId(),this.isCreator=this.docsModel.getCreatorId()==GO.session("id")},events:{"click #btnEdit":"goEdit","click #totalDeleteBtn":"doDelete","click #totalDelete":"doDelete","click #currentDelete":"doCurrentDelete","click #goToListBtn":"goFolderHome","click #goToPrev":"goToPrev","click #goToNext":"goToNext","click #btnMove":"moveDocs","click #btnCancel":"approveCancelDocs","click #btnPermit":"approvePermitDocs","click #btnReject":"showRejectPopup","click #docsPrint":"printPopup"},render:function(){return this.$el.html(t({isEditable:this.isEditable,isDeletable:this.isDeletable,isApproveWaiting:this.isApproveWaiting,isCreator:this.isCreator,reject:this.isReject,isManageable:this.isManageable,needNavigator:this.getFolderId()!="registwaiting",hasPrev:this.PrevDocsId!=undefined,hasNext:this.NextDocsId!=undefined,lang:a})),this.backdrop(),this},backdrop:function(){var e=new i;e.backdropToggleEl=this.$("#deleteBtn"),e.linkBackdrop(this.$("[el-backdrop-link]")),e.bindBackdrop()},setPrintDocsId:function(e){this.printDocsId=e},goEdit:function(){GO.router.navigate("docs/edit/"+this.printDocsId,!0)},doDelete:function(){var t=this;$.goCaution(o["\ubaa8\ub4e0 \ubc84\uc804 \uc0ad\uc81c"],o["\uc774 \ubb38\uc11c\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],_.bind(function(){var n=new e.Model;n.id=t.docsId,n.url=GO.config("contextRoot")+"api/docs/"+t.docsId,n.save(null,{type:"DELETE",contentType:"application/json",success:function(){GO.router.navigate("docs/folder/"+t.folderId,!0)}})},this))},doCurrentDelete:function(){var t=this;$.goCaution(o["\ud604\uc7ac \ubc84\uc804 \uc0ad\uc81c"],o["\ud604\uc7ac \ubc84\uc804\uc758 \ubb38\uc11c\ub9cc \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],_.bind(function(){var n=new e.Model;n.id=t.printDocsId,n.url=GO.config("contextRoot")+"api/docs/"+t.printDocsId+"/version/delete",n.save(null,{type:"DELETE",contentType:"application/json",success:function(){GO.router.navigate("docs/folder/"+t.folderId,!0)}})},this))},getFolderId:function(){return this.docsModel.folderType==undefined||this.docsModel.folderType=="undefined"?this.folderId:this.docsModel.folderType},goFolderHome:function(){GO.router.navigate("docs/folder/"+this.getFolderId(),!0)},goToPrev:function(){GO.router.navigate("docs/detail/"+this.PrevDocsId,!0)},goToNext:function(e){GO.router.navigate("docs/detail/"+this.NextDocsId,!0)},printPopup:function(){var e=GO.contextRoot+"app/docs/"+this.printDocsId+"/print";window.open(e,"","location=no, directories=no, resizable=yes, status=no, toolbar=no, menubar=no, width=1280, height=650, left=0, top=0, scrollbars=yes")},getRejectForm:function(){return n({lang:a})},showRejectPopup:function(){var e=this;$.goPopup({pclass:"layer_normal",header:o["\ubc18\ub824"],modal:!0,draggable:!0,width:500,contents:e.getRejectForm(),buttons:[{btext:o["\ubc18\ub824"],btype:"confirm",autoclose:!1,callback:function(){e.approveRejectDocs()}},{btext:s["\ucde8\uc18c"],btype:"cancel"}]})},validate:function(e){if(e.get("str").length>64||e.get("str").length<2){var t=GO.i18n(o["0\uc740 0\uc790\uc774\uc0c1 0\uc790\uc774\ud558 \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4."],{arg0:o["\ubc18\ub824\uc758\uacac"],arg1:"2",arg2:"64"});return $.goError(t,$("#textarea-desc"),!1,!0),!1}return!0},approveRejectDocs:function(t){var n=this,r=new e.Model;r.id=n.docsId,r.url=GO.config("contextRoot")+"api/docs/"+n.docsId+"/rejected",r.set("str",$("#textarea-desc").val());if(this.validate(r)==0)return;r.save(null,{type:"PUT",contentType:"application/json",success:function(){GO.router.navigate("docs/folder/approvewaiting",!0)}})},approvePermitDocs:function(){var t=this;$.goCaution(o["\uc2b9\uc778"],o["\uc2b9\uc778\ud655\uc778"],_.bind(function(){var n=new e.Model;n.id=t.docsId,n.url=GO.config("contextRoot")+"api/docs/"+t.docsId+"/approved",n.save(null,{type:"PUT",contentType:"application/json",success:function(){GO.router.navigate("docs/detail/"+t.docsId,!0)}})},this),s["\ud655\uc778"])},approveCancelDocs:function(){var t=this;$.goCaution(s["\ucde8\uc18c"],s["\ucde8\uc18c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],_.bind(function(){var n=new e.Model;n.id=t.docsId,n.url=GO.config("contextRoot")+"api/docs/"+t.docsId+"/tempsave",n.save(null,{type:"PUT",contentType:"application/json",success:function(){GO.router.navigate("docs/folder/registwaiting",!0)}})},this),s["\ud655\uc778"])},moveDocs:function(e){var t=[];t.push(this.docsInfoId);var n=this;this.popup=$.goPopup({pclass:"layer_normal doc_layer",header:o["\ubb38\uc11c\uc774\ub3d9"],width:300,top:"40%",contents:"<div class='list_wrap'></div>",buttons:[{btext:s["\ud655\uc778"],btype:"confirm",callback:function(e){var r=e.find(".on span[data-folderid]").attr("data-folderid");if(!r)return $.goMessage(o["\ubb38\uc11c\ud568\uc744 \uc120\ud0dd\ud574 \uc8fc\uc138\uc694."]),!1;if(parseInt(r)==n.folderId)return $.goMessage(o["\ub2e4\ub978\ubb38\uc11c\ud568\uc120\ud0dd\uc54c\ub9bc"]),!1;var i=new u;i.setFolderId(n.folderId),i.setTargetFolderId(r);var a=$.goPreloader();i.save({ids:t},{silent:!0,type:"PUT",beforeSend:function(){a.render()},success:function(t,r){$.goMessage(o["\ubb38\uc11c\uc774\ub3d9\uc644\ub8cc"]),e.close(),n.goFolderHome()},error:function(e,t){var n=t.responseJSON;return!_.isUndefined(n)&&n.message?($.goError(n.message),!1):($.goError(s["\uc800\uc7a5\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4."]),!1)},complete:function(){a.release()}})}},{btext:s["\ucde8\uc18c"],btype:"normal"}]}),(new r({popupType:"move"})).renderList().then($.proxy(function(){this.popup.reoffset()},this))}})});