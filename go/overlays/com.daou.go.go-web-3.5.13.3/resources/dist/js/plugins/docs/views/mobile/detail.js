define("docs/views/mobile/detail",function(require){var e=require("backbone"),t=require("hgn!docs/templates/mobile/detail"),n=require("docs/views/mobile/docs_action"),r=require("docs/models/docs_doc_item"),i=require("docs/models/doc_folder_info"),s=require("views/mobile/header_toolbar"),o=require("i18n!approval/nls/approval"),u=require("views/mobile/m_font_resize"),a=require("i18n!nls/commons"),f=require("i18n!docs/nls/docs");require("go-fancybox");var l=e.Model.extend({initialize:function(e){this.docsId=e.docsId},url:function(){return GO.contextRoot+"api/docs/"+this.docsId+"/rejected"}}),c=Hogan.compile('<span class="state notyet">{{lang.\ubc18\ub824}}</span><span class="subject">&nbsp;{{model.message}}</span><div class="info"><span class="name">{{model.userName}} {{model.positionName}}</span><span class="part"> | </span><span class="date">{{date}}</span></div>'),h={"\ub4f1\ub85d\uc790":f["\ub4f1\ub85d\uc790"],"\ub4f1\ub85d\uc77c":a["\ub4f1\ub85d\uc77c"],"\ubcf4\uc874\uc5f0\ud55c":f["\ubcf4\uc874\uc5f0\ud55c"],"\ubb38\uc11c\uc0c1\ud0dc":f["\ubb38\uc11c\uc0c1\ud0dc"],"\ubb38\uc11c\ubc88\ud638":f["\ubb38\uc11c\ubc88\ud638"],"\ubcc0\uacbd\uc0ac\uc720":f["\ubcc0\uacbd \uc0ac\uc720"],"\uc0c1\uc138\ub0b4\uc6a9":f["\uc0c1\uc138\ub0b4\uc6a9"],"\uc790\uc138\ud788":a["\uc790\uc138\ud788"],"\uc2b9\uc778\ub300\uae30":f["\uc2b9\uc778\ub300\uae30"],"\ubc18\ub824":f["\ubc18\ub824"],"\ubb38\uc11c\ubc84\uc804":f["\ubb38\uc11c\ubc84\uc804"]};return e.View.extend({initialize:function(e){this.options=e,this.docsId=this.options.docsId},dataFetch:function(){var e=$.Deferred(),t=$.Deferred(),n=this;this.folderType=sessionStorage.getItem("list-folderType"),this.docsId?(this.docsModel=new r({id:this.docsId}),this.folderType!="undefined"&&this.folderType!=null&&(this.docsModel.folderType=this.folderType,this.docsModel.type="folderType"),this.docsModel.fetch({error:function(e,t){GO.util.linkToErrorPage(t)}}).done($.proxy(function(){t.resolve(),this.folderId=this.docsModel.getFolderId(),this.folderModel=new i({id:this.folderId}),this.folderModel.fetch({statusCode:{400:function(){GO.util.error("404",{msgCode:"400-common"})},403:function(){GO.util.error("403",{msgCode:"400-common"})},404:function(){GO.util.error("404",{msgCode:"400-common"})},500:function(){GO.util.error("500")}}}).done(function(){e.resolve()})},this))):(t.resolve(),e.resolve());var s=$.Deferred();return $.when(t,e).done(function(){s.resolve(n)}),s},render:function(){return $(".content_page").html(t({lang:h,docsModel:this.docsModel.toJSON(),preserveYear:this.makePreserveYear(),completeDate:this.docsModel.getCompleteDate(),needState:this.docsModel.isNeedState()||this.docsModel.getDocsStatus()=="TEMPSAVE",wait:this.docsModel.getDocsStatus()=="APPROVEWAITING",version:"VER "+this.docsModel.getVersion(),reject:this.docsModel.getDocsStatus()=="REJECT",temp:this.docsModel.getDocsStatus()=="TEMPSAVE",stateName:this.docsModel.getDocsStatusName(),useDocNum:this.folderModel.useDocNum()&&!_.isUndefined(this.docsModel.get("docNum"))&&!_.isEmpty(this.docsModel.get("docNum"))})),this.docsModel.getDocsStatus()=="REJECT"&&this._renderReject(),this._renderHeader(),this._renderAction(),GO.util.imageLoadCheck("editorView").done($.proxy(function(){this.initIscroll()},this)),this.initWindowEvent(),this.fontResizeLayerAdd(),$("#copyUrl").on("vclick",function(e){GO.util.copyUrl(e)}),this},initIscroll:function(){$(document).width()<$("#editorView .editor_view").width()&&GO.util.initDetailiScroll("iScrollContentWrap","docsContentLayout","editorView")},fontResizeLayerAdd:function(){u.render({el:"#fontResizeWrap",targetContentEl:"#docsContentLayout"})},initWindowEvent:function(){this.orientationWindowEvent={name:"orientation",event:function(){this.initIscroll()}},this.setTimeoutToWindowEventHandler(this.orientationWindowEvent)},setTimeoutToWindowEventHandler:function(e){var t=this;$(window).on(e.name,function(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout($.proxy(e.event,t),200)})},_renderReject:function(){this.rejectModel=new l({docsId:this.docsModel.id}),this.rejectModel.fetch({statusCode:{400:function(){GO.util.error("404",{msgCode:"400-common"})},403:function(){GO.util.error("403",{msgCode:"400-common"})},404:function(){GO.util.error("404",{msgCode:"400-common"})},500:function(){GO.util.error("500")}},success:function(e){var t=c.render({lang:{"\ubc18\ub824":f["\ubc18\ub824"]},model:e.toJSON(),date:GO.util.shortDate(e.get("createdAt"))});this.$("#rejectWrap").append(t)}})},makePreserveYear:function(){return this.docsModel.getDocsYear()==0?o["\uc601\uad6c"]:this.docsModel.getDocsYear()+o["\ub144"]},_renderAction:function(){this.actionView=new n({model:this.docsModel,folderInfo:this.docsModel.folderType,folderModel:this.folderModel}),this.actionView.setElement($("#actionArea")).render()},_getTitleName:function(){return this.folderType=="latestread"?f["\ucd5c\uadfc \uc5f4\ub78c \ubb38\uc11c"]:this.folderType=="latestupdate"?f["\ucd5c\uadfc \uc5c5\ub370\uc774\ud2b8 \ubb38\uc11c"]:this.folderType=="registwaiting"?f["\ub4f1\ub85d \ub300\uae30 \ubb38\uc11c"]:this.folderType=="approvewaiting"?f["\uc2b9\uc778 \ub300\uae30 \ubb38\uc11c"]:this.folderModel.getName()},_renderHeader:function(){this.headerToolbarView=s,this.headerToolbarView.render({title:this._getTitleName(),isPrev:!0})}})});