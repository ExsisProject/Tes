(function(){define(["backbone","app","i18n!nls/commons","i18n!task/nls/task","task/collections/task_search_results","views/mobile/header_toolbar"],function(e,t,n,r,i,s){var o={total:r["\ucd1d"],count:r["\uac74"],empty:n["\ud574\ub2f9 \uac80\uc0c9 \uacb0\uacfc\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."],keyword:n["\uac80\uc0c9\uc5b4"],context:n["\uc704\uce58"],status:r["\uc0c1\ud0dc"],title:n["\uc81c\ubaa9"],detail:r["\uc0c1\uc138\ub0b4\uc6a9"],activity:r["\ud65c\ub3d9\uae30\ub85d"],comment:n["\ub313\uae00"],assignee:r["\ub2f4\ub2f9\uc790"],register:r["\ub4f1\ub85d\uc790"],term:r["\uae30\ud55c"],more:n["\ub354\ubcf4\uae30"],attachName:n["\ucca8\ubd80\ud30c\uc77c \uba85"],attachContent:n["\ucca8\ubd80\ud30c\uc77c \ub0b4\uc6a9"]},u=Hogan.compile('<div class="content_page"><div class="content report"><header class="article_header"><h2 class="search_title">'+n["\uac80\uc0c9\uc5b4"]+" : <strong>{{param.keyword}}</strong></h2>"+"</header>"+'<ul class="list_normal list_search list_task"></ul>'+'<div class="paging">'+'<a class="btn_type4" data-value="-1" data-type="prev" id="prev" href="javascript:;" {{^page.isPossiblePrev}}style="display:none;"{{/page.isPossiblePrev}}>'+'<span class="ic ic_arrow3_l"></span>'+'<span class="txt">'+n["\uc774\uc804"]+"</span>"+"</a>"+'<span class="page">'+'<span class="current_page" id="listCurrent">{{page.firstIndex}}</span>'+'<span class="txt_bar">-</span>'+'<span class="total_page" id="listMax">{{page.lastIndex}}</span>'+"</span>"+'<a class="btn_type4" data-value="1" data-type="next" id="next" href="javascript:;" {{^page.isPossibleNext}}style="display:none;"{{/page.isPossibleNext}}>'+'<span class="txt">'+n["\ub2e4\uc74c"]+"</span>"+'<span class="ic ic_arrow3_r"></span>'+"</a>"+"</div>"+"</div>"+"</div>"),a=Hogan.compile('<a class="tit"><span class="state etc">{{data.status.name}}</span><span class="subject"><span class="title">{{{data.name}}}</span></span><span class="info"><span class="reporter txt_ellipsis">'+r["\ub2f4\ub2f9\uc790"]+" : {{{data.assignees}}}"+"</span>"+'<span class="part">|</span>'+'<span class="name txt_ellipsis">'+r["\ub4f1\ub85d\uc790"]+" : {{{data.creator}}}"+"</span>"+"{{#hasDueDate}}"+'<span class="part">|</span>'+'<span class="date">{{dueDate}}</span>'+"{{/hasDueDate}}"+"</span>"+"</a>"),f=e.View.extend({tagName:"li",events:{"vclick a":"moveDetail"},initialize:function(){},render:function(){var e=this.model.get("dueDate");this.$el.html(a.render({data:this.model.toJSON(),dueDate:e?GO.util.basicDate2(this.model.get("dueDate")):"",hasDueDate:e?!0:!1}))},moveDetail:function(){t.router.navigate("task/"+this.model.id+"/detail",!0)}}),l=e.View.extend({events:{"vclick a[data-value]":"paging"},initialize:function(){this.param=GO.router.getSearch(),this.results=new i({param:this.param}),console.log(this.param)},dataFetch:function(){return this.results.fetch()},render:function(){return s.render({isClose:!0,title:n["\uac80\uc0c9\uacb0\uacfc"],isWriteBtn:!0,writeBtnCallback:function(){t.router.navigate("task/create",{trigger:!0,pushState:!0})}}),this.$el.html(u.render({lang:o,param:this.param,isSimple:_.has(this.param,"keyword"),folderNames:this.param.folderNames||n["\uc804\uccb4"],statusName:this.param.statusName||n["\uc804\uccb4"],term:this.getTermLabel(),page:this.results.getPageInfo()})),this},renderResult:function(){this.$("ul").find("li").remove();if(this.results.page.total==0){this.renderEmptyContent();return}_.each(this.results.models,function(e){var t=new f({model:e});this.$("ul").append(t.el),t.render()},this);var e=this.results.getPageInfo();e.isPossiblePrev?this.$("#prev").show():this.$("#prev").hide(),e.isPossibleNext?this.$("#next").show():this.$("#next").hide()},renderEmptyContent:function(){var e=['<li class="creat data_null"><span class="txt">{{lang.empty}}</span></li>'];this.$("ul").append(Hogan.compile(e.join("")).render({lang:o})),this.$("#moreButton").hide()},showMore:function(){var e=this;this.results.setNextPage(),this.results.fetch({success:function(){e.renderResult()}})},getTermLabel:function(){var e="";if(this.param.termName==r["\uc9c1\uc811\uc120\ud0dd"]){var t=GO.util.shortDate(this.param.fromDate),n=GO.util.shortDate(this.param.toDate);e=t+" ~ "+n}else e=this.param.termName;return e},paging:function(e){var t=$(e.currentTarget),n=t.attr("data-type"),r=this.results.getPageInfo();if(n=="prev"&&!r.isPossiblePrev)return;if(n=="next"&&!r.isPossibleNext)return;var i=this,s=t.attr("data-value");this.results.setPage(this.results.page.page+parseInt(s)),this.results.fetch({success:function(){i.renderResult(),i.setCurrentPage(),GO.EventEmitter.trigger("common","layout:scrollToTop",this)}})},setCurrentPage:function(){var e=this.results.getPageInfo();this.$("#listCurrent").text(e.firstIndex),this.$("#listMax").text(e.lastIndex)}});return l})}).call(this);