define("task/components/task_dept_tree/views/base_task_dept_tree_menu",function(require){var e=require("app"),t=require("task/components/task_dept_tree/views/base_task_dept_tree"),n=t.extend({deptId:null,storeKey:null,initialize:function(e){var n=e||{};t.prototype.initialize.apply(this,arguments),this.deptId=null,n.hasOwnProperty("deptId")&&this.setDeptId(n.deptId)},renderChildView:function(e,t){var n=new this.constructor({lastId:t,nodes:e.children,parentId:e.data.parentId,deptId:e.data.id});return n.render(),n},setDeptId:function(e){this.deptId=e},getDeptId:function(){return this.deptId},isClosedNode:function(e){var t=this._getStoredClosedNodes();return _.indexOf(t,e)>-1},foldNode:function(e){var t=e.data("id");e.find(".task-tree-nodes:first").hide(),e.find(".close:first").removeClass("close").addClass("open"),this._addClosedNode(parseInt(t))},unfoldNode:function(e){var t=e.data("id");e.find(".task-tree-nodes:first").show(),e.find(".open:first").removeClass("open").addClass("close"),this._removeClosedNode(parseInt(t))},toggleNode:function(e){var t=parseInt(e.data("id"));this.isClosedNode(t)?this.unfoldNode(e):this.foldNode(e)},_addClosedNode:function(e){var t=this._getStoredClosedNodes();_.indexOf(t,parseInt(e))<0&&(t.push(e),this._storeNodeClosedState(t))},_removeClosedNode:function(e){var t=this._getStoredClosedNodes(),n=_.indexOf(t,parseInt(e));n>-1&&(t.splice(n,1),this._storeNodeClosedState(t))},_getStoreKey:function(){if(this.deptId===null)return;return e.session("loginId")+".task.side."+this.deptId+".closedNodes"},_getStoredClosedNodes:function(){var t=e.util.store.get(this._getStoreKey());return!this.getDeptId()||!t?[]:(_.isArray(t)||(t=[t]),t)},_storeNodeClosedState:function(t){var n=this._getStoreKey();n&&e.util.store.set(n,t)}});return n});