(function(){define(["backbone","hogan","app","i18n!nls/commons","i18n!task/nls/task","hgn!task/templates/mobile/task_activity_item","views/mobile/m_font_resize","attach_file"],function(e,t,n,r,i,s,o,u){var a={report:i["\ubcf4\uace0"],edit:r["\uc218\uc815"],"delete":r["\uc0ad\uc81c"],attach:r["\ud30c\uc77c \ucca8\ubd80"],save:r["\uc800\uc7a5"],cancel:r["\ucde8\uc18c"],count:i["\uac1c"],comment:r["\ub313\uae00"],showAll:i["\ubaa8\ub450 \ubcf4\uae30"]},f=e.View.extend({events:{"swipeleft #activityItemWrapper":"seeNext","swiperight #activityItemWrapper":"seePrevious","vclick #deleteActivityBtn":"destroyConfirm","vclick #editActivityBtn":"editActivity","vclick #goCommentList":"goCommentList"},initialize:function(e){this.activity=e.model,this.taskId=e.taskId,this.originalScale=1,this.editorId="activityEditor"+this.activity.get("id")},render:function(){return this.$el.html(s({content:GO.util.escapeXssFromHtml(this.activity.get("content")),lang:a,data:this.activity.toJSON(),snsDate:GO.util.snsDate(this.activity.get("updatedAt")?this.activity.get("updatedAt"):this.activity.get("createdAt")),commentPresent:this.activity.commentPresent()})),$("#content").css("visibility","hidden"),$("#doc_header").css("visibility","visible"),this.renderAttachView(),this.resizeContent(),this},renderAttachView:function(){var e=this;this.attachView=u.create("#attachArea"+this.activity.id,this.activity.get("attaches"),function(t){return GO.config("contextRoot")+"api/task/activity/"+e.activity.id+"/download/"+t.id})},resizeContent:function(){var e=this;setTimeout(function(){e.iscroll=GO.util.initDetailiScroll("activityItemWrapper","iScrollContentWrap","activityContentWrapper"),e.originalScale=e.iscroll.options.zoomMin,e.fontResizeLayerAdd()},500)},fontResizeLayerAdd:function(){o.render({el:"#fontResizeWrap",targetContentEl:"#activityContent"})},editActivity:function(){if(/<.*>.*<\/.*>/.test(this.model.get("content"))){alert(i["PC\uc5d0\uc11c \ub4f1\ub85d\ud55c \uc5c5\ubb34\ub294 \ubaa8\ubc14\uc77c\uc5d0\uc11c \uc218\uc815\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]);return}n.router.navigate("task/"+this.taskId+"/activity/"+this.activity.id,!0)},destroyConfirm:function(){confirm(r["\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"])&&this.destroyActivity()},destroyActivity:function(){var e=this;this.activity.destroy({success:function(t){alert(r["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),n.router.navigate("task/"+e.taskId+"/activities",!0)},error:function(){console.log("error")}})},isPageMovable:function(){var e=$("#iScrollContentWrap").css("transform"),t=e.replace("matrix(","").split(",")[0];return Number(t).toFixed(6)==this.originalScale.toFixed(6)},seeNext:function(e){$("#rightBtn").length>0&&this.isPageMovable()&&$("#rightBtn").trigger("click")},seePrevious:function(e){$("#leftBtn").length>0&&this.isPageMovable()&&$("#leftBtn").trigger("click")},goCommentList:function(){n.router.navigate("task/"+this.taskId+"/activity/"+this.activity.id+"/comment",!0)}});return f})}).call(this);