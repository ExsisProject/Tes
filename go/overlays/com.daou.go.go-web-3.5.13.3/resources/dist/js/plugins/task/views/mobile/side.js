(function(){define(["backbone","app","i18n!nls/commons","i18n!task/nls/task","hgn!task/templates/mobile/side","task/collections/task_department_folders","task/views/mobile/side_dept","task/views/mobile/side_folder","admin/models/task_config","components/favorite/collections/favorite"],function(e,t,n,r,i,s,o,u,a,f){var l={task:r["\uc5c5\ubb34"],newTask:r["\uc0c8 \uc5c5\ubb34"],deptFolder:r["\ubd80\uc11c\ubcc4 \uc5c5\ubb34 \ud3f4\ub354"],addFolder:r["\uc5c5\ubb34 \ud3f4\ub354 \ucd94\uac00"],companyFolder:r["\uc804\uc0ac \uc5c5\ubb34 \ud3f4\ub354"],favorite:n["\uc990\uaca8\ucc3e\uae30"]},c=e.View.extend({events:{"vclick li[data-id]":"moveToFolder"},initialize:function(){this.deptFolders=new s({type:"dept"}),this.companyFolders=new s({type:"public"}),this.favorites=f.get({url:GO.contextRoot+"api/task/folder/favorite"}),this.model=a.read({admin:!1}).toJSON(),GO.config("attachNumberLimit",this.model.attachNumberLimit),GO.config("attachSizeLimit",this.model.attachSizeLimit),GO.config("maxAttachNumber",this.model.maxAttachNumber),GO.config("maxAttachSize",this.model.maxAttachSize),GO.config("excludeExtension",this.model.excludeExtension?this.model.excludeExtension:"")},render:function(){this.packageName=this.options.packageName;var e=this,t=this.deptFolders.fetch(),n=this.companyFolders.fetch(),r=this.favorites.fetch(),s=$.Deferred();return $.when(t,n,r).done(function(){e.$el.html(i({lang:l,hasFavorite:e.favorites.hasFavorite(),favorites:e.favorites.toJSON()})),e.deptFolders.folderPresent()||$("#commonWriteButton").hide(),e.renderDeptView(e.deptFolders,e.$el.find("#sideDeptList"),!0),e.renderDeptView(e.companyFolders,e.$el.find("#companyList"),!1),e.setSideApp(),s.resolveWith(e,[e])}),s},renderDeptView:function(e,t,n){_.each(e.models,function(e){if(e.isEmptyfolder())return;var n=new o(e);t.append(n.render().el),n.renderFolders()},this)},moveToFolder:function(e){var n=$(e.currentTarget).attr("data-id");t.router.navigate("task/folder/"+n+"/task",!0)},setSideApp:function(){$("body").data("sideApp",this.packageName)}},{__instance__:null,create:function(e){return this.__instance__=new this.prototype.constructor({packageName:e}),this.__instance__}});return c})}).call(this);