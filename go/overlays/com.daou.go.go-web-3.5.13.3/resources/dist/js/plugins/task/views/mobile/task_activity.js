(function(){define(["backbone","hogan","app","i18n!nls/commons","i18n!task/nls/task","views/mobile/header_toolbar","task/views/mobile/task_activity_item","task/collections/task_activities"],function(e,t,n,r,i,s,o,u){var a={"\ud65c\ub3d9\uae30\ub85d\ub4f1\ub85d":{id:"btnWriteActivity",text:r["\ub4f1\ub85d"],triggerFunc:"task-write-activity"}},f=e.View.extend({el:"#content",initialize:function(e){this.taskId=e.taskId,this.activities=new u({taskId:this.taskId}),this.currentPage=1,this.headerBindEvent()},dataFetch:function(){return this.activities.fetch()},headerBindEvent:function(){GO.EventEmitter.off("trigger-action"),GO.EventEmitter.on("trigger-action","task-write-activity",this.goActivityCreate,this)},render:function(){var e=this;return this.dataFetch().done(function(){e.models=e.activities.models,e.models.length==0?GO.router.navigate("task/"+e.taskId+"/detail",!0):(e.renderActivity(),e.renderHeaderToolBar())}),this},renderActivity:function(){var e=this.models[this.currentPage-1],t=new o({model:e,taskId:this.taskId});return this.$el.empty().html(t.el),t.render(),this},renderHeaderToolBar:function(){s.render({title:this.currentPage+"/"+this.models.length,actionMenu:this.getUseMenus(),isLeftBtn:this.currentPage>1,leftBtnCallback:$.proxy(this._onClickPrevious,this),isRightBtn:this.currentPage<this.models.length,rightBtnCallback:$.proxy(this._onClickNext,this),isClose:!0})},getUseMenus:function(){var e=[];return e.push(a.\ud65c\ub3d9\uae30\ub85d\ub4f1\ub85d),e},goActivityCreate:function(){n.router.navigate("task/"+this.taskId+"/create",!0)},_onClickPrevious:function(){this.currentPage--,this.renderActivity(),this.renderHeaderToolBar()},_onClickNext:function(){this.currentPage++,this.renderActivity(),this.renderHeaderToolBar()}});return f})}).call(this);