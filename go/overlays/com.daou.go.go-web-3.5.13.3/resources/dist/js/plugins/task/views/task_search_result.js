(function(){define(["backbone","app","i18n!nls/commons","i18n!task/nls/task","hgn!task/templates/task_search_result","task/views/task_title","task/views/task_search_item","task/collections/task_search_results"],function(e,t,n,r,i,s,o,u){var a={total:r["\ucd1d"],count:r["\uac74"],empty:n["\ud574\ub2f9 \uac80\uc0c9 \uacb0\uacfc\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."],keyword:n["\uac80\uc0c9\uc5b4"],context:n["\uc704\uce58"],status:r["\uc0c1\ud0dc"],title:n["\uc81c\ubaa9"],detail:r["\uc0c1\uc138\ub0b4\uc6a9"],activity:r["\ud65c\ub3d9\uae30\ub85d"],comment:n["\ub313\uae00"],assignee:r["\ub2f4\ub2f9\uc790"],creator:r["\ub4f1\ub85d\uc790"],term:r["\uae30\ud55c"],more:n["\ub354\ubcf4\uae30"],attachName:n["\ucca8\ubd80\ud30c\uc77c \uba85"],attachContent:n["\ucca8\ubd80\ud30c\uc77c \ub0b4\uc6a9"]},f=e.View.extend({events:{"click #searchMoreButton":"showMore"},initialize:function(){this.param=GO.router.getSearch(),this.results=new u({param:this.param})},dataFetch:function(){return this.results.fetch()},render:function(){this.$el.html(i({lang:a,param:this.param,isSimple:_.has(this.param,"keyword"),folderNames:this.param.folderNames||n["\uc804\uccb4"],statusName:this.param.statusName||n["\uc804\uccb4"],term:this.getTermLabel()}));var e=new s({title:n["\uac80\uc0c9\uacb0\uacfc"],count:this.results.page.total});return this.$el.find(".content_top").html(e.el),e.render(),this._renderMoreButton(),this._bindScrollEvent(),this},_bindScrollEvent:function(){var e=this;$(window).bind("scroll.task",function(t){var n=$(document).height(),r=$(window).height(),i=n-r,s=$(document).scrollTop();i-s<2&&e.$el.find("div.bottom_action").is(":visible")&&e.showMore()})},renderResult:function(){if(this.results.page.total==0){this.renderEmptyContent();return}_.each(this.results.models,function(e){var t=new o({model:e});this.$("tbody").append(t.el),t.render()},this)},renderEmptyContent:function(){var e=['<tr><td colspan="6"><p class="data_null"><span class="ic_classic ic_no_result"></span><span class="txt">{{lang.empty}}</span></p></td></tr>'];this.$("tbody").append(Hogan.compile(e.join("")).render({lang:a})),this.$("#moreButton").hide()},showMore:function(){var e=this;this.$("#searchMoreButton").hide(),this.results.setPage(this.results.page.page+1),this.results.fetch({success:function(){e.renderResult(),e._renderMoreButton()}})},_renderMoreButton:function(){this.results.page.lastPage?this.$("#searchMoreButton").hide():this.$("#searchMoreButton").show()},getTermLabel:function(){var e="";if(this.param.termName==r["\uc9c1\uc811\uc120\ud0dd"]){var t=GO.util.shortDate(this.param.fromDate),n=GO.util.shortDate(this.param.toDate);e=t+" ~ "+n}else e=this.param.termName;return e}});return f})}).call(this);