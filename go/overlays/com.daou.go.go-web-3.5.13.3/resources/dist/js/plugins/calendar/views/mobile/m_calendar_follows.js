define("calendar/views/mobile/m_calendar_follows",function(require){var e=require("backbone"),t=require("app"),n=require("hgn!calendar/templates/mobile/m_calendar_follows"),r=require("views/mobile/header_toolbar"),i=require("i18n!nls/commons"),s=require("i18n!calendar/nls/calendar"),o=require("when"),u=require("calendar/models/calendar_follow"),a={"\uc2b9\uc778":s["\uc218\ub77d"],"\uac70\uc808":s["\uac70\uc808"],"\uc2e0\uccad \uc218\ub77d \uba54\uc2dc\uc9c0":s["\uad00\uc2ec \uce98\ub9b0\ub354 \uc2e0\uccad\uc744 \uc218\ub77d\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],"\uc815\uc0c1 \ucc98\ub9ac":i["\uc815\uc0c1 \ucc98\ub9ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]},f=e.View.extend({el:"#content",initialize:function(e){this.options=e,this.followCalendar||(this.followCalendar=new u({followId:this.options.followLinkId})),this.noMoreFollows=!1,this.unbindEvent(),this.bindEvent()},unbindEvent:function(){this.$el.off("click","#approval"),this.$el.off("click","#refusal")},bindEvent:function(){this.$el.on("click","#approval",$.proxy(this.followApproval,this)),this.$el.on("click","#refusal",$.proxy(this.followRefusal,this))},render:function(){this.followCalendar?this.followCalendar.toJSON().state!="waiting"&&(this.noMoreFollows=!0):this.noMoreFollows=!0,this._initRender();var e={title:s["\uad00\uc2ec \ub3d9\ub8cc \uac1c\ubcc4 \ucd94\uac00"],isClose:!0};return this.headerToolbarView=r,this.headerToolbarView.render(e),this},_initRender:function(){this.$el.html(n({lang:a,calendarId:this.options.calendarId,followLinkId:this.options.followLinkId,noMoreFollows:this.noMoreFollows,text:this.getCalendarApplyAllowText()}))},getCalendarApplyAllowText:function(){var e=this.followCalendar.toJSON();return t.i18n(s["{{arg1}} {{arg2}}\ub2d8\uc758<br>'{{arg3}}' \uad00\uc2ec \uce98\ub9b0\ub354 \uc2e0\uccad\uc744<br>\uc218\ub77d \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],{arg1:e.follower.name,arg2:e.follower.position,arg3:e.calendar.name})},followApproval:function(){if(confirm(s["\uad00\uc2ec \uce98\ub9b0\ub354 \uc2e0\uccad\uc744 \uc218\ub77d\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"])){var e=this,t=[GO.config("contextRoot")+"api/calendar/follower/",this.options.followLinkId,"/accept"].join("");$.ajax(t,{type:"POST",async:!1}).then(function(){e.noMoreFollows=!0,e.render()},function(){$.goAlert(i["500 \uc624\ub958\ud398\uc774\uc9c0 \ud0c0\uc774\ud2c0"])})}},followRefusal:function(){if(confirm(s["\uc0c1\ub300\ubc29\uc774 \uc2e0\uccad\ud55c \uad00\uc2ec \uce98\ub9b0\ub354\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"])){var e=this;$.ajax({url:GO.config("contextRoot")+"api/calendar/follower",type:"DELETE",data:JSON.stringify({ids:[this.options.followLinkId]}),dataType:"json",contentType:"application/json"}).then(function(){e.noMoreFollows=!0,e.render()},function(){$.goAlert(i["500 \uc624\ub958\ud398\uc774\uc9c0 \ud0c0\uc774\ud2c0"])})}},fetch:function(){return this.followCalendar.fetch()}});return f});