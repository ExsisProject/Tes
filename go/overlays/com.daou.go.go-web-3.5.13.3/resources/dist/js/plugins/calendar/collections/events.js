(function(){define(["jquery","underscore","backbone","moment","app","calendar/models/event"],function(e,t,n,r,i,s){var o="YYYY-MM-DDThh:mm:ssZZ",u,a=i.BaseCollection.prototype,f=Array.prototype.slice,l=i.util.toMoment,c=i.util.now(),h=c.clone().startOf("day").format(o),p=c.clone().endOf("day").format(o);return u=i.BaseCollection.extend({model:s,calendarId:-1,conditions:{timeMin:h,timeMax:p,maxResult:1e3},initialize:function(){this.__dateslots__=[],this.resetConditions()},url:function(){if(!this.isValidBoundary())throw new Error("Invalid boundary conditions.");return"/api/calendar/"+this.calendarId+"/event?"+e.param(this.conditions)},getCalendarId:function(){return this.calendarId},setCalendarId:function(e){if(e<0)throw new Error("Invalid Calendar ID");return this.calendarId=e,this},setBoundaryTime:function(e,t){return this.setTimeMin(e),this.setTimeMax(t),this},setTimeMin:function(e){return this.conditions.timeMin=l(e).format(o),this},setTimeMax:function(e){return this.conditions.timeMax=l(e).format(o),this},setMaxResult:function(e){return this.conditions.maxResult=e,this},isValidBoundary:function(){var e=!0;return this.calendarId<0&&(e&=!1),l(this.conditions.timeMin).diff(l(this.conditions.timeMax),"seconds")>0&&(e&=!1),e},isInBoundary:function(e,t){var n=l(e),r=l(t),i=l(this.conditions.timeMin),s=l(this.conditions.timeMax),o=!0;return o&=!(Math.floor(n.diff(i,"seconds",!0))<0),o&=!(Math.floor(r.diff(s,"seconds",!0))>0),o},resetConditions:function(){this.calendarId=-1,this.__needFetch__=!1,this.conditions={timeMin:h,timeMax:p,maxResult:1e3}}},{__instance__:null}),u})}).call(this);