(function(){define(["backbone","app","hogan","when","when/sequence","calendar/collections/calendars","calendar/collections/calendar_feeds","calendar/helpers/side_lnb","calendar/views/color_picker","calendar/libs/util","text!calendar/templates/side.html","text!calendar/templates/_side_nullguide.html","i18n!nls/commons","i18n!calendar/nls/calendar","go-ignoreduplicatemethod","jquery.go-popup","jquery.go-orgslide"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function S(){return $("#feed-list > .null_guide").length>0||$("#feed-list > ul.side_depth").length>0&&$("#feed-list > ul.side_depth").is(":visible")}function x(e){function a(e){var t=[];return _.each(e,function(e){var n=e.find("input[name=calendar_id]");t.push({id:+n.val(),name:n.data("name"),type:n.data("type")})}),t}var t=this,n=this._getActionQueue(e),s=n.get(),o=N.call(this,e),u=[];return _.each(s,function(n){u.push(function(){var r={sort:k,remove:C}[n.action];return r.call(t,e,n.ids)})},this),i(u).then(function(){var i=n.groupByAction();if(i.remove){var s=[];_.each(i.remove,function(e){s.concat(a(e.elements))}),D("hide",s),t._saveCheckedCalendar()}return o.trigger("reset"),r.resolve()})}function T(e,t,n){var i=r.defer();return n=_.isArray(n)?n:[n],$.ajax({url:e,type:t,data:JSON.stringify({ids:n}),dataType:"json",contentType:"application/json"}).then(i.resolve,i.reject),i.promise}function N(e){return{calendar:this.calendars,feed:this.feeds}[e]}function C(e,n){var r=t.config("contextRoot")+"api/calendar",i={calendar:r,feed:r+"/feed"}[e],s=N.call(this,e);return T(i,"DELETE",n).then(function(e){s.remove(n,{silent:!0})})}function k(e,n){var r=t.config("contextRoot")+"api/calendar",i={calendar:r+"/move",feed:r+"/feed/move"}[e],s=N.call(this,e);return T(i,"PUT",n).then(function(e){s.reset(e.data,{silent:!0})})}function L(e,t){var n=[];return n.push('<div class="list_action normalmode">'),n.push('<span class="btn_wrap">'),n.push('<span class="btn_side2 '+e+'">'),n.push(t),n.push("</span>"),n.push("</span>"),n.push("</div>"),n.join("\n")}function A(e){return t.i18n(p["\uce98\ub9b0\ub354 \uae30\ubcf8\uc774\ub984"],{username:e})}function O(e){var n=e.defaultCalendar?p["\uae30\ubcf8 \uce98\ub9b0\ub354 \ud45c\uc2dc"]:"";return(e.name||A(t.session("name")))+n}function M(e,t){var n="("+e+")";return(t||A(e))+n}function D(e,t){return $(document).trigger(e+":calendar",[t])}function P(e,t){var n=$(e);return n.prop("checked",t||!1),{id:n.val(),name:n.data("name"),type:n.data("type")}}function H(e){var t=$("#feed-list"),n=t.children("div").hasClass("null_guide")?251:85;e<n&&(e=n);var r=Math.min(t.outerHeight(),e)+1;t.parent().height(r)}function B(e){var n=$(window).height(),r=t.isAdvancedTheme()?0:$("header.go_header").outerHeight(),i=85,s=n-r-i-e;$("#side > section:not([id='company-calendar'])").each(function(){s-=$(this).outerHeight()}),$("#company-calendar").height(s),$("#company-calendar").css("overflow-y","auto")}var v=t.constant("calendar","FEED_STATE"),m=t.constant("calendar","SIDE_TYPE"),g=n.compile(l),y=n.compile(c),b={context_root:t.config("contextRoot"),regist_event_url:t.config("contextRoot")+"app/calendar/regist","use_org?":t.session("useOrg"),label:{calendar:h["\uce98\ub9b0\ub354"],new_event:p["\uc77c\uc815 \ub4f1\ub85d"],waiting:p["\uc2e0\uccad\ub300\uae30"],add_all_staff:p["\uc6b0\ub9ac \ubd80\uc11c\uc6d0 \ubaa8\ub450 \ucd94\uac00"],add_staff:p["\uad00\uc2ec \uce98\ub9b0\ub354 \ucd94\uac00"],modify:p["\uc218\uc815\uc644\ub8cc"],cancel:h["\ucde8\uc18c"],my_calendar_config:h["\ub0b4 \uce98\ub9b0\ub354 \uad00\ub9ac"],color_config:h["\uc0c9\uc0c1 \ubcc0\uacbd"],edit:h["\uc218\uc815"],following:p["\uad00\uc2ec \uce98\ub9b0\ub354"],edit_following:p["\uad00\uc2ec \uce98\ub9b0\ub354 \ud3b8\uc9d1"],edit_my_calendar:p["\ub0b4 \uce98\ub9b0\ub354 \ud3b8\uc9d1"],unfold:h["\uc811\uae30"],my_calendar:p["\ub0b4 \uce98\ub9b0\ub354"],setting:p["\uce98\ub9b0\ub354 \ud658\uacbd\uc124\uc815"]},msg:{no_feeds:p["\uad00\uc2ec \uce98\ub9b0\ub354 \uc5c6\uc74c \uba54\uc2dc\uc9c0"]},isOrgServiceOn:t.session("useOrg"),appName:t.util.getAppName("calendar")},w=function(){var e=function(){this.__index__=0,this.__queue__={}};return e.prototype={get:function(e){return typeof e=="undefined"?_.reject(this.__queue__,function(e){return!e}):this.__queue__[e]},last:function(){return this.__queue__[this.__index__]},placeholder:function(){return this.add(null)},add:function(e){return this.__queue__[++this.__index__]=$.extend(!0,{index:this.__index__},e),this.__index__},update:function(e,t){return this.__queue__.hasOwnProperty(e)&&(this.__queue__[e]=$.extend(!0,this.__queue__[e],t)),this},remove:function(e){return delete this.__queue__[e],this},clear:function(){this.__queue__={}},count:function(){return _.toArray(this.__queue__).length},groupByAction:function(){return _.groupBy(this.get(),function(e){return e.action},this)}},e}(),E=e.View.extend({feeds:[],mainView:null,initialize:function(e){var t=this;console.log("[SideView#initialize] initializing..."),this.calendars=e.calendars,this.feeds=e.feeds,this.mainView=e.mainView,this.actionQueues={},this.checkedCals=f.getSavedSelectedCalendar();if(!_.isUndefined(this.checkedCals)){var n=this.calendars.getNewCompanyCalendarIds();n.length!=0&&(this.checkedCals=this.checkedCals+","+this.calendars.getNewCompanyCalendarIds().join(","),f.saveCheckedCalendar(this.checkedCals.split(",")))}this._prepareTemplate(),this.loadMyCalendars(),this.reloadFeeds(this.$el),this._saveCheckedCalendar(),this.listenTo(this.calendars,"sync",this.reloadMyCalendars),this.listenTo(this.calendars,"remove",this.reloadMyCalendars),this.listenTo(this.calendars,"sort",this.reloadMyCalendars),this.listenTo(this.feeds,"remove",this.reloadFeeds),this.listenTo(this.feeds,"sort",this.reloadFeeds),$(document).off("req:checked-feeds.calendar-side").on("req:checked-feeds.calendar-side",function(){$(document).trigger("res:checked-feeds",[t.getCheckedFeeds()])})},render:function(){return this},loadMyCalendars:function(){var e=this.$el.find("#my-calendar > ul.side_depth"),t=e.is(":hidden");e.remove(),this.$el.find("#my-calendar > div.list_action").remove(),this.$el.find("#my-calendar").append(this._buildMyCalendars()),this.$el.find("#my-calendar > ul.side_depth").toggle(!t),this._setFoldStateForMyCalendar()},_setFoldStateForMyCalendar:function(){var e=f.getSavedCalendarFoldState();return e==="Y"?this._foldLnb($("#my-calendar"),!1):this._unfoldLnb($("#my-calendar"),!1),this},_toggleFoldState:function(e){var t=$(e.currentTarget),n=t.closest("section.lnb");t.closest("h1").hasClass("folded")?this._unfoldLnb(n):this._foldLnb(n)},reloadMyCalendars:function(e){this.checkedCals=f.getSavedSelectedCalendar(),this.loadMyCalendars(),this._setCheckedCalendars(this.$el.find("#my-calendar"))},loadFeeds:function(){this.$el.find("#feed-list > ul.side_depth").remove(),this.$el.find("#feed-list > div.null_guide").remove(),this.$el.find("#feed-list > div.list_action").remove(),this.$el.find("#feed-list").append(this._buildFeeds()),this._toggleFeedActionButtons(),this._setFoldStateForFeeds(),this._setScrollForFeeds()},reloadFeeds:function(e){this.loadFeeds(),this._setCheckedCalendars(e),this._setCheckedAllFeed()},_setCheckedCalendars:function(e){e=e||this.$el.find("#feed-list");if(!this.checkedCals)this._saveCheckedCalendar();else{var t=this.checkedCals.split(",");e.find("input[type=checkbox][name=calendar_id]").each($.proxy(function(e,n){var r=$(n);_.contains(t,$(n).val())&&!$(n).is(":disabled")&&r.prop("checked",!0)},this))}},delegateEvents:function(t){var n=this;console.log("[SideView#delegateEvents] called..."),e.View.prototype.delegateEvents.call(this,t),this.undelegateEvents(),this.$el.on("click.calendar-side",".ic_list_reorder",$.proxy(this._changeEditMode,this)),this.$el.on("click.calendar-side",".ic_cancel",$.proxy(this._cancelEdit,this)),this.$el.on("click.calendar-side",".ic_hide_up",$.proxy(this._toggleFoldState,this)),this.$el.on("click.calendar-side","h1.opened span.txt",$.proxy(this._toggleFoldState,this)),this.$el.on("changed:chip-color.calendar-side",".chip",$.proxy(this._bindChagnedCalendarColor,this)),this.$el.on("click.calendar-side","input[type='checkbox'][name='calendar_id']:not(':disabled')",$.proxy(this._checkToggleCalendar,this)),this.$el.on("click.calendar-side",".ic_list_del, .cancel_following",$.proxy(this._removeCalendar,this)),this.$el.on("click.calendar-side",".ic_done",$.proxy(this._requestModify,this)),this.$el.on("click.calendar-side",".mycalendar span.chip:not([data-unchangable])",$.proxy(this._toggleColorPickerByCalendar,this)),this.$el.on("click.calendar-side","#my-calendar .add-calendar-btn",$.proxy(this._addCalendar,this)),this.$el.on("click.calendar-side","#feed-list span.chip",$.proxy(this._toggleColorPickerByFeed,this)),this.$el.on("click.calendar-side","#feed-list input[name=check_all]",$.proxy(this._toggleCheckAllFeeds,this)),this.$el.on("click.calendar-side","#add-allstaff-btn",$.proxy(this._addFeedsForMyDepts,this)),this.$el.on("click.calendar-side","#feed-list .add-follow-btn",$.proxy(this._addFollow,this)),this.$el.on("click.calendar-side","#lnb-preference",$.proxy(this._goToPreference,this)),$(document).on("reload:calendar-feeds.calendar-side",$.proxy(function(e){this.reloadFeeds(),this._setCheckedAllFeed(),e.stopPropagation()},this)),$(document).on("removed:calendar-feeds.calendar-side",$.proxy(function(e){this.reloadFeeds(),this._saveCheckedCalendar(),this._setCheckedAllFeed(),e.stopPropagation()},this));var r=new d;return $(window).on("resize.calendar-side",function(e){r.bind(function(){console.log("resize.calendar-side"),n._setScrollForFeeds()})}),this},undelegateEvents:function(){return e.View.prototype.undelegateEvents.call(this),this.$el.off(".calendar-side"),$(window).off(".calendar-side"),$(document).off(".calendar-side"),this.$el.find(".chip").off("changed:calendar-color"),t.session("useOrg")&&this.stopListening(this.feeds),this},getCheckedCalendarIds:function(){return _.pluck(this.getCheckedCalendars(),"id")},getCheckedCalendars:function(){var e=[];return _.each(this.calendars.getHolidayCalendars(),function(t,n){e.push({id:t.id,name:"holiday",type:"holiday"})}),this.$el.find("input[type=checkbox][name=calendar_id]:checked").each(function(t,n){var r=$(n);e.push({id:r.val(),name:r.attr("data-name"),type:r.attr("data-type")})}),e},getCheckedFeeds:function(){var e=this.getCheckedCalendars(),t=[];return _.each(e,function(e){e.type==="feed"&&t.push(this.feeds.findByCalendarId(e.id)[0].toJSON())},this),t},uncheckAll:function(){this.$el.find("input[type=checkbox][name=calendar_id]:checked").prop("checked",!1)},saveCheckedCalendar:function(){this._saveCheckedCalendar()},isFollowing:function(e){return this.feeds.isFollowing(e)},isAccessible:function(e){return this.feeds.isAccessible(e)},_setFoldStateForFeeds:function(){var e=f.getSavedFeedFoldState();return this._hasFeeds()?(e||f.saveSideFoldState("feed",!1),e==="Y"?this._foldLnb($("#feed-list"),!1):this._unfoldLnb($("#feed-list"),!1)):!e||f.saveSideFoldState("feed",!1),this},_toggleFeedActionButtons:function(){var e=this.$el.find("#feed-list > h1 > .btn_wrap");return this._hasFeeds()?(e.is(":visible")||e.css("display")==="none")&&e.show():e.hide(),this},_changeEditMode:function(e){var t=$(e.currentTarget).closest("section.lnb"),n=t.data("type"),r={calendar:p["\ub0b4 \uce98\ub9b0\ub354 \ud3b8\uc9d1"],feed:p["\uad00\uc2ec \uce98\ub9b0\ub354 \ud3b8\uc9d1"]}[n],i=null,s;return s=this._getActionQueue(n),this._unfoldLnb(),t.find("h1 > span.txt").text(r),t.find(".cb-check-all").hide(),t.addClass("lnb_edit"),t.find(".normalmode").hide(),t.find(".editmode:not([data-lazyshow])").show(),t.sortable({items:"li:not(.ui-state-disabled)",axis:"y",start:function(e,t){var n=s.last();$(t.helper).addClass("move"),n&&n.action==="sort"?i=n.index:i=s.placeholder()},stop:function(e,n){var r=[];t.find("li:not(.ui-state-disabled)").each(function(e,t){r.push($(t).data("id"))}),s.update(i,{ids:r,action:"sort"}),$(n.item).removeClass("move")}}),t.disableSelection(),this},_changeNormalMode:function(e){var t=$(e.currentTarget).closest("section.lnb"),n=t.data("type"),r={calendar:p["\ub0b4 \uce98\ub9b0\ub354"],feed:p["\uad00\uc2ec \uce98\ub9b0\ub354"]}[n],i={calendar:this.reloadMyCalendars,feed:this.reloadFeeds}[n];return this._clearActionQueue(n),t.find("h1 > span.txt").text(r),t.removeClass("lnb_edit"),t.find(".normalmode").show(),t.find(".editmode").hide(),t.sortable("destroy"),t.enableSelection(),this.render(),i.call(this),this},_getActionQueue:function(e){return this.actionQueues[e]||(this.actionQueues[e]=new w),this.actionQueues[e]},_clearActionQueue:function(e){this.actionQueues[e]&&this.actionQueues[e].clear()},_requestModify:function(e){var t=this,n=$(e.currentTarget).closest("section.lnb").data("type");e.preventDefault(),x.call(this,n).then(function(){t._changeNormalMode(e)})},_cancelEdit:function(e){return this._changeNormalMode(e),this},_removeCalendar:function(e){var t=$(e.currentTarget),n=t.closest("li"),r=t.closest("section.lnb").data("type"),i=this._getActionQueue(r),s=i.last();if(s&&s.action==="remove"){var o=_.isArray(s.ids)?s.ids:[s.ids],u=_.isArray(s.elements)?s.elements:[s.elements];o.push(n.attr("data-id")),u.push(n),i.update(s.index,{ids:o,elements:u})}else i.add({ids:[n.attr("data-id")],action:"remove",elements:[n]});n.remove()},_addFeedsForMyDepts:function(e){var n=this,r=[t.config("contextRoot"),"api/calendar/feed/department?userId=",t.session("id")].join("");return $.ajax(r,{type:"POST"}).done(function(e){e.data&&e.data.length>0?(n.feeds.reset(e.data),f.triggerReloadFeeds()):$.goSlideMessage(p["\uacf5\uac1c \uce98\ub9b0\ub354 \uc5c6\uc74c \uba54\uc2dc\uc9c0"])}),this},_addFollow:function(e){return $.goOrgSlide({header:p["\uad00\uc2ec \uce98\ub9b0\ub354 \ucd94\uac00"],type:"list",desc:p["\uad00\uc2ec \uce98\ub9b0\ub354\ub85c \ucd94\uac00\ud560 \uc0ac\uc6a9\uc790\ub97c \uc544\ub798\uc5d0\uc11c \uc120\ud0dd\ud558\uc138\uc694"],contextRoot:t.config("contextRoot"),memberTypeLabel:p["\uad00\uc2ec \uce98\ub9b0\ub354"],externalLang:h,isBatchAdd:!0,callback:$.proxy(function(e){var n=_.isArray(e)?e:[e],r=_.map(n,function(e){return e.id});if(t.session().id==r[0]){$.goSlideMessage(p["\uacf5\uac1c \uce98\ub9b0\ub354 \uc5c6\uc74c \uba54\uc2dc\uc9c0"]);return}var i=_.reject(r,function(e){return e==t.session().id}),s=this.feeds.length+i.length;if(s>50){$.goSlideMessage(p["\uad00\uc2ec \uce98\ub9b0\ub354 50\uac1c\uae4c\uc9c0\ub9cc \ucd94\uac00 \uac00\ub2a5 \ubb38\uad6c"]);return}var o=this,u=[t.config("contextRoot"),"api/calendar/user/feed"].join("");$.ajax(u,{type:"POST",data:JSON.stringify({ids:i}),contentType:"application/json"}).done(function(e){e.data&&e.data.length>0?(o.feeds.add(e.data),f.triggerReloadFeeds()):$.goSlideMessage(p["\uacf5\uac1c \uce98\ub9b0\ub354 \uc5c6\uc74c \uba54\uc2dc\uc9c0"])})},this)})},_addCalendar:function(e){var t=$(e.currentTarget),n=t.offset();require(["calendar/views/add_mycal_popup"],_.bind(function(e){var r={left:n.left+t.outerWidth()+5,top:n.top-5};e({offset:r}).then(_.bind(function(e){this.calendars.add(e)},this))},this))},_prepareTemplate:function(){var e=g.render(b,this._buildPartials());this.$el.empty().html(e)},_goToPreference:function(e){var n=this._getCalendarIdFromCheckbox(e.currentTarget);return t.router.navigate(["calendar",n,"preference"].join("/"),{trigger:!0,pushState:!0}),this},_hasFeeds:function(){return this.feeds.length>0},_buildPartials:function(){return{company_calendar:this._buildCompanyCalendars()}},_buildMyCalendars:function(){var e=new u(this.calendars.getMyCalendars()),t=[],r;return e.setItemVars(function(e,t){var n=O(t),r=!this.checkedCals;e.setLabel(n),e.setClassnames("default"),e.useCheckbox("calendar_id",t.id,!1,r,{"data-name":n,"data-type":"my"}),e.addButton(null,"normalmode chip bgcolor"+t.color,"title='"+h["\uc0c9\uc0c1 \ubcc0\uacbd"]+"'"),t.defaultCalendar||e.addButton(null,"ic_side ic_list_del editmode remove_following",'style="display:none" title="'+h["\uc0ad\uc81c"]+'"')},this),r=n.compile(e.render()),t.push(r.render(b)),t.push(L("add-calendar-btn",p["\ub0b4 \uce98\ub9b0\ub354 \ucd94\uac00"])),t.join("\n")},_buildCompanyCalendars:function(){var e=new u(this.calendars.getCompanyCalendars()),t=!this.checkedCals;return e.setItemVars(function(e,n){var r=n.name;e.setLabel(r),e.setClassnames("default"),e.useCheckbox("calendar_id",n.id,!1,t,{"data-name":r,"data-type":"company"}),e.addButton(null,"chip bgcolor"+n.color)}),n.compile(e.render())},_buildFeeds:function(){var e=[];if(this._hasFeeds()){var t=new u(this.feeds.toJSON(),{useCheckAll:!0,display:"none"});t.setItemVars(function(e,t){var n=!1,r=t.calendar,i=r.owner.name,s=M(i,r.name);t.state===v.following?(e.setClassnames("star"),e.addButton(null,"normalmode chip bgcolor"+t.color,'title="'+p["\uc0c9\uc0c1 \ubcc0\uacbd"]+'"'),e.addButton(null,"ic_side ic_list_del editmode remove_following",'style="display:none" title="'+h["\uc0ad\uc81c"]+'"')):(n=!0,e.setClassnames("star_waiting"),e.addTag(p["\uc2e0\uccad\ub300\uae30"],"btn_state_disable normalmode"),e.addButton(p["\uc2e0\uccad\ucde8\uc18c"],"btn_side3 editmode cancel_following",'style="display:none"')),e.setLabel(s),e.useCheckbox("calendar_id",t.calendar.id,n,!1,{"data-feedid":t.id,"data-name":s,"data-type":"feed"})});var r=n.compile(t.render());e.push(r.render(b)),e.push(L("add-follow-btn",p["\uad00\uc2ec \uce98\ub9b0\ub354 \ucd94\uac00"]))}else e.push(y.render(b));return e.join("")},_getSideFeedsElement:function(){return this.$el.find("#feed-list")},_toggleColorPickerByCalendar:function(e){console.log("[SideView#toggleColorPickerByMyCalendar] toggled color picker"),a.show(e.target,"calendar")},_toggleColorPickerByFeed:function(e){console.log("[SideView#_toggleColorPickerByFeed] toggled color picker"),a.show(e.target,"feed")},_checkToggleCalendar:function(e){console.log("[SideView#_checkToggleCalendar] triggered event");var t=$(e instanceof $.Event?e.currentTarget:e),n=t.val(),r=t.attr("data-name"),i=t.attr("data-type"),s=t.is(":checked"),o=s?"show":"hide";this._saveCheckedCalendar(),this.checkedCals=f.getSavedSelectedCalendar(),this._triggerEventToggle(o,n,r,i),this._setCheckedAllFeed()},_triggerEventToggle:function(e,t,n,r){return D(e,[{id:t,name:n,type:r}])},_saveCheckedCalendar:function(){f.saveCheckedCalendar(this.getCheckedCalendarIds())},_bindChagnedCalendarColor:function(e,t,n){console.log("[SideView#_bindChagnedCalendarColor] called function");var r=this,i=e.target,s=this._getCalendarOrFeedId(e.target),o=this._getCollectionBySideType(n),u=o.get(s),a=this._getCalendarIdFromCheckbox(e.target);u.save({color:t},{success:function(e){var t=e.get("color");r._resetCalendarColor(i,t),$(document).trigger("changed:calendar-color",[a,t])}})},_getCollectionBySideType:function(e){var t={};return t[m.calendar]=this.calendars,t[m.feed]=this.feeds,t[e]},_resetCalendarColor:function(e,t){return $(e).attr("class",""),$(e).addClass("chip"),$(e).addClass("bgcolor"+t),this},_setCheckedAllFeed:function(){var e=$("#feed-list");e.find(".star input[type=checkbox][name=calendar_id]:not(:checked)").length?e.find("input[name=check_all]").prop("checked",!1):e.find("input[name=check_all]").prop("checked",!0)},_foldLnb:function(e,t){var n=e instanceof $.Event?$(e.currentTarget).closest("section.lnb"):$(e),r=n.data("type"),i=typeof t=="undefined"?!0:t,s=i?"slideUp":"hide";n.find("ul.side_depth").is(":visible")&&$.prototype[s].call(n.find("ul.side_depth"),"fast",$.proxy(function(){this._setScrollForFeeds(),f.saveSideFoldState(r,!0),n.find(".ic_hide_up").attr("title",h["\ud3bc\uce58\uae30"])},this)),n.find("h1").addClass("folded")},_unfoldLnb:function(e,t){var n=e instanceof $.Event?$(e.currentTarget).closest("section.lnb"):$(e),r=n.data("type"),i=typeof t=="undefined"?!0:t,s=i?"slideDown":"show";n.find("ul.side_depth").is(":hidden")&&$.prototype[s].call(n.find("ul.side_depth"),"fast",$.proxy(function(){this._setScrollForFeeds(),f.saveSideFoldState(r,!1),n.find(".ic_hide_up").attr("title",h["\uc811\uae30"])},this)),n.find("h1").removeClass("folded")},_toggleCheckAllFeeds:function(e){var t,n;$(e.currentTarget).is(":checked")?(t=this._checkAllFeed(),n="show"):(t=this._uncheckAllFeed(),n="hide"),this._saveCheckedCalendar(),this.checkedCals=f.getSavedSelectedCalendar(),D(n,t)},_checkAllFeed:function(){var e=[];return $("#feed-list").find("input[type=checkbox][name=calendar_id]:not(:checked, :disabled)").each(function(t,n){e.push(P(this,!0))}),e},_uncheckAllFeed:function(){var e=[];return $("#feed-list").find("input[type=checkbox][name=calendar_id]:checked").each(function(t,n){e.push(P(this,!1))}),e},_setScrollForFeeds:function(){return setTimeout(function(){var e=$("#feed-list").outerHeight();if(S()){var n=$(window).height(),r=t.isAdvancedTheme()?0:$("header.go_header").outerHeight(),i=t.isAdvancedTheme()?0:85,s=n-r-i;$("#side > section:not([id='feed-list'])").each(function(){s-=$(this).outerHeight()}),H(s)}else H(e)},300),this},_getCalendarOrFeedId:function(e){return $(e).parent().parent().parent().attr("data-id")},_getCalendarIdFromCheckbox:function(e){return $(e).parent().parent().find("input[name='calendar_id']").val()}});return E})}).call(this);