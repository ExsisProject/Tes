(function(){define(["calendar/models/calendar","hgn!calendar/templates/add_mycal_popup","i18n!nls/commons","i18n!calendar/nls/calendar","jquery.go-popup"],function(e,t,n,r){function o(e){var i=$.Deferred(),s,o;return o=_.extend({header:r["\ub0b4 \uce98\ub9b0\ub354 \ucd94\uac00"],width:"300px",modal:!1,pclass:"layer_normal layer_add_mailbox",contents:t({message:r["\ub0b4 \uce98\ub9b0\ub354 \ucd94\uac00 \ud31d\uc5c5 \uba54\uc2dc\uc9c0"]}),buttons:[{btext:n["\ud655\uc778"],btype:"confirm",autoclose:!1,callback:_.bind(function(e){u(e).then(i.resolve,i.reject)},this)},{btext:n["\ucde8\uc18c"],btyle:"cancel"}]},e||{}),s=$.goPopup(o),$(s).on("submit","form[name=form-add-mycal]",function(e){e.preventDefault(),u(s).then(i.resolve,i.reject)}),i}function u(t){var n=$(t),r=n.find("form[name=form-add-mycal]"),i=n.find('input[name="name"]').val(),s=$.Deferred();return a(r)&&(new e).addMyCalendar(i).then(function(){t.close(),s.resolve.apply(s,arguments)},s.reject),s}function a(e){var t=e.find('input[name="name"]'),r=t.val();return s>r.length||r.length>i?($.goError(GO.i18n(n["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:s,arg2:i}),t),t.addClass("enter error"),!1):$.goValidation.containsInvalidFileNameCharacter(r)?($.goError(GO.i18n(n["\ud30c\uc77c\uba85 \ud2b9\uc218 \ubb38\uc790 \ubd88\uac00"]),t),t.addClass("enter error"),!1):!0}var i=32,s=1;return o})})();