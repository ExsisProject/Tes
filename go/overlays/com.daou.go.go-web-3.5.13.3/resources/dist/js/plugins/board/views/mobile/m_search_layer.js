(function(){define(function(require){var e=require("jquery"),t=require("backbone"),n=require("app"),r=require("i18n!nls/commons"),i=require("i18n!admin/nls/admin"),s=require("i18n!board/nls/board"),o=require("hgn!board/templates/mobile/m_search_layer"),u=require("views/mobile/m_search_header"),a=require("board/views/mobile/m_search_result"),f=require("board/views/dept_list");require("GO.util");var l=null,c={"\uac80\uc0c9 \uc870\uac74":r["\uac80\uc0c9 \uc870\uac74"],"\uc804\uccb4":r["\uc804\uccb4"],"\uac80\uc0c9":r["\uac80\uc0c9"],"\uc791\uc131\uc790":s["\uc791\uc131\uc790"],"\ubcf8\ubb38":r["\ubcf8\ubb38"],"\uac8c\uc2dc\ud310":r["\uac8c\uc2dc\ud310"],"\ucee4\ubba4\ub2c8\ud2f0":r["\ucee4\ubba4\ub2c8\ud2f0"],"\ub313\uae00":r["\ub313\uae00"],"\ucca8\ubd80\ud30c\uc77c":r["\ucca8\ubd80\ud30c\uc77c"],"\ucd08\uae30\ud654":i["\ucd08\uae30\ud654"],"\uac80\uc0c9 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694":r["\uac80\uc0c9 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694."],"\uac80\uc0c9\uc5b4":r["\uac80\uc0c9\uc5b4"],"\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694":r["\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694."]},h=t.View.extend({el:"#goSearch",events:{"vclick #searchInit":"_detailSearchInit","vclick a[data-search]":"_simpleSearch","keyup #detailSearchWrap input":"_detailSearch"},initialize:function(e){this.$el.off(),this.packageName=e.packageName},render:function(){return this.$el.html(o({lang:c,isCommunity:this._isCommunity()})),this._renderSearchHeader(),this._renderBoardList(),this.el},_renderSearchHeader:function(){var e=this;u.render({enterSimpleSearchCallback:function(t){e._simpleSearch(t)}})},_renderBoardList:function(){f.render({id:"#detail_select_wrap",boardList:!0,selectClass:"detailSelect w_max",allSelectUse:!0,isCommunity:this._isCommunity()})},_isCommunity:function(){return this.packageName=="community"?!0:!1},_detailSearchInit:function(t){t.preventDefault(),e("#detailSearchWrap input[type=search], #detailSearchWrap input[type=checkbox]").prop("checked",!1).val(""),e("#detailSearchWrap select").prop("selectedIndex",0)},_detailSearch:function(t){if(t.keyCode!=13)return;var r=e.trim(e("#detail_text").val()),i=e.trim(e("#detail_writer").val()),s=e("#select_board"),o=[],u=n.util.shortDate(new Date),f=n.util.toISO8601("1970/01/01"),l=n.util.searchEndDate(u),h=[{data:r,id:"detail_text"},{data:i,id:"detail_writer"}];if(n.util.isAllEmptySearchText(h)){alert(c["\uac80\uc0c9 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694"]);return}if(!n.util.isValidForSearchTextWithCheckbox("detail_text"))return;if(!n.util.isValidSearchTextForDetail(h))return;s.val()=="all"?e.each(e("#detailSearchWrap #select_board option[data-bbstype]"),function(e,t){o.push(t.value)}):o.push(s.val());var p={stype:"detail",content:e("#detail_content").is(":checked")?r:"",comments:e("#detail_comment").is("checked")?r:"",attachFileNames:e("#detail_attachFile").is("checked")?r:"",attachFileContents:e("#detail_attachFile").is("checked")?r:"",userName:i,boardIds:o.join(","),fromDate:f,toDate:l,isCommunity:this._isCommunity(),page:0,offset:15,allSearch:!0};a.render(p)},_simpleSearch:function(t){t.preventDefault();var r=e(t.currentTarget),i=e.trim(e("#commonSearchInput").val());if(!n.util.isValidSearchText(i))return;var s=r.attr("data-search")||"all",o={page:0,offset:15,isCommunity:this._isCommunity()};s=="all"?(o.stype="simple",o.keyword=i):(o.stype="detail",o[s]=i),a.render(o)}});return{render:function(e){return l=new h(e),l.render()}}})}).call(this);