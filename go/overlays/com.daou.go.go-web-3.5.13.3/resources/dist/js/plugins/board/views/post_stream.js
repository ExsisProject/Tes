(function(){define(["jquery","backbone","i18n!nls/commons","i18n!board/nls/board","app","hgn!board/templates/post_stream","hgn!board/templates/post_link","board/collections/post_stream","board/views/post_attaches","views/profile_card","board/models/post","file_upload","board/models/board_config","board/views/post_stream_unit","json","json2","jquery.fancybox-buttons","jquery.fancybox-thumbs","jquery.fancybox","jquery.go-validation","jquery.placeholder","jquery.progressbar","go-fancybox"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d={link_input:r["\ub9c1\ud06c\uc785\ub825"],"\uc774\uc57c\uae30 \ud558\uae30":r["\uc774\uc57c\uae30 \ud558\uae30"],notice_clear:r["\uacf5\uc9c0 \ud574\uc81c"],notice_register:r["\uacf5\uc9c0 \ub4f1\ub85d"],img_attach:n["\uc774\ubbf8\uc9c0 \ucca8\ubd80"],file_attach:n["\ud30c\uc77c \ucca8\ubd80"],link_add:r["\ub9c1\ud06c \ucd94\uac00"],vote:r["\ud22c\ud45c"],range:r["\uc815\ub82c"],sort_create:r["\uae00 \ub4f1\ub85d \uae30\uc900"],sort_update:r["\ub313\uae00 \ub4f1\ub85d \uae30\uc900"],past_feed:r["\uc608\uc804 \ud53c\ub4dc \ubcf4\uae30"],today:r["\uc624\ub298\ub85c"],week_before:r["\uc8fc \uc804\uc73c\ub85c"],month_before:r["\ub2ec \uc804\uc73c\ub85c"],term_custom:r["\uc0ac\uc6a9\uc790 \uc9c0\uc815"],before_post:r["\uc774\uc804 \uae00"],portrait:r["\ucd08\uc0c1\ud654"],meta_img:r["\uba54\ud0c0\uc815\ubcf4 \uc774\ubbf8\uc9c0"],link_meta:r["\ub9c1\ud06c \uba54\ud0c0\uc815\ubcf4 \ud0c0\uc774\ud2c0"],save:n["\uc800\uc7a5"],preview:n["\ubbf8\ub9ac\ubcf4\uae30"],cancel:n["\ucde8\uc18c"],sample_img:r["\uc0d8\ud50c\uc774\ubbf8\uc9c0"],modify:n["\uc218\uc815"],del:n["\uc0ad\uc81c"],comment:r["\uac1c\uc758 \ub367\uae00"],all_view:r["\ubaa8\ub450 \ubcf4\uae30"],comment_modify:r["\ub367\uae00 \uc218\uc815"],comment_delete:r["\ub367\uae00 \uc0ad\uc81c"],comment_save:r["\ub313\uae00 \uc791\uc131"],close:n["\ub2eb\uae30"],plus_list:r["Plus 1 \ud55c \uc0ac\ub78c\ub4e4"],more_view:r["\ub354 \ubcf4\uae30"],more_content:r["\ub354\ubcf4\uae30"],content_fold:n["\uc811\uae30"],no_content:r["\uc544\uc9c1 \ub4f1\ub85d\ub41c \uae00\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uae00\uc744 \ub4f1\ub85d\ud574 \uc8fc\uc138\uc694."],alert_max_attach_cnt:r["\ucd5c\ub300 \ucca8\ubd80 \uac2f\uc218\ub294 0\uac1c \uc785\ub2c8\ub2e4."],alert_max_attach_size:r["\ucca8\ubd80\ud560 \uc218 \uc788\ub294 \ucd5c\ub300 \uc0ac\uc774\uc988\ub294 0MB \uc785\ub2c8\ub2e4."],alert_exclude_extension:r["\ud655\uc7a5\uc790\uac00 \ub561\ub561\uc778 \uac83\ub4e4\uc740 \ucca8\ubd80 \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."],confirm_delete:r["\uac8c\uc2dc\uae00\uc744 \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],confirm_comment_delete:r["\ub313\uae00\uc744 \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],confirm_delete_message:r["\uc0ad\uc81c\ud655\uc778\uba54\uc138\uc9c0"],confirm_comment_delete_message:r["\ub313\uae00\uc0ad\uc81c\ud655\uc778\uba54\uc138\uc9c0"],alert_content:r["\uc785\ub825\ub41c \ub0b4\uc6a9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],alert_length:r["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],input_placeholder:r["\uc0c8\ub85c\uc6b4 \uc815\ubcf4, \uae30\ubd84 \uc88b\uc740 \uc18c\uc2dd\uc744 \ubd80\uc11c\uc6d0\ub4e4\uacfc \uacf5\uc720\ud558\uc138\uc694."],comment_placeholder:r["\ub313\uae00\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."],alert_url:r["\uc798\ubabb\ub41c url\uc785\ub2c8\ub2e4."],alert_fail:n["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."],title_recommend:n["\uc88b\uc544\uc694 \ud558\uae30"],title_recommend_cancel:n["\uc88b\uc544\uc694 \ucde8\uc18c"],title_open:n["\ud3bc\uce58\uae30"],title_close:n["\uc811\uae30"],link_meta_delete:r["\uba54\ud0c0 \ub370\uc774\ud130 \uc0ad\uc81c"],link_meta_title:r["\ub9c1\ud06c \uba54\ud0c0\uc815\ubcf4 \ud0c0\uc774\ud2c0"],link_meta_img:r["\uba54\ud0c0\uc815\ubcf4 \uc774\ubbf8\uc9c0"],link_content_delete:r["\ub0b4\uc6a9 \uc0ad\uc81c"],link_img_delete:r["\uc774\ubbf8\uc9c0 \uc0ad\uc81c"],post_comment:r["\ub313\uae00"],count:r["\uac1c"],back:n["\uc774\uc804"],download:n["\ub2e4\uc6b4\ub85c\ub4dc"],alim_mail:n["\uba54\uc77c\uc54c\ub9bc"],alim_push:n["\ud478\uc2dc\uc54c\ub9bc"],alim_alert:n["\uad00\ub9ac\uc790 \uc124\uc815\uc73c\ub85c \ud558\ub098\uc758 \uc54c\ub9bc\uc740 \ubc18\ub4dc\uc2dc \uc120\ud0dd\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."],alim_tooltip:n["\ud574\ub2f9 \uac8c\uc2dc\ud310\uc5d0 \uc811\uadfc \uac00\ub2a5\ud55c \uc784\uc9c1\uc6d0\uc5d0\uac8c\ub9cc \uc54c\ub9bc\uc774 \ubc1c\uc1a1\ub429\ub2c8\ub2e4."],mail_push_desc:r["\uba54\uc77c\uc54c\ub9bc\uc548\ub0b4"],"\uc774 \uacf3\uc5d0 \ud30c\uc77c\uc744 \ub4dc\ub798\uadf8 \ud558\uc138\uc694":n["\uc774 \uacf3\uc5d0 \ud30c\uc77c\uc744 \ub4dc\ub798\uadf8 \ud558\uc138\uc694"],public_writer:r["\uc791\uc131\uc790 \uacf5\uac1c"]},v=t.View.extend({manage:!1,initialize:function(t){console.log("PostStream initialize"),this.options=t||{},this.boardId=this.options.boardId,this.boardModel=h.get(this.boardId),this.bbsWritable=this.options.bbsWritable,this.owner=this.options.owner||{},this.isCommunity=this.options.isCommunity,this.isCompany=this.owner.ownerType=="Company",this.commentFlag=this.options.commentFlag,this.sendMailFlag=this.options.sendMailFlag,this.recommendFlag=!1,this.isMoreComment=!1,this.commentViewFlag=!1,this.page=0,this.streamFromDate="",this.streamToDate="",this._bindEvents(),this.posts=new u([],{boardId:this.boardId}),this.posts.on("sync",e.proxy(function(){this._renderList()},this)),this.posts.fetch({data:{page:0,offset:"10",sorts:"createdAt desc"}}),this.isSaaS=GO.session().brandName=="DO_SAAS",this.totalAttachSize=0,this.totalAttachCount=0},events:{"change select#postSort":"changePostSort","change select#termSort":"changeTermSort","keyup #feedContent":"streamKeyCheck","keyup textarea.w_max":"expandTextarea","keyup textarea#feedContent":"expandTextarea","keyup textarea.txt_mini":"expandTextarea","keyup textarea.edit":"expandTextarea","click input[id=post_stream_mail_noti]":"writeNoti","click input[id=post_stream_push_noti]":"writeNoti","click span[id=sFeedWrite]":"feedWrite","click li.file span.ic_del":"attachDelete","click #moreButton":"listMore","click div.article_wrap div.info a.name":"showProfileCardTrigger","click span.ic_link_up":"linkShow","click div#linkWrap span.txt":"linkInsert","click input[id=link_img_delete]":"linkImageDelete","click input[id=link_description_delete]":"linkDescriptionDelete","click li.url span.ic_del":"linkDelete","click span#beforeCalendarIcon":"beforeCalendarIcon","dragover #dropZone":"_dragOver","dragleave #dropZone":"_dragLeave","drop #dropZone":"_drop"},render:function(){return this.page=0,this.streamFromDate="",this.streamToDate="",this.$el.html(this.makeTemplete({collection:this.posts.toJSON(),boardId:this.boardId,bbsWritable:this.bbsWritable})),this.feedInputFocus(),this.initUpload("#steam_image_upload","img"),this.pluginInit(),this.setViewedTotalAttachSize(),e(".fancybox-thumbs").goFancybox(),e("#content").addClass("go_renew"),this.boardModel.toJSON().notificationFlag&&this.changeNotiStatus(!0,e("#post_stream_push_noti")),this},_dragOver:function(t){t.preventDefault(),t.stopPropagation(),t.originalEvent.dataTransfer.dropEffect="move",e("#dropZone").addClass("drag_file")},_dragLeave:function(t){t.preventDefault(),t.stopPropagation(),e("#dropZone").removeClass("drag_file")},_drop:function(e){this._dragLeave(e)},_toggleStreamOption:function(e){this.$("#streamOption").toggle(e)},_renderList:function(){var e=this.posts.length>0;this.$("li[el-no-content]").toggle(!e),this.moreBtnHide(this.posts.page.lastPage);if(!e)return;this.posts.page.page==0&&this.$("li[data-postid]").remove(),this.posts.each(function(e){this.initItemView(e)},this),this._postAttachResize(),this._toggleStreamOption(e)},_bindEvents:function(){var t=this;e(window).unbind("scroll.board"),e(window).bind("scroll.board",e.proxy(function(t){e(document).height()-e(window).height()-e(document).scrollTop()<2&&this.listMore()},this)),e("div.article textarea.edit").live("keyup",function(e){t.postUpdateKeycheck(e)}),e("div.reply_wrap textarea.edit").live("keyup",function(e){t.commentUpdateKeycheck(e)})},beforeCalendarIcon:function(){e("#beforePicker").focus()},streamKeyCheck:function(e){e.shiftKey&&e.keyCode==13&&this.feedWrite()},postUpdateKeycheck:function(t){t.shiftKey&&t.keyCode==13&&e(t.currentTarget).parents("div.article").first().find('span[data-btntype="postUpdate"]').trigger("click")},commentUpdateKeycheck:function(t){t.shiftKey&&t.keyCode==13&&e(t.currentTarget).parents("div.msg_wrap").first().find('span[data-btntype="commentUpdate"]').trigger("click")},expandTextarea:function(e){GO.util.textAreaExpand(e)},feedInputFocus:function(e){this.$("#feedWriteSmall").hide(),this.$("#feedWriteLarge").show()},linkDelete:function(t){e("#metaWrap").children().remove(),e("#linkWrap").css("display","none"),e("#optionDisplay").find("li").length<1&&(e("#optionDisplay").removeClass("option_display"),e("#optionDisplay").css("height","1px"))},linkDescriptionDelete:function(t){var n=e(t.target);n.is(":checked")?e("#metaWrap .meta_contents").hide():e("#metaWrap .meta_contents").show()},linkImageDelete:function(t){var n=e(t.target);n.is(":checked")?e("#metaWrap .thumb").hide():e("#metaWrap .thumb").show()},linkInsert:function(t){var n=this.boardId,i=encodeURIComponent(t);if(e.trim(i)==""){e.goMessage(r["\ub9c1\ud06c\ub97c \uc785\ub825\ud558\uc138\uc694."]);return}var s=GO.contextRoot+"api/board/"+n+"/html/parser?url="+i;e.go(s,"",{async:!1,qryType:"GET",contentType:"application/json",responseFn:function(t){if(t.code==200){var n=o({dataset:t.data,lang:d});e("#metaWrap").html(n),e("#linkUrl").val("")}else e.goMessage(d.alert_url)},error:function(t){e.goMessage(d.alert_url)}})},linkShow:function(t){this.feedInputFocus(),e("#optionDisplay").addClass("option_display"),e("#linkWrap").show(),e("#linkUrl").focus(),e("#optionDisplay").css("height","auto"),this.openAttachPart(e("#metaWrap"))},moreBtnHide:function(t){e("#moreButton img").hide(),e("#moreButton a").toggle(!t)},listMore:function(){if(this.posts.page.lastPage)return;this.$("#moreButton img").show(),this.$("#moreButton a").hide(),this.page+=1;var e={page:this.page,offset:"10",sorts:"createdAt desc"};this.streamFromDate!=""&&(e.fromDate=this.streamFromDate),this.streamToDate!=""&&(e.toDate=this.streamToDate),this.posts.fetch({data:e})},showProfileCardTrigger:function(t){var n=e(t.currentTarget).parents(".article").find("a[data-userid]").attr("data-userid");(n||n!="")&&f.render(n,t.currentTarget)},sortCalDate:function(){var t=e("#postSort option:selected"),n=e("#termSort option:selected"),r,i;if(n.val()=="today")e("#stream_customInput").hide(),r=GO.util.toISO8601("1970/01/01"),i=GO.util.toISO8601(new Date);else{if(n.val()!="before")return e("#stream_customInput").show(),null;e("#stream_customInput").hide();var s=new Date,o=e("#termSort option:selected"),u=o.attr("data-key"),a=o.attr("data-amount");r=GO.util.toISO8601("1970/01/01"),i=GO.util.calDate(s,u,a)}return{startAt:r,endAt:i,selectOrder:t.val()}},changeTermSort:function(e){var t=this.sortCalDate();if(t==null)return;this.page=0;var n={page:"0",offset:"10",fromDate:t.startAt,toDate:t.endAt,sorts:t.selectOrder+" desc"};this.streamFromDate=t.startAt,this.streamToDate=t.endAt,this.posts.fetch({data:n})},changePostSort:function(e){var t=this.sortCalDate();if(t==null)return;this.page=0;var n={page:"0",offset:"10",fromDate:t.startAt,toDate:t.endAt,sorts:t.selectOrder+" desc"};this.streamFromDate=t.startAt,this.streamToDate=t.endAt,this.posts.fetch({data:n})},attachDelete:function(t){e(t.target).parents("li").first().remove(),e("#optionDisplay").find("li").length<1&&(e("#optionDisplay").removeClass("option_display"),e("#optionDisplay").css("height","1px"),e("#linkWrap").hide(),e(".meta_info_wrap").hide()),this.setViewedTotalAttachSize()},feedWrite:function(){if(e("#progressbar").length>0)return e.goMessage(n["\ud604\uc7ac \ud30c\uc77c \uc5c5\ub85c\ub4dc \uc911\uc785\ub2c8\ub2e4."]),!1;var t=e("#isPublicWriter").is(":checked"),r=e("#post_stream_mail_noti").is(":checked"),i=e("#post_stream_push_noti").is(":checked"),s=e("#feedContent").val();if(e.trim(s)==""||s==d.input_placeholder){e.goMessage(d.alert_content);return}var o=s.match(/\bhttps?:\/\/\S+/gi);o&&o.length>0&&this.linkInsert(o[0]);var u=[],a=e("#imgWrap,#fileWrap").find("li:not(.attachError)");a.each(function(){u.push({path:e(this).attr("data-tmpname"),name:e(this).attr("data-name"),hostId:e(this).attr("data-hostid")})});var f=e("#metaWrap li"),c=[];if(f.length>0){var h=e("#metaWrap a.url_type").html(),p=e("#metaWrap a.url_type").attr("data-video"),v=this.$("#link_img_delete").is(":checked")?null:e("#metaWrap .thumb img").attr("src"),m=e("#metaWrap .title").html(),g=this.$("#link_description_delete").is(":checked")?null:e("#metaWrap .meta_contents").html();c.push({url:h,title:m,description:g,imageSrc:v,videoSrc:p})}var y=this.boardId,b=this;this.writemodel=new l,this.writemodel.set({boardId:y,postId:""},{silent:!0}),this.writemodel.save({content:s,status:"OPEN",notiMailFlag:r,notiPushFlag:i,attaches:u,links:c,publicWriter:t},{success:function(t,n){b.initItemView(t,!0,!0),b._postAttachResize(),e("#optionDisplay").find("li").remove(),e("#optionDisplay").removeClass("option_display"),e("#linkWrap").css("display","none"),e("#optionDisplay").css("height","1px"),e("#feedContent").val("").attr("style","height:80px"),e(".commentAttachPart ul").css("margin-top","0px"),e("#post_stream_push_noti").attr("checked",!1).parent().removeClass("action_on").addClass("action_off"),e("#post_stream_mail_noti").attr("checked",!1).parent().removeClass("action_on").addClass("action_off"),e("div #mail_push_desc").hide(),b.boardModel.toJSON().notificationFlag&&b.changeNotiStatus(!0,e("#post_stream_push_noti")),b.nullTempleteDelete(),GO.EventEmitter.trigger("board","change:boardInfo",b.boardId),GO.EventEmitter.trigger(b.isCommunity?"community":"board","changed:lastPostedAt",b.boardId)},error:function(t,n){var r=JSON.parse(n.responseText);r.message?e.goMessage(r.message):e.goMessage(d.alert_fail)}})},_postAttachResize:function(){a.resize(this.$el)},nullTempleteDelete:function(){this.$el.find("p.data_null").parent().remove()},changeNotiStatus:function(t,n){n.prop("checked",t);var r=n.attr("id");t?(n.siblings("label").parent().removeClass("action_off").addClass("action_on"),r.indexOf("mail")>0&&e("div #mail_push_desc").show()):(n.siblings("label").parent().removeClass("action_on").addClass("action_off"),r.indexOf("mail")>0&&e("div #mail_push_desc").hide())},writeNoti:function(t){var n=e(t.target);this.changeNotiStatus(n.is(":checked"),n),this.boardModel.toJSON().notificationFlag&&!e("#post_stream_mail_noti").is(":checked")&&!e("#post_stream_push_noti").is(":checked")&&(e.goError(d.alim_alert),this.changeNotiStatus(!0,e("#post_stream_push_noti")))},openAttachPart:function(e){e.parent().css("display","")},initUpload:function(t){var r=this,s={el:t,context_root:GO.contextRoot,button_text:"",button_width:70,button_height:23,progressUse:!0,progressEl:"#progress_bar",url:"api/file?GOSSOcookie="+e.cookie("GOSSOcookie"),mode:"IMAGE",dropZone:"#dropZone",imgTmpl:["<span class='wrap_btn wrap_file_upload'>","<span class='fileinput-button'>","<span class='ic ic_file_s'></span>","<input type='file' name='file' title='{title}' style='height:inherit;' multiple=''/>","</span>","<div class='progress' style='display:none;margin-top:5px'></span>","</span>"].join("")},o=GO.config("attachSizeLimit")?parseInt(GO.config("maxAttachSize")):parseInt(GO.config("commonAttachConfig").maxAttachSize),u=o*1024*1024,a=GO.config("attachNumberLimit")?parseInt(GO.config("maxAttachNumber")):parseInt(GO.config("commonAttachConfig").maxAttachNumber);(new c(s)).queue(function(e,t){}).start(function(t,s){if(!GO.config("attachFileUpload"))return e.goAlert(n["\ud30c\uc77c\ucca8\ubd80\uc6a9\ub7c9\ucd08\uacfc"]),r.$("#dropZone").removeClass("drag_file"),!1;r.feedInputFocus(),e("input[name=disabled]:checked",this).length&&t.preventDefault();if(GO.config("excludeExtension")!=""){var f=e.inArray(s.type.substr(1).toLowerCase(),GO.config("excludeExtension").split(","));if(f>=0)return e.goMessage(i.i18n(d.alert_exclude_extension,"arg1",GO.config("excludeExtension"))),r.$("#dropZone").removeClass("drag_file"),!1}if(r.isSaaS||GO.config("attachSizeLimit")){if(u<s.size)return e.goMessage(i.i18n(d.alert_max_attach_size,"arg1",o)),r.$("#dropZone").removeClass("drag_file"),!1;r.totalAttachSize+=s.size}if(r.isSaaS||GO.config("attachNumberLimit")){var l=e("#imgWrap").find("li").length+e("#fileWrap").find("li").length+r.totalAttachCount+1;if(a<l)return e.goMessage(i.i18n(d.alert_max_attach_cnt,"arg1",a)),r.$("#dropZone").removeClass("drag_file"),!1;r.totalAttachCount++}var c='<span class="btn_wrap"><span class="txt" data-btntype="uploadCancelButton" class="ic_classic ic_del" title="'+d.cancel+'"></span>'+"</span>";e("#progress_file").html(c),e("#progress_file").show()}).progress(function(e,t){}).success(function(t,n,i){e("#progress_file").hide();var s="",o="file";if(GO.util.fileUploadErrorCheck(n))s="<strong class='caution'>"+GO.util.serverMessage(n)+"</strong>",o="attachError";else if(GO.util.isFileSizeZero(n))return e.goAlert(GO.util.serverMessage(n)),!1;r.feedInputFocus(),e("#optionDisplay").hasClass("option_display")||(e("#optionDisplay").addClass("option_display"),e("#optionDisplay").css("height","auto"));var n=n.data,u=n.filePath,a=n.fileName,f=n.fileExt,l=GO.util.getHumanizedFileSize(n.fileSize),c=n.thumbnail,h=n.hostId,p="";if(GO.util.isImage(f))p='<li class="'+o+'" data-tmpname="'+u+'" data-name="'+a+'" data-hostid="'+h+'" data-size="'+n.fileSize+'">'+'<span class="item_image">'+'<span class="thumb"><img src="'+c+'" alt="'+a+'" /></span>'+'<span class="name">'+a+"</span>"+'<span class="size">('+l+")</span>"+"</span>"+'<span class="btn_wrap">'+'<span class="ic_classic ic_del" title="'+d.del+'"></span>'+"</span>"+"</li>",r.openAttachPart(e("#imgWrap")),e("#imgWrap").append(p);else{var v="def";GO.util.fileExtentionCheck(f)&&(v=f),p='<li class="'+o+'" data-tmpname="'+u+'" data-name="'+a+'" data-hostid="'+h+'" data-size="'+n.fileSize+'">'+'<span class="item_file">'+'<span class="btn_bdr">'+'<span class="ic_classic ic_del" title="'+d.del+'"></span>'+"</span>"+'<span class="ic_file ic_'+v+'"></span>'+'<span class="name">'+a+"</span>"+'<span class="size">('+l+")</span>"+s+"</span>"+"</li>",r.openAttachPart(e("#fileWrap")),e("#fileWrap").append(p)}e("#progressBarWrap").html(""),r.setViewedTotalAttachSize(),r.resetAttachSizeAndCount()}).complete(function(e,t){}).error(function(t,i){e("#progress_file").html(""),i.jqXHR&&(i.jqXHR.statusText=="abort"?e.goAlert(n["\ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]):e.goAlert(n["\uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."]),r.resetAttachSizeAndCount())})},makeTemplete:function(e){var t=this,n=t.boardModel.toJSON().anonymFlag,r=t.boardModel.toJSON().availableAnonymousWriterOptionInPost,i={dataset:e.collection,isListNull:e.collection.length==0?"":"none",lang:d,bbsWritable:t.bbsWritable,isCommunity:t.isCommunity,isCompany:t.isCompany,anonymFlag:n,availableAnonymousWriterOptionInPost:r};return s(i)},pluginInit:function(){e("input[placeholder], textarea[placeholder]").placeholder(),e(".commentAttachPart ul").css("margin-top","0px");var t=e("#beforePicker");e.datepicker.setDefaults(e.datepicker.regional[GO.config("locale")]),t.datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:"",onSelect:e.proxy(function(t){var n=e("#postSort option:selected"),r=GO.util.toISO8601("1970/01/01"),i=GO.util.searchEndDate(e("#beforePicker").val()),s={page:"0",offset:"10",fromDate:r,toDate:i,sorts:n.val()+" desc"};this.page=0,this.streamFromDate=r,this.streamToDate=i,this.posts.fetch({data:s})},this)})},initItemView:function(t,n,r){var i=new p({el:e("<li></li>"),model:t,boardId:this.boardId,postId:t.id,boardModel:this.boardModel,isDetail:r?!0:!1,sendMailFlag:this.sendMailFlag,isCommunity:this.isCommunity});n?this.$("ul.feed_type").prepend(i.render().el):this.$("ul.feed_type").append(i.render().el),e(".fancybox-thumbs").goFancybox()},getViewedTotalAttachSize:function(){var t=0;return e("#fileWrap, #imgWrap").find("li").each(function(){t+=parseInt(this.getAttribute("data-size"),0)}),t},setViewedTotalAttachSize:function(){if(this.isSaaS||GO.config("attachSizeLimit")){var e=this.getViewedTotalAttachSize();this.$el.find("#total_size").html(GO.util.displayHumanizedAttachSizeStatus(e))}},resetAttachSizeAndCount:function(){if(this.isSaaS||GO.config("attachSizeLimit"))this.totalAttachSize=0,this.totalAttachCount=0}});return{render:function(t){var n=new v({boardId:t.boardId,bbsWritable:t.writable,isCommunity:t.isCommunity,owner:t.owner,commentFlag:t.commentFlag||!1,sendMailFlag:t.sendMailFlag||!1});e("#content #postContents").html(n.el),n.render()}}})}).call(this);