(function(){define(["jquery","backbone","app","i18n!board/nls/board","i18n!nls/commons","board/views/dept_list","views/profile_card","board/views/notice_layer","board/collections/header_list","board/collections/posts","hgn!board/templates/post_bbs_null","hgn!board/templates/header_select_list","hgn!board/templates/post_reader_list","hgn!board/templates/post_recommend_list","hgn!board/templates/post_bbs_custom_button","hgn!board/templates/post_notice","grid","jquery.go-sdk","jquery.go-popup","jquery.go-grid","jquery.ui","GO.util","jquery.placeholder","jquery.cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={download:i["\ubaa9\ub85d \ub2e4\uc6b4\ub85c\ub4dc"],move:i["\uc774\ub3d9"],copy:i["\ubcf5\uc0ac"],"delete":i["\uc0ad\uc81c"],search:i["\uac80\uc0c9"],add_stickable:r["\uacf5\uc9c0\ub85c \ub4f1\ub85d"],post_write:r["\uc0c8\uae00\uc4f0\uae30"],post_new:i["\uc0c8\uae00"],attach_files:r["\ucca8\ubd80\ud30c\uc77c"],num:r["\ubc88\ud638"],title:i["\uc81c\ubaa9"],writer:r["\uc791\uc131\uc790"],created_at:r["\uc791\uc131\uc77c"],read_count:r["\uc870\ud68c"],recommend_count:r["\uc88b\uc544\uc694"],post_null:r["\uc791\uc131\ub41c\uae00\uc5c6\uc74c"],post_delete_title:r["\uac8c\uc2dc\uae00\uc744 \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],post_delete_desc:r["\uc0ad\uc81c\ud655\uc778\uba54\uc138\uc9c0"],post_move_success:i["\uc131\uacf5\ud588\uc2b5\ub2c8\ub2e4."],post_move_title:r["\uac8c\uc2dc\ubb3c \uc774\ub3d9"],post_move_desc:r["\uac8c\uc2dc\ubb3c\uc744 \uc774\ub3d9\uc2dc\ud0ac \uac8c\uc2dc\ud310\uc744 \uc120\ud0dd\ud558\uc138\uc694."],post_move_header_desc:r["\ub9d0\uba38\ub9ac\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694."],post_move_orphan_desc:r["\uc6d0\uae00\uc774 \uc0ad\uc81c\ub41c \ub2f5\uae00\uc740 \uc774\ub3d9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."],post_move_reply_desc:r["\uc6d0\uae00 \uc774\ub3d9 \uc2dc, \ub2f5\uae00\ub3c4 \ud568\uaed8 \uc774\ub3d9\ud569\ub2c8\ub2e4."],post_move_reply_only:r["\ub2f5\uae00\uc740 \uc6d0\uae00\uacfc \ud568\uaed8 \uc774\ub3d9\uc2dc\ud0ac \uc218 \uc788\uc2b5\ub2c8\ub2e4."],post_status_close:i["\ube44\uacf5\uac1c"],post_reply:r["\ub2f5\uae00"],post_sticky:r["\uacf5\uc9c0"],post_sticky_term:r["\uacf5\uc9c0 \uae30\uac04 \uc124\uc815"],search_period_msg:i["\uac80\uc0c9\uae30\uac04\uc744 \uc798\ubabb \uc785\ub825\ud558\uc168\uc2b5\ub2c8\ub2e4."],post_hidden_msg:r["\uc5f4\ub78c\uad8c\ud55c\uc774 \uc5c6\ub294 \uac8c\uc2dc\ubb3c\uc785\ub2c8\ub2e4."],post_orphan_msg:r["\uc6d0\uae00\uc774 \uc0ad\uc81c\ub41c \ub2f5\uae00"],header_default:r["\ub9d0\uba38\ub9ac \uc120\ud0dd"],header_all:i["\uc804\uccb4"],notice_delete_title:r["\uacf5\uc9c0\uc0ac\ud56d\uc5d0\uc11c \ub0b4\ub9ac\uc2dc\uaca0\uc2b5\ub2c8\uae4c"],alert_length:r["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],placeholder_search:i["\ud50c\ub808\uc774\uc2a4\ud640\ub354\uac80\uc0c9"],was_not_selected:r["\uc120\ud0dd\ub41c \uac8c\uc2dc\ubb3c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"],copy_fail:i["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."],post_copy_title:r["\uac8c\uc2dc\ubb3c \ubcf5\uc0ac"],post_copy_message:r["* \uc6d0\uae00 \ubcf5\uc0ac\uc2dc, \ub2f5\uae00\ub3c4 \ud568\uaed8 \ubcf5\uc0ac\ub429\ub2c8\ub2e4."],post_copy_desc:r["\uac8c\uc2dc\ubb3c\uc744 \ubcf5\uc0ac\ud560 \uac8c\uc2dc\ud310\uc744 \uc120\ud0dd\ud558\uc138\uc694."],post_copy_success:i["\uc131\uacf5\ud588\uc2b5\ub2c8\ub2e4."],post_copy_orphan_desc:r["* \uc6d0\uae00\uc774 \uc0ad\uc81c\ub41c \ub2f5\uae00\uc740 \ubcf5\uc0ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."],post_copy_reply_desc:r["* \uc6d0\uae00 \ubcf5\uc0ac\uc2dc, \ub2f5\uae00\ub3c4 \ud568\uaed8 \ubcf5\uc0ac\ub429\ub2c8\ub2e4."],post_copy_reply_only:r["\ub2f5\uae00\uc740 \uc6d0\uae00\uacfc \ud568\uaed8 \ubcf5\uc0ac\uc2dc\ud0ac \uc218 \uc788\uc2b5\ub2c8\ub2e4."],post_copy_same_board_alert:r["\ub3d9\uc77c\ud55c \uac8c\uc2dc\ud310\uc774 \uc120\ud0dd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],reomment_list_tab:r["\uc88b\uc544\uc694"],read_count:r["\uc870\ud68c"],ok:i["\ud655\uc778"]},y=t.View.extend({el:"#postContents",initialize:function(e){this.options=e||{},this.resetPage(this,this.options),this.anonymFlag=this.options.anonymFlag,this.posts=new f([],{boardId:this.boardId,boardType:"classic",params:["headerId"]}),this.posts.setDuration(),this.notices=new f([],{boardId:this.boardId,boardType:"classic",isNoticeType:!0})},events:{"click a.btn_tool[data-btntype='delete']":"actionCheckedDelete","click a.btn_tool[data-btntype='move']":"actionCheckedMove","click a.btn_tool[data-btntype='copy']":"actionCheckedCopy","click a.btn_tool[data-btntype='notice']":"actionCheckedSticky","click a.btn_tool[data-btntype='download']":"actionCsvDownload","change #header_list":"headerFilter","click tr.noti span.ic_notice":"actionNoticeDelete","click a#listPostRecommend":"showPostRecommend","click a#listPostReader":"showPostReader","click ul.tab_nav2 li.first":"showPostReader","click ul.tab_nav2 li.last":"showPostRecommend"},render:function(){return this._renderDataTables(),this._renderCustomButtons(),this.$el.find("input[placeholder]").placeholder(),this.el},getHeaderList:function(){if(!this.headerFlag)return"";var e=a.getHeaderList({boardId:this.boardId}).toJSON();if(e.length){var t=c({dataset:e,defaultSelect:g.header_default,selectId:"header_list",selectClass:"article_head"});return t}return},resetPage:function(e,t){e.boardId=t.boardId.split("?")[0],e.owner=t.owner,e.manageable=t.manageable||!1,e.isCommunity=t.isCommunity||!1,e.writable=t.writable||!1,e.status=t.status,e.headerFlag=t.headerFlag||!1,e.headerRequiredFlag=t.headerRequiredFlag||!1,e.status=="CLOSED"&&(e.writable=!1),e.controlButtons=null,e.noticePopup=null,e.writeUrl=GO.contextRoot+"app/board/post/write/"+e.owner.ownerId+"/"+e.boardId,e.isCommunity&&(e.writeUrl=GO.contextRoot+"app/community/"+e.owner.ownerId+"/board/"+e.boardId+"/post/write")},goPostDetail:function(e){var t="board/"+this.boardId+"/post/"+e;this.isCommunity&&(t="community/"+this.owner.ownerId+"/board/"+this.boardId+"/post/"+e),n.router.navigate(t,{trigger:!0})},_renderPostTitle:function(e){var t="";e.readPost||(t="read_no");var n=['<p class="depth',e.depth," ",t,'">'];e.depth&&n.push('<span class="ic_classic ic_answer"></span>&nbsp;');if(e.status==="CLOSE"){n.push('<span class="ic_classic ic_lock" title="',g.post_status_close,'"></span>&nbsp;');if(e.summary==" $$#HIDDEN_POST#$$ ")return n.push(g.post_hidden_msg),n.join("")}n.push('<a class="boardTitle" data-id="',e.id,'" data-bypass><span class="list_subject">'),e.orphanFlag&&n.push("<strong>[",g.post_orphan_msg,"]</strong>&nbsp;"),this.anonymFlag&&e.writer.name&&n.push('<span class="state ghost" title="',e.writer.name,"&nbsp;",e.writer.positionName,'">',i["\uacf5\uac1c"],"</span>&nbsp;"),e.header&&n.push("["+e.header.name+"]&nbsp;"),e.hasAttach&&n.push('&nbsp;<span class="ic ic_file_s" title="',g.attach_files,'"></span>&nbsp;');if(e.title){var r=e.title.replace(/ {1,}/g," ");n.push(GO.util.textToHtml(r))}return n.push("</span></a>"),e.commentsCount&&n.push('&nbsp;<span class="ic_classic ic_reply"></span><span class="num">[<strong>'+e.commentsCount+"</strong>]</span>"),e.repliesCount&&n.push('&nbsp;<span class="ic_classic ic_answer"></span><span class="num">',g.post_reply,"[<strong>"+e.repliesCount+"</strong>]</span>"),e.newFlag&&n.push('&nbsp;<span class="ic_classic ic_new2" title="',g.post_new,'"></span>'),n.push("</p>"),n.join("")},headerFilter:function(t){var n=e(t.currentTarget).val();this.posts.setHeaderId(n||""),this.posts.pageNo=0,this.posts.fetch()},_renderDataTables:function(){var t=this,n=[{value:"titleAndContent",label:r["\uc81c\ubaa9+\ub0b4\uc6a9"]},{value:"titleOnly",label:i["\uc81c\ubaa9"]},{value:"userName",label:r["\uc791\uc131\uc790"]}],s=[{className:"num",label:r["\ubc88\ud638"],render:function(e){var t=e.collection;return t.total-t.indexOf(e)-t.pageNo*t.pageSize}},{className:"subject",label:i["\uc81c\ubaa9"],header:Hogan.compile('<div class="article_head_wrap">{{{headerList}}}</div>').render({headerList:t.getHeaderList()}),render:function(e){return t._renderPostTitle(e.toJSON())}},{className:"name",label:r["\uc791\uc131\uc790"],render:function(e){var t=e.get("writer");return t?(t.positionName=t.positionName||"",t.otherCompanyUser?'<a data-profile data-id="'+t.id+'" class="multi_user">'+t.name+" "+t.positionName+"</a>":'<a data-profile data-id="'+t.id+'">'+t.name+" "+t.positionName+"</a>"):"-"}},{className:"date",label:r["\uc791\uc131\uc77c"],render:function(e){return GO.util.boardDate(e.get("createdAt"))}},{className:"read",label:r["\uc870\ud68c"],render:function(e){return t.anonymFlag?e.get("readCount")||"-":'<a id="listPostReader" data-id = "'+e.id+'">'+e.get("readCount")||"-</a>"}},{className:"plus",label:r["\uc88b\uc544\uc694"],render:function(e){var n=e.get("recommendCount");return t.anonymFlag?'<span class="plus_num">'+(n?n:0)+"</span>":'<a id="listPostRecommend" data-id = "'+e.id+'"><span class="plus_num">'+(n?n:0)+"</span></a>"}}];t.anonymFlag&&(n=_.filter(n,function(e){return e.value!=="userName"}),s=_.filter(s,function(e){return e.className!=="name"}));var o=this.notices.fetch();this.gridView=new m({el:this.el,collection:this.posts,checkbox:this.manageable&&t.status!="CLOSED",tableClass:"type_normal tb_classic_list dataTable",usePeriod:!0,emptyContent:l({lang:g,writable:this.writable,writeUrl:this.writeUrl}),columns:s,searchOptions:n,drawCallback:function(n){n.total==0&&!n.keyword?e(".dataTables_paginate, .tool_bar, .table_search").hide():e(".dataTables_paginate, .tool_bar, .table_search").show(),t.posts.keyword?t.noticeTotal=0:o.done(function(){t._renderNotice()}),e(window).scrollTop(0),n.headerId&&t.$el.find("#header_list option[value='"+n.headerId+"']").attr("selected","selected"),t.$el.find(".read_no").closest("tr").addClass("read_no")}}),this.posts.fetch(),this.gridView.render(),this.gridView.$el.on("navigate:grid",e.proxy(function(t,n){var i=this.posts.findWhere({id:parseInt(n,10)});if(i&&_.isUndefined(i.get("actions"))){e.goMessage(r["\uac8c\uc2dc\uae00 \uc5f4\ub78c\ubd88\uac00 \uba54\uc138\uc9c0"]);return}this.goPostDetail(n)},this))},actionCsvDownload:function(e){GO.util.downloadCsvFile("api/board/"+this.boardId+"/posts/classic/download?"+this.posts.makeParam())},actionNoticeDelete:function(t){t.stopPropagation();var n=this;if(!this.manageable&&e(t.currentTarget).parents("tr").find("a[data-profile]").attr("data-id")!=GO.session("id"))return!1;e.goConfirm(g.notice_delete_title,"",function(){var r=[GO.contextRoot+"api/board",n.boardId,"post",e(t.currentTarget).parents("tr").attr("data-id"),"notice"];GO.util.preloader(e.ajax({url:r.join("/"),data:JSON.stringify({stickable:!1}),type:"PUT",contentType:"application/json",success:function(){n._renderList()}}))})},_renderList:function(){var t=this;e.when(t.posts.fetch(),t.notices.fetch()).done(function(){t._renderNotice()})},_renderNotice:function(){var e=this,t=[];e.noticeTotal=this.notices.total||0,e.noticeTotal&&(e.$el.find(".tool_bar").show(),e.gridView.$el.find("tbody p.data_null").length&&e.gridView.$el.find("tbody p.data_null").parents("tr").remove()),this.notices.each(function(n){if(n.get("hiddenPost"))return!0;var r=n.get("writer"),i=v({dataset:n,readPostClass:n.get("readPost")?"":"read_no",writer:r,root:n.get("root"),createdAt:GO.util.boardDate(n.get("createdAt")),readCount:n.get("readCount"),lang:g,isManageable:e.manageable||r.id==GO.session("id"),hasValidCheckBox:e.manageable&&e.status!="CLOSED",postTitle:function(){return e._renderPostTitle(n.toJSON())},recommendCount:function(){var e=n.get("recommendCount");return e>0?e:0}});t.push(i)}),e.gridView.$el.find("noti").remove(),this.notices.length&&e.gridView.$el.find("tbody").prepend(t.join(""))},_renderCustomButtons:function(){var e=d({writable:this.writable,writeUrl:this.writeUrl,anonymFlag:this.anonymFlag,lang:g,manageable:this.manageable&&this.status!="CLOSED"});this.$el.find(".tool_bar .critical").html(e)},_getCheckecNoticeIds:function(){var t=this.gridView.$el.find("input[type=checkbox][data-notice]:checked"),n=e(t).map(function(t,n){return parseInt(e(n).val(),10)}).get();return n},actionCheckedDelete:function(){var t=this,n=this.gridView.getCheckedIds();n.length?e.goCaution(g.post_delete_title,g.post_delete_desc,function(){var r=[GO.contextRoot+"api/board",t.boardId,"post"];e.go(r.join("/"),JSON.stringify({ids:n}),{qryType:"DELETE",contentType:"application/json",responseFn:function(){t._renderList(),t.$el.trigger("boardInfo:change",[!1]),GO.EventEmitter.trigger("boardTree","changed:nodes")}})}):e.goMessage(r["\uc120\ud0dd\ub41c \uac8c\uc2dc\ubb3c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"])},actionCheckedCopy:function(){var t=this,n=null,i=!1,o=!1,u=this._getCheckedData(),a=[],f=function(n){var r=!0,i=[],s=n.find("#boardCopyTable tr");e.each(s,function(t,n){var s={},o=e(n).find(".select_board option:selected"),u=e(n).find(".copy_header_list option:selected");if(!o.val())return e.goError(g.post_copy_desc),r=!1,!1;if(o.attr("data-headerFlag")=="true"&&o.attr("data-headerRequiredflag")=="true"&&u.val()==0)return e.goError(g.post_move_header_desc),r=!1,!1;var a=e.grep(i,function(e){return e.id==o.val()});if(a.length)return e.goSlideMessage(g.post_copy_same_board_alert,"caution"),r=!1,!1;s.id=o.val(),s.headerId=u.length?u.val():"",i.push(s)});if(!r)return;e.goPopup.close(),GO.EventEmitter.trigger("common","layout:setOverlay",!0);var o=[GO.contextRoot+"api/board",t.boardId,"post/copy"];e.ajax({type:"POST",async:!0,data:JSON.stringify({postIds:a,boards:i}),dataType:"json",contentType:"application/json",url:o.join("/")}).done(function(n){e.goSlideMessage(g.post_copy_success),GO.EventEmitter.trigger("board","changed:deptBoard",!0),t.$el.trigger("boardInfo:change",[!1]),t._renderList(),GO.EventEmitter.trigger("common","layout:clearOverlay",!0)}).fail(function(t){e.goSlideMessage(g.copy_fail,"caution"),GO.EventEmitter.trigger("common","layout:clearOverlay",!0)})},l=!1;e.each(u,function(e,n){n.orphanFlag&&!l?(i=!0,t.$el.find('input[name="id"][value="'+n.id+'"]').removeAttr("checked")):n.id==n.root?(l=!0,a.push(n.id),n.repliesCount&&(o=!0,t.$el.find('input[name="id"][data-root="'+n.id+'"]').attr("checked","checked"))):o=!0}),a=_.union(a,this._getCheckecNoticeIds());if(a.length){var c=[g.post_copy_desc],h=[];h.push('<span class="desc">'),h.push("<br>"+r["\uc5f4\ub78c\uad8c\ud55c \ubcf5\uc0ac \ubb38\uad6c"]),o&&h.push("<br>"+g.post_copy_reply_desc),i&&h.push("<br>"+g.post_copy_orphan_desc),h.push("</span>"),h.push('<br><br><div id="deptList"></div>'),n=e.goPopup({pclass:"layer_normal layer_absence",width:700,header:g.post_copy_title,title:c,modal:!0,contents:h.join(""),buttons:[{btype:"confirm",btext:g.copy,autoclose:!1,callback:f}]}),s.render({id:".go_popup #deptList",boardList:!0,deptId:this.owner.ownerId,boardId:this.boardId,isCommunity:this.isCommunity,boardType:"classic",postId:"",isCopy:!0}),this.attachHeaderSelectCopy(e("#boardCopyTable select.select_board")),n.reoffset()}else i?e.goAlert(g.post_copy_title,g.post_copy_orphan_desc):o?e.goAlert(g.post_copy_title,g.post_copy_reply_only):e.goMessage(r["\uc120\ud0dd\ub41c \uac8c\uc2dc\ubb3c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"]);var p=e("#boardCopyTable select.select_board");p.die("change"),p.live("change",function(e){t.changeBoardListCopy(e)})},_getCheckedData:function(){var e=this.gridView.getCheckedIds();return _.map(e,function(e){var t=this.posts.get(e);return t||(t=this.notices.get(e)),t.toJSON()},this)},actionCheckedMove:function(){var t=this,n=null,o=!1,u=!1,a=this._getCheckedData(),f=[],l=function(n){var r=n.find("#select_board"),s=r.find("option:selected"),o=r.val(),u=[GO.contextRoot+"api/board",t.boardId,"post/move",o],a=n.find("#move_header_list"),l=a.val();l!="0"&&u.push(l);if(s.attr("data-headerFlag")=="true"&&s.attr("data-headerRequiredflag")=="true"&&l==0)return e.goError(g.post_move_header_desc),!1;if(!o)return e.goError(g.post_move_desc),!1;e.goPopup.close(),GO.EventEmitter.trigger("common","layout:setOverlay",!0),e.go(u.join("/"),JSON.stringify({ids:f}),{qryType:"PUT",contentType:"application/json",responseFn:function(){e.goMessage(g.post_move_success),GO.EventEmitter.trigger("board","changed:deptBoard",!0),t.$el.trigger("boardInfo:change",[!1]),t._renderList(),GO.EventEmitter.trigger("common","layout:clearOverlay",!0)},error:function(t){try{var n=JSON.parse(t.responseText);e.goAlert(n.message)}catch(r){e.goAlert(i["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."])}}})},c=!1;e.each(a,function(e,n){n.orphanFlag&&!c?(o=!0,t.$el.find('input[name="id"][value="'+n.id+'"]').removeAttr("checked")):n.id==n.root?(c=!0,f.push(n.id),n.repliesCount&&(u=!0,t.$el.find('input[name="id"][data-root="'+n.id+'"]').attr("checked","checked"))):u=!0}),f=_.union(f,this._getCheckecNoticeIds());if(f.length){var h=[g.post_move_desc],p=[];o&&p.push("<br />\u203b "+g.post_move_orphan_desc),u&&p.push("<br />\u203b "+g.post_move_reply_desc),n=e.goPopup({pclass:"layer_normal layer_item_move",width:330,header:g.post_move_title,title:h,modal:!0,contents:p.join("")+'<br /><br /><div id="deptList"></div>',buttons:[{btype:"confirm",btext:g.move,autoclose:!1,callback:l}]}),s.render({id:".go_popup #deptList",boardList:!0,deptId:this.owner.ownerId,boardId:this.boardId,isCommunity:this.isCommunity,boardType:"classic",postId:"",isMove:!0}),this.attachHeaderSelect(this.boardId),n.reoffset()}else o?e.goAlert(g.post_move_title,g.post_move_orphan_desc):u?e.goAlert(g.post_move_title,g.post_move_reply_only):e.goMessage(r["\uc120\ud0dd\ub41c \uac8c\uc2dc\ubb3c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"]);var d=e("#deptList select#select_board");d.die(),d.live("change",function(){t.changeBoardList()})},actionCheckedSticky:function(){var t=this,n=this.gridView.getCheckedIds();n.length?(this.noticePopup=e.goPopup({header:g.post_sticky_term,width:"350px",pclass:"layer_normal layer_date_set",contents:"",modal:!0,buttons:[{btext:g.post_sticky,btype:"confirm",callback:function(){var r=t.getStickyDate()||{};r.stickable=!0;var i=[];e.each(n,function(n,s){var o=e.Deferred();e.go([GO.contextRoot+"api/board",t.boardId,"post",s,"notice"].join("/"),JSON.stringify(r),{qryType:"PUT",contentType:"application/json",responseFn:function(){o.resolve()}}),i.push(o)}),e.when.apply(null,i).done(function(){t._renderList()})}}],closePopup:function(){t.noticePopup=null}}),u.render()):e.goMessage(r["\uc120\ud0dd\ub41c \uac8c\uc2dc\ubb3c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"])},getStickyDate:function(){if(this.noticePopup==null)return!1;var e=this.noticePopup.find("input[name=noticeTerm]:radio:checked"),t=e.attr("data-key"),n=e.attr("data-amount"),r,i,s;if(this.noticePopup.find("#noticeStartDate").val()!=""&&this.noticePopup.find("#noticeEndDate").val()!=""){r=this.noticePopup.find("#noticeStartDate").val(),i=this.noticePopup.find("#noticeEndDate").val();var o=/^(19|20)\d{2}\-(0[1-9]|1[012])\-(0[1-9]|[12][0-9]|3[0-1])$/;if(!o.test(r)||!o.test(i))throw new Error("invalid date format");r=GO.util.toISO8601(r),i=GO.util.toISO8601(i),i=GO.util.searchEndDate(i)}else s=n+t;return{fromDate:r,toDate:i,dateType:s}},changeBoardList:function(){var t=e("#select_board option:selected");this.attachHeaderSelect(t.val(),t.attr("data-headerflag"))},changeBoardListCopy:function(t){var n=e(t.currentTarget);this.attachHeaderSelectCopy(n)},attachHeaderSelectCopy:function(t){if(t.val()){var n=[];t.find("option:selected").attr("data-headerflag")=="true"&&(n=a.getHeaderList({boardId:t.val()}).toJSON());if(n.length){var r=c({dataset:n,defaultSelect:g.header_default,selectClass:"wfix_medi copy_header_list"});e("#headerSelectPart").show(),t.parents("tr").first().find(".board_header_wrap").html(r)}else e("#headerSelectPart").hide(),t.parents("tr").first().find(".board_header_wrap").html("")}else e("#headerSelectPart").hide()},attachHeaderSelect:function(t,n){var r=[];n=="true"&&(r=a.getHeaderList({boardId:t}).toJSON());if(r.length){var i=c({dataset:r,defaultSelect:g.header_default,selectId:"move_header_list"});e("#header_dt").show(),e(".go_popup #deptList #board_header_wrap").html(i)}else e("#header_dt").hide(),e(".go_popup #deptList #board_header_wrap").html("")},_serializeObj:function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},isCurrentLayer:function(t){return e(t.currentTarget).hasClass("on")},postPopupTabs:function(t){var n=this;t.on("click","ul.tab_nav2 li",function(t){e(t.currentTarget).hasClass("first")?n.showPostReader(t):n.showPostRecommend(t)})},showPostRecommend:function(t){t.stopPropagation();if(this.isCurrentLayer(t))return;var n=e(t.currentTarget).attr("data-id"),i=['<ul class="tab_nav tab_nav2"><li class="first" data-id="'+n+'"><span>',g.read_count,'</span></li><li class="last on" data-id="'+n+'"><span>',g.reomment_list_tab,"</span></li></ul>"],s=e.goPopup({pclass:"layer_normal layer_reader",headerHtml:i.join(""),contents:p(),buttons:[{btype:"confirm",btext:g.ok}]});this.postPopupTabs(s),e.goGrid({el:"#recommendList",url:GO.contextRoot+"api/board/"+this.boardId+"/post/"+n+"/recommend",displayLength:10,displayLengthSelect:!1,emptyMessage:r["\uc88b\uc544\uc694 \ubaa9\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],method:"GET",defaultSorting:[],sDom:'rt<"tool_bar"<"critical custom_bottom">p>',bProcessing:!1,columns:[{mData:null,sWidth:"150px",bSortable:!1,sClass:"align_l",fnRender:function(e){var t=e.aData,n=[t.recommender.name," ",t.recommender.positionName].join("");return t.recommender.otherCompanyUser&&(n='<span class="multi_user">'+n+"</span>"),returnArr=[n,'&nbsp;<span class="date">',GO.util.basicDate(t.updatedAt),"</span>"],returnArr.join("")}}],fnDrawCallback:function(t,n,r){var i=s.find(".tool_bar");n._iRecordsTotal<n._iDisplayLength?(e(this.el).find("tr:last-child>td").css("border-bottom",0),i.hide()):(i.show(),i.find("div.dataTables_paginate").css("margin-top",0)),s.find(".dataTables_wrapper").css("margin-bottom",0),s.reoffset()}})},showPostReader:function(t){t.stopPropagation();if(this.isCurrentLayer(t))return;var n=e(t.currentTarget).attr("data-id"),i=null,s=['<ul class="tab_nav tab_nav2"><li class="first on"  data-id="'+n+'"><span>',g.read_count,'</span></li><li class="last" data-id="'+n+'"><span>',g.reomment_list_tab,"</span></li></ul>"];i=e.goPopup({pclass:"layer_normal layer_reader",headerHtml:s.join(""),contents:h(),buttons:[{btype:"confirm",btext:g.ok}]}),this.postPopupTabs(i),e.goGrid({el:"#readerList",url:GO.contextRoot+"api/board/"+this.boardId+"/post/"+n+"/reader",displayLength:10,displayLengthSelect:!1,emptyMessage:r["\uc870\ud68c\ud55c \ubaa9\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],method:"GET",defaultSorting:[],sDom:'rt<"tool_bar"<"critical custom_bottom">p>',bProcessing:!1,columns:[{mData:null,bSortable:!1,sClass:"align_l",fnRender:function(e){var t=e.aData,n=[t.reader.name," ",t.reader.positionName].join("");return t.reader.otherCompanyUser&&(n='<span class="multi_user">'+n+"</span>"),returnArr=[n,'&nbsp;<span class="date">',GO.util.basicDate(t.updatedAt),"</span>"],returnArr.join("")}},{mData:null,sWidth:"80px",sClass:"align_l",bSortable:!1,fnRender:function(e){var t=e.aData;return['<span class="plus_num">',g.read_count,t.point,"</span>&nbsp;"].join("")}}],fnDrawCallback:function(t,n,r){var s=i.find(".tool_bar");n._iRecordsTotal<n._iDisplayLength?(e(this.el).find("tr:last-child>td").css("border-bottom",0),s.hide()):(s.show(),s.find("div.dataTables_paginate").css("margin-top",0)),i.find(".dataTables_wrapper").css("margin-bottom",0),i.reoffset()}})}});return y})}).call(this);