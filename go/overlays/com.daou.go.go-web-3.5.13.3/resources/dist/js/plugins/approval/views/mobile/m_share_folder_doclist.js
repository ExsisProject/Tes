(function(){define(["jquery","backbone","hogan","app","approval/models/doclist_item","collections/paginated_collection","approval/views/mobile/m_pagination","approval/views/mobile/m_doclist_item","views/mobile/header_toolbar","hgn!approval/templates/mobile/m_doclist_empty","hgn!approval/templates/mobile/m_doclist_item","i18n!nls/commons","i18n!approval/nls/approval","jquery.go-validation","GO.util"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p={approval:h["\uc804\uc790\uacb0\uc7ac"],move_to_home:c["\ud648\uc73c\ub85c \uc774\ub3d9"]},d=s.extend({model:i,types:["userfolder","deptfolder"],initialize:function(e){s.prototype.initialize.call(this),this.options=e||{},this.type=e.type,this.folderId=e.folderId,this.belong=e.belong,this.deptId=e.deptId},url:function(){var t=e.param({page:this.pageNo}),n="/api/approval/userfolder/"+this.folderId+"/share/"+this.belong;return this.type=="userfolder"?this.belong=="indept"?n="/api/approval/userfolder/"+this.folderId+"/share/"+this.belong+"/"+this.deptId:n="/api/approval/userfolder/"+this.folderId+"/share/"+this.belong:this.type=="deptfolder"&&(n="/api/approval/deptfolder/"+this.folderId+"/share/"+this.belong+"/"+this.deptId),n+"?"+t},setFolderId:function(e){this.folderId=e},setListParam:function(){this.pageNo=sessionStorage.getItem("list-history-pageNo")}}),v=t.View.extend({el:"#content",types:["userfolder","deptfolder"],typesWithNoState:["userfolder","deptfolder"],initialize:function(e){r.util.appLoading(!0),this.options=e||{},this.type=this.options.type;if(!_.contains(this.types,this.type))throw new Error("\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ud0c0\uc785\uc785\ub2c8\ub2e4.");this.folderId=this.options.folderId,this.belong=this.options.belong,this.options.belong&&(this.options.belong.indexOf("?")>=0?this.belong=this.options.belong.substr(0,this.options.belong.indexOf("?")):this.belong=this.options.belong),this.options.deptId&&(this.options.deptId.indexOf("?")>=0?this.deptId=this.options.deptId.substr(0,this.options.deptId.indexOf("?")):this.deptId=this.options.deptId),_.bindAll(this,"render","renderPages"),this.collection=new d({type:this.type,folderId:this.folderId,belong:this.belong,deptId:this.deptId}),this.headerToolbarView=a;var t=sessionStorage.getItem("list-history-baseUrl"),n="/api/approval/userfolder/"+this.folderId+"/share/"+this.belong;this.type=="userfolder"?this.belong=="indept"?n="/api/approval/userfolder/"+this.folderId+"/share/"+this.belong+"/"+this.deptId:n="/api/approval/userfolder/"+this.folderId+"/share/"+this.belong:this.type=="deptfolder"&&(n="/api/approval/deptfolder/"+this.folderId+"/share/"+this.belong+"/"+this.deptId),t&&t==n&&this.collection.setListParam(),sessionStorage.clear(),this.collection.bind("reset",this.resetList,this),this.collection.fetch()},renderPages:function(){this.pageView=new o({pageInfo:this.collection.pageInfo()}),this.pageView.bind("paging",this.selectPage,this),this.$el.find("div.paging br_no").remove(),this.$el.find("ul.list_box").append(this.pageView.render().el)},render:function(){this.$el.html(l),r.util.appLoading(!1)},selectPage:function(e){this.collection.setPageNo(e),this.collection.fetch()},resetList:function(e){var t=this,n=this.collection.url().replace("/api/",""),i=r.router.getUrl();i.indexOf("?")<0?r.router.navigate(n,{replace:!0}):i!=n&&r.router.navigate(n,{trigger:!1,pushState:!0}),this.toolBarData={title:this.collection.extData.folderName,isList:!0,isSideMenu:!0,isHome:!0,isSearch:!0},this.headerToolbarView.render(this.toolBarData),this.$el.find("ul.list_box").empty();var s="approval";e.each(function(e){var n=new u({model:e,listType:s});t.$el.find("ul.list_box").append(n.render().el)}),e.length==0&&this.$el.find("ul.list_box").append(f({lang:{doclist_empty:h["\ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."]}})),_.contains(this.typesWithNoState,this.type)&&this.hideListState(),!e.length==0&&this.renderPages()},hideListState:function(){this.$el.find("span.state").hide()}},{__instance__:null,create:function(){return this.__instance__=new this.prototype.constructor({el:e("#content")}),this.__instance__},render:function(){var e=this.create(),t=arguments.length>0?Array.prototype.slice.call(arguments):[];return this.prototype.render.apply(e,t)}});return v})}).call(this);