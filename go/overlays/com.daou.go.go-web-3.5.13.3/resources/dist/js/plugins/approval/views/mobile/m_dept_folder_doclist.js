(function(){define(["views/mobile/m_more_list","jquery","backbone","hogan","app","i18n!nls/commons","i18n!approval/nls/approval","approval/views/mobile/m_pagination","approval/views/mobile/m_doclist_item","approval/models/doclist_item","collections/paginated_collection","views/mobile/header_toolbar","approval/views/mobile/document/m_appr_form_select","hgn!approval/templates/mobile/m_doclist_empty","hgn!approval/templates/mobile/m_doclist_item","jquery.go-validation","GO.util"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v={approval:o["\uc804\uc790\uacb0\uc7ac"],"\ubd80\uc11c \ucc38\uc870\ud568":o["\ubd80\uc11c \ucc38\uc870\ud568"],move_to_home:s["\ud648\uc73c\ub85c \uc774\ub3d9"],"\uc0c8\uacb0\uc7ac":o["\uc0c8\uacb0\uc7ac"],"\uc591\uc2dd\uc120\ud0dd":o["\uacb0\uc7ac\uc591\uc2dd \uc120\ud0dd"]},m=l.extend({model:f,types:["deptdraft","deptreference","deptofficial","deptdoc"],initialize:function(e,t,n){l.prototype.initialize.call(this),this.type=e,this.deptId=t,this.folderId=n;if(!_.contains(this.types,this.type))throw new Error("\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ud0c0\uc785\uc785\ub2c8\ub2e4.")},url:function(){var e;switch(this.type){case"deptdraft":e="/api/approval/deptfolder/draft/"+this.deptId+"?";break;case"deptreference":e="/api/approval/deptfolder/reference/"+this.deptId+"?";break;case"deptofficial":e="/api/approval/deptfolder/official/"+this.deptId+"?";break;default:e="/api/approval/deptfolder/"+this.folderId+"/documents?"}return e},setFolderId:function(e){this.folderId=e}}),g=e.extend({el:"#content",types:["deptdraft","deptreference","deptofficial","deptdoc"],typesWithNoState:["deptdraft","deptdoc"],initialize:function(e){i.util.appLoading(!0),this.options=e||{},this.type=this.options.type;if(!_.contains(this.types,this.type))throw new Error("\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ud0c0\uc785\uc785\ub2c8\ub2e4.");this.folderId=this.options.folderId,this.deptId=this.options.deptId,_.bindAll(this,"render","renderPages"),this.collection=new m(this.type,this.deptId,this.folderId),this.collection.setFolderId(this.folderId);var n=this.collection.url().replace("/api/",""),r=i.router.getUrl();r.indexOf("?")<0?i.router.navigate(n,{replace:!0}):r!=n&&i.router.navigate(n,{trigger:!1,pushState:!0});var s={listFunc:t.proxy(function(e){this.renderList(e)},this),emptyListFunc:t.proxy(function(){this.$el.find("ul.list_box").append(p({lang:{doclist_empty:o["\ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."]}}))},this)};this.setRenderListFunc(s);var u={};this.setFetchInfo(u,this.collection)},renderPages:function(){this.$el.find("div.paging br_no").remove()},render:function(){var e=this;this.$el.html(d({ulWrapperId:"document_todo",documentAction:!0})),i.util.appLoading(!1),this.headerToolbarView=c;var n=function(){return e.type==="deptdoc"?t('a[data-id="'+e.folderId+'"][data-navi="'+e.type+'"]').text().trim():t('a[data-deptid="'+e.deptId+'"][data-navi="'+e.type+'"]').text().trim()};this.toolBarData={title:n(),isList:!0,isSideMenu:!0,isHome:!0,isSearch:!0,isWriteBtn:!0,writeBtnCallback:function(){var t={title:v["\uc591\uc2dd\uc120\ud0dd"],isClose:!0,closeCallback:function(){e.headerToolbarView.render(e.toolBarData),e.documentAction.release(),e.onScrollEvent(),e.$el.find("#document_action").hide(),e.$el.find("#document_todo").show()}};e.documentAction=new h({toolBarData:t}),e.documentAction.release(),e.offScrollEvent(),e.$el.find("#document_todo").hide(),e.$el.find("#document_action").show(),e.assign(e.documentAction,"#document_action")}},this.headerToolbarView.render(this.toolBarData),this.dataFetch().done(t.proxy(function(e){e.length===0?this.renderListFunc.emptyListFunc():(this.renderListFunc.listFunc(e),this.scrollToEl())},this)),i.util.appLoading(!1),_.contains(this.typesWithNoState,this.type)&&this.hideListState()},hideListState:function(){this.$el.find("span.state").hide()},assign:function(e,t){e.setElement(this.$(t)).render()},renderList:function(e){var t=this,n="approval";e.each(function(e){var r=new a({model:e,listType:n});t.$el.find("ul.list_box").append(r.render().el)})}},{__instance__:null,create:function(){return this.__instance__=new this.prototype.constructor({el:t("#content")}),this.__instance__},render:function(){var e=this.create(),t=arguments.length>0?Array.prototype.slice.call(arguments):[];return this.prototype.render.apply(e,t)}});return g})}).call(this);