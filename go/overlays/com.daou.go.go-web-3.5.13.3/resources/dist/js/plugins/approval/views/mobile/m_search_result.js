(function(){define(function(require){var e=require("jquery"),t=require("backbone"),n=require("app"),r=require("text!approval/templates/mobile/m_search_result.html"),i=require("text!approval/templates/mobile/m_search_result_item.html"),s=require("views/mobile/m_search_common_result"),o=require("i18n!nls/commons"),u=require("i18n!approval/nls/approval");require("GO.util");var a=null,f={"\uac80\uc0c9\uacb0\uacfc\uc5c6\uc74c":o["\uac80\uc0c9\uacb0\uacfc\uc5c6\uc74c"],"\uac80\uc0c9\uacb0\uacfc":o["\uac80\uc0c9\uacb0\uacfc"],"\uc218\uc2e0":u["\uc218\uc2e0"]},l=function(){return GO.util.snsDate(this.draftedAt)},c=function(){return this.docType=="RECEIVE"?!0:!1},h=function(){var e=this.docStatus;if(e=="INPROGRESS")return u["\uc9c4\ud589\uc911"];if(e=="COMPLETE")return u["\uc644\ub8cc"];if(e=="RETURN")return u["\ubc18\ub824"];if(e=="TEMPSAVE")return u["\uc784\uc2dc\uc800\uc7a5"];if(e=="DRAFT_WAITING")return u["\uc784\uc2dc\uc800\uc7a5"];if(e=="RECEIVED")return u["\uc811\uc218"];if(e=="RECV_WAITING")return u["\uc811\uc218\ub300\uae30"];if(e=="RECV_RETURNED")return u["\ubc18\uc1a1"]},p=t.Collection.extend({model:t.Model.extend(),initialize:function(e){this.type=e},url:function(){return"/api/search/"+this.type}}),d=function(){var e=this.docStatus;if(e=="INPROGRESS"||e=="RECEIVED")return"read";if(e=="TEMPSAVE"||e=="DRAFT_WAITING"||e=="RECV_WAITING")return"temp";if(e=="RETURN"||e=="RECV_RETURNED")return"notyet";if(e=="COMPLETE")return"finish"},v=t.View.extend({el:"#searchResultWrap",events:{"vclick a[data-id]":"_getContent"},initialize:function(e){var t=this;this.options=e,this.$el.off(),this.collection=new p(this.options.type),this.lastPage=!1,s.set({collection:this.collection,searchOptions:this.options,renderListFunc:function(e){t._renderContents(e)},renderListMoreFunc:function(e){t._moreList(e)}})},render:function(){return s.fetch(),this.el},_renderContents:function(t){this.$el.html(Hogan.compile(r).render({lang:f,dataset:t.toJSON(),resultCount:t.page.total,parseDraftedAt:l,isReceive:c,getStatusName:h,getStatusClass:d},{partial:i})),e("#detailSearchToggle").removeClass("on"),this._showResultWrap()},_moreList:function(e){this.$el.find("ul:first").append(Hogan.compile(i).render({lang:f,dataset:e.toJSON(),parseDraftedAt:l,isReceive:c,getStatusName:h,getStatusClass:d}))},_showResultWrap:function(){e("#simpleSearchWrap").hide(),e("#detailSearchWrap").hide(),e("#searchResultWrap").show()},_getContent:function(t){t.preventDefault();var r=e(t.currentTarget),i="/"+this.options.type+"/document/"+r.attr("data-id");n.router.navigate(i,!0)}});return{render:function(e){return a=new v(e),a.render()}}})}).call(this);