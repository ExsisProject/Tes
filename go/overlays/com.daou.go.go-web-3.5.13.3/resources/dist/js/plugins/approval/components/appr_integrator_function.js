define(["jquery","backbone","app"],function(e,t,n){var r=t.Model.extend({c_select:null,c_check:null,c_radio:null,c_table:null,initialize:function(e){this.options=e||{},this.variables=this.options.variables,this.config=this.options.config||{},this.infoData=this.options.infoData,this.setComponentData()},setComponentData:function(){this.c_select=this.config.select||[],this.c_check=this.config.check||[],this.c_radio=this.config.radio||[],this.c_table=this.config.table||[]},render:function(){var e=[];this.c_select.length>0&&e.push({type:"cSel"}),this.c_check.length>0&&e.push({type:"check"}),this.c_radio.length>0&&e.push({type:"radio"}),this.c_table.length>0&&e.push({type:"table"}),this.renderComponent(e)},renderComponent:function(e){var t=this;_.each(e,function(e){switch(e.type){case"cSel":t.renderSelect(e);break;case"check":t.renderCheck(e);break;case"radio":t.renderRadio(e);break;case"table":t.renderTable()}},this)},renderSelect:function(t){var n=this;_.each(n.c_select,function(r){var i=[],s=e(r.el);_.each(JSON.parse(n.variables[r.key]),function(e,t){i.push({value:e[r.data_id],text:e[r.data_text]})});var o=n.makeDsl(i.slice(0),t.type);_.each(i,function(t){var n=e('<option value="'+t.text+'" data-id="'+t.value+'">'+t.text+"</option>");s.append(n),e(n).data("attr",t.attr)}),s.attr("data-dsl",o)})},renderCheck:function(t){var n=this;_.each(n.c_check,function(r){var i=[],s=e(r.el),o=s.closest("span"),u=n.getBaseId(s);_.each(JSON.parse(n.variables[r.key]),function(e,t){i.push({value:e[r.data_id],text:e[r.data_text],id:u+"_"+r.data_id})});var a=n.makeDsl(i.slice(0),t.type);_.each(i,function(t){e("<input>").attr({"data-dsl":a,id:t.text,name:s.attr("id"),"data-require":!1,type:"checkbox","class":"editor_opt","data-label":t.text}).val(t.value).appendTo(o),e("<label>").attr({"class":"editor_label","data-type":"removeSpan"}).text(t.text).appendTo(o)}),s.remove()})},renderRadio:function(t){var n=this;_.each(n.c_radio,function(r){var i=[],s=e(r.el),o=s.closest("span"),u=n.getBaseId(s);_.each(JSON.parse(n.variables[r.key]),function(e,t){i.push({value:e[r.data_id],id:u+"_"+e[r.data_id],text:e[r.data_text]})});var a=n.makeDsl(i.slice(0),t.type);_.each(i,function(t,n){e("<input>").attr({"data-dsl":a,name:s.attr("name"),id:t.id,"data-require":!1,checked:n==0?!0:!1,type:"radio","class":"editor_opt","data-label":t.text}).val(t.value).appendTo(o),e("<label>").attr({"class":"editor_label","data-type":"removeSpan"}).text(t.text).appendTo(o)}),s.remove()})},renderTable:function(){var t=this;_.each(this.c_table,function(n){var r=[],i=e(n.el),s=i.find("tr").eq(0).clone(),o=i.find("tr").eq(1).length>0?i.find("tr").eq(1).clone():i.find("tr").eq(0).clone(),u=e(s).find("td").length;i.data("thTpl",s),i.data("tdTpl",o),i.find("tbody").empty(),_.each(JSON.parse(t.variables[n.key]),function(t,r){var a;a=r<=u-1?s.clone():o.clone(),_.each(_.range(u),function(r){e(a).find("td").eq(r).text(t[n.data_colums[r]]),e(a).appendTo(i)})})})},renderTableByData:function(t,n){var r=this,i=[],s=e(n.el),o=s.data("thTpl"),u=s.data("tdTpl"),a=e(o).find("td").length;s.find("tbody").empty(),_.each(t,function(t,r){var i;i=r<=a-1?o.clone():u.clone(),_.each(_.range(a),function(r){e(i).find("td").eq(r).text(t[n.data_colums[r]]),e(i).appendTo(s)})})},getBaseId:function(e){var t;return e.attr("name")&&e.attr("name").split("_").length>2?t=e.attr("name").split("_")[0]+"_"+e.attr("name").split("_")[1]:t="",t},makeDsl:function(e,t){var n="{{"+t;return _.each(e,function(e){t=="cSel"?n+="_"+e.text:t=="check"?n+="_"+e.value:n+="_"+e.value}),n+="}}",n}});return r});