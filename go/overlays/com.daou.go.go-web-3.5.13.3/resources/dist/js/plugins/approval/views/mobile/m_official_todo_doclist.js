(function(){define(["views/mobile/m_more_list","jquery","backbone","when","hogan","app","when","approval/models/doclist_item","collections/paginated_collection","approval/views/mobile/m_pagination","approval/views/mobile/m_doclist_item","views/mobile/header_toolbar","hgn!approval/templates/mobile/m_doclist_empty","hgn!approval/templates/mobile/m_doclist_item","i18n!nls/commons","i18n!approval/nls/approval","jquery.go-validation","GO.util"],function(e,t,n,r,i,s,r,o,u,a,f,l,c,h,p,d){var v=n.Model.extend({url:"/api/approval/apprconfig"}),m={approval:d["\uc804\uc790\uacb0\uc7ac"],"\uacf5\ubb38 \ub300\uae30 \ubb38\uc11c":d["\uacf5\ubb38 \ub300\uae30 \ubb38\uc11c"],move_to_home:p["\ud648\uc73c\ub85c \uc774\ub3d9"]},g=u.extend({initialize:function(e){u.prototype.initialize.call(this,e),_.extend(this.options,e||{})},model:o,url:function(){return"/api/approval/officialtodo"}}),y=e.extend({el:"#content",initialize:function(e){s.util.appLoading(!0),this.options=e||{},_.bindAll(this,"render","renderPages"),this.collection=new g;var n=this.collection.url().replace("/api/",""),r=s.router.getUrl();r.indexOf("?")<0?s.router.navigate(n,{replace:!0}):r!=n&&s.router.navigate(n,{trigger:!1,pushState:!0}),this.headerToolbarView=l,this.toolBarData={title:m["\uacf5\ubb38 \ub300\uae30 \ubb38\uc11c"],isList:!0,isSideMenu:!0,isHome:!0,isSearch:!0};var i={listFunc:t.proxy(function(e){this.renderList(e)},this),emptyListFunc:t.proxy(function(){this.$el.find("ul.list_box").append(c({lang:{doclist_empty:d["\ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."]}}))},this)};this.setRenderListFunc(i);var o={};this.setFetchInfo(o,this.collection)},renderPages:function(){this.$el.find("div.paging br_no").remove()},render:function(){r(this.fetchConfig.call(this)).then(_.bind(function(){this.$el.html(h),this.headerToolbarView.render(this.toolBarData),this.dataFetch().done(t.proxy(function(e){e.length===0?this.renderListFunc.emptyListFunc():(this.renderListFunc.listFunc(e),this.scrollToEl())},this)),s.util.appLoading(!1)},this)).then(_.bind(this.fetchCollection,this)).otherwise(function(t){console.log(t.stack)}),setTimeout(function(){s.util.pageDone()},500)},fetchConfig:function(){var e=this,t=r.defer();return this.configModel=new v,this.useOfficialConfirm=!0,this.configModel.fetch({success:function(n){e.useOfficialConfirm=n.get("useOfficialConfirm"),t.resolve()},error:t.reject}),t.promise},fetchCollection:function(){var e=r.defer();return this.collection.fetch({success:function(){e.resolve()},error:e.reject}),e.promise},renderList:function(e){var t=this,n="officialDoc",r=this.useOfficialConfirm;e.each(function(e){var i=new f({model:e,listType:n,useDocStatus:!1,useOfficialConfirm:r});t.$el.find("ul.list_box").append(i.render().el)})},scrollToEl:function(){if(_.isNull(this.properties))return!1;var e=JSON.parse(this.properties),n=t("a[data-docid="+e.docid+"]"),r=n.offset().top,i=n.height(),s=t(window).height(),o;i<s?o=r-(s/2-i/2):o=r,t("html").animate({scrollTop:o})},appendRenderAboveList:function(){var e=this,t=this.collection.pageInfo();if(!t.next)return;var n=t.pageNo+1;return this.collection.fetch({async:!1,data:{page:n,offset:this.offset},success:function(t){e.renderList(t)}}),!1}},{__instance__:null,create:function(){return this.__instance__=new this.prototype.constructor({el:t("#content")}),this.__instance__},render:function(){var e=this.create(),t=arguments.length>0?Array.prototype.slice.call(arguments):[];return this.prototype.render.apply(e,t)}});return y})}).call(this);