define(["jquery","backbone","app","hgn!approval/templates/mobile/m_reference_doclist_item","i18n!nls/commons","i18n!approval/nls/approval","approval/models/ref_document","approval/views/mobile/document/m_preview"],function(e,t,n,r,i,s,o,u){return t.View.extend({initialize:function(e){this.options=e||{},this.total=this.options.total,this.listType=this.options.listType,this.isCheckboxVisible=_.isBoolean(this.options.isCheckboxVisible)?this.options.isCheckboxVisible:!1,_.bindAll(this,"render")},tagName:"li",events:{"vclick .tit":"refDocPreview"},render:function(){this.model.setListType(this.listType);var e={id:this.model.getDocumentId(),isReceive:this.model.isReceive(),draftedAt:this.model.getDraftedAt(),receivedAt:this.model.getReceivedAt(),formName:this.model.get("formName"),title:this.model.get("title"),drafterId:this.model.get("drafterId"),drafterName:this.model.get("drafterName"),docStatus:this.model.getDocStatusName(),isNew:this.model.get("isNew"),receiveStatusClass:this.model.getReceiveStatusClass(),receiveStatusName:this.model.getReceiveStatusName(),docTypeName:this.model.getDocType(),statusClass:this.model.getDocStatusClass(),drafterPositionName:this.model.get("drafterPositionName"),receiverUserName:this.model.getReceiverNameWithPosition(),receiverUserPositionName:this.model.get("receiverUserPositionName"),deptFolderName:this.model.get("deptFolderName"),userFolderName:this.model.get("userFolderName"),completedAt:this.model.getCompletedAt(),docNum:this.model.get("docNum"),isEmergency:this.model.get("isEmergency"),showUrl:this.model.getShowUrl(),holdStatusName:this.model.getHoldStatusName(),holdStatusClass:this.model.getHoldStatusClass(),officialStateName:this.model.getOfficialStateName(),officialStateClass:this.model.getOfficialStateClass(),commentCount:this.model.get("commentCount"),replyCount:this.model.get("replyCount"),attachCount:this.model.get("attachCount"),hasAdditionalInfo:this.model.get("attachCount")||this.model.get("commentCount")||this.model.get("replyCount")};return this.$el.html(r({doc:e,deptId:this.deptId,lang:s,isCheckboxVisible:this.isCheckboxVisible})),this.$el.find("span.subject span").addClass(e.isNew?"read_no":""),this},refDocPreview:function(t){t.preventDefault(),t.stopPropagation();var n=o.create(this.model.getDocumentId());n.fetch({async:!1,success:e.proxy(function(t){var n=t.get("document").docBodyContent,r=t.get("document").attaches,s=t.get("document").references;this.preView=new u({title:i["\ubbf8\ub9ac\ubcf4\uae30"],docId:this.docId,docBody:n,attaches:r,references:s,callback:function(e){return this.$el.remove(),e&&e.stopPropagation(),!1}}),this.preView.render(),e("html").scrollTop(0)},this),error:function(e,t,n){alert(t.responseJSON.message)}})}})});