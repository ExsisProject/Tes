(function(){define(["jquery","backbone","app","approval/models/comment_reply","hgn!approval/templates/mobile/document/m_comment_reply","hgn!approval/templates/mobile/document/m_comment_unit","i18n!board/nls/board","i18n!nls/commons"],function(e,t,n,r,i,s,o,u){var a=null,f=t.View.extend({initialize:function(e){this.options=e||{};var t=this;this.el=this.options.el,this.docId=this.options.docId,this.commentId=this.options.commentId,this.thread=this.options.thread,this.collection=this.options.collection,this.model=r.get({docId:this.docId,commentId:this.commentId,thread:this.thread})},unbindEvent:function(){this.$el.off("vclick",".comment_reply_save"),this.$el.off("vclick",".comment_reply_cancel"),this.$el.off("keyup","div.ipt_wrap textarea")},bindEvent:function(){this.$el.on("vclick",".comment_reply_save",e.proxy(this.saveReply,this)),this.$el.on("vclick",".comment_reply_cancel",e.proxy(this.cancelReply,this)),this.$el.on("keyup","div.ipt_wrap textarea",e.proxy(this.expandTextarea,this))},expandTextarea:function(e){GO.util.textAreaExpand(e)},render:function(){var e=GO.session();this.$el.html(i({writer:e,comment_save:o["\ub313\uae00 \uc791\uc131"],comment_cancel:u["\ucde8\uc18c"],comment_placeholder:o["\ub313\uae00\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."]})).find("textarea").focus(),this.unbindEvent(),this.bindEvent()},saveReply:function(){var t=this,n=this.$el.find("textarea");n.val()?(this.$el.hide(),this.model.save({message:n.val()},{success:function(n,r){var i=null;t.collection.fetch({data:{offset:"1000"},async:!1,reset:!0}),i=e('li[data-id="'+n.id+'"]'),i.length&&i.fadeOut(100,function(){i.fadeIn(500)})}})):n.focus()},cancelReply:function(e){return this.$el.remove(),e.preventDefault(),!1}});return{render:function(e){return a=new f(e),a.render()},close:function(e){return a.cancelReply()}}})}).call(this);