define(["jquery","underscore","backbone","app","approval/views/content_top","views/pagination","views/pagesize","approval/views/doclist/base_doclist","approval/views/doclist/doclist_item","approval/views/doclist/doclist_csv_download","approval/views/doclist/user_doc_folder","approval/collections/send_doclist","approval/models/doclist_item","hgn!approval/templates/send_doclist","hgn!approval/templates/doclist_empty","i18n!nls/commons","i18n!approval/nls/approval"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={"\uc81c\ubaa9":v["\uc81c\ubaa9"],"\uae30\uc548\uc790":m["\uae30\uc548\uc790"],"\ub2f4\ub2f9\uc790":m["\ub2f4\ub2f9\uc790"],"\uacb0\uc7ac\uc591\uc2dd":m["\uacb0\uc7ac\uc591\uc2dd"],"\uacb0\uc7ac\uc120":m["\uacb0\uc7ac\uc120"],"\ubb38\uc11c\ubc88\ud638":m["\ubb38\uc11c\ubc88\ud638"],"\uac80\uc0c9":v["\uac80\uc0c9"],"\uc804\uccb4":m["\uc804\uccb4"],"\uc811\uc218\ub300\uae30":m["\uc811\uc218\ub300\uae30"],"\uc811\uc218":m["\uc811\uc218"],"\uc9c4\ud589":m["\uc9c4\ud589"],"\uc644\ub8cc":m["\uc644\ub8cc"],"\ubc18\ub824":m["\ubc18\ub824"],"\ubc18\uc1a1":m["\ubc18\uc1a1"],"\uac1c\uc778 \ubb38\uc11c\ud568 \ubd84\ub958":m["\uac1c\uc778 \ubb38\uc11c\ud568 \ubd84\ub958"],"\uac1c\uc778 \ubb38\uc11c\ud568\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":m["\uac1c\uc778 \ubb38\uc11c\ud568\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"]},y=u.extend({columns:{"\uc811\uc218\uc77c":m["\uc811\uc218\uc77c"],"\uacb0\uc7ac\uc591\uc2dd":m["\uacb0\uc7ac\uc591\uc2dd"],"\uae34\uae09":m["\uae34\uae09"],"\uc81c\ubaa9":v["\uc81c\ubaa9"],"\ub2f4\ub2f9\uc790":m["\ub2f4\ub2f9\uc790"],"\ucca8\ubd80":m["\ucca8\ubd80"],"\ubc1c\uc1a1\uc77c":m["\ubc1c\uc1a1\uc77c"],"\uacb0\uc7ac\uc0c1\ud0dc":m["\uacb0\uc7ac\uc0c1\ud0dc"],count:8},el:"#content",docFolderType:"user_send",usePeriod:!0,events:{"click .tab_nav > li":"selectTab","click .sorting":"sort","click .sorting_desc":"sort","click .sorting_asc":"sort","click .btn_search2":"search","keypress input#keyword":"searchByEnter","click #userDocCopy":"userDocCopy","click #checkedAllDeptDoc":"checkedAllDoc"},initialize:function(e){this.options=e||{},this.type=this.options.type,t.contains(this.type,"?")&&(this.type=this.type.substr(0,this.type.indexOf("?"))),this.deptId=this.options.deptId,this.contentTop=i.getInstance(),this.collection=new c(this.type,this.deptId),this.initProperty="createdAt",this.initDirection="desc",this.initPage=20,this.ckeyword="",this.userId=r.session("id"),t.bindAll(this,"render","renderPageSize","renderPages");var n=sessionStorage.getItem("list-history-baseUrl"),s=new RegExp("(#)?approval/doclist/send/"+this.type+"$");n&&s.test(n)?(this.initProperty=sessionStorage.getItem("list-history-property"),this.initDirection=sessionStorage.getItem("list-history-direction"),this.initSearchtype=sessionStorage.getItem("list-history-searchtype"),this.ckeyword=sessionStorage.getItem("list-history-keyword").replace(/\+/gi," "),this.duration=sessionStorage.getItem("list-history-duration"),this.fromDate=sessionStorage.getItem("list-history-fromDate"),this.toDate=sessionStorage.getItem("list-history-toDate"),this.collection.setListParam()):(this.collection.pageSize=this.initPage,this.collection.setDuration(),this.collection.setSort(this.initProperty,this.initDirection)),sessionStorage.clear(),this.collection.bind("reset",this.resetList,this),u.prototype.initialize.call(this,e)},renderLayout:function(){this.$el.html(p({buttons:this.buttons,lang:g})),this.type.indexOf("?")>=0&&(this.type=this.type.substr(0,this.type.indexOf("?"))),e("#tab_"+this.type).addClass("on");var t=m["\ubc1c\uc1a1 \ubb38\uc11c\ud568"];this.contentTop.setTitle(t),this.contentTop.render(),this.$el.find("header.content_top").replaceWith(this.contentTop.el),this.$el.find("input[placeholder]").placeholder(),this.renderPageSize(),(new f({getDownloadURL:e.proxy(this.collection.getCsvURL,this.collection),appendTarget:this.$el.find("#docToolbar > div.critical")})).render()},renderTitle:function(e){this.contentTop.setTitle(e),this.contentTop.render()},renderPageSize:function(){this.pageSizeView=new o({pageSize:this.collection.pageSize}),this.pageSizeView.render(),this.pageSizeView.bind("changePageSize",this.selectPageSize,this)},renderPages:function(){this.pageView=new s({pageInfo:this.collection.pageInfo()}),this.pageView.bind("paging",this.selectPage,this),this.$el.find("div.tool_absolute > div.dataTables_paginate").remove(),this.$el.find("div.tool_absolute").append(this.pageView.render().el)},resetList:function(t){var n=this.collection.url().replace("/api/",""),i=r.router.getUrl().replace("#","");i.indexOf("?")<0?r.router.navigate(n,{replace:!0}):i!=n&&r.router.navigate(n,{trigger:!1,pushState:!0}),e(".list_approval > tbody").empty();var s=this.columns,o="sendDoc";t.each(function(t){var n=new a({model:t,listType:o,columns:s});e(".list_approval > tbody").append(n.render().el)}),t.length==0&&e(".list_approval > tbody").html(d({columns:this.columns,lang:{doclist_empty:m["\ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."]}})),this.renderPages()},selectTab:function(t){this.collection.setPageNo(0),e(".tab_nav > li").removeClass("on"),e(t.currentTarget).addClass("on");var n=e(t.currentTarget).attr("id");n=="tab_all"?this.collection.setType("all"):n=="tab_waiting"?this.collection.setType("waiting"):n=="tab_received"?this.collection.setType("received"):n=="tab_inprogress"?this.collection.setType("inprogress"):n=="tab_complete"?this.collection.setType("complete"):n=="tab_returned"?this.collection.setType("returned"):n=="tab_recv_returned"&&this.collection.setType("recv_returned"),this.collection.fetch()},selectPage:function(e){this.collection.setPageNo(e),this.collection.fetch()},selectPageSize:function(e){this.collection.setPageSize(e),this.collection.fetch()},checkedAllDoc:function(){e("#checkedAllDeptDoc").is(":checked")?e("td.check :checkbox:not(checked)").attr("checked",!0):e("td.check :checkbox:checked").attr("checked",!1)},release:function(){this.$el.off(),this.$el.empty()}});return y});