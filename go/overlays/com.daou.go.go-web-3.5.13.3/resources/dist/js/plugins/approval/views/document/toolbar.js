define("approval/views/document/toolbar",function(require){var e=require("jquery"),t=require("underscore"),n=require("backbone"),r=require("hgn!approval/templates/document/toolbar"),i=require("i18n!nls/commons"),s=require("i18n!approval/nls/approval"),o={"\uae30\uc548":s["\uae30\uc548"],"\uacb0\uc7ac\uc694\uccad":s["\uacb0\uc7ac\uc694\uccad"],"\uc784\uc2dc\uc800\uc7a5":s["\uc784\uc2dc\uc800\uc7a5"],"\uc0ad\uc81c":s["\uc0ad\uc81c"],"\ucde8\uc18c":i["\ucde8\uc18c"],"\uc800\uc7a5":i["\uc800\uc7a5"],"\ubb38\uc11c \uc218\uc815":s["\ubb38\uc11c \uc218\uc815"],"\uacb0\uc7ac":s["\uacb0\uc7ac"],"\ubc18\ub824":s["\ubc18\ub824"],"\ubcf4\ub958":s["\ubcf4\ub958"],"\ud569\uc758":s["\ud569\uc758"],"\ubc18\ub300":s["\ubc18\ub300"],"\ud655\uc778":s["\ud655\uc778"],"\ud68c\uc218":s["\ud68c\uc218"],"\uacb0\uc7ac\ubb38\uc11c\ud68c\uc218":s["\uacb0\uc7ac\ubb38\uc11c\ud68c\uc218"],"\uc811\uc218":s["\uc811\uc218"],"\ubc18\uc1a1":s["\ubc18\uc1a1"],"\uc811\uc218\ucde8\uc18c":s["\uc811\uc218\ucde8\uc18c"],"\ub2f4\ub2f9\uc790 \uc9c0\uc815":s["\ub2f4\ub2f9\uc790 \uc9c0\uc815"],"\ud6c4\uc5f4":s["\ud6c4\uc5f4"],"\ud6c4\uacb0":s["\ud6c4\uacb0"],"\uc120\uacb0\uc7ac":s["\uc120\uacb0\uc7ac"],"\ubd80\uc11c \ubb38\uc11c\ud568 \ubcf5\uc0ac":s["\ubd80\uc11c \ubb38\uc11c\ud568 \ubcf5\uc0ac"],"\uc5f4\ub78c\uc790 \ucd94\uac00":s["\uc5f4\ub78c\uc790 \ucd94\uac00"],"\ubb38\uc11c\ubd84\ub958 \ucd94\uac00":s["\ubb38\uc11c\ubd84\ub958 \ucd94\uac00"],"\uacb0\uc7ac \uc815\ubcf4":s["\uacb0\uc7ac \uc815\ubcf4"],"\uacb0\uc7ac\uc120 \ubcc0\uacbd":s["\uacb0\uc7ac\uc120 \ubcc0\uacbd"],"\ubaa9\ub85d":i["\ubaa9\ub85d"],"\ubcf5\uc0ac":i["URL \ubcf5\uc0ac"],"\uc778\uc1c4":i["\uc778\uc1c4"],"\uacb0\uc7ac\ubb38\uc11c\uba85":s["\uacb0\uc7ac\ubb38\uc11c\uba85"],"\uc0c1\uc2e0\ucde8\uc18c":s["\uc0c1\uc2e0\ucde8\uc18c"],"\uacb0\uc7ac\ucde8\uc18c":s["\uacb0\uc7ac\ucde8\uc18c"],"\uc804\uacb0":s["\uc804\uacb0"],"\uc218\uc2e0\uc790 \ucd94\uac00":s["\uc218\uc2e0\uc790 \ucd94\uac00"],"\uc7ac\uae30\uc548":s["\uc7ac\uae30\uc548"],"\uc7ac\uc811\uc218":s["\uc7ac\uc811\uc218"],"\uba54\uc77c\ubc1c\uc1a1":i["\uba54\uc77c\ubc1c\uc1a1"],"\uac8c\uc2dc\ud310 \uac8c\uc2dc":s["\uac8c\uc2dc\ud310 \uac8c\uc2dc"],"\ud31d\uc5c5\ubcf4\uae30":i["\ud31d\uc5c5\ubcf4\uae30"],"\ub3c4\uc6c0\ub9d0":i["\ub3c4\uc6c0\ub9d0"],"\ub2e4\uc6b4\ub85c\ub4dc":i["\ub2e4\uc6b4\ub85c\ub4dc"],"\ubbf8\ub9ac\ubcf4\uae30":i["\ubbf8\ub9ac\ubcf4\uae30"],"\uc790\ub3d9\uc800\uc7a5\uc548\ud568":s["\uc790\ub3d9\uc800\uc7a5\uc548\ud568"],"\uc790\ub3d9\uc800\uc7a5":s["\uc790\ub3d9\uc800\uc7a5"],"\uc790\ub3d9\uc800\uc7a5 \uc8fc\uae30\ub97c \ubcc0\uacbd \ud558\uc600\uc2b5\ub2c8\ub2e4.":s["\uc790\ub3d9\uc800\uc7a5 \uc8fc\uae30\ub97c \ubcc0\uacbd \ud558\uc600\uc2b5\ub2c8\ub2e4."],"\uc790\ub3d9 \uc800\uc7a5 \ud558\uc600\uc2b5\ub2c8\ub2e4.":s["\uc790\ub3d9 \uc800\uc7a5 \ud558\uc600\uc2b5\ub2c8\ub2e4."],"\uc790\ub3d9\uc800\uc7a5 \uc911 \uc5d0\ub7ec \ubc1c\uc0dd":s["\uc790\ub3d9\uc800\uc7a5 \uc911 \uc5d0\ub7ec \ubc1c\uc0dd"],"\ucd08":s["\ucd08"],"\ubd84":s["\ubd84"],"\uc811\uc218 \ucde8\uc18c \ud6c4 \ubc18\uc1a1":s["\uc811\uc218 \ucde8\uc18c \ud6c4 \ubc18\uc1a1"],"\ubd80\uc11c \uc7ac\uc9c0\uc815":s["\ubd80\uc11c \uc7ac\uc9c0\uc815"]},u,a,f,l,c=!1,h=!1,p=n.View.extend({initialize:function(e){this.options=e||{},t.bindAll(this,"render","showEditType","showNormalType"),this.type=this.options.type,this.toolbarModel=this.options.toolbarModel,this.docStatus=this.options.docStatus,this.userId=this.options.userId,this.drafterId=this.options.drafterId,this.isAgreement=this.options.isAgreement,this.isReceptionDocument=this.options.isReceptionDocument,this.isDeletedDeptRcvDoc=this.options.isDeletedDeptRcvDoc,this.isPublic=this.options.isPublic,this.useHelp=this.options.useHelp,this.formId=this.options.formId,this.checkIsDeputyActivity=this.options.checkIsDeputyActivity,this.docId=this.options.docId,this.autoSaveTime=this.options.autoSaveTime},events:{"click #act_save":"actSave","click #act_cancel":"actCancel","click #act_draft":"actDraft","click #act_delete":"actDelete","click #act_temp_save":"actTempSave","click #act_cancel_draft":"actCancelDraft","click #act_approve":"actApprove","click #act_hold":"actHold","click #act_return":"actReturn","click #act_agree":"actAgree","click #act_disagree":"actDisagree","click #act_check":"actCheck","click #act_inspection":"actInspection","click #act_advappr":"actAdvAppr","click #act_withdrawal":"actWithdrawal","click #act_draft_withdrawal":"actDraftWithdrawal","click #act_draft_withdrawal_inprogress":"actDraftWithdrawalInprogress","click #act_draft_withdrawal_draft":"actDraftWithdrawalDraft","click #act_draft_withdrawal_cancelDraft":"actDraftWithdrawalCancelDraft","click #reassign_receiver":"reassignReceiver","click #cancel_reception":"cancelReception","click #return_reception":"returnReception","click #act_deptFolderCopy":"actDeptFolderCopy","click #act_edit_apprflow":"actEditApprFlow","click #act_edit":"actEdit","click #act_postcheck":"actPostCheck","click #act_postapproval":"actPostApproval","click #act_addFolder":"actAddFolder","click #act_generate_actcopy":"actGenerateActCopy","click #act_reapply":"actReapply","click #act_list":"actList","click #show_help":"showHelp","click #act_doc_print":"actDocPrint","click #sendMail":"showSendMailLayer","click #post_regist":"showPostRegistLayer","click #show_popup":"showPopup","click #downloadDocument":"downloadDocument","click #act_document_preview":"documentPreview","change #autoSaveSelect":"autoSave","click #cancel_and_return_reception":"cancelAndReturnReception","click #reassign_dept":"reassignDept"},autoSave:function(t){var n=e(t.currentTarget).attr("evt-rol");if(!n)return;if(n=="auto-save"){var r=e(t.currentTarget).val();e("select[evt-rol=auto-save]").val(r),this.chgAutoSaveTerm(r)}},showSendMailLayer:function(){this.trigger("showSendMailLayer")},showPostRegistLayer:function(){this.trigger("showPostRegistLayer")},render:function(){var n=this,i=this.makeActionControll();this.$el.html(r({lang:o,useActData:i,isPopup:this.options.isPopup,useHelp:this.options.useHelp,formId:this.options.formId,isPopupButtonVisible:!t.contains(["CREATE"],this.docStatus),isAutoSave:t.contains(["CREATE","TEMPSAVE"],this.docStatus),autoSaveOptions:{options:[{val:0,txt:o["\uc790\ub3d9\uc800\uc7a5\uc548\ud568"],selected:n.autoSaveTime==0?!0:!1},{val:30,txt:o["\uc790\ub3d9\uc800\uc7a5"]+"(30"+o["\ucd08"]+")",selected:n.autoSaveTime==30?!0:!1},{val:60,txt:o["\uc790\ub3d9\uc800\uc7a5"]+"(1"+o["\ubd84"]+")",selected:n.autoSaveTime==60?!0:!1},{val:180,txt:o["\uc790\ub3d9\uc800\uc7a5"]+"(3"+o["\ubd84"]+")",selected:n.autoSaveTime==180?!0:!1}]}})),clearTimeout(u),f!=undefined&&clearTimeout(f);if(this.docStatus=="CREATE"||this.docStatus=="TEMPSAVE"){var s=e("#autoSaveSelect").val()*1e3||6e4;if(this.docStatus=="CREATE"||this.docStatus=="TEMPSAVE")f=setTimeout(function(){n.runAutoSaveProcess()},s)}e(this.$el).find("#act_save").hide(),e(this.$el).find("#act_cancel").hide(),e(this.$el).find("#act_rereceive").bind("click",e.proxy(function(){this.trigger("actRereceive")},this)),e(this.$el).find("#act_receive").bind("click",e.proxy(function(){this.trigger("actReceive")},this)),e("body").trigger("approval.toolbarRender")},makeActionControll:function(){return{isActivityUser:this.toolbarModel.isActivityUser,createDraft:this.getCreateDraft(),tempSave:this.getTempSave(),inDraft:this.getInDraft(),inApproval:this.getInApproval(),inHold:this.getInHold(),inAgree:this.getInAgree(),inCheck:this.getInCheck(),inInspection:this.getInInspection(),inInspectionReturn:this.getInInspectionReturn(),inRecovery:this.getInRecovery(),inAdvApproval:this.getInAdvApproval(),inDraftWithdraw:this.getInDraftWithdraw(),inPostCheck:this.getInPostCheck(),inPostApproval:this.getInPostApproval(),completeDraft:this.getCompleteDraft(),completeEtc:this.getCompleteEtc(),isReceiver:this.toolbarModel.isReceiver,isReceivable:this.toolbarModel.isReceivable,isReceived:this.toolbarModel.isReceived,isAllowCancelReceive:this.toolbarModel.isAllowCancelReceive,completeAddReceive:this.getCompleteAddReceive(),isPublic:this.isPublic,useHelp:this.useHelp,formId:this.formId,isPostRegistable:this.toolbarModel.isPostRegistable,completeRefer:!1,completeRead:!1,returnDraft:this.getReturnDraft(),isRereceivable:this.toolbarModel.isRereceivable,isReceptionDocument:this.isReceptionDocument,isDeletedDeptRcvDoc:this.isDeletedDeptRcvDoc,arbitraryDecision:this.toolbarModel.isArbitraryDecisionabled,arbitraryDecisionDocument:this.toolbarModel.isArbitraryDecisionDocument,inArbitraryDecisionDocument:this.getInArbitraryDecisionDocument(),actCopy:this.toolbarModel.actCopyAlterable,isActCopyDocument:this.toolbarModel.isActCopyDocument,lastActivityUser:this.toolbarModel.isLastActivityUser,isDocumentEditable:this.toolbarModel.isDocumentEditable,isApprovalInfoButtonVisible:this.toolbarModel.isActivityUser||this.toolbarModel.isReader,showUrlCopy:this.getShowUrlBtn(),showPrintBtn:this.type=="CREATE"||this.type=="REAPPLY"?!1:!0,showSendMailBtn:GO.session("mailAccountStatus")=="enabled"&&this.toolbarModel.isUseSendMail&&!this.getCreateDraft()&&!this.getTempSave(),showDownloadBtn:this.getShowDownloadBtn(),latestCompletedActionisApproval:this.toolbarModel.latestCompleteAction=="APPROVAL"?!0:!1,latestCompletedActionName:this.toolbarModel.latestCompleteActionName,showDraftBtnByDraftWaiting:this.docStatus=="DRAFT_WAITING"&&this.userId==this.drafterId?!0:!1,hideWhenDeletedDeptRcvDoc:this.getHideWhenDeletedDeptRcvDoc()}},getCreateDraft:function(){return this.docStatus=="CREATE"&&this.userId==this.drafterId?!0:!1},getTempSave:function(){return this.docStatus=="TEMPSAVE"&&this.userId==this.drafterId?!0:!1},getInDraft:function(){return this.docStatus=="INPROGRESS"&&this.userId==this.drafterId&&this.toolbarModel.isAllowCancelDraftUser?!0:!1},getInDraftWithdraw:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isAllowInprogressCancelDraftUser?!0:!1},getInApproval:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isApprovalWaitingUser?!0:!1},getInHold:function(){return this.toolbarModel.useHold?this.docStatus=="INPROGRESS"&&this.toolbarModel.isActivityHoldingUser||this.toolbarModel.isApprovalDeputy||this.toolbarModel.isAgreementDeputy||this.toolbarModel.isCheckDeputy||this.toolbarModel.isInspectionDeputy?!0:!1:!0},getInAdvApproval:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isApprovalUpcommingUser&&this.toolbarModel.useAdvApproval?!0:!1},getInAgree:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isAgreementWaitingUser?!0:!1},getInCheck:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isCheckWaitingUser?!0:!1},getInInspection:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isInspectionWaitingUser?!0:!1},getInInspectionReturn:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isInspectionWaitingUser&&this.toolbarModel.useInspectionReturn?!0:!1},getInRecovery:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.latestCompleteAction!="DRAFT"&&this.toolbarModel.isJustBeforeApprovalUser&&this.checkIsDeputyActivity?!0:this.docStatus=="INPROGRESS"&&this.toolbarModel.latestCompleteAction!="DRAFT"&&this.toolbarModel.isBeforeParallelAgreemntUser&&this.checkIsDeputyActivity?!0:!1},getInPostApproval:function(){if(this.toolbarModel.isPostApprovalUser)return!0;!1},getInPostCheck:function(){if(this.toolbarModel.isPostCheckUser)return!0;!1},getInArbitraryDecisionDocument:function(){return this.docStatus=="INPROGRESS"&&this.toolbarModel.isArbitraryDecisionDocument?!0:!1},getShowUrlBtn:function(){return this.docStatus=="INPROGRESS"||this.docStatus=="COMPLETE"||this.docStatus=="RETURN"?!0:!1},getCompleteDraft:function(){return this.docStatus=="COMPLETE"&&this.userId==this.drafterId?!0:!1},getReturnDraft:function(){return this.docStatus=="RETURN"&&this.userId==this.drafterId&&!this.isReceptionDocument?!0:!1},getCompleteEtc:function(){return this.docStatus=="COMPLETE"&&this.userId!=this.drafterId&&this.toolbarModel.isActivityUser?!0:!1},getCompleteAddReceive:function(){return this.docStatus=="COMPLETE"&&this.toolbarModel.isReceiptAddReader?!0:!1},getShowDownloadBtn:function(){return this.docStatus=="COMPLETE"||this.isReceptionDocument?!0:!1},getHideWhenDeletedDeptRcvDoc:function(){return!this.isDeletedDeptRcvDoc||this.docStatus!="RECEIVED"&&this.docStatus!="RETURN"?!1:!0},showEditType:function(){e(this.$el).find("#act_save").show(),e(this.$el).find("#act_cancel").show(),e(this.$el).find("#act_edit").hide(),e(this.$el).find("#act_draft").hide(),e(this.$el).find("#act_approve").hide(),e(this.$el).find("#act_hold").hide(),e(this.$el).find("#act_check").hide(),e(this.$el).find("#act_return").hide(),e(this.$el).find("#act_edit_apprflow").hide(),e(this.$el).find("#act_draft_withdrawal").hide(),e(this.$el).find("#act_withdrawal").hide(),e(this.$el).find("#cancel_reception").hide(),e(this.$el).find("#sendMail").hide(),e(this.$el).find("#show_popup").hide(),e(this.$el).find("#act_agree").hide(),e(this.$el).find("#act_disagree").hide(),e(this.$el).find("#act_inspection").hide()},showNormalType:function(){e(this.$el).find("#act_save").hide(),e(this.$el).find("#act_cancel").hide(),e(this.$el).find("#act_edit").show()},actSave:function(){this.trigger("saved")},actCancel:function(){this.trigger("canceled")},actDraft:function(){this.trigger("drafted")},actDelete:function(){this.trigger("deleted")},actTempSave:function(){this.trigger("tempSaved")},actTempAutoSave:function(){this.trigger("tempAutoSaved")},actCancelDraft:function(){this.trigger("draftCanceled")},actApprove:function(){this.trigger("approved")},actHold:function(){this.trigger("holded")},actReturn:function(){this.trigger("returned")},actAgree:function(){this.trigger("agreed")},actDisagree:function(){this.trigger("disagreed")},actCheck:function(){this.trigger("checked")},actInspection:function(){this.trigger("inspected")},actAdvAppr:function(){this.trigger("actAdvAppr")},actWithdrawal:function(){this.trigger("actWithdrawal")},actDraftWithdrawal:function(){this.trigger("actDraftWithdrawal")},actDraftWithdrawalInprogress:function(){this.trigger("actDraftWithdrawalInprogress")},actDraftWithdrawalDraft:function(){this.trigger("actDraftWithdrawalDraft")},actDraftWithdrawalCancelDraft:function(){this.trigger("actDraftWithdrawalCancelDraft")},actReceive:function(){this.trigger("actReceive")},reassignReceiver:function(){this.trigger("reassignReceiver")},actRereceive:function(){this.trigger("actRereceive")},cancelReception:function(){this.trigger("cancelReception")},returnReception:function(){this.trigger("returnReception")},actDeptFolderCopy:function(){this.trigger("deptFolderCopy")},actEditApprFlow:function(){this.trigger("editApprFlow")},actEdit:function(){this.showEditType(),this.trigger("edit")},actPostCheck:function(){this.trigger("actPostCheck")},actPostApproval:function(){this.trigger("actPostApproval")},actAddFolder:function(){this.trigger("actAddFolder")},actGenerateActCopy:function(){this.trigger("generateActCopy")},actReapply:function(){this.trigger("actReapply")},actList:function(){this.trigger("actList")},showHelp:function(t){var n=e(t.currentTarget).attr("data-value"),r=window.location.protocol+"//"+window.location.host+GO.contextRoot+"app/approval/help/"+n;window.open(r,"","scrollbars=1,width=400,height=600 top="+(screen.height/2-200)+" left="+(screen.width/2-180))},actDocPrint:function(){this.trigger("docPrint")},showPopup:function(){this.trigger("showPopup")},downloadDocument:function(){this.trigger("downloadDocument")},documentPreview:function(){this.trigger("documentPreview")},storeAutoSaveTime:function(){this.trigger("storeAutoSaveTime")},runAutoSaveProcess:function(){var t=this;clearTimeout(u);var n=e("#autoSaveSelect").val(),r=n*1e3;r>0?(c&&this.doAutoSave(),c=!0,u=setTimeout(function(){t.runAutoSaveProcess()},r)):(c=!1,clearTimeout(u))},doAutoSave:function(){var n=!0;t.each(e('form span[data-dsl*="editor"]'),function(t){if(!GO.Editor.getInstance(e(t).attr("id")).isAccessible())return n=!1,!1});if(!n)return;var r=this;h=!0,this.actTempAutoSave(),l=setTimeout(function(){h&&r.processAutoSaveMessage("saveErrMessage")},1e4)},chgAutoSaveTerm:function(e){clearTimeout(u),c=!1,this.trigger("storeAutoSaveTime"),this.runAutoSaveProcess(),this.processMessageViewer(o["\uc790\ub3d9\uc800\uc7a5 \uc8fc\uae30\ub97c \ubcc0\uacbd \ud558\uc600\uc2b5\ub2c8\ub2e4."]+this.getSelectedTimeMsg())},processAutoSaveMessage:function(e,t){clearTimeout(l);var n="";e=="saveTerm"?n=o["\uc790\ub3d9 \uc800\uc7a5 \ud558\uc600\uc2b5\ub2c8\ub2e4."]+this.getSelectedTimeMsg():e=="saveErrorTerm"&&(n=o["\uc790\ub3d9\uc800\uc7a5 \uc911 \uc5d0\ub7ec \ubc1c\uc0dd"]),this.processMessageViewer(n),h=!1},processMessageViewer:function(t){clearTimeout(a),e("#processMessageContent").text(t),e("#processMessageWrap").fadeIn(500,function(){a=setTimeout(function(){jQuery("#processMessageWrap").fadeOut(500)},3e3)})},getSelectedTimeMsg:function(){var t="",n=e("#autoSaveSelect").val();return n>0?n<60?t+="("+n+o["\ucd08"]+")":t+="("+n/60+o["\ubd84"]+")":t+="("+o["\uc790\ub3d9\uc800\uc7a5\uc548\ud568"]+")",t},cancelAndReturnReception:function(){this.trigger("cancelAndReturnReception")},reassignDept:function(){this.trigger("reassignDept")}});return p});