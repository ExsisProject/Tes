define(["jquery","underscore","backbone","app","approval/models/doclist_item","views/profile_card","approval/views/document/apprflow","approval/views/document_attach","hgn!approval/templates/doclist_item","i18n!nls/commons","i18n!approval/nls/approval"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({tagName:"tr",events:{"click span.ic_file_s":"showAttach","click span.read":"showApprFlow","click span.notyet":"showApprFlow","click span.finish":"showApprFlow","click .writer":"showUserProfile","click td.subject a:not([class])":"showUrl"},initialize:function(e){this.options=e||{},t.bindAll(this,"render","showApprFlow","showAttach","showUserProfile"),this.columns=this.options.columns,this.deptId=this.options.deptId,this.listType=this.options.listType},render:function(){var e=this.listType;this.model.setListType(e);var t={id:this.model.get("id"),draftedAt:this.model.getDraftedAt(),formName:this.model.get("formName"),title:this.model.get("title"),hasAttach:this.model.get("attachFileCount")>0?!0:!1,attachCount:this.model.get("attachFileCount"),drafterId:this.model.get("drafterId"),drafterName:this.model.get("drafterName"),docStatus:this.model.getDocStatusName(),statusClass:this.model.getDocStatusClass(),completedAt:this.model.getCompletedAt(),docNum:this.model.get("docNum"),isReceive:this.model.get("docType")=="RECEIVE"};return this.$el.html(a({doc:t,columns:this.columns,deptId:this.deptId,lang:l})),this},showAttach:function(e){e.stopPropagation();var t=new u({docId:this.model.get("id")});t.render()},showApprFlow:function(t){t.stopPropagation(),t.preventDefault();var n=new o({docId:this.model.get("id")}),r=e.goPopup({pclass:"layer_normal layer_approval_line_state",header:l["\uacb0\uc7ac \uc9c4\ud589 \uc0c1\ud669"],modal:!0,width:"300px",contents:n.render().$el.html(),buttons:[{btext:f["\ud655\uc778"],btype:"confirm",callback:function(){}}]});r.on("click","a[data-userid]",e.proxy(this.showUserProfileCard,this))},showUserProfile:function(e){e.stopPropagation(),e.preventDefault(),s.render(this.model.get("drafterId"),e.currentTarget)},showUserProfileCard:function(t){s.render(e(t.currentTarget).attr("data-userid"),t.currentTarget)},showUrl:function(e){sessionStorage.setItem("list-history-baseUrl",r.router.getUrl()),sessionStorage.setItem("list-history-doc-id",this.model.get("id"));var t=this.listType;t||(t="approval");var n="/"+t+"/document/"+this.model.get("id");r.router.navigate(n,!0)}});return c});