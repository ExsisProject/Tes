define(["jquery","underscore","backbone","app","views/profile_card","i18n!nls/commons","i18n!approval/nls/approval"],function(e,t,n,r,i,s,o){var u=n.Collection.extend({url:function(){return this.isAdmin?"/ad/api/approval/manage/document/"+this.docId+"/readerhistory":"/api/approval/document/"+this.docId+"/readerhistory"},initialize:function(e){this.docId=e.docId,this.isAdmin=e.isAdmin}}),a=n.View.extend({tagName:"div",className:"aside_wrapper_body",events:{"click a[data-userid]":"_showUserProfile"},initialize:function(e){this.docId=e.docId,this.isAdmin=e.isAdmin,t.isObject(this.options.collection)?this.collection=new u(this.options.collection):(this.collection=new u({isAdmin:this.isAdmin,docId:this.docId}),this.collection.fetch({async:!1}))},render:function(){var e=Hogan.compile(this._renderTemplate()),n=[];return this.collection.each(function(e){n.push(t.extend(e.toJSON(),{latestReadAt:GO.util.basicDate(e.get("latestReadAt"))}))}),this.$el.html(e.render({histories:n,lang:{"\uc870\ud68c\uc218":o["\uc870\ud68c\uc218"],no_histories:o["\uc5f4\ub78c\uae30\ub85d\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}})),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},_renderTemplate:function(){var e=[];return e.push("{{#histories}}"),e.push('<ul class="reply">'),e.push("    <li>"),e.push('        <span class="photo"><a data-userid="{{readerId}}">'),e.push('            <img src="{{#readerThumbnail}}{{readerThumbnail}}{{/readerThumbnail}}{{^readerThumbnail}}resources/images/photo_profile_small.jpg{{/readerThumbnail}}">'),e.push("        </a></span>"),e.push('        <div class="msg_wrap">'),e.push('            <div class="info">'),e.push('                <span class="name">{{readerName}} {{readerPosition}}</span>'),e.push('                <span class="department">{{lang.\uc870\ud68c\uc218}} {{readCount}}</span>'),e.push('                <span class="date">{{latestReadAt}}</span>'),e.push("            </div>"),e.push("        </div>"),e.push("    </li>"),e.push("</ul>"),e.push("{{/histories}}"),e.push("{{^histories}}"),e.push('<ul class="reply">'),e.push('    <li class="inactive last" style="margin-left: 10px">{{lang.no_histories}}</li>'),e.push("</ul>"),e.push("{{/histories}}"),e.join("")},_showUserProfile:function(t){if(!e(t.currentTarget).attr("data-userid"))return;i.render(e(t.currentTarget).attr("data-userid"),t.currentTarget)}});return a});