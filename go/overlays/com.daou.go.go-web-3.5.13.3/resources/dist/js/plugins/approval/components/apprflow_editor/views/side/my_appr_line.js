define("approval/components/apprflow_editor/views/side/my_appr_line",["approval/components/apprflow_editor/views/base_tab_item","hgn!approval/components/apprflow_editor/templates/side/my_appr_line","approval/models/appr_line","approval/collections/appr_lines","i18n!nls/commons","i18n!approval/nls/approval"],function(e,t,n,r,i,s){var o={"delete":i["\uc0ad\uc81c"],group_count_title:s["{{count}}\uac1c\uc758 \uacb0\uc7ac\uc120\uc774 \uc788\uc2b5\ub2c8\ub2e4."],msg_empty_my_lines:s["\uac1c\uc778 \uacb0\uc7ac\uc120\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]},u=e.extend({tabId:"myapprline",tabName:s["\ub098\uc758\uacb0\uc7ac\uc120"],docStatus:null,observer:null,events:{"click a.my_line_a":"_onItemSelected","click a.ic_del":"_onItemDeleted"},initialize:function(t){t=t||{},e.prototype.initialize.apply(this,arguments),this.collection=new r,this.observer=t.observer,this.docStatus=t.docStatus,this.$el.addClass("content_tab_wrap"),this.listenTo(this.observer,"reloadMyLine",this.render),this.listenTo(this.observer,"deselectMyLine",this.deselectMyLine)},render:function(){this.$el.empty(),GO.util.isIE8()?this.$el.css({"min-height":"353px","max-height":"353px"}):this.$el.css({"min-height":"339px","max-height":"339px"}),this.collection.fetch({success:$.proxy(this._renderMyLineList,this)})},show:function(){this.$el.show()},hide:function(){this.$el.hide()},isShowing:function(){return!0},isHiding:function(){return!0},deselectMyLine:function(){this.collection.each(function(e){e.set("isSelected",!1)}),this._renderMyLineList(this.collection)},_renderMyLineList:function(e,n,r){var i=this.docStatus=="CREATE"||this.docStatus=="TEMPSAVE"||this.docStatus=="RECEIVED";this.$el.html(t({lang:o,hasMyLines:!e.isEmpty(),myLines:e.map(function(e){var t=0;return _.each(e.get("activityGroups"),function(e){t+=e.activities.length}),{id:e.get("id"),title:e.get("title"),groupCount:t,groupCountTitle:GO.i18n(o.group_count_title,"count",e.get("activityGroups").length),isSelected:e.get("isSelected")||!1,isEnabled:i,"delete":o["delete"],apply:o.apply}})}))},_onItemSelected:function(e){var t=this,n=$(e.currentTarget),r=$("div#my_line_tab_content").find("ul.side_depth");e.preventDefault(),$.each(r.find("li"),function(){var e=$(this).children().children("a.my_line_a").attr("data-id"),n=t.collection.get(e);n.set("isSelected",!1)});var i=n.parents("li.feed");if(i.hasClass("inactive"))return!1;var s=i.find("a.my_line_a").data("id");this.collection.each(function(e){e.set("isSelected",!1)});var o=this.collection.get(s);o.set("isSelected",!0),this.observer.trigger("myLineSelected",o.get("activityGroups"),o.get("useParallelAgreement")),this.render()},_onItemDeleted:function(e){var t="gopopup-delmyapprline",n=$(e.target).parent().find("a.my_line_a"),r=$.proxy(this._deleteAsPeronalApprLineOkButtonCallback,this,n.attr("data-id"),targetEl);e.preventDefault();if($("#"+t).length>0)return;$.goPopup({id:t,title:o.delete_as_my_line,message:s["\uc120\ud0dd\ud55c \ud56d\ubaa9\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],modal:!0,allowPrevPopup:!0,closeIconVisible:!1,buttons:[{btext:i["\ud655\uc778"],btype:"confirm",callback:r},{btext:i["\ucde8\uc18c"],btype:"normal",callback:function(){}}]}),e.stopPropagation()},_deleteAsPeronalApprLineOkButtonCallback:function(e,t,r,s){var o=new n;o.save({id:e},{type:"DELETE",success:$.proxy(function(e,n,o){$.goMessage(i["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),this.render(),$(t).closest("li").remove(),r.close("",s)},this),error:function(e,t,n){$.goMessage(i["\uad00\ub9ac \uc11c\ubc84\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4"])}})},checkAuth:function(){return!0}});return u});