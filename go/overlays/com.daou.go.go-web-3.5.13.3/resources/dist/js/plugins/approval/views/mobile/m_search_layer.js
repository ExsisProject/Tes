(function(){define(function(require){var e=require("jquery"),t=require("backbone"),n=require("app"),r=require("i18n!nls/commons"),i=require("i18n!admin/nls/admin"),s=require("i18n!approval/nls/approval"),o=require("hgn!approval/templates/mobile/m_search_layer"),u=require("views/mobile/m_search_header"),a=require("approval/views/mobile/m_search_result");require("GO.util");var f=null,l={"\uac80\uc0c9 \uc870\uac74":r["\uac80\uc0c9 \uc870\uac74"],"\uc804\uccb4":r["\uc804\uccb4"],"\uac80\uc0c9":r["\uac80\uc0c9"],"\uae30\uc548\uc790":s["\uae30\uc548\uc790"],"\uc81c\ubaa9":s["\uc81c\ubaa9"],"\uacb0\uc7ac\uc591\uc2dd":s["\uacb0\uc7ac\uc591\uc2dd"],"\uae30\uc548\ubd80\uc11c":s["\uae30\uc548\ubd80\uc11c"],"\uacb0\uc7ac\uc120":s["\uacb0\uc7ac\ub77c\uc778"],"\ubb38\uc11c\ubc88\ud638":s["\ubb38\uc11c\ubc88\ud638"],"\ubcf8\ubb38":r["\ubcf8\ubb38"],"\ucca8\ubd80\ud30c\uc77c":r["\ucca8\ubd80\ud30c\uc77c"],"\uac80\uc0c9\uc870\uac74":r["\uac80\uc0c9 \uc870\uac74"],"\ubaa8\ub450\ub9cc\uc871":s["\ubaa8\ub450 \ub9cc\uc871"],"\ud558\ub098\ub9cc\ub9cc\uc871":s["\ud558\ub098\ub9cc \ub9cc\uc871"],"\ucd08\uae30\ud654":i["\ucd08\uae30\ud654"],"\uac80\uc0c9\uc5b4":r["\uac80\uc0c9\uc5b4"],"\uac80\uc0c9 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694":r["\uac80\uc0c9 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694."],"\ubd88\uac00\ubb38\uc790":r["\uba54\uc77c \uc0ac\uc6a9 \ubd88\uac00 \ubb38\uc790"],"\ubb38\uc790\uae38\uc774\uccb4\ud06c":r["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."]},c=t.View.extend({el:"#goSearch",events:{"vclick #searchInit":"_detailSearchInit","vclick a[data-search]":"_simpleSearch","keyup #detailSearchWrap input":"_detailSearch"},initialize:function(e){this.$el.off(),this.packageName=e.packageName},render:function(){return this.$el.html(o({lang:l})),this._renderSearchHeader(),this.el},_renderSearchHeader:function(){var e=this;u.render({enterSimpleSearchCallback:function(t){e._simpleSearch(t)}})},_detailSearchInit:function(t){t.preventDefault(),e("#detailSearchWrap input[type=search], #detailSearchWrap input[type=checkbox]").prop("checked",!1).val("")},_detailSearch:function(t){if(t.keyCode!=13)return;var r=e.trim(e("#formName").val()),i=e.trim(e("#drafterName").val()),s=e.trim(e("#drafterDeptName").val()),o=e.trim(e("#activityUserNames").val()),u=e.trim(e("#docNum").val()),f=e.trim(e("#stext").val()),c=e.trim(e("input[name='searchOption']:checked").val()),h=[{data:r,id:"formName"},{data:i,id:"drafterName"},{data:s,id:"drafterDeptName"},{data:o,id:"activityUserNames"},{data:u,id:"docNum"},{data:f,id:"stext"}];if(n.util.isAllEmptySearchText(h)){alert(l["\uac80\uc0c9 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694"]);return}if(!n.util.isValidForSearchTextWithCheckbox("stext"))return;if(!n.util.isValidSearchTextForDetail(h))return;var c={stype:"detail",type:this.packageName,formName:r,drafterName:i,drafterDeptName:s,activityUserNames:o,docNum:u,dateType:"draftedAt",title:e("#title").is(":checked")?f:"",docBody:e("#docBody").is(":checked")?f:"",searchTerm:"all",attachFileNames:e("#attachFile").is(":checked")?f:"",attachFileContents:e("#attachFile").is(":checked")?f:"",searchOption:c};a.render(c)},_simpleSearch:function(t){t.preventDefault();var r=e(t.currentTarget),i=e.trim(e("#commonSearchInput").val());if(!n.util.isValidSearchText(i))return;var s=r.attr("data-search")||"all",o={type:this.packageName,page:0,offset:15};s=="all"?(o.stype="simple",o.keyword=i):(o.stype="detail",o[s]=i),a.render(o)}});return{render:function(e){return f=new c(e),f.render()}}})}).call(this);