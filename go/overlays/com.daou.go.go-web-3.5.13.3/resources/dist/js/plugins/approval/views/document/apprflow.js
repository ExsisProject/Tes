define(["jquery","underscore","backbone","app","approval/models/appr_flow","views/profile_card","hgn!approval/templates/document/apprflow","i18n!nls/commons","i18n!approval/nls/approval"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({tagName:"div",className:"aside_wrapper_body",events:{"click a[data-userid]":"showUserProfile"},initialize:function(e){this.options=e||{},this.release(),this.docId=this.options.docId,this.masterChange=this.options.masterChange,this.isAdmin=!1,t.isBoolean(this.options.isAdmin)&&(this.isAdmin=this.options.isAdmin),t.isObject(this.options.model)?this.model=this.options.model:(this.model=new i({docId:this.docId,isAdmin:this.isAdmin,masterChange:this.masterChange}),this.model.fetch({async:!1}))},render:function(){var e=function(){return this.status!="undefined"&&this.status=="WAIT"&&!this.postCheck},n=function(){return!!this.status},r=function(){return GO.util.basicDate(this.completedAt)};t.each(this.model.get("activityGroups"),function(e,n){t.each(e.activities,function(e,n){!t.isUndefined(e.comment)&&!t.isEmpty(e.comment)&&(e.comment=GO.util.escapeHtml(e.comment)),e.holdingActivity&&e.holdingActivity.comment&&(e.holdingActivity.comment=GO.util.escapeHtml(e.holdingActivity.comment)),e.deputyActivity&&e.deputyActivity.comment&&(e.deputyActivity.comment=GO.util.escapeHtml(e.deputyActivity.comment))})});var i=o({dataset:this.model.get("activityGroups"),isEmpty:this.model.hasNoActivities(),lang:{portrait:a["\ucd08\uc0c1\ud654"],postCheck:a["\ud6c4\uc5f4"],noApprline:a["\uacb0\uc7ac\uc120 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],"\ubcf4\ub958":a["\ubcf4\ub958"]},isCurrent:e,isActive:n,formattedCompletedAt:r,contextRoot:GO.contextRoot});return this.$el.html(i),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},makeApprFlow:function(e){e[0].activities[0].isCurrent=!0,e[0].activities[0].isActive=!0;var t=o({dataset:e,isEmpty:!1,lang:{portrait:a["\ucd08\uc0c1\ud654"]},contextRoot:GO.contextRoot});this.$el.empty(),this.$el.html(t)},getCurrentActivity:function(){return this.model.getCurrentActivity()},showUserProfile:function(t){if(!e(t.currentTarget).attr("data-userid"))return;s.render(e(t.currentTarget).attr("data-userid"),t.currentTarget)},release:function(){this.$el.off(),this.$el.empty()}});return f});