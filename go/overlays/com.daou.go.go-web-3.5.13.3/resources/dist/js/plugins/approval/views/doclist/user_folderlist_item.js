define(["jquery","underscore","backbone","app","when","approval/models/user_folderlist_item","approval/views/doclist/docfolder_share","approval/views/side","hgn!approval/templates/user_folderlist_item","i18n!nls/commons","i18n!approval/nls/approval"],function(e,t,n,r,i,s,o,u,a,f,l){var c=t.extend(f,{"\uacf5\uc720 \uc124\uc815":l["\uacf5\uc720 \uc124\uc815"],"\uacf5\uc720":l["\uacf5\uc720"],"\ubb38\uc11c\ud568 \uacf5\uc720":l["\ubb38\uc11c\ud568 \uacf5\uc720"]}),h=n.View.extend({tagName:"tr",events:{"click #showArea":"toggleEditForm","click #editCancle":"toggleEditForm","click #editName":"editName","click [name=docFolderShare]":"docFolderShare"},initialize:function(e){this.options=e||{},t.bindAll(this,"render"),this.columns=this.options.columns},render:function(){var e={id:this.model.get("id"),userName:this.model.get("userName"),folderId:this.model.get("folderId"),folderName:this.model.get("folderName"),createdAt:this.model.getCreatedAt(),docCount:this.model.get("docCount"),shareCount:this.model.get("shareCount")};return this.$el.html(a({folder:e,columns:this.columns,lang:c})),this},toggleEditForm:function(t){var n=e(t.currentTarget),r=n.attr("data-type"),i=r=="show";this.$("#showArea").toggle(!i),this.$("#editArea").toggle(i),i||this.$("#name").val(this.model.get("folderName"))},editName:function(){var e=this,t=this.$("#name").val();this.validate(t)&&(this.model.set("folderName",t),this.model.save().done(function(){e.render(),u.reload(!0)}))},validate:function(t){return t?t.length<2||t.length>20?(e.goMessage(r.i18n(f["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"2",arg2:"20"})),!1):!0:(e.goMessage(c["\uac1c\uc778 \ubb38\uc11c\ud568 \ud3f4\ub354\uba85\uc744 \uc785\ub825\ud558\uc138\uc694"]),!1)},docFolderShare:function(t){var n=this,r=this.model.get("id"),i=e.goPopup({header:c["\ubb38\uc11c\ud568 \uacf5\uc720"],modal:!1,allowPrevPopup:!0,forceClosePopup:!1,closeCallback:function(){n.shareView.orgSlide&&n.shareView.orgSlide.close()},width:"424px",pclass:"layer_normal layer_folder_share",contents:"",buttons:[{btext:f["\ud655\uc778"],btype:"confirm",autoClose:!1,callback:function(e){return n.shareView.trigger("docFolderSave"),!1}},{btype:"normal",btext:f["\ucde8\uc18c"],autoclose:!0}]});n.shareView=new o({popupEl:i,folderType:"user",folderId:r,folderName:this.model.get("folderName")}),n.shareView.render(),n.shareView.on("successDocFolderSave",e.proxy(this.refreshShareCount,this))},refreshShareCount:function(e){this.model.set("shareCount",e),this.render()}});return h});