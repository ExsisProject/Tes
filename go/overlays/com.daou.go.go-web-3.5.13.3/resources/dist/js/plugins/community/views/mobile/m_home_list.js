(function(){define(["views/mobile/m_more_list","jquery","backbone","app","i18n!nls/commons","i18n!board/nls/board","i18n!community/nls/community","hgn!board/templates/mobile/m_home_list_unit","hgn!board/templates/mobile/m_board_list_item","community/models/community_info","community/collections/community_board_myhome","views/mobile/header_toolbar","jquery.go-validation","GO.util"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={board:i["\uac8c\uc2dc\ud310"],community_posts:o["\ucee4\ubba4\ub2c8\ud2f0 \uae00"],post_write:s["\uae00\uc4f0\uae30"],new_post:s["\uc0c8 \uae00 \uc791\uc131\ud558\uae30"],new_board:s["\uac8c\uc2dc\ud310 \ucd94\uac00\ud558\uae30"],no_auth:s["\uc5f4\ub78c\uad8c\ud55c\uc774 \uc5c6\ub294 \uac8c\uc2dc\ubb3c\uc785\ub2c8\ub2e4."],board_null:s["\ub4f1\ub85d\ub41c \uac8c\uc2dc\ud310\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],post_null:s["\uc791\uc131\ub41c \uac8c\uc2dc\uae00\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],board_null_msg1:s["\ub4f1\ub85d\ub41c \uac8c\uc2dc\ud310\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],move_to_home:i["\ud648\uc73c\ub85c \uc774\ub3d9"],view_count:s["\uc870\ud68c"]},p=e.extend({initialize:function(e){this.$el.off(),this.options=e||{},this.communityId=this.options.communityId,this.headerToolbarView=c,this.collection=new l;var n={listFunc:t.proxy(function(e){this.renderPosts(e)},this)};this.setRenderListFunc(n);var r={};this.setFetchInfo(r,this.collection),this.model=f.read({communityId:this.communityId})},events:{"vclick ul.home_list li>a":"goPostDetail",'vclick a[href="home"]':"goCommunityHome"},getPage:function(){var e=r.router.getSearch("page");return e?e:0},render:function(){var e=this;this.collection.communityId=this.communityId,GO.util.pageDone(),this.$el.html(a({otherClass:"list_board home_list"})),this.$listEl=this.$el.find("ul");var n={title:this.model.toJSON().name,isList:!0,isSideMenu:!0,isHome:!0,isSearch:!0};this.getWritable()&&(n.isWriteBtn=!0,n.writeBtnCallback=function(){r.router.navigate("community/post/write/"+e.communityId,!0)}),this.headerToolbarView.render(n),this.dataFetch().done(t.proxy(function(e){this.renderListFunc.listFunc(e),this.scrollToEl()},this))},hasBoard:function(){return this.model.get("boardCount")>0},getWritable:function(){return this.hasBoard()&&this.model.get("memberStatus")=="ONLINE"},getPosts:function(e){GO.util.appLoading(!0);var t={offset:this.offset};if(e==="more"){if(this.collection.page.lastPage)return GO.util.appLoading(!1),!1;t.page=parseInt(Number(this.collection.page.page)+1,10)||0}else t.page=e||0;this.collection.communityId=this.communityId,GO.util.appLoading(!1)},renderPosts:function(e){e.page.page==0&&this.$listEl.empty(),this.$listEl.append(this.makeTemplete(e)),GO.util.appLoading(!1)},goPostDetail:function(e){this.setSessionInfo(e);var n=t(e.currentTarget),i="community/"+this.communityId+"/board/"+n.attr("data-boardId")+"/post/"+n.attr("data-postId")+"?page="+this.getPage();return r.router.navigate(i,{trigger:!0,pushState:!0}),e.stopImmediatePropagation(),!1},goCommunityHome:function(e){return e.preventDefault(),r.router.navigate("community",{trigger:!0,pushState:!0}),!1},newPost:function(){return r.router.navigate("board/post/write",!0),!1},makeTemplete:function(e){var n={},r=null,i=e.toJSON(),s=function(){return parseInt(this.recommendCount)==0?"zero":""},o=function(e){return GO.util.snsDate(this.createdAt)},a=function(){var e=this.type;return e=="CLASSIC"?!0:!1},f=function(){return GO.util.br2nl(GO.util.escapeHtml(t.goValidation.charEllipsis(this.summary,40)))},l=function(){return GO.util.escapeHtml(this.title)},c=function(){return this.hiddenPost},p=function(){return this.summary==" $$#HIDDEN_POST#$$ "};return n={dataSet:i,isZero:s,titleParse:l,contentParse:f,dateParse:o,isClassic:a,lang:h,isPostHidden:c,isTitleHidden:p,hasBoard:this.hasBoard()},r=u(n),r}},{__instance__:null,create:function(e){return this.__instance__=new this.prototype.constructor({el:t("#content"),communityId:e[0].communityId}),this.__instance__},render:function(){var e=arguments.length>0?Array.prototype.slice.call(arguments):[],t=this.create(e);return this.prototype.render.apply(t,e)}});return p})}).call(this);