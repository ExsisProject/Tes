(function(){define(["jquery","backbone","app","community/models/community_info","community/collections/community_boards","hgn!board/templates/mobile/m_side","i18n!board/nls/board","i18n!nls/commons"],function(e,t,n,r,i,s,o,u){var a=t.View.extend({id:"communitySideMenu",unBindEvent:function(){this.$el.off("vclick","h3"),this.$el.off("vclick","a[data-navigate]")},bindEvent:function(){this.$el.on("vclick","h3",e.proxy(this.goCommunityHome,this)),this.$el.on("vclick","a[data-navigate]",e.proxy(this.goBoard,this))},initialize:function(e){this.options=e||{};var t=this;this.collection=new i,this.collection.status="active",this.collection.on("reset",function(e,n){t.renderBoardsList()})},render:function(t){var n=this;this.packageName=this.options.packageName;var i=e.Deferred();return this.communityId!=t.communityId?(this.communityId=t.communityId,this.model=r.read({communityId:this.communityId}),this.collection.communityId=this.communityId,this.collection.fetch({data:{offset:100,page:0},reset:!0}).done(function(){i.resolveWith(n,[n])}),this.setSideApp()):i.resolveWith(this,[this]),this.unBindEvent(),this.bindEvent(),i},renderBoardsList:function(){var t=[];e(this.collection.toJSON()).each(function(e,n){n.type=="BOARD"&&t.push({iconCls:function(){return this.boardType=="CLASSIC"?"ic_classic":"ic_feed"},name:n.board.name,publicFlag:n.board.publicFlag,navigate:"community/"+this.communityId+"/board/"+n.board.id,boardType:n.boardType})}),this.$el.html(s({title:this.model.get("name"),menus:t,"hasMenu?":function(){return t.length>0}}))},setSideApp:function(){e("body").data("sideApp",this.packageName)},goCommunityHome:function(t){return e(t).focusout().blur(),n.router.navigate("community/"+this.communityId,!0),!1},goBoard:function(t){var r=e(t.currentTarget),i=r.attr("data-navigate");return i&&n.router.navigate(i,!0),!1}},{__instance__:null,create:function(e){return this.__instance__=new this.prototype.constructor({packageName:e}),this.__instance__}});return a})}).call(this);