(function(){define(["jquery","backbone","app","views/mobile/title_toolbar","community/collections/community_list","hgn!community/templates/mobile/m_community_user","i18n!nls/commons","i18n!community/nls/community","jquery.go-grid"],function(e,t,n,r,i,s,o,u){var a={joincommunity:u["\uac00\uc785 \ucee4\ubba4\ub2c8\ud2f0"],member_wait:u["\uac00\uc785\ub300\uae30"],community:o["\ucee4\ubba4\ub2c8\ud2f0"],all_post:u["\uc804\uccb4 \uae00 0\uac74"],join_community_null:u["\uac00\uc785\ub41c \ucee4\ubba4\ub2c8\ud2f0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],move_to_home:o["\ud648\uc73c\ub85c \uc774\ub3d9"]},f=t.View.extend({events:{"vclick .list_comm_joinlist li>a":"goCommunity","vclick a[data-btn=paging]":"goPaging"},initialize:function(){var e=this;GO.util.appLoading(!0),this.baseTpl=['<div class="content"><ul class="list_normal list_single  list_comm_joinlist"></ul></div>'],this.$listEl=null,this.offset=GO.config("mobileListOffset")||20,this.titleToolbarView=r,this.collectionClone=null,this.collection=new i,this.collection.type="joined",this.collection.on("reset",function(t,n){e.renderJoindList();var r=GO.util.mPaging(t);e.$listEl.after(r),GO.util.appLoading(!1)})},render:function(){return GO.util.pageDone(),this.titleToolbarView.render({isPrev:!0,prevCallback:function(){return GO.EventEmitter.trigger("common","goHome"),!1},contentEl:this.$el,name:a.joincommunity}),this.$el.html(this.baseTpl),this.$listEl=this.$el.find("ul"),this.getJoindList(0),this.el},goPaging:function(t){GO.EventEmitter.trigger("common","layout:scrollToTop",this),t.stopPropagation();var n=e(t.currentTarget).attr("data-direction"),r=this.collection.page.page||0;return n=="prev"&&r>0?r--:n=="next"&&r++,e(t.currentTarget).parents(".paging").remove(),this.$listEl.empty(),this.getJoindList(r),!1},goCommunity:function(t){var r=e(t.currentTarget).attr("data-id"),i=this.collectionClone.get(r);!i.get("publicFlag")&&i.get("memberStatus")=="WAIT"?alert(u["\uc544\uc9c1 \uac00\uc785\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]+"\n"+u["\ucee4\ubba4\ub2c8\ud2f0 \uad00\ub9ac\uc790\uc758 \uc2b9\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."]):n.router.navigate("community/"+r,!0)},getJoindList:function(e){var t={offset:this.offset,property:"createdAt",direction:"desc"};if(e==="more"){if(this.collection.page.lastPage==1)return!1;t.page=parseInt(this.collection.page.page+1,10)||0}else t.page=e||0;this.collection.fetch({data:t,reset:!0})},renderJoindList:function(){var e=this.collection.page,t=this.collection.toJSON(),r=s({lang:a,isWait:function(){return this.memberStatus=="WAIT"},hasNewPost:function(){return this.newPostCount>0},communityPostCount:function(){return n.i18n(a.all_post,"count",this.postCount)},data:t});e.page==0?t.length>0?(this.$listEl.html(r),this.collectionClone=this.collection.clone()):this.$listEl.html(r):(this.$listEl.append(r),this.collectionClone.add(this.collection.toJSON())),e.lastPage?this.$el.find("#pullUp").hide():this.$el.find("#pullUp").show()}},{__instance__:null,create:function(){return this.__instance__=new this.prototype.constructor({el:e("#content")}),this.__instance__},render:function(){var e=this.create(),t=arguments.length>0?Array.prototype.slice.call(arguments):[];return this.prototype.render.apply(e,t)}});return f})}).call(this);