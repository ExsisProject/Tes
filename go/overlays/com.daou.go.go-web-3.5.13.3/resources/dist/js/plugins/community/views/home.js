(function(){define(["app","community/models/info","community/collections/posts","hgn!community/templates/home","hgn!community/templates/home_more","i18n!nls/commons","board/views/board_title","i18n!board/nls/board","i18n!community/nls/community","GO.util"],function(e,t,n,r,i,s,o,u,a){var f=null,l={board:s["\uac8c\uc2dc\ud310"],community:a["\ucee4\ubba4\ub2c8\ud2f0 \uae00"],detail_search:s["\uc0c1\uc138\uac80\uc0c9"],detail_view:s["\uc790\uc138\ud788 \ubcf4\uae30"],more_view:u["\ub354 \ubcf4\uae30"],search:s["\uac80\uc0c9"],search_result:s["\uac80\uc0c9\uacb0\uacfc"],total:u["\ucd1d"],count:u["\uac74"],not_list:u["\uc758 \ucee4\ubba4\ub2c8\ud2f0 \ub4f1\ub85d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \n\uac8c\uc2dc\ud310\uc744 \uc0dd\uc131\ud558\uc5ec, \uae00\uc744 \ub4f1\ub85d \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."],new_board:u["\uac8c\uc2dc\ud310 \ub9cc\ub4e4\uae30"],new_post:u["\uc0c8 \uae00 \uc791\uc131\ud558\uae30"],new_post_desc:u["\uc544\uc9c1 \ub4f1\ub85d\ub41c \uae00\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uc544\ub798 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc5ec, \uae00\uc744 \ub4f1\ub85d\ud574 \uc8fc\uc138\uc694."],no_auth:u["\uc5f4\ub78c\uad8c\ud55c\uc774 \uc5c6\ub294 \uac8c\uc2dc\ubb3c\uc785\ub2c8\ub2e4."],new_post_null:a["\ucee4\ubba4\ub2c8\ud2f0\uc5d0 \uac8c\uc2dc\ubb3c\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]},c=Backbone.View.extend({el:"#content",manage:!1,events:{"click #homeListCreateBoardBtn":"createBoard","click #homeListCreatePostBtn":"createPost","click ul.home_list li":"moveDetail","click .board_link":"moveBoard","click span.photo a, a.name":"showProfileCard"},initialize:function(e){this.$el.off(),this.options=e||{},this.communityId=this.options.communityId},createBoard:function(){e.router.navigate("community/"+this.communityId+"/board/create",!0)},createPost:function(){e.router.navigate("community/"+this.communityId+"/board/post/write",!0)},moveDetail:function(t){var n=$(t.currentTarget),r=n.attr("data-boardType"),i=n.attr("data-boardId"),s=n.attr("data-postId"),o=n.attr("data-hidden"),a=n.attr("data-communityId");if(o=="true"){alert(u["\uac8c\uc2dc\uae00 \uc5f4\ub78c\ubd88\uac00 \uba54\uc138\uc9c0"]);return}r=="CLASSIC"?e.router.navigate("community/"+a+"/board/"+i+"/post/"+s,!0):r=="STREAM"?e.router.navigate("community/"+a+"/board/"+i+"/post/"+s+"/stream",!0):e.router.navigate("community/"+a+"/board/"+i,!0)},moveBoard:function(t){var n=$(t.currentTarget).parents("li:first"),r=n.attr("data-communityid"),i=n.attr("data-boardid");e.router.navigate("community/"+r+"/board/"+i,!0),t.stopPropagation()},render:function(e){var t=this;$(window).unbind("scroll.community"),$(window).bind("scroll.community",function(e){d_height=$(document).height(),w_height=$(window).height(),s_height=d_height-w_height,d_top=$(document).scrollTop(),s_height-d_top<2&&t.$el.find("div.bottom_action").is(":visible")&&t.listMore()}),this.collection=n.getCollection({communityId:this.communityId,page:0,offset:"15"});var r=t.makeTemplete({dataSet:this.collection.toJSON()});this.$el.html(r),o.render({el:".content_top",dataset:{name:l.community},isCommunity:!0}),this.moreBtnHide(this.collection)},moreBtnHide:function(){if(this.collection.length==0){$("#moreButton").hide();return}var e=this.collection.page.lastPage;e?$("#moreButton").hide():$("#moreButton").show()},listMore:function(){var e=this,t=parseInt(this.collection.page.page)+1;this.collection=n.getCollection({communityId:this.communityId,page:t,offset:"15"});var r=e.makeTemplete({dataSet:this.collection.toJSON(),type:"more"});this.$el.find("ul.article_list").append(r),this.moreBtnHide(this.collection)},makeTemplete:function(e){var n=t.read({communityId:this.communityId}),s=e.type,o,u=function(){return this.type=="CLASSIC"?"classic":"feed"},a=function(){return parseInt(this.recommendCount)==0?"zero":""},f=function(e){return GO.util.snsDate(this.createdAt)},c=function(){var e=this.type;return e=="CLASSIC"?!0:!1},h=function(){return GO.util.textToHtml($.goValidation.charEllipsis(GO.util.convertMSWordTag(this.summary),40))},p=function(){return this.hiddenPost},d=function(){return this.summary==" $$#HIDDEN_POST#$$ "},v=function(){return n.toJSON().memberStatus=="ONLINE"?!0:!1};return s?o=i({dataSet:this.collection.toJSON(),isZero:a,contentParse:h,dateParse:f,isClassic:c,lang:l,isPostHidden:p,isTitleHidden:d,community:n.toJSON(),isCommunityMember:v,boardType:u}):o=r({dataSet:this.collection.toJSON(),isZero:a,contentParse:h,dateParse:f,isClassic:c,lang:l,isPostHidden:p,isTitleHidden:d,community:n.toJSON(),isCommunityMember:v,hasBoard:n.get("boardCount")>0,boardType:u}),o}});return{render:function(e){return f=new c({communityId:e,page:0,offset:30}),f.render()}}})}).call(this);