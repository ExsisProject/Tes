(function(){define(["backbone","app","board/views/board_title","hgn!community/templates/board_closed","i18n!board/nls/board","i18n!nls/commons","jquery.go-grid","GO.util"],function(e,t,n,r,i,s){var o={title:i["\uc911\uc9c0\ub41c \uac8c\uc2dc\ud310 \uad00\ub9ac"],name:s["\uac8c\uc2dc\ud310"],board_term:i["\uac8c\uc2dc \uae30\uac04"],empty_data:i["\uc911\uc9c0\ub41c \uac8c\uc2dc\ud310\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],remove:s["\uc0ad\uc81c"],change_status_normal:s["\uc815\uc0c1 \uc0c1\ud0dc\ub85c \ubcc0\uacbd"],not_select_board:i["\uac8c\uc2dc\ud310\uc744 \uc120\ud0dd\ud574 \uc8fc\uc138\uc694."],delete_success:s["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],delete_confirm:i["\uac8c\uc2dc\ud310 \uc0ad\uc81c \ud655\uc778"],change_success:s["\ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],dept_name:i["\ubd80\uc11c\uba85"],post_count:i["\uac8c\uc2dc\uae00 \uc218"],normal_confirm:i["\uc815\uc0c1\uc73c\ub85c \ubcc0\uacbd \uc54c\ub9bc"]},u=e.View.extend({events:{"click a.remove":"remove","click a.active":"active","click #checkedAll":"checkAll"},initialize:function(e){this.closeBoardList=null,this.options=e||{}},render:function(){return this.$el.html(r({lang:o})),n.render({el:".content_top",dataset:{name:o.title}}),this.makeGrid(this.options.communityId),this},checkAll:function(e){var t=$(e.currentTarget).is(":checked");$("input[type=checkbox][data-row]").attr("checked",t)},makeGrid:function(e){var n=this,r=$.goGrid({el:"#folders_table",method:"GET",destroy:!0,url:t.contextRoot+"api/community/"+e+"/boards/closed",params:this.searchParams,emptyMessage:"<p class='data_null'> <span class='ic_data_type ic_no_data'></span><span class='txt'>"+o.empty_data+"</span>"+"</p>",defaultSorting:[[1,"asc"]],columns:[{mData:null,sWidth:"53px",bSortable:!1,fnRender:function(e){var t=e.aData.actions.managable;return t?"<input type='checkbox' value='"+e.aData.id+"' data-row='"+e.iDataRow+"'></input>":""}},{mData:null,sWidth:"170px",bSortable:!1,fnRender:function(e){return t.util.customDate(e.aData.createdAt,"YYYY-MM-DD")+" ~ "+t.util.customDate(e.aData.closedAt,"YYYY-MM-DD")}},{mData:null,sWidth:"200px",bSortable:!1,sClass:"name",fnRender:function(t){return"<span data-communityid='"+e+"' data-boardid='"+t.aData.board.id+"'>"+t.aData.board.name+"</span>"}},{mData:null,sWidth:"70px",bSortable:!1,fnRender:function(e){return e.aData.board.postCount}}],fnDrawCallback:function(e,r,i){var s=n.$("input[type=checkbox][data-row]").length>0;n.$el.find(".custom_header").append(n.$el.find("#controlButtons").show()),n.$el.find("#checkedAll").attr("checked",!1),s||(n.$("#checkedAll").hide(),n.$("#controlButtons").hide()),n.$el.find(this.el+" tr>td.name").css("cursor","pointer").click(function(e){var n=$(e.currentTarget).find("span");t.router.navigate("community/"+n.attr("data-communityid")+"/board/"+n.attr("data-boardid"),{trigger:!0})})}});this.closeBoardList=r.tables},getBoardIds:function(){console.log("getboardIds"),console.log(this.closeBoardList);var e=this.closeBoardList.getCheckedData();console.log(e);var t=[];return $.each(e,function(e,n){t.push(n.board.id)}),t},active:function(){var e=this,n=this.getBoardIds();if(n.length==0){$.goMessage(o.not_select_board);return}$.goConfirm(o.change_status_normal,o.normal_confirm,function(){$.ajax({type:"PUT",async:!0,data:JSON.stringify({ids:n}),dataType:"json",contentType:"application/json",url:t.config("contextRoot")+"api/board/status/active"}).done(function(n){$.goMessage(o.change_success),t.EventEmitter.trigger("community","changed:sideCommunityBoard",e.options.communityId),e.render(),e.closeBoardList.fnClearTable()})})},remove:function(){var e=this,n=this.getBoardIds();if(n.length==0){$.goMessage(o.not_select_board);return}$.goConfirm(o.name+" "+o.remove,o.delete_confirm,function(){$.ajax({type:"DELETE",async:!0,data:JSON.stringify({ids:n}),dataType:"json",contentType:"application/json",url:t.config("contextRoot")+"api/board/status/deleted"}).done(function(n){$.goMessage(o.delete_success),t.EventEmitter.trigger("community","changed:sideCommunityBoard",e.options.communityId),e.render(),e.closeBoardList.fnClearTable()})})}});return u})})();