(function(){define(["jquery","underscore","hgn!asset/templates/asset_loop_popup","i18n!nls/commons","i18n!calendar/nls/calendar","i18n!asset/nls/asset","jquery.go-popup"],function(e,t,n,r,i,s){var o=function(){var i=function(e,r,i){if(!t.contains(["remove","update"],r))throw new Error("\uc798\ubabb\ub41c \uc778\uc790\uc785\ub2c8\ub2e4.");this.model=e,this.isRecurrence=this.model.get("recurrence"),this.type=r,this.data=i,this.callbacks={},this.template=n({"recurrence?":this.isRecurrence,"remove?":this.isRemoveType(),"update?":this.isUpdateType(),recurrence_notice:s["\ud604\uc7ac '\ubc18\ubcf5 \uc608\uc57d'\uc73c\ub85c \ub4f1\ub85d\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."],remove_desc:s["\uc608\uc57d\uc744 \ucde8\uc18c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \ucde8\uc18c\ud55c \uc608\uc57d\uc740 \ubcf5\uad6c\uac00 \ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4"],label:{remove_only:s["\uc774 \uc608\uc57d\ub9cc \uc218\uc815"],remove_after:s["\uc774 \uc608\uc57d\ubd80\ud130 \uc774\ud6c4 \uc608\uc57d \ubaa8\ub450 \uc218\uc815"],remove_all:s["\uc804\uccb4 \uc608\uc57d \uc218\uc815"]}})};return i.prototype={render:function(){var t={remove:"layer_schedule_del",update:"layer_schedule_repeat"}[this.type],n={remove:s["\uc608\uc57d \ucde8\uc18c"],update:s["\uc608\uc57d \uc218\uc815"]}[this.type];this.popupEl=e.goPopup({pclass:"layer_normal "+t,width:-1,header:n,contents:this.template,closeCallback:e.proxy(this._close,this),buttons:[{btype:"confirm",btext:r["\ud655\uc778"],callback:e.proxy(this._confirm,this),autoclose:!1},{btype:"cancel",btext:r["\ucde8\uc18c"],callback:e.proxy(this._cancel,this)}]})},setCallbacks:function(t){e.extend(!0,this.callbacks,t||{})},isRemoveType:function(){return this.type==="remove"},isUpdateType:function(){return this.type==="update"},_confirm:function(){this.isRemoveType()?this.reservationDeleteAction():this.reservationUpdateAction()},_cancel:function(){this.callbacks.hasOwnProperty("complete")&&this.callbacks.complete.call(this)},reservationDeleteAction:function(){var t=this,n=GO.contextRoot+"api/asset/item/loop/reservation?"+e.param({reservationId:this.model.attributes.reservationId,recurChange:e(this.popupEl).find("input[name=remove_option]:checked").val()});e.ajax(n,{type:"DELETE",success:function(){t.popupEl.close(),GO.router.navigate("asset/"+t.model.attributes.assetId+"/list/reservation",!0)}})},reservationUpdateAction:function(){var t=this,n=GO.contextRoot+"api/asset/item/loop/reservation?"+e.param({reservationId:this.model.attributes.reservationId,recurChange:e(this.popupEl).find("input[name=remove_option]:checked").val()});e.ajax(n,{type:"PUT",data:JSON.stringify(this.data),dataType:"json",contentType:"application/json",success:function(){t.popupEl.close(),GO.router.navigate("asset/"+t.model.attributes.assetId+"/list/reservation",!0)},error:function(){e.goError(s["\uc608\uc57d\ud558\ub824\ub294 \uc2dc\uac04\ub300\uc5d0 \uc774\ubbf8 \uc608\uc57d\ub41c \uac74\uc774 \ud3ec\ud568\ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4."])}})}},i}();return o})}).call(this);