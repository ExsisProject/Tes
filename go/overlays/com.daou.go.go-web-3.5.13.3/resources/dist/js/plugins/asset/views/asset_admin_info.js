define(["jquery","backbone","app","hgn!asset/templates/asset_admin_info","asset/collections/asset_admin","asset/models/asset_admin","i18n!nls/commons","i18n!asset/nls/asset"],function(e,t,n,r,i,s,o,u){var a={info:u["\uc790\uc0b0\uc5d0 \ub300\ud55c \ucd94\uac00 \uc815\ubcf4\ub780"],field_name:u["\ud544\ub4dc\uba85"],show_user:u["\uc774\uc6a9\uc790\uc5d0\uac8c \ubcf4\uc774\uae30"],"delete":o["\uc0ad\uc81c"],code:u["\ucf54\ub4dc"],no_delete:u["\uc0ad\uc81c\ubd88\uac00"],name:u["\ud56d\ubaa9\uba85"],add:u["\ucd94\uac00\ud558\uae30"],ok:o["\ud655\uc778"],cancel:o["\ucde8\uc18c"],success:u["\uc131\uacf5\ud588\uc2b5\ub2c8\ub2e4."],alert_input:u["\ud544\ub4dc\uba85\uc744 \uc785\ub825\ud558\uc138\uc694."],save_ok:o["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]},f=null,l=t.View.extend({el:"#assetAdminPart",unbindEvent:function(){this.$el.off("click","a[data-btntype='attrAdd']"),this.$el.off("click","span[data-btntype='attrDel']"),this.$el.off("click","span[data-btntype='infoSubmit']"),this.$el.off("click","span[data-btntype='infoCancel']")},bindEvent:function(){this.$el.on("click","a[data-btntype='attrAdd']",e.proxy(this.attrAdd,this)),this.$el.on("click","span[data-btntype='attrDel']",e.proxy(this.attrDel,this)),this.$el.on("click","span[data-btntype='infoSubmit']",e.proxy(this.saveAdminInfo,this)),this.$el.on("click","span[data-btntype='infoCancel']",e.proxy(this.infoCancel,this))},initialize:function(){},attrDel:function(t){var n=e(t.currentTarget);n.parents("tr").first().remove()},attrAdd:function(){var e='<tr class="attribute" data-assetid=""><td><input type="text" class="txt"/></td><td><input type="checkbox" checked="checked" class="visibleCheck"></td><td><span class="ic_side ic_basket_bx" title="\uc0ad\uc81c" data-btntype="attrDel"></span></td></tr>';this.$el.find("#infoTbody").append(e)},infoCancel:function(){this.render({assetId:this.assetId})},saveAdminInfo:function(){var t=this,n={useCodeVisibility:e("#useCodeVisibility").is(":checked")},r=[],i=e("#infoTbody").find("tr.attribute"),o=!1;i.each(function(){var t=e(this).find("input.txt").val();e.trim(t)==""&&(o=!0)});if(o){e.goMessage(a.alert_input);return}i.each(function(){var t={};t.id=e(this).attr("data-attrid"),t.name=e.trim(e(this).find("input.txt").val()),t.visibility=e(this).find("input.visibleCheck").is(":checked"),r.push(t)}),n.attributes=r,this.assetModel=new s,this.assetModel.set({id:this.assetId,assetId:this.assetId,urlPart:"attribute/item"}),this.assetModel.save(n,{success:function(n,r){e.goMessage(a.save_ok),t.render({assetId:t.assetId})}})},render:function(e){this.assetId=e.assetId;var t=this;this.unbindEvent(),this.bindEvent();var n=i.getCollection({assetId:this.assetId,type:"info"});n.on("reset",function(e,n){var r=t.makeTemplete({collection:e.toJSON()});t.$el.html(r)})},makeTemplete:function(e){var t=e.collection,n=r({dataset:t,lang:a});return n}},{create:function(e){return f=new l,f.render(e)}});return{render:function(e){var t=l.create(e);return t}}});