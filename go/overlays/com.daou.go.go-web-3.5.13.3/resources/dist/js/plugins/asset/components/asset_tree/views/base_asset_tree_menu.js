define("asset/components/asset_tree/views/base_asset_tree_menu",function(require){var e=require("app"),t=require("asset/components/asset_tree/views/base_asset_tree");require("jquery.go-popup");var n=t.extend({menuId:null,storeKey:null,initialize:function(e){var n=e||{};t.prototype.initialize.apply(this,arguments),this.menuId=null,n.hasOwnProperty("menuId")&&this.setMenuId(n.menuId)},renderChildView:function(e){var t=new this.constructor({nodes:this.assetTreeNodes,parentId:e.getNodeId(),menuId:this.menuId});return t.render(),t},setMenuId:function(e){this.menuId=e},getMenuId:function(){return this.menuId},isClosedNode:function(e){return e.find("span.btnToggleNode").hasClass("open")},foldNode:function(e){var t=e.data("id");e.find(".board-tree-nodes").remove(),e.find(".btnToggleNode:first").removeClass("close").addClass("open"),this._addClosedNode(parseInt(e.data("id")))},unfoldNode:function(e){console.debug("[board] BaseBoardTreeView: unfoldNode call"),e.find(".btnToggleNode:first").removeClass("open").addClass("close"),this._removeClosedNode(parseInt(e.data("id")))},toggleNode:function(e){var t=parseInt(e.data("id")),n=this.assetTreeNodes.get(t);if(!n)return;this.isClosedNode(e)?this.unfoldNode(e):this.foldNode(e)},_addClosedNode:function(e){var t=this._getStoredClosedNodes();_.indexOf(t,parseInt(e))<0&&(t.push(e),this._storeNodeClosedState(t))},_removeClosedNode:function(e){var t=this._getStoredClosedNodes(),n=_.indexOf(t,parseInt(e));n>-1&&(t.splice(n,1),this._storeNodeClosedState(t))},_getStoreKey:function(){if(this.menuId===null)return;return e.session("loginId")+".board.side."+this.menuId+".closedNodes"},_getStoredClosedNodes:function(){var t=e.util.store.get(this._getStoreKey());return!this.getMenuId()||!t?[]:(_.isArray(t)||(t=[t]),t)},_storeNodeClosedState:function(t){var n=this._getStoreKey();n&&e.util.store.set(n,t)}});return n});