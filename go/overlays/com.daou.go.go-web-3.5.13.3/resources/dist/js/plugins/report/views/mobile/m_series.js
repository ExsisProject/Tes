(function(){define(["jquery","backbone","app","hogan","i18n!report/nls/report","i18n!nls/commons","views/mobile/header_toolbar","hgn!report/templates/mobile/m_series","text!report/templates/mobile/m_series_card.html","report/models/series_report","report/models/report_folder","GO.util","GO.m.util"],function(e,t,n,r,i,s,o,u,a,f,l){var c={list:s["\ubaa9\ub85d"],series_comment:i["\ud68c\ucc28 \ub313\uae00"],exclude_reporters:i["\uc81c\uc678\ub41c \ubcf4\uace0\uc790"],undone:i["\ubbf8\ubcf4\uace0"],done:i["\ubcf4\uace0"],write:i["\ubcf4\uace0 \uc791\uc131"]},h=t.View.extend({el:"#content",events:{"vclick div.tool_bar a.list":"list","vclick div.tool_bar a.comment":"comment","vclick div.dones section.clickable":"show","vclick section a.btn_report_write_s":"write"},initialize:function(e){this.options=e||{};var t=this.options.seriesId;this.model=f.get(t),this.folder=(new l).set(this.model.get("folder")),this.$el.off(),this.headerBindEvent()},headerBindEvent:function(){n.EventEmitter.off("trigger-action"),n.EventEmitter.on("trigger-action","series-comment",this.comment,this)},render:function(){var e=this,t=n.session(),r={title:this.folder.get("name"),isPrev:!0,actionMenu:[{id:"series-comment",text:i["\ud68c\ucc28 \ub313\uae00"],cls:"btn_comments",triggerFunc:"series-comment",commentsCount:this.model.toJSON().commentCount}]};return this.model.isUndoneReporter(t.id)&&(r.isWriteBtn=!0,r.writeBtnCallback=function(){e.write()}),o.render(r),this.$el.addClass("report"),this.makeContent(),this.$el},makeContent:function(){this.$el.html(u({data:e.extend({},this.model.toJSON(),{createdAtBasicDate:n.util.basicDate(this.model.get("createdAt")),excludeReporters:this.model.excludeReportsStr(),isCommentCountZero:function(){return this.commentCount==0?!0:!1}}),lang:c},{seriesReporterCard:a}))},reload:function(){this.model.fetch(),this.folder=(new l).set(this.model.get("folder")),this.makeContent()},makeTitleOption:function(){var t=this,r={name:this.folder.get("name"),isIscroll:!1,isPrev:!0,refreshButton:{callback:e.proxy(t.reload,t)}},t=this,i=n.session();return this.model.isUndoneReporter(i.id)&&(r.rightButton={text:c.write,callback:e.proxy(t.write,t)}),r},list:function(){var e="report/folder/"+this.folder.get("id")+"/reports";return n.router.navigate(e,!0),!1},comment:function(){var e="/report/series/"+this.model.get("id")+"/comments";n.router.navigate(e,{trigger:!0})},show:function(t){var r=e(t.currentTarget).attr("data-id"),i="/report/series/"+this.model.get("id")+"/report/"+r;n.router.navigate(i,{trigger:!0})},write:function(){var e=this.model.findReporterByUserId(n.session().id),t="report/series/"+this.model.get("id")+"/report/"+e.user.reportId+"/form";n.router.navigate(t,{trigger:!0})}},{__instance__:null,create:function(e){return this.__instance__=new this.prototype.constructor({packageName:e}),this.__instance__}});return h})}).call(this);