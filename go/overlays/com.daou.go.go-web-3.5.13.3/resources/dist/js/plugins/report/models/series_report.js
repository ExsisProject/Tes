define(["underscore","backbone","i18n!report/nls/report","GO.util"],function(e,t,n){var r=t.Model.extend({urlRoot:GO.contextRoot+"api/report/series/",closedAtBasicDate2:function(){return GO.util.basicDate2(this.get("closedAt"))},excludeReportsStr:function(){var e=[];return this.hasExcludeReport()?($.each(this.get("exclusion"),function(t,n){e.push(n.name+" "+n.position)}),e.join(", ")):n["\uc5c6\uc74c"]},hasExcludeReport:function(){return this.get("exclusion").length>0},changeStatus:function(e,t){var n=this.findReporterByUserId(e);return n.status!=t&&(this.get(t).push(n.user),this.get(n.status).splice(n.index,1),t=="dones"?this.setDoneClickable(n.user):this.setUndoneClickable(n.user)),n.status=t,n},isUndoneReporter:function(e){var t=!1;return $.each(this.get("undones"),function(n,r){if(r.id==e)return t=!0,!1}),t},isExistReport:function(t){var n=["dones","undones","exclusion"],r=!1;return e.each(n,function(n){e.each(this.get(n),function(e){if(e.reportId==t)return r=!0,!1},this);if(r)return!1},this),r},findReporterByUserId:function(e,t){var n=[],r={status:"",user:{},index:""},i=this,s=!1;return t==undefined?n=["dones","undones","exclusion"]:n=[t],$.each(n,function(t,n){$.each(i.get(n),function(t,i){if(i.id==e)return r.status=n,r.user=i,r.index=t,s=!0,!1});if(s)return!1}),r},isDoneClickable:function(e){return e.readable==1},isUndoneClickable:function(e){return e.writable==1},setDonesClickable:function(){var e=this;$.each(this.get("dones"),function(t,n){$.proxy(e.setDoneClickable(n),e)})},setDoneClickable:function(e){return e.isCommentCountShow=!0,e.isWritable=!1,e.isNewReport=!1,GO.util.calDate(e.submittedAt,"hours",24)>GO.util.toISO8601(new Date)&&(e.isNewReport=!0),this.isDoneClickable(e.actions)?e.isClickable=!0:e.isPrivateShow=!0,e},setUndonesClickable:function(){var e=this;$.each(this.get("undones"),function(t,n){e.setUndoneClickable.call(e,n)})},setUndoneClickable:function(e){return e.isCommentCountShow=!1,e.isWritable=!1,this.isUndoneClickable(e.actions)&&this.get("folder").status=="ACTIVE"&&(e.isClickable=!0,e.isWritable=!0),e},getCompleteCount:function(){return this.get("dones").length},getIncompleteCount:function(){return this.get("undones").length},getCompleteUserName:function(){var e=[];return $.each(this.get("dones"),function(){e.push(this.name+" "+this.position)}),e.join(", ")},getIncompleteUserName:function(){var e=[];return $.each(this.get("undones"),function(){e.push(this.name+" "+this.position)}),e.join(", ")},isActive:function(){return this.get("folder").status=="ACTIVE"},isInactive:function(){return this.get("folder").status=="INACTIVE"},getSeriesStr:function(){var e=GO.util.parseOrdinaryNumber(this.get("series"),GO.config("locale"));return GO.i18n(n["\uc81c {{arg1}}\ud68c\ucc28"],{arg1:e})}},{get:function(e){var t=new r;return t.set({id:e},{silent:!0}),t.fetch({async:!1,error:function(e,t){if(GO.util.isMobile())GO.util.linkToErrorPage(t);else{var n=JSON.parse(t.responseText);GO.util.error(n.code,n.code==="500"?{}:{msgCode:"400-report"})}}}),t.setDonesClickable(),t.setUndonesClickable(),t}});return r});