(function(){define(["jquery","backbone","app","views/mobile/header_toolbar","report/collections/report_search","hgn!report/templates/mobile/m_report_result","hgn!report/templates/mobile/m_report_result_item","i18n!nls/commons","i18n!report/nls/report","jquery.go-sdk","GO.util"],function(e,t,n,r,i,s,o,u,a){var f={search_result:u["\uac80\uc0c9\uacb0\uacfc"],search_empty:u["\uac80\uc0c9\uacb0\uacfc\uc5c6\uc74c"]},l=t.View.extend({el:"#content",events:{"vclick a[data-btn='paging']":"goPaging","vclick #result_list li.search_result":"moveReport"},initialize:function(){this.collection=null,this.offset=n.config("mobileListOffset")||20,this.$listEl=null},goPaging:function(t){n.EventEmitter.trigger("common","layout:scrollToTop",this),t.stopPropagation();var r=e(t.currentTarget).attr("data-direction"),i=this.collection.page.page||0;r=="prev"&&i>0?i--:r=="next"&&i++,e(t.currentTarget).parents(".paging").remove();var s={page:i,offset:this.offset,stype:this.stype,keyword:this.keyword,fromDate:this.fromDate,toDate:this.toDate};this.collection.fetch({async:!1,data:s,reset:!0}),this.$el.find("#result_list").html(this.makeResultItems());var o=n.util.mPaging(this.collection);this.$el.find("#result_list").append(o),n.util.appLoading(!1)},render:function(){var e=this;n.util.appLoading(!0),r.render({isClose:!0,title:f.search_result});var t=n.router.getSearch(),o={stype:t.stype,keyword:t.keyword,fromDate:t.fromDate,toDate:t.toDate,page:n.router.getSearch("page")||0,offset:this.offset,properties:t.properties};this.collection=i.searchCollection(o,t.isCommunity,!0),this.$el.html(s({keyword:t.keyword,data:this.collection.toJSON(),resultItems:this.makeResultItems(),lang:f})),this.$el.addClass("report");var u=n.util.mPaging(this.collection);this.$el.find("#result_list").append(u),n.util.appLoading(!1)},makeResultItems:function(){var t=[];return this.collection.length==0?(t.push("<li class='creat data_null'>"),t.push("<span class='txt'>"+f.search_empty+"</span>"),t.push("</li>")):this.collection.each(function(r,i){var s=o({data:e.extend({},r.toJSON(),{submittedAt:n.util.basicDate3(r.get("submittedAt"))}),makeTitle:function(){if(this.folderType=="PERIODIC"){var e=n.util.parseOrdinaryNumber(this.seriesNo,n.config("locale"));return this.folderDeptName+" "+n.i18n(a["\uc81c {{arg1}}\ud68c\ucc28"],{arg1:e})}return this.title}});t.push(s)}),t.join("")},moveReport:function(t){var r=e(t.target),i=r.parents("li.search_result"),s=i.attr("data-report-id"),o=i.attr("data-series-id"),u=i.attr("data-folder-id"),a=i.attr("data-report-type"),f="";a=="PERIODIC"?f="report/series/"+o+"/report/"+s:f="report/folder/"+u+"/report/"+s,n.router.navigate(f,{trigger:!0})}});return l})}).call(this);