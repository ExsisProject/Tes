(function(){define(["jquery","underscore","backbone","app","i18n!nls/commons","i18n!report/nls/report","models/dept_profile","report/views/report_title","hgn!report/templates/dept_close_folders","GO.util","jquery.go-grid","jquery.go-popup","jquery.go-preloader"],function(e,t,n,r,i,s,o,u,a){function c(e,t,n){}var f={remove:i["\uc0ad\uc81c"],change_status_normal:s["\uc815\uc0c1 \uc0c1\ud0dc\ub85c \ubcc0\uacbd"],report_term:s["\ubcf4\uace0 \uae30\uac04"],report_name:s["\ubcf4\uace0\uc11c \uc81c\ubaa9"],empty_data:s["\uc911\uc9c0\ub41c \ubcf4\uace0\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],title:s["\uc911\uc9c0\ub41c \ubcf4\uace0\uc11c \uad00\ub9ac"],remove_report:s["\ubcf4\uace0\uc11c \uc0ad\uc81c"],select_alert:s["\uc120\ud0dd\ub41c \ubcf4\uace0\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],remove_desc:s["\uc120\ud0dd\ud55c \ubcf4\uace0\uc11c\ub97c \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],remove_report:s["\ubcf4\uace0\uc11c \uc0ad\uc81c"],normal_desc:s["\uc120\ud0dd\ud55c \ubcf4\uace0\uc11c\uc758 \uc0c1\ud0dc\ub97c '\uc815\uc0c1'\uc73c\ub85c \ubcc0\uacbd\ud569\ub2c8\ub2e4.\ubcc0\uacbd \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],department_name:i["\ubd80\uc11c\uba85"],remove_success:i["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]},l=n.View.extend({el:"#content",events:{"click #controlButtons a.remove":"remove","click #controlButtons a.active":"changeActive","click #checkAll":"toggleCheckbox"},initialize:function(t){this.options=t||{},this.$el.off(),e("#side").trigger("set:leftMenu","closed_folder")},render:function(){var t=this;return this.$el.html(a({lang:f})),this.dataTable=e.goGrid({el:"#folders_table",method:"GET",url:r.contextRoot+"api/report/folder/status/inactive",emptyMessage:"<p class='data_null'> <span class='ic_data_type ic_no_data'></span><span class='txt'>"+f.empty_data+"</span>"+"</p>",defaultSorting:[],sDomUse:!0,params:{property:"closedAt",direction:"asc"},columns:[{mData:null,sWidth:"40px",bSortable:!1,fnRender:function(e){var t=e.aData,n=t.actions.managable;return n?"<input type='checkbox' value='"+t.id+"' >":"<input type='checkbox' disabled='true'>"}},{mData:null,bSortable:!1,sClass:"period",sWidth:"180px",fnRender:function(e){var t=e.aData;return t.department.name}},{mData:"createdAt",bSortable:!1,sClass:"period",sWidth:"220px",fnRender:function(e){var t=e.aData;return r.util.customDate(t.createdAt,"YYYY-MM-DD")+" ~ "+r.util.customDate(t.closedAt,"YYYY-MM-DD")}},{mData:"name",bSortable:!1,sClass:"subject",sWidth:"1000px",fnRender:function(e){var t=e.aData;return"<span data-id='"+t.id+"'>"+t.name+"</span>"}}],fnDrawCallback:function(n){t.$el.find(".tool_bar .custom_header").append(t.$el.find("#controlButtons").show()),t.$el.find("tr>td.subject span").css("cursor","pointer").click(function(t){var n=e(t.currentTarget);url="report/folder/"+n.attr("data-id")+"/reports",r.router.navigate(url,{trigger:!0})})}}).tables,u.create({text:f.title}),this},toggleCheckbox:function(t){e(t.currentTarget).is(":checked")?this.$el.find("#folders_table td input:checkbox").not(":disabled").attr("checked",!0):this.$el.find("#folders_table td input:checkbox").attr("checked",!1)},getCheckedIds:function(){var t=[];return e.each(e("#folders_table td input:checkbox:checked"),function(n,r){t.push(e(r).val())}),t},remove:function(){var t=this,n=this.$el.find("#folders_table"),s=n.find('tbody input[type="checkbox"]:checked');if(s.size()==0){e.goMessage(f.select_alert);return}var o=this.options.deptId;e.goConfirm(f.remove_report,f.remove_desc,function(){var n=r.contextRoot+"api/report/folder",s={id:o,ids:t.getCheckedIds()};t.preloader=e.goPreloader(),t.preloader.render(),e.go(n,JSON.stringify(s),{async:!0,qryType:"DELETE",contentType:"application/json",responseFn:function(n){t.preloader.release(),e.goMessage(f.remove_success),t.reload.call(t)},error:function(n){t.preloader.release(),e.goAlert(i["\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."])}})})},changeActive:function(){var t=this,n=this.$el.find("#folders_table"),i=n.find('tbody input[type="checkbox"]:checked');if(i.size()==0){e.goMessage(f.select_alert);return}e.goConfirm(f.change_status_normal,f.normal_desc,function(){var n=r.contextRoot+"api/report/folder/status/active",i={id:t.options.deptId,ids:t.getCheckedIds()};e.go(n,JSON.stringify(i),{async:!1,qryType:"PUT",contentType:"application/json",responseFn:function(e){e.code==="200"&&t.reload.call(t)},error:function(t){e.goAlert(type.error)}})})},reload:function(){this.dataTable.reload()},release:function(){this.childView.release(),this.$el.off(),this.$el.empty(),this.remove()}},{__instance__:null,create:function(){return this.__instance__===null&&(this.__instance__=new this.prototype.constructor),this.__instance__}});return l})})();