(function(){define(["views/mobile/m_more_list","jquery","backbone","app","hogan","i18n!report/nls/report","i18n!nls/commons","views/mobile/header_toolbar","hgn!report/templates/mobile/m_home_undone_item","hgn!report/templates/mobile/m_home_recent_item","report/models/report_folder","report/collections/series","report/collections/reports","GO.util","GO.m.util"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p={series_null:s["\ub4f1\ub85d\ub41c \ubcf4\uace0\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],reports_null:s["\ub4f1\ub85d\ub41c \ubcf4\uace0\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],write:s["\ubcf4\uace0 \uc791\uc131"]},d=e.extend({el:"#content",events:{"vclick li a[data-type]":"goDetail","vclick li.undone a.btn_report_write":"goSeriesWrite"},initialize:function(e){r.util.appLoading(!0),this.options=e||{},this.folderModel=l.get(this.options.folderId),this.$el.off(),r.EventEmitter.trigger("common","layout:scrollToTop",this);var n={listFunc:t.proxy(function(e){this.folderModel.isPeriodic()?this.renderSeries(e):this.renderReports(e)},this),emptyListFunc:t.proxy(function(){var e=['<li class="creat data_null"><span class="subject"><span class="txt_ellipsis"></span>'+p.reports_null+"</li>"];this.$el.find("ul.list_normal").append(e)},this)};this.setRenderListFunc(n);var i={direction:"desc"};this.folderModel.isPeriodic()?this.setFetchInfo(i,new c([],{folderId:this.folderModel.get("id")})):this.setFetchInfo(i,new h([],{folderId:this.folderModel.get("id")}))},render:function(){var e=this;this.$el.html('<div class="content"><ul class="list_normal list_report" data-type="list"></ul></div>');var n={title:this.folderModel.get("name"),isList:!0,isSideMenu:!0,isHome:!0,isSearch:!0};this.folderModel.isOccasional()&&this.folderModel.isActive()&&this.folderModel.get("actions").writable&&(n.isWriteBtn=!0,n.writeBtnCallback=function(){var t="report/folder/"+e.folderModel.get("id")+"/write";r.router.navigate(t,{trigger:!0})}),u.render(n),this.dataFetch().done(t.proxy(function(e){e.length===0?this.renderListFunc.emptyListFunc():(this.renderListFunc.listFunc(e),this.scrollToEl())},this)),r.util.appLoading(!1)},renderReports:function(e){var n=this,i=[];e.each(function(e,n){var s=f({data:t.extend({},e.toJSON(),{title:function(){return this.name},isCommentCountZero:e.get("commentCount")==0,createdAtBasicDate:r.util.basicDate(e.get("submittedAt")),isReadable:e.get("actions").readable}),lang:p});i.push(s)}),n.$el.find("ul.list_normal").append(i.join(""))},renderSeries:function(e){var n=this,i=[];e.each(function(e,n){var o=r.session(),u=e.findReporterByUserId(o.id).user.reportId,f=a({data:t.extend({},e.toJSON(),{closedAtBasicDate:r.util.customDate(e.get("closedAt"),"YYYY-MM-DD(ddd)"),seriesText:e.getSeriesStr(),donesText:r.i18n(s["\ubcf4\uace0\uc790 {{arg1}}\uba85"],{arg1:e.get("dones").length}),undonesText:r.i18n(s["\ubbf8\ubcf4\uace0\uc790 {{arg1}}\uba85"],{arg1:e.get("undones").length}),isCommentCountZero:e.get("commentCount")==0?!0:!1,reportId:u})});i.push(f)}),n.$el.find("ul.list_normal").append(i.join(""))},goDetail:function(e){this.setSessionInfo(e);var n=t(e.currentTarget),i="";return this.folderModel.isPeriodic()?i="report/series/"+n.attr("data-series-id"):i="report/folder/"+this.folderModel.get("id")+"/report/"+n.attr("data-report-id"),i+="/?page="+this.collection.page.page,r.router.navigate(i,!0),!1},goSeriesWrite:function(e){var n=t(e.currentTarget),i=n.parents("li.undone").find("a[data-report-id]"),s=i.attr("data-report-id"),o=i.attr("data-series-id"),u="report/series/"+o+"/report/"+s+"/form";r.router.navigate(u,{trigger:!0})}},{__instance__:null,create:function(e){return this.__instance__=new this.prototype.constructor({packageName:e}),this.__instance__}});return d})}).call(this);