define("store/views/all_tab",function(require){var e=require("backbone"),t=require("app"),n=require("underscore"),r=require("jquery"),i=require("hgn!store/templates/all_tab"),s=require("store/collections/products"),o=require("json!store/views/products.json"),u=require("store/models/store_admin"),a=require("i18n!store/nls/store"),f=e.View.extend({el:"#innerContent",events:{"click .list_album_thum":"showDetail","click a[data-type='prev']":"bannerLeft","click a[data-type='next']":"bannerRight","click #benefitLink":"openBenefitPage","click .banner":"goToDetail"},initialize:function(){this.isAdmin=u.getInstance().isAdmin();var e="all",t={statuses:["REGISTRATION_COMPLETE"]};this.isAdmin&&t.statuses.push("REGISTRATION_APPLY"),this.allProducts=new s(e,t),this.initializeBanner()},getProductList:function(){this.productList=[];var e=this;n.each(o,function(t){var n=e.allProducts.getByProductCode(t.code);if(n){var i=r.extend({},t,n);e.productList.push(i)}}),this.productList=n.sortBy(this.productList,"sortOrder")},render:function(){var e=this;return this.allProducts.fetch().done(r.proxy(function(){this.getProductList(),this.$el.html(i({baseImgUrl:t.contextRoot+"resources/images/linkplus/",products:this.productList,lang:a,inUse:function(){return this.status==="REGISTRATION_COMPLETE"},inApplying:function(){return this.status==="REGISTRATION_APPLY"&&e.isAdmin}}))},this)),this},showDetail:function(e){var n=r(e.currentTarget).attr("data-code");return this.logDetailViewOpen(n),t.router.navigate("store/all",{trigger:!1,pushStatus:!0}),t.router.navigate("store/"+n+"/detail",!0)},logDetailViewOpen:function(e){r.ajax({type:"GET",url:t.contextRoot+"api/store/service/logging/detail/view?code="+e})},initializeBanner:function(){this.BANNER_INDEX=0,this.BANNER_LEN=3,this.BANNER_WIDTH=1013},bannerLeft:function(){var e=this.BANNER_INDEX-1;e<0&&(e=this.BANNER_LEN-1),this.showBannerAt(e)},bannerRight:function(){var e=this.BANNER_INDEX+1;e>=this.BANNER_LEN&&(e=0),this.showBannerAt(e)},showBannerAt:function(e){this.updateBannerIndex(e);if(e!==this.BANNER_INDEX){var t=-this.BANNER_WIDTH*e;r("#banner_wrapper").stop(),r("#banner_wrapper").animate({left:t},1e3),this.BANNER_INDEX=e}},updateBannerIndex:function(e){var t=this.$el.find(".banner_rolling_page span");t.removeClass("on"),r(t[e]).addClass("on")},openBenefitPage:function(){window.open("https://care.daouoffice.co.kr/hc/ko/articles/900003146743","benefit")},goToDetail:function(e){this.logBannerClick(e);var n=r(e.currentTarget).attr("data-code");return t.router.navigate("store/"+n+"/detail",!0)},logBannerClick:function(e){var n=r(e.currentTarget).attr("data-btype"),i=r(e.currentTarget).attr("data-code");r.ajax({type:"GET",url:t.contextRoot+"api/store/service/logging/banner?code="+i+"&bannerType="+n})}});return f});