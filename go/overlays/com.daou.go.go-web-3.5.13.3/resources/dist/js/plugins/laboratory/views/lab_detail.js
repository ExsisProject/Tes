define("laboratory/views/lab_detail",function(require){var e=require("backbone"),t=require("hgn!laboratory/templates/lab_detail"),n=require("i18n!nls/commons"),r={close:n["\ub2eb\uae30"],move_to_home:n["\ud648\uc73c\ub85c \uc774\ub3d9"],before_comment_desc:n["\uc774 \uae30\ub2a5\uc774 \ub3c4\uc6c0\uc774 \ub418\uc168\ub098\uc694"],after_comment_desc:n["\uc18c\uc911\ud55c \uc758\uacac \uac10\uc0ac\ud569\ub2c8\ub2e4."],before_thanks_desc:n["\uc5ec\ub7ec\ubd84\uc758 \uc758\uacac\uc73c\ub85c \ub354 \ud3b8\ub9ac\ud55c \uae30\ub2a5\uc744 \ub9cc\ub4e4\uaca0\uc2b5\ub2c8\ub2e4."],after_thanks_desc:n["\ub354 \ud3b8\ub9ac\ud55c \uae30\ub2a5\uc744 \ub9cc\ub4e4 \uc218 \uc788\ub3c4\ub85d \ub178\ub825\ud558\uaca0\uc2b5\ub2c8\ub2e4."]};return e.View.extend({events:{"click [data-feedback-like]":"_onClickFeedback","click [data-go-home]":"_goHome"},initialize:function(){this.data=GO.util.getLocalStorage("lab-feedback-config"),this.feedbackDoneData=this._getFeedbackDoneData()},render:function(e){this.$el.html(t({data:this.data,isFeedbackDone:this.feedbackDoneData.isDone,lang:r})),this.feedbackDoneData.isDone&&this._renderForFeedbackDone()},_renderForFeedbackDone:function(){$("[data-feedback-like]").prop("disabled",!0),$("[data-feedback-img]").empty().append('<img class="" src="/resources/images/wooram_good.gif">'),$("[data-reault-comment]").text(r.after_comment_desc),$("[data-reault-comment-side]").html(r.after_comment_desc),$("[data-thanks-desc]").text(r.after_thanks_desc)},_onClickFeedback:function(e){e.preventDefault();var t=this,r=$(e.currentTarget).attr("data-value")||1;$.ajax({type:"POST",url:GO.contextRoot+"api/laboratory/feedback/likes",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({labConfigId:t.data.id,title:t.data.title,appliedVersion:t.data.appliedVersion,point:r}),success:function(e){if(e.code!=="200")return $.goAlert(e.message),!1;GO.util.setLocalStorage("lab-user-feedback-done-"+GO.session("id"),{isDone:!0,point:r,configId:t.data.id}),t._renderForFeedbackDone()},error:function(e){$.goAlert(n["\uc800\uc7a5\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4."])}})},_getFeedbackDoneData:function(){var e=GO.util.getLocalStorage("lab-user-feedback-done-"+GO.session("id"));return _.isEmpty(e)||e.configId!==this.data.id?{isDone:!1}:e},_goHome:function(){GO.router.navigate("home",{trigger:!0})}})});