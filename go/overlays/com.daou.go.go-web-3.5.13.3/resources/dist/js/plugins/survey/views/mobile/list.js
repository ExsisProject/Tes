(function(){define(["views/mobile/m_more_list","backbone","app","survey/collections/surveys","survey/helpers/html","i18n!survey/nls/survey","views/mobile/header_toolbar"],function(e,t,n,r,i,s,o){function a(e){var t=[],r="";return t.push("<li>"),t.push('<a class="tit" data-list-id=\''+e.id+"'>"),t.push('<span class="subject">'),this.isMyList()?r=i.getStatusTagByStatus(e.get("status")):e.isResponsible()?r=i.getStatusTagByResponse(e.getResponseStatus()):e.isIncludedReferrer(n.session("id"))&&(r=i.getStatusTag("read",s["\uc5f4\ub78c"])),t.push(r),e.isIncludedReferrer(n.session("id"))&&t.push('<span class="state refer">'+s["\ucc38\uc870"]+"</span>"),t.push('<span class="txt">'+e.get("title")+"</span>"),t.push("</span>"),t.push('<span class="info">'),t.push('<span class="vertical_wrap"><span class="date date_em">'+i.getSurveyPeriod(e)+"</span></span>"),t.push('<span class="writer">'+e.getCreatorName()+"</span>"),t.push("</span>"),t.push("</a>"),t.push("</li>"),t.join("\n")}var u=e.extend({tagName:"ul",className:"list_box list_box_survey",filterName:"all",events:{"vclick a.tit":"goDetail"},initialize:function(e){this.options=e||{},n.util.appLoading(!0),this.filterName=this.options.filter;var t={listFunc:$.proxy(function(e){e.each(function(e,t){this.$el.append(a.call(this,e))},this)},this),emptyListFunc:$.proxy(function(){this.$el.append('<li class="creat data_null"><span class="txt_ellipsis">'+s["\uc124\ubb38 \ube48\ubaa9\ub85d \uba54\uc2dc\uc9c0"]+"</span></li>")},this)};this.setRenderListFunc(t);var i={property:"id",direction:"desc"};this.collection||this.setFetchInfo(i,new r([],{filter:this.filterName}))},render:function(){var e=$.Deferred(),t=this.filterName==="progress"&&_.isNull(sessionStorage.getItem("tabKind"));return o.render({title:{progress:s["\uc9c4\ud589\uc911\uc778 \uc124\ubb38"],finished:s["\uc644\ub8cc\ub41c \uc124\ubb38"],my:s["\ub0b4\uac00 \ub9cc\ub4e0 \uc124\ubb38"]}[this.filterName],isList:!0,isSideMenu:!0,isHome:!0}),this.dataFetch().done($.proxy(function(r){r.length===0?(t&&n.EventEmitter.trigger("survey","layout:toggleLatestTab"),this.renderListFunc.emptyListFunc()):(this.renderListFunc.listFunc(r),e.resolveWith(this,r),n.util.pageDone(),this.scrollToEl()),n.util.appLoading(!1)},this)),e},isMyList:function(){return this.filterName==="my"},goDetail:function(e){this.setSessionInfo(e);var t=$(e.currentTarget),r="survey/"+t.attr("data-list-id");return n.router.navigate(r,{trigger:!0}),!1}});return u})})();