(function(){define(["underscore","backbone","app","survey/collections/surveys","views/card_item","survey/helpers/html","i18n!nls/commons","i18n!survey/nls/survey","jquery.ajaxmock"],function(e,t,n,r,i,s,o,u){function f(){var e=[];return e.push('<h1 class="s_title">'+u["\uc9c4\ud589\uc911\uc778 \uc124\ubb38"]),e.push('<span class="btn_wrap">'),e.push('<span class="ic ic_info btn-toggle-desc">'),e.push('<span class="layer_tail tooltip-desc" style="display:none;">'),e.push('<i class="ic ic_tail"></i>'),e.push("<div>"+u["\ub300\uc2dc\ubcf4\ub4dc \uc9c4\ud589\uc911 \uc124\ubb38 \uc124\uba85"]+"</div>"),e.push("</span>"),e.push("</span>"),e.push("</span>"),e.push("</h1>"),e.push('<div class="dashboard_box">'),e.push('<div class="card_item_wrapper"></div>'),e.push("</div>"),e.join("\n")}function l(e){e.length>0?e.each(function(e,t){var r=new i;this.$el.find(".card_item_wrapper").append(r.el),r.setHeader(h(e,t+1)),r.setSubject(p(e)),r.setContent(d(e));if(!c(e)){var s="",o="/survey/"+e.id;e.isResponseDone()?!e.isCreator(n.session("id"))&&e.isPrivate()&&e.editable()?(s=u["\uc751\ub2f5 \uc218\uc815"],o+="/response/edit"):s=u["\uacb0\uacfc \ubcf4\uae30"]:e.isResponseTemp()?s=u["\uacc4\uc18d \ucc38\uc5ec"]:e.isIncludedReferrer(n.session("id"))&&!e.isResponsible()?s=u["\uacb0\uacfc \ubcf4\uae30"]:s=u["\uc124\ubb38 \ucc38\uc5ec"],r.addButtons({name:"apply_survey",label:s,onClick:function(e,t,r){n.router.navigate(o,{trigger:!0,pushState:!0})}})}r.$el.addClass("survey_home_card"),r.render()},this):this.$el.find(".card_item_wrapper").replaceWith('<p class="desc">'+u["\uc9c4\ud589\uc911 \uc124\ubb38 \uc5c6\uc74c \uba54\uc2dc\uc9c0"]+"</p>")}function c(e){return!e.isCreator(n.session("id"))&&e.isResponseDone()&&e.isPrivate()&&!e.editable()}function h(e,t){var r=[];return r.push('<span class="number">No.'+t+"</span>"),e.isResponsible()?r.push(s.getStatusTagByResponse(e.getResponseStatus())):e.isIncludedReferrer(n.session("id"))&&r.push(s.getStatusTag("read",u["\uc5f4\ub78c"])),e.isIncludedReferrer(n.session("id"))&&r.push(s.getReferTag(e.getResponseStatus())),r.join("\n")}function p(t){var n=[],r=moment(t.get("startTime"),"YYYY-MM-DD").format("YYYY-MM-DD"),i=moment(t.get("endTime"),"YYYY-MM-DD").format("YYYY-MM-DD");return n.push('<span class="title">'+e.escape(t.get("title"))+"</span>"),n.push('<span class="date">'+r+"~"+i+"</span>"),n.join("\n")}function d(e){var t=[],n=e.isPrivate()?u["\ube44\uacf5\uac1c"]:u["\uacf5\uac1c"],r=e.getCreatorName();return t.push('<table class="form_s">'),t.push("<tbody>"),t.push("<tr>"),t.push("<th>"+u["\uc791\uc131\uc790"]+"</th>"),t.push("<td>"+r+"</th>"),t.push("</tr>"),t.push("<tr>"),t.push("<th>"+u["\uc124\ubb38 \uacb0\uacfc"]+"</th>"),t.push("<td>"+n+"</th>"),t.push("</tr>"),t.push("</tbody>"),t.push("</table>"),t.join("\n")}var a=t.View.extend({tagName:"div",className:"dr_wrapper",events:{},initialize:function(){this.collection||(this.collection=new r),this.collection.pageOptions.offset=6},render:function(){this.$el.append(f()),this.collection.setFilter("todo").fetch({success:e.bind(l,this)})}});return a})})();