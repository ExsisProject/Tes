(function(){define(["jquery","backbone","survey/models/query","survey/views/query/form","survey/views/query/preview"],function(e,t,n,r,i){var s=t.View.extend({tagName:"li",className:"query-item",callbacks:{},initialize:function(){this.model||(this.model=new n),this.callbacks.start=e.Callbacks(),this.callbacks.complete=e.Callbacks(),this.$el.on("click:edit-end",e.proxy(function(e,t){this.model=t,this.renderPreview(),this.callbacks.complete.fire()},this)),this.$el.on("click:edit-start",e.proxy(function(){this.renderForm(),this.callbacks.start.fire()},this))},release:function(){var e=this.$el.data("view");e&&e.undelegateEvents(),this.$el.attr("class","").addClass(this.className).empty()},onStart:function(e){this.callbacks.start.add(e)},onComplete:function(e){this.callbacks.complete.add(e)},renderForm:function(){this.release();var e=new r({el:this.el,model:this.model});return e.render(),e},renderPreview:function(){this.release(),this.$el.addClass("sortable");var e=new i({el:this.el,model:this.model});return e.render(),e}},{create:function(e){return this.modify(new n({surveyId:e}))},modify:function(e){var t=new this.prototype.constructor({model:e});return t.renderForm(),t},preview:function(e){var t=new this.prototype.constructor({model:e});return t.renderPreview(),t}});return s})})();