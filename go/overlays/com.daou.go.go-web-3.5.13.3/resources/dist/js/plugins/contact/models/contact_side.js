define(function(require){var e=require("backbone"),t=null,n=e.Model.extend({url:"/api/contact/side",initialize:function(){},getSortedDataByPriority:function(){var e=this.get("companyGroups")||[],t=this.get("personalGroups")||[],n=this.get("deptGroups")||[],r=this.get("priority").priorityTypes,i=[{type:"USER",groups:t},{type:"DEPARTMENT",deptInfo:n}];if(e.length>0||this.get("admin"))e=_.each(e,function(e){var t=e.parentPathName,n=t?t.split(">").length-1:0;e.depth=n}),e=_.chain(e).sortBy(function(e){if(e.parent.length>0)return e.parent[e.parent.length-1].seq}).sortBy("seq").sortBy("depth").value(),i.push({type:"COMPANY",groups:e});var s=_.sortBy(i,function(e){return r.indexOf(e.type)});return s},getInitMenu:function(){function n(e){var t=e.splice(0,1)[0];return e.length==0||r(t)?t:n(e)}function r(e){return e.type=="COMPANY"&&e.groups.length==0?!1:e.type=="DEPARTMENT"&&e.deptInfo.length==0?!1:!0}var e=this.getSortedDataByPriority(),t=n(e),i={type:t.type};return t.type=="DEPARTMENT"&&(i.deptId=t.deptInfo[0].deptId),t.type=="COMPANY"&&(i.groupId=t.groups[0].id),i},getContactListExposure:function(){return this.get("contactListExposure")},getPersonalGroups:function(){return new e.Collection(this.get("personalGroups"))},getDeptGroups:function(){return new e.Collection(this.get("deptGroups"))},getCompanyGroups:function(){return new e.Collection(this.get("companyGroups"))},isAdmin:function(){return this.get("admin")}},{get:function(){return t==null&&(t=new n),t.fetch({async:!1}),t},init:function(){return new n}});return{read:function(){return n.get()},init:function(){return n.init()}}});