define("works/views/app/list_manager",function(require){var e=require("i18n!nls/commons"),t=require("i18n!works/nls/works"),n={"\uc800\uc7a5":e["\uc800\uc7a5"],"\ucde8\uc18c":e["\ucde8\uc18c"],"\uc81c\ubaa9\uc73c\ub85c \uc9c0\uc815\ub41c \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":t["\uc81c\ubaa9\uc73c\ub85c \uc9c0\uc815\ub41c \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],"\uad00\ub9ac":t["\uad00\ub9ac"],"\ud398\uc774\uc9c0 \uc81c\ubaa9":t["\ubaa9\ub85d \ud654\uba74 \uad00\ub9ac"],"\ubaa9\ub85d \ud654\uba74 \uad00\ub9ac":t["\ubaa9\ub85d \ud654\uba74 \uad00\ub9ac"],"\ud398\uc774\uc9c0 \uc124\uba85":t["\ubaa9\ub85d \ud654\uba74 \uad00\ub9ac \uc124\uba85"],"\ubaa9\ub85d \ud654\uba74 \uad00\ub9ac \uc124\uba852":t["\ubaa9\ub85d \ud654\uba74 \uad00\ub9ac \uc124\uba852"],"\ucc28\ud2b8":t["\ucc28\ud2b8"],"\ucc28\ud2b8 \uc124\uba85":t["\ucc28\ud2b8 \uc124\uba85"],"\ucc28\ud2b8 \ucd94\uac00":t["\ucc28\ud2b8 \ucd94\uac00"],"\ucc28\ud2b8 \uc124\uc815 \uc124\uba851":t["\ucc28\ud2b8 \uc124\uc815 \uc124\uba851"],"\ucc28\ud2b8 \uc124\uc815 \uc124\uba852":t["\ucc28\ud2b8 \uc124\uc815 \uc124\uba852"],"\uad00\ub9ac \ud648\uc73c\ub85c \uc774\ub3d9":t["\uad00\ub9ac \ud648\uc73c\ub85c \uc774\ub3d9"],"\ud574\ub2f9 \uc571\uc73c\ub85c \uc774\ub3d9":t["\ud574\ub2f9 \uc571\uc73c\ub85c \uc774\ub3d9"]},r=require("works/components/list_manager/models/list_setting"),i=require("works/components/chart/models/chart_setting"),s=require("works/components/list_manager/collections/list_columns"),o=require("works/components/chart/collections/chart_settings"),u=require("works/collections/fields"),a=require("works/views/app/base_setting"),f=require("works/components/chart/views/chart_setting"),l=require("works/components/list_manager/views/list_setting"),c=require("hgn!works/components/list_manager/templates/list_manager");return a.extend({className:"go_content go_renew go_works_home app_temp",events:_.extend(a.prototype.events,{"click [el-add-chart]":"_onClickAddChart","change #notUseDocNo":"toggleByNotUseDocNoFlag","change input[name=docNoType]":"toggleDocNoType"}),initialize:function(e){this.lang=n,a.prototype.initialize.call(this,e),this.setting=new r({},{appletId:this.appletId}),this.fields=new u([],{appletId:this.appletId,includeProperty:!0}),this.columns=new s,this.charts=new o},render:function(){return a.prototype.render.call(this),this.$("[el-content]").prepend(c({lang:n})),this._fetchData(),this},_initChartSortable:function(){this.$("ul[el-charts]").sortable({items:"> li:not(#addChartButton)",tolerance:"pointer",cursor:"move",placeholder:{element:function(){return"<li><div class='column_create'><div class='wrap_works_info'></div></div></li>"},update:function(){return}},stop:$.proxy(function(e,t){var n=t.item.index(),r=t.item.attr("data-chart-cid");this.charts.reorder(r,n)},this)}),this.$("ul[el-charts]").find("li:not(#addChartButton)").css("cursor","move")},_fetchData:function(){$.when(this.fields.fetch(),this.setting.fetch()).done($.proxy(function(){this._renderContent()},this))},_renderContent:function(){this._initData(),this._renderColumns(),this._renderCharts(),this._initChartSortable(),this._initDocNoConfig(this.setting.get("docNoConfig"))},_initData:function(){this.charts.reset([]),this.charts.setChartsWithSeq(this.setting.get("charts")),this.charts.mergeFromFields(this.fields),this.chartFields=this.fields.getChartFields(),this.numberFields=this.fields.getNumberFields()},_initDocNoConfig:function(e){var t=!e.useDocNo;t&&this.$("#notUseDocNo").attr("checked",t),this._renderDocNoConfig(t)},_renderCharts:function(){this.$("[el-charts]").find("li").not("#addChartButton").remove(),this.charts.each(function(e){this._renderChart(e)},this)},_renderChart:function(e){var t=new f({chartFields:this.chartFields,numberFields:this.numberFields,model:e,appletId:this.appletId});this.$("#addChartButton").before(t.render().el)},_renderColumns:function(){var e=new l({columns:this.columns,fields:this.fields,setting:this.setting});this.$("[data-el-list-setting]").html(e.render().el)},_renderDocNoConfig:function(e){e?(this.$("input[name=docNoType]").prop("disabled",!0).addClass("disabled"),this.$("#customInputView_1").find("input").prop("disabled",!0).addClass("disabled"),this.$("#customSelectView_1").find("select").prop("disabled",!0).addClass("disabled")):(this.$("input[name=docNoType]").prop("disabled",!1).removeClass("disabled"),this._reRenderDocNoType(this.$("input[name=docNoType]:checked").val()))},_reRenderDocNoType:function(e){e=="custom"?(this.$("#customInputView_1").find("input").prop("disabled",!1).removeClass("disabled"),this.$("#customSelectView_1").find("select").prop("disabled",!1).removeClass("disabled")):(this.$("#customInputView_1").find("input").prop("disabled",!0).addClass("disabled"),this.$("#customSelectView_1").find("select").prop("disabled",!0).addClass("disabled"))},_onClickSave:function(){var r=this.columns.getTitleColumnIndex();if(r<0){$.goError(n["\uc81c\ubaa9\uc73c\ub85c \uc9c0\uc815\ub41c \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]);return}var i=_.compact(this.charts.map(function(e){var t=e.isInvalidTitle(),n=e.isInvalidGoal();return t&&e.trigger("change:title"),n&&e.trigger("change:goal"),t||n}));if(i.length)return;var s={useDocNo:!this.$("#notUseDocNo").is(":checked")||!1,docNoType:this.$("input[name=docNoType]:checked").val()||"simple",customPrefix:this.$("#customPrefix").val()==""?null:this.$("#customPrefix").val(),customDigit:this.$("#customDigit").val()||2};if(s.useDocNo&&s.docNoType=="custom"&&s.customPrefix==null){$.goError(t["\ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4."]),this.$("#customPrefix").focus();return}this.setting.set("docNoConfig",s),this.setting.set("titleColumnIndex",r),this.setting.set("sortColumnIndex",this.columns.getSortColumnIndex()),this.setting.set("sortDirection",this.columns.getSortDirection()),this.setting.set("columns",this.columns.toJSON()),this.setting.set("charts",this.charts.toJSON()),this.setting.save({},{success:$.proxy(function(){$.goMessage(e["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),this._fetchData()},this),error:function(){$.goMessage(e["\uad00\ub9ac \uc11c\ubc84\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4"])}})},_onClickCancel:function(n){n.preventDefault();var r=this;$.goConfirm(e["\ucde8\uc18c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],t["\ud3b8\uc9d1 \ucde8\uc18c"],_.bind(function(){r._fetchData()},this))},_onClickAddChart:function(){var e=this.chartFields.length?{fieldCid:this.chartFields.at(0).get("cid")}:{},t=new i(e);this.charts.push(t),this._renderChart(t)},toggleByNotUseDocNoFlag:function(e){this._renderDocNoConfig($(e.target).is(":checked"))},toggleDocNoType:function(e){this._reRenderDocNoType($(e.target).val())}})});