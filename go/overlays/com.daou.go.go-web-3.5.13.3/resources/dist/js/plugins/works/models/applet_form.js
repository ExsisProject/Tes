define("works/models/applet_form",function(require){var e=require("app"),t=require("models/base_model");return t.extend({components:null,initialize:function(){t.prototype.initialize.apply(this,arguments)},url:function(){var t=this.get("appletId"),n=this.get("subFormId"),r=e.util.isValidValue(n),i=this.get("type");return i==="subform_setting"?r?e.config("contextRoot")+"api/works/applets/"+t+"/subform/"+n:e.config("contextRoot")+"api/works/applets/"+t+"/subform":r?e.config("contextRoot")+"api/works/applets/"+t+"/form/"+n:e.config("contextRoot")+"api/works/applets/"+t+"/form"},mergeMaskingValue:function(e){function n(t){_.each(t.components,function(t){t.masking=_.contains(e,t.cid),t.components.length&&n(t)})}var t=this.get("data");n(t)},parse:function(e){var t=e.data.data.components,n=e.data;return n.data=this._correctionComponents(n.data),n},_correctionComponents:function(e){return this._removeDuplicateComponents(e),this._correctionMultipleFlagInTable(e),e},_removeDuplicateComponents:function(e){function n(e){e.components=_.filter(e.components,function(e){var r=_.contains(t,e.cid);return r||t.push(e.cid),n(e),!r})}var t=[];return n(e),e},_correctionMultipleFlagInTable:function(e){var t=!1;return _.each(e.components,function(e){e.type==="table"&&_.each(e.components,function(e){e.multiple===!1&&(e.multiple=!0,t=!0)})}),t&&$.ajax({type:"PUT",contentType:"application/json",url:this.url(),data:JSON.stringify({appletId:this.get("appletId"),id:this.get("appletId"),data:e})}),e}})});