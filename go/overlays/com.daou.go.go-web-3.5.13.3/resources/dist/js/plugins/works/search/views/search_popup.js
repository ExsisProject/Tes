define("works/search/views/search_popup",function(require){var e=require("hogan"),t=require("i18n!admin/nls/admin"),n=require("i18n!nls/commons"),r=require("i18n!works/nls/works"),i=require("i18n!dashboard/nls/dashboard"),s=require("works/collections/applet_simples"),o={creator:r["\ub4f1\ub85d\uc790"],keyword:n["\uac80\uc0c9\uc5b4"],period:n["\uae30\uac04"],"\uc571 \uba85":r["\uc571 \uba85"],all:n["\uc804\uccb4"],aweek:i["\ucd5c\uadfc 1\uc8fc\uc77c"],twoweeks:i["\ucd5c\uadfc 2\uc8fc\uc77c"],amonth:i["\ucd5c\uadfc 1\uac1c\uc6d4"],directly:i["\uc9c1\uc811\uc120\ud0dd"],"\ud14d\uc2a4\ud2b8":r["\ud14d\uc2a4\ud2b8"],"\ud65c\ub3d9\uae30\ub85d":r["\ud65c\ub3d9\uae30\ub85d"],"\ub313\uae00":n["\ub313\uae00"],"\ucca8\ubd80\ud30c\uc77c \uba85":n["\ucca8\ubd80\ud30c\uc77c \uba85"],"\ucca8\ubd80\ud30c\uc77c \ub0b4\uc6a9":n["\ucca8\ubd80\ud30c\uc77c \ub0b4\uc6a9"],"\uc9c1\uc811 \uc785\ub825":t["\uc9c1\uc811 \uc785\ub825"]},u=e.compile('<option value="{{data.id}}">{{data.name}}</option>'),a=require("hgn!works/search/templates/search_popup");return Backbone.View.extend({tagName:"form",events:{"change input[type=radio]":"changeTerm","change #appType":"toggleAppType"},initialize:function(){this.appList=new s},render:function(){return this.$el.html(a({lang:o})),this.appList.fetch({success:function(e){e.each(function(e){this.$("#appList").append(u.render({data:e.toJSON()}))})}}),$.datepicker.setDefaults($.datepicker.regional[GO.config("locale")]),this.renderDatePicker(),this},renderDatePicker:function(){this.$("#fromDate").datepicker({yearSuffix:"",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0}),this.$("#toDate").datepicker({yearSuffix:"",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0})},changeTerm:function(e){var t=$(e.currentTarget).attr("id")=="radioDirectly";this.$("input[data-type=datepicker]").prop("disabled",!t),this.renderDatePicker(),t&&this.$("input[data-type=datepicker]").val(GO.util.shortDate(new Date))},getSearchParam:function(){var e=this.validate();if(!e)return;var t=this.getSearchTerm();return{stype:"detail",keyword:this.$("#keyword").val(),searchAttachContents:this.$("#searchAttachContents").is(":checked"),searchTerm:t.searchTerm,page:0,offset:15,fromDate:t.fromDate,toDate:t.toDate,adv:"on",authorName:this.$("#creator").val(),content:this.$('input[name="text"]').is(":checked"),activityContents:this.$('input[name="activity"]').is(":checked"),comments:this.$('input[name="comment"]').is(":checked"),attachFileNames:this.$('input[name="attachName"]').is(":checked"),attachFileContents:this.$('input[name="attachContent"]').is(":checked"),appletId:this.$("#appList option:selected").val(),appletName:this.$("#appName").val()}},getSearchTerm:function(){var e=this.$el.find("input[type=radio]:checked").val(),t=GO.util.shortDate(new Date),n=GO.util.toISO8601("1970/01/01"),r=GO.util.toISO8601(new Date),i="all";return e=="-1"?(n=GO.util.calDate(t,"weeks",e),i="1w"):e=="-2"?(n=GO.util.calDate(t,"weeks",e),i="2w"):e=="month"?(n=GO.util.calDate(t,"months",-1),i="1m"):e=="directly"&&(i="",n=GO.util.toISO8601($("#fromDate").val()),r=GO.util.searchEndDate($("#toDate").val())),{fromDate:n,toDate:r,searchTerm:i}},validate:function(){var e=this.$("#appType").val();if(e=="directInput"){var t=this.$("#appName"),i=$.trim(t.val());if(i=="")return $.goError(r["\uc571 \uba85\uc744 \uc785\ub825\ud558\uc138\uc694."]),t.focus(),!1}var s=this.$("#keyword"),o=$.trim(s.val());if(o=="")return $.goError(n["\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694."]),s.focus(),!1;if(!$.goValidation.isCheckLength(2,64,o))return $.goMessage(GO.i18n(n["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"2",arg2:"64"})),s.focus(),!1;if($.goValidation.isInValidEmailChar(o))return $.goMessage(n["\uba54\uc77c \uc0ac\uc6a9 \ubd88\uac00 \ubb38\uc790"]),s.focus(),!1;var u=this.$("#creator"),a=u.val();return a.length&&!$.goValidation.isCheckLength(2,64,a)?($.goMessage(GO.i18n(n["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"2",arg2:"64"})),u.focus(),!1):!0},toggleAppType:function(e){var t=$(e.currentTarget).val();t=="directInput"?(this.$("#appList").hide(),this.$("#appName").show()):(this.$("#appList").show(),this.$("#appName").hide())}})});