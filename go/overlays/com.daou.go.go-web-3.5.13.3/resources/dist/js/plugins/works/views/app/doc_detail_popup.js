define("works/views/app/doc_detail_popup",function(require){var e=require("when"),t=require("i18n!nls/commons"),n=require("works/components/masking_manager/models/masking"),r=require("works/collections/fields"),i=require("works/models/applet_baseconfig"),s=require("works/models/applet_doc_refer"),o=require("works/models/applet_doc"),u=require("works/models/applet_form"),a=require("works/views/app/layout/app_content_top"),f=require("works/views/app/doc_detail"),l=require("hgn!works/templates/app/doc_detail_popup"),c=require("hgn!works/templates/app/doc_detail"),h=require("works/constants/value_type"),p=Backbone.Collection.extend({model:Backbone.Model,initialize:function(e){this.options=e||{},this.appletId=e.appletId,this.docId=e.docId},url:function(){return GO.config("contextRoot")+"api/works/applets/"+this.appletId+"/docs/"+this.docId+"/actions"}});return f.extend({className:"go_wrap build_popup_layer",initialize:function(e){this.appletId=e.appletId,this.subFormId=e.subFormId,this.reqAppletId=e.reqAppletId,this.docId=e.docId,this.fieldsOfIntegrationApplet={},this.fields=new r([],{appletId:e.appletId,subFormId:e.subFormId,includeProperty:!0}),this.baseConfigModel=new i({id:this.appletId}),this.appletFormModel=new u({appletId:this.appletId,subFormId:e.subFormId?e.subFormId:0}),this.masking=new n({appletId:this.appletId}),this.masking.fetch(),this.isOrgDocPopup=e.hasOwnProperty("isOrgDocPopup")?e.isOrgDocPopup:!1,this.isOrgDocPopup?(this.model=new o({id:this.docId,appletId:this.appletId,subFormId:this.subFormId}),this.actions=new p({appletId:this.appletId,docId:this.docId})):this.model=new s({id:this.docId},{appletId:this.appletId,reqAppletId:this.reqAppletId}),this.$el.on("doAction",$.proxy(function(){$.when(this.model.fetch(),this.actions.fetch()).done($.proxy(function(){this._removeNeedToSetProcess(),this._renderAction(),this._renderDocLog(),$.goMessage(t["\ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},this))},this))},render:function(){return this.$el.html(l),this.$("div.content_page").html(c({isRefDocPopup:!0})),this.$("#actionArea").remove(),this.$("#logSection").remove(),e.all([this.baseConfigModel.fetch(),this.appletFormModel.fetch({statusCode:{403:function(){GO.util.error("403",{msgCode:"403-works-accessibleform"})}}}),this.model.fetch({statusCode:{403:function(){GO.util.error("403",{msgCode:"400-works"})},404:function(){GO.util.error("404",{msgCode:"400-works"})},500:function(){GO.util.error("500")}}}),this.fields.fetch(),this.masking.deferred]).then($.proxy(function(){var e=$.Deferred();return this.fields.getFieldsOfIntegrationApplet().done(_.bind(function(t){this.fieldsOfIntegrationApplet=t,e.resolve()},this)),e},this)).then($.proxy(function(){this.model.isCreator(GO.session("id"))||this.appletFormModel.mergeMaskingValue(this.masking.get("fieldCids")),this._renderContent()},this)).otherwise(function(t){console.log(t.stack)}),$("body").html(this.el),this},renderOrgDoc:function(){return this.$el.html(l),this.$("div.content_page").html(c()),e.all([this.baseConfigModel.fetch(),this.appletFormModel.fetch({statusCode:{403:function(){GO.util.error("403",{msgCode:"403-works-accessibleform"})}}}),this.actions.fetch(),this.model.fetch(),this.fields.fetch(),this.masking.deferred]).then($.proxy(function(){var e=$.Deferred();return this.fields.getFieldsOfIntegrationApplet().done(_.bind(function(t){this.fieldsOfIntegrationApplet=t,e.resolve()},this)),e},this)).then($.proxy(function(){this.model.isCreator(GO.session("id"))||this.appletFormModel.mergeMaskingValue(this.masking.get("fieldCids"));var e=new a({baseConfigModel:this.baseConfigModel,pageName:this.pageName,useSearch:this.useSearch,isOrgDocPopup:this.isOrgDocPopup});this.$("div.go_popup_content_top").html(e.el),e.render(),this._renderContent(),this._renderActivity(),this._renderAction(),_.contains(this.masking.get("fieldCids"),this.model.get("titleCid"))&&this._renderMaskedTitle()},this)).otherwise(function(t){console.log(t.stack)}),this._renderConsumer(),this._renderDocLog(),$("body").html(this.el),this}})});