define("works/components/filter/views/filter_condition_button",function(require){var e=require("works/components/filter/views/filter_condition_layer"),t=require("works/components/filter/collections/filter_condition_options"),n=require("hgn!works/components/filter/templates/filter_condition_button"),r=Backbone.View.extend({className:"btn_submenu",attributes:{"el-condition":""},initialize:function(e){this.type=e.type,this.fieldType=e.fieldType||e.type,this.valueType=e.valueType,this.deletable=e.deletable==0?!1:!0,this.isInstant=e.isInstant||!1,this.fields=e.fields,this.zIndex=e.zIndex,this.model.on("unusedItem",this._onChangeUsed,this),this.collection=new t(this.model.get("options")),this.collection.on("toggleOption",this._onToggleOption,this);if(this.model.isSelectValueType()){var n=this.model.get("values")?this.model.get("values").values:[];this.collection.setLabel(),this.collection.setUsed(n)}else this.model.isOrgType()&&this.collection.addConditionFromUsers(this.model.get("values").values);this.$el.on("setLabelText",$.proxy(function(){this._setLabelText()},this))},events:{"click span[el-delete]":"_onClickDelete"},render:function(){return this.$el.html(n({model:this.model.toJSON()})),this.model.isOrgType()&&this.$("a").addClass("fix_large"),this._setLabelText(),this._renderLayer(),this},_renderLayer:function(){var t={type:this.fieldType,fieldType:this.fieldType,valueType:this.valueType,parentCid:this.cid,model:this.model,fields:this.fields,zIndex:this.zIndex};this.model.isSelectTypeCondition()&&(t.collection=this.collection),this.$el.attr("backdrop-toggle",!0),this.filterLayer=new e(t),this.filterLayer.linkBackdrop(this.$el),this.filterLayer.toggle(this.isInstant),this.$el.append(this.filterLayer.render().el)},_onChangeUsed:function(){this.model.off("unusedItem"),this.remove(),this.model.collection.remove([this.model])},_onClickDelete:function(){this.filterLayer.afterHide(),this.model.set("isUsed",!1),this.model.collection.trigger("unuseCondition",this.model),this.$el.trigger("changeFilter"),this.remove(),this._removeDatepicker()},_onToggleOption:function(){var e=this.collection.getUsedOption();this.model.set("values",{values:e}),this._setLabelText()},_setLabelText:function(){var e=this.model.getLabelText();this.$("strong[el-type='fieldLabel']").text(e),this.$("strong[el-type='fieldLabel']").attr("title",e)},_removeDatepicker:function(){$("#ui-datepicker-div").empty()}});return r});