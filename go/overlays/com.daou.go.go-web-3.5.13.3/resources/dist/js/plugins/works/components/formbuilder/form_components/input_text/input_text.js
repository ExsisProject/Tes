define("works/components/formbuilder/form_components/input_text/input_text",function(require){require("jquery.go-validation");var e=require("app"),t=require("works/component_type"),n=require("works/components/formbuilder/core/form_component"),r=require("works/components/formbuilder/core/component_registry"),i=require("works/components/formbuilder/core/views/base_form"),s=require("works/components/formbuilder/core/views/base_detail"),o=require("works/components/formbuilder/core/views/base_option"),u=require("works/components/similar_layer/views/similar_layer"),a=require("works/components/formbuilder/form_components/input_text/input_text_validator"),f=require("hgn!works/components/formbuilder/form_components/input_text/form"),l=require("hgn!works/components/formbuilder/form_components/input_text/detail"),c=require("hgn!works/components/formbuilder/form_components/input_text/option"),h=require("works/collections/docs"),p=require("i18n!works/nls/works"),d=require("i18n!nls/commons"),v=require("works/libs/util"),m={"\uc774\ub984":d["\uc774\ub984"],"\uc911\ubcf5 \uac80\uc0ac \uc911\uc785\ub2c8\ub2e4.":d["\uc911\ubcf5 \uac80\uc0ac \uc911\uc785\ub2c8\ub2e4."],"\uc124\uba85":p["\uc124\uba85"],"\uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694":p["\uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."],"\uc124\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694":p["\uc124\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."],"\ud234\ud301\uc73c\ub85c \ud45c\ud604":p["\ud234\ud301\uc73c\ub85c \ud45c\ud604"],"\ud544\uc218 \uc785\ub825 \ucef4\ud3ec\ub10c\ud2b8":p["\ud544\uc218 \uc785\ub825 \ucef4\ud3ec\ub10c\ud2b8"],"\uae30\ubcf8\uac12":p["\uae30\ubcf8\uac12"],"\ucd5c\uc18c \uc785\ub825 \uc218":p["\ucd5c\uc18c \uc785\ub825 \uc218"],"\ucd5c\ub300 \uc785\ub825 \uc218":p["\ucd5c\ub300 \uc785\ub825 \uc218"],"\uc785\ub825 \ub108\ube44 \uc870\uc808":p["\uc785\ub825 \ub108\ube44 \uc870\uc808"],"\ud37c\uc13c\ud2b8\uc124\uba85":p["\ud37c\uc13c\ud2b8\uc124\uba85"],"\uc785\ub825\uac12 \uc720\ud6a8\uc131 \uccb4\ud06c":p["\uc785\ub825\uac12 \uc720\ud6a8\uc131 \uccb4\ud06c"],"\ubaa8\ub4e0 \uac12 \ud5c8\uc6a9":p["\ubaa8\ub4e0 \uac12 \ud5c8\uc6a9"],"\uc774\uba54\uc77c":d["\uc774\uba54\uc77c"],"\uc601\ubb38\uacfc\uc22b\uc790":p["\uc601\ubb38+\uc22b\uc790"],"\uc774\ub984\uc228\uae30\uae30":p["\uc774\ub984\uc228\uae30\uae30"],"\uc911\ubcf5 \uc785\ub825\uac12 \ub4f1\ub85d \ubd88\uac00":p["\uc911\ubcf5 \uc785\ub825\uac12 \ub4f1\ub85d \ubd88\uac00"],"\uc720\uc0ac \uc785\ub825\uac12 \uc790\ub3d9 \uac80\uc0c9":p["\uc720\uc0ac \uc785\ub825\uac12 \uc790\ub3d9 \uac80\uc0c9"],"\uc774\ubbf8 \ub4f1\ub85d\ub41c {{arg1}}\uc774(\uac00) \uc788\uc2b5\ub2c8\ub2e4.":p["\uc774\ubbf8 \ub4f1\ub85d\ub41c {{arg1}}\uc774(\uac00) \uc788\uc2b5\ub2c8\ub2e4."],"\uad00\ub9ac\uc790\uc5d0 \uc758\ud574 \ub9c8\uc2a4\ud0b9 \ucc98\ub9ac \ub41c \ud56d\ubaa9\uc785\ub2c8\ub2e4":p["\uad00\ub9ac\uc790\uc5d0 \uc758\ud574 \ub9c8\uc2a4\ud0b9 \ucc98\ub9ac \ub41c \ud56d\ubaa9\uc785\ub2c8\ub2e4"]},g={minLength:0,maxLength:100,width:100,widthUnit:"percent"},y=o.extend({customEvents:{"blur input[name=minLength], input[name=maxLength], input[name=width], input[type=text]":"_checkOptionValidate","keypress input[name=minLength], input[name=maxLength], input[name=width]":"onlyNumber","keyup input[name=minLength], input[name=maxLength], input[name=width]":"replaceNumber"},renderBody:function(){this.$el.html(c({lang:m,model:this.model.toJSON(),isWidthUnitPx:this.model.get("widthUnit")==="px"}))},_checkOptionValidate:function(e){var t=$(e.currentTarget),n=t.attr("name"),r=t.val();r==""&&_.has(g,n)&&(t.val(g[n]),this.model.set(n,g[n])),parseInt(this.$("input[name=minLength]").val())>parseInt(this.$("input[name=maxLength]").val())&&(this.$("input[name=minLength]").val(g.minLength),this.model.set("minLength",g.minLength)),n=="maxLength"&&r>2e3&&(t.val(2e3),this.model.set(n,2e3))},onlyNumber:function(e){var t=e.keyCode?e.keyCode:e.which;if(!v.isNumber(t))return e.preventDefault(),!1},replaceNumber:function(e){var t=e.keyCode?e.keyCode:e.which;if(!v.isNumber(t)){var n=$(e.currentTarget).val().replace(/[^0-9]/gi,"");return $(e.currentTarget).val(n),e.preventDefault(),!1}}}),b=i.extend({keyLogs:[],events:{"change input":"_onKeyup","click span[data-doc-id]":"_onClickDuplicateDoc"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.validator=new a,this.duplicateDocs=new h([],{appletId:this.appletId,fieldCid:this.clientId})},render:function(){var t=this.appletDocModel.get(this.clientId);if(!t){var n=this.model.get("defaultValue");n&&this.appletDocModel.set(this.clientId,n)}this.$body.html(f({model:this.model.toJSON(),label:e.util.escapeHtml(this.model.get("label")),clientId:this.clientId,inputValue:this._getInputValue(),isReadonly:this.isEditable(),"editable?":this.isEditable(),isMasking:this.isMasking(),lang:m})),this.resizeWidth(this.model.get("width"),this.model.get("widthUnit")==="percent"?"%":this.model.get("widthUnit")),this.model.get("similar")&&!this.isEditable()&&(this._renderSimilarLayer(),this.model.get("duplicate")||this.$el.on("clickSimilarItem",$.proxy(function(e,t){this.$("input").val(t),this.appletDocModel.set(this.getDataFromView()),this.similarLayer.timerToggle(!1,100,!0),this.similarLayer.docs.reset([])},this))),this.model.get("duplicate")&&this._validateDuplicate(),($.browser.mozilla||$.browser.opera)&&e.util.bindVirtualKeyEvent(this.$("input[type=text]"))},getFormData:function(){return this.isMultiple()&&this.appletDocModel.set(this.clientId,this._getMultipleData()),this.appletDocModel.toJSON()},getDataFromView:function(){var e,t={};return this.isMultiple()?(e=[],e.push($.trim(this.$("input[type=text]").val())),_.each(this.getMultipleViews(),function(t){e.push($.trim(t.$("input[type=text]").val()))})):e=$.trim(this.$("input[type=text]").val()),t[this.getCid()]=e,t},validate:function(){var e=0;return this._validate()||e++,this.isMultiple()&&_.each(this.getMultipleViews(),function(t){t._validate()||e++},this),e===0},_validate:function(){var e=this.$("input[type=text]"),t=e.val(),n=this.validator.validate({value:t},this.model.toJSON());if(n.isValid){if(this.model.get("duplicate")&&this.duplicateDocs.length&&t)return this._showDuplicateMessage(),!1}else this._printErrorTo(n.message);return n.isValid},resizeWidth:function(e,t){this._getInputElement().outerWidth(e+t)},_printErrorTo:function(e){var t=this.$("input[type=text]");t.trigger("focus"),this.printErrorTo(t,e)},_getInputElement:function(){return this.$("input[type=text]")},_getInputValue:function(){return this.appletDocModel.id?this.appletDocModel.get(this.getCid()):this.appletDocModel.get(this.getCid())||this.model.get("defaultValue")},_renderSimilarLayer:function(){this.similarLayer=new u({appletId:this.appletId,clientId:this.clientId,label:this.model.get("label"),linkEl:this.$("input")}),this.$("input").after(this.similarLayer.render().el)},_onKeyup:function(){function e(){this.duplicateTypingTimeout&&clearTimeout(this.duplicateTypingTimeout),this.duplicateTypingTimeout=setTimeout($.proxy(function(){this._validateDuplicate(),this.appletDocModel.set(this.getDataFromView())},this),300)}function t(){if(!this.model.get("similar"))return;this.similarSearchTypingTimeout&&clearTimeout(this.similarSearchTypingTimeout);var e=$.trim(this.$("input").val());this.similarSearchTypingTimeout=setTimeout($.proxy(function(){this.similarLayer.search(e,this.clientId)},this),300)}this.appletDocModel.set(this.getDataFromView()),this.model.get("duplicate")&&this._showDuplicateCheckMessage(),e.call(this),t.call(this)},_validateDuplicate:function(){var e=$.trim(this.$("input").val());if(!e){this.$("p.txt_error").remove();return}if(!this.model.get("duplicate"))return;this.model.get("similar")&&!this.isEditable()&&this.similarLayer.timerToggle(!1,200),this.duplicateDocs.duplicateSearch(e,this.appletDocModel.id).done($.proxy(function(){setTimeout($.proxy(function(){this.duplicateDocs.length?this._showDuplicateMessage():this.$("p.txt_error").remove()},this),100)},this))},_showDuplicateMessage:function(){var t=e.i18n(m["\uc774\ubbf8 \ub4f1\ub85d\ub41c {{arg1}}\uc774(\uac00) \uc788\uc2b5\ub2c8\ub2e4."],{arg1:this.model.get("label")}),n='<span class="btn_wrap"><span class="ic_classic ic_blank" data-doc-id="'+this.duplicateDocs.at(0).id+'" title="'+d["\ud31d\uc5c5\ubcf4\uae30"]+'"></span></span>';this.printErrorTo(this.$("input"),t+n)},_showDuplicateCheckMessage:function(){this.printErrorTo(this.$("input"),e.i18n(m["\uc911\ubcf5 \uac80\uc0ac \uc911\uc785\ub2c8\ub2e4."]))},_onClickDuplicateDoc:function(t){var n=$(t.currentTarget).attr("data-doc-id"),r="width=1280,height=700,status=yes,scrollbars=yes,resizable=yes";window.open(e.contextRoot+"app/works/applet/"+this.appletId+"/doc/"+n,"help",r)}}),w=s.extend({events:{"click a":"_onClickLink"},render:function(){var t=this.model.get("format")==="url",n=t?e.util.escapeHtml(this.getTitle()):e.util.textToHtml(this.getTitle());this.$body.html(l({isURL:t,model:this.model.toJSON(),label:e.util.escapeHtml(this.model.get("label")),userData:n,url:t?this._replaceToURL(n):"",isMasking:this.isMasking(),lang:m})),this.resizeWidth(this.model.get("width"),this.model.get("widthUnit")==="percent"?"%":this.model.get("widthUnit"))},getTitle:function(){return this.appletDocModel.get(this.clientId)},resizeWidth:function(e,t){this._getInputElement().outerWidth(e+t)},_onClickLink:function(e){return e.preventDefault(),window.open($(e.currentTarget).attr("href")),!1},_replaceToURL:function(e){return/https?:\/\//i.test(e)?e:"http://"+e},_getInputElement:function(){return this.$("input[type=text]")}}),E=n.define(t.Text,{name:p["\ud14d\uc2a4\ud2b8"],valueType:"STEXT",group:"basic",properties:{label:{defaultValue:p["\ud14d\uc2a4\ud2b8"]},hideLabel:{defaultValue:!1},guide:{defaultValue:""},guideAsTooltip:{defaultValue:!0},required:{defaultValue:!1},duplicate:{defaultValue:!1},similar:{defaultValue:!1},defaultValue:{defaultValue:""},minLength:{defaultValue:g.minLength},maxLength:{defaultValue:g.maxLength},width:{defaultValue:g.width},widthUnit:{defaultValue:g.widthUnit},format:{defaultValue:"all"}},OptionView:y,FormView:b,DetailView:w});r.addComponent(E)});