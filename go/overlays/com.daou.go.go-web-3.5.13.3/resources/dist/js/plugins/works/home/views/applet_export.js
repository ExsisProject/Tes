define("works/home/views/applet_export",function(require){var e=require("grid"),t=require("i18n!works/nls/works"),n=require("i18n!nls/commons"),r={"\uc0dd\uc131\uc77c":t["\uc0dd\uc131\uc77c"],"\uc571\uba85":t["\uc571\uba85"],"\uc678":t["\uc678"],"\uba85":n["\uba85"],"\ucd1d":t["\ucd1d"],"\ub0b4\ubcf4\ub0b4\uae30":t["\ub0b4\ubcf4\ub0b4\uae30"],"\uac1c\uc758 \uc571\uc774 \uc788\uc2b5\ub2c8\ub2e4.":t["\uac1c\uc758 \uc571\uc774 \uc788\uc2b5\ub2c8\ub2e4."],"\uc120\ud0dd\ub41c \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":n["\uc120\ud0dd\ub41c \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]};return Backbone.View.extend({gridView:null,events:_.extend({"click [data-export]":"_onClickExportBtn"},e.prototype.events),initialize:function(e){e=e||{},this.models=e.models},render:function(){return this.gridView=new e({tableClass:"type_normal",checkbox:!0,columns:this._getGridColumns(),collection:this.models,usePageSize:!0,useTableScroll:!0,useBottomButton:!0}),this.$el.append(this.gridView.render().el),this.gridView.$el.on("navigate:grid",function(e,t){}),this._renderCustomHeader(),this._renderCustomBottom(),this},_renderCustomHeader:function(){this.$el.find(".tool_bar .custom_header").append("<a class='btn_tool' data-export><span class='ic_toolbar out'></span><span class='txt'>"+r["\ub0b4\ubcf4\ub0b4\uae30"]+"</span></a><span class='desc'>"+r["\ucd1d"]+"<span class='num'>"+this.models.total+"</span>"+r["\uac1c\uc758 \uc571\uc774 \uc788\uc2b5\ub2c8\ub2e4."]+"</span>")},_renderCustomBottom:function(){this.$el.find(".tool_bar .custom_bottom").append("<a class='btn_tool' data-export><span class='ic_toolbar out'></span><span class='txt'>"+r["\ub0b4\ubcf4\ub0b4\uae30"]+"</span></a>")},_getGridColumns:function(){var e=this,n=[{name:"name",label:r["\uc571\uba85"],sortable:!0,className:"subject",render:function(e){return'<div class="app_list"><div class="wrap_img_ic"><img src="'+e.get("thumbSmall")+'"></div><span class="txt">'+e.get("name")+"</span></div>"}},{name:"createdAt",label:t["\ub4f1\ub85d\uc790"],sortable:!0,className:"name",render:function(e){return e.get("createdBy").name}},{name:"admins",label:t["\uc6b4\uc601\uc790"],sortable:!1,className:"name",render:function(e){var t=e.get("admins"),n=t[0].name;return t.length>1&&(n+=" "+r["\uc678"]+" "+(t.length-1)+r["\uba85"]),n}},{name:"createdAt",label:r["\uc0dd\uc131\uc77c"],sortable:!0,className:"date",render:function(e){return moment(e.get("createdAt")).format("YYYY-MM-DD")}}];return n},_onClickExportBtn:function(){var e=this.gridView.getCheckedIds();if(!e.length){$.goMessage(r["\uc120\ud0dd\ub41c \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]);return}var t=0;this._downloadFile(e,t)},_downloadFile:function(e,t){var n=this;if(t==e.length)return;var r=$("<iframe>").css("display","none").attr("src",GO.contextRoot+"api/works/applets/"+e[t]+"/export");$("body").append(r),setTimeout(function(){$(r).remove(),t+=1,n._downloadFile(e,t)},2e3)}})});