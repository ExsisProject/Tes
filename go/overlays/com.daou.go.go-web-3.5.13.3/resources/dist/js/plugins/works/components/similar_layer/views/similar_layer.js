define("works/components/similar_layer/views/similar_layer",function(require){var e=require("components/backdrop/backdrop"),t=require("hgn!works/components/similar_layer/templates/similar_layer"),n=require("works/collections/similar_docs"),r=require("i18n!works/nls/works"),i=require("i18n!nls/commons"),s=Hogan.compile(["<li>","<strong>{{label}}</strong>",'<a><span class="btn_wrap">','<span class="{{cssClass}} ic_blank" data-id="{{id}}" title="{{title}}"></span>',"</span></a>","</li>"].join(""));return e.extend({className:"similar_data",attributes:{style:"display: none;"},events:{"mousedown span[data-id]":"_onMouseDown","click span[data-id]":"_onClickDoc","click li":"_onClickItem"},initialize:function(e){this.backdropToggleEl=this.$el,this.bindBackdrop(),this.linkEl=e.linkEl,this.label=e.label,this.clientId=e.clientId,this.docs=new n([],{type:"score",appletId:e.appletId,fieldCid:e.clientId}),this.listenTo(this.docs,"sync",this._onSyncDocs),this.listenToOnce(this.docs,"sync",this._linkBackdrop)},render:function(){return this.$el.html(t({text:GO.i18n(r["\uc720\uc0ac\ud55c {{arg1}}\uc774(\uac00) \uc788\uc2b5\ub2c8\ub2e4."],{arg1:this.label})})),this},search:function(e){e?this.docs.similarSearch(e):(this.docs.reset([]),this.toggle(!1))},toggle:function(t){e.prototype.toggle.call(this,t),this.docs.length||this.backdropToggleEl.hide()},timerToggle:function(e,t,n){var r=setTimeout($.proxy(function(){this.toggle(e)},this),t);n||(this.timer=r)},_onSyncDocs:function(){this.toggle(!!this.docs.length),this._renderList()},_renderList:function(){this.$("ul").empty(),this.docs.each(function(e){this.$("ul").append(s.render({title:i["\ud31d\uc5c5\ubcf4\uae30"],id:e.id,label:e.get("values")[this.clientId]||"-",cssClass:GO.util.isMobile()?"ic_v2":"ic_classic"}))},this)},_linkBackdrop:function(){this.linkBackdrop(this.linkEl)},_onBackdrop:function(t){$(t.relatedTarget).closest(this.backdropToggleEl).length>0&&clearTimeout(this.timer),e.prototype._onBackdrop.call(this,t),this.docs.length||this.toggle(!1)},_onMouseDown:function(e){e.preventDefault()},_onClickDoc:function(e){var t=$(e.currentTarget).attr("data-id"),n=this.docs.get(t),r="width=1280,height=700,status=yes,scrollbars=yes,resizable=yes";window.open(GO.contextRoot+"app/works/applet/"+n.get("appletId")+"/doc/"+n.id,"help",r)},_onClickItem:function(e){this.$el.trigger("clickSimilarItem",$(e.currentTarget).find("strong").text())}})});