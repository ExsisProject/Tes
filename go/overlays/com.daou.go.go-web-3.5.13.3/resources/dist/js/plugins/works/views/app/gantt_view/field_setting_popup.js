define("works/views/app/gantt_view/field_setting_popup",function(require){var e=require("backbone"),t=require("works/components/list_manager/models/list_setting"),n=require("hgn!works/templates/app/gantt_view/field_setting_popup"),r=require("i18n!nls/commons"),i=require("i18n!works/nls/works"),s={"\uc81c\ubaa9":r["\uc81c\ubaa9"],"\uc2dc\uc791\ub0a0\uc9dc":i["\uc2dc\uc791 \ub0a0\uc9dc"],"\uc885\ub8cc\ub0a0\uc9dc":i["\uc885\ub8cc \ub0a0\uc9dc"],"\ub2f4\ub2f9\uc790":i["\ub2f4\ub2f9\uc790"],"\uc9c4\ud589\ub960":i["\uc9c4\ud589\ub960"],"\uc9c4\ud589\ub960\uc124\uba85":i["\uac04\ud2b8\ubdf0 \uc9c4\ud589\ub960 \uc124\uba85"],"\uc81c\ubaa9\uc120\ud0dd":i["\uc81c\ubaa9 \uc120\ud0dd"],"\uc2dc\uc791\ub0a0\uc9dc\uc120\ud0dd":i["\uc2dc\uc791\ub0a0\uc9dc \uc120\ud0dd"],"\uc885\ub8cc\ub0a0\uc9dc\uc120\ud0dd":i["\uc885\ub8cc\ub0a0\uc9dc \uc120\ud0dd"],"\ub2f4\ub2f9\uc790\uc120\ud0dd":i["\ub2f4\ub2f9\uc790 \uc120\ud0dd"],"\uc9c4\ud589\ub960\uc120\ud0dd":i["\uc9c4\ud589\ub960 \uc120\ud0dd"]};return e.View.extend({tagName:"form",initialize:function(e){this.options=e||{},this.appletId=this.options.appletId,this.fields=this.options.fields||[],this.ganttViewModel=this.options.ganttViewModel||{},this.setting=new t({},{appletId:this.appletId})},render:function(){this.titleFieldCid=this.ganttViewModel.get("titleFieldCid"),this.startFieldCid=this.ganttViewModel.get("startFieldCid"),this.endFieldCid=this.ganttViewModel.get("endFieldCid"),this.userFieldCid=this.ganttViewModel.get("userFieldCid"),this.progressFieldCid=this.ganttViewModel.get("progressFieldCid");if(!this.fetchedSetting&&_.isUndefined(this.titleFieldCid)&&!this.ganttViewModel.hasStartEndField()){this.setting.fetch({async:!1}),this.fetchedSetting=this.setting.toJSON();var e=this.fetchedSetting.columns[this.fetchedSetting.titleColumnIndex];this.titleFieldCid=e?e.fieldCid:undefined}var t=this.getTitleFields(this.fields),r=this.getProgressFields(this.fields);this.$el.html(n({lang:s,titleFields:t,dateFields:this.getDateFields(this.fields),userFields:this.getUserFields(this.fields),progressFields:r,isTitleFieldEmpty:t.length==0,isProgressFieldEmpty:r.length==0})),this.$el.find("#title_setting option[value="+this.titleFieldCid+"]").prop("selected",!0),this.$el.find("#startdate_setting option[value="+this.startFieldCid+"]").prop("selected",!0),this.$el.find("#enddate_setting option[value="+this.endFieldCid+"]").prop("selected",!0),this.$el.find("#user_setting option[value="+this.userFieldCid+"]").prop("selected",!0),this.$el.find("#progress_setting option[value="+this.progressFieldCid+"]").prop("selected",!0)},getDateFields:function(e){return _.filter(e,function(e){return e.valueType=="DATE"||e.valueType=="DATETIME"})},getTitleFields:function(e){return _.filter(e,function(e){return e.valueType=="STEXT"})},getUserFields:function(e){return _.filter(e,function(e){return e.valueType=="USERS"||e.valueType=="USER"})},getProgressFields:function(e){return _.filter(e,function(e){return e.valueType=="NUMBER"&&e.properties.dataType=="PERCENT"})}})});