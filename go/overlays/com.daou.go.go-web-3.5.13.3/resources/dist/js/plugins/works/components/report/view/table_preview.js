define("works/components/report/view/table_preview",function(require){var e=require("backbone"),t=require("hgn!works/components/report/template/table_preview"),n=require("hgn!works/components/report/template/item_empty_preview"),r=require("i18n!works/nls/works"),i={COUNT:r["\uac1c\uc218"],SUM:r["\ud569\uacc4"],AVG:r["\ud3c9\uade0"],MAX:r["\ucd5c\ub300\uac12"],MIN:r["\ucd5c\uc18c\uac12"]};return e.View.extend({initialize:function(e){this.options=e||{},this.chartFields=e.chartFields},render:function(e){if(e)return this._renderEmptyPreview(r["\ub9ac\ud3ec\ud2b8 \uc544\uc774\ud15c \ucef4\ud3ec\ub10c\ud2b8 \uc0ad\uc81c \uacbd\uace0"]),this;var n=this.model.get("values");if(n.length<1)return this._renderEmptyPreview(r["\ud45c\uc2dc\ud560 \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc120\ud0dd\ud558\uc2e0 \uae30\uc900\uceec\ub7fc\uacfc \ubcf4\uc870\uceec\ub7fc\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694."]),this;this.$el.empty(),this.$el.append(t({title:this.model.get("title"),aggMethodLang:i[this.model.aggMethod]}));var s=this.model.get("keySet"),o="<tr>",u=this;return _.each(s,function(e){var t=u._getCidByKey(e),n=u.chartFields.findByCid(t).toJSON();o+='<th class="col"><span class="title">',o+=n.label,o+="</span></th>"}),o+="</tr>",_.each(n,function(e){o+="<tr>",_.each(s,function(t){o+='<td class="col">',o+=u._convertPrintFormat(e[t],t),o+="</td>"}),o+="</tr>"}),this.$("[table-content-wrap]").append(o),this},_renderEmptyPreview:function(e){this.$el.append(n({lang:{msg:e}}))},_convertPrintFormat:function(e,t){if(!e)return"-";var n=this._getCidByKey(t),r=this._getCidByMethod(t),i=this.chartFields.findByCid(n);if(!i)return e;var s=i.get("valueType");if(!r&&"NUMBER"!=s.toUpperCase())return e;if(r&&"COUNT"==r.toUpperCase())return GO.util.formatNumber(e,{decimalPoints:0});var o=i.get("properties");if(o){var u=o.dataType?o.dataType:"NUMBER";if("PERCENT"==u)return parseFloat(e).toFixed(0)+" "+"%";if("POINT"==u)return parseFloat(e).toFixed(0);var a=parseFloat(e).toFixed(o.decimalPoints);return GO.util.formatNumber(a,{decimalPoints:o.decimalPoints})}return e},_getCidByKey:function(e){return e?e.indexOf("|")>0?e.split("|")[0]:e:"-"},_getCidByMethod:function(e){return e?e.indexOf("|")>1?e.split("|")[1]:"":""}})});