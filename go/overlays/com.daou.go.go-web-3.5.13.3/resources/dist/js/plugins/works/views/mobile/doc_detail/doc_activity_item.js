define("works/views/mobile/doc_detail/doc_activity_item",function(require){var e=require("backbone"),t=require("app"),n=require("hgn!works/templates/mobile/doc_detail/doc_activity_item"),r=require("attach_file"),i=require("views/mobile/m_font_resize"),s=require("i18n!nls/commons"),o=require("i18n!works/nls/works"),u={edit:s["\uc218\uc815"],"delete":s["\uc0ad\uc81c"],comment:s["\ub313\uae00"]};return e.View.extend({events:{"swipeleft #activityItemWrapper":"seeNext","swiperight #activityItemWrapper":"seePrevious","click #deleteActivityBtn":"destroyConfirm","click #editActivityBtn":"editActivity","click #goCommentList":"goCommentList"},initialize:function(e){this.activity=e.model,this.appletId=e.appletId,this.docId=e.docId,this.model.set("appletId",this.appletId),this.model.set("docId",this.docId),this.editorId="activityEditor"+this.activity.get("id"),this.originalScale=1},render:function(){return this.$el.html(n({content:GO.util.escapeXssFromHtml(this.activity.get("content")),lang:u,data:this.activity.toJSON(),snsDate:GO.util.snsDate(this.activity.get("updatedAt")?this.activity.get("updatedAt"):this.activity.get("createdAt")),commentPresent:this.activity.commentPresent()})),$("#content").css("visibility","hidden"),$("#doc_header").css("visibility","visible"),this.renderAttachView(),this.resizeContent(),this},renderAttachView:function(){var e=this;this.attachView=r.create("#attachArea"+this.activity.id,this.activity.get("attaches"),function(t){return GO.contextRoot+"api/works/activity/"+e.model.id+"/download/"+t.id})},resizeContent:function(){var e=this;setTimeout(function(){e.decideIscrollInit(),e.fontResizeLayerAdd()},500)},decideIscrollInit:function(){$(document).width()<$("#activityContent").width()?(this.iscroll=GO.util.initDetailiScroll("activityItemWrapper","iScrollContentWrap","activityContentWrapper"),this.originalScale=this.iscroll.options.zoomMin):$("#content").css("visibility","visible")},fontResizeLayerAdd:function(){i.render({el:"#fontResizeWrap",targetContentEl:"#activityContent"})},editActivity:function(){if(/<.*>.*<\/.*>/.test(this.model.get("content"))){alert(o["PC\uc5d0\uc11c \ub4f1\ub85d\ud55c \uc5c5\ubb34\ub294 \ubaa8\ubc14\uc77c\uc5d0\uc11c \uc218\uc815\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]);return}t.router.navigate("works/applet/"+this.appletId+"/doc/"+this.docId+"/activity/"+this.activity.get("id"),!0)},destroyConfirm:function(){confirm(s["\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"])&&this.destroyActivity()},destroyActivity:function(){var e=this;this.activity.destroy({success:function(){alert(s["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),t.router.navigate("works/applet/"+e.appletId+"/doc/"+e.docId+"/activities",!0)},error:function(){console.log("error")}})},isPageMovable:function(){var e=$("#iScrollContentWrap").css("transform"),t=e.replace("matrix(","").split(",")[0];return Number(t).toFixed(6)==this.originalScale.toFixed(6)},seeNext:function(e){$("#rightBtn").length>0&&this.isPageMovable()&&$("#rightBtn").trigger("click")},seePrevious:function(e){$("#leftBtn").length>0&&this.isPageMovable()&&$("#leftBtn").trigger("click")},goCommentList:function(){t.router.navigate("works/applet/"+this.appletId+"/doc/"+this.docId+"/activity/"+this.activity.get("id")+"/comment",!0)}})});