define("works/search/models/search",function(require){var e=require("models/base_model"),t=require("works/collections/fields"),n=require("collections/paginated_collection"),r=n.extend({fetch:function(){this.trigger("fetch",{pageNo:this.pageNo})}});return e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments),this.collection=new r,this.listenTo(this.collection,"fetch",this.fetch)},url:function(){return GO.contextRoot+"api/search/works?"+this.makeParam()},fetch:function(t){return t=t||{},this.page=t.pageNo||0,e.prototype.fetch.apply(this,arguments)},parse:function(e){return this.collection.page=e.data.docs.pageInfo,this.collection.total=e.data.docs.pageInfo.total,this.collection.pageNo=e.data.docs.pageInfo.page,this.collection.pageSize=e.data.docs.pageInfo.offset,this.collection.lastPage=e.data.docs.pageInfo.lastPage,this.collection.reset(e.data.docs.content),e.data},setParam:function(e){_.each(e,function(e,t){this[t]=e},this)},makeParam:function(){var e={keyword:this.keyword||"",content:_.isUndefined(this.content)?!0:this.content,page:this.page||0,offset:this.offset||15};return this.authorName&&(e.authorName=this.authorName),_.isUndefined(this.comments)||(e.comments=this.comments),_.isUndefined(this.attachFileNames)||(e.attachFileNames=this.attachFileNames),_.isUndefined(this.activityContents)||(e.activityContents=this.activityContents),_.isUndefined(this.attachFileContents)||(e.attachFileContents=this.attachFileContents),this.fromDate&&(e.fromDate=this.fromDate),this.toDate&&(e.toDate=this.toDate),this.appletId&&(e.appletId=this.appletId),this.appletName&&(e.appletName=this.appletName),$.param(e)},getCollection:function(){return this.collection},parseViewDatas:function(){return _.map(this.get("docs").content,function(e){var n=_.findWhere(this.get("appletSummaries"),{id:e.appletId}),r=n.thumbSmall||"",i=n.titleCid||"",s=n.fields,o=new t(s),u=o.getColumnFields(),a=e.values[i]||"",f=u.map(function(t){var n=t.getDisplayValue(new Backbone.Model(e),t.get("properties")),r=_.isArray(n)?n.join(", "):n;return t.get("cid")==i&&(a=r),t.get("label")+": "+r});return{id:e.id,appletId:e.appletId,title:a,createdAt:GO.util.basicDate3(e.values.create_date),content:f,creator:e.values.creator?GO.util.userLabel(e.values.creator):"",appletName:n.name,appletIcon:r}},this)}})});