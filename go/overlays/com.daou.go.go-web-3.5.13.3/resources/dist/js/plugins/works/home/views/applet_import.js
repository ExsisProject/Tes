define("works/home/views/applet_import",function(require){var e=require("grid"),t=require("works/home/views/applet_import_popup"),n=require("hgn!works/home/templates/applet_import_popup"),r=require("i18n!works/nls/works"),i=require("i18n!nls/commons"),s={"\uc0dd\uc131\uc77c":r["\uc0dd\uc131\uc77c"],"\uc571\uba85":r["\uc571\uba85"],"\uc678":r["\uc678"],"\ucd1d":r["\ucd1d"],"\ud30c\uc77c\ucc3e\uae30":i["\ud30c\uc77c\ucc3e\uae30"],"\ud30c\uc77c \uc5c5\ub85c\ub4dc":r["\ud30c\uc77c \uc5c5\ub85c\ub4dc"],"\uac1c\uc758 \uac00\uc838\uc628 \uc571\uc774 \uc788\uc2b5\ub2c8\ub2e4.":r["\uac1c\uc758 \uac00\uc838\uc628 \uc571\uc774 \uc788\uc2b5\ub2c8\ub2e4."],"\ube44\uacf5\uac1c":r["\ube44\uacf5\uac1c"],"\uacf5\uac1c":r["\uacf5\uac1c"],"\uc0ad\uc81c":i["\uc0ad\uc81c"],"\uc804\uc0ac\uacf5\uc720":r["\uc804\uc0ac\uacf5\uc720"]};return Backbone.View.extend({gridView:null,popupView:null,events:_.extend({"click [data-import]":"_onClickImportBtn","click a[data-select-file]":"_onClickSelectFile","click [data-select-delete]":"_onClickSelectionDelete","click [data-public-config]":"_onClickPublicConfigItem"},e.prototype.events),initialize:function(e){e=e||{},this.collection=e.models},render:function(){return this.gridView=new e({tableClass:"type_normal",checkbox:!1,columns:this._getGridColumns(),collection:this.collection,usePageSize:!0,useTableScroll:!0,useBottomButton:!0}),this.$el.append(this.gridView.render().el),this.gridView.$el.on("navigate:grid",function(e,t){}),this._renderCustomHeader(),this._renderCustomBottom(),this},_renderCustomHeader:function(){this.$el.find(".tool_bar .custom_header").append("<a class='btn_tool' data-import><span class='ic_toolbar search'></span><span class='txt'>"+s["\ud30c\uc77c\ucc3e\uae30"]+"</span></a><span class='desc'>"+s["\ucd1d"]+"<span class='num'>"+this.collection.total+"</span>"+s["\uac1c\uc758 \uac00\uc838\uc628 \uc571\uc774 \uc788\uc2b5\ub2c8\ub2e4."]+"</span>")},_renderCustomBottom:function(){this.$el.find(".tool_bar .custom_bottom").append("<a class='btn_tool' data-import><span class='ic_toolbar search'></span><span class='txt'>"+s["\ud30c\uc77c\ucc3e\uae30"]+"</span></a>")},_getGridColumns:function(){var e=this,t=[{label:"No",sortable:!1,className:"num",render:function(e){return e.collection.indexOf(e)+1}},{name:"name",label:s["\uc571\uba85"],sortable:!0,className:"subject",render:function(e){return'<div class="app_list"><span class="txt">'+e.get("name")+"</span></div>"}},{name:"createdAt",label:r["\ub4f1\ub85d\uc790"],sortable:!0,className:"name",render:function(e){return e.get("requester").name}},{name:"createdAt",label:s["\uc0dd\uc131\uc77c"],sortable:!0,className:"date",render:function(e){return moment(e.get("createdAt")).format("YYYY-MM-DD")}},{name:"publicConfig",label:s["\uc804\uc0ac\uacf5\uc720"],sortable:!1,className:"toggle",render:function(e){var t="on"==e.get("publicConfig")?s["\uacf5\uac1c"]:s["\ube44\uacf5\uac1c"];return'<span class="device_access_setting ic_control ic_ctrl_'+e.get("publicConfig")+'" title="'+t+'" data-public-config data-template-id="'+e.get("templateId")+'"></span>'}},{name:"delete",label:s["\uc0ad\uc81c"],sortable:!1,className:"del",render:function(e){var t="on"==e.get("publicConfig")?"none":"block";return'<span class="ic_side ic_basket_bx" title = "'+s["\uc0ad\uc81c"]+'" data-select-delete data-template-id="'+e.get("templateId")+'" style="display: '+t+'"></span>'}}];return t},_onClickSelectionDelete:function(e){var t=this,n=$(e.currentTarget),r=n.attr("data-template-id");console.log(r),$.goCaution(i["\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],"",function(){$.ajax({type:"DELETE",contentType:"application/json",url:GO.contextRoot+"api/works/templates/"+r,success:function(e){t.collection.fetch(),$.goMessage(i["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},error:function(e){$.goError(i["\uad00\ub9ac \uc11c\ubc84\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4"])}}).done(function(e){})},s["\uc0ad\uc81c"])},_onClickPublicConfigItem:function(e){var t=$(e.currentTarget),n=t.attr("data-template-id"),i=t.hasClass("ic_ctrl_on");i?this._renderPublicConfigPopup("off",n,r["\uacf5\uc720\ud55c \uc571\uc744 \ud574\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],r["\uc571 \uacf5\uc720 \ud574\uc81c \uc124\uba85"],r["\ud574\uc81c\ud558\uae30"]):this._renderPublicConfigPopup("on",n,r["\uac00\uc838\uc628 \uc571\uc744 \uacf5\uc720\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],r["\uc571 \uacf5\uc720 \uc124\uba85"],r["\uacf5\uc720\ud558\uae30"])},_renderPublicConfigPopup:function(e,t,n,r,s){var o=this;$.goPopup({pclass:"layer_normal new_layer layer_works_new new_wide",header:n,modal:!0,width:450,contents:'<p class="desc">'+r+"</p>",buttons:[{btext:s,autoclose:!0,btype:"confirm",callback:function(){$.ajax({type:"PUT",contentType:"application/json",url:GO.contextRoot+"api/works/templates/"+t+"/public/"+e,success:function(n){o._updatePublicConfig(t,e),$.goMessage(i["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},error:function(e){$.goError(i["\uad00\ub9ac \uc11c\ubc84\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4"])}})}},{btext:i["\ub2eb\uae30"],btype:"cancel"}]})},_updatePublicConfig:function(e,t){var n="off"==t,r=n?s["\ube44\uacf5\uac1c"]:s["\uacf5\uac1c"],i=this.$("[data-id="+e+"]");i.find("[data-select-delete]").toggle(n),i.find("[data-public-config]").attr("title",r),i.find("[data-public-config]").removeClass("ic_ctrl_on ic_ctrl_off"),i.find("[data-public-config]").addClass("ic_ctrl_"+t)},_onClickImportBtn:function(e){this._popupLayer()},_popupLayer:function(){var e=this;this.popupLayer=$.goPopup({header:s["\ud30c\uc77c \uc5c5\ub85c\ub4dc"],pclass:"layer_normal layer_upload",width:550,buttons:[{btext:i["\ub2eb\uae30"],btype:"normal",callback:function(){e.collection.fetch()}}]}),this.popupView=new t({}),this.popupLayer.find("div.content").append(this.popupView.render().el),this.popupView.initFileUpload(),this.popupView.$el.on("renderingComplete",$.proxy(function(){this.popupLayer.reoffset()},this))},_makeParam:function(e){return _.map(e,function(e){return"ids="+e}).join("&")}})});