define("works/components/alarm_setting/views/alarm_setting",function(require){var e=require("i18n!nls/commons"),t=require("i18n!works/nls/works"),n=require("hgn!works/components/alarm_setting/templates/alarm_setting"),r=Hogan.compile(['<li data-unit="{{unit}}" data-number="{{number}}">','<span class="minor">{{lang.\uc54c\ub78c}}: {{number}} {{label}}</span>','<span class="btn_border">','<span class="ic ic_delete" data-delete></span>',"</span>","</li>"].join("")),i=_.extend(e,t,{MINUTE:e["\ubd84 \uc804"],HOUR:e["\uc2dc\uac04 \uc804"],DAY:e["\uc77c \uc804"]});return Backbone.View.extend({events:{"click [data-add-time]":"_onClickAddTimeItem","click [data-delete]":"_onClickDeleteTimeItem"},initialize:function(e){e=e||{},this.userFields=e.userFields,this.useMinute=e.useMinute!==!1,this.useHour=e.useHour!==!1,this.alarms=e.alarms||{}},render:function(){return this.$el.html(n({userFields:this.userFields.toJSON(),useMinute:this.useMinute,useHour:this.useHour,alarms:this.alarms,lang:i})),this._setData(),this},getData:function(){var t=this.$("li[data-unit][data-number]"),n=_.map(t,function(e){var t=$(e);return{type:t.attr("data-unit"),time:t.attr("data-number")}}),r=_.map(this.$("[data-method]").find("input:checked"),function(e){return $(e).val()}),i=r.length===2?"ALL":r[0],s=_.map(this.$("[data-targets]").find("input:checked"),function(e){return $(e).val()});if(!n.length||!r.length||!s.length){$.goMessage(e["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]);return}return{timers:n,method:i,targets:s}},_setData:function(){_.each(this.alarms.timers,function(e){this._addTime(e.time,e.type)},this),_.each(this.alarms.targets,function(e){this.$('input[value="'+e+'"]').attr("checked",!0)},this);var e=this.alarms.method==="ALL"?["NOTIFICATION","MAIL"]:[this.alarms.method];_.each(e,function(e){this.$('input[value="'+e+'"]').attr("checked",!0)},this)},_onClickAddTimeItem:function(){var e=this.$("[data-number]").val(),t=this.$("[data-unit]").val();if(!e||!t)return;this._addTime(e,t)},_addTime:function(t,n){var s=this.$("li[data-unit][data-number]");if(s.length>=3){$.goMessage(e["\ucd5c\ub300 3\uac1c\uae4c\uc9c0\ub9cc \uc124\uc815\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4"]);return}var o=!!this.$('li[data-unit="'+n+'"][data-number="'+t+'"]').length;if(o){$.goMessage(e["\ub3d9\uc77c\ud55c \uc2dc\uac04\ub300\ub294 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"]);return}this.$("[data-time-list-wrapper]").show(),this.$("[data-time-list]").append(r.render({number:t,unit:n,label:i[n],lang:i}))},_onClickDeleteTimeItem:function(e){$(e.target).closest("li").remove();var t=this.$("[data-time-list-wrapper]");t.find("li").length||t.hide()}})});