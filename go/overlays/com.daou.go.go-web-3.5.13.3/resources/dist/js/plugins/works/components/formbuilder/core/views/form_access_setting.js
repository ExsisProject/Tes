define("works/components/formbuilder/core/views/form_access_setting",function(require){var e=require("app"),t=require("works/components/formbuilder/core/views/toolbox_pane"),n=require("views/circle"),r=require("hgn!works/components/formbuilder/core/templates/form_access_setting"),i=require("i18n!works/nls/works"),s=require("i18n!board/nls/board"),o=require("i18n!admin/nls/admin"),u=require("i18n!nls/commons"),a=require("works/components/formbuilder/constants");require("jquery.ui"),require("jquery.go-popup"),require("jquery.go-sdk"),require("jquery.go-orgslide");var f={"\ud3fc \uad8c\ud55c\uad00\ub9ac":i["\ud3fc \uad8c\ud55c\uad00\ub9ac"],"\ud3fc \uc774\ub984":i["\ud3fc \uc774\ub984"],"\uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694":i["\uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."],"\ube44\uacf5\uac1c":i["\ube44\uacf5\uac1c"],"\uacf5\uac1c":i["\uacf5\uac1c"],"\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd":o["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"],"\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd":o["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"],"\uba54\uc778\ud3fc \uc124\uba85":i["\uba54\uc778\ud3fc \uc124\uba85"],"\uacf5\uac1c \uc124\uc815":s["\uacf5\uac1c \uc124\uc815"]},l=t.extend({className:"builder_side_box component-option",title:i["\ud3fc \uad8c\ud55c\uad00\ub9ac"],useResizer:!1,titleWrapClassname:"title_attr_edit",contentWrapClassname:"tool_attr",events:_.extend({"click #selectAccessPolicy input:radio":"_changeAccessSetting",'keyup input[name="name"]':"_keyupCheckFormNameLength"},t.prototype.events),initialize:function(e){e=e||{},t.prototype.initialize.apply(this,arguments),this.observer=null,e.hasOwnProperty("observer")&&(this.observer=e.observer),this.appletFormModel=e.appletFormModel,this.mainForm=this.appletFormModel.mainForm,this.name=this.appletFormModel.name,this.accessSetting=this.appletFormModel.accessSetting,this.accessTarget=this.appletFormModel.accessTarget,this.exceptionTarget=this.appletFormModel.exceptionTarget,this.listenTo(this.observer,a.REQ_SAVE,this._requestSave)},render:function(){this.$el.find(".tool_attr").off();var e="form-component-option",t=$('<div class="scroll-inner"><ul class="form-component-option"></ul></div>');this.$(".toolbox-content").append(t),this.$(".form-component-option").append(r({formName:this.name,mainForm:this.mainForm,lang:f})),this._renderAccessUserView(),this._renderExceptionUserView();var n=this.accessSetting;$('input[name="accessSetting"][value="'+n+'"]').attr("checked",!0),"black"==n?($("#selectedClass").text(o["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClass").text(o["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClassToolTip").text(o["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):($("#selectedClass").text(o["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClass").text(o["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClassToolTip").text(o["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"]));var i=this;this.$el.find("input[name='name']").on("change",function(){i._triggerModelUpdate()})},_renderAccessUserView:function(){var e=["user","position","grade","usergroup"];GO.util.isUseOrgService(!1)&&(e=["user","department","position","grade","duty","usergroup"]);var t=function(){this._triggerModelUpdate()};this.accessUserView=new n({selector:"#accessUser",isAdmin:!1,isWriter:!0,circleJSON:this.accessTarget,nodeTypes:e,isWorksSetting:!0,addCallback:$.proxy(t,this),removeCallback:$.proxy(t,this)}),this.accessUserView.render()},_renderExceptionUserView:function(){var e=["user","position","grade","usergroup"];GO.util.isUseOrgService(!1)&&(e=["user","department","position","grade","duty","usergroup"]);var t=function(){this._triggerModelUpdate()};this.exceptionUserView=new n({selector:"#exceptionUser",isAdmin:!1,isWriter:!0,circleJSON:this.exceptionTarget,nodeTypes:e,isWorksSetting:!0,addCallback:$.proxy(t,this),removeCallback:$.proxy(t,this)}),this.exceptionUserView.render()},_keyupCheckFormNameLength:function(t){var n=$(t.currentTarget);$.goValidation.isCheckLength(1,100,n.val())||$.goSlideMessage(e.i18n(o["{{arg1}}\uc740(\ub294) {{arg2}}\uc790\uc774\uc0c1 {{arg3}}\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:i["\ud3fc \uc774\ub984"],arg2:"1",arg3:"100"})),n.focus()},_changeAccessSetting:function(e){$(e.currentTarget).val()=="black"?($("#selectedClass").text(o["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClass").text(o["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClassToolTip").text(o["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):($("#selectedClass").text(o["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClass").text(o["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClassToolTip").text(o["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])),this._confirmDeleteTarget(e)},_confirmDeleteTarget:function(e){var t=this,n=function(){$(e.currentTarget).val()=="black"?($('input[name="accessSetting"][value="white"]').attr("checked",!0),$("#selectedClass").text(o["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClass").text(o["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClassToolTip").text(o["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):($('input[name="accessSetting"][value="black"]').attr("checked",!0),$("#selectedClass").text(o["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClass").text(o["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),$("#exceptedClassToolTip").text(o["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"]))},r=function(){t.accessUserView.deleteAllData(),t.exceptionUserView.deleteAllData(),t._triggerModelUpdate()};$.goConfirm(o["\uc815\ucc45 \uc124\uc815 \ubcc0\uacbd \ud655\uc778"],"",r,n,u["\ud655\uc778"])},_requestSave:function(e,t,n){var r=this.__getAccessSettingData();r.data=e,this.observer.trigger(a.REQ_FORM_SAVE,r,t,n)},_triggerModelUpdate:function(){this.observer.trigger(a.EVENT_UPDATE_FORM_ACCESS_SETTING,this.__getAccessSettingData())},__getAccessSettingData:function(){var e=_.isEmpty(this.$(":text[name='name']").val())?this.name:this.$(":text[name='name']").val();return{name:e,accessSetting:$(":radio[name='accessSetting']:checked").val(),accessTarget:this.accessUserView.getData(),exceptionTarget:this.exceptionUserView.getData()}},toggleContent:function(e){t.prototype.toggleContent.apply(this,arguments),e||!1?this.$("."+this.titleWrapClassname).removeClass("off"):this.$("."+this.titleWrapClassname).addClass("off"),e&&this.observer.trigger(a.EVENT_FOLD_ACCESS_PANNEL)},getMarginHeight:function(){var e=40;return this.$(".toolbox-title").outerHeight()+e}});return l});