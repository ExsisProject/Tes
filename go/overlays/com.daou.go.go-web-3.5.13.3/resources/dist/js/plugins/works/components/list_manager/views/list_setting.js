define("works/components/list_manager/views/list_setting",function(require){var e=require("i18n!works/nls/works"),t=require("i18n!docs/nls/docs"),n=require("works/components/list_manager/models/list_column"),r=require("works/components/list_manager/views/list_manager_column_item"),i=require("works/components/list_manager/views/list_manager_column_add_button"),s=require("hgn!works/components/list_manager/templates/list_setting"),o={"\ubb38\uc11c\ubc88\ud638 \uc0ac\uc6a9\uc720\ubb34":e["\ubb38\uc11c\ubc88\ud638 \uc0ac\uc6a9\uc720\ubb34"],"\ubb38\uc11c\ubc88\ud638 \uc9c1\uc811 \uc124\uc815":e["\ubb38\uc11c\ubc88\ud638 \uc9c1\uc811 \uc124\uc815"],"\ubb38\uc11c\ubc88\ud638 \uc790\ub3d9 \uc124\uc815":e["\ubb38\uc11c\ubc88\ud638 \uc790\ub3d9 \uc124\uc815"],"\uc22b\uc790 1\ubd80\ud130 \uc790\ub3d9 \ub4f1\ub85d":e["\uc22b\uc790 1\ubd80\ud130 \uc790\ub3d9 \ub4f1\ub85d"],"2\uc790\ub9ac":e["2\uc790\ub9ac"],"3\uc790\ub9ac":e["3\uc790\ub9ac"],"4\uc790\ub9ac":e["4\uc790\ub9ac"],"5\uc790\ub9ac":e["5\uc790\ub9ac"]},u={cid:"docNo",label:t["\ubb38\uc11c\ubc88\ud638"],fieldType:"docNo",valueType:"STEXT",options:[],multiple:!1};return Backbone.View.extend({events:{"change #notUseDocNo":"_onChangeIsUseDocNo"},initialize:function(e){this.isPrivate=e.isPrivate,this.columns=e.columns,this.fields=e.fields,this.setting=e.setting,this.docNoConfig=e.setting.get("docNoConfig"),this.columns.reset(this.setting.get("columns")),this.columns.setTitleColumnByIndex(this.setting.get("titleColumnIndex")),this.columns.setSortColumnByIndex(this.setting.get("sortColumnIndex"),this.setting.get("sortDirection")),this.columns.reset(this.columns.filterByFields(this.fields.toJSON())),this.columns.mergeFromFields(this.fields.toJSON()),this.columns.on("unuseColumn",this._onUnuseColumn,this),this.columnFields=this.fields.getColumnFields(),this.columnFields.mergeFromColumns(this.columns.toJSON()),this.fields.off("toggleOption"),this.fields.on("toggleOption",this._onToggleFieldOption,this),this.$el.on("setTitleColumn",$.proxy(function(e,t){this._setTitleColumn(t)},this)),this.$el.on("setSortColumn",$.proxy(function(e,t,n){this._setSortColumn(t,n)},this))},render:function(){return this.$el.html(s({lang:o,useDocNo:this.docNoConfig.useDocNo,isPrivate:this.isPrivate})),this._renderColumns(),this._renderColumnAddButton(),this._renderDocNoConfig(),this._initColumnSortable(),this},getSetting:function(){this.setting.set("sortColumnIndex",this.columns.getSortColumnIndex()),this.setting.set("sortDirection",this.columns.getSortDirection()),this.setting.set("columns",this.columns.toJSON())},_renderColumns:function(){this.$("#columns").empty();var e=this.columns.filterByFields(this.fields.toJSON());_.each(e,function(e){this._addColumn(e,this.columns)},this)},_renderColumnAddButton:function(){var e=new i({collection:this.columnFields});this.$("div[el-button-area]").html(e.render().el)},_renderDocNoConfig:function(){var e=this.docNoConfig.docNoType||"simple";e=="simple"?this.$("#simple").prop("checked",!0).trigger("change"):this.$("#custom").prop("checked",!0).trigger("change"),this.$("#customPrefix").val(this.docNoConfig.customPrefix),this.$("#customDigit").val(this.docNoConfig.customDigit)},_initColumnSortable:function(){this.$("#columns").sortable({axis:"x",tolerance:"pointer",cursor:"move",placeholder:{element:function(){return"<td class='blank_box'><div><span></span></div></td>"},update:function(){return}},stop:$.proxy(function(){var e=_.map(this.$("#columns").find("[el-cid]"),function(e){return $(e).attr("el-cid")},this);this.columns.reIndex(e)},this)}),this.$("#columns").find("td").css("cursor","move")},_addColumn:function(e,t){var n=new r({model:e,isPrivate:this.isPrivate,columns:t});this.$("#columns").append(n.render().el)},_onUnuseColumn:function(e){var t=this.columnFields.findWhere({cid:e.get("fieldCid")});t.set("isUsed",!1),this.columns.remove([e])},_onToggleFieldOption:function(e){var t,r=e.get("isUsed");if(r){var i=e.fieldToColumn();t=new n(i),this.columns.push(t),this._addColumn(t,this.columns)}else t=this.columns.findWhere({fieldCid:e.get("cid")}),t&&t.trigger("unusedItem",[t])},_setTitleColumn:function(t){this.columns.setTitleColumnByFieldCid(t),this._renderColumns(),$.goMessage(e["\uc120\ud0dd\ud55c \ud56d\ubaa9\uc774 \uc81c\ubaa9 \uc18d\uc131\uc73c\ub85c \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},_setSortColumn:function(e,t){this.columns.setSortColumnByFieldCid(e,t),this._renderColumns()},_onChangeIsUseDocNo:function(e){var t=!$(e.currentTarget).is(":checked");if(t)this.fields.add([u]);else{var n=this.fields.findWhere({cid:u.cid});n.set({isUsed:!1}),this._onToggleFieldOption(n),this.fields.remove([n])}this.columnFields=this.fields.getColumnFields(),this.columnFields.mergeFromColumns(this.columns.toJSON()),this._renderColumnAddButton(),this._renderColumns()}})});