define("works/views/app/workflow_stat_item",function(require){var e=require("i18n!admin/nls/admin"),t=require("i18n!nls/commons"),n=require("hgn!works/templates/app/workflow_stat_item"),r=require("i18n!works/nls/works"),i=require("calendar/views/color_picker"),s={color:t["\uc0c9\uc0c1"],statusName:e["\uc0c1\ud0dc\uba85"],add:t["\ucd94\uac00"],edit:t["\uc218\uc815"],color_config:t["\uc0c9\uc0c1 \ubcc0\uacbd"],inputTag:r["\uc0c1\ud0dc\uba85\uc744 \uc785\ub825\ud558\uc138\uc694."],"\uc0c1\ud0dc\ubcc0\uacbd":r["\uc0c1\ud0dc\ubcc0\uacbd"]},o=Backbone.View.extend({initialize:function(e){this.options=e||{},this.graph=e.graph,this.model=e.model,this.stats=e.stats,this.setColor=e.setColor},events:{'focusout input[name="statName"]':"onChangeStatName",'click span[id="stateColor"]':"toggleColorPickerByWorks","click input[type=checkbox]":"setEndState"},onChangeStatName:function(e){var n=$(e.currentTarget).val(),r=this.model.name,i=this.isValidStatName(r,n);if(!i)return $.goError(t["\uc774\ubbf8 \uc0ac\uc6a9\uc911\uc778 \uc774\ub984\uc785\ub2c8\ub2e4."]),this.$el.find('input[name="statName"]').val(r),!1;this.model.name=n,this.trigger("changeStatName",r,n)},isValidStatName:function(e,t){if(_.isEqual(e,t))return!0;for(var n=0;n<this.stats.length;n++)if(t==this.stats[n].getAttribute("name"))return!1;return!0},render:function(){return this.$el.html(n({lang:s,data:this.model})),this.$el.attr("data-type","stat"),this.$el.find('span[id="stateColor"]').addClass("bgcolor"+this.model.color),this.$el.on("changed:chip-color.works",".chip",$.proxy(this.onChangeStateColor,this)),this},setEndState:function(e){var t=$(e.currentTarget),n=t.is(":checked");this.model.end=n,console.log(this.model.name+" => "+this.model.end)},toggleColorPickerByWorks:function(e){var t=$("#notUseProcess").is(":checked");t||i.show(e.target,"works")},onChangeStateColor:function(e,t,n){var r=e.target,i=this.graph.getSelectionCell();this.model.color=t,this.resetStateColor(r,t);var s=this.graph.getModel();s.beginUpdate(),s.execute(new mxCellAttributeChange(i,"color",t)),s.endUpdate(),this.setColor(i)},resetStateColor:function(e,t){return $(e).attr("class","chip"),$(e).addClass("bgcolor"+t),this}});return o});