define("works/libs/util",["jquery","backbone","when"],function(e,t,n){var r=GO.session("id"),i;return i={saveViewType:function(e){var t=e.tabId,n=e.arrangeType;GO.util.store.set(r+"-works-viewtype",{tabId:t,arrangeType:n},"local")},getViewType:function(){return GO.util.store.get(r+"-works-viewtype")||{}},saveFilterStorage:function(e,t){GO.util.store.set(r+"-works-last-filter-id"+e,t,"local")},getFilterStorage:function(e){return GO.util.store.get(r+"-works-last-filter-id"+e)||null},saveShowGuideLayer:function(e){GO.util.store.set(r+"-works-showlayer-",e,"local")},getShowGuideLayer:function(){return GO.util.store.get(r+"-works-showlayer-")||null},createResponseError:function(e,t,n){return{status:e,statusText:t,responseText:n||""}},goCreateAppIntro:function(){GO.router.navigate("works/applet/create/intro",{pushState:!0,trigger:!0})},goSettingHome:function(e){GO.router.navigate("works/applet/"+e+"/settings/home",{pushState:!0,trigger:!0})},goAppHome:function(e){GO.router.navigate("works/applet/"+e+"/home",{pushState:!0,trigger:!0})},checkAppManager:function(t){var n=!1;e.each(t,function(e,t){t.id==GO.session("id")&&(n=!0)}),n||GO.util.error("403",{msgCode:"400-works"})},goEditDoc:function(e){var t=e.appletId,n=e.subFormId,r=e.docId;GO.util.isValidValue(n)?GO.router.navigate("works/applet/"+t+"/doc/"+r+"/edit/"+n,{pushState:!0,trigger:!0}):GO.router.navigate("works/applet/"+t+"/doc/"+r+"/edit",{pushState:!0,trigger:!0})},promiseAsync:function(t,r){var i=r||{},s=n.defer(),o=this,u={type:"GET",dataType:"json",contentType:"application/json",success:function(e){e.hasOwnProperty("__go_checksum__")?s.resolve(e.data):s.reject(o.createResponseError(500,"Internal Server Error"))},error:function(e,t,n){s.reject(n)}};return i.hasOwnProperty("data")&&_.isObject(i.data)&&(i.data=JSON.stringify(i.data)),e.ajax(t,_.extend({},u,i)),s.promise},promiseModelSave:function(e,t){var r=n.defer();return e.save(t,{success:r.resolve,error:function(e,t,n){r.reject(t)}}),r.promise},promiseFetch:function(e,r){var i=n.defer();return e instanceof t.Model||e instanceof t.Collection?e.fetch(_.extend({success:i.resolve,error:function(e,t,n){i.reject(t)}},r||{})):i.reject(this.createResponseError(400,"Bad Request")),i.promise},reqReorderList:function(e,t){return this.promiseAsync(e,{type:"PUT",data:{ids:t}})},convertArrayToCollection:function(e,n){var r;return n&&(r={model:n}),new t.Collection(e,r)},reorderList:function(e,t,n){var r=t-n,i=[];return _.each(e,function(e,s){var o=0;if(!e.hasOwnProperty("seq"))return new Error("seq \uc18d\uc131\uc744 \uac00\uc9c0\uace0 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.");o=e.seq,e.seq===t?e.seq=n:r>0&&n<=o&&o<t?e.seq=++o:r<0&&t<=o&&o<n&&(e.seq=--o),i.push(e)}),_.sortBy(i,function(e){return e.seq})},deepClone:function(t){return e.extend(!0,{},t)},callFile:function(e,t,n,r){try{var i=t==undefined?-1:t,s=n==undefined?-1:n,o=r==undefined?"":r;GO.util.checkOS()=="android"&&window.GOMobile.callFile("attachFileSuccess"+e,"attachFileFail"+e,s,i,o)}catch(u){}},callOrg:function(e,t){try{GO.util.checkOS()=="android"?window.GOMobile.callOrg(JSON.stringify(t),"addSuccess"+e,"addFail"+e):window.location="gomobile://callOrg?"+JSON.stringify(t)+"&addSuccess"+e+"&addFail"+e}catch(n){}},callAlbum:function(e){try{GO.util.checkOS()=="android"?window.GOMobile.callAlbum("attachFileSuccess"+e,"attachFileFail"+e):window.location="gomobile://callAlbum?attachFileSuccess"+e+"&attachFileFail"+e}catch(t){}},callCamera:function(e){try{GO.util.checkOS()=="android"?window.GOMobile.callCamera("attachFileSuccess"+e,"attachFileFail"+e):window.location="gomobile://callCamera?attachFileSuccess"+e+"&attachFileFail"+e}catch(t){}},errorDescRemover:function(t,n){var r=_.isArray(t.targets)?t.targets:[];_.each(r,function(t){e(t).hasClass("error")&&e(t).removeClass("error")}),n.$(".go_error").remove()},giveHoverEventAtIE:function(t,n,r,i,s){!navigator.userAgent.match(/Trident\/7\./)||(t.$(n).on("mouseenter",r,function(){e(this).addClass("hover")}),t.$(n).on("hover",i,function(){e(this).parents(s).addClass("hover")}),t.$(n).on("mouseleave",r,function(){e(this).removeClass("hover")}))},isNumber:function(e,t){var n=t||[];_.isArray(n)||_.toArray(n);var r=[8,35,36,37,38,39];return r=_.union(r,n),e>=48&&e<=57||_.contains(r,e)},isTimeFormat:function(e){if(!e)return!0;var t=/[^(0-9)]/gi;e=e.replace(t,""),e=e.substr(0,4);var n=e.substr(0,1);parseInt(n)>2&&(e="0"+e.substr(0,3));var r=e,i=r.substr(0,2),s=r.substr(2,2);return parseInt(i)<=23&&parseInt(i)>=0&&parseInt(s)<=59&&parseInt(s)>=0},parseTime:function(e){if(!e)return"";var t=/[^(0-9)]/gi;e=e.replace(t,""),e=e.substr(0,4);var n=e.substr(0,1);parseInt(n)>2&&(e="0"+e.substr(0,3));var r=e,i=r.substr(0,2),s=r.substr(2,2);s.length==0&&(s="00"),s.length==1&&(s="0"+s);var o=parseInt(i)<=23&&parseInt(i)>=0&&parseInt(s)<=59&&parseInt(s)>=0;return o?r=i+":"+s:r=GO.util.hourMinute(),r},getSavedBasedate:function(e){return GO.util.store.get(r+"-works-"+e+"-calendar-basedate")||GO.util.now().format("YYYY-MM-DD")},getSavedSelectedPeriod:function(e){return GO.util.store.get(r+"-works-"+e+"-calendar-selectedperiod")},saveCalendarType:function(e,t){return GO.util.store.set(r+"-works-"+e+"-calendar-viewtype",t)},saveBasedate:function(e,t){return GO.util.store.set(r+"-works-"+ +e+"-calendar-basedate",GO.util.toMoment(t).format("YYYY-MM-DD"),{type:"session"})},saveCheckedPeriod:function(t,n){var i=e.isArray(n)?n:[n];return GO.util.store.set(r+"-works-"+t+"-calendar-selectedperiod",i.join(","))},getDateForUrl:function(e,t){var n=GO.util.toMoment(t||new Date).clone();return e==="monthly"?n.format("YYYY-MM"):n.format("YYYY-MM-DD")},parseEventModel:function(e){return e.summary=GO.util.XSSFilter(e.title),e}},i});