define("works/components/formbuilder/core/form_component",function(require){var e=require("underscore"),t=require("backbone"),n=require("app"),r=require("works/components/formbuilder/constants"),i=require("works/constants/value_type"),s=require("works/components/formbuilder/core/views/base_form"),o=require("works/components/formbuilder/core/cid_generator"),u=require("works/components/formbuilder/core/component_manager"),a=function(t,n){var r=this,i;t&&e.has(t,"constructor")?i=t.constructor:i=function(){return r.apply(this,arguments)},e.extend(i,r,n);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,t&&e.extend(i.prototype,t),i.__super__=r.prototype,i},f=t.Model.extend({}),l=function(e){return n.util.initCap(e)},c=function(){function h(e,t){return n.util.clone(e,t)}var c=function(t,n){this.appletId=null,this.components=[],this.__formView__=null,this.__detailView__=null,this.__optionView__=null,this.__componentModel__=null,this.__appletDocModel__=null,this.__integrationModel__=null,this.__editable__=!1,this.__observer__=null,this.__viewType__="form",this.visible=!0,this.masking=!1,e.isObject(t)?n=t:t!=null&&this.setAppletId(t),n&&n.cid?e.extend(this,n):this.cid===null&&(this.cid=o.generate()),this.getKlass=function(){return this.__klass__},this.initialize.apply(this,arguments)};return e.extend(c.prototype,t.Events,{type:null,name:null,cid:null,valueType:null,parentCid:null,visible:!0,masking:!1,multiple:!1,acceptComponent:null,initialize:function(){},setAppletId:function(e){this.appletId=e},getAppletId:function(){return this.appletId},setSubFormId:function(e){this.subFormId=e},getSubFormId:function(){return this.subFormId},setEditable:function(e){this.__editable__=e},isEditable:function(){return this.__editable__},attachObserver:function(e){this.__observer__=e},getObserver:function(){return this.__observer__},addChildren:function(e){this.components===null&&(this.components=[]),this.components.push(e)},removeChildren:function(t){this.components===null&&(this.components=[]);var n=t.cid;this.components=e.filter(this.components,function(e){return e.cid!=n})},addComponent:function(e){return this.addChildren(e)},removeComponent:function(e){return this.removeChildren(e)},setIntegrationModel:function(e){this.__integrationModel__=e,this.__formView__!=null&&this.__formView__.setIntegrationModel(this.__integrationModel__),this.__detailView__!=null&&this.__detailView__.setIntegrationModel(this.__integrationModel__)},setAppletDocModel:function(e){this.__appletDocModel__=e,this.__formView__!=null&&this.__formView__.setAppletDocModel(this.__appletDocModel__),this.__detailView__!=null&&this.__detailView__.setAppletDocModel(this.__appletDocModel__)},hasChildren:function(){return this.components==null?!1:e.isArray(this.components)&&this.components.length>0},remove:function(){this.__formView__&&this.__formView__.remove(),this.__optionView__&&this.__optionView__.remove(),this.__detailView__&&this.__detailView__.remove(),this.__componentModel__=null,this.__cid__=null},validateFormData:function(){var t=this.getFormView();try{if(e.isFunction(t.validate))return t.isHide()?!0:t.validate()}catch(n){return console.log(n.stack),!1}return!0},getType:function(){return this.type},getComponentName:function(){return this.name},getValueType:function(){return this.valueType},setValueType:function(t){var n=this.getObserver();if(!e.contains(e.values(i),t))throw new Error("Invalid Value Type");this.valueType=t,n&&n.trigger(r.REQ_UPDATE_COMPONENT,this.getCid())},getCid:function(){return this.cid},getViewType:function(){return this.__viewType__},setViewType:function(e){this.__viewType__=e},getView:function(e){return this["get"+l(this.getViewType())+"View"](e)},setParentCid:function(e){this.parentCid=e},getParentCid:function(){return this.parentCid},getParentComponent:function(){return u.getComponent(this.getParentCid())},getChildren:function(){return this.components},getFormView:function(e){return e=e||!1,e?new this.__formViewKlass__(this._subViewOptions(e)):(this.__formView__===null&&(this.__formView__=new this.__formViewKlass__(this._subViewOptions())),this.__formView__)},getOptionView:function(e){return e=e||!1,e?new this.__optionViewKlass__(this._subViewOptions(e)):(this.__optionView__===null&&(this.__optionView__=new this.__optionViewKlass__(this._subViewOptions())),this.__optionView__)},getDetailView:function(e){return e=e||!1,e?new this.__detailViewKlass__(this._subViewOptions(e)):(this.__detailView__===null&&(this.__detailView__=new this.__detailViewKlass__(this._subViewOptions())),this.__detailView__)},getComponentPropertyModel:function(e){function t(e){return new f(h(e,!0))}return e||!1?t(this.properties):(this.__componentModel__||(this.__componentModel__=t(this.properties),this.__componentModel__.on("remove",this.remove,this)),this.__componentModel__)},getComponentModel:function(){return this.getComponentPropertyModel()},getAppletDocModel:function(){return this.__appletDocModel__},getIntegrationModel:function(){return this.__integrationModel__},getFormData:function(){var t=this.getFormView();if(t instanceof s){var n=t.getFormData();return n?e.pick(n,this.getCid()):null}return null},isMultiple:function(){return this.multiple},setMultiple:function(e){this.multiple=e,this.__formView__!=null&&this.__formView__.setMultiple(this.multiple),this.__detailView__!=null&&this.__detailView__.setMultiple(this.multiple)},toJSON:function(){return{type:this.getType(),cid:this.getCid(),valueType:this.getValueType(),multiple:this.isMultiple(),parentCid:this.getParentCid(),properties:this.getComponentPropertyModel().toJSON(),components:this.getChildren()}},setProperties:function(e){this.properties=e},setVisible:function(e){this.visible=e},getVisible:function(){return this.visible},isMasking:function(){return this.masking},setMasking:function(e){this.masking=e},isShow:function(){if(!this.getVisible())return!1;var e=this.getParentComponent();return e?this.getParentComponent().isShow():!0},isHide:function(){return!this.isShow()},setDefaultValue:function(){var e=this.getView();e.setDefaultValue()},trigger:function(t){t=t||"instance";var n=this.getAppletDocModel(),r=this.getObserver(),i=u.getInstance(t),s=i.getComponents();e.each(s,function(e){if(e.isShow()){var t=e.getCid(),n=e.getAppletDocModel().get(t);r.trigger("changeValue",{cid:t,value:n})}})},_subViewOptions:function(e){return{type:this.getType(),appletId:this.getAppletId(),subFormId:this.getSubFormId(),clientId:this.getCid(),parentCid:this.getParentCid(),components:n.util.clone(this.getChildren(),!0),model:this.getComponentPropertyModel(e),appletDocModel:this.getAppletDocModel(),integrationModel:this.getIntegrationModel(),editable:this.isEditable(),multiple:this.isMultiple(),observer:this.__observer__}}}),c.type=null,c.group="basic",c.handlerable=!0,c.acceptComponent=null,c.OptionView=null,c.FormView=null,c.DetailView=null,c.define=function(t,n){function r(t){var n={};return e.each(t,function(t,r){e.isObject(t)&&t.hasOwnProperty("defaultValue")?n[r]=h(t.defaultValue,!0):n[r]=t}),n}return n=n||{},t?(e.defaults(n,{cid:null,type:t,group:"basic",handlerable:!0,acceptComponent:null}),a.call(this,{type:n.type,name:n.name,cid:n.cid,valueType:n.valueType,properties:r(n.properties||{}),acceptComponent:n.acceptComponent,rule:n.rule,__optionViewKlass__:n.OptionView,__formViewKlass__:n.FormView,__detailViewKlass__:n.DetailView,initialize:n.initialize||function(){}},{type:n.type,cname:n.name,group:n.group,cid:n.cid||null,handlerable:n.handlerable,OptionView:n.OptionView,FormView:n.FormView,DetailView:n.DetailView})):new Error("\ucef4\ud3ec\ub10c\ud2b8 \ud0c0\uc785\uc774 \uc815\uc758\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.")},c}();return c});