define(["backbone","app","hrcard/helpers/tabTemplateHelper"],function(e,t,n,r){var i=e.View.extend({events:{"click div.viewForm span.txt":"modify","keypress input.w_max":"onKeypress","click div.viewForm td":"add","click div.viewForm span.ic_add":"addRow","click div.viewForm span.ic_remove":"removeRow"},initialize:function(e){this.options=e||{},this.userid=this.options.userid,this.tabType=this.options.tabType,this.data=this.options.data,this.editable=this.options.editable},render:function(){var e=n.getTemplate(this.tabType,this.editable,this.data);return this.$el.html(e),this.$el.find("tr.dataRow:not(:last) td.modify span.ic_add").hide(),this.initDatepicker(),this},initDatepicker:function(){$.datepicker.setDefaults($.datepicker.regional[t.config("locale")]),_.each(this.$el.find("span.wrap_date input"),function(e,t){$(e).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"c-80:c+10",yearSuffix:""})})},modify:function(e){if(!this.editable||$(e.currentTarget).hasClass("hide"))return;var t=$(e.currentTarget).closest("td");t.children().toggle(),t.find("input").focus()},add:function(e){var t=$(e.currentTarget),n=t.find("input.w_max");n.length>0&&!n.is(":visible")&&(t.children().toggle(),t.find("input.w_max").focus())},onKeypress:function(e){var t=$(e.currentTarget).closest("td");e.keyCode==13&&(t.find("span").text($(e.currentTarget).val()),t.children().toggle())},addRow:function(e){$.datepicker.setDefaults($.datepicker.regional[t.config("locale")]);var n=$(e.currentTarget).closest("tr"),r=n.clone();n.find("span.ic_add").remove(),r.attr("data-id",""),_.each(r.find("td"),function(e,t){t==0?$(e).text(Number($(e).text())+1):($(e).find("input").val("").hide(),$(e).find("span.txt:not(.hide)").text("").show(),$(e).find("span.wrap_date input").attr("id","").removeClass("hasDatepicker").removeData("datapicker").show().unbind())}),n.closest("table").append(r),this.initDatepicker(r)},removeRow:function(e){var t=$(e.currentTarget).closest("tr"),n=$(".type_list_box").eq(1);t.parent().find("tr").size()==2?_.each(t.find("td"),function(e,t){t!=0&&($(e).find("input").val(""),$(e).find("span.txt").text(""))}):(t.next().is("tr")||t.prev().find("td:last").append('<span class="ic_con ic_add"></span>'),t.remove(),$.each($(n).find("tr"),function(e,t){e>0&&$(t).find("td").eq(0).html(e)}))}});return i});