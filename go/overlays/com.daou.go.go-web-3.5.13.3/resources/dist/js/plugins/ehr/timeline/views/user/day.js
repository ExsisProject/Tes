define("timeline/views/user/day",function(require){var e=require("backbone"),t=require("hgn!timeline/templates/user/day"),n=require("timeline/models/daily_stat"),r=require("timeline/views/user/timeline"),i=require("i18n!timeline/nls/timeline"),s=require("app"),o=require("timeline/helpers/user/local_storage"),u=require("components/backdrop/backdrop"),a=e.View.extend({className:"tb_attend_list",events:{click:"showTimeline","click .gps_link":"moveLocation","click .attend .wrap_tool_tip":"showAttendToolTip","click .leave .wrap_tool_tip":"showLeaveToolTip","click .tool_tip":"clickToolTip"},clickToolTip:function(e){e.stopPropagation()},initialize:function(){this.model=new n(this.options.data),this.targetUserId=this.options.targetUserId,this.timeLineView=null,s.EventEmitter.on("timeline","reset:timeline",_.bind(function(){this.removeTimeline()},this))},render:function(){var e=this;this.$el.html(t({data:this.model.toJSON(),clockInBy:function(){return e.model.get("clockInHistory").historyType.toLowerCase()},clockOutBy:function(){return e.model.get("clockOutHistory").historyType.toLowerCase()},totalWorkingTime:function(){return e.model.hasTotalWorkingTime()?e.model.getTotalWorkingTime():""},workingTimeDetail:function(){return e.model.hasTotalWorkingTime()?e.model.getWorkingTimeDetail():""},isEditedWorkInTime:function(){return e.model.isEditedWorkInTime()},isEditedWorkOutTime:function(){return e.model.isEditedWorkOutTime()},approvals:function(){return e.model.getApprovals()},clockOut:function(){return e.model.getClockOutTime()},dayOfWeek:function(){return i[e.model.get("detailDay").dayOfWeek]},autoLang:i["\uc790\ub3d9\ud1f4\uadfcAuto"]})),this.addDayOfWeekCss(),this.addTodayCssIfToday(),s.util.store.get("timeline.selectedDay")==this.model.get("detailDay").day&&this.showTimeline()},addTodayCssIfToday:function(){if(!this.model.isToday())return;this.$el.addClass("today")},addDayOfWeekCss:function(){var e=this.model.getDayOfWeek(),t="";e=="SUNDAY"?t="day_sun":e=="SATURDAY"?t="day_sat":this.model.get("holiDay")&&(t="day_holiday"),this.$el.addClass(t)},showTimeline:function(e){if(!_.isUndefined(e)&&$(e.target).hasClass("wrap_tool_tip"))return;if(this.timeLineView){this.removeTimeline();return}s.util.store.set("timeline.selectedDay",this.model.get("detailDay").day,{type:"local"}),s.EventEmitter.trigger("timeline","reset:timeline",this),this.$el.addClass("tb_attend_select"),this.timeLineView=new r({targetUserId:this.targetUserId,data:this.model.toJSON()}),this.$el.after(this.timeLineView.$el),this.timeLineView.render()},showAttendToolTip:function(e){var t=$(e.currentTarget);t.toggleClass("active"),this.attendBackdropView||(this.attendBackdropView=this._bindBackdrop(t))},showLeaveToolTip:function(e){var t=$(e.currentTarget);t.toggleClass("active"),this.leaveBackdropView||(this.leaveBackdropView=this._bindBackdrop(t))},_bindBackdrop:function(e){var t=new u;return t.backdropToggleEl=e.find(".tool_tip"),t.linkBackdrop(e),t},removeTimeline:function(){if(_.isEmpty(this.timeLineView))return;this.timeLineView.remove(),this.timeLineView=null,this.$el.removeClass("tb_attend_select")},moveLocation:function(e){console.log(this.model);var t=$(e.currentTarget),n=t.attr("id"),r=n==="clock_in_link"?this.model.getClockInGpsLink():this.model.getClockOutGpsLink();window.open(r,"","")}});return a});