define("timeline/views/user/summary",function(require){var e=require("backbone"),t=require("hgn!timeline/templates/user/summary"),n=require("hgn!timeline/templates/user/selective_type_summary"),r=require("timeline/models/summary"),i=require("timeline/models/integration_appr_link"),s=require("i18n!timeline/nls/timeline"),o=require("i18n!nls/commons"),u=require("app"),a=require("components/backdrop/backdrop"),f=e.View.extend({events:{"click #download":"download","click #overtime":"overtime","click #timeline_info":"toggleTimelineInfoDesc","click #selectiveTimeToolTipBtn":"toggleSelectiveTimeToolTip","click #overTimeToolTipBtn":"toggleOverTimeToolTip","click #approvalTimeToolTipBtn":"toggleApprovalTimeToolTip"},className:"wrap_statistics",initialize:function(e){this.options=e,this.model=new r(e),this.apprLinkModel=new i(e),this.apprLinkModel.fetch({async:!1}),this.baseDate=e.baseDate,this.userId=e.userId},render:function(){this.model.fetch().done(_.bind(function(){this.groupHistories=this.model.month.groupHistories;var e=this.model.month.isSelectiveWorkingType();e?this.$el.html(n(this.getSelectiveTypeData())):this.$el.html(t(this.getNonSelectiveTypeData()))},this))},getNonSelectiveTypeData:function(){return{CommonLang:o,TimelineLang:s,weekTotalWorkingTime:this.model.getWeekTotalWorkingTime(),weekExtensionWorkingTime:this.model.getWeekExtensionWorkingTime(),weekRestWorkingTime:this.model.getWeekRestWorkingTime(),monthTotalWorkingTime:this.model.getMonthTotalWorkingTime(),monthTotalApprovalTime:this.model.getMonthExtentionWorkingTimeStr(),groupName:this.model.getGroupName(),groupDesc:this.model.getGroupDesc(),restPeriods:this.model.getRestPeriods(),nightWorkingTime:this.model.getNightWorkingTime(),workingTimeRange:this.model.getWorkingTimeRange(),isOverTotalWorkingTime:this.model.isOverTotalWorkingTime(),canApplyOvertimeAppr:this.apprLinkModel.canApplyOvertimeAppr(),remainMaximumWorkingTime:this.model.month.selectiveWorkingTime.getRemainingMaximumWorkingTime(),groupHistories:this.groupHistories,isFlexibleWorkingType:this.model.month.isFlexibleWorkingType()}},getSelectiveTypeData:function(){var e=this.model.getSelectiveWorkingTime(),t=this.model.getMonthWorkingTime(),n={"\uc120\ud0dd\uc801\uadfc\ub85c\uc81c \uadfc\ubb34\uac00\ub2a5\uc2dc\uac04 \uc124\uba85":u.i18n(s["\uc120\ud0dd\uc801\uadfc\ub85c\uc81c \uadfc\ubb34\uac00\ub2a5\uc2dc\uac04 \uc124\uba85"],{arg1:e.maximumExtensionWorkingTimeStr}),"\ucd5c\uc18c\uadfc\ubb34\uc2dc\uac04 \uc548\ub0b4":u.i18n(s["\ucd1d \ucd5c\uc18c\uadfc\ubb34\uc2dc\uac04 \uc548\ub0b4"],{arg1:this.model.getMM(),arg2:e.minimumTotalWorkingTimeStr}),"\ucd5c\ub300\uadfc\ubb34\uc2dc\uac04 \uc548\ub0b4":u.i18n(s["\ucd1d \ucd5c\ub300\uadfc\ubb34\uc2dc\uac04 \uc548\ub0b4"],{arg1:this.model.getMM(),arg2:e.maximumTotalWorkingTimeStr}),"\uc624\ub298\ucd5c\uc18c\uadfc\ubb34\uc2dc\uac04 \uc548\ub0b4":u.i18n(s["\uc624\ub298\uae4c\uc9c0\ucd5c\uc18c\uadfc\ubb34\uc2dc\uac04\uc548\ub0b4"],{arg1:e.todayMinimumTotalWorkingTimeStr})};return{CommonLang:o,TimelineLang:s,Lang:n,"\uc6d4":this.model.getMM(),"\ucd1d\uadfc\ubb34Hour":t.totalDetail.hour,"\ucd1d\uadfc\ubb34Min":t.totalDetail.min,"\ucd1d\uadfc\ubb34Sec":t.totalDetail.sec,"\uc6d4\ucd5c\uc18c\uadfc\ubb34\uc2dc\uac04":e.minimumTotalWorkingTimeStr,"\uc6d4\ucd5c\ub300\uadfc\ubb34\uc2dc\uac04":e.maximumTotalWorkingTimeStr,"\uc6d4\uc5f0\uc7a5\ucd5c\ub300\uc2dc\uac04":e.maximumExtensionWorkingTimeStr,"\uc794\uc5ec\uadfc\ubb34\ucd5c\uc18c":e.remainMinimumWorkingTimeStr,"\uc794\uc5ec\uadfc\ubb34\ucd5c\ub300":e.remainMaximumWorkingTimeStr,"\uc794\uc5ec\ud3c9\uade0\uadfc\ubb34":e.averageMinimumWorkingTimeStr,"\uc794\uc5ec\uc5f0\uc7a5\uadfc\ubb34":e.remainExtensionWorkingTimeStr,"\ub0a8\uc740\uadfc\ubb34\uc77c":e.furtureWorkingDayCnt,"\uc120\ud0dd\uadfc\ubb34\uc2dc\uac04":e.normalWorkingTimeStr,"\ucd08\uacfc\uadfc\ubb34\uc2dc\uac04":e.normalOverWorkingTimeStr,"\uc2b9\uc778\uadfc\ubb34\uc2dc\uac04":e.extensionWorkingTimeStr,"\uae08\uc77c\ucd5c\uc18c\uadfc\ubb34\uc728":e.rate.todayMinimumWorkingTimeRate,"\uc6d4\ucd5c\uc18c\uadfc\ubb34\uc728":e.rate.minimumWorkingTimeRate,"\uc120\ud0dd\uadfc\ubb34\uc728":e.rate.tunedNormalWorkingTimeRate,"\ucd08\uacfc\uadfc\ubb34\uc728":e.rate.tunedNormalOverWorkingTimeRate,"\uc2b9\uc778\uadfc\ubb34\uc728":e.rate.tunedExtensionWorkingTimeRate,canApplyOvertimeAppr:this.apprLinkModel.canApplyOvertimeAppr(),restPeriods:this.model.getRestPeriods(),nightWorkingTime:this.model.getNightWorkingTime(),workingTimeRange:this.model.getWorkingTimeRange(),groupDesc:this.model.getGroupDesc(),groupName:this.model.getGroupName(),groupHistories:this.groupHistories}},toggleTimelineInfoDesc:function(){this._bindBackdrop(this.$("#timeline_info_desc"),this.$("#timeline_info"))},toggleSelectiveTimeToolTip:function(){this.selectiveTimeToolTipBackdropView||(this.selectiveTimeToolTipBackdropView=this._bindBackdrop(this.$("#selectiveTimeToolTip"),this.$("#selectiveTimeToolTipBtn")))},toggleOverTimeToolTip:function(){this.overTimeToolTipBackdropView||(this.overTimeToolTipBackdropView=this._bindBackdrop(this.$("#overTimeToolTip"),this.$("#overTimeToolTipBtn")))},toggleApprovalTimeToolTip:function(){this.approvalTimeToolTipBackdropView||(this.approvalTimeToolTipBackdropView=this._bindBackdrop(this.$("#approvalTimeToolTip"),this.$("#approvalTimeToolTipBtn")))},_bindBackdrop:function(e,t){var n=new a;return n.backdropToggleEl=e,n.linkBackdrop(t),n},changeBaseDate:function(e){this.baseDate=e,this.model.baseDate=moment(this.baseDate,"YYYY-MM-DD").format("YYYY-MM-DD"),this.render()},overtime:function(){var e="/approval/document/new/",t=this.apprLinkModel.getDeptId(),n=this.apprLinkModel.getFormId(),r=this.apprLinkModel.getWriteMode();r=="POPUP"?(e=u.contextRoot+"app"+e+"popup"+"/"+t+"/"+n,window.open(e,"","location=no, directories=no, resizable=yes, status=no, toolbar=no, menubar=no, width=1280, height=650, left=0, top=0, scrollbars=yes")):(e+=t+"/"+n,u.router.navigate(e,{trigger:!0}),$("html, body").animate({scrollTop:0}))},download:function(){window.location.href=u.contextRoot+"api/ehr/timeline/excel?"+$.param({userId:this.userId,baseDate:moment(this.baseDate,"YYYY-MM-DD").format("YYYY-MM-DD")})}});return f});