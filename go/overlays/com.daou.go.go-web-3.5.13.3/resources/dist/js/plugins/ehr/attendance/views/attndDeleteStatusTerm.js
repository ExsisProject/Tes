define(["backbone","hgn!attendance/templates/popup_delete_status_term","attendance/collections/companyStatuses","i18n!nls/commons","i18n!attendance/nls/attendance","app"],function(e,t,n,r,i,s){var o={label_delete_status_term:i["\uc0c1\ud0dc\uc77c\uad04\uc0ad\uc81c"],label_delete:r["\uc0ad\uc81c"],label_cancel:r["\ucde8\uc18c"],label_status:r["\uc0c1\ud0dc"],label_select:r["\uc120\ud0dd"],label_date:i["\ub0a0\uc9dc"],label_time:i["\uc2dc\uac04"],label_delete_description:i["\ub4f1\ub85d\ub41c \uc0c1\ud0dc\ub97c \uc120\ud0dd\ud558\uba74 \uac1c\ubcc4 \uc0ad\uc81c\uac00 \uac00\ub2a5\ud569\ub2c8\ub2e4."]},u=s.BaseView.extend({tagName:"table",className:"form_type go_form_basic",initialize:function(e){if(e||0)this.firstDate=e.firstDate,this.userid=e.userid,this.option=e.option;this.companyStatuses=new n,this.companyStatuses.fetch({async:!1})},render:function(){var e=t({id:this.option,status:this.companyStatuses.toJSON(),lang:o});return this.$el.html(e),this.$el.find("#startDate").val(moment(this.firstDate.getLogDate()).format("YYYY-MM-DD")),this.$el.find("#endDate").val(moment(this.firstDate.getLogDate()).format("YYYY-MM-DD")),this.$el.find("#startDate").datepicker({dateFormat:"yy-mm-dd",changeMonth:!1,changeYear:!1,yearSuffix:"",stepMonths:0,onSelect:function(e){$("#startDate").val(e)}}).focus(function(){$(".ui-datepicker-prev, .ui-datepicker-next").remove()}),this.$el.find("#endDate").datepicker({dateFormat:"yy-mm-dd",changeMonth:!1,changeYear:!1,yearSuffix:"",stepMonths:0,onSelect:function(e){$("#endDate").val(e)}}).focus(function(){$(".ui-datepicker-prev, .ui-datepicker-next").remove()}),this},deleteStatusTermReqest:function(){var t=new e.Model,n=this.$el.find("#AttendStatusSelect option:selected"),i=n.attr("data-type"),o=n.attr("data-id"),u=n.val();t.set("startDate",s.util.toISO8601(moment(this.$el.find("#startDate").val(),"YYYY-MM-DD")),{silent:!0}),t.set("endDate",s.util.toISO8601(moment(this.$el.find("#endDate").val(),"YYYY-MM-DD")),{silent:!0}),t.set("companyStatus",{name:u,type:i,id:o},{silent:!0}),t.url=s.contextRoot+"api/ehr/attnd/user/"+this.userid+"/status/term",s.EventEmitter.trigger("common","layout:setOverlay",""),t.save({},{type:"DELETE",success:function(e,t){t.code=="200"&&($.goMessage(r["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),s.EventEmitter.trigger("attnd","change:clockInOutStatus"),s.EventEmitter.trigger("attnd","change:clockInOutStatusSide"))},error:function(e,t){t.status==403?$.goMessage(r["\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]):$.goMessage(t.responseJSON.message)},complete:function(e,t){s.EventEmitter.trigger("common","layout:clearOverlay",!0)}})}});return u});