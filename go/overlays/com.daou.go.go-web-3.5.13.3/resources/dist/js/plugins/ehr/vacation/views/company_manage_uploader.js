define("vacation/views/company_manage_uploader",function(require){var e=require("backbone"),t=require("app"),n=require("hgn!vacation/templates/company_manage_uploader"),r=require("i18n!vacation/nls/vacation"),i=require("i18n!nls/commons"),s=require("i18n!admin/nls/admin"),o=require("file_upload");require("GO.util"),require("jquery.go-preloader");var u={"\uc5c5\ub85c\ub4dc\uc124\uba85":r["\uc0d8\ud50c\uc591\uc2dd\uc744 \ub2e4\uc6b4\ubc1b\uc544 \uc591\uc2dd\uc5d0 \ub9de\uac8c \uc791\uc131 \ud6c4 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br/>\uc7ac \uc5c5\ub85c\ub4dc\uc2dc, \uac00\uc7a5 \ucd5c\uadfc \uc5c5\ub370\uc774\ud2b8 \ud30c\uc77c\ub85c \ub300\uccb4 \ub429\ub2c8\ub2e4."],"\uc0d8\ud50c\uc591\uc2dd \ub2e4\uc6b4\ub85c\ub4dc":r["\uc0d8\ud50c\uc591\uc2dd \ub2e4\uc6b4\ub85c\ub4dc"],"\ucd08\uae30\uc124\uc815 \ud30c\uc77c \ub4f1\ub85d":r["\ucd08\uae30\uc124\uc815 \ud30c\uc77c \ub4f1\ub85d"],"\ud30c\uc77c\ucca8\ubd80":i["\ud30c\uc77c\ucca8\ubd80"],"{{extension}} \ud30c\uc77c\ub9cc \ub4f1\ub85d \uac00\ub2a5\ud569\ub2c8\ub2e4.":i["{{extension}} \ud30c\uc77c\ub9cc \ub4f1\ub85d \uac00\ub2a5\ud569\ub2c8\ub2e4."],"\ub4f1\ub85d\uc77c":i["\ub4f1\ub85d\uc77c"],"\uc885\ub8cc\uc77c":s["\uc885\ub8cc\uc77c"],"\ucd1d \uacc4\uc815\uc218":r["\ucd1d"],"\uc2e4\ud328 \uacc4\uc815\uc218":i["\uc2e4\ud328"],"\uc131\uacf5 \uacc4\uc815\uc218":i["\uc131\uacf5"],"\uc77c\uad04 \ub4f1\ub85d":s["\uc77c\uad04 \ub4f1\ub85d"],"\uc804\uccb4 \ucc98\ub9ac \uacb0\uacfc \ub2e4\uc6b4\ub85c\ub4dc":s["\uc804\uccb4 \ucc98\ub9ac \uacb0\uacfc \ub2e4\uc6b4\ub85c\ub4dc"],"CSV \ud30c\uc77c \uc7ac\uc5c5\ub85c\ub4dc \uc2dc":r["CSV \ud30c\uc77c \uc7ac\uc5c5\ub85c\ub4dc \uc2dc"],"\uc815\ubcf4 \ubcc0\uacbd\uc73c\ub85c \ubc1c\uc0dd \uc5f0\ucc28\uc640 \uc870\uc815 \uc5f0\ucc28, \uc0ac\uc6a9\ub0b4\uc5ed\uc774 \ucd08\uae30\ud654\ub429\ub2c8\ub2e4":r["\uc815\ubcf4 \ubcc0\uacbd\uc73c\ub85c \ubc1c\uc0dd \uc5f0\ucc28\uc640 \uc870\uc815 \uc5f0\ucc28, \uc0ac\uc6a9\ub0b4\uc5ed\uc774 \ucd08\uae30\ud654\ub429\ub2c8\ub2e4."],"\uc77c\uad04 \uc870\uc815 \uae30\ub2a5\uc744 \uc774\uc6a9\ud558\uc5ec \uc5f0\ucc28\ub97c \uc870\uc815\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4":r["\uc77c\uad04 \uc870\uc815 \uae30\ub2a5\uc744 \uc774\uc6a9\ud558\uc5ec \uc5f0\ucc28\ub97c \uc870\uc815\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4"],"\uc5f0\ucc28\ucd08\uae30\uc124\uc815 \uc2dc \uacb0\uc7ac\ubb38\uc11c \uc548\ub0b4\uc0ac\ud56d":r["\uc5f0\ucc28\ucd08\uae30\uc124\uc815 \uc2dc \uacb0\uc7ac\ubb38\uc11c \uc548\ub0b4\uc0ac\ud56d"],"\uc77c\uad04 \ub4f1\ub85d \uc2dc \uaddc\uce59 \uc0ac\ud56d":r["\uc77c\uad04 \ub4f1\ub85d \uc2dc \uaddc\uce59 \uc0ac\ud56d"],"ID(\uacc4\uc815) \uc740 \uadf8\ub8f9\uc6e8\uc5b4 \uacc4\uc815 \uc774\uba54\uc77c \uc8fc\uc18c\uc5d0\uc11c id \uac12":r["ID(\uacc4\uc815) \uc740 \uadf8\ub8f9\uc6e8\uc5b4 \uacc4\uc815 \uc774\uba54\uc77c \uc8fc\uc18c\uc5d0\uc11c id \uac12"],"\uc785\uc0ac\uc77c\uc740 yyyy-mm-dd \ud615\uc2dd\uc73c\ub85c \uc785\ub825 (ex 2018-01-01)":r["\uc785\uc0ac\uc77c\uc740 yyyy-mm-dd \ud615\uc2dd\uc73c\ub85c \uc785\ub825 (ex 2018-01-01)"],"\uc5f0\ucc28\uc640 \uc0ac\uc6a9\uc77c\uc218 \uc785\ub825 \ub2e8\uc704 \uc124\uba85":r["\uc5f0\ucc28\uc640 \uc0ac\uc6a9\uc77c\uc218\ub294 1\uc77c, 0.5\uc77c, 0.25\uc77c \ub2e8\uc704\ub85c \uc785\ub825"],"\uc785\uc0ac\uc77c\uc744 \ubbf8 \uc785\ub825 \uc2dc,  \uc5f0\ucc28\ub294 \uc790\ub3d9 \uc0dd\uc131\ub418\uc9c0 \uc54a\uc74c":r["\uc785\uc0ac\uc77c\uc744 \ubbf8 \uc785\ub825 \uc2dc,  \uc5f0\ucc28\ub294 \uc790\ub3d9 \uc0dd\uc131\ub418\uc9c0 \uc54a\uc74c"],"\uc815\ubcf4 \ubcc0\uacbd\uc73c\ub85c \ubc1c\uc0dd \uc5f0\ucc28\uc640 \uc870\uc815 \uc5f0\ucc28, \uc0ac\uc6a9\ub0b4\uc5ed, \uc785\uc0ac\uc77c\uc774 \ucd08\uae30\ud654\ub429\ub2c8\ub2e4":r["\uc815\ubcf4 \ubcc0\uacbd\uc73c\ub85c \ubc1c\uc0dd \uc5f0\ucc28\uc640 \uc870\uc815 \uc5f0\ucc28, \uc0ac\uc6a9\ub0b4\uc5ed, \uc785\uc0ac\uc77c\uc774 \ucd08\uae30\ud654\ub429\ub2c8\ub2e4."]},a=e.View.extend({events:{"click #sampleDownload":"sampleDownload","click #registerBtn":"fileRegister","click #resultDownload":"resultDownload"},initialize:function(e){this.preloader=$.goPreloader(),this.accountUseEhr=_.isUndefined(e)?!1:e},resultDownload:function(){window.location.href=t.contextRoot+"api/vacation/upload/result/download?accountUseEhr="+this.accountUseEhr},sampleDownload:function(){window.location.href=t.contextRoot+"api/ehr/vacation/company/upload/sample?accountUseEhr="+this.accountUseEhr},fileRegister:function(){this.preloader.render();var e=this,n=t.contextRoot+"api/vacation/upload?accountUseEhr="+this.accountUseEhr,r=$("#fileComplete li");if(!r.data("name")){$.goError(i["\ucca8\ubd80\ud30c\uc77c\uc744 \ub4f1\ub85d\ud574 \uc8fc\uc138\uc694."]),this.preloader.$el.hide();return}var s=r.data();$.go(n,JSON.stringify(s),{qryType:"POST",timeout:0,contentType:"application/json",responseFn:function(t){e.getStatus()},error:function(e){$("#statusResult").show(),$.goError(i["\uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."]),this.preloader.$el.hide()}})},getStatus:function(){_this=this,$.ajax({url:t.contextRoot+"api/vacation/upload/result",success:function(e){_this.data=e.data},complete:function(){if(!_this.data||!_this.data.jobStatus){_this.preloader.$el.hide(),$.goError(i["\uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."]);return}var e=_this.data.jobStatus;if(e=="DONE"){_this.preloader.$el.hide(),$("#statusResult").show(),$("#resultInfo").show(),$("#resultInfo").empty();var n=t.util.customDate(_this.data.startedAt,"YYYY-MM-DD"),r=t.util.customDate(_this.data.endedAt,"YYYY-MM-DD"),s=_this.data.size,o=_this.data.failCount,a=_this.data.successCount,f=$(["<li>"+u["\ub4f1\ub85d\uc77c"]+" : "+n+"</li>"+"<li>"+u["\uc885\ub8cc\uc77c"]+" : "+r+"</li>"+"<li>"+u["\ucd1d \uacc4\uc815\uc218"]+" : "+s+" / "+u["\uc2e4\ud328 \uacc4\uc815\uc218"]+" : "+o+" / "+u["\uc131\uacf5 \uacc4\uc815\uc218"]+" : "+a+"</li>"].join(""));$("#resultInfo").append(f)}else if(e=="CANCELLED"||e=="DELETE")_this.preloader.$el.hide(),$.goError(i["\uc5c5\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."]);else{if(e=="WAIT"){_this.preloader.$el.hide();return}setTimeout(function(){_this.getStatus()},3e3)}},dataType:"json",timeout:3e4})},render:function(){return this.initCheck(),this.$el.html(n({accountUseEhr:this.accountUseEhr,lang:u})),this.initFileUpload(),this},initCheck:function(){_this=this,this.preloader.render(),$.ajax({url:t.contextRoot+"api/vacation/upload/result",success:function(e){var t=e.data.jobStatus;t=="DONE"||t=="CANCELLED"||t=="DELETE"?_this.preloader.$el.hide():_this.getStatus()},dataType:"json"})},submit:function(){this.preloader.release()},initFileUpload:function(){var e=t.util.useButtonWindow(),n={el:"#uploadBtn",context_root:t.contextRoot,useButtonWindow:e,button_text:"<span class='buttonText'>"+u["\ud30c\uc77c\ucca8\ubd80"]+"</span>",url:"api/file?GOSSOcookie="+$.cookie("GOSSOcookie")};e&&(n.button_height=26),(new o(n)).queue(function(e,t){}).start(function(e,n){var r=new RegExp("(.csv|.xls|.xlsx)","gi"),i=n.type.toLowerCase();if(!r.test(i))return $.goError(t.i18n(u["{{extension}} \ud30c\uc77c\ub9cc \ub4f1\ub85d \uac00\ub2a5\ud569\ub2c8\ub2e4."],{extension:"exel, csv"})),!1;$("#fileComplete").empty()}).progress(function(e,t){}).success(function(e,n,r){t.util.fileUploadErrorCheck(n)&&(r.find(".item_file").append("<strong class='caution'>"+t.util.serverMessage(n)+"</strong>"),r.addClass("attachError")),r.data("file-path",n.data.filePath),r.data("file-name",n.data.fileName),r.data("file-ext",n.data.fileExt),r.data("hostid",n.data.hostId),r.find(".ic_del").hide(),$("#fileComplete").append(r)}).complete(function(e,t){}).error(function(e,t){})}});return a});