define("timeline/views/company_stat/stat_filter",function(require){var e=require("app"),t=require("backbone"),n=require("hgn!timeline/templates/company_stat/stat_filter"),r=require("i18n!timeline/nls/timeline"),i=require("i18n!nls/commons"),s=t.View.extend({className:"table_search table_search_ehr",events:{"change #filter_type":"filterTypeChange","click #search":"search","keyup #text_field":"enterSearch"},initialize:function(e){this.options=e.options,this.range=e.range,this.filterType=this.options?this.options.filterType:"none"},render:function(){return this.$el.html(n({TimelineLang:r,CommonLang:i,filterType:this.filterType,timeFilter:this.isTimeFilter(),textFilter:this.isTextFilter(),useFilter:this.isUseFilter(),isCompany:this.range=="COMPANY",isDept:this.range=="DEPARTMENT"})),this.options&&(this.$el.find("#filter_type").val(this.filterType),this.$el.find("#time_filter_type").val(this.options.timeFilterType),this.$el.find("#filter_hour").val(this.options.filterHour),this.$el.find("#text_field").val(this.options.textField),this.options=null),this.$el.find("#filter_type").val(this.filterType),this},isUseFilter:function(){return this.filterType&&this.filterType!="none"},isTimeFilter:function(){return this.filterType=="totalTime"},isTextFilter:function(){return this.filterType=="departmentName"||this.filterType=="userName"||this.filterType=="groupName"},filterTypeChange:function(e){var t=$(e.currentTarget).val();this.filterType=t,this.filterType=="none"&&this.search(),this.render()},getSearchQuery:function(){return this.isTextFilter()?$.param({_key_:this.$el.find("#text_field").val()}).replace("_key_",this.filterType):this.isTimeFilter()?this.$el.find("#time_filter_type").val()+"="+this.$el.find("#filter_hour").val():""},search:function(){var e={filterType:this.filterType,textField:this.$el.find("#text_field").val(),filterHour:this.$el.find("#filter_hour").val(),timeFilterType:this.$el.find("#time_filter_type").val(),query:this.getSearchQuery()};this.trigger("statFiltering",e)},enterSearch:function(e){e.keyCode==13&&this.search()}});return s});