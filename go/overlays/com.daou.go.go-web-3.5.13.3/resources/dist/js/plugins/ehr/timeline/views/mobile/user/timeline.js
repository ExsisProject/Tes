define("timeline/views/mobile/user/timeline",function(require){var e=require("backbone"),t=require("timeline/models/daily_stat"),n=require("timeline/models/auth"),r=require("hgn!timeline/templates/mobile/user/timeline"),i=require("hgn!timeline/templates/mobile/user/timeline_empty"),s=require("hgn!timeline/templates/mobile/user/timeline_approval_item"),o=require("timeline/views/mobile/user/timeline_item"),u=require("i18n!timeline/nls/timeline"),a=require("i18n!nls/commons"),f=require("hgn!timeline/templates/mobile/user/timeline_regist"),l={regist:[u["\uadfc\ubb34"],u["\uc0c1\ud0dc"],u["\ub4f1\ub85d"]].join(" ")},c=e.View.extend({className:"daily_status",events:{"vclick #registTimeline":"registTimeline"},initialize:function(){this.model=new t(this.options.data),this.targetUserId=this.options.targetUserId},render:function(){this.$el.html(r({}));var e="";_.isEmpty(this.model.getTimelineHistories())?this.editableTimelineHistory()?(this.$el.find(".list_timeline").append(f({regist:l.regist})),e=".time_add"):(this.renderEmptyTmpl(),e=".data_null_s"):(this.renderTimelineItemView(),this.$el.find(".list_timeline div.timeline_de:first").addClass("first"),this.$el.find(".list_timeline div.timeline_de:last").addClass("last"),e=".list_timeline div.timeline_de:last",this.editableTimelineHistory()&&(this.$el.find(e).after(f({regist:l.regist})),e=".time_add")),_.isEmpty(this.model.getApprovals())||this.$el.find(e).after(s({TimelineLang:u,approvals:this.model.getApprovals()}))},isTimelineSuperUser:function(){var e=new n(GO.util.store.get("timeline.auth"));return e.isSuperUser()},editableTimelineHistory:function(){return this.isTimelineSuperUser()&&(GO.util.isBeforeToday(this.model.day)||GO.util.isToday(this.model.day))},renderEmptyTmpl:function(){this.$el.find(".list_timeline").append(i({empty:a["\ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."]}))},renderTimelineItemView:function(){_.each(this.model.getTimelineHistoriesSortByCheckTime(),function(e){var t=new o({targetUserId:this.targetUserId,dayInfo:this.options.data.detailDay,data:_.extend(e,{checkType:e.historyType.toLowerCase()})});this.$el.find(".list_timeline").append(t.$el),t.render()},this)},registTimeline:function(e){GO.router.navigate("ehr/timeline/history/new/update/"+this.targetUserId+"/"+this.model.detailDay.day,{trigger:!0,pushState:!0})}});return c});