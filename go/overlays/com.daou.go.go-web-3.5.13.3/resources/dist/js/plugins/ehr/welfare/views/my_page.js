(function(){define(["backbone","app","hgn!welfare/templates/my_page","i18n!welfare/nls/welfare","i18n!nls/commons","welfare/views/title","welfare/models/user_welfare","welfare/collections/user_histories"],function(e,t,n,r,i,s,o,u){function l(e,t,n){}var a={"\ub144\uac04 Point":r["\ub144\uac04 Point"],"\uc0ac\uc6a9 Point":r["\uc0ac\uc6a9 Point"],"\uc870\uc815 Point":r["\uc870\uc815 Point"],"\ub0a8\uc740 Point":r["\ub0a8\uc740 Point"],"\uc0ac\uc6a9\uc77c":r["\uc0ac\uc6a9\uc77c"],"\uc0ac\uc6a9 Point":r["\uc0ac\uc6a9 Point"],"\uac70\ub798\ucc98":r["\uac70\ub798\ucc98"],"\ubd84\ub958":r["\ubd84\ub958"],"\uc774\uc804":i["\uc774\uc804"],"\ub2e4\uc74c":i["\ub2e4\uc74c"],"\ub0a0\uc9dc \uc774\ub3d9":r["\ub0a0\uc9dc \uc774\ub3d9"],"\ubcf5\uc9c0\ud3ec\uc778\ud2b8 \ub370\uc774\ud130 \uc5c6\uc74c":r["\ubcf5\uc9c0\ud3ec\uc778\ud2b8 \ub370\uc774\ud130 \uc5c6\uc74c"]},f=e.View.extend({events:{"click #preDate":"preDate","click #nextDate":"nextDate","click #calArea":"showCalendar"},initialize:function(){var e=t.util.toMoment().year();this.welfare=new o,this.welfare.setYear(e),this.welfare.fetch({async:!1}),this.histories=new u,this.histories.setYear(e),this.histories.fetch({async:!1})},render:function(e){_.isUndefined(e)&&(e=t.util.toMoment().year());var r=Number(e);return this.$el.html(n({preDate:r-1,nextDate:r+1,searchDate:r,welfare:this.welfare.toJSON(),histories:this.histories.toJSON(),lang:a,isEmpty:this.histories.size()==0?!0:!1,convertNumber:function(){return function(e){return t.util.numberWithCommas(this[e])}}})),this.$el.find("header.content_top").html((new s).render("\ub0b4 \ubcf5\uc9c0\ud3ec\uc778\ud2b8").el),this.initDatePicker(),this},preDate:function(e){var t=$(e.currentTarget);this.refresh(t.attr("data-date"))},nextDate:function(e){var t=$(e.currentTarget);this.refresh(t.attr("data-date"))},refresh:function(e){var t=Number(e);$("#preDate").attr("data-date",t-1),$("#searchDate").attr("data-date",t),$("#searchDate").text(t),$("#nextDate").attr("data-date",t+1),this.welfare.setYear(t),this.welfare.fetch({async:!1}),this.histories.setYear(t),this.histories.fetch({async:!1}),this.render(t)},showCalendar:function(){this.$el.find("#calBtn").focus()},initDatePicker:function(){var e=this.$el.find("#calBtn");$.datepicker.setDefaults($.datepicker.regional[t.config("locale")]),e.datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:"",onSelect:$.proxy(function(e){var n=t.util.toMoment(e).year();this.refresh(n)},this)})}});return f})})();