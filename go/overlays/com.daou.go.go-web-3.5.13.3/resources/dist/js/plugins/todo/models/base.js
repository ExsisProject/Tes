define("todo/models/base",["backbone","moment","app","libs/go-utils"],function(e,t,n,r){function u(){r.store.set(o,n.util.toISO8601(new Date),{type:"session"})}function a(e){e=e||{};if(e.success){var t=e.success;e.success=function(e){u(),t.apply(this,arguments)}}return e}var i,s,o=n.session("id")+"-todo-lastupdated";return i=e.Model.extend({lockFlag:!1,fetch:function(t){return e.Model.prototype.fetch.call(this,a(t))},save:function(){var t=[].slice.call(arguments),n=t.length>1?t[1]:{},r,s;if(i.__lockFlag__){this.trigger("locking");return}return r=n.hasOwnProperty("beforeSend")?n.beforeSend:function(){},s=n.hasOwnProperty("complete")?n.complete:function(){},n.beforeSend=function(){r.apply(undefined,arguments),i.__lockFlag__=!0},n.complete=function(){s.apply(undefined,arguments),i.__lockFlag__=!1},e.Model.prototype.save.call(this,t[0],n)}},{__lockFlag__:!1}),s=e.Collection.extend({fetch:function(t){return e.Collection.prototype.fetch.call(this,a(t))},updateModel:function(e){return _.map(this.models,function(t){t.id===e.id&&(t=e)}),this}}),{Model:i,Collection:s}});