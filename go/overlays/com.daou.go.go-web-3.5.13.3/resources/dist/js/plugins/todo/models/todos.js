define("todo/models/todos",["when","app","todo/models/base","todo/models/todo","todo/libs/util"],function(e,t,n,r,i){function f(e){var n=t.config("contextRoot")+"api/todo",r=a[e];return[n,r||a.my].join("/")}function l(t){var n=new TodoList,r=e.defer();return n.url=f(t),n.fetch({success:r.resolve,error:r.reject}),r.promise}function c(e,t,n){var r={my:o,favorite:u}[e],i;return r&&(i=new r(t||[],n||{}),i.modelType=e),i}function h(t){var n=c(t),r=e.defer();return n.fetch({success:r.resolve,error:function(e,t,n){r.reject(t)}}),r.promise}var s,o,u,a={my:"my",favorite:"favorite"};return s=n.Collection.extend({model:r,modelType:a.my,comparator:"seq",reorder:function(){}}),o=s.extend({url:function(){return f(a.my)}}),u=s.extend({url:function(){return f(a.favorite)},reorder:function(n){var r=this,s=e.defer();return i.reqReorderList(t.config("contextRoot")+"api/todo/favorite/move",n).then(function(e){_.map(n,function(e,t){var n=r.get(e);n.set("seq",t)}),r.sort(),s.resolve(r)},s.reject),s.promise}}),{MyTodoList:o,FavoriteTodoList:u,createForMyBoard:function(){var e=Array.prototype.slice.call(arguments);return e.unshift(a.my),c.apply(undefined,e)},createForFavorite:function(){var e=Array.prototype.slice.call(arguments);return e.unshift(a.favorite),c.apply(undefined,e)},getMyBoards:function(){return h(a.my)},getFavoriteBoards:function(){return h(a.favorite)},fetchCollections:function(){var e={};return h(a.my).then(function(t){return e[a.my]=t,e.myTodoList=t,h(a.favorite)}).then(function(t){return e[a.favorite]=t,e.favoriteTodoList=t,e})}}});