define("todo/libs/util",["backbone","when","moment","i18n!todo/nls/todo"],function(e,t,n,r){var i;return i={createResponseError:function(e,t,n){return{status:e,statusText:t,responseText:n||""}},promiseAsync:function(e,n){var r=n||{},i=t.defer(),s=this,o={type:"GET",dataType:"json",contentType:"application/json",success:function(e){e.hasOwnProperty("__go_checksum__")?i.resolve(e.data):(e.code==404&&e.name=="todo.not.found.element"&&$.goSlideMessage(e.message,"caution"),i.reject(s.createResponseError(500,"Internal Server Error")))},error:function(e,t,n){e.responseJSON.code==404&&e.responseJSON.name=="todo.not.found.element"&&$.goSlideMessage(e.responseJSON.message,"caution"),i.reject(n)}};return r.hasOwnProperty("data")&&_.isObject(r.data)&&(r.data=JSON.stringify(r.data)),$.ajax(e,_.extend({},o,r)),i.promise},promiseModelSave:function(e,n){var r=t.defer();return e.save(n,{success:r.resolve,error:function(e,t,n){r.reject(t),t.responseJSON.code==404&&t.responseJSON.name=="todo.not.found.element"&&$.goSlideMessage(t.responseJSON.message,"caution")}}),r.promise},promiseFetch:function(n,r){var i=t.defer();return n instanceof e.Model||n instanceof e.Collection?n.fetch(_.extend({success:i.resolve,error:function(e,t,n){i.reject(t)}},r||{})):i.reject(this.createResponseError(400,"Bad Request")),i.promise},reqReorderList:function(e,t){return this.promiseAsync(e,{type:"PUT",data:{ids:t}})},convertArrayToCollection:function(t,n){var r;return n&&(r={model:n}),new e.Collection(t,r)},reorderList:function(e,t,n){var r=t-n,i=[];return _.each(e,function(e,s){var o=0;if(!e.hasOwnProperty("seq"))return new Error("seq \uc18d\uc131\uc744 \uac00\uc9c0\uace0 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.");o=e.seq,e.seq===t?e.seq=n:r>0&&n<=o&&o<t?e.seq=++o:r<0&&t<=o&&o<n&&(e.seq=--o),i.push(e)}),_.sortBy(i,function(e){return e.seq})},deepClone:function(e){return $.extend(!0,{},e)},toStreamDate:function(e){var t=""+e,i;return mDate=n(t),mDate.isBefore(n().startOf("y"))?i=mDate.format("YYYY-MM-DD(dd) HH:mm"):mDate.isBefore(n().subtract("hour",12))?i=mDate.format("MM-DD(dd) HH:mm"):mDate.isAfter(n().subtract("second",60))||mDate.isAfter(new Date)?i=r["\ubc29\uae08 \uc804"]:i=mDate.fromNow(),i},callActionForMember:function(e,t,n){return e.isMember(GO.session("id"))?n.call(this,t):!1},callActionForOwner:function(e,t,n){return e.isOwner(GO.session("id"))?n.call(this,t):!1},searchCardSeq:function(e,t){var n=0;return e.each(function(e,r){if($(r).data("itemid")===t){n=e;return}}),n},syncCardSeqs:function(e){e.each(function(e,t){var n=$(t).data("view");n.setSequence(e)})},parseDuedate:function(e){var e=n(e),t;return e.isSame(new Date,"y")?t=e.format(r["\uae30\ud55c\uc77c\uc2dc \ud3ec\ub9f7"]):t=e.format(r["\uae30\ud55c\ub144\uc6d4\uc77c\uc2dc \ud3ec\ub9f7"]),t}},i});