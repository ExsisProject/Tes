define("todo/views/menus/search_member",["underscore","hogan","components/history_menu/main","hgn!todo/templates/menus/search_member_menu","text!todo/templates/partials/_search_member_list.html","text!todo/templates/partials/_user_thumbnail.html","i18n!todo/nls/todo","i18n!nls/commons","libs/go-utils"],function(e,t,n,r,i,s,o,u,a){function d(t){var n=[],r=e.pluck(this.model.get("members"),"id");return e.map(t||[],function(t){var i=e.contains(r,t.id);n.push(e.extend(t,{selected:i}))}),t}function v(t){var n=this.todoModel.get("members"),r=a.escapeRegExChars(a.normalizeQuery(t)),i=new RegExp("(?:"+r+")","i");return e.filter(n,function(e){var t=e.name+(e.position?" "+e.position:"");return i.exec(t)})}var f,l=n.HistoriableMenuView,c=!1,h=500,p=function(){var e=Hogan.compile(i);return e.render.apply(e,arguments)};return f=l.extend({id:"search-member-menu",className:"content",name:"search-member-menu",title:o["\ub2f4\ub2f9\uc790"],template:r,todoModel:null,events:{"click .btn-memberinfo":"_toggle","keyup input[name=query]":"_resetHint"},initialize:function(e){e=e||{},this.todoModel=e.todoModel,l.prototype.initialize.call(this,e)},render:function(){this.$el.empty().append(this.template({members:d.call(this,this.todoModel.get("members")),label:{search_member:o["\uba64\ubc84 \uac80\uc0c9"]}},{_search_member_list:i,_user_thumbnail:s})),this.setMenuClass("layer_new_board")},_resetHint:function(){c||(c=!0,setTimeout(e.bind(function(){var t=this.$el.find("input[name=query]").val(),n=this.$el.find(".ui-member-list"),r=v.call(this,t),i=[];e.each(d.call(this,r),function(e){i.push(p(e,{_user_thumbnail:s}))},this),n.empty().append.apply(n,i),c=!1},this),h))},_toggle:function(e){var t=$(e.currentTarget),n=t.data("userid"),r=t.hasClass("select")?"removeMember":"addMember",i=t.hasClass("select")?"removeClass":"addClass";e.preventDefault(),this.model[r].call(this.model,n).then(function(e){return t[i].call(t,"select"),when.resolve(e)})}}),f});