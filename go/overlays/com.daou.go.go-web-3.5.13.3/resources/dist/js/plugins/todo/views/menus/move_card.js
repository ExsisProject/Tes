define("todo/views/menus/move_card",["components/history_menu/main","hgn!todo/templates/menus/move_card_menu","text!todo/templates/partials/_confirm_button.html","todo/libs/util","i18n!todo/nls/todo","i18n!nls/commons"],function(e,t,n,r,i,s){function a(){this.$el.find("select[name=select_column]").val(this.model.get("todoCategoryId")),f.call(this)}function f(){var e=parseInt(this.$el.find("select[name=select_column]").val()),t=this.$el.find("select[name=select_position]"),n=$("#column-container-"+e).find(".ui-todocard"),i=n.length,s=[];e===this.model.get("todoCategoryId")&&(i-=1),t.empty();if(i>0)for(var o=0;o<=i;o++){var u=o+1;s.push('<option value="'+o+'">'+u+"</option>")}else s.push('<option value="0">1</option>');$.fn.append.apply(t,s),t.val(r.searchCardSeq(n,this.model.id))}var o,u=e.HistoriableMenuView;return o=u.extend({id:"move-card-menu",className:"content",name:"move-card-menu",title:i["\uce74\ub4dc \uc774\ub3d9"],template:t,todoModel:null,events:{"change select[name=select_column]":"_changeColumn","click .btn-confirm":"_move","click .btn-cancel":"_cancel"},initialize:function(e){e=e||{},this.todoModel=e.todoModel,u.prototype.initialize.call(this,e)},render:function(){this.$el.empty().append(this.template({columns:this.todoModel.getCategories(),label:{column:i["\uce7c\ub7fc"],position:s["\uc704\uce58"],confirm:s["\uc774\ub3d9"],cancel:s["\ucde8\uc18c"]}},{_confirm_button:n})),this.setMenuClass("layer_move"),a.call(this)},_changeColumn:function(e){f.call(this)},_move:function(e){var t=this,n,r;e.preventDefault(),n=parseInt(this.$el.find("select[name=select_column]").val()),r=parseInt(this.$el.find("select[name=select_position]").val()),this.model.move(n,r).then(function(){t.model.trigger("moved",n,r),GO.EventEmitter.trigger("todo","resize:column"),t.close()})},_cancel:function(e){e.preventDefault(),this.back()}}),o});