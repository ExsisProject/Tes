define("todo/views/menus/move_column",["components/history_menu/main","hgn!todo/templates/menus/move_column_menu","text!todo/templates/partials/_confirm_button.html","i18n!todo/nls/todo","i18n!nls/commons"],function(e,t,n,r,i){function u(){var e=this.model.get("seq"),t=parseInt(this.$el.find("select[name=select_position]").val()),n=$($(".ui-todocolumn").get(t)),r=this.columnView.$el,i;if(t<e)i="before";else{if(!(t>e))return!1;i="after"}return n[i].call(n,r),!0}var s,o=e.HistoriableMenuView;return s=o.extend({id:"move-column-menu",className:"content",name:"move-column-menu",title:r["\uce7c\ub7fc \uc774\ub3d9"],template:t,columnView:null,todoModel:null,events:{"click .btn-confirm":"_move","click .btn-cancel":"_cancel"},initialize:function(e){e=e||{},this.columnView=e.columnView,this.model=this.columnView.model,this.todoModel=this.columnView.todoModel,o.prototype.initialize.call(this,e)},render:function(){var e=this.todoModel.getCategories();_.map(e,function(e){e.disp_text=e.seq+1}),this.$el.empty().append(this.template({columns:e,label:{position:i["\uc704\uce58"],confirm:i["\uc774\ub3d9"],cancel:i["\ucde8\uc18c"]}},{_confirm_button:n})),this.setCurrentPosition(),this.setMenuClass("layer_move")},setCurrentPosition:function(){this.$el.find(".select-column-seq").val(this.model.get("seq"))},_move:function(e){var t=this,n=[];e.preventDefault(),u.call(this)&&($(".ui-todocolumn").each(function(e,t){var r=$(t),i=r.data("categoryid"),s=r.data("view");s.reorder(e),n.push(i)}),this.todoModel.reorderCategories(n).then(function(e){t.close()}).otherwise(function(e){window.location.reload()}))},_cancel:function(e){e.preventDefault(),this.back()}}),s});