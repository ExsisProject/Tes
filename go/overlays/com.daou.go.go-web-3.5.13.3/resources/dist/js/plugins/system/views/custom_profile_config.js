define("system/views/custom_profile_config",function(require){function f(e,t,n){}var e=require("backbone"),t=require("app"),n=require("system/collections/custom_profile_config"),r=require("system/models/custom_profile_config"),i=require("hgn!system/templates/custom_profile_config"),s=require("i18n!nls/commons"),o=require("i18n!admin/nls/admin");require("jquery.go-sdk");var u={label_custom_profile_config:o["\ucee4\uc2a4\ud140 \ud504\ub85c\ud544 \uad00\ub9ac"],label_edit:s["\uc218\uc815"],label_ok:s["\uc800\uc7a5"],label_cancel:s["\ucde8\uc18c"],label_fail:s["\uc2e4\ud328"],label_failDesc:s["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."],label_sucess:s["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],label_company_name:o["\ud68c\uc0ac\uba85"],label_field_name:o["\ud544\ub4dc\uc774\ub984"],label_ko:o.KO,label_en:o.EN,label_jp:o.JP,label_zhcn:o["ZH-CN"],label_zhtw:o["ZH-TW"],label_usage:o["\uc0ac\uc6a9\uc5ec\ubd80"],label_order:o["\uc815\ub82c\uc5ec\ubd80"],label_display:o["\uc720\uc800 \ud504\ub85c\ud544 \ub178\ucd9c \uc5ec\ubd80"],label_data_type:o["\ub370\uc774\ud130 \ud0c0\uc785"],label_use:s["\uc0ac\uc6a9"],label_no_use:s["\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"],label_field:o["\ud544\ub4dc"]},a=e.View.extend({events:{"click .ic_edit":"editText","click #btn_ok":"saveConfig","click #btn_cancel":"resetConfig","change #companyList":"changeCompanyConfigs"},initialize:function(){this.collection=n.getList(t.session("companyId")),this.model=r.create()},render:function(){var e=this;this.$el.html(i({lang:u,data:this.collection.toJSON()})),$(".breadcrumb .path").html("\ucee4\uc2a4\ud140 \ud504\ub85c\ud544 \uad00\ub9ac"),e.getCompanyList(),$("#companyList").val(t.session("companyId"))},editText:function(e){var t=$(e.currentTarget).closest("td");t.find(".editable").hide(),t.find("input:text").show()},saveConfig:function(e){var t=this,r=$("#formCustomProfileConfig"),i=!0,a=$(e.currentTarget).attr("data-name"),f=$(e.currentTarget).attr("data-id");t.model.set("id",f,{silent:!0}),t.model.set("profileName",a,{silent:!0}),$.each(r.serializeArray(),function(e,n){var r=n.name.split("_")[0];if(a==r){if(n.name.split("_")[1]=="koLabel"&&n.value=="")return t.showValidateMsg(n.name,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]),i=!1,!1;if(n.name.split("_")[1]=="useOrder"&&n.value=="false"&&$("#"+n.name+"_false").attr("data-used-dept-order")=="true")return $("#"+n.name+"Validate").html(o["\ubd80\uc11c\uc6d0 \uc815\ub82c \uc21c\uc11c\uc5d0 \uc0ac\uc6a9\uc911\uc785\ub2c8\ub2e4"]),i=!1,!1;if(n.name.split("_")[1]=="dataType"&&n.value=="")return t.showValidateMsg(n.name,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \ubd80\uc11c \uc815\ub82c"]),i=!1,!1;t.model.set(n.name.split("_")[1],n.value,{silent:!0})}});if(!i)return!1;t.model.save({},{success:function(e,r){if(r.code=="200"){$.goMessage(u.label_sucess);var i=$("#companyList").val();t.collection=n.getList(i),t.render(),$("#companyList").val(i)}},error:function(e,t){$.goAlert(u.label_fail,u.label_failDesc)}})},showValidateMsg:function(e,t){$("#"+e).focus(),$("#"+e+"Validate").html(t)},getCompanyList:function(){var e=t.contextRoot+"ad/api/system/companies?offset=999";$.go(e,"",{qryType:"GET",async:!1,responseFn:function(e){return $.each(e.data,function(e,t){$("#companyList").append('<option value="'+t.id+'">'+t.name+"</option>")}),e.data},error:function(e){var t=JSON.parse(e.responseText);$.goMessage(t.message)}})},changeCompanyConfigs:function(e){console.log($(e.currentTarget).val()),this.collection=n.getList($(e.currentTarget).val()),this.render(),$("#companyList").val($(e.currentTarget).val())},resetConfig:function(){this.render()}},{__instance__:null});return a});