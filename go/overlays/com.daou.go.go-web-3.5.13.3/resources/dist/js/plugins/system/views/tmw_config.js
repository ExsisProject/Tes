define("system/views/tmw_config",function(require){function f(e,t,n){}var e=require("app"),t=require("backbone"),n=require("system/models/tmw_config"),r=require("hgn!system/templates/tmw_config"),i=require("i18n!nls/commons"),s=require("i18n!admin/nls/admin"),o=require("i18n!board/nls/board");require("jquery.go-validation");var u={label_edit:i["\uc218\uc815"],label_ok:i["\uc800\uc7a5"],label_cancel:i["\ucde8\uc18c"],label_fail:i["\uc2e4\ud328"],label_failDesc:i["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."],label_sucess:i["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],label_ko:s.KO,label_en:s.EN,label_jp:s.JP,label_zhcn:s["ZH-CN"],label_zhtw:s["ZH-TW"],label_usage:s["\uc0ac\uc6a9\uc5ec\ubd80"],label_order:s["\uc815\ub82c\uc5ec\ubd80"],label_use:i["\uc0ac\uc6a9"],label_no_use:i["\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"],label_folder_name:s["\ud3f4\ub354\uba85"],label_add:i["\ucd94\uac00"],label_delete:i["\uc0ad\uc81c"]},a=t.View.extend({events:{"click .ic_edit":"editText","click #btn_add_tmw":"addTMWServer","click #btn_delete_tmw":"deleteTMWServer","click #btn_ok":"saveTMWConfig","click input:radio[name='useTmw']":"changeUseTMWFolder"},initialize:function(){this.tmwModel=n.get()},render:function(){var e=this;return $(".breadcrumb .path").html(s["TMW \uc5f0\ub3d9"]),this.$el.html(r({lang:u,data:this.tmwModel.toJSON()})),$.each(this.tmwModel.toJSON().serverInfos,function(t,n){this.$el.find("#tmwServerInfos").append(e.makeServerInfoOption(n.server,n.port,n.key))}),this.$el},editText:function(e){var t=$(e.currentTarget).closest("td");t.find(".editable").hide(),t.find("input:text").show()},addTMWServer:function(){var e=this,t=this.$el.find("#tmwServer").val(),n=this.$el.find("#tmwPort").val(),r=this.$el.find("#tmwKey").val();if(!$.goValidation.validateURL(t)){e.showValidateMsg("tmwServer",o["\uc798\ubabb\ub41c url\uc785\ub2c8\ub2e4."]);return}this.$el.find("#tmwServerValidate").empty();if(!$.goValidation.isNumber(n)){e.showValidateMsg("tmwPort",s["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]);return}this.$el.find("#tmwPortValidate").empty();if(r.length!=8){e.showValidateMsg("tmwKey",s["\ud0a4\ub294 8\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]);return}this.$el.find("#tmwKeyValidate").empty(),this.$el.find("#tmwServer").val(""),this.$el.find("#tmwPort").val(""),this.$el.find("#tmwKey").val(""),this.$el.find("#tmwServerInfos").append(this.makeServerInfoOption(t,n,r))},deleteTMWServer:function(){this.$el.find("#tmwServerInfos option:selected").remove()},saveTMWConfig:function(){var e=this,t=this.$el.find("#tmwKoLabel").val(),r=this.$el.find("#tmwEnLabel").val(),i=this.$el.find("#tmwJaLabel").val(),s=this.$el.find("#tmwZhcnLabel").val(),o=this.$el.find("#tmwZhtwLabel").val(),a=this.$el.find("input:radio[name='useTmw']:checked").val(),f=this.$el.find("input:radio[name='useSpam']:checked").val(),l=[];$.each(this.$el.find("#tmwServerInfos option"),function(e,t){l.push({id:e,server:t.getAttribute("data-server"),port:t.getAttribute("data-port"),key:t.getAttribute("data-key")})}),e.tmwModel.set("useTMWFolder",a=="on"?!0:!1),e.tmwModel.set("useSpamFolder",f=="on"?!0:!1),e.tmwModel.set("koLabel",t),e.tmwModel.set("enLabel",r),e.tmwModel.set("jaLabel",i),e.tmwModel.set("zhcnLabel",s),e.tmwModel.set("zhtwLabel",o),e.tmwModel.set("serverInfos",l),e.tmwModel.save({},{success:function(t,r){r.code=="200"&&($.goMessage(u.label_sucess),e.tmwModel=n.get(),e.render())},error:function(e,t){$.goAlert(u.label_fail,u.label_failDesc)}})},makeServerInfoOption:function(e,t,n){var r=e+":"+t+", KEY : "+n,i='<option value="'+r+'" data-server="'+e+'" data-port="'+t+'" data-key="'+n+'">'+r+"</option>";return i},showValidateMsg:function(e,t){$("#"+e).focus(),$("#"+e+"Validate").html(t)},changeUseTMWFolder:function(e){$(e.currentTarget).val()=="on"?this.$el.find("#tmwDetailInfo").show():this.$el.find("#tmwDetailInfo").hide()}},{__instance__:null});return a});