(function(){define(["backbone","app","hgn!system/templates/notice/list","admin/libs/recurrence_parser","i18n!nls/commons","i18n!admin/nls/admin","jquery.go-grid","GO.util"],function(e,t,n,r,i,s){var o={add_notice:s["\uacf5\uc9c0 \ucd94\uac00"],remove_notice:i["\uc0ad\uc81c"],name:i["\uc81c\ubaa9"],term:s["\uacf5\uc9c0 \uae30\uac04"],state:i["\uc0c1\ud0dc"],hidden:s["\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"],normal:s["\uc0ac\uc6a9"],creator:s["\ub4f1\ub85d\uc790"],createdAt:s["\ub4f1\ub85d\uc77c"],config:i["\uc124\uc815"],search:i["\uac80\uc0c9"],empty_data:s["\ub4f1\ub85d\ub41c \uacf5\uc9c0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],not_select:s["\uacf5\uc9c0\uc0ac\ud56d\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694."],delete_success:i["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],delete_title:s["\ud31d\uc5c5 \uacf5\uc9c0 \uc0ad\uc81c"],delete_confirm:s["\ud31d\uc5c5 \uacf5\uc9c0 \uc0ad\uc81c \uc54c\ub9bc"],no_title:i["\uc81c\ubaa9\uc5c6\uc74c"],read:i["\uc870\ud68c"],show:i["\ubcf4\uae30"],device:s["\ub514\ubc14\uc774\uc2a4"],web:s["\uc6f9"],mobile:s["\ubaa8\ubc14\uc77c"]},u=e.View.extend({events:{"click #add_notice":"addNotice","click #remove_notice":"removeNotice"},initialize:function(){$(".breadcrumb .path").html("\ub85c\uadf8\uc778\ud398\uc774\uc9c0 \uacf5\uc9c0")},render:function(){this.$el.html(n({lang:o})),this.makeGrid()},makeGrid:function(){var e=this;this.noticeGrid=$.goGrid({el:"#notice_table",method:"GET",destroy:!0,url:t.contextRoot+"ad/api/notice/front",params:this.searchParams,emptyMessage:"<p class='data_null'> <span class='ic_data_type ic_no_data'></span><span class='txt'>"+o.empty_data+"</span>"+"</p>",defaultSorting:[[6,"desc"]],sDomType:"admin",checkbox:!0,checkboxData:"id",displayLength:t.session("adminPageBase"),columns:[{mData:"title",sClass:"subject",bSortable:!0,fnRender:function(e){var t=e.aData.title;return $.trim(t).length==0&&(t=o.no_title),"<span data-type='title' data-id='"+e.aData.id+"'>"+t+"</span>"}},{mData:"startTime",sClass:"period",bSortable:!1,fnRender:function(e){if(e.aData.recurrence!=undefined&&e.aData.recurrence!=""){var t=new r,n=e.aData.recurrence;return t.parse(n).humanize()}var i=moment(e.aData.startTime).format("YYYY-MM-DD"),s=moment(e.aData.endTime).format("YYYY-MM-DD");return i+" ~ "+s}},{mData:"showWeb",sClass:"device",bSortable:!1,fnRender:function(e){var t=e.aData.showWeb,n=e.aData.showMobile;if(t&&n)return o.web+", "+o.mobile;if(t==1&&n==0)return o.web;if(t==0&&n==1)return o.mobile}},{mData:"state",sClass:"",bSortable:!1,fnRender:function(e){var t={};return t.hidden=o.hidden,t.normal=o.normal,t[e.aData.state]}},{mData:"creator",sClass:"name",bSortable:!0,fnRender:function(e){var t=e.aData.creator;return t.name+" "+t.position}},{mData:"createdAt",sClass:"date",bSortable:!0,fnRender:function(e){return t.util.customDate(e.aData.createdAt,"YYYY-MM-DD")}},{mData:null,sClass:"last action",bSortable:!1,fnRender:function(e){return"<span class='btn_s' data-id='"+e.aData.id+"'>"+o.config+"</span>"}}],fnDrawCallback:function(n,r,i){e.$el.find(".toolbar_top .custom_header").append(e.$el.find("#controlButtons").show()),e.$el.find("#checkedAll").attr("checked",!1),e.$el.find(this.el+" tr>td.reader span.btn_s").css("cursor","pointer").click(function(t){e._popupReader($(t.currentTarget).attr("data-id"))}),e.$el.find(this.el+" tr>td.last span.btn_s").css("cursor","pointer").click(function(e){var n="system/extension/frontnotice/"+$(e.currentTarget).attr("data-id");t.router.navigate(n,{trigger:!0})}),e.$el.find(this.el+" tr>td.subject span[data-type='title']").css("cursor","pointer").click(function(e){var n="system/extension/frontnotice/"+$(e.currentTarget).attr("data-id");t.router.navigate(n,{trigger:!0})})}}).tables},addNotice:function(){t.router.navigate("system/extension/frontnotice/create",{trigger:!0})},removeNotice:function(){var e=this.noticeGrid.getCheckedIds(),n=t.contextRoot+"ad/api/notice",r=this,i=$("#notice_table").find('tbody input[type="checkbox"]:checked').length;if(i!=e.length)return;if(e.length==0){$.goMessage(o.not_select);return}$.goConfirm(o.delete_title,o.delete_confirm,function(){$.ajax({type:"DELETE",async:!0,data:JSON.stringify({ids:e}),dataType:"json",contentType:"application/json",url:n}).done(function(e){$.goMessage(o.delete_success),r.noticeGrid.reload()})})}},{render:function(){var e=new u;return e.render()}});return u})})();