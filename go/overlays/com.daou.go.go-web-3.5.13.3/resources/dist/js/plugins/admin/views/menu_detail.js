define("admin/views/menu_detail",function(require){function f(e,t){t.find(".access_class_label").text(o["\uc124\uc815"]),"black"==e?(t.find("#selectedClass").text(o["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),t.find("#exceptedClass").text(o["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),t.find(".help .tool_tip").html(o["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):(t.find("#selectedClass").text(o["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),t.find("#exceptedClass").text(o["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),t.find(".help .tool_tip").html(o["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"]))}var e=require("jquery"),t=require("backbone"),n=require("app"),r=require("hgn!admin/templates/menu_detail"),i=require("views/circle"),s=require("i18n!nls/commons"),o=require("i18n!admin/nls/admin");require("jquery.go-orgslide"),require("jquery.go-sdk"),require("jquery.go-validation"),require("jquery.go-popup");var u={label_ok:s["\uc800\uc7a5"],label_cancel:s["\ucde8\uc18c"],label_base:o["\uae30\ubcf8 \uc815\ubcf4"],label_name:o["\uba54\ub274\uba85"],label_url:o["\uba54\ub274 URL \uc8fc\uc18c"],label_ko:o.KO,label_en:o.EN,label_jp:o.JP,label_zhcn:o["ZH-CN"],label_zhtw:o["ZH-TW"],label_vi:o.VI,label_linkMenu_mobile_desc:o["\uc0c8 \ub9c1\ud06c \ubaa8\ubc14\uc77c \uc571 \uc774\uc6a9 \uc8fc\uc758 \ubb38\uad6c"],label_location_desc:o["\uba54\ub274\uc704\uce58\uacbd\uace0"],label_info_add:o["\uba54\ub274\uba85 \uc5b8\uc5b4\ud56d\ubaa9 \ucd94\uac00"],label_info_add_select:o["\ucd94\uac00\ud560 \ud56d\ubaa9\uc744 \uc120\ud0dd\ud558\uc138\uc694."],label_iframe:o["\ud604\uc7ac \ubcf4\uace0 \uc788\ub294 \ud398\uc774\uc9c0\uc5d0 iframe \uc73c\ub85c \ud654\uba74\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4."],label_self:o["\ud604\uc7ac \ubcf4\uace0 \uc788\ub294 \ud398\uc774\uc9c0\uc5d0\uc11c \ud654\uba74\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4."],label_new:o["\uc0c8\ucc3d\uc774 \ub5a0\uc11c \ud654\uba74\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4."],label_has_submenu:o["\ud558\uc704 \uba54\ub274\uac00 \uc788\uc2b5\ub2c8\ub2e4."],label_comfirm_has_submenu:o["\ud574\ub2f9 \uba54\ub274\ub97c \uc0ad\uc81c\ud558\ub824\uba74, \uba3c\uc800 \ud558\uc704 \uba54\ub274\ub97c \uc0ad\uc81c\ud558\uc2dc\uae38 \ubc14\ub78d\ub2c8\ub2e4."],label_modify_has_submenu:o["\ud574\ub2f9 \uba54\ub274\ub97c \uc218\uc815\ud558\ub824\uba74, \uba3c\uc800 \ud558\uc704 \uba54\ub274\ub97c \uc0ad\uc81c\ud558\uc2dc\uae38 \ubc14\ub78d\ub2c8\ub2e4."],label_location:o["\uba54\ub274\ud654\uba74\ud45c\uc2dc"],label_status:o["\uba54\ub274 \ud65c\uc131\ud654 \uc5ec\ubd80"],use:s["\uc0ac\uc6a9"],not_use:s["\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"],use_label:o["\uc0ac\uc6a9\uc5ec\ubd80"],add_org_access_deny:o["\uc811\uadfc\uc81c\ud55c \ud074\ub798\uc2a4 \ucd94\uac00"],label_modify:s["\uc218\uc815"],label_remove:s["\uc0ad\uc81c"],label_validate:o["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],label_access:o["\uba54\ub274 \uc811\uadfc \uc124\uc815"],label_white:o["\uacf5\uac1c"],label_black:o["\ube44\uacf5\uac1c"],label_policy:o["\uc815\ucc45 \uc124\uc815"],label_addAccessDenyClass:o["\uc124\uc815"],label_addAccessAllowedClass:o["\uc811\uadfc \ud5c8\uc6a9 \ud074\ub798\uc2a4 \ucd94\uac00"],label_selectClass:o["\ud074\ub798\uc2a4 \uc120\ud0dd"],label_addExceptionClass:o["\uc608\uc678 \ud074\ub798\uc2a4 \ucd94\uac00"],"Web(PC,\ubaa8\ubc14\uc77c)":o["Web(PC,\ubaa8\ubc14\uc77c)"],"WEB \uc815\ucc45 \ud234\ud301":o["WEB \uc815\ucc45 \ud234\ud301"],"\ubaa8\ubc14\uc77c\uc571 \uc815\ucc45 \ud234\ud301":o["\ubaa8\ubc14\uc77c\uc571 \uc815\ucc45 \ud234\ud301"],"\uc790\ub8cc\uc2e4 \uc815\ucc45 \ud234\ud301":o["\uc790\ub8cc\uc2e4 \uc815\ucc45 \ud234\ud301"],"\ubaa8\ubc14\uc77c \uc571":o["\ubaa8\ubc14\uc77c \uc571"],"\ubaa8\ubc14\uc77c \uba54\ub274 \uad8c\ud55c \uc548\ub0b4":o["\ubaa8\ubc14\uc77c \uba54\ub274 \uad8c\ud55c \uc548\ub0b4"],"\ub514\ubc14\uc774\uc2a4 \ubcc4 \uad8c\ud55c \uc124\uc815":o["\ub514\ubc14\uc774\uc2a4 \ubcc4 \uad8c\ud55c \uc124\uc815"],"\ubaa8\ub4e0\uae30\uae30":o["\ubaa8\ub4e0\uae30\uae30"],"WEB / \ubaa8\ubc14\uc77c \uc571 \uad6c\ubd84":o["WEB / \ubaa8\ubc14\uc77c \uc571 \uad6c\ubd84"]},a=t.View.extend({webAccessTarget:null,mobileAccessTarget:null,mobileAccessTarget:null,mobileExceptionTarget:null,className:"col2",initialize:function(e){this.installInfo=e.installInfo,this.model=e.model,this.menuId=e.menuId},events:{"click #submit":"submit","click #cancel":"cancel","change #selectAccessPolicy input:radio":"changeAccessSetting","keyup input[name$='Name']":"nameValidate","keyup input[name='url']":"urlValidate","keydown input":"prevent","click span.btn_box[data-btntype='changePopupName']":"modifyName","click span.btn_box[data-btntype='changePopupUrl']":"changeModifyUrl","click span#data[data-type='changePopupName']":"changeModifyName","click span#data[data-type='changePopupUrl']":"changeModifyUrl","change #moreName":"addMoreName","change #accessDeviceOption input:radio":"changeAccessDeviceOption"},render:function(){this.$el.html(r({lang:u,model:this.model.toJSON(),isKoLocale:this.installInfo.isKoLocale(),isEnLocale:this.installInfo.isEnLocale(),isJpLocale:this.installInfo.isJpLocale(),isZhcnLocale:this.installInfo.isZhcnLocale(),isZhtwLocale:this.installInfo.isZhtwLocale(),isViLocale:this.installInfo.isViLocale(),isAccessDeviceOptionAll:this.model.isAccessDeviceOptionAll(),isRequireMobileAccess:this.model.isRequireMobileAccess()&&this.model.toJSON().appName!=="webfolder",isWebFolderMenu:this.model.toJSON().appName==="webfolder"})),this.setModifyMenuData(this.model.toJSON());var t=this.$el.find("#pc_device"),n=this.$el.find("#mobile_device");if(!this.model.isNew()){var i=this.model.get("location"),s=this.model.get("status"),o=this.model.get("subMenuType");this.$('input[name="location"][value="'+i.toLowerCase()+'"]').attr("checked",!0),this.$('input[name="status"][value="'+s.toLowerCase()+'"]').attr("checked",!0),this.$('input[name="subMenuType"][value="'+o+'"]').attr("checked",!0),this.$('select[name="parentId"] option[value="'+this.menuId+'"]').hide();var a=this.model.get("webAccessSetting"),l=this.model.get("mobileAccessSetting"),c=this.$el.find("#accessDeviceOption"),h=this.model.get("accessDeviceOption");f(a,t),f(l,n),t.find('input[name="webAccessSetting"][value="'+a+'"]').attr("checked",!0),n.find('input[name="mobileAccessSetting"][value="'+l+'"]').attr("checked",!0),c.find("input[name='accessDeviceOption'][value='"+h+"']").attr("checked",!0)}else this.$("#self").attr("checked",!0),t.find("[name='webAccessSetting'][value='black']").attr("checked",!0),n.find("[name='mobileAccessSetting'][value='black']").attr("checked",!0),n.hide();e("span.btn[data-btntype='submit']").attr("data-locale",this.installInfo.getLocale());var p=GO.util.isUseOrgService(!0);this.webAccessTarget=this.renderCricleView("#webAccessTarget",this.model.get("webAccessTarget"),p),this.webExceptionTarget=this.renderCricleView("#webExceptionTarget",this.model.get("webExceptionTarget"),p),this.mobileAccessTarget=this.renderCricleView("#mobileAccessTarget",this.model.get("mobileAccessTarget"),p),this.mobileExceptionTarget=this.renderCricleView("#mobileExceptionTarget",this.model.get("mobileExceptionTarget"),p)},changeAccessDeviceOption:function(t){function s(){this.$el.find("#mobile_device").hide(),this.$el.find("#access_web_label").hide()}function o(){this.$el.find("#mobile_device").show(),this.$el.find("#access_web_label").show()}var n=e(t.currentTarget),r=n.val(),i={ALL:s,DIVIDE:o};i[r].call(this)},submit:function(){function r(t,r){function f(e){return e.indexOf(i)>=0?!0:!1}if(t.indexOf("Name")<0)return;var i=this.installInfo.getLocale(),s=16,o=f(t)?1:0,a=e("#"+t+"Validate");if(!e.goValidation.isCheckLength(o,s,r))throw a.html(n.i18n(u.label_validate,{arg1:o,arg2:s})),e("#"+t).focus(),new Error(n.i18n(u.label_validate,{arg1:o,arg2:s}));a.empty()}var t=this;e.each(this.$("form").serializeArray(),function(e,n){r.call(t,n.name,n.value),t.model.set(n.name,n.value,{silent:!0})}),this.model.set("accessDeviceOption",this.$el.find("#accessDeviceOption :radio[name='accessDeviceOption']:checked").val()),this.model.set("webAccessSetting",this.$el.find("#pc_device :radio[name='webAccessSetting']:checked").val()),this.model.set("mobileAccessSetting",this.$el.find("#mobile_device :radio[name='mobileAccessSetting']:checked").val()),this.model.set("webAccessTarget",this.webAccessTarget.getData()),this.model.set("webExceptionTarget",this.webExceptionTarget.getData()),this.model.set("mobileAccessTarget",this.mobileAccessTarget.getData()),this.model.set("mobileExceptionTarget",this.mobileExceptionTarget.getData()),GO.util.preloader(t.model.save({},{success:function(n,r){r.code=="200"&&e.goMessage(s["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),t.render(),t.$el.trigger("change:menu",n)},error:function(t,n){var r=JSON.parse(n.responseText);r!=null?e.goAlert(s["\uc624\ub958"],r.message):e.goMessage(s["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."])}}))},cancel:function(){this.render()},addMoreName:function(t){e('[data-id="'+t.target.value+'Input"]').show(),e(t.target).find(":selected").remove(),e("#moreName option").size()==1&&e('[data-id="addMenuName"]').hide()},modifyName:function(t){var r=e(t.currentTarget).parent(),i=e(t.currentTarget).attr("data-locale"),s=i!=undefined?i+"Name":"";if(r&&r.attr("data-formname")){e(t.currentTarget).hide(),r.html(['<input type="input" name="',r.attr("data-formname"),'" class="input w_full" value="',r.attr("data-value"),'" />'].join("")).find("input").focusin();var o=r.parent().find("#"+r.attr("data-formname")+"Validate");r.find("input").keyup(function(t){r.attr("data-formname")==s&&!e.goValidation.isCheckLength(1,16,e(t.currentTarget).val())?o.html(n.i18n(u.label_validate,{arg1:"1",arg2:"16"})):r.attr("data-formname")!=s&&e(t.currentTarget).val().length>0&&!e.goValidation.isCheckLength(1,16,e(t.currentTarget).val())?o.html(n.i18n(u.label_validate,{arg1:"1",arg2:"16"})):o.empty()})}},changeModifyUrl:function(t){var r=e(t.currentTarget).parent();if(r&&r.attr("data-formname")){e(t.currentTarget).hide(),r.html(['<input type="input" name="',r.attr("data-formname"),'" class="input w_full" value="',r.attr("data-value"),'" />'].join("")).find("input").focusin();var i=r.parent().find("#"+r.attr("data-formname")+"Validate");r.find("input").keyup(function(t){e.goValidation.isCheckLength(1,128,e(t.currentTarget).val())?i.empty():i.html(n.i18n(u.label_validate,{arg1:"1",arg2:"128"}))})}},urlValidate:function(t){var r=e("#urlValidate");e.goValidation.isCheckLength(1,255,e(t.currentTarget).val())?r.empty():r.html(n.i18n(u.label_validate,{arg1:"1",arg2:"255"}))},nameValidate:function(t){var r=e(t.currentTarget).attr("data-locale"),i=r!=undefined?r+"Name":"",s=t.currentTarget.id,o=e(t.currentTarget).val(),a=e("#"+s+"Validate");s==i&&!e.goValidation.isCheckLength(1,16,o)?a.html(n.i18n(u.label_validate,{arg1:"1",arg2:"16"})):s!=i&&o.length>0&&!e.goValidation.isCheckLength(1,16,o)?a.html(n.i18n(u.label_validate,{arg1:"1",arg2:"16"})):a.empty()},changeAccessSetting:function(t){function a(){var e={PC:{accessTarget:this.webAccessTarget,exceptionTarget:this.webExceptionTarget},MOBILE:{accessTarget:this.mobileAccessTarget,exceptionTarget:this.mobileExceptionTarget}};e[i].accessTarget.deleteAllData(),e[i].exceptionTarget.deleteAllData(),f(n.val(),r),u.close()}function l(){function t(e){var t="black";return e==t&&(t="white"),t}var e=t(n.val());r.find('input[value="'+e+'"]').attr("checked",!0)}var n=e(t.currentTarget),r=n.closest("table.detail"),i=r.data("type"),u=e.goPopup({title:o["\uc815\ucc45 \uc124\uc815 \ubcc0\uacbd \ud655\uc778"],message:"",buttons:[{btext:s["\ud655\uc778"],btype:"confirm",callback:e.proxy(a,this),autoclose:!1},{btext:s["\ucde8\uc18c"],btype:"normal",callback:e.proxy(l,this)}],closeCallback:e.proxy(l,this)})},setModifyMenuData:function(e){var t=["ko","en","jp","zhcn","zhtw","vi"];_.each(t,function(t){e[t+"Name"]&&(this.$('tr[data-id="'+t+'NameInput"]').show(),this.$('#moreName > option[value="'+t+'Name"]').remove())},this),this.$("#moreName option").size()==1&&this.$('tr[data-id="addMenuName"]').hide()},renderCricleView:function(e,t,n){var r=["user","position","grade","usergroup"];n&&(r=["user","department","position","grade","duty","usergroup"]);var s=new i({selector:e,isAdmin:!0,isWriter:!0,circleJSON:t,nodeTypes:r});return s.render(),s},prevent:function(e){e.keyCode==13&&e.preventDefault()}});return a});