define(["backbone","app","i18n!nls/commons","i18n!admin/nls/admin","i18n!approval/nls/approval","views/circle","models/site_config","approval/views/security_level_list","admin/views/approval/appr_form_integration/appr_form_integration_main","admin/views/appr_form_activity_group_app","admin/views/appr_form_template_editor","admin/views/admin_doc_type_select","admin/views/appr_line_rule_form","admin/models/integration_detail","admin/models/appr_form","admin/collections/appr_form_list","system/collections/companies","approval/collections/activity_groups","hgn!admin/templates/appr_form","hgn!admin/templates/appr_form_template_editor","hgn!admin/templates/appr_admin_owners","hgn!admin/templates/appr_admin_owners_data","hgn!admin/templates/appr_script_sample_data","jquery.go-sdk","jquery.jstree","jquery.go-popup","jquery.go-grid","jquery.go-orgslide","jquery.go-validation"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x,T,N,C,k,L,A,O,M,D=GO.contextRoot+"ad/api/",P={head_title:r["\uacb0\uc7ac \uc591\uc2dd"],caption:r["\uacc4\uc815 \ucd94\uac00 \ub4f1\ub85d"],title:n["\uc81c\ubaa9"],form_name:i["\uc591\uc2dd\uc81c\ubaa9"],alias:r["\uc591\uc2dd\uc57d\uc5b4"],code:r["\ucf54\ub4dc"],description:i["\uc591\uc2dd \ub3c4\uc6c0\ub9d0"],use_help:i["\uacb0\uc7ac\ubb38\uc11c\uc5d0\uc11c \ub3c4\uc6c0\ub9d0 \ubc84\ud2bc \uc81c\uacf5"],unuse_help:i["\uc81c\uacf5\ud558\uc9c0 \uc54a\uc74c"],appr_line:i["\uacb0\uc7ac\ub77c\uc778"],select_count:r["\uac2f\uc218 \uc120\ud0dd"],approver_name:r["\uacb0\uc7ac\uc790 \uc774\ub984"],agreer_name:r["\ud569\uc758\uc790 \uc774\ub984"],guide_approver_deletable:r["\uc0ac\uc6a9\uc790\uac00 \uc9c0\uc815 \uacb0\uc7ac\uc790\ub97c \uc0ad\uc81c\ud560 \uc218 \uc788\uc74c"],reception:r["\ubb38\uc11c \uc218\uc2e0"],use:n["\uc0ac\uc6a9"],possible:n["\uac00\ub2a5"],impossible:n["\ubd88\uac00\ub2a5"],year:i["\ub144"],dept:i["\ubd80\uc11c"],user:r["\uc0ac\uc6a9\uc790"],select_dept:r["\ubd80\uc11c \uac80\uc0c9"],select_user:r["\uc0ac\uc6a9\uc790 \uac80\uc0c9"],edit_template:r["\uc591\uc2dd \ud3b8\uc9d1"],template_editor:n["\uc591\uc2dd \ud3b8\uc9d1\uae30"],template_preview:n["\ubbf8\ub9ac\ubcf4\uae30"],load_template_title:n["\uc591\uc2dd \ubd88\ub7ec\uc624\uae30"],load_another_template:n["\ub2e4\ub978 \uc591\uc2dd \ubd88\ub7ec\uc624\uae30"],system_integration:r["\uc2dc\uc2a4\ud15c \uc5f0\ub3d9"],folder:r["\uc804\uc0ac \ubb38\uc11c\ud568\n\ubcf4\uad00 \ud3f4\ub354"],unsigned:r["\ubbf8\uc9c0\uc815"],folder_addable:r["\uc0ac\uc6a9\uc790\uac00 \uc800\uc7a5 \ud3f4\ub354\ub97c \ucd94\uac00\ud560 \uc218 \uc788\uc74c"],arbt_decision_active:r["\uc804\uacb0 \uc635\uc158"],use_right:r["\uc791\uc131 \uad8c\ud55c"],all_user:r["\uc804\uccb4 \uc0ac\uc6a9\uc790"],specific_user:r["\uc77c\ubd80 \uc0ac\uc6a9\uc790"],preserve_in_year:i["\ubcf4\uc874\uc5f0\ud55c"],preserve_changeable:r["\uc0ac\uc6a9\uc790 \ubcc0\uacbd \uac00\ub2a5"],securityLevel_changeable:r["\uc0ac\uc6a9\uc790 \ubcc0\uacbd \uac00\ub2a5"],activity_editable:r["\uacb0\uc7ac\uc120 \uc218\uc815"],document_editable:r["\ubb38\uc11c \uc218\uc815"],approver_allow:r["\uacb0\uc7ac\uc790\uac00 \uc218\uc815\ud560 \uc218 \uc788\uc74c"],approver_disallow:r["\uacb0\uc7ac\uc790\ub294 \uc218\uc815\ud560 \uc218 \uc5c6\uc74c"],official_document_send:i["\uacf5\ubb38 \ubc1c\uc1a1 \uae30\ub2a5"],invalid_template_html_activity_groups:i["\uacb0\uc7ac\ub77c\uc778 \uc815\ubcf4\uac00 \uc591\uc2dd\uc5d0 \ubc18\uc601\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \uc591\uc2dd\uc744 \uc218\uc815\ud574\uc8fc\uc138\uc694."],invalid_template_html_receivers:i["\uc591\uc2dd\uc5d0 \uc218\uc2e0\uc790 \uc815\ubcf4\uac00 \uc81c\ub300\ub85c \ubc18\uc601\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \uc591\uc2dd\uc744 \uc218\uc815\ud574\uc8fc\uc138\uc694."],is_over_max_approval_count:i["\uc9c0\uc815 \uacb0\uc7ac\uc790\uac00 \ucd5c\ub300 \uacb0\uc7ac\uc790 \uc778\uc6d0\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4."],is_nothing_checked_approval_type:i["\uacb0\uc7ac \ud0c0\uc785\uc744 \ud55c\uac1c \uc774\uc0c1 \uc120\ud0dd\ud574\uc8fc\uc138\uc694"],is_appointmentof_notselectedtype:i["\uc120\ud0dd\ud558\uc9c0 \uc54a\uc740 \ud0c0\uc785\uc758 \uc9c0\uc815 \uacb0\uc7ac\uc790\uac00 \uc788\uc2b5\ub2c8\ub2e4"],security_level:r["\ubcf4\uc548\ub4f1\uae09"],state:r["\uc0ac\uc6a9\uc5ec\ubd80"],hidden:r["\uc228\uae40"],normal:r["\uc815\uc0c1"],allow:n["\ud5c8\uc6a9"],disallow:n["\ube44\ud5c8\uc6a9"],empty_msg:r["\ub4f1\ub85d\ub41c \uc591\uc2dd\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],receiverEditable:r["\uc0ac\uc6a9\uc790\uac00 \uc218\uc2e0\ucc98 \uc218\uc815 \uac00\ub2a5"],referrerEditable:r["\uae30\uc548\uc790\uac00 \ucc38\uc870\uc790 \uc218\uc815 \uac00\ub2a5"],readerEditable:i["\uc0ac\uc6a9\uc790\uac00 \uc9c0\uc815 \uc5f4\ub78c\uc790 \uc0ad\uc81c \uac00\ub2a5"],adminUser:r["\uc6b4\uc601\uc790"],reader:r["\ubb38\uc11c \uc5f4\ub78c\uc790"],reference:r["\ubb38\uc11c \ucc38\uc870\uc790"],creation_success_msg:r["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc591\uc2dd \ubaa9\ub85d\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4."],creation_fail_msg:r["\uc800\uc7a5\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."],duplicated_name:r["\uc81c\ubaa9\uc774 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],duplicated_code:r["\ucf54\ub4dc\uac00 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],form_changed:i["\ucd5c\uc885\ubc84\uc804\uc591\uc2dd\uc774\uc544\ub2d9\ub2c8\ub2e4."],name_required:r["\uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694."],alias_required:r["\uc591\uc2dd\uc57d\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694."],name_invalid_length:r["\uc81c\ubaa9\uc740 100\uc790\uae4c\uc9c0 \uc785\ub825\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."],alias_invalid_length:r["\uc591\uc2dd\uc57d\uc5b4\ub294 100\uc790\uae4c\uc9c0 \uc785\ub825\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."],description_invalid_length:r["\uc591\uc2dd\uc124\uba85\uc740 500\uc790\uae4c\uc9c0 \uc785\ub825\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."],state_required:r["\uc0c1\ud0dc\ub97c \uc9c0\uc815\ud558\uc138\uc694."],integration_invalid:r["\uc5f0\ub3d9 \uc635\uc158\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694."],documentOpenable:r["\uacf5\uac1c\uc5ec\ubd80"],documentOpen:r["\uacf5\uac1c"],documentClose:r["\ube44\uacf5\uac1c"],documentOpenEditable:r["\uc0ac\uc6a9\uc790\uac00 \uacf5\uac1c\uc5ec\ubd80 \uc218\uc815 \uac00\ub2a5"],select:n["\uc120\ud0dd"],add:n["\ucd94\uac00"],"delete":n["\uc0ad\uc81c"],save:n["\uc800\uc7a5"],cancel:n["\ucde8\uc18c"],displayDrafter_desc:r["\uae30\uc548\uc790 \ud45c\uc2dc \uc124\uba85"],includeAgreement_desc:r["\uacb0\uc7ac\ubc29 \ud45c\uc2dc \uc124\uba85"],"\uc6b4\uc601\uc790 \ucd94\uac00":r["\uc6b4\uc601\uc790 \ucd94\uac00"],"\uc218\uc815\uad8c\ud55c":r["\uc218\uc815\uad8c\ud55c"],"\uc0ad\uc81c\uad8c\ud55c":r["\uc0ad\uc81c\uad8c\ud55c"],"\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5":r["\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5"],"\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5 \uc124\uba85":r["\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5 \uc124\uba85"],"1\uc778\uacb0\uc7ac \uc635\uc158":r["1\uc778\uacb0\uc7ac \uc635\uc158"],"1\uc778\uacb0\uc7ac \uc635\uc158 \uc124\uba85":r["1\uc778\uacb0\uc7ac \uc635\uc158 \uc124\uba85"],"\uac8c\uc2dc\ud310 \ub4f1\ub85d \uae30\ub2a5":r["\uac8c\uc2dc\ud310 \ub4f1\ub85d \uae30\ub2a5"],"\uc0ac\uc6a9":n["\uc0ac\uc6a9"],"\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c":n["\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"],"\uc790\ub3d9\uacb0\uc7ac\uc120":r["\uc790\ub3d9\uacb0\uc7ac\uc120"],code_required:i["\ucf54\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694"],apprlineruleid_required:i["\uc790\ub3d9 \uacb0\uc7ac\uc120\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694"],invalid_apprlinerule_form:i["\uc790\ub3d9\uacb0\uc7ac\uc120 \uc815\ubcf4\uac00 \uc591\uc2dd\uc5d0 \ubc18\uc601\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4 \uc591\uc2dd\uc744 \uc218\uc815\ud574\uc8fc\uc138\uc694"],script:i["\uc2a4\ud06c\ub9bd\ud2b8"],"\ubcc0\uacbd":n["\ubcc0\uacbd"],"\uc218\uc2e0\ucc98 \uc9c0\uc815 \ud544\uc218":i["\uc218\uc2e0\ucc98 \uc9c0\uc815 \ud544\uc218"],"\uc218\uc2e0\ubb38\uc11c \uc218\uc815 \ud5c8\uc6a9":i["\uc218\uc2e0\ubb38\uc11c \uc218\uc815 \ud5c8\uc6a9"],"\ud30c\uc77c\uacbd\ub85c":i["\ud30c\uc77c\uacbd\ub85c"],"\uc2a4\ud06c\ub9bd\ud2b8\ud3b8\uc9d1":i["\uc2a4\ud06c\ub9bd\ud2b8\ud3b8\uc9d1"],"\uc2a4\ud06c\ub9bd\ud2b8 \uc608\uc2dc":i["\uc2a4\ud06c\ub9bd\ud2b8 \uc608\uc2dc"],"\uc218\uc815":n["\uc218\uc815"],"\uacf5\ubb38\ubc1c\uc1a1\uc591\uc2dd\uc124\uba85":i["\uacf5\ubb38\ubc1c\uc1a1\uc591\uc2dd\uc124\uba85"],"\uc2dc\ud589\ubb38":i["\uc2dc\ud589\ubb38"],"\ubc1c\uc2e0\uba85\uc758":i["\ubc1c\uc2e0\uba85\uc758"],"\uc9c1\uc778":i["\uc9c1\uc778"],"\ubbf8\ub9ac\ubcf4\uae30\uc9c1\uc778\ub178\ucd9c":i["\ubbf8\ub9ac\ubcf4\uae30 \uc9c1\uc778 \ub178\ucd9c"],"\ubbf8\ub9ac\ubcf4\uae30\uc9c1\uc778\ub178\ucd9c\uc124\uba85":i["\ubbf8\ub9ac\ubcf4\uae30\uc9c1\uc778\ub178\ucd9c\uc124\uba85"],changeable:r["\uc0ac\uc6a9\uc790 \ubcc0\uacbd \uac00\ub2a5"],"\uc804\uacb0\uc644\ub8cc\uc720\ud615\ubb38\uc11c":i["\uc804\uacb0\uc644\ub8cc\uc720\ud615\ubb38\uc11c"],"\uc804\uacb0\uc644\ub8cc\uc720\ud615\uacb0\uc7ac\ubc29":i["\uc804\uacb0\uc644\ub8cc\uc720\ud615\uacb0\uc7ac\ubc29"],"\uc5f0\ub3d9\ucf54\ub4dc\uc124\uba85":i["\uacb0\uc7ac \uc5f0\ub3d9\ucf54\ub4dc \uc124\uba85"],"\uae30\ubcf8":n["\uae30\ubcf8"],"\uacb0\uc7ac\uc815\ubcf4":n["\uacb0\uc7ac\uc815\ubcf4"],"\uad8c\ud55c \ubcf4\uc548":n["\uad8c\ud55c \ubcf4\uc548"],"\uae30\ud0c0":n["\uae30\ud0c0"],"\uc591\uc2dd \uc57d\uc5b4 \ub3c4\uc6c0\ub9d0":n["\uc591\uc2dd \uc57d\uc5b4 \ub3c4\uc6c0\ub9d0"],"\uc804\uc0ac \ubb38\uc11c\ud568 \ubcf4\uad00 \ud3f4\ub354 \ub3c4\uc6c0\ub9d0":n["\uc804\uc0ac \ubb38\uc11c\ud568 \ubcf4\uad00 \ud3f4\ub354 \ub3c4\uc6c0\ub9d0"],"\uc591\uc2dd \ud3b8\uc9d1 \ub3c4\uc6c0\ub9d0":n["\uc591\uc2dd \ud3b8\uc9d1 \ub3c4\uc6c0\ub9d0"],"\uc0ac\uc6a9 \uc5ec\ubd80 \ub3c4\uc6c0\ub9d0":n["\uc0ac\uc6a9 \uc5ec\ubd80 \ub3c4\uc6c0\ub9d0"],"\ubb38\uc11c \ucc38\uc870\uc790 \ub3c4\uc6c0\ub9d0":n["\ubb38\uc11c \ucc38\uc870\uc790 \ub3c4\uc6c0\ub9d0"],"\ubb38\uc11c \uc5f4\ub78c\uc790 \ub3c4\uc6c0\ub9d0":n["\ubb38\uc11c \uc5f4\ub78c\uc790 \ub3c4\uc6c0\ub9d0"],"\ubb38\uc11c \uc218\uc2e0 \ub3c4\uc6c0\ub9d0":n["\ubb38\uc11c \uc218\uc2e0 \ub3c4\uc6c0\ub9d0"],"\uacf5\ubb38 \ubc1c\uc1a1 \uae30\ub2a5 \ub3c4\uc6c0\ub9d0":n["\uacf5\ubb38 \ubc1c\uc1a1 \uae30\ub2a5 \ub3c4\uc6c0\ub9d0"],"\uc804\uacb0 \ub3c4\uc6c0\ub9d0":n["\uc804\uacb0 \ub3c4\uc6c0\ub9d0"],"1\uc778 \uacb0\uc7ac \ub3c4\uc6c0\ub9d0":n["1\uc778 \uacb0\uc7ac \ub3c4\uc6c0\ub9d0"],"\uc791\uc131 \uad8c\ud55c \ub3c4\uc6c0\ub9d0":n["\uc791\uc131 \uad8c\ud55c \ub3c4\uc6c0\ub9d0"],"\ubb38\uc11c \uc218\uc815 \ub3c4\uc6c0\ub9d0":n["\ubb38\uc11c \uc218\uc815 \ub3c4\uc6c0\ub9d0"],"\uacb0\uc7ac\uc120 \uc218\uc815 \ub3c4\uc6c0\ub9d0":n["\uacb0\uc7ac\uc120 \uc218\uc815 \ub3c4\uc6c0\ub9d0"],"\uc6b4\uc601\uc790 \ub3c4\uc6c0\ub9d0":n["\uc6b4\uc601\uc790 \ub3c4\uc6c0\ub9d0"],"\ubcf4\uc874\uc5f0\ud55c \ub3c4\uc6c0\ub9d0":n["\ubcf4\uc874\uc5f0\ud55c \ub3c4\uc6c0\ub9d0"],"\ubcf4\uc548\ub4f1\uae09 \ub3c4\uc6c0\ub9d0":n["\ubcf4\uc548\ub4f1\uae09 \ub3c4\uc6c0\ub9d0"],"\uacf5\uac1c\uc5ec\ubd80 \ub3c4\uc6c0\ub9d0":n["\uacf5\uac1c\uc5ec\ubd80 \ub3c4\uc6c0\ub9d0"],"\uc591\uc2dd \ub3c4\uc6c0\ub9d0":n["\uc591\uc2dd \ub3c4\uc6c0\ub9d0"],"\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5 \ub3c4\uc6c0\ub9d0":n["\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5 \ub3c4\uc6c0\ub9d0"],"\uac8c\uc2dc\ud310 \ub4f1\ub85d \uae30\ub2a5 \ub3c4\uc6c0\ub9d0":n["\uac8c\uc2dc\ud310 \ub4f1\ub85d \uae30\ub2a5 \ub3c4\uc6c0\ub9d0"],"\uc2dc\uc2a4\ud15c \uc5f0\ub3d9 \ub3c4\uc6c0\ub9d0":n["\uc2dc\uc2a4\ud15c \uc5f0\ub3d9 \ub3c4\uc6c0\ub9d0"],"\uacb0\uc7ac\uc120\uc744 \ucd94\uac00\ud55c \ud6c4 \uc800\uc7a5\ud574 \uc8fc\uc138\uc694":n["\uacb0\uc7ac\uc120\uc744 \ucd94\uac00\ud55c \ud6c4 \uc800\uc7a5\ud574 \uc8fc\uc138\uc694"],"\ubaa8\ub4e0 \uacb0\uc7ac \uad8c\ud55c \uc0ac\uc6a9\uc790":i["\ubaa8\ub4e0 \uacb0\uc7ac \uad8c\ud55c \uc0ac\uc6a9\uc790"],"\uc77c\ubd80 \uacb0\uc7ac \uad8c\ud55c \uc0ac\uc6a9\uc790":i["\uc77c\ubd80 \uacb0\uc7ac \uad8c\ud55c \uc0ac\uc6a9\uc790"],"\uacb0\uc7ac":i["\uacb0\uc7ac"],"\ud569\uc758":i["\ud569\uc758"],"\uac10\uc0ac":i["\uac10\uc0ac"],"\ud655\uc778":i["\ud655\uc778"],"\uacb0\uc7ac\uc591\uc2dd\uc800\uc7a5\uc548\ub0b4":r["\uacb0\uc7ac\uc591\uc2dd\uc800\uc7a5\uc548\ub0b4"],"\ubaa8\ubc14\uc77c \uae30\uc548 \ud5c8\uc6a9":i["\ubaa8\ubc14\uc77c \uae30\uc548 \ud5c8\uc6a9"],"\ubaa8\ubc14\uc77c \uae30\uc548 \ud5c8\uc6a9 \ub3c4\uc6c0\ub9d0":i["\ubaa8\ubc14\uc77c \uae30\uc548 \ud5c8\uc6a9 \ub3c4\uc6c0\ub9d0"]};return x=e.Model.extend({url:D+"approval/admin/config"}),A=e.Collection.extend({url:D+"approval/official/form"}),O=e.Collection.extend({url:D+"approval/official/sender"}),M=e.Collection.extend({url:D+"approval/official/sign"}),T=e.Model.extend({defaults:{name:"",beanName:"",description:"",isSelected:!1}}),N=e.Collection.extend({url:D+"approval/integration",model:T,getSelected:function(){return this.find(function(e){return e.get("isSelected")})},setSelected:function(e){var t=this.find(function(t){return t.get("beanName")==e});t&&t.set("isSelected",!0)},selectFirstOneIfNothingSelected:function(){if(this.isEmpty()||this.getSelected())return;this.at(0).set("isSelected",!0)}}),k=e.Collection.extend({url:function(){return GO.contextRoot+"ad/api/approval/apprlinerule"}}),L=e.Model.extend(),C=e.View.extend({tagName:"select",className:"integration_list",selected:null,optNameForIntegrationBtn:"standardApprIntegration",initialize:function(e){this.collection=new N,e.selected&&(this.selected=e.selected)},render:function(){return this.$el.remove(),this.$el.text(r["\uc5f0\ub3d9 \ud504\ub85c\uadf8\ub7a8 \uc120\ud0dd"]),this.$el.hide(),this.collection.fetch({success:$.proxy(function(e){_.isNull(this.selected)||e.setSelected(this.selected.beanName),e.selectFirstOneIfNothingSelected(),this.$el.append(this._renderTemplate({list:e.toJSON()})),this.trigger("toggleConfigStandardButton",this.collection.findWhere({isSelected:true}).get("beanName")==this.optNameForIntegrationBtn)},this)}),$("select."+this.className).die().live("change",$.proxy(this._onSelected,this)),$("#docInfo_txt_form").trigger("change"),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},getSelectedAsJSON:function(){var e=_.find(this.collection.models,function(e){return e.get("isSelected")==1});return e.toJSON()},_renderTemplate:function(e){var t=["{{#list}}",'    <option value="{{beanName}}" {{#isSelected}}selected{{/isSelected}}>{{name}}</option>',"{{/list}}"];return Hogan.compile(t.join("")).render(e)},_onSelected:function(e){var t=$(e.target).val();_.map(this.collection.models,function(e){e.get("beanName")==t?e.set("isSelected",!0):e.set("isSelected",!1)}),this.trigger("toggleConfigStandardButton",t==this.optNameForIntegrationBtn)}}),e.View.extend({el:"#layoutContent",model:null,apprLineView:null,receiverView:null,formUserView:null,templateEditorView:null,initEditor:null,integrationListView:null,securityLevelListView:null,preserveYears:[],receiveAllowType:"ALL",adminUserData:[],events:{"click div.tit":"_onClickFold",'change input[name="name"]':"_onChangeName"},initialize:function(e){this.$el.off(),e=_.extend({},e),this.model=e.model,this.apprConfigModel=new x({}),this.companyCollection=new m({type:"companygroup"}),this.apprLineRuleCollection=new k,this.isServiceMode=GO.session().serviceAdminMode,this.isSystemAdmin=GO.session().systemAdmin,this.siteConfigModel=new o.read({isAdmin:!0}),this.isEditableIntegration=!this.isServiceMode||this.isSystemAdmin||this.siteConfigModel.get("allianceSystemService")=="on",this.activityGroups=new g,this.bindEvents(),this.listenTo(this.model,"sync",this._onSyncModel),this.listenTo(this.activityGroups,"change",this._onChangeActivityGroups),this.listenTo(this.activityGroups,"remove",this._onRemoveActivityGroups),this.model.id||this._initTemplateEditor(),this.listenTo(this.model,"change:name",_.bind(function(e){this.$('input[name="name"]').val(e.get("name"))},this))},bindEvents:function(){this.$el.off("change","input[name=useHelp]"),this.$el.off("change","input[name=receptionActive]"),this.$el.off("change","input[name=receiverEditable]"),this.$el.off("change","input[name=integrationActive]"),this.$el.off("click","input[name=formUserScope]"),this.$el.off("click","#load_template_editor"),this.$el.off("click","#preview_template"),this.$el.off("click","#save_btn"),this.$el.off("click","#cancel_btn"),this.$el.off("click","#btn_config_standard"),this.$el.off("change","input[name=useApprLineRule]"),this.$el.off("click","#apprLineRule_add"),this.$el.off("click","#cancelSelectedLineRule"),this.$el.off("change","#input[name=scriptType]"),this.$el.off("click","#scriptInitData"),this.$el.off("change","input[name=officialDocumentSendable]"),this.$el.off("change","select[name=officialSender]"),this.$el.off("change","input[name=arbtDecisionActive]"),this.$el.on("change","input[name=useHelp]",$.proxy(this._changeUseHelpConfig,this)),this.$el.on("change","input[name=receptionActive]",$.proxy(this._onReceptionActiveChecked,this)),this.$el.on("change","input[name=receiverEditable]",$.proxy(this._offReceiverEditableChecked,this)),this.$el.on("change","input[name=readerActive]",$.proxy(this._onReaderActiveChecked,this)),this.$el.on("change","input[name=referenceActive]",$.proxy(this._onReferenceActiveChecked,this)),this.$el.on("change","input[name=integrationActive]",$.proxy(this._onIntegrationActiveChanged,this)),this.$el.on("click","input[name=formUserScope]",$.proxy(this._onFormUserScopeChanged,this)),this.$el.on("click","#load_template_editor",$.proxy(this._openTemplateEditor,this)),this.$el.on("click","#preview_template",$.proxy(this._previewTemplate,this)),this.$el.on("click","#save_btn",$.proxy(this._onSaveClicked,this)),this.$el.on("click","#cancel_btn",$.proxy(this._onCancelClicked,this)),this.$el.on("click","#docInfo_btn_edit",$.proxy(this._docTypeSelect,this)),this.$el.on("click","#docInfo_btn_delete",$.proxy(this._docTypeDelete,this)),this.$el.on("click","#admin",$.proxy(this._addAdmin,this)),this.$el.on("click","#adminTable span.ic_basket",$.proxy(this._deleteAdmin,this)),this.$el.on("click","#btn_config_standard",$.proxy(this._popupConfigStandardLayer,this)),this.$el.on("change","input[name=useApprLineRule]",$.proxy(this._changeUseApprLineRule,this)),this.$el.on("click","#apprLineRule_add",$.proxy(this._addApprLineRule,this)),this.$el.on("click","#cancelSelectedLineRule",$.proxy(this.cancelSelectedLineRule,this)),this.$el.on("change","input[name=scriptType]",$.proxy(this._onScriptTypeChecked,this)),this.$el.on("click","#scriptInitData",$.proxy(this._popupScriptSampleLayer,this)),this.$el.on("change","input[name=officialDocumentSendable]",$.proxy(this._changeOfficialConfig,this)),this.$el.on("change","input[name=arbtDecisionActive]",$.proxy(this._onArbtDecisionActiveChanged,this)),this.$el.on("change","#docInfo_txt_form",$.proxy(this._onChangeCompanyFolder,this)),this.$el.off("click","#load_old_template_editor").on("click","#load_old_template_editor",$.proxy(this._openOldTemplateEditor,this)),this.$el.on("change","input[name=documentEditable]",$.proxy(this._onDocumentEditableChanged,this)),this.$el.on("change","input[name=documentEditableType]",$.proxy(this._onDocumentEditableTypeChanged,this)),this.$el.on("change","input[name=activityEditable]",$.proxy(this._onActivityEditableChanged,this)),this.$el.on("change","input[name=activityEditableType]",$.proxy(this._onActivityEditableTypeChanged,this))},render:function(){this.apprConfigModel.fetch({success:_.bind(function(e){this.receiveAllowType=e.get("receiveAllowType"),this.allowAgreement=e.get("useAgreement"),this.agreementAllowType=e.get("agreementAllowType"),this.allowCheck=e.get("useCheckActivity"),this.allowInspection=e.get("useInspectionActivity"),this.apprLineRuleFormModel=new L(this.model.get("apprLineRuleModel")),e.get("multiCompanySupporting")==1?this.companyCollection.fetch({success:_.bind(function(e){this.companyIds=e.map(function(e){return e.id}),this.templateEditorView.setCompanyIds(this.companyIds),this._renderWithData(this.companyIds)},this)}):this._renderWithData(null)},this)})},_onClickFold:function(e){var t=$(e.currentTarget).parent(".module_drop_head").siblings(".module_drop_body").toggle();t.is(":visible")&&t.find("#useHelp").is(":checked")&&this._initDescriptionEditor()},_initDescriptionEditor:function(){if(this.initEditor)return;this.initEditor=$("#description_editor").goWebEditor({contextRoot:GO.config("contextRoot"),lang:GO.session("locale"),editorValue:this.model.get("description"),appLoadCallBack:function(){$("#useHelp").is(":checked")||$("#description").hide()}})},_renderWithData:function(e){var t=this._makeTemplateData();this.$el.html(y(t)),this._renderReceptionView(e),this._renderIntegrationListView(),this._renderFormUserView(),this._renderSecurityLevelView(),this._renderAdminView(),this._renderApprLineView(e),this._renderOfficialForms(),this._renderOfficialSenders(),this._renderOfficialSigns(),this._renderReaderView(e),this._renderReferenceView(e),this._renderDocAndActivityEditable()},_makeTemplateData:function(){var e=this.model.id?!1:!0,r=_.map(d.PRESERVE_YEARS,function(e){return{value:e,label:e==0?i["\uc601\uad6c"]:t.i18n(n["{{arg1}}\ub144"],{arg1:e}),isSelected:this.model.get("preserveDurationInYear")*1==e*1}},this),s=this.model.get("state")=="NORMAL",o=this.model.get("allowMobileApproval")||!1,u=this.model.get("formUserScope")=="ALL",a=this.model.get("formScriptType")=="SRC",f=this.model.get("officialSenderId")=="",l=this.model.get("arbtDecisionType")=="DOCUMENT",c=this.apprConfigModel.get("useAgreement")||!1,h=this.apprConfigModel.get("useCheckActivity")||!1,p=this.apprConfigModel.get("useInspectionActivity")||!1,v=c||h||p,m={lang:P,isCreate:e,preserveYears:r,wrappedState:s,wrappedFormUserScope:u,wrappedAllowMobileApproval:o,scriptTypeInput:a,notUseOfficialSender:f,arbtDecisionTypeValue:l,isEditableIntegration:this.isEditableIntegration,useCompanyApprovalOtherType:v,useCompanyAgreement:c,useCompanyCheckActivity:h,useCompanyInspectionActivity:p};return _.extend(m,this.model.toJSON())},_renderDocAndActivityEditable:function(){var e=!1;this.model.get("useDocEditableTypeAll")==undefined||!this._useDocEditableTypes()?e=!0:e=this.model.get("useDocEditableTypeAll"),e?(this.$("#documentEditableTypeAll").prop("checked",!0),this.$("#documentEditableTypes").hide()):this.$("#documentEditableTypes").show(),this.model.get("useActivityEditableTypeAll")==undefined||!this._useActivityEditableTypes()?useActivityEditableTypeAll=!0:useActivityEditableTypeAll=this.model.get("useActivityEditableTypeAll"),useActivityEditableTypeAll?(this.$("#activityEditableTypeAll").prop("checked",!0),this.$("#activityEditableTypes").hide()):this.$("#activityEditableTypes").show()},_useDocEditableTypes:function(){return this.model.get("useDocEditableApproval")||this.model.get("useDocEditableAgreement")||this.model.get("useDocEditableInspection")||this.model.get("useDocEditableCheck")?!0:!1},_useActivityEditableTypes:function(){return this.model.get("useActivityEditableApproval")||this.model.get("useActivityEditableAgreement")||this.model.get("useActivityEditableInspection")||this.model.get("useActivityEditableCheck")?!0:!1},_renderApprLineView:function(e){this.apprLineView=new f({groups:this.activityGroups,apprlinerule:this.model.get("apprLineRuleModel"),companyIds:e,allowAgreement:this.allowAgreement,agreementAllowType:this.agreementAllowType,allowCheck:this.allowCheck,allowInspection:this.allowInspection,formid:this.model.id}),this.$el.find("#appr_line_td").prepend(this.apprLineView.render())},_renderOfficialForms:function(){var e=this;this.officialFormCollection=new A,this.officialFormCollection.fetch({success:function(t){e._markSelectedOfficialData(t,e.model.get("officialFormId")),e.$el.find("select[name=officialForm]").append(e._renderOfficalTmpl({officialData:t.toJSON()}))}})},_renderOfficialSenders:function(){var e=this;this.officialSenderCollection=new O,this.officialSenderCollection.fetch({success:function(t){e._markSelectedOfficialData(t,e.model.get("officialSenderId")),e.$el.find("select[name=officialSender]").append(e._renderOfficalTmpl({officialData:t.toJSON()}))}})},_renderOfficialSigns:function(){var e=this;this.officialSignCollection=new M,this.officialSignCollection.fetch({success:function(t){e._markSelectedOfficialData(t,e.model.get("officialSignId")),e.$el.find("select[name=officialSign]").append(e._renderOfficalTmpl({officialData:t.toJSON()}))}})},_renderOfficalTmpl:function(e){var t=[];_.extend(e,{}),t.push("{{#officialData}}"),t.push('    <option value="{{id}}" {{#isSelected}}selected{{/isSelected}}>{{name}}</option>'),t.push("{{/officialData}}");var n=Hogan.compile(t.join("\n"));return n.render(e)},_markSelectedOfficialData:function(e,t){t&&e.each(function(e){e.get("id")==t&&e.set("isSelected",!0)})},_renderReceptionView:function(e){var t=[];this.receiveAllowType=="ALL"?GO.util.isUseOrgService(!0)&&(t=["user","department-nosub"]):this.receiveAllowType=="DEPARTMENT"?GO.util.isUseOrgService(!0)&&(t=["department-nosub"]):this.receiveAllowType=="USER"&&(t=["user"]),this.receiverView=new s({selector:"#form_receiver",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("receiver"),nodeTypes:t,withCompanies:!0,companyIds:e,useApprReception:!0,noSubDept:!0,companyCollectionType:"companygroup"}),this.receiverView.render()},_renderReaderView:function(e){var t=["user"];this.readerView=new s({selector:"#form_reader",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("reader"),nodeTypes:t,withCompanies:!0,companyIds:e,companyCollectionType:"companygroup"}),this.readerView.render()},_renderReferenceView:function(e){var t=["user"];GO.util.isUseOrgService(!0)&&(t=["user","department"]),this.referrerView=new s({selector:"#form_referrer",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("referrer"),nodeTypes:t,withCompanies:!0,companyIds:e,useApprReference:!0,companyCollectionType:"companygroup"}),this.referrerView.render()},_renderIntegrationListView:function(){this.integrationListView=new C({selected:this.model.get("integration")}),this.integrationListView.render(),this.$("#integration_container span:eq(1)").after(this.integrationListView.$el),this.model.get("integrationActive")==1&&this.integrationListView.show(),this.listenTo(this.integrationListView,"toggleConfigStandardButton",this.toggleConfigStandardButton),this.$("#integration_container .integration_list").after('<span class="btn_wrap"><span class="btn_s" id="btn_config_standard">'+n["\uc124\uc815"]+"</span></span>")},toggleConfigStandardButton:function(e){this.$("#btn_config_standard").toggle(e)},_renderFormUserView:function(){var e=["user","position","grade","usergroup"];GO.util.isUseOrgService(!0)&&(e=["user","department","position","grade","duty","usergroup"]),this.formUserView=new s({selector:"#formUser",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("formUser"),nodeTypes:e}),this.formUserView.render(),this.model.get("formUserScope")=="ALL"?this.formUserView.hide():this.formUserView.show()},_renderSecurityLevelView:function(){this.securityLevelListView=new u({el:this.$el.find("select[name=securityLevel]"),selectedData:this.model.get("securityLevel")}),this.securityLevelListView.render()},_renderAdminView:function(){var e=this,t=$("#adminTable .in_table");e.adminUserData=[],this.model.get("admin")&&_.each(this.model.get("admin").nodes,function(n){n&&!t.find('tr[data-id="'+n.nodeId+'"]').length&&(t.length||($("#adminTable").append(w({lang:P})),t=$("#adminTable .in_table")),t.find("tbody").append(E($.extend({id:n.nodeId,name:n.nodeValue,writeChecked:n.actions.indexOf("write")!=-1,removeChecked:n.actions.indexOf("remove")!=-1},{lang:P}))),e.adminUserData.push(n))})},_addAdminEl:function(e){var t=this,n=$("#adminTable .in_table");e&&!n.find('tr[data-id="'+e.id+'"]').length&&(n.length||($("#adminTable").append(w({lang:P})),n=$("#adminTable .in_table")),n.find("tbody").append(E($.extend(e,{lang:P}))),t.adminUserData.push({nodeId:e.id,nodeDeptId:e.deptId,nodeCompanyId:null,nodeCompanyName:null,nodeType:"user",nodeValue:e.name+" "+e.position,actions:"",members:[]}))},_addAdmin:function(e){var t=this;$.goOrgSlide({target:e,header:"",type:"list",isAdmin:!0,contextRoot:GO.config("contextRoot"),callback:$.proxy(t._addAdminEl,t)})},_deleteAdmin:function(e){var t=this,n=this.$el.find("#adminTable>table"),r=$(n[0]),i=n.find("tbody");i.find('tr[data-id="'+$(e.currentTarget).attr("data-id")+'"]').remove(),t.adminUserData=_.reject(t.adminUserData,function(t){return t.nodeId==$(e.currentTarget).attr("data-id")}),r.find("tbody>tr").length||r.remove()},_changeUseHelpConfig:function(e){$("#description").toggle($(e.target).is(":checked")),this._initDescriptionEditor()},_changeOfficialConfig:function(e){$("#official_detail").toggle($(e.target).is(":checked"))},_onReceptionActiveChecked:function(e){this.$("#reception_detail").toggle($(e.target).is(":checked"))},_onScriptTypeChecked:function(){var e=this.$('input[name="scriptType"]:checked').val()=="SRC";this.$('input[name="externalScript"]').toggle(e),this.$('textarea[name="scriptBody"]').toggle(!e),$("#scriptInitData").toggle(!e)},_offReceiverEditableChecked:function(e){$(e.target).is(":checked")?this.$("#useRequiredReceiver").attr("disabled",!1):(this.$("#useRequiredReceiver").attr("checked",!1),this.$("#useRequiredReceiver").attr("disabled",!0))},_onReaderActiveChecked:function(e){this.$("#reader_detail").toggle($(e.target).is(":checked"))},_onReferenceActiveChecked:function(e){this.$el.find("#reference_detail").toggle($(e.target).is(":checked"))},_onIntegrationActiveChanged:function(e){var t=$(e.target).is(":checked"),n=t&&this.$(".integration_list").val()=="standardApprIntegration";this.$("#btn_config_standard").toggle(n),t||this.model.set("integration",{}),this.integrationListView.$el.toggle(t),this.$("#integrationLayer").toggle(t)},_onArbtDecisionActiveChanged:function(e){this.$("#arbtDecision_detail").toggle($(e.target).is(":checked"))},_onDocumentEditableChanged:function(e){this.$("#documentEditable_detail").toggle($(e.target).is(":checked"))},_onActivityEditableChanged:function(e){this.$("#activityEditable_detail").toggle($(e.target).is(":checked"))},_onDocumentEditableTypeChanged:function(e){var t=this.$('input[name="documentEditableType"]:checked').val()=="All";t?this.$("#documentEditableTypes").hide():(this.$("#documentEditableTypes input:checkbox").prop("checked",!1),this.$('#documentEditableTypes input[name="docEditableApproval"]').prop("checked",!0),this.$("#documentEditableTypes").show())},_onActivityEditableTypeChanged:function(e){var t=this.$('input[name="activityEditableType"]:checked').val()=="All";t?this.$("#activityEditableTypes").hide():(this.$("#activityEditableTypes input:checkbox").prop("checked",!1),this.$('#activityEditableTypes input[name="activityEditableApproval"]').prop("checked",!0),this.$("#activityEditableTypes").show())},_onChangeCompanyFolder:function(e){var t=_.isEmpty($(e.currentTarget).attr("data-docTypeId"));t?this.$("#docInfo_txt_formAlert").text(r["\uc804\uc0ac \ubb38\uc11c\ud568 \ud3f4\ub354\uac00 \uc9c0\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):this.$("#docInfo_txt_formAlert").text(""),this.$("#docInfo_btn_delete").toggle(!t)},_onFormUserScopeChanged:function(e){var t=$(e.target).is(":checked");t&&this.model.set("formUser",{}),t?this.formUserView.hide():this.formUserView.show()},_openOldTemplateEditor:function(){this.templateEditorView.setApprovalInfo(this.activityGroups),this.templateEditorView.setCompanyIds(this.companyIds),this.templateEditorView.renderOldFormEditor()},_openTemplateEditor:function(){this.templateEditorView.setApprovalInfo(this.activityGroups),this.templateEditorView.setTitle(this.model.get("name")),this.templateEditorView.setCompanyIds(this.companyIds),this.templateEditorView.render()},_previewTemplate:function(){this.templateEditorView.preview()},_docTypeSelect:function(){var e=this,t=$.goPopup({pclass:"layer_normal layer_approval_line_state",header:i["\ubb38\uc11c \ubd84\ub958 \uc120\ud0dd"],modal:!0,width:300,contents:"",buttons:[{btext:n["\ud655\uc778"],autoclose:!1,btype:"confirm",callback:function(t){if(!r.doc_type_confirm())return!1;e.$el.find("#docInfo_txt_form").trigger("change"),t.close()}},{btext:n["\ucde8\uc18c"],btype:"cancel"}]}),r=new c({});r.render(),t.reoffset()},_docTypeDelete:function(){$("#docInfo_txt_form").text(""),$("#docInfo_txt_form").attr("data-docTypeId",""),$("#docInfo_txt_form").trigger("change")},_popupScriptSampleLayer:function(){var e=$.goPopup({pclass:"layer_normal system_link_popup",header:i["\uc2a4\ud06c\ub9bd\ud2b8 \uc608\uc2dc"],modal:!0,width:700,contents:"",buttons:[{btext:n["\ub2eb\uae30"],btype:"cancel"}]});e.find(".content").html(S({lang:P})),e.reoffset()},_popupConfigStandardLayer:function(){var e=this,t=$.goPopup({pclass:"layer_normal layer_appr_link",header:i["\uacb0\uc7ac DB \uc5f0\ub3d9 \uc124\uc815"],modal:!0,width:1e3,contents:"",buttons:[{btext:n["\ud655\uc778"],autoclose:!1,btype:"confirm",callback:function(t){var n=e.apprFormIntegrationMainView.validate();if(n){var r=e.apprFormIntegrationMainView.getData();e.model.setIntegrationDetailModel(r.toJSON()),t.close()}}},{btext:n["\ucde8\uc18c"],btype:"cancel"}]}),r=this.model.getIntegrationDetailModel();this.apprFormIntegrationMainView=new a({model:new p(r)}),this.apprFormIntegrationMainView.fetchDataSource().done(function(){e.apprFormIntegrationMainView.render(),t.reoffset(),t.css("position","absolute")})},getIntegrationData:function(){var e,t=this.integrationListView.getSelectedAsJSON();return this.$el.find("#integrationActive").is(":checked")&&(e=this.model.getIntegrationDetailModel(),e.formCode=this.model.get("code"),t.integrationDetailModel=e),t},_addApprLineRule:function(){var e=this,t=$.goPopup({pclass:"layer_normal layer_pay_line",header:P["\uc790\ub3d9\uacb0\uc7ac\uc120"],modal:!0,width:504,contents:"",buttons:[{btext:n["\ud655\uc778"],autoclose:!1,btype:"confirm",callback:function(t){e.apprLineRuleFormModel=$(t[0]).find(".content").data("instance").ApprLineRuleFormModel;var n=$(t[0]).find("#apprLineRuleSelect option:selected").text(),r=$(t[0]).find("#apprLineRuleSelect option:selected").val();!_.isEmpty(n)&&!_.isEmpty(r)&&e._setSelectedLineRule(r,n),t.close()}},{btext:n["\ucde8\uc18c"],btype:"cancel"}]});this.apprLineRuleCollection.fetch({success:function(){var n=new h({collection:e.apprLineRuleCollection});n.render(),t.reoffset(),$("#apprLineRule_add span.txt").attr("data-state")=="selected"&&n.trigger("_callApprLineRuleSelect")}})},_changeUseApprLineRule:function(e){var t=$("#appr_line_tbl tr:eq(0) .approver_max #selectApproverCount");if($(e.currentTarget).is(":checked"))$("#appr_line_tbl tr:eq(0) .tb_approval_line .userAdd").hide(),$("#appr_line_tbl tr:eq(0) .tb_approval_line .apprLineRule").show(),$("#apprLineRule_add span.txt").attr("data-state")=="selected"&&$("#appr_line_tbl tr:eq(0) .tb_approval_line .selectedLineRule").show(),t.attr("disabled",!0),t.attr("tempVal",$("#appr_line_tbl tr:eq(0) .approver_max #selectApproverCount").val()),t.val("10").trigger("change");else{$("#appr_line_tbl tr:eq(0) .tb_approval_line .userAdd").show(),$("#appr_line_tbl tr:eq(0) .tb_approval_line .apprLineRule").hide(),$("#appr_line_tbl tr:eq(0) .tb_approval_line .selectedLineRule").hide(),t.attr("disabled",!1);var n=t.attr("tempVal")||5;t.val(n).trigger("change")}},_setSelectedLineRule:function(e,t){$("#selectedLineRule").text(t),$("#selectedLineRule").attr("data-id",e),$("#appr_line_tbl tr:eq(0) .tb_approval_line .selectedLineRule").show(),$("#apprLineRule_add span.txt").text(P["\ubcc0\uacbd"]),$("#apprLineRule_add span.txt").attr("data-state","selected")},cancelSelectedLineRule:function(){$("#appr_line_tbl tr:eq(0) .tb_approval_line .selectedLineRule").hide(),$("#appr_line_tbl tr:eq(0) .tb_approval_line #selectedLineRule").attr("data-id",""),$("#apprLineRule_add span.txt").text(P["\uc790\ub3d9\uacb0\uc7ac\uc120"]),$("#apprLineRule_add span.txt").attr("data-state","ready")},_onSaveClicked:function(){var e=GO.Editor.getInstance("description_editor"),t=e&&e.$el.parents("body").length;if(t&&!e.validate())return $.goError(n["\ub9c8\uc784 \uc0ac\uc774\uc988 \ucd08\uacfc"]),!1;this.model.set("alias",this.$el.find("input[name=alias]").val()),t&&this.model.set("description",e.getContent()),this.model.set("useHelp",this.$el.find('input[name="useHelp"]').is(":checked")),this.model.set("receptionActive",this.$el.find("input[name=receptionActive]").is(":checked")),this.model.set("receiverEditable",this.$el.find("input[name=receiverEditable]").is(":checked")),this.model.set("useRequiredReceiver",this.$el.find("input[name=useRequiredReceiver]").is(":checked")),this.model.set("useReceptionDocModifiable",this.$el.find("input[name=useReceptionDocModifiable]").is(":checked")),this.model.set("readerActive",this.$el.find("input[name=readerActive]").is(":checked")),this.model.set("readerEditable",this.$el.find("input[name=readerEditable]").is(":checked")),this.model.set("securityLevelActive",this.$el.find("input[name=securityLevelActive]").is(":checked")),this.model.set("referenceActive",this.$el.find("input[name=referenceActive]").is(":checked")),this.model.set("referrerEditable",this.$el.find("input[name=referrerEditable]").is(":checked")),this.model.set("actCopyAlterable",this.$el.find("input[name=actCopyAlterable]:checked").val()),this.model.set("externalScript",this.$el.find("input[name=externalScript]").val()),this.model.set("folderChangeable",this.$el.find("input[name=folderChangeable]").is(":checked")),this.model.set("arbtDecisionActive",this.$el.find('input[name="arbtDecisionActive"]').is(":checked")),this.model.set("arbtDecisionType",this.$el.find('input[name="arbtDecisionType"]:checked').val()),this.model.set("formUserScope",this.$el.find('input[name="formUserScope"]').is(":checked")?"ALL":"SPECIFIC"),this.model.set("preserveDurationInYear",this.$el.find("[name=preserveDurationInYear]").val()),this.model.set("preserveDurationEditable",this.$el.find("input[name=preserveDurationEditable]").is(":checked")),this.model.set("documentOpenable",this.$el.find("input[name=documentOpenable]").is(":checked")),this.model.set("documentOpenEditable",this.$el.find("input[name=documentOpenEditable]").is(":checked"));var r=this.$el.find("input[name=activityEditable]").is(":checked");this.model.set("activityEditable",r);var i=this.$('input[name="activityEditableType"]:checked').val();r&&typeof i=="undefined"?i=!0:i=i=="All"?!0:!1,this.model.set("useActivityEditableTypeAll",i),i?this.model.set("useActivityEditableApproval",!1):this.model.set("useActivityEditableApproval",this.$el.find("input[name=activityEditableApproval]").is(":checked")),this.model.set("useActivityEditableAgreement",this.$el.find("input[name=activityEditableAgreement]").is(":checked")),this.model.set("useActivityEditableInspection",this.$el.find("input[name=activityEditableInspection]").is(":checked")),this.model.set("useActivityEditableCheck",this.$el.find("input[name=activityEditableCheck]").is(":checked"));var s=this.$el.find("input[name=documentEditable]").is(":checked");this.model.set("documentEditable",s);var o=this.$('input[name="documentEditableType"]:checked').val();s&&typeof o=="undefined"?o=!0:o=o=="All"?!0:!1,this.model.set("useDocEditableTypeAll",o),o?this.model.set("useDocEditableApproval",!1):this.model.set("useDocEditableApproval",this.$el.find("input[name=docEditableApproval]").is(":checked")),this.model.set("useDocEditableAgreement",this.$el.find("input[name=docEditableAgreement]").is(":checked")),this.model.set("useDocEditableInspection",this.$el.find("input[name=docEditableInspection]").is(":checked")),this.model.set("useDocEditableCheck",this.$el.find("input[name=docEditableCheck]").is(":checked")),this.model.set("state",this.$el.find('input[name="state"]').is(":checked")?"NORMAL":"HIDDEN"),this.model.set("allowMobileApproval",this.$el.find("input[name=allowMobileApproval]").is(":checked")),this.model.set("securityLevel",this.securityLevelListView.getSelectedData()),this.model.set("securityLevelEditable",this.$el.find("input[name=securityLevelEditable]").is(":checked")),this.model.set("useSelfApproval",this.$el.find("input[name=useSelfApproval]").is(":checked")),this.model.set("useSendMail",this.$el.find("input[name=useSendMail]").is(":checked")),this.model.set("usePostRegistable",this.$el.find("input[name=usePostRegistable]").is(":checked")),this.model.set("apprLineRuleOptionVariable",this.$el.find("input[name=apprLineRuleOptionVariable]").val()),this.model.set("apprLineRuleAmountVariable",this.$el.find("input[name=apprLineRuleAmountVariable]").val());var u=$("#docInfo_txt_form").attr("data-docTypeId");this.model.set("companyDocFolder",u?{id:u}:null),this.model.set("formScriptType",this.$el.find('input[name="scriptType"]:checked').val()),this.model.set("scriptBody",this.$el.find("textarea[name=scriptBody]").val()),this.model.set("officialDocumentSendable",this.$el.find("input[name=officialDocumentSendable]").is(":checked")),this.model.set("officialFormId",""),this.model.set("officialSenderId",""),this.model.set("officialSignId",""),this.model.set("officialFormEditable",!1),this.model.set("officialSenderEditable",!1),this.model.set("officialSignEditable",!1),this.model.set("officialSignPreviewEditable",!1),this.$el.find("input[name=officialDocumentSendable]").is(":checked")&&(this.model.set("officialFormId",this.$el.find("select[name=officialForm]").val()),this.model.set("officialSenderId",this.$el.find("select[name=officialSender]").val()),this.model.set("officialSignId",this.$el.find("select[name=officialSign]").val()),this.model.set("officialFormEditable",this.$el.find("input[name=officialFormEditable]").is(":checked")),this.model.set("officialSenderEditable",this.$el.find("input[name=officialSenderEditable]").is(":checked")),this.model.set("officialSignEditable",this.$el.find("input[name=officialSignEditable]").is(":checked")),this.model.set("officialSignPreviewEditable",this.$el.find("input[name=officialSignPreviewEditable]").is(":checked"))),this.isEditableIntegration&&(this.model.set("code",this.$el.find("input[name=code]").val()),this.model.set("integration",this.getIntegrationData()),this.model.set("integrationActive",this.$el.find("input[name=integrationActive]").is(":checked")));var a=this.adminUserData,f=$("#adminTable").find("tbody tr");_.each(a,function(e){_.each(f,function(t){e.nodeId==$(t).attr("data-id")&&(e.actions="read",$(t).find("[name=writePermission]").is(":checked")&&(e.actions+=",write"),$(t).find("[name=removePermission]").is(":checked")&&(e.actions+=",remove"))})}),this.model.set("admin",{nodes:a}),this.model.set("receiver",{nodes:[]}),this.model.get("receptionActive")&&this.model.set("receiver",this.receiverView.getData()),this.model.set("referrer",{nodes:[]}),this.model.get("referenceActive")&&this.model.set("referrer",this.referrerView.getData()),this.model.set("reader",{nodes:[]}),this.model.get("readerActive")&&this.model.set("reader",this.readerView.getData()),this.model.set("formUser",{nodes:[]}),this.model.get("formUserScope")=="SPECIFIC"&&this.model.set("formUser",this.formUserView.getData());if(this.apprLineView.isOverMaxApprovalCount())return $.goMessage(P.is_over_max_approval_count),!1;if(this.apprLineView.isNothingCheckedApprType())return $.goMessage(P.is_nothing_checked_approval_type),!1;if(this.apprLineView.isAppointmentOfNotSelectedType())return $.goMessage(P.is_appointmentof_notselectedtype),!1;if(!this.model.isValid())return this.model.validationError=="name_invalid_length"||this.model.validationError=="name_required"?($.goMessage(P[this.model.validationError]),this.$el.find(":input[name=name]").select()):this.model.validationError=="alias_invalid_length"||this.model.validationError=="alias_required"?($.goMessage(P[this.model.validationError]),this.$el.find(":input[name=alias]").select()):$.goMessage(P[this.model.validationError]),!1;if(this.model.get("useApprLineRule")&&_.isEmpty(this.model.get("apprLineRuleModel")))return $.goMessage(P.apprlineruleid_required),!1;if(!this.templateEditorView.validateActivityGroups(this.model.get("activityGroups")))return $.goMessage(P.invalid_template_html_activity_groups),!1;if(!this.templateEditorView.validateApprLineRuleForm(this.model.get("apprLineRuleModel")))return $.goMessage(P.invalid_apprlinerule_form),!1;if(this.requestProcessing)return;this.requestProcessing=!0,this.model.save({},{success:$.proxy(function(e){GO.util.store.set("appr_form_index:folderId",e.get("folderId")),$.goAlert(P.creation_success_msg,"",$.proxy(this._goToFormListView,this))},this),error:function(e,t){_.contains(t.responseJSON.message,"duplication.name")?$.goMessage(P.duplicated_name):_.contains(t.responseJSON.message,"duplication.code")?$.goMessage(P.duplicated_code):_.contains(t.responseJSON.message,"form.changed")?(GO.util.store.set("appr_form_index:folderId",e.get("folderId")),$.goConfirm(P.form_changed,"",function(){GO.router.navigate("approval",{trigger:!0})},n["\uc774\ub3d9"],function(){})):_.contains(t.responseJSON.name,"DuplicateRequestException")?$.goMessage(t.responseJSON.message.split("[")[0]):$.goMessage(P["\uacb0\uc7ac\uc120\uc744 \ucd94\uac00\ud55c \ud6c4 \uc800\uc7a5\ud574 \uc8fc\uc138\uc694"])},complete:$.proxy(function(){this.requestProcessing=!1},this)})},_onCancelClicked:function(){return $.goAlert(r["\ucde8\uc18c\ud558\uc168\uc2b5\ub2c8\ub2e4. \uc774\uc804 \ud654\uba74\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4."],"",$.proxy(this._goToFormListView,this)),!1},_goToFormListView:function(){return GO.router.navigate("approval",{trigger:!0}),!1},_onSyncModel:function(){this.activityGroups.set(this.model.get("activityGroups")),this.templateEditorView||this._initTemplateEditor(),this.render()},_onChangeActivityGroups:function(e){this.templateEditorView.syncApprLineToHtmlContent(e)},_onRemoveActivityGroups:function(e){this.templateEditorView.syncApprLineToHtmlContent(e,!0)},_initTemplateEditor:function(){this.templateEditorView=new l({title:this.model.get("name"),model:this.model,config:this.apprConfigModel,approvalInfo:this.activityGroups,companyIds:this.companyIds})},_onChangeName:function(e){this.model.set("name",$(e.currentTarget).val())}})});