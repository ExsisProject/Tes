define("admin/views/ehr/timeline/workplace/work_place_list",function(require){var e=require("hgn!admin/templates/ehr/timeline/workplace/work_place_list"),t=require("admin/collections/ehr/timeline/work_place_list"),n=require("i18n!admin/nls/admin"),r=require("i18n!nls/commons");return Backbone.View.extend({el:"#workPlaceList",unbindEvent:function(){this.$el.off("click",".work_place"),this.$el.off("click","#placeAddBtn"),this.$el.off("click","#placeDelBtn")},bindEvent:function(){this.$el.on("click",".work_place",$.proxy(this.onPlaceClicked,this)),this.$el.on("click","#placeAddBtn",$.proxy(this.addWorkPlace,this)),this.$el.on("click","#placeDelBtn",$.proxy(this.onDelBtnClicked,this))},initialize:function(e){this.workPlaceCollection=new t,this.workPlaceCollection.fetch({async:!1}),this.workPlaceCollection.sortWorkPlaces("createdAt",!0),this.unbindEvent(),this.bindEvent()},render:function(){this.$el.html(e({places:this.workPlaceCollection.models,adminLang:n,commonLang:r})),this.defaultActiveWorkPlace(this.workPlaceCollection)},defaultActiveWorkPlace:function(e){e.models[0]&&this.$el.trigger("activeWorkPlace",e.models[0])},addWorkPlace:function(){this.$el.trigger("renderWorkPlace"),this.$el.trigger("inActiveWorkPlace")},onPlaceClicked:function(e){var t=$(e.currentTarget).val();this.$el.trigger("activeWorkPlace",this.getCheckedWorkPlace(t)),this.$el.trigger("renderWorkPlace",this.getCheckedWorkPlace(t))},getCheckedWorkPlace:function(e){return this.activePlaceModel=this.workPlaceCollection.getById(e),this.activePlaceModel},onDelBtnClicked:function(e){var t=new Array,i=this.$el.find("#workPlacesTable"),s=i.find('li input[type="checkbox"]:checked');if(s.size()==0){$.goMessage(n["\uc0ad\uc81c\ud560 \uadfc\ubb34\uc9c0\ub97c \uc120\ud0dd\ud558\uc138\uc694"]);return}s.attr("value",function(e,n){n!=null&&t.push(n)});var o=function(){var e=this;$.go(GO.contextRoot+"ad/api/timeline/workplaces",JSON.stringify({ids:t}),{qryType:"DELETE",contentType:"application/json",responseFn:function(t){t.code==200&&($.goMessage(r["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),e.$el.trigger("reset"))},error:function(e){var t=JSON.parse(e.responseText);t!=null?$.goAlert(t.message):$.goMessage(r["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."])}})};$.goPopup({title:n["\uc120\ud0dd\ud55c \uadfc\ubb34\uc9c0 \uc0ad\uc81c \uc54c\ub9bc"],modal:!0,buttons:[{btype:"confirm",btext:r["\uc0ad\uc81c"],callback:$.proxy(o,this)},{btype:"close",btext:r["\ucde8\uc18c"]}]})}})});