(function(){define(["backbone","i18n!nls/commons","i18n!admin/nls/admin","hgn!admin/templates/task_flow_item"],function(e,t,n,r){var i={firstRegistration:n["\ucd5c\ucd08\ub4f1\ub85d"],select:t["\uc120\ud0dd"],select:t["\uc120\ud0dd"],add:t["\ucd94\uac00"],"delete":t["\uc0ad\uc81c"]},s=e.View.extend({tagName:"tr",events:{"change select":"changeState","click input[type=checkbox]":"setRoles","focusout input[type=text]":"setActionName"},initialize:function(e){GO.EventEmitter.on("task","change:states",function(e){this.renderStates(e)},this),this.isFirst=this.model.isFirst(),this.roles=e.roles},render:function(){return this.$el.html(r({lang:i,model:this.model.toJSON(),isFirst:this.isFirst,roles:this.roles,cid:this.cid})),this.renderStates(this.collection),this.renderRoles(),this.$el.attr("data-type","flow"),this},renderStates:function(e){_.each(["before","next"],function(t){var n=this.model.get(t+"Status"),r=this.$("select[data-type="+t+"]");r.find("option:gt(0)").remove(),e.each(function(e){var t='<option value="'+e.get("name")+'">'+e.get("name")+"</option>";r.append(t)},this);var i=e.isDelete(n);i?r.val(""):r.val(n),r.toggleClass("pause",i)},this)},renderRoles:function(){_.each(["action","push"],function(e){var t=this.$("td[data-type="+e+"]");_.each(this.model.get(e+"Roles"),function(e){t.find("input[value="+e+"]").attr("checked",!0)},this)},this)},changeState:function(e){var t=$(e.currentTarget),n=t.attr("data-type");t.removeClass("pause"),this.model.set(n+"Status",t.val())},setRoles:function(e){var t=$(e.currentTarget).parents("td[data-type]"),n=t.attr("data-type"),r=[];_.each(t.find("input[type=checkbox]:checked"),function(e){r.push(e.getAttribute("value"))}),this.model.set(n+"Roles",r),console.log(this.model.get(n+"Roles"))},setActionName:function(e){this.model.set("actionName",$(e.currentTarget).val())}});return s})}).call(this);