define("admin/views/loginout_config",function(e){var t=require("jquery"),n=require("backbone"),r=require("app"),i=require("hgn!admin/templates/loginout_config"),s=require("i18n!admin/nls/admin"),o=require("i18n!nls/commons");require("jquery.go-popup"),require("jquery.go-sdk"),require("jquery.go-validation");var u={label_id:o["\uc774\uba54\uc77c"],label_use:s["\uc0ac\uc6a9\ud568"],label_notuse:o["\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"],label_config:s["\ub85c\uadf8\uc778 \uc124\uc815"],label_loginout_config:s["\ub85c\uadf8\uc778 / \ub85c\uadf8\uc544\uc6c3 \ud658\uacbd"],label_mode:s["\ub85c\uadf8\uc778 \ubc29\ubc95"],label_employeenum:s["\uc778\uc2dd\ubc88\ud638(\uc0ac\ubc88/\ud559\ubc88)"],label_ok:o["\uc800\uc7a5"],label_cancel:o["\ucde8\uc18c"],label_concurrent_ok:s["\ub3d9\uc2dc\uc811\uc18d \ud5c8\uc6a9"],label_concurrent_no:s["\ub3d9\uc2dc\uc811\uc18d \uc81c\ud55c"],label_fail:o["\uc2e4\ud328"],label_key_length8:s["\ud0a4\ub294 8\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."],label_key_length16:s["\ud0a4\ub294 16\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."],label_sso_title:s["\ud1b5\ud569 \ub85c\uadf8\uc778 (SSO) \uae30\ub2a5"],label_sso_setting:s["\ud1b5\ud569 \ub85c\uadf8\uc778 \uc124\uc815"],label_use_notuse:s["\uc0ac\uc6a9\uc5ec\ubd80"],label_method:s["\uc5f0\ub3d9 \ubc29\uc2dd"],label_cookie:s["\ucfe0\ud0a4"],label_param:s["\ud30c\ub77c\ubbf8\ud130"],label_sso_key:s["\uc5f0\ub3d9 \ud0a4"],label_id:s["\uc544\uc774\ub514"],label_empno:s["\uc778\uc2dd\ubc88\ud638(\uc0ac\ubc88/\ud559\ubc88)"],label_cryptoAlgorithm:s["\uc554\ud638\ud654 \ubc29\uc2dd"],label_select_none:s["\uc0ac\uc6a9 \uc548\ud568"],label_cryptoAlgorithm_test:s["\uc554\ud638\ud654 \ud14c\uc2a4\ud2b8"],label_btn_test:s["\ud14c\uc2a4\ud2b8"],label_aes:s.AES,label_des:s.DES,label_desede:s.DESede,label_blowfish:s.Blowfish,label_twofish:s.Twofish,label_aria:s.ARIA,label_fail_test:s["\uc554\ud638\ud654 \ud14c\uc2a4\ud2b8\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."],label_test_wods:s["\ud14c\uc2a4\ud2b8 \ubb38\uc7a5\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694."],label_encoding:s["\uc554\ud638\ud654 \uacb0\uacfc"],label_decoding:s["\ubcf5\ud638\ud654 \uacb0\uacfc"],label_auto_logout:s["\uc790\ub3d9 \ub85c\uadf8\uc544\uc6c3"],label_mins:s["\ubd84"],label_time_out_direct:s["\uc9c1\uc811 \uc785\ub825"]},a=r.BaseView.extend({el:"#loginOutConfig",events:{"click span#loginConfigSaveBtn":"loginoutConfigSave","click span#loginConfigCancelBtn":"loginoutConfigCancel","click div#loginoutConfigTmpl input:radio":"toggleRadio","click select#cryptoAlgorithm":"selectcryptoAlgorithm","click span#btn_test":"testSso","click select#autoLogoutTime":"changeTimeOutMins"},initialize:function(){this.model=new n.Model,this.model.url="/ad/api/loginoutconfig",this.model.fetch({async:!1}),this.ssoModel=new n.Model,this.ssoModel.url="/ad/api/sso/config",this.ssoModel.fetch({async:!1})},toggleRadio:function(e){t(e.currentTarget).attr("value")=="true"?t(e.currentTarget).is(':radio[name="loginUrlAutoChange"]')?(t("#preLoginUrl").attr("disabled",!1),t("#postLoginUrl").attr("disabled",!1)):t(e.currentTarget).is(':radio[name="afterLogoutMove"]')?t("#logoutUrl").attr("disabled",!1):t(e.currentTarget).is(':radio[name="apply"]')?(t(".sso-content").show(),t('input:radio[name="method"]').attr("disabled",!1),t('input:radio[name="ssoKey"]').attr("disabled",!1),t("#cryptoAlgorithm").attr("disabled",!1),t("#cryptoAlgorithm").attr("value")!="NONE"&&(t("#cryptoKey").attr("disabled",!1),t("#testValue").attr("disabled",!1),t("#encodingValue").attr("disabled",!1),t("#decodingValue").attr("disabled",!1),this.$el.on("click","span#btn_test",t.proxy(this.testSso,this)))):t(e.currentTarget).is(':radio[name="autoLogout"]')&&(t("#autoLogoutTime").show(),this.changeTimeOutMins()):t(e.currentTarget).attr("value")=="false"&&(t(e.currentTarget).is(':radio[name="loginUrlAutoChange"]')?(t("#preLoginUrl").attr("disabled",!0),t("#preLoginUrl").val(""),t("#postLoginUrl").attr("disabled",!0),t("#postLoginUrl").val("")):t(e.currentTarget).is(':radio[name="afterLogoutMove"]')?(t("#logoutUrl").attr("disabled",!0),t("#logoutUrl").val("")):t(e.currentTarget).is(':radio[name="apply"]')?(t(".sso-content").hide(),t('input:radio[name="method"]').attr("disabled",!0),t('input:radio[name="ssoKey"]').attr("disabled",!0),t("#cryptoAlgorithm").attr("disabled",!0),t("#cryptoKey").attr("disabled",!0),t("#testValue").attr("disabled",!0),t("#encodingValue").attr("disabled",!0),t("#decodingValue").attr("disabled",!0),this.$el.off("click","span#btn_test")):t(e.currentTarget).is(':radio[name="autoLogout"]')&&(t("#autoLogoutTime").hide(),t("#timeOutDirect").hide()))},changeTimeOutMins:function(e){t("select#autoLogoutTime option:selected").val()==-1?t("#timeOutDirect").show():t("#timeOutDirect").hide()},render:function(){var e=this;this.$el.empty();var n=i({lang:u,model:this.model.toJSON(),ssoModel:this.ssoModel.toJSON(),sessionTimeOutMins:[{value:"5"},{value:"15"},{value:"30"},{value:"60"}]});this.$el.html(n),e.$el.find("#autoLogoutTime").val(e.model.get("autoLogoutTime")),e.$el.find("#cryptoAlgorithm").val(e.ssoModel.get("cryptoAlgorithm")),e.ssoModel.get("cryptoAlgorithm")=="NONE"&&(t('input:radio[name="cryptoKey"]').attr("disabled",!0),t("#cryptoKey").attr("disabled",!0),t("#testValue").attr("disabled",!0),t("#encodingValue").attr("disabled",!0),t("#decodingValue").attr("disabled",!0),this.$el.off("click","span#btn_test")),e.ssoModel.get("cryptoAlgorithm")=="cryptoAlgorithm"&&t("#cryptoKey").attr("disabled",!0),e.$el.find("#method_"+e.ssoModel.get("method")).attr("checked",!0),e.$el.find("#ssoKey_"+e.ssoModel.get("ssoKey")).attr("checked",!0),e.ssoModel.get("apply")||(t(".sso-content").hide(),t('input:radio[name="method"]').attr("disabled",!0),t('input:radio[name="ssoKey"]').attr("disabled",!0),t("#cryptoAlgorithm").attr("disabled",!0),t("#cryptoKey").attr("disabled",!0),t("#testValue").attr("disabled",!0),t("#encodingValue").attr("disabled",!0),t("#decodingValue").attr("disabled",!0),this.$el.off("click","span#btn_test"));var r=e.model.get("autoLogoutTime");return r!="5"&&r!="15"&&r!="30"&&r!="60"?(t('#autoLogoutTime option[value="-1"]').attr("selected","selected"),t("#timeOutDirectValue").attr("value",r),t("#timeOutDirect").show()):t("#timeOutDirect").hide(),e.model.get("autoLogout")||(t("#autoLogoutTime").hide(),t("#timeOutDirect").hide()),GO.session().serviceAdminMode&&t("#divSsoConfig").hide(),this._validateLengthEncryptionKey(),this.$el},_validateLengthEncryptionKey:function(){var e=this;t("#cryptoAlgorithm").on("propertychange change",function(){e._checkLengthEncryptionKey()}),t("#cryptoKey").on("propertychange change keyup paste input",function(){e._checkLengthEncryptionKey()})},_checkLengthEncryptionKey:function(){var e=this,n=t("#cryptoAlgorithm").attr("value"),r=t("#cryptoKey").val();t("#cryptoKeyValidate").show();if(n=="DES"&&r.length!=8){e.showValidateMsg("cryptoKey",s["\ud0a4\ub294 8\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]);return}if(n!="DES"&&r.length!=16){e.showValidateMsg("cryptoKey",s["\ud0a4\ub294 16\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]);return}t("#cryptoKeyValidate").hide()},selectcryptoAlgorithm:function(e){e.stopPropagation(),t("#cryptoAlgorithm").attr("value")=="NONE"?(t("#cryptoKey").attr("disabled",!0),t("#testValue").attr("disabled",!0),t("#encodingValue").attr("disabled",!0),t("#decodingValue").attr("disabled",!0),this.$el.off("click","span#btn_test")):(t("#cryptoKey").attr("disabled",!1),t("#testValue").attr("disabled",!1),t("#encodingValue").attr("disabled",!1),t("#decodingValue").attr("disabled",!1),this.$el.on("click","span#btn_test",t.proxy(this.testSso,this)),this._checkLengthEncryptionKey())},testSso:function(e){var n=this,r=GO.contextRoot+"ad/api/sso/test/encrypt",i=t("#cryptoAlgorithm").attr("value"),o=t("#cryptoKey").attr("value"),u=t("#testValue").attr("value");if(u==""){n.showValidateMsg("testValue",s["\ud14c\uc2a4\ud2b8 \ubb38\uc7a5\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694."]);return}if(i=="DES"&&o.length!=8){n.showValidateMsg("cryptoKey",s["\ud0a4\ub294 8\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]);return}if(i!="DES"&&o.length!=16){n.showValidateMsg("cryptoKey",s["\ud0a4\ub294 16\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]);return}var a={cryptoAlgorithm:i,cryptoKey:o,plainText:u};t.go(r,a,{qryType:"GET",contentType:"text/plain",responseFn:function(e){e.code==200&&(t("#encodingValue").attr("value",e.data.encodingValue),t("#decodingValue").attr("value",e.data.decodingValue))},error:function(e){var n=JSON.parse(e.responseText);t.goMessage(s["\uc554\ud638\ud654 \ud14c\uc2a4\ud2b8\uc5d0 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4."])}})},showValidateMsg:function(e,n){t("#"+e).focus(),t("#"+e+"Validate").html(n)},loginoutConfigSave:function(e){e.stopPropagation();var n=this,i=this.$el.find("form[name=formLoginoutConfig]"),u=this.$el.find("form[name=formSsoConfig]"),a=!0;t.each(i.serializeArray(),function(e,i){if(i.name=="autoLogoutTime"&&i.value==-1){if(t('input:radio[name="autoLogout"]:checked').val()=="true"){if(t("#timeOutDirectValue").val()==""||t("#timeOutDirectValue").val()==null)return n.showValidateMsg("timeOutDirectValue",s["\uc790\ub3d9 \ub85c\uadf8\uc544\uc6c3 \uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."]),a=!1,!1;var o=t("#timeOutDirectValue").val();if(!t.goValidation.isNumber(o))return n.showValidateMsg("timeOutDirectValue",s["\uc22b\uc790\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."]),a=!1,!1;if(o<1||o>7200)return n.showValidateMsg("timeOutDirectValue",r.i18n(s["\uc785\ub825\uac12\uc740 0~0\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4."],{arg1:"1",arg2:"7200"})),a=!1,!1}i.value=t("#timeOutDirectValue").val()}n.model.set(i.name,i.value,{silent:!0})});if(!a)return!1;var f="";t.each(u.serializeArray(),function(e,t){t.name=="cryptoAlgorithm"&&(f=t.value);if(t.name=="cryptoKey"&&f=="DES"&&t.value.length!=8)return n.showValidateMsg("cryptoKey",s["\ud0a4\ub294 8\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]),a=!1,!1;if(t.name=="cryptoKey"&&f!="DES"&&t.value.length!=16)return n.showValidateMsg("cryptoKey",s["\ud0a4\ub294 16\uc790\ub9ac\uc5ec\uc57c\ud569\ub2c8\ub2e4."]),a=!1,!1;n.ssoModel.set(t.name,t.value,{silent:!0})});if(!a)return!1;GO.util.preloader(n.model.save({},{type:"PUT",success:function(e,r){r.code=="200"&&n.ssoModel.save({},{type:"PUT",success:function(e,n){n.code=="200"&&t.goMessage(o["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},error:function(e,t){n._errorFunction(t);var r=JSON.parse(t.responseText)}})},error:function(e,t){n._errorFunction(t)}}))},_errorFunction:function(e){var n=JSON.parse(e.responseText);n!=null?t.goAlert(u.label_fail,n.message):t.goMessage(o["\uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."])},_errorMessage:function(e,n){t("#"+e).focus(),t.goAlert(u.label_fail,n)},loginoutConfigCancel:function(e){e.stopPropagation();var n=this;t.goCaution(o["\ucde8\uc18c"],o["\ubcc0\uacbd\ud55c \ub0b4\uc6a9\uc744 \ucde8\uc18c\ud569\ub2c8\ub2e4."],function(){n.render(),t.goMessage(o["\ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},o["\ud655\uc778"])}},{__instance__:null});return a});