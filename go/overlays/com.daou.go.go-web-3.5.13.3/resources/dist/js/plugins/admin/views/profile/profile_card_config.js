(function(){define(["jquery","backbone","app","when","admin/models/profile_config","hgn!admin/templates/profile/profile_card_config","i18n!nls/commons","i18n!admin/nls/admin","jquery.go-grid","GO.util"],function(e,t,n,r,i,s,o,u){var a={exposure_item:u["\ucd94\uac00 \ub178\ucd9c \ud56d\ubaa9"],select_item:u["\ud56d\ubaa9 \uc120\ud0dd"],select_item_tool_tip:u["\uae30\ubcf8\uc815\ubcf4 \uc678 \uc6f9 \ud398\uc774\uc9c0 \uc870\uc9c1\ub3c4 \ud504\ub85c\ud544, \uba54\uc2e0\uc800 \ud504\ub85c\ud544, \ubaa8\ubc14\uc77c \ud504\ub85c\ud544\uc5d0 \ub178\ucd9c\ub418\ub294 \ud56d\ubaa9\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."],decorate_profile:u["\ud654\uba74 \uafb8\ubbf8\uae30"],confirm:o["\ud655\uc778"],cancel:o["\ucde8\uc18c"],photo:o["\uc0ac\uc9c4"],name:o["\uc774\ub984"],grade:u["\uc9c1\uae09"],company_name:u["\ud68c\uc0ac\uba85"],duty:o["\uc9c1\ucc45\ubd80\uc11c"],position:u["\uc9c1\uc704"],job:u["\uc9c1\ubb34"],employee_no:o["\uc778\uc2dd\ubc88\ud638"],email:o["\uc774\uba54\uc77c"],direct_tel:u["\uc9c1\ud1b5\uc804\ud654"],phone:u["\ud578\ub4dc\ud3f0"],representive_tel:u["\ub300\ud45c\uc804\ud654"],fax:u["\ud329\uc2a4"],selfInfo:u["\uc790\uae30\uc18c\uac1c"],location:u["\uc704\uce58"],homepage:u["\ud648\ud398\uc774\uc9c0"],messanger:u["\uba54\uc2e0\uc800"],birthday:u["\uc0dd\uc77c"],anniversary:u["\uae30\ub150\uc77c"],address:u["\uc8fc\uc18c"],memo:u["\uba54\ubaa8"],account_profile_modification_title:u["\uac1c\uc778 \uc815\ubcf4 \uc218\uc815"],account_profile_modification_sub_title:u["\uae30\ubcf8\uc815\ubcf4 \uc218\uc815"],account_profile_modification_allow:u["\uac1c\uc778 \uc218\uc815 \ud5c8\uc6a9"],account_profile_modification_not_allow:u["\uac1c\uc778 \uc218\uc815 \ud5c8\uc6a9\ud558\uc9c0 \uc54a\uc74c"]},f=function(){return r.promise.apply(this,arguments)},l=t.View.extend({el:"#layoutContent",initialize:function(){this.profileConfigModel=new i,this.unbindEvent(),this.bindEvent()},unbindEvent:function(){this.$el.off("click.account","#update_profile_card_config"),this.$el.off("click.account","#cancel")},bindEvent:function(){this.$el.on("click.account","#update_profile_card_config",e.proxy(this.saveProfileExposureInfo,this)),this.$el.on("click.account","#cancel",e.proxy(this.cancel,this))},render:function(){this.$el.html(s({lang:a})),this.loadProfileExposureInfo()},cancel:function(){this.render()},loadProfileExposureInfo:function(){this.asyncFetch(this.profileConfigModel).then(_.bind(function(){var t=this.profileConfigModel.toJSON();e("input[name=allowed]").filter("[value="+t.allowed+"]").prop("checked",!0);var n=t.visibleProfileItems.split(",");_.each(n,function(t){e("input[type=checkbox]").filter("[value="+t+"]").prop("checked",!0)})},this)).otherwise(function(t){console.log(t.stack)})},saveProfileExposureInfo:function(t){var n=e('input:radio[name="allowed"]:checked').val(),r=e("input[type=checkbox]"),i=["thumbSmall"];_.each(r,function(t){e(t).is(":checked")&&i.push(e(t).val())});var s=this;this.profileConfigModel.set({allowed:n,visibleProfileItems:i.join(",")}),this.profileConfigModel.save({},{type:"PUT",success:function(t,n){e.goMessage(o["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),s.render()},error:function(t,n){e.goMessage(o["\uc800\uc7a5\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4."])}})},asyncFetch:function(t){return new f(function(n,r,i){t.fetch({success:n,error:r,statusCode:{400:function(){e.goError(o["500 \uc624\ub958\ud398\uc774\uc9c0 \ub0b4\uc6a9"])},403:function(){e.goError(o["\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."])},404:function(){e.goError(o["500 \uc624\ub958\ud398\uc774\uc9c0 \ub0b4\uc6a9"])},500:function(){e.goError(o["500 \uc624\ub958\ud398\uc774\uc9c0 \ub0b4\uc6a9"])}}})})}},{render:function(){var e=new l;return e.render()}});return l})})();