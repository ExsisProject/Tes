(function(){define(["jquery","backbone","app","hgn!admin/templates/mail/alias_list","i18n!admin/nls/admin","i18n!nls/commons","GO.util","jquery.go-grid"],function(e,t,n,r,i,s){var o=null,u={alias_name:i["\ubcc4\uce6d \uacc4\uc815 \uc774\ub984"],alias_id:i["\ubcc4\uce6d \uacc4\uc815 \uc544\uc774\ub514"],forward_count:i["\uc804\ub2ec \uc774\uba54\uc77c \uac1c\uc218"],account_status:i["\uc0ac\uc6a9 \uc0c1\ud0dc"],alias_forward_address:i["\uc804\ub2ec\ud560 \uc774\uba54\uc77c"]},a=t.View.extend({el:"#layoutContent",initialize:function(){this.$el.off(),this.listOption={page:0,size:20}},events:{"keypress #searchKeyword":"enterEventHandler","click #addAlias":"addAlias","click #delAlias":"delAlias","click #searchAlias":"search","click span[data-type='setting']":"settingAlias"},render:function(){return e("div#aliasList").empty(),this.$el.append(r({lang:u})),this.renderAliasGrid(),this.renderButton(),this},renderButton:function(){var t='<span class="btn_tool" id="addAlias">'+i["\ubcc4\uce6d \uacc4\uc815 \ucd94\uac00"]+"</span>",n='<span class="btn_tool txt_caution" id="delAlias">'+i["\ubcc4\uce6d \uacc4\uc815 \uc0ad\uc81c"]+"</span>";e(".custom_header").append(t+n)},renderAliasGrid:function(){var t=this;this.dataTable=e.goGrid({el:this.$("#aliasDataTable"),method:"GET",bDestroy:!0,url:GO.contextRoot+"ad/api/mail/alias/list",emptyMessage:"<p class='data_null'> <span class='ic_data_type ic_no_data'></span><span class='txt'>"+i["\ub4f1\ub85d\ub41c \ubcc4\uce6d \uacc4\uc815\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]+"</span>"+"</p>",defaultSorting:[[2,"asc"]],sDomType:"admin",checkbox:!0,checkboxData:"mailUserSeq",displayLength:20,params:{page:this.page,offset:this.offset},columns:[{mData:"userName",sWidth:"350px",sClass:"title",bSortable:!0,fnRender:function(e){return e.aData.userName==null&&(e.aData.userName="-"),'<span data-type="setting" data-id="'+e.aData.mailUserSeq+'" style="cursor:pointer;">'+e.aData.userName+"</span>"}},{mData:"mailUid",sWidth:"350px",sClass:"title",bSortable:!0,fnRender:function(e){return'<span data-type="setting" data-id="'+e.aData.mailUserSeq+'" style="cursor:pointer;">'+e.aData.mailUid+"</span>"}},{mData:"forwardCount",sWidth:"150px",bSortable:!1,fnRender:function(e){return e.aData.forwardCount}},{mData:"accountStatus",bSortable:!0,fnRender:function(e){return e.aData.accountStatus=="enabled"?i["\uc815\uc0c1"]:i["\uc911\uc9c0"]}}],fnDrawCallback:function(e,t,n){e.find("thead tr th:first").addClass("check")}})},addAlias:function(){GO.router.navigate("mail/alias/create",{trigger:!0,pushState:!0})},delAlias:function(){var t=this,n=this.getCheckedIds();if(n.length==0){e.goMessage(i["\uc0ad\uc81c\ud560 \ud56d\ubaa9\uc744 \uc120\ud0dd\ud558\uc138\uc694."]);return}e.goConfirm(i["\ubcc4\uce6d \uacc4\uc815 \uc0ad\uc81c"],i["\ubcc4\uce6d \uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uba74, \ud558\uc704 \ubcc4\uce6d \uacc4\uc815\uc774 \ucd5c\uc0c1\uc704\ub85c \uc774\ub3d9\ub429\ub2c8\ub2e4."],function(){e.go(GO.contextRoot+"ad/api/mail/alias",JSON.stringify({ids:n}),{qryType:"DELETE",contentType:"application/json",responseFn:function(n){t.render(),e.goMessage(s["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},error:function(t){e.goError(t.responseJSON.message)}})},s["\ud655\uc778"])},settingAlias:function(t){var n=e(t.currentTarget).attr("data-id");GO.router.navigate("mail/alias/modify/"+n,{trigger:!0,pushState:!0})},getCheckedIds:function(){var t=[];return e.each(e("#aliasDataTable td input:checkbox:checked"),function(n,r){t.push(e(r).val())}),t},search:function(){var t=this.$el.find('.table_search input[type="text"]'),n=t.val();t.trigger("focusout").blur();if(e.trim(n)==""){e.goAlert(s["\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694."]);return}this.dataTable.tables.search(this.$el.find(".table_search select").val(),n)},getSearchUrl:function(){return GO.contextRoot+"ad/api/mail/alias/list?"+e.param(this.listOption)},enterEventHandler:function(e){e.which==13&&this.search()}});return a})}).call(this);