(function(){define(["jquery","backbone","app","hgn!admin/templates/org_group_list","admin/collections/board_group_list","i18n!nls/commons","i18n!admin/nls/admin"],function(e,t,n,r,i,s,o){var u={manager_add:o["\ud074\ub798\uc2a4 \uc120\ud0dd"],manager_modify:o["\ud074\ub798\uc2a4 \uc218\uc815 : "],position:o["\uc9c1\uc704"],rank:o["\uc9c1\uae09"],duty:o["\uc9c1\ucc45"],user_group:o["\uc0ac\uc6a9\uc790\uadf8\ub8f9"],writable:o["\uc4f0\uae30\uac00\ub2a5"],submit:o["\ub4f1\ub85d"],save:s["\uc800\uc7a5"],modify:s["\uc218\uc815"],del:s["\uc0ad\uc81c"],duplicatePermission:o["\uc774\ubbf8 \ucd94\uac00\ub41c \ud074\ub798\uc2a4 \uc785\ub2c8\ub2e4."],additional_warining_manager:o["\ud074\ub798\uc2a4 \ucd94\uac00 \uacbd\uace0"]},a=null,f=!1,l=t.View.extend({initialize:function(e){this.options=e||{},this.type=this.options.type;var t=r({lang:u,isOrgServiceOn:GO.util.isUseOrgService(!0)});this.$el.html(t),this.unbindEvent(),this.bindEvent()},unbindEvent:function(){this.$el.off("change","select.baseJobList"),this.$el.off("click","span[data-btntype='addBtn']"),this.$el.off("click","span[data-btntype='saveBtn']")},bindEvent:function(){this.$el.on("change","select.baseJobList",e.proxy(this.changeGroupList,this)),this.$el.on("click","span[data-btntype='addBtn']",e.proxy(this.addBtn,this)),this.$el.on("click","span[data-btntype='saveBtn']",e.proxy(this.saveBtn,this))},addBtn:function(t){var n=this.$el.find(".baseJobList option:selected"),r=this.$el.find(".groupListSelect option:selected");if(r.html()==undefined){e.goMessage(u.additional_warining_manager);return}this.validateDuplicatePermission(r.val(),n.val());var i="";i="<li data-code='"+r.val()+"' data-type='"+n.val()+"'>"+"<span class='major'>["+n.html()+" : "+r.html()+"]</span> "+" <span class='btn_border'> <span class='ic ic_edit' title='"+u.modify+"' data-btntype='publicModify'> </span></span>"+" <span class='btn_border'> <span class='ic ic_delete' title='"+u.del+"' data-btntype='publicDelete'> </span></span>"+"</li>",e("#groupUl").addClass("list_option").append(i)},validateDuplicatePermission:function(t,n){var r=e("#groupUl li");permissionDatas=[],r.each(function(){var t=e(this);permissionDatas.push({data_code:t.attr("data-code"),data_type:t.attr("data-type"),data_permission:t.attr("data-permission")})}),e.each(permissionDatas,function(){if(this["data_code"]==t&&this["data_type"]==n)throw e.goMessage(u.duplicatePermission),new Error})},saveBtn:function(t){var n=e(t.currentTarget).parents("li").first(),r=e(t.currentTarget).parents("li").first().prev("li"),i=n.find(".baseJobList option:selected"),s=n.find(".groupListSelect option:selected"),o=n.find(".writePossible").is(":checked")?u.read+"/"+u.write:u.read,a=n.find(".writePossible").is(":checked")?"READWRITE":"READ";r.attr("data-code",s.val()),r.attr("data-permission",a),r.attr("data-type",i.val()),r.find("span.major").html("["+i.html()+" : "+s.html()+"]"),r.find("span.minor").html(o),r.find("span.btn_border").css("display",""),n.remove()},changeGroupList:function(t){var n=this.$el.find(".baseJobList option:selected"),r=i.getGroupList({groupValue:n.val()}),s="";e.each(r.toJSON(),function(e,t){s+="<option value="+t.id+">"+t.name+"</option>"}),this.type=="add"?this.$el.find(".groupListSelect").html(s):(this.$el.find(".groupListSelect").html(s),this.$el.find(".addBtn").hide(),this.$el.find(".saveBtn").show(),this.$el.find(".publicAdd").html(u.manager_modify))},render:function(){this.changeGroupList()}});return{render:function(e){return this.boardList=f,a=new l({el:e.id,type:e.type}),a.render()}}})}).call(this);