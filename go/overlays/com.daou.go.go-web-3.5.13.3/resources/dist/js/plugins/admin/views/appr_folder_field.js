define(["jquery","underscore","backbone","app","admin/views/appr_folder_field_help_layer","hgn!admin/templates/appr_folder_field","i18n!nls/commons","i18n!approval/nls/approval","i18n!admin/nls/admin"],function(e,t,n,r,i,s,o,u,a){var f=n.Model.extend({url:function(){return"/ad/api/approval/admin/basefieldconfig"}}),l={"\uc800\uc7a5":o["\uc800\uc7a5"],"\ucde8\uc18c":o["\ucde8\uc18c"],"\uc124\uc815":o["\uc124\uc815"],useManagerSetting:u["\uad00\ub9ac\uc790\uac00 \uc9c0\uc815\ud55c \ubaa9\ub85d \uc0ac\uc6a9"],useUserSetting:u["\uc0ac\uc6a9\uc790 \ubcc4 \ubaa9\ub85d \uc0ac\uc6a9"],"\ubb38\uc11c\ud568 \ud544\ub4dc \uc124\uc815":u["\ubb38\uc11c\ud568 \ud544\ub4dc \uc124\uc815"],"\uae30\uc548\uc77c":u["\uae30\uc548\uc77c"],"\uc644\ub8cc\uc77c":u["\uc644\ub8cc\uc77c"],"\uc811\uc218\uc77c":u["\uc811\uc218\uc77c"],"\uc0dd\uc131\uc77c":u["\uc0dd\uc131\uc77c"],"\uad6c\ubd84":u["\uad6c\ubd84"],"\uacb0\uc7ac\uc591\uc2dd":u["\uacb0\uc7ac\uc591\uc2dd"],"\uae34\uae09":u["\uae34\uae09"],"\uc81c\ubaa9":u["\uc81c\ubaa9"],"\ucca8\ubd80":u["\ucca8\ubd80"],"\uae30\uc548\uc790":u["\uae30\uc548\uc790"],"\uae30\uc548\ubd80\uc11c":u["\uae30\uc548\ubd80\uc11c"],"\ud604\uc7ac\uacb0\uc7ac\uc790":u["\ud604\uc7ac\uacb0\uc7ac\uc790"],"\ucd5c\uc885\uacb0\uc7ac\uc790":u["\ucd5c\uc885\uacb0\uc7ac\uc790"],"\ub2f4\ub2f9\uc790":u["\ub2f4\ub2f9\uc790"],"\ubb38\uc11c\ubc88\ud638":u["\ubb38\uc11c\ubc88\ud638"],"\uc6d0\ubb38\ubc88\ud638":u["\uc6d0\ubb38\ubc88\ud638"],"\ubc1c\uc1a1\uc77c":u["\ubc1c\uc1a1\uc77c"],"\uacb0\uc7ac\uc0c1\ud0dc":u["\uacb0\uc7ac\uc0c1\ud0dc"],"\uc218\uc2e0\ubd80\uc11c":u["\uc218\uc2e0\ubd80\uc11c"],"\uac1c\uc778 \ubb38\uc11c\ud568":u["\uac1c\uc778\ubb38\uc11c\ud568"],"\ubd80\uc11c\ubb38\uc11c\ud568":u["\ubd80\uc11c\ubb38\uc11c\ud568"],"\uacb0\uc7ac \ub300\uae30 \ubb38\uc11c":u["\uacb0\uc7ac \ub300\uae30 \ubb38\uc11c"],"\ucc38\uc870/\uc5f4\ub78c \ub300\uae30 \ubb38\uc11c":u["\ucc38\uc870/\uc5f4\ub78c \ub300\uae30 \ubb38\uc11c"],"\uacb0\uc7ac \uc218\uc2e0 \ubb38\uc11c":u["\uacb0\uc7ac \uc218\uc2e0 \ubb38\uc11c"],"\uacb0\uc7ac \uc608\uc815 \ubb38\uc11c":u["\uacb0\uc7ac \uc608\uc815 \ubb38\uc11c"],"\uae30\uc548 \ubb38\uc11c\ud568":u["\uae30\uc548 \ubb38\uc11c\ud568"],"\uacb0\uc7ac \ubb38\uc11c\ud568":u["\uacb0\uc7ac \ubb38\uc11c\ud568"],"\ucc38\uc870 \ubb38\uc11c\ud568":u["\ucc38\uc870 \ubb38\uc11c\ud568"],"\ucc38\uc870/\uc5f4\ub78c \ubb38\uc11c\ud568":u["\ucc38\uc870/\uc5f4\ub78c \ubb38\uc11c\ud568"],"\uc218\uc2e0 \ubb38\uc11c\ud568":u["\uc218\uc2e0 \ubb38\uc11c\ud568"],"\ubc1c\uc1a1 \ubb38\uc11c\ud568":u["\ubc1c\uc1a1 \ubb38\uc11c\ud568"],"\uc784\uc2dc \uc800\uc7a5\ud568":u["\uc784\uc2dc \uc800\uc7a5\ud568"],"\uae30\uc548 \uc644\ub8cc\ud568":u["\uae30\uc548 \uc644\ub8cc\ud568"],"\ubd80\uc11c \ucc38\uc870\ud568":u["\ubd80\uc11c \ucc38\uc870\ud568"],"\ubd80\uc11c \uc218\uc2e0\ud568":u["\ubd80\uc11c \uc218\uc2e0\ud568"],"\uacf5\ubb38 \ubc1c\uc1a1\ud568":u["\uacf5\ubb38 \ubc1c\uc1a1\ud568"],"\ucd94\uac00\ub41c \ubb38\uc11c\ud568":u["\ucd94\uac00\ub41c \ubb38\uc11c\ud568"],"\uac1c\uc778/\ubd80\uc11c \uacf5\ud1b5":u["\uac1c\uc778/\ubd80\uc11c \uacf5\ud1b5"],"\uc591\uc2dd\ubcc4 \ubb38\uc11c\uc870\ud68c":u["\uc591\uc2dd\ubcc4 \ubb38\uc11c\uc870\ud68c"],"\uc804\uc0ac \uacf5\ubb38 \ubc1c\uc1a1\ud568":u["\uc804\uc0ac \uacf5\ubb38 \ubc1c\uc1a1\ud568"],"\uad00\ub9ac\uc790 \uc791\uc5c5\uae30\ub85d":u["\uad00\ub9ac\uc790 \uc791\uc5c5\uae30\ub85d"],"\uc0c1\ud0dc":u["\uc0c1\ud0dc"],"\ud544\ub4dc \uc124\uba85":u["\ud544\ub4dc \uc124\uba85"],"\uac01 \ud544\ub4dc\uba85 \uc124\uba85":u["\uac01 \ud544\ub4dc\uba85 \uc124\uba85"],"\uacf5\ubb38 \ub300\uae30 \ubb38\uc11c":u["\uacf5\ubb38 \ub300\uae30 \ubb38\uc11c"],"\uacf5\ubb38 \ubb38\uc11c\ud568":u["\uacf5\ubb38 \ubb38\uc11c\ud568"],"\uc2b9\uc778\uc790":u["\uc2b9\uc778\uc790"],"\uc2b9\uc778\uc0c1\ud0dc":u["\uc2b9\uc778\uc0c1\ud0dc"],"\uc6d0\ubb38\uae30\uc548\uc77c":u["\uc6d0\ubb38\uae30\uc548\uc77c"],"\uc6d0\ubb38\uc644\ub8cc\uc77c":u["\uc6d0\ubb38\uc644\ub8cc\uc77c"],"\uc6d0\ubb38\uae30\uc548\ubd80\uc11c":u["\uc6d0\ubb38\uae30\uc548\ubd80\uc11c"]},c=n.View.extend({el:"#layoutContent",initialize:function(){this.model=new f,this.model.fetch({async:!1,statusCode:{403:function(){r.util.error("403")},404:function(){r.util.error("404",{msgCode:"400-common"})},500:function(){r.util.error("500")}}})},delegateEvents:function(t){this.undelegateEvents(),n.View.prototype.delegateEvents.call(this,t),this.$el.on("click.sign","input[name=configType]",e.proxy(this.configDocFieldType,this)),this.$el.on("click.sign","input[type=checkbox]",e.proxy(this.configDocListFields,this)),this.$el.on("click.sign","span#btn_save_appr_config",e.proxy(this.save,this)),this.$el.on("click.sign","span#btn_cancel_appr_config",e.proxy(this.cancel,this)),this.$el.on("click.sign","#btnFolderFieldHelpLayer",e.proxy(this.popupLayer,this))},undelegateEvents:function(){return n.View.prototype.undelegateEvents.call(this),this.$el.off(".sign"),this},render:function(e){var n={isBaseType:this.model.get("docFieldType")=="BASE"?!0:!1,APPR_TODO:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"APPR_TODO"}),"seq"),APPR_RECEPTION:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"APPR_RECEPTION"}),"seq"),OFFICIAL_TODO:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"OFFICIAL_TODO"}),"seq"),TODO_REF:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"TODO_REF"}),"seq"),APPR_WAIT:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"APPR_WAIT"}),"seq"),USER_DRAFT:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_DRAFT"}),"seq"),USER_TEMP:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_TEMP"}),"seq"),USER_APPROVAL:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_APPROVAL"}),"seq"),USER_REF:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_REF"}),"seq"),USER_RECEPTION:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_RECEPTION"}),"seq"),USER_SEND:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_SEND"}),"seq"),USER_OFFICIAL:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"USER_OFFICIAL"}),"seq"),DEPT_COMPLETE:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"DEPT_COMPLETE"}),"seq"),DEPT_REF:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"DEPT_REF"}),"seq"),DEPT_RECEPTION:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"DEPT_RECEPTION"}),"seq"),DEPT_OFFICIAL:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"DEPT_OFFICIAL"}),"seq"),CUSTOM_ADD:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"CUSTOM_ADD"}),"seq"),MANAGE_FORM:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"MANAGE_FORM"}),"seq"),MANAGE_OFFICIAL:t.sortBy(t.where(this.model.get("docListFields"),{docFolderType:"MANAGE_OFFICIAL"}),"seq")};return this.$el.empty(),this.$el.html(s({config:this.setConfig(n),lang:l})),this.$el},setConfig:function(e){for(var n in e)t.isArray(e[n])&&t.each(e[n],function(e){e.columnName=u[e.columnMsgKey]});return e},popupLayer:function(t){var n=e.goPopup({header:l["\ud544\ub4dc \uc124\uba85"],modal:!0,width:"600px",offset:e(t.currentTarget).offset(),pclass:"layer_normal layer_fieldName",contents:"",buttons:[{btext:o["\ub2eb\uae30"],btype:"cancel"}]}),r=new i({el:n.find(".content")});r.render()},configDocFieldType:function(t){var n=e(t.currentTarget);e(n).attr("id")=="isBaseType"?this.model.set("docFieldType","BASE"):e(n).attr("id")=="isNotBaseType"&&this.model.set("docFieldType","USER")},configDocListFields:function(n){var r=e(n.currentTarget);t.each(this.model.get("docListFields"),function(t){t["docFolderType"]==e(r).attr("docfoldertype")&&t["columnType"]==e(r).attr("columntype")&&(t.useColumn=e(r).is(":checked")?!0:!1)})},save:function(){var t=this;this.model.save({},{type:"PUT",success:function(n,r){r.code=="200"&&(t.model=new f,t.model.fetch({async:!1}),e.goMessage(o["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]))},error:function(t,n){var r=JSON.parse(n.responseText);return r.message?(e.goError(r.message),!1):(e.goError(o["\uc800\uc7a5\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4."]),!1)}})},cancel:function(){var t=this;e.goCaution(o["\ucde8\uc18c"],o["\ubcc0\uacbd\ud55c \ub0b4\uc6a9\uc744 \ucde8\uc18c\ud569\ub2c8\ub2e4."],function(){t.model=new f,t.model.fetch({async:!1}),t.render(),e.goMessage(o["\ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])},o["\ud655\uc778"])},release:function(){this.$el.off(),this.$el.empty()}});return c});