define("admin/views/auth/app_integrated_auth",function(require){var e=require("underscore"),t=require("jquery"),n=require("backbone"),r=require("app"),i=require("hgn!admin/templates/auth/app_integrated_auth"),s=require("admin/collections/auth/app_integrated_auth_collection"),o=require("admin/views/auth/app_integrated_auth_category"),u=require("admin/views/layout/page_view"),a=require("i18n!nls/commons"),f=require("i18n!admin/nls/admin"),l=["ApprFormOperator"],c=["CommunityMaster"],h=["CommunityMaster"];return n.View.extend({events:{"click #sel_auth_item_all":"selectAll","click .btn_adm_add":"addAdmAll","click .btn_adm_del":"delAdmAll","click .search_btn":"changedSearchCondition","click #ok_button":"saveAll","click #cancel_button":"render","click #back_list":"backToList","keydown #search_txt":"keydownSearch","keydown #search_content_txt":"keydownSearch","change #app_category_select":"changedAppCategory","change #search_category_select":"changedSearchCategory","click .sorting":"sort","click .sorting_asc":"sort","click .sorting_desc":"sort"},initialize:function(t){var n=this;this.viewOpt={},this.bc=t.bc,this.viewOpt.appAuthType=t?t.opt1:null,this.viewOpt.menus=t?t.menus:null,this.viewOpt.appAuthLevel=this.viewOpt.appAuthType?"AppContentOperator":"AppManager",this.viewOpt.isAppAuthView=this.viewOpt.appAuthLevel==="AppManager",this.viewOpt.isContentAuthView=!this.viewOpt.isAppAuthView,this.viewOpt.pageView=this.viewOpt.isContentAuthView,this.viewOpt.viewSaveButton=!!e.find(l,function(e){return e===n.viewOpt.appAuthType}),this.viewOpt.singleManagerType=!!e.find(c,function(e){return e===n.viewOpt.appAuthType}),this.viewOpt.useCheckBox=!e.find(h,function(e){return e===n.viewOpt.appAuthType}),this.checkedCnt=0,this.catViews=[],this.filterModel={appAuthLevel:this.viewOpt.appAuthLevel,appCategory:"ALL",userName:null,appAuthType:this.viewOpt.appAuthType,contentName:null},this.auths=new s({filterModel:this.filterModel}),this.viewOpt.appName=this.auths.appName},keydownSearch:function(e){e.keyCode===13&&this.changedSearchCondition(e)},changedSearchCondition:function(n){this.filterModel.userName=null,this.filterModel.contentName=null;if(this.viewOpt.isAppAuthView)this.filterModel.userName=t("#search_txt").val();else{var r=t("#search_category_select").val();this.filterModel[r]=t("#search_content_txt").val()}e.forEach(t("input[type=checkbox]:checked"),function(e){t(e).attr("checked",!1)}),this.changePage(this,0)},changedSearchCategory:function(e){var n=t(e.currentTarget),r=n.val();r==="userName"?t("#search_content_txt").attr("placeholder",f["\uac80\uc0c9\ud560 \uc6b4\uc601\uc790(\uc774\ub984+\uc774\uba54\uc77c)\uc744 \uc785\ub825\ud558\uc138\uc694"]).val("").focus().blur():r==="contentName"&&t("#search_content_txt").attr("placeholder",f["\uac80\uc0c9\ud560 {name}\uc744 \uc785\ub825\ud558\uc138\uc694"].replace("{name}",this.contentTitle())).val("").focus().blur()},changedAppCategory:function(n){var r=t(n.currentTarget);e.forEach(t("input[type=checkbox]:checked"),function(e){t(e).attr("checked",!1)});var i=r.val();this.filterModel.appCategory=i,this.render()},updateBreadCrumbs:function(){if(this.viewOpt.isAppAuthView)return;this.bc.setSubMenu(this.auths.appName+" "+a["\uad00\ub9ac"],"/auth/app/"+this.viewOpt.appAuthType),this.bc.render()},render:function(){var e=this.viewOpt.isAppAuthView?"search_txt":"search_content_txt",n=t("#"+e).val(),r=t("#search_category_select").val();return this.$el.html(i({contextRoot:GO.contextRoot,AdminLang:f,CommonLang:a,isAppAuthView:this.viewOpt.isAppAuthView,isContentAuthView:this.viewOpt.isContentAuthView,pageView:this.viewOpt.pageView,viewCkbox:this.viewOpt.useCheckBox,multiManager:!this.viewOpt.singleManagerType,viewSaveButton:this.viewOpt.viewSaveButton,appTitle:this.contentTitle()})),this.renderContents(!0),this.addEventListner(),this.renderPage(),this.updateBreadCrumbs(),n&&t("#"+e).val(n),this.updatedSelectedItems(),r&&t("#search_category_select").val(r),this.filterModel.appCategory&&t("#app_category_select").val(this.filterModel.appCategory),this},renderContents:function(n){var r=[];e.forEach(t("input[type=checkbox]:checked"),function(e){r[r.length]=t(e).attr("id")}),this.$el.find("tbody").remove();var i=t("#auth_table");n&&this.auths.refresh();for(var s=0;s<this.auths.catModel.length;s++)this.catViews[s]=new o(this.auths.catModel[s],this.viewOpt);var u=0;e.forEach(this.catViews,function(e){i.append(e.$el),e.render(),u+=e.hasContent?1:0;var n=e.model.appAuthGroup;!e.hasContent&&n!=="ALL"&&t("#app_category_select").find('option[value="'+n+'"]').remove()}),e.forEach(r,function(e){t("#"+e).attr("checked",!0)}),u<1&&i.append(this.emptyContentTpl());var a=i.find("tbody:last .help .tool_tip");a.length>0&&a.addClass("top")},emptyContentTpl:function(){var e=this.viewOpt.isAppAuthView?5:3,t='<tbody role="alert" aria-live="polite" aria-relevant="all"><tr class="odd"><td valign="top" colspan="'+e+'" class="dataTables_empty">\n'+"    \n"+"        \n"+'            <p class="data_null">\n'+'                <span class="ic_data_type ic_no_data"></span> \n'+'                <span class="txt">'+a["\uac80\uc0c9\uacb0\uacfc\uc5c6\uc74c"]+"</span>\n"+"            </p>\n"+"        \n"+"    \n"+"</td></tr></tbody>";return t},renderPage:function(){var e=t("#page_view");this.pageView=new u({self:this,page:this.auths,pageCb:this.changePage,offsetCb:this.changeOffset}),e.append(this.pageView.$el)},selectAll:function(n){var r=t(n.currentTarget),i=!!r.attr("checked");e.forEach(t(".sel_auth_item"),function(e){t(e).attr("checked",i)}),this.updatedSelectedItems()},addEventListner:function(){t("body").on("auth.selected.updated",t.proxy(this.updatedSelectedItems,this))},showOrgSlide:function(e,n,r){var i=this;t.goOrgSlide({header:f[r],desc:"",callback:t.proxy(function(t){n(i,t,e)},this),target:e,isAdmin:!0,contextRoot:GO.contextRoot})},addAdmAll:function(e){if(this.checkedCnt<1)return;this.showOrgSlide(e,this._addAdmAll,f["\uc6b4\uc601\uc790 \ucd94\uac00"])},_addAdmAll:function(e,t,n){e.viewOpt.viewSaveButton?e.auths.addAdminData(t):e.auths.addAdmin(t),e.renderContents(!1)},delAdmAll:function(e){if(this.checkedCnt<1)return;var n=this;if(this.viewOpt.viewSaveButton)n.auths.clearData(),n.renderContents(!1);else{t.goConfirm(f["\uba54\ub274\uc6b4\uc601\uad00\ub9ac\uc790\uc77c\uad04\uc0ad\uc81c"],f["\uba54\ub274\uc6b4\uc601\uad00\ub9ac\uc790\uc77c\uad04\uc0ad\uc81c\uc124\uba85"],t.proxy(r,this),a["\uc0ad\uc81c"]);function r(){n.auths.removeSelectedUser(),t("#search_txt").val(""),n.changedSearchCondition(e),n.render(),jQuery.goMessage(f["\uc0ad\uc81c \ub418\uc5c8\uc2b5\ub2c8\ub2e4"])}}},changeOffset:function(e,t){e.auths.updatePage({page:0,offset:t}),e.render()},changePage:function(e,t){e.auths.updatePage({page:t}),e.render()},sort:function(e){var n=t(e.currentTarget),r=n.attr("class"),i=r.indexOf("sorting_asc")>=0?"asc":r.indexOf("sorting_desc")>=0?"desc":"none",s=i==="asc"?"desc":"asc";t(".sorting_asc").addClass("sorting").removeClass("sorting_asc"),t(".sorting_desc").addClass("sorting").removeClass("sorting_desc"),n.removeClass("sorting sorting_asc sorting_desc"),n.addClass("sorting_"+s);var o=n.attr("value");this.auths.updatePage({property:o,direction:s}),this.renderContents(!0)},updatedSelectedItems:function(){var n=this,r="";e.forEach(t(".sel_auth_item"),function(e){!t(e).attr("checked")||(r+=t(e).attr("value")+", ")}),this.checkedCnt=this.auths.updatedChecked(r),e.forEach(this.$el.find(".btn_only_checked"),function(e){t(e).removeClass("disable"),n.checkedCnt<1&&t(e).addClass("disable")})},backToList:function(e){var t="/auth/app";r.router.navigate(t,{trigger:!0,pushState:!0})},saveAll:function(e){var n=this;t.goConfirm(f["\uacb0\uc7ac\uc591\uc2dd\uc6b4\uc601\uc790\ubcc0\uacbd"],f["\uacb0\uc7ac\uc591\uc2dd\uc6b4\uc601\uc790\ubcc0\uacbd\uc124\uba85"],function(){n.auths.saveUpdatedItems(),n.render(),jQuery.goMessage(f["\uc800\uc7a5 \ub418\uc5c8\uc2b5\ub2c8\ub2e4"])},function(){},a["\ubcc0\uacbd"])},contentTitle:function(){var e=f["\uc571\uc774\ub984"];switch(this.viewOpt.appAuthType){case"ApprFormOperator":e=f["\uacb0\uc7ac\uc591\uc2dd \uba85"];break;case"CompanyCalendarManager":e=f["\uc804\uc0ac \uce98\ub9b0\ub354 \uba85"];break;case"CompanyAssetManager":e=f["\uc790\uc0b0 \uba85"];break;case"CommunityMaster":e=f["\ucee4\ubba4\ub2c8\ud2f0 \uba85"];break;case"WorksAppOperator":e=f["works \uc571\uba85"];break;case"CompanyContactGroupOperator":e=f["\uacf5\uc6a9 \uc8fc\uc18c\ub85d \uba85"];break;case"CompanyBoardManager":e=f["\uc804\uc0ac \uac8c\uc2dc\ud310 \uba85"];break;case"CompanyDocsOperator":e=f["\ubb38\uc11c\ud568 \uba85"]}return e}})});