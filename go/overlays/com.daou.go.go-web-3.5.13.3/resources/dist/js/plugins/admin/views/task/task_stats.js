(function(){define(["backbone","i18n!nls/commons","i18n!admin/nls/admin","i18n!task/nls/task","hgn!admin/templates/task_stats","admin/models/task_stats","jquery.go-grid"],function(e,t,n,r,i,s){var o={totalFolderCount:n["\ucd1d \uc5c5\ubb34 \ucd10\ub354 \uc218"],count:r["\uac1c"],normal:n["\uc815\uc0c1"],stop:n["\uc911\uc9c0"],totalTaskCount:n["\ucd1d \uc5c5\ubb34 \uc218"],totalAttachSize:n["\ucd1d \uc0ac\uc6a9\ub7c9"],title:t["\uc81c\ubaa9"],department:r["\ubd80\uc11c"],type:n["\uc720\ud615"],taskCount:r["\uc5c5\ubb34\uc218"],attachSize:n["\uc0ac\uc6a9\ub7c9"],status:n["\uc0c1\ud0dc"],createdAt:n["\uc0dd\uc131\uc77c"]},u=e.View.extend({events:{"keypress #searchKeyword":"enterEventHandler","click #search":"search","click #download":"download","click .wrap_action":"onClickedWrapAction"},initialize:function(e){this.stats=new s,this.stats.fetch({async:!1}),this.listOption={page:0,offset:20}},render:function(){return this.$el.html(i({lang:o,stats:this.stats.toJSON(),totalCount:this.stats.totalCount(),sizeStr:GO.util.byteToMega(this.stats.get("attachSize"))})),this.renderList(),this.renderButton(),this},renderList:function(){var e=this;this.dataTable=$.goGrid({el:this.$("#folderList"),url:GO.contextRoot+"ad/api/task/folder",displayLength:e.listOption.offset,emptyMessage:'<tr style="display:"><td colspan="6"><p class="data_null"> <span class="ic_data_type ic_no_contents"></span><span class="txt">'+r["\ubaa9\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"]+"</span>"+"</p>"+"</td>"+"</tr>",defaultSorting:[],sDomUse:!0,columns:[{mData:"name",sClass:"title",bSortable:!0,fnRender:function(e){return e.aData.name}},{mData:"departmentName",sClass:"part",bSortable:!0,fnRender:function(e){return e.aData.departmentName}},{mData:null,sClass:"",bSortable:!1,fnRender:function(e){return(new s(e.aData)).typeLabel()}},{mData:"taskCount",sClass:"",bSortable:!0,fnRender:function(e){return e.aData.taskCount}},{mData:"attachSize",sClass:"",bSortable:!0,fnRender:function(e){return GO.util.byteToMega(e.aData.attachSize)}},{mData:function(e){return e?e.closedAt?n["\uc911\uc9c0"]:n["\uc815\uc0c1"]:"closedAt"},sClass:"date",bSortable:!0,fnRender:function(e){}},{mData:"createdAt",sClass:"last date",bSortable:!0,fnRender:function(e){return GO.util.customDate(e.aData.createdAt,"YYYY-MM-DD")}}],fnDrawCallback:function(e,t,n){}})},renderButton:function(){this.$("div.tool_bar").first().removeClass("toolbar").addClass("toolbar_top header_tb"),this.$("div.custom_header").append('<span class="btn_tool" id="download">'+n["\ubaa9\ub85d \ub2e4\uc6b4\ub85c\ub4dc"]+"</span>")},enterEventHandler:function(e){e.which==13&&this.search()},search:function(){var e=this.$("#searchKeyword").val();if(!e){$.goMessage(r["\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."]);return}this.listOption.keywordType=this.$("#searchType").val(),this.listOption.keyword=this.$("#searchKeyword").val(),this.dataTable.tables.fnSettings().sAjaxSource=this.getSearchUrl(),this.dataTable.tables.fnClearTable()},getSearchUrl:function(){return GO.contextRoot+"ad/api/task/folder?"+$.param(this.listOption)},onClickedWrapAction:function(){this.$el.find(".wrap_action").toggle(),this.$el.find(".info_summary li").not(".first").toggle()},download:function(){window.location.href=GO.contextRoot+"ad/api/task/folder/download?"+$.param(this.listOption)}});return u})}).call(this);