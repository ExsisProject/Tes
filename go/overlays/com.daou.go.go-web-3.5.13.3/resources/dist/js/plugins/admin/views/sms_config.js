define(["jquery","backbone","app","admin/models/sms_config_model","hgn!admin/templates/sms_config","views/circle","i18n!nls/commons","i18n!admin/nls/admin","jquery.go-popup","jquery.go-sdk","jquery.go-orgslide","GO.util"],function(e,t,n,r,i,s,o,u){var a={label_ok:o["\uc800\uc7a5"],label_cancel:o["\ucde8\uc18c"],label_remove:o["\uc0ad\uc81c"],label_use:u["\uc0ac\uc6a9"],label_unuse:u["\uc0ac\uc6a9\uc548\ud568"],label_lmsSetting:u["\uc7a5\ubb38 \ubc1c\uc1a1\uc790 \uc124\uc815"],label_mmsSetting:u["\ud3ec\ud1a0 \ubc1c\uc1a1\uc790 \uc124\uc815"],label_policySetting:u["\uc815\ucc45 \uc124\uc815"],label_blackDesc:u["\uacf5\uac1c"],label_whiteDesc:u["\ube44\uacf5\uac1c"],label_selectClass:u["\ud074\ub798\uc2a4 \uc120\ud0dd"],label_addExceptionClass:u["\uc608\uc678 \ud074\ub798\uc2a4 \ucd94\uac00"],label_desc1:u["\ub2e8\ubb38\ubc1c\uc1a1\uc870\uac74\uc124\uba85"],label_desc2:u["\uc7a5\ubb38\ud3ec\ud1a0\ubc1c\uc1a1\uc870\uac74\uc124\uba85"],label_config:u["\uc124\uc815"],"\ucc28\ub2e8\ud560\ud074\ub798\uc2a4\uc120\ud0dd":u["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"],"\ud5c8\uc6a9\ud560\ud074\ub798\uc2a4\uc120\ud0dd":u["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"],"\uc608\uc678\ud5c8\uc6a9\ud074\ub798\uc2a4\uc120\ud0dd":u["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"],"\uc608\uc678\ucc28\ub2e8\ud074\ub798\uc2a4\uc120\ud0dd":u["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"],"\uc608\uc678\ud5c8\uc6a9\ud074\ub798\uc2a4\ud234\ud301":u["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"],"\uc608\uc678\ucc28\ub2e8\ud074\ub798\uc2a4\ud234\ud301":u["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"]},f=t.View.extend({accessUserView:null,exceptionUserView:null,el:"#layoutContent",initialize:function(){this.$el.off(),this.model=r.read({admin:!0})},events:{"click #smsConfigSubmit":"submit","click #smsConfigCancel":"cancel","click #selectLmsAccessPolicy input:radio":"confirmDeleteTarget","click #selectMmsAccessPolicy input:radio":"confirmDeleteTarget"},render:function(){var t=this;this.$el.empty(),this.$el.html(i({lang:a,data:this.model.toJSON()}));if(this.model.id){var n=this.model.get("lmsAccessSetting"),r=this.model.get("mmsAccessSetting");this.$('input[name="lmsAccessSetting"][value="'+n+'"]').attr("checked",!0),this.$('input[name="mmsAccessSetting"][value="'+r+'"]').attr("checked",!0),"BLACK"==n?(e("#lmsContainer .selectedClass").text(u["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .exceptedClass").text(u["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .tool_tip").text(u["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):(e("#lmsContainer .selectedClass").text(u["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .exceptedClass").text(u["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .tool_tip").text(u["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])),"BLACK"==r?(e("#mmsContainer .selectedClass").text(u["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .exceptedClass").text(u["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .tool_tip").text(u["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):(e("#mmsContainer .selectedClass").text(u["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .exceptedClass").text(u["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .tool_tip").text(u["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"]))}this.renderAccessUserView(),this.renderExceptionUserView()},renderAccessUserView:function(e){var t=["user","position","grade","usergroup"];GO.util.isUseOrgService(!0)&&(t=["user","department","position","grade","duty","usergroup"]),this.lmsAccessUserView=new s({selector:"#lmsAccessUser",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("lmsAccessTarget"),nodeTypes:t}),this.lmsAccessUserView.render(),this.mmsAccessUserView=new s({selector:"#mmsAccessUser",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("mmsAccessTarget"),nodeTypes:t}),this.mmsAccessUserView.render()},renderExceptionUserView:function(e){var t=["user","position","grade","usergroup"];GO.util.isUseOrgService(!0)&&(t=["user","department","position","grade","duty","usergroup"]),this.lmsExceptionUserView=new s({selector:"#lmsExceptionUser",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("lmsExceptionTarget"),nodeTypes:t}),this.lmsExceptionUserView.render(),this.mmsExceptionUserView=new s({selector:"#mmsExceptionUser",isAdmin:!0,isWriter:!0,circleJSON:this.model.get("mmsExceptionTarget"),nodeTypes:t}),this.mmsExceptionUserView.render()},confirmDeleteTarget:function(t){var n=this,r=e(t.target).val(),i=e(t.currentTarget),s=i.attr("data-type"),a=function(){s=="lms"?e('input[name="lmsAccessSetting"][value="'+r+'"]').attr("checked",!0):e('input[name="mmsAccessSetting"][value="'+r+'"]').attr("checked",!0)},f=function(){s=="lms"?(n.lmsAccessUserView.deleteAllData(),n.lmsExceptionUserView.deleteAllData(),r=="BLACK"?(e("#lmsContainer .selectedClass").text(u["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .exceptedClass").text(u["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .tool_tip").text(u["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):(e("#lmsContainer .selectedClass").text(u["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .exceptedClass").text(u["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#lmsContainer .tool_tip").text(u["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])),l.close()):(n.mmsAccessUserView.deleteAllData(),n.mmsExceptionUserView.deleteAllData(),r=="BLACK"?(e("#mmsContainer .selectedClass").text(u["\ucc28\ub2e8\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .exceptedClass").text(u["\uc608\uc678 \ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .tool_tip").text(u["\uc608\uc678\ud5c8\uc6a9 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])):(e("#mmsContainer .selectedClass").text(u["\ud5c8\uc6a9\ud560 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .exceptedClass").text(u["\uc608\uc678 \ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd"]),e("#mmsContainer .tool_tip").text(u["\uc608\uc678\ucc28\ub2e8 \ud074\ub798\uc2a4 \uc120\ud0dd \ud234\ud301"])),l.close())},l=e.goPopup({title:u["\uc815\ucc45 \uc124\uc815 \ubcc0\uacbd \ud655\uc778"],message:"",buttons:[{btext:o["\ud655\uc778"],btype:"confirm",callback:f,autoclose:!1},{btext:o["\ucde8\uc18c"],btype:"normal",callback:a}],closeCallback:a})},submit:function(){var t=this,n=e("#selectLmsAccessPolicy input[type=radio]:checked").val(),r=e("#selectMmsAccessPolicy input[type=radio]:checked").val(),i=t.lmsAccessUserView.getData(),s=t.mmsAccessUserView.getData(),u=t.lmsExceptionUserView.getData(),a=t.mmsExceptionUserView.getData();t.model.set("lmsAccessSetting",n,{silent:!0}),t.model.set("mmsAccessSetting",r,{silent:!0}),t.model.set("lmsAccessTarget",i,{silent:!0}),t.model.set("mmsAccessTarget",s,{silent:!0}),t.model.set("lmsExceptionTarget",u,{silent:!0}),t.model.set("mmsExceptionTarget",a,{silent:!0}),GO.EventEmitter.trigger("common","layout:setOverlay",""),t.model.save({},{type:"PUT",success:function(t,n){n.code=="200"&&(e.goMessage(o["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),GO.EventEmitter.trigger("common","layout:clearOverlay",!0),GO.router.navigate("sms/config",{trigger:!0}))},error:function(t,n){e.goMessage(o["\uc800\uc7a5\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4."]),GO.EventEmitter.trigger("common","layout:clearOverlay",!0)}})},cancel:function(){this.render()}});return f});