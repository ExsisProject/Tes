define("admin/views/ehr/timeline/group/noti/noti",function(require){var e=require("backbone"),t=require("admin/views/ehr/timeline/group/noti/noti_item"),n=require("hgn!admin/templates/ehr/timeline/group/noti/noti"),r=require("i18n!admin/nls/admin"),i=require("underscore"),s=require("i18n!nls/commons"),o=require("app"),u=e.View.extend({MAX_ITEM_COUNT:3,tagName:"tr",events:{},initialize:function(){var e=this;this.type=this.options.type,this.title=this.options.title,this.timeSetting=this.options.timeSetting,this.description=this.options.description,this.collection=this.options.collection,i.isUndefined(this.collection)||i.isEmpty(this.collection)?this.notiItems=[this.makeNotiItemView()]:this.notiItems=i.chain(this.collection).map(function(t){return e.makeNotiItemView(t)}).value()},render:function(){this.$el.html(n({type:this.type,title:this.title,isOn:i.isEmpty(this.collection)?!1:this.collection[0].enable})),i.each(this.notiItems,i.bind(function(e){this.$el.find("#noti_list").append(e.$el),e.render()},this))},makeNotiItemView:function(e){var n=new t({timeSetting:this.timeSetting,description:this.description,data:e});return n.on({addNoti:i.bind(this.addNoti,this),removeNoti:i.bind(this.removeNoti,this)}),n},addNoti:function(e){if(this.notiItems.length>=this.MAX_ITEM_COUNT)throw $.goError(o.i18n(s["\ucd5c\ub300 {{arg1}}\uac1c \uae4c\uc9c0 \uc124\uc815\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."],{arg1:this.MAX_ITEM_COUNT})),new Error(o.i18n(s["\ucd5c\ub300 {{arg1}}\uac1c \uae4c\uc9c0 \uc124\uc815\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."],{arg1:this.MAX_ITEM_COUNT}));var t=this.makeNotiItemView();$(e.$el).after(t.$el),t.render(!0),this.notiItems.splice(this.notiItems.indexOf(e)+1,0,t)},removeNoti:function(e){if(this.notiItems.length<2)throw $.goError(r["\ucd5c\uc18c 1\uac1c\ub294 \uc874\uc7ac\ud574\uc57c \ud569\ub2c8\ub2e4."]),new Error(r["\ucd5c\uc18c 1\uac1c\ub294 \uc874\uc7ac\ud574\uc57c \ud569\ub2c8\ub2e4."]);this.notiItems=i.without(this.notiItems,e)},getData:function(){function t(t){return{notiType:e.type,enable:e.$el.find("#"+e.type).is(":checked"),minute:t.getDate()}}function n(t){return{notiType:e.type,enable:e.$el.find("#"+e.type).is(":checked"),limitWorkingHour:t.getDate()}}var e=this;return i.chain(this.notiItems).map(function(e){return e.timeSetting.useMinuteType?t(e):n(e)}).value()}});return u});