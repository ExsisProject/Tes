define("admin/views/ehr/timeline/ip/access_allow_info",function(require){require("jquery.go-orgslide"),require("jquery.go-grid"),require("jquery.go-sdk");var e=require("hgn!admin/templates/ehr/timeline/ip/access_allow_info"),t=require("hgn!admin/templates/ehr/timeline/ip/edit"),n=require("i18n!admin/nls/admin"),r=require("i18n!nls/commons"),i=Backbone.View.extend({lang:{label_access_allow_ip_info:n["\uc811\uc18d \ud5c8\uc6a9 IP"],label_ip_name:n["\uc811\uc18d IP \uc774\ub984"],label_ip:n.IP,label_use:n["\uc0ac\uc6a9"],label_not_use:n["\uc0ac\uc6a9\uc548\ud568"],label_save:r["\uc800\uc7a5"],label_cancel:r["\ucde8\uc18c"],label_add:r["\ucd94\uac00"],label_delete:r["\uc0ad\uc81c"],label_description:n["\uc124\uba85"],ips_empty_message:n["\ub4f1\ub85d\ub41c \uc811\uc18d \ud5c8\uc6a9 IP\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],label_all:r["\ubaa8\ub450 \ud5c8\uc6a9"],label_part:r["\ubd80\ubd84 \ud5c8\uc6a9"]},events:{"click #accessIpAddBtn":"addAccessIp","click .ip_model":"modifyAccessIp","click .ip_del_btn":"delAccessIp","click .title_sort":"onSortClicked","click #allOfIp":"toggleIpInfo","click #partOfIp":"toggleIpInfo"},initialize:function(e){this.workPlace=e.workPlace,this.useIp=this.workPlace.get("useIp"),this.workPlace.get("ipModels")?this.ipModels=this.workPlace.get("ipModels").slice():this.ipModels=new Array,this.updated=!1},render:function(){this.$el.html(e({adminLang:n,commonLang:r,lang:this.lang,ipModels:this.ipModels,useIp:this.useIp}))},toggleIpInfo:function(e){$(e.currentTarget).val()==="all"?this.$el.find("#accessIpsContainer").css("display","none"):this.$el.find("#accessIpsContainer").css("display","")},addAccessIp:function(e){this.updated=!0,this._callPopupEditIp()},modifyAccessIp:function(e){this.updated=!0,this._callPopupEditIp($(e.currentTarget),!0)},delAccessIp:function(e){var t=function(){var t=$(e.currentTarget).attr("data-name"),n=$(e.currentTarget).attr("data-range");this.ipModels.splice(this.ipModels.findIndex(function(e){return e.ipName===t&&e.ipRange===n}),1),this.refresh(),this.updated=!0};$.goPopup({title:n["\uc120\ud0dd\ud55c IP \uc0ad\uc81c \uc54c\ub9bc"],modal:!0,buttons:[{btype:"confirm",btext:r["\uc0ad\uc81c"],callback:$.proxy(t,this)},{btype:"close",btext:r["\ucde8\uc18c"]}]}),e.stopPropagation()},isCheckedUseIp:function(){return this.$el.find("#partOfIp").prop("checked")},_callPopupEditIp:function(e,i){var s={};if(i){var o=e.data("id"),u=e.data("name"),a=e.data("range"),f=this.ipModels.find(function(e){return o?o==e.id:e.ipName==u&&e.ipRange==a});s=f;var l=s.ipRange.split("-");s.ip1=l[0].split(".")[0],s.ip2=l[0].split(".")[1],s.ip3=l[0].split(".")[2],s.ip4=l[0].split(".")[3],s.ip5=l[1]}var c=this,h=t({adminLang:n,commonLang:r,model:s});this.editPopup=$.goPopup({pclass:"layer_normal layer_ehr_kind",header:o==null?n["\uc811\uc18d \ud5c8\uc6a9 IP \ucd94\uac00"]:n["\uc811\uc18d \ud5c8\uc6a9 IP \uc218\uc815"],modal:!0,width:"320px",contents:h,buttons:[{btext:r["\uc800\uc7a5"],btype:"confirm",autoclose:!1,callback:function(e){var t=!0,r=$("#accessIpEditBlock"),o=r.find("#ipName").val(),u=r.find("#ipDescription").val(),a=r.find("#ip1").val(),f=r.find("#ip2").val(),l=r.find("#ip3").val(),h=r.find("#ip4").val(),p=r.find("#ip5").val();c.initAlertEl();if(!$.goValidation.isCheckLength(2,10,o))t=!1,r.find("#ipNameAlert").html(GO.i18n(n["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"2",arg2:"10"})),r.find("#ipName").focus();else if(!$.goValidation.isNumber(a)||!$.goValidation.isNumber(f)||!$.goValidation.isNumber(l)||!$.goValidation.isNumber(h)||!$.goValidation.isNumber(p))t=!1,r.find("#ipAlert").html(n["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]);else if(a<0||a>255||f<0||f>255||l<0||l>255||h<0||h>255||p<0||p>255)t=!1,r.find("#ipAlert").html("0~255 \uc0ac\uc774\uc758 \uac12\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");var d=a+"."+f+"."+l+"."+h+"-"+p;c.ipModels.filter(function(e){return e!=s}).forEach(function(e){o==e.ipName&&(r.find("#ipNameAlert").html(n["\uc911\ubcf5\ub41c \uc774\ub984\uc774 \uc874\uc7ac\ud569\ub2c8\ub2e4."]),t=!1)});if(!t)return!1;s.ipName=o,s.ipRange=d,s.description=u,i||c.ipModels.push(s),c.useIp=c.isCheckedUseIp(),c.refresh(),e.close()}},{btext:r["\ucde8\uc18c"],btype:"cancel"}]},this)},initAlertEl:function(){var e=$("#accessIpEditBlock");e.find("#ipAlert").html(""),e.find("#ipNameAlert").html("")},refresh:function(){this.remove(),this.render(),this.delegateEvents()},remove:function(){this.undelegateEvents(),this.$el.removeData().unbind(),this.$el.html("")},onSortClicked:function(e){var t=$(e.currentTarget).data("sortkey"),n=t==this.sortKey?!this.desc:!1;this.sortKey=t,this.desc=n,this.sortIps(t,n),this.refresh()},saved:function(){this.updated=!1},sortIps:function(e,t){this.ipModels.sort(function(n,r){var i=0;return!n[e]&&r[e]?i=-1:n[e]&&!r[e]?i=1:n[e]>r[e]?i=1:n[e]<r[e]&&(i=-1),t?-i:i})}});return i});