define("admin/models/auth/admin_auth_group",function(require){var e=require("i18n!admin/nls/admin"),t=require("i18n!nls/commons"),n=function(t){t.responseJSON&&t.responseJSON.message?$.goMessage(t.responseJSON.message):$.goMessage(e["\uc694\uccad \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4."])};return Backbone.Model.extend({initialize:function(t,n){function i(t){var n={uid:t.uid,labelKey:t.labelKey,labelKeyOrigin:t.labelKeyOrigin,isAccessibleLevel:t.isAccessibleLevel,isAccessibleApp:t.isAccessibleApp,checkboxFlag:!_.contains(r.inaccessibleMenus,t.uid),exceptedMenu:_.contains(["\uc11c\ube44\uc2a4 \uc815\ubcf4"],t.labelKeyOrigin),subMenus:_.map(t.childs,i)},s=t.depth==0;if(s){n.description=e[n.labelKey+" \uad8c\ud55c\uc124\uba85"],n.withoutSubMenus=_.contains(["\ubcf4\uc548 \uad00\ub9ac","\uc870\uc9c1 \uad00\ub9ac","\uc2dc\uc2a4\ud15c \uc5f0\ub3d9"],n.labelKeyOrigin);var o=_.chain(n.subMenus).filter(function(e){return e.isAccessibleLevel}).every(function(e){return e.checkboxFlag}).value();n.checkboxFlag=n.withoutSubMenus?n.checkboxFlag:o}return n}var r=this;n&&n.collection&&n.collection.sideMenuCollection&&(this.sideMenuCollection=n.collection.sideMenuCollection,this.inaccessibleMenus=this.getInaccessibleMenus()),this.sideMenus=_.map(this.sideMenuCollection.models,i),this.sortAuthUsers("userName",!0)},url:function(){return GO.contextRoot+"ad/api/domainadmin/auth"},fetch:function(e){return e=e?e:{},this.isDefaultGroup()?e.url=this.url()+"/default":e.url=this.url()+"/"+this.id,Backbone.Model.prototype.fetch.call(this,e).fail(n)},save:function(e){var r=this;return Backbone.Model.prototype.save.call(this,e).done(function(e){r.inaccessibleMenus=e.data.inaccessibleMenus,$.goMessage(t["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])}).done($.proxy(r.initialize,r)).fail(n)},destroy:function(e){return e=e?e:{},e.contentType="application/json",e.data=JSON.stringify(this.attributes),e.wait=!0,Backbone.Model.prototype.destroy.call(this,e).done(function(){$.goMessage(t["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])}).fail(n)},getInaccessibleMenus:function(){return this.get("inaccessibleMenus")},isDefaultGroup:function(){return this.get("defaultGroup")},deleteAuthUsers:function(e){var t=GO.contextRoot+"ad/api/domainadmin";return this.isDefaultGroup()?t+="/default/users":t+="/auth/users",$.ajax({url:t,type:"DELETE",data:JSON.stringify(e),dataType:"json",contentType:"application/json"}).fail(n)},addAuthUser:function(e,t){var r=GO.contextRoot+"ad/api/domainadmin";return this.isDefaultGroup()?r+="/default/user":r+="/auth/user",$.ajax({url:r,type:"POST",data:{authGroupId:this.id,userId:e,removeOtherAuth:t}}).fail(n)},sortAuthUsers:function(e,t){var n=this.get("domainAdminAuthUsers");if(!n)return;this.desc=t,this.sortKey=e,n.sort(function(n,r){var i=0;return!n[e]&&r[e]?i=-1:n[e]&&!r[e]?i=1:n[e]>r[e]?i=1:n[e]<r[e]&&(i=-1),t?i:-i}),this.set("domainAdminAuthUsers",n)},findAuthUserByUserId:function(e){var t=this;return _.find(t.get("domainAdminAuthUsers"),function(t){return t["userId"]==e})}})});