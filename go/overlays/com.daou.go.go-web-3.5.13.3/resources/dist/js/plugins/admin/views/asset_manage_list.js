define(["jquery","backbone","app","hgn!admin/templates/asset_manage_list","i18n!nls/commons","i18n!admin/nls/admin","admin/collections/asset_list","board/components/layer/views/share_scope","jquery.go-sdk","GO.util"],function(e,t,n,r,i,s,o,u){var a={asset_add:s["\uc790\uc0b0 \ucd94\uac00"],asset_sort:s["\uc21c\uc11c \ubc14\uafb8\uae30"],asset_sort_done:s["\uc21c\uc11c\ubc14\uafb8\uae30 \uc644\ub8cc"],asset_list:s["\uc790\uc0b0 \ubaa9\ub85d"],asset_cnt:s["\ubcf4\uc720 \uc218"],asset_admin:s["\uc6b4\uc601\uc790"],asset_setting:s["\uc124\uc815"],asset_no_list:s["\uc790\uc0b0\uc774 \ubaa9\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."],board_sort_done:s["\uc21c\uc11c\ubc14\uafb8\uae30 \uc644\ub8cc"],asset_public:s["\uc804\uccb4 \ud5c8\uc6a9"],asset_private:s["\uc77c\ubd80\ub9cc \ud5c8\uc6a9"],asset_name:s["\uc790\uc0b0\uba85"],asset_auth:s["\uad8c\ud55c"],asset_status:s["\uc0c1\ud0dc"],asset_setting:s["\uc124\uc815"],range:s["\uacf5\uac1c \ubc94\uc704"]},f=null,l=t.View.extend({el:"#layoutContent",events:{'click [data-type="btnOwners"]':"onClickBtnOwners"},unbindEvent:function(){this.$el.off("click","span[data-btntype='assetCreate']"),this.$el.off("click","span[data-btntype='assetSettingBtn']"),this.$el.off("click","span.btnAssetSortable"),this.$el.off("click","span.btnBoardSortDone")},bindEvent:function(){this.$el.on("click","span[data-btntype='assetCreate']",e.proxy(this.assetCreate,this)),this.$el.on("click","span[data-btntype='assetSettingBtn']",e.proxy(this.assetInfo,this)),this.$el.on("click","span.btnAssetSortable",e.proxy(this.bindListSortable,this)),this.$el.on("click","span.btnBoardSortDone",e.proxy(this.ListSortablePut,this))},initialize:function(){this.companyId=GO.session().companyId,this.unbindEvent(),this.bindEvent()},render:function(){var t=this;this.collection=o.getCollection();var n=this.collection.toJSON(),i=function(){var t=[];return e.each(this.managers,function(e,n){t.push(n.user.name+" "+n.user.positionName)}),t.join(",")},u=function(){return this.status=="ACTIVE"?s["\uc0ac\uc6a9\uc911"]:s["\uc0ac\uc6a9\uc911\uc9c0"]},f=r({dataset:n,parseManagers:i,parseStatus:u,lang:a});this.$el.html(f),this.listEl=this.$el.find("#tableBorderList"),this.$el.find("#tableBorderList tr:last-child").addClass("last")},assetInfo:function(t){var r=e(t.currentTarget);if(e(t.currentTarget).parents("tbody:eq(0)").hasClass("ui-sortable"))return e.goMessage(s["\uc21c\uc11c \ubc14\uafb8\uae30 \uc644\ub8cc\ud6c4 \uc218\uc815"]),!1;n.router.navigate("/asset/"+r.attr("data-assetid")+"/modify",!0)},bindListSortable:function(t){if(this.collection.length==0)return e.goMessage(s["\uc790\uc0b0\uc774 \ubaa9\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]),!1;this.$el.find(".btnAssetAdd").hide(),this.$el.find(".btnAssetSortable").hide(),this.$el.find(".btnBoardSortDone").show(),this.listEl.find("tbody").removeClass().sortable({opacity:"1",delay:100,cursor:"move",items:"tr",containment:".admin_content",hoverClass:"ui-state-hover",placeholder:"ui-sortable-placeholder",start:function(e,t){t.placeholder.html(t.helper.html()),t.placeholder.find("td").css("padding","5px 10px")}})},ListSortablePut:function(n){var r=this,i=this.$el.find("tbody"),s=i.find("tr").map(function(t,n){return e(n).attr("data-id")}).get();this.model=new t.Model,this.model.url=GO.contextRoot+"ad/api/asset/list",this.model.set({ids:s},{silent:!0}),this.model.save({},{type:"PUT",success:function(){r.render()}})},assetCreate:function(){n.router.navigate("/asset/create",!0)},assetModify:function(t){var r=e(t.currentTarget).attr("data-assetId");n.router.navigate("/asset/"+r+"/modify",!0)},onClickBtnOwners:function(t){var n=e(t.currentTarget),r=n.attr("data-id"),o=this.collection.get(r),a=e.goPopup({header:s["\uacf5\uac1c \ubc94\uc704"],pclass:"layer_normal layer_share_scope",width:330,modal:!0,allowPrevPopup:!1,buttons:[{btext:i["\ud655\uc778"],btype:"confirm",autoclose:!0}],contents:""}),f=new u({shares:o});f.render()}});return l});