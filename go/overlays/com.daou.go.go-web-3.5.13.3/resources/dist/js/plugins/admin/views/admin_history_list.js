(function(){define(["jquery","backbone","app","hgn!admin/templates/admin_history_list","hgn!admin/templates/list_empty","i18n!nls/commons","i18n!admin/nls/admin","jquery.go-popup","jquery.go-sdk","jquery.go-grid","jquery.go-orgslide","jquery.go-validation","GO.util"],function(e,t,n,r,i,s,o){var u={label_download:o["\ubaa9\ub85d \ub2e4\uc6b4\ub85c\ub4dc"],label_id:o["\uc77c\ub828\ubc88\ud638"],label_create_at:o["\uc77c\uc2dc"],label_name:s["\uc774\ub984"],label_position:o["\uc9c1\uc704"],label_email:s["\uc774\uba54\uc77c"],label_desc:o["\uc791\uc5c5\ub0b4\uc6a9"],search:s["\uac80\uc0c9"],select_type:[{text:o["\uc804\uccb4\ubd84\ub958"],value:""},{text:o["\uc811\uc18d"],value:"ACCESS"},{text:o["\uc815\ubcf4\uad00\ub9ac"],value:"INFO"},{text:o["\uacc4\uc815\uad00\ub9ac"],value:"ACCOUNT"},{text:o["\uc790\ub8cc\uad00\ub9ac"],value:"DATA"},{text:o["\uc11c\ube44\uc2a4\uc124\uc815"],value:"SERVICE"}]},a=t.View.extend({el:"#layoutContent",initialize:function(){this.listEl="#adminList",this.dataTable=null,this.unbindEvent(),this.bindEvent()},unbindEvent:function(){this.$el.off("click","span#btn_down"),this.$el.off("change","#categoryName"),this.$el.off("click","#search_history"),this.$el.off("keydown","span.search_wrap input")},bindEvent:function(){this.$el.on("click","span#btn_down",e.proxy(this.downDomainAdminList,this)),this.$el.on("change","#categoryName",e.proxy(this.categoryNameFilter,this)),this.$el.on("click","#search_history",e.proxy(this.search,this)),this.$el.on("keydown","span.search_wrap input",e.proxy(this.searchKeyboardEvent,this))},search:function(){var t=this.$el.find(".table_search input[type='text']"),r=t.val();if(r.length>64){e.goAlert(n.i18n(o["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"1",arg2:"64"}));return}this.dataTable.tables.search(this.$el.find(".table_search select").val(),r,t)},searchKeyboardEvent:function(e){e.keyCode==13&&this.search()},categoryNameFilter:function(t){var n=e(t.currentTarget).val();typeof this.dataTable.tables.setParam=="function"&&this.dataTable.tables.setParam("category",n)},downDomainAdminList:function(){var e="ad/api/activitylog/download/list?",t=this.dataTable.listParams,n={property:t.property,direction:t.direction,searchtype:t.searchtype,keyword:t.keyword,action:t.action,category:t.category};GO.util.downloadCsvFile(e+GO.util.jsonToUrlParam(n))},render:function(){this.$el.empty(),this.$el.html(r({lang:u})),this.renderAdminHistoryList()},renderAdminHistoryList:function(){var t=this;this.dataTable=e.goGrid({el:this.listEl,method:"GET",url:GO.contextRoot+"ad/api/activitylog/list",emptyMessage:i({label_desc:o["\uc5c5\ubb34\uae30\ub85d \uc5c6\uc74c"]}),defaultSorting:[[0,"desc"]],sDomType:"admin",displayLength:n.session("adminPageBase"),columns:[{mData:"createdAt",sClass:"align_c",sWidth:"200px",bSortable:!0,fnRender:function(e){return GO.util.basicDate(e.aData.createdAt)}},{mData:"categoryName",sWidth:"110px",bSortable:!1,fnRender:function(e){return e.aData.categoryName}},{mData:"actor",sWidth:"150px",bSortable:!0,fnRender:function(e){return e.aData.actor}},{mData:function(e){return e?e.position==null||e.position==""?"-":e.position:"position"},sWidth:"100px",bSortable:!0,fnRender:function(e){}},{mData:"actorEmail",sWidth:"200px",bSortable:!0,fnRender:function(e){return e.aData.actorEmail}},{mData:"doneMessage",sClass:"title",bSortable:!1,fnRender:function(e){return e.aData.doneMessage}}],fnDrawCallback:function(e){t.$el.find(".toolbar_top .custom_header").append(t.$el.find("#controlButtons").show())}})}});return a})}).call(this);