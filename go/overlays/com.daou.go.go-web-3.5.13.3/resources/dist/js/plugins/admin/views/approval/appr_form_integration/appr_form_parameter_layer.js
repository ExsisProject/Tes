define(["i18n!nls/commons","i18n!admin/nls/admin","i18n!approval/nls/approval","admin/constants/integration_config","hgn!admin/templates/approval/appr_form_integration/appr_form_parameter_layer"],function(e,t,n,r,i){var s={"\uac12\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694":e["\uac12\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694"],"\ub3d9\uc77c\ud55c variable\uc774 \uc874\uc7ac \ud569\ub2c8\ub2e4":n["\ub3d9\uc77c\ud55c variable\uc774 \uc874\uc7ac \ud569\ub2c8\ub2e4"],Document:"Document",STRING:"STRING",NUMBER:"NUMBER",BOOLEAN:"BOOLEAN","\ucd94\uac00":e["\ucd94\uac00"],Variables:"Variables"},o=['<td class="name" data-name="{{paramName}}" data-type="{{dataType}}"><a>{{paramName}}({{dataType}})</a></td>',"{{^isDocument}}",'<td class="func"><span class="btn_bdr" title="{{label_remove}}"><span class="ic_classic ic_basket"></span></span></td>',"{{/isDocument}}"].join(""),u=Backbone.View.extend({tagName:"tr",initialize:function(e){this.data=e.data,this.observer=e.observer},events:{"click span.btn_bdr":"removeParam","click td.name":"addParameter"},addParameter:function(){this.trigger("addParameter",this.data)},removeParam:function(e){e.stopPropagation(),$(e.currentTarget).closest("tr").remove()},render:function(){return this.$el.html(Hogan.compile(o).render(this.data)),this}}),a=Backbone.View.extend({el:".layer_normal.parameter_popup > .content",initialize:function(e){this.model=e.model,this.observer=e.observer,this.parameters=this._setParameters()},_setParameters:function(){var e=[],t=[{dataType:"NUMBER",isDocument:!0,paramName:"getId",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getEmployeeNumber",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getTitle",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getDocNum",paramType:"DOCUMENT"},{dataType:"NUMBER",isDocument:!0,paramName:"getDrafterId",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getDrafterName",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getDrafterDeptName",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getStatus",paramType:"DOCUMENT"},{dataType:"NUMBER",isDocument:!0,paramName:"getFormId",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getFormName",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getFormCode",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getBody",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getCurrEmpNo",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getCurrEmpName",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getCurrEmpDeptName",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getDraftedAt",paramType:"DOCUMENT"},{dataType:"STRING",isDocument:!0,paramName:"getCompletedAt",paramType:"DOCUMENT"}];_.each(t,function(t){e.push({dataType:t.dataType,isDocument:t.isDocument,paramName:t.paramName,paramType:t.paramType})});var n=$("[name=input_parameters]");$.each(n,function(t,n){$(n).attr("data-paramtype")!="DOCUMENT"&&e.push({dataType:$(n).attr("data-datatype"),isDocument:!1,paramName:$(n).attr("data-paramname"),paramType:$(n).attr("data-paramtype")})});var r=$("[name=output_parameters]");return $.each(r,function(t,n){$(n).attr("data-paramtype")!="DOCUMENT"&&e.push({dataType:$(n).attr("data-datatype"),isDocument:!1,paramName:$(n).attr("data-paramname"),paramType:$(n).attr("data-paramtype")})}),this._getUniqueParam(e)},_getUniqueParam:function(e){var t={};for(var n=0,r=e.length;n<r;n++)t[e[n].paramName]=e[n];e=new Array;for(var i in t)e.push(t[i]);return e},events:{"click .btn_s":"addVariables"},addVariables:function(){var e=this.$("select").val(),t=this.$("input:text").val(),n=r.PARAM_TYPE.VARIABLE;if(_.isEmpty(t))return $.goMessage(s["\uac12\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694"]),!1;var i=!0;_.each(this.$("#parameter_variablesList .name"),function(e){if($(e).attr("data-name")==t)return i=!1,!1});if(!i)return $.goMessage(s["\ub3d9\uc77c\ud55c variable\uc774 \uc874\uc7ac \ud569\ub2c8\ub2e4"]),!1;this.addItemView({dataType:e,paramName:t,paramType:n}),this.$("input:text").val("")},addItemView:function(e){var t=this,n=e["paramType"]==r.PARAM_TYPE.DOCUMENT;e.isDocument=n;var i=new u({data:e,observer:this.observer});n?this.$("#parameter_documentList").append(i.render().$el):this.$("#parameter_variablesList").append(i.render().$el),i.on("addParameter",function(e){t.trigger("addParameter",e)})},render:function(){this.$el.html(i({lang:s})),_.each(this.parameters,function(e){this.addItemView(e)},this)}});return a});