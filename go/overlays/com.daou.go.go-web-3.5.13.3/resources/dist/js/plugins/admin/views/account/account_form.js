(function(){define(["jquery","backbone","app","views/layouts/admin_default","i18n!nls/commons","i18n!admin/nls/admin","i18n!approval/nls/approval","admin/collections/position_list","admin/collections/grade_list","admin/collections/duty_list","admin/collections/usergroup_list","admin/collections/time_zone","admin/collections/mailgroup_list","admin/collections/user_virtual_domain_list","admin/collections/virtual_domain_list","admin/models/mail_domain_group","models/site_config","hgn!admin/templates/_add_dept_member","hgn!admin/templates/_select_duty","hgn!admin/templates/_user_group_popup","hgn!admin/templates/_add_group_member","hgn!admin/templates/_add_alternate_email","hgn!admin/templates/_add_user_virtual_domain","file_upload","jquery.go-validation","jquery.go-orgslide","jquery.go-popup","jquery.go-sdk"],function(e,t,n,r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N=Backbone.Collection.extend({url:n.contextRoot+"ad/api/approval/securitylevel"}),C=Backbone.View.extend({type:{locale_ko:o.KO,locale_en:o.EN,locale_jp:o.JP,locale_zhcn:o["ZH-CN"],locale_zhtw:o["ZH-TW"],locale_vi:o.VI,basic_info:o["\uae30\ubcf8\uc815\ubcf4"],photo:s["\uc0ac\uc9c4"],photo_upload:s["\uc0ac\uc9c4 \uc62c\ub9ac\uae30"],photo_profile:o["\ud504\ub85c\ud544 \uc0ac\uc9c4"],photo_size_info:o["100x100 \uc0ac\uc774\uc988"],name:s["\uc774\ub984"],lable_nomal_class:o["\ud074\ub798\uc2a4"],position:o["\uc9c1\uc704"],position_select:o["\uc9c1\uc704 \uc120\ud0dd"],grade:o["\uc9c1\uae09"],grade_select:o["\uc9c1\uae09 \uc120\ud0dd"],mail:o["\uba54\uc77c\uadf8\ub8f9"],mail_setting:o["\uba54\uc77c\uadf8\ub8f9 \uac1c\ubcc4\uc124\uc815"],dept:o["\ubd80\uc11c"],duty:o["\uc9c1\ucc45"],duty_select:o["\uc9c1\ucc45 \uc120\ud0dd"],dept_add:o["\ubd80\uc11c \ucd94\uac00"],dept_duty_add:o["\ubd80\uc11c-\uc9c1\ucc45 \ucd94\uac00"],user_group:s["\uc0ac\uc6a9\uc790 \uadf8\ub8f9"],join_dept_select:o["\uc870\uc9c1\ub3c4"],user_group_add:o["\uc0ac\uc6a9\uc790 \uadf8\ub8f9 \ucd94\uac00"],auth_info:o["\uc778\uc99d\uc815\ubcf4"],id:o["\uc544\uc774\ub514"],status:o["\uacc4\uc815 \uc0c1\ud0dc"],normal:o["\uc815\uc0c1"],close:o["\uc911\uc9c0"],dormant:o["\uba54\uc77c \ud734\uba74"],id_exist:o["\uc544\uc774\ub514\uac00 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],email_at:o["@"],email_exist:o["\uc774\uba54\uc77c\uc774 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],password:o["\ube44\ubc00\ubc88\ud638"],password_confirm:o["\ube44\ubc00\ubc88\ud638 \ud655\uc778"],password_not_match:o["\ube44\ubc00\ubc88\ud638 \ubd88\uc77c\uce58"],employee_no:o["\uc778\uc2dd\ubc88\ud638(\uc0ac\ubc88/\ud559\ubc88)"],employee_no_exist:o["\uc0ac\ubc88\uc774 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],timezone:o["\ud0c0\uc784\uc874"],language:o["\uc5b8\uc5b4"],more_info:o["\ubd80\uac00\uc815\ubcf4"],direct_tel:o["\uc9c1\ud1b5\uc804\ud654"],phone:o["\ud578\ub4dc\ud3f0"],representive_tel:o["\ub300\ud45c\uc804\ud654"],fax:o["\ud329\uc2a4"],selfInfo:o["\uc790\uae30\uc18c\uac1c"],info_add:o["\ud56d\ubaa9\ucd94\uac00"],info_add_select:o["\ucd94\uac00\ud560 \ud56d\ubaa9\uc744 \uc120\ud0dd\ud558\uc138\uc694."],location:o["\uc704\uce58"],homepage:o["\ud648\ud398\uc774\uc9c0"],messanger:o["\uba54\uc2e0\uc800"],birthday:o["\uc0dd\uc77c"],anniversary:o["\uae30\ub150\uc77c"],address:o["\uc8fc\uc18c"],memo:o["\uba54\ubaa8"],self_info:o["\uc790\uae30\uc18c\uac1c"],job:o["\uc9c1\ubb34"],save_and_continue:o["\uc800\uc7a5 \ud6c4 \uacc4\uc18d\ud574\uc11c \ucd94\uac00"],account_add:o["\uacc4\uc815 \ucd94\uac00 \ub4f1\ub85d"],save:s["\uc800\uc7a5"],cancel:s["\ucde8\uc18c"],saveSuccess:s["\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],error:s["\uc624\ub958"],ko:s["\ud55c\uad6d\uc5b4"],en:s["\uc601\uc5b4"],jp:s["\uc77c\ubcf8\uc5b4"],zh_cn:s["\uc911\uad6d\uc5b4 \uac04\uccb4"],zh_tw:s["\uc911\uad6d\uc5b4 \ubc88\uccb4"],vi:s["\ubca0\ud2b8\ub0a8\uc5b4"],addMember:o["\ubd80\uc11c \ucd94\uac00"],addMemberSelect:o["\ubd80\uc11c\ucd94\uac00 \uc548\ub0b4\uba54\uc138\uc9c0"],userGroup:s["\uc0ac\uc6a9\uc790 \uadf8\ub8f9"],addUserGroup:o["\uc0ac\uc6a9\uc790 \uadf8\ub8f9 \ucd94\uac00"],duplicateId:o["\uc544\uc774\ub514\uac00 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],duplicateEmployeeNo:o["\uc0ac\ubc88\uc774 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."],selectDeptError:o["\ubd80\uc11c\ub97c \uc120\ud0dd\ud574 \uc8fc\uc2ed\uc2dc\uc624."],confirm:s["\ud655\uc778"],isAlreadyExistMember:o["\uc774\ubbf8 \uc18c\uc18d\ub41c \ubd80\uc11c\uc785\ub2c8\ub2e4."],isAlreadyExistGroup:o["\ud574\ub2f9 \uc0ac\uc6a9\uc790\uadf8\ub8f9\uc740 \uc774\ubbf8 \ucd94\uac00\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."],requireData:s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."],saveFail:s["\uc800\uc7a5\uc5d0 \uc2e4\ud328 \ud558\uc600\uc2b5\ub2c8\ub2e4."],fail_mail_group:o["\uba54\uc77c\uadf8\ub8f9 API\uc5f0\ub3d9 \uc2e4\ud328"],edit_password:o["\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"],approval_date:u["\uacb0\uc7ac\uc77c"],upload_sign:u["\uc11c\uba85 \uc62c\ub9ac\uae30"],mail_group_personal_config:o["\uba54\uc77c\uadf8\ub8f9 \uac1c\ubcc4\uc124\uc815"],add_mail_quota:o["\uba54\uc77c\ud568 \ucd94\uac00 \uc6a9\ub7c9"],quota_excess_warning:o["\uc6a9\ub7c9 \ucd08\uacfc \uacbd\uace0\ubc1c\uc1a1"],quota_excess_warning_ratio:o["\uc6a9\ub7c9 \ucd08\uacfc \uacbd\uace0\ube44\uc728"],quota_excess_mode:o["\uc6a9\ub7c9 \ucd08\uacfc\uc2dc \uc870\uce58"],quota_excess_ratio:o["\uc6a9\ub7c9 \ucd08\uacfc \ud5c8\uc6a9\ube44\uc728"],not_use:o["\uc0ac\uc6a9\uc548\ud568"],use:s["\uc0ac\uc6a9"],allow_group_config:o["\uadf8\ub8f9 \uc124\uc815\uc5d0 \ub530\ub984"],add_webfolder_quota:o["\uc790\ub8cc\uc2e4 \ucd94\uac00 \uc6a9\ub7c9"],mail_service:o["\uba54\uc77c \uc11c\ube44\uc2a4"],default_mailbox_expired:o["\uae30\ubcf8\uba54\uc77c\ud568 \uc720\ud6a8\uae30\uac04"],trash_expired:o["\ud734\uc9c0\ud1b5 \uc720\ud6a8\uae30\uac04"],spam_expired:o["\uc2a4\ud3a8\uba54\uc77c\ud568 \uc720\ud6a8\uae30\uac04"],maximum_message_size:o["\uc1a1\uc2e0\uba54\uc77c \ucd5c\ub300\ud06c\uae30"],unlimited:o["\ubb34\uc81c\ud55c"],days:o["\uc77c\ub2e8\uc704"],not_select:o["\uadf8\ub8f9 \uc124\uc815\uc5d0 \ub530\ub984"],input:o["\uc9c1\uc811\uc785\ub825"],alias_mail_id:o["\uac00\uc0c1 \uba54\uc77c \uc544\uc774\ub514"],email_etc_config:o["\ubd80\uac00 \uae30\ub2a5"],forwarding_mode:o["\uc790\ub3d9 \uc804\ub2ec \ubaa8\ub4dc"],hidden_forwarding_mode:o["\uc228\uae40 \uc804\ub2ec \ubaa8\ub4dc"],save_mail_on_server:o["\uc11c\ubc84\uc5d0 \uba54\uc77c \uc6d0\ubcf8 \ub0a8\uaca8\ub450\uae30"],delete_mail_on_server:o["\uc11c\ubc84\uc5d0 \uba54\uc77c \uc6d0\ubcf8 \uc0ad\uc81c\ud558\uae30"],return_text:o["\ubc18\uc1a1"],temporary_save:o["\uc784\uc2dc\uc800\uc7a5"],add:s["\ucd94\uac00"],delete_text:s["\uc0ad\uc81c"],invalid_email_id:o["\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \uc774\uba54\uc77c\uc785\ub2c8\ub2e4."],mail_expire_date:o["\uacc4\uc815 \uc0ac\uc6a9 \ub9cc\ub8cc\uc77c"],user_virtual_domain:o["\uc0ac\uc6a9\uc790 \ubcc4 \uac00\uc0c1\ub3c4\uba54\uc778"],mail_sender_mode:o["\ubcf4\ub0b4\ub294 \uba54\uc77c \uc8fc\uc18c \ucd94\uac00"],mail_sender_name:o["\ubcf4\ub0b4\ub294 \uc0ac\ub78c \uc774\ub984"],email:s["\uc774\uba54\uc77c"],hurigana:o["\uc774\ub984 \ud6c4\ub9ac\uac00\ub098"],limit_send:o["\uc1a1\uc2e0\uc81c\ud55c"],no_select:o["\uc120\ud0dd\uc548\ud568"],apply_otp:o["OTP \uc0ac\uc6a9 \uc5ec\ubd80"],use_abbroad_ip_check:o["\ud574\uc678 \ub85c\uadf8\uc778 \ucc28\ub2e8"],rep_user_email:o["\ub300\ud45c \uc774\uba54\uc77c \uc8fc\uc18c"],max_send_mail_count:o["\uc77c\uc77c \uc1a1\uc2e0 \uac1c\uc218 \uc81c\ud55c"],max_trans_number:o["\uc77c\uc77c \ucd5c\ub300 \uc1a1\uc2e0 \uac1c\uc218"],count:o["\uac1c"],approval_info:o["\uc804\uc790\uacb0\uc81c \uc815\ubcf4"],approval_sign_img:o["\uc11c\uba85 \uc774\ubbf8\uc9c0"],approval_password:o["\uacb0\uc7ac \ube44\ubc00\ubc88\ud638"],approval_password_info:o["\u203b \uacb0\uc81c \ube44\ubc00\ubc88\ud638\ub97c \uc124\uc815\ud558\uc9c0 \uc54a\uc744 \uacbd\uc6b0, \uacc4\uc815 \ube44\ubc00\ubc88\ud638\ub85c \uc801\uc6a9\ub429\ub2c8\ub2e4."],approval_grade:o["\ubcf4\uc548\ub4f1\uae09"],modify:s["\ubcc0\uacbd"],change_img:s["\uc774\ubbf8\uc9c0 \ubcc0\uacbd"],select:s["\uc120\ud0dd"],upload_img:s["\uc774\ubbf8\uc9c0 \uc62c\ub9ac\uae30"],not_apply:o["\uc801\uc6a9\ud558\uc9c0 \uc54a\uc74c"],dont_change_status:o["\uc0c1\ud0dc \ubcc0\uacbd\uc774 \ubd88\uac00\ub2a5\ud569\ub2c8\ub2e4. \ub77c\uc774\uc120\uc2a4 \uacc4\uc815\uc218\ub97c \ud655\uc778\ud558\uc138\uc694."],custom_field_title:o["\uc120\ud0dd \uc815\ubcf4"],sendMailAddrDisplay:o["\ubcf4\ub0b4\ub294 \uba54\uc77c \uc8fc\uc18c \ud45c\uc2dc"],select_desc:s["\uc120\ud0dd"],lunar_cal_desc:s["\uc74c\ub825\uc120\ud0dd"],year:s["\ub144"],month:s["\ub2ec"],day:s["\ub0a0"],appr_sign_desc:u["\uc11c\uba85\uc740 \uc774\ubbf8\uc9c0 \ud06c\uae30 \uc548\ub0b4"],id_tooltip:o["\uc544\uc774\ub514 \ud234\ud301"],password_tooltip:o["\ube44\ubc00\ubc88\ud638 \ud234\ud301"],usergroup_tooltip:o["\uc0ac\uc6a9\uc790\uadf8\ub8f9 \ud234\ud301"],mailgroup_tooltip:o["\uba54\uc77c\uadf8\ub8f9 \ud234\ud301"]},isDuplicateLoginId:!1,isDuplicateEmployeeNo:!1,isChangeStatus:!0,initialize:function(t){this.options=t||{},this.positions=a.getCollection(),this.grades=f.getCollection(),this.duties=l.getCollection(),this.timeZone=e.extend(!0,[],h.read().toJSON()),this.userGroup=c.getCollection(),this.mailDomainGroups=p.getCollection(),this.userVirtualDomains=d.getCollection(),this.virtualDomains=v.getCollection(),this.deleteGroupIds=[];var n=new Backbone.Model;n.url=GO.contextRoot+"ad/api/company",n.fetch({async:!1}),this.companyInfo=n.toJSON(),this.hasApproval=g.read({isAdmin:!0}).hasApproval();if(this.hasApproval){var r=new N;r.fetch({async:!1}),this.approvalLevels=r}},events:{"click.account #add_dept_member":"onAddDeptMemberClicked","click.account #add_user_group":"onAddUserGroupClicked","click.account #cancel":"cancel","click.account #dept_members .ic_del":"deleteDeptEl","click.account #addMembers .ic_del":"deleteApprAbsenceEl","click.account #group_members .ic_del":"deleteGroupEl","click.account #quotaWarningMode span input:radio":"quotaWarningModeToggle","click.account #quotaViolationActionMode span input:radio":"quotaViolationActionModeToggle","click.account input:radio[name='maxSendMailCountUse']":"maxSendMailCountUseModeToggle","click.account #addAlternateEmail":"addAlternateEmail","click.account #addUserVirtualDomain":"addUserVirtualDomain","click.account form tr td span.ic_delete":"deleteAlternateEmail","click.account input[name='forwardingUse']":"forwardModeToggle","click.account input[name='sendAllowMode']":"sendAllowModeToggle","click.account #hiddenForwardingMode span input:radio":"hiddenForwardingModeToggle","click.account #addForwardingEmail":"addForwardingEmail","click.account #addSendAllowEmail":"addSendAllowEmail","click.account #addHiddenForwardingEmail":"addHiddenForwardingEmail","mouseup #status_stop":"rememberAccountStatus","click.account #status_stop":"confirmStatusStop","change.account #more_info":"addMoreInfoEl","change.account #mail_config tr td select":"mailSelectBoxToggle","change.account #mailGroup":"changeMailGroup","change.account input:radio[name='status']":"checkUserCount","keyup.account #loginId":"loginIdCheck","keyup.account #employeeNo":"employeeNoCheck","submit form":"formSubmit"},formSubmit:function(e){e.preventDefault();return},quotaWarningModeToggle:function(t){var n=e(t.target);n.val()=="on"?this.$el.find("#quotaWarningModeOnSetting").show():this.$el.find("#quotaWarningModeOnSetting").hide()},hiddenForwardingModeToggle:function(t){var n=e(t.target),r=n.parents("tr").find("#hiddenForwardingList");n.val()!="off"?r.show():r.hide()},forwardModeToggle:function(t){var n=e(t.target),r=n.parents("td").find("#forwardingList");n.val()=="on"?(r.show(),this.$el.find("#forwardingMode_forwarding").val("forwarding"),this.$el.find("#forwardingMode_forwardingonly").val("forwardingonly"),this.$el.find("#forwardingMode_none").val("none"),this.$el.find("#forwardingMode_none").prop("checked",!0)):n.val()=="off"?r.hide():this.mailDomainGroup.get("forwardingUse")=="on"?(r.show(),this.$el.find("#forwardingMode_forwarding").val("forwarding"),this.$el.find("#forwardingMode_forwardingonly").val("forwardingonly"),this.$el.find("#forwardingMode_none").val("none"),this.$el.find("#forwardingMode_none").prop("checked",!0)):r.hide()},sendAllowModeToggle:function(t){var n=e(t.target),r=n.parents("td").find("#sendAllowModeList");n.val()=="on"?r.show():n.val()=="off"?r.hide():r.hide()},changeMailGroup:function(t){this.deleteBeforeGroupSendAllow(this.mailDomainGroup.toJSON()),this.mailDomainGroup=m.read(e(t.target).val()),this.companyMailService=new Backbone.Model,this.companyMailService.url=GO.contextRoot+"ad/api/company/mailservice",this.companyMailService.fetch({async:!1}),this.inheritMailGroupConfig(this.mailDomainGroup.toJSON()),this.inheritDomainMailServiceConfig(this.companyMailService.toJSON())},inheritDomainMailServiceConfig:function(e){var t={mailServiceDataList:["webMail","pop","imap","smtpauth"],targetElIdList:["webmailUsed","popUsed","imapUsed","smtpAuthUsed"]};_.each(t.mailServiceDataList,function(n,r){e[n]||this.$el.find("#"+t.targetElIdList[r]).prop("checked",!1).parent().hide()},this)},inheritMailGroupConfig:function(e){e.sendAllowUse=="on"?this.$el.find("#sendAllowMode").text(" ( "+s["\uc0ac\uc6a9"]+" )"):this.$el.find("#sendAllowMode").text(" ( "+o["\uc0ac\uc6a9\uc548\ud568"]+" )"),this.$el.find("input[name='sendAllowMode']:checked").val()=="group"&&this.$el.find("#sendAllowModeList").hide();var t=[];if(e.sendAllowList!=undefined){for(var n=0;n<e.sendAllowList.length;n++)if(!this.isSavedGroupAllowList(e.sendAllowList[n])){var r={type:{name:"sendAllowEmail",emailInfo:e.sendAllowList[n],hideDeleteBtn:!0},data:{emailId:e.sendAllowList[n]}};t.push(S(r))}this.$el.find("#sendAllowModeEmails").append(t.join(""))}e.forwardingUse=="on"?this.$el.find("#forwardingUse").text(" ( "+s["\uc0ac\uc6a9"]+" )"):this.$el.find("#forwardingUse").text(" ( "+o["\uc0ac\uc6a9\uc548\ud568"]+" )"),this.$el.find("input[name='forwardingUse']:checked").val()==""&&(e.forwardingUse=="on"?this.$el.find("#forwardingList").show():this.$el.find("#forwardingList").hide());var i=e.megaMailQuota==undefined?0:e.megaMailQuota;this.$el.find("#groupMailQuota").text(" ( "+o["\uae30\ubcf8\uc81c\uacf5"]+" "+i+"MB )"),this.$el.find("#groupMailQuota").attr("data-max",i);var u=e.megaWebFolderQuota==undefined?0:e.megaWebFolderQuota;this.$el.find("#groupWebFolderQuota").text(" ( "+o["\uae30\ubcf8\uc81c\uacf5"]+" "+u+"MB )"),this.$el.find("#groupWebFolderQuota").attr("data-max",u),e.quotaWarningMode?this.$el.find("#groupQuotaExcessWarning").text(" ( "+s["\uc0ac\uc6a9"]+" )"):this.$el.find("#groupQuotaExcessWarning").text(" ( "+o["\uc0ac\uc6a9\uc548\ud568"]+" )"),e.quotaViolationAction=="return"?this.$el.find("#groupQuotaViolationAction").text(" ( "+o["\ubc18\uc1a1"]+" ) "):this.$el.find("#groupQuotaViolationAction").text(" ( "+o["\uc784\uc2dc\uc800\uc7a5"]+" ) "),e.mailSenderUse=="on"?this.$el.find("#groupMailSenderMode").text(" ( "+s["\uc0ac\uc6a9"]+" ) ").attr("data-use","on"):this.$el.find("#groupMailSenderMode").text(" ( "+o["\uc0ac\uc6a9\uc548\ud568"]+" ) ").attr("data-use","off"),this.setMailServiceCheckbox(e,function(e,t){e.prop("disabled",t).prop("checked",t)});var a=e.megaMailMaxSendSize==undefined?0:e.megaMailMaxSendSize;this.$el.find("#groupMailMaxSendSize").text(" ( "+a+"MB )"),e.maxSendMailCountUse=="on"?this.$el.find("#maxSendMailCountUseCustom").text(" ( "+s["\uc0ac\uc6a9"]+" )"):this.$el.find("#maxSendMailCountUseCustom").text(" ( "+o["\uc0ac\uc6a9\uc548\ud568"]+" )")},setMailServiceCheckbox:function(t,n){var r=["popUsed","smtpAuthUsed","imapUsed","webmailUsed"];_.each(r,function(t){var r=e("#mailServices input[name='"+t+"']");n(r,this[t])},t)},setApprovalConfig:function(e){function r(e){var r="";e!=undefined&&e.approvalSignPath!=undefined?(r=e.approvalSignPath,n.mailInfo.set("approvalSignPath",r)):r=GO.contextRoot+"resources/images/stamp_approved.png",t.find("#approval_sign_img").attr("src",r)}function i(e){var n=t.find("#approval_security_options"),r=[],i;r.push("<option value=''>"+o["\ubcf4\uc548\ub4f1\uae09\uc744 \uc120\ud0dd"]+"</option>"),this.approvalLevels.each(function(t){t.get("useFlag")?i="":i="("+u["\ubbf8\uc0ac\uc6a9"]+")",e!=undefined&&e.approvalLevel==t.get("level")?r.push("<option value='"+t.get("level")+"' selected>"+t.get("name")+i+"</options>"):r.push("<option value='"+t.get("level")+"'>"+t.get("name")+i+"</options>")}),n.html(r)}var t=this.$el.find("#approval_content"),n=this;r.call(this,e),i.call(this,e)},quotaViolationActionModeToggle:function(t){var n=e(t.target);n.val()==""?this.$el.find("#quotaViolationActionModeSetting").hide():this.$el.find("#quotaViolationActionModeSetting").show()},maxSendMailCountUseModeToggle:function(t){var n=e(t.target);n.val()=="on"?this.$el.find("#maxSendMailCount").show():this.$el.find("#maxSendMailCount").hide()},mailSelectBoxToggle:function(t){var n=e(t.currentTarget);n.val()=="custom"?n.parent("td").find("span").show():n.parent("td").find("span").hide()},onAddUserGroupClicked:function(){var t=this;this.userGroup==undefined&&(this.userGroup=c.getCollection()),this.userGroupPopup=e.goPopup({header:t.type.addUserGroup,width:260,modal:!1,appendTarget:t.$el.find("form"),allowPrevPopup:!0,buttons:[{btext:s["\ud655\uc778"],btype:"confirm",callback:e.proxy(this.addUserGroup,this)},{btext:s["\ucde8\uc18c"]}],contents:w({type:this.type,userGroup:this.userGroup.toJSON()})})},rememberAccountStatus:function(){this.statusBeforeClickStop=this.$el.find("#account_status input[type='radio']:checked").val()},confirmStatusStop:function(){var t=this,n=t.mailInfo?t.mailInfo.toJSON().admin:!1,r;n?r=e.goAlert(o["\uacc4\uc815 \uc911\uc9c0 \uc624\ub958"],o["\uad00\ub9ac\uc790 \uc911\uc9c0 \uc624\ub958 \uc124\uba85"],function(){var e=t.mailInfo?t.mailInfo.toJSON().status:t.statusBeforeClickStop;t.$el.find("input[name='status'][value="+e+"]").prop("checked",!0)}):r=e.goConfirm(o["\uacc4\uc815\uc911\uc9c0\uc2dc \ubd80\uc11c\uc815\ubcf4\uc0ad\uc81c"],o["\uc911\uc9c0\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"],function(){t.$el.find("#dept_members").children(".dept_member").remove()},function(){var e=t.mailInfo?t.mailInfo.toJSON().status:t.statusBeforeClickStop;t.$el.find("input[name='status'][value="+e+"]").prop("checked",!0)},s["\ud655\uc778"]),r.css("width","420px")},addUserGroup:function(){var t=this.$el.find("#user_group_select :selected");if(t.val()==""){e.goMessage(o["\ucd94\uac00\ud560 \ud56d\ubaa9\uc744 \uc120\ud0dd\ud558\uc138\uc694."]);return}return this._isExistGroup(t.val())?e.goMessage(this.type.isAlreadyExistGroup):(this.$el.find("#group_members").prepend(E({id:t.val(),name:t.text(),del:s["\uc0ad\uc81c"]})),this.userGroupPopup.remove()),!1},onAddDeptMemberClicked:function(t){var n=this;if(this.$el.find("#status_stop").is(":checked")){e.goMessage(o["\uc911\uc9c0\ub41c\uacc4\uc815 \ubd80\uc11c\ucd94\uac00\ubd88\uac00\ub2a5"]);return}e.goOrgSlide({header:n.type.dept_duty_add,isAdmin:!0,type:"department",externalLang:s,contextRoot:GO.contextRoot,desc:n.type.addMemberSelect,target:t,zIndex:200,buttons:[{btext:n.type.confirm,bclass:"btn_major_s",autoClose:!0,callback:e.proxy(this.addDeptMember,this)}]}),e("#orgTree").after(b({data:this.duties.toJSON(),selectDuty:o["\uc9c1\ucc45 \uc120\ud0dd"],nonCheck:o["\ubbf8\uc9c0\uc815"]}))},addDeptMember:function(t){function o(t){if(!_.isUndefined(t))return;throw e.goMessage(this.type.selectDeptError),new Error(this.type.selectDeptError)}function u(e,t){function u(e,t,n){return y({member:e,dept:t,duty:n,del:s["\uc0ad\uc81c"]})}var r={},i=n.$el.find("#dept_members input[name=deptId][value="+e.id+"]");if(!_.isEmpty(i)){var o=i.closest("li");r.id=o.find("input[name=memberId]").attr("value"),o.replaceWith(u(r,e,t))}else n.$el.find("#dept_members > li:last").before(u(r,e,t))}function a(){var e=this.$("#duty").find(":selected"),t={name:""};return _.isEmpty(e.val())||(t.name=e.text(),t.id=e.val()),t}o(t.id);var n=this,r=a(),i={id:t.id,name:t.name};_.isEmpty(r.name)||(i.name=i.name+" - "+r.name),u(i,r),this.enableDeptMembersDraggable()},enableDeptMembersDraggable:function(){this.$el.find("#dept_members").disableSelection().sortable({axis:"x",items:"> li.dept_member"})},deleteDeptEl:function(t){var n=e(t.target),r=n.attr("value");n.parent().parent().remove()},deleteApprAbsenceEl:function(t){e(t.currentTarget).parents("li").remove()},deleteGroupEl:function(t){var n=e(t.target),r=n.attr("value");r!=undefined&&this.deleteGroupIds.push(n.attr("value")),n.parent().parent().remove()},_isExistGroup:function(e){var t=this.$("#group_members").find("input[name=userGroupId]"),n=[];for(var r=0;r<t.length;r++)n.push(t[r].value);return n.length==0||_.indexOf(n,e.toString())<0?!1:!0},_isExistDept:function(e){var t=this.$("#dept_members").find("input[name=deptId]"),n=[];for(var r=0;r<t.length;r++)n.push(t[r].value);return n.length==0||_.indexOf(n,e.toString())<0?!1:!0},loginIdCheck:function(){this.isDuplicateLoginId=!1;var t=this,n=this.$el.find("#loginId").val(),r={emailId:n,userId:this.options==undefined?"":this.options.userId};if(e.trim(n)==""){this.$el.find("#id_error_message").hide();return}try{this.__validateLoginId(r.emailId)}catch(i){console.info("invalid login id !!");return}this.isDuplicateEmailId(r,function(){t.isDuplicateLoginId=!1,t.$el.find("#id_error_message").hide()},function(){t.isDuplicateLoginId=!0,t.$el.find("#id_error_message").show()}),this.changeRepresentationEmail()},addAlternateEmail:function(){var t=this,n=this.$el.find("#alternateEmail").val().toLowerCase(),r=this.companyInfo.domainName,i={emailId:n,domainName:r};if(e.trim(n)==""){e.goMessage(o["\ucd94\uac00\ud560 \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694."]),this.$el.find("#alternateEmail").focus();return}if(e.goValidation.isInvalidEmailId(n)){e.goMessage(o["\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \uc774\uba54\uc77c\uc785\ub2c8\ub2e4."]),this.$el.find("#alternateEmail").focus();return}var u=this.$el.find("#alternateEmails li"),a=!1;e.each(u,function(t){if(e(this).find('[name="alternateEmailId"]').val()==n){a=!0;return}});if(a)return;this.isDuplicateEmailId(i,function(){var e={type:{name:"alternateEmailId",emailInfo:n,del:s["\uc0ad\uc81c"]},data:{emailId:n}};t.$el.find("#alternateEmail").val(""),t.$el.find("#alternateEmails").append(S(e)),t.changeRepresentationEmail()})},addSendAllowEmail:function(t){var n=e(t.target).parents("td"),r=n.find("input:text"),i=n.find("ul.list_option");if(e.trim(r.val())==""){e.goMessage(o["\ucd94\uac00\ud560 \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694."]),e(r).focus();return}if(e.goValidation.isInvalidEmail(r.val())&&!this.validateAllowDomain(r.val())){e.goMessage(o["\ub3c4\uba54\uc778 \ud639\uc740 \uc774\uba54\uc77c \ud615\uc2dd\uc774 \uc798\ubabb\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),e(r).focus();return}var s={type:{name:r.attr("id"),emailInfo:r.val()},data:{emailId:r.val()}};r.val(""),e(i.append(S(s)))},validateAllowDomain:function(t){return"@"!==t.charAt(0)?!1:e.goValidation.isValidDomain(t.substring(1))?!0:!1},addUserVirtualDomain:function(t){var n=this.$el.find("#userVirtualDomain option:selected").val(),r=this.$el.find("#userVirtualDomains li"),i=!1;e.each(r,function(t){if(e(this).find('[name="userVirtualDomain"]').val()==n){i=!0;return}});if(i)return;if(e.trim(n)==""){e.goMessage(o["\ucd94\uac00\ud560 \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694."]),this.$el.find("select#userVirtualDomain").focus();return}var s={type:{name:"userVirtualDomain",userVirtualDomain:n},data:{userVirtualDomain:n}};this.$el.find("ul#userVirtualDomains").append(x(s)),this.changeRepresentationEmail()},addHiddenForwardingEmail:function(t){var n=e(t.target).parents("td"),r=n.find("input:text"),i=n.find("ul.list_option");if(e.trim(r.val())==""){e.goMessage(o["\ucd94\uac00\ud560 \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694."]),e(r).focus();return}if(e.goValidation.isInvalidEmail(r.val())){e.goMessage(o["\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \uc774\uba54\uc77c\uc785\ub2c8\ub2e4."]),e(r).focus();return}var s={type:{name:r.attr("id"),emailInfo:r.val().toLowerCase()},data:{emailId:r.val().toLowerCase()}};r.val(""),e(i.append(S(s)))},addForwardingEmail:function(t){var n=e(t.target).parents("td"),r=n.find("input:text"),i=n.find("ul.list_option");if(e.trim(r.val())==""){e.goMessage(o["\ucd94\uac00\ud560 \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694."]),e(r).focus();return}if(e.goValidation.isInvalidEmail(r.val())){e.goMessage(o["\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \uc774\uba54\uc77c\uc785\ub2c8\ub2e4."]),e(r).focus();return}var s={type:{name:r.attr("id")+"Id",emailInfo:r.val().toLowerCase()},data:{emailId:r.val().toLowerCase()}};r.val(""),e(i.append(S(s)))},isDuplicateEmailId:function(t,n,r){var i=GO.contextRoot+"ad/api/user/idcheck";e.go(i,t,{qryType:"GET",contentType:"application/json",responseFn:function(e){e.code==="200"&&n()},error:function(t,n,i){r!=undefined?r():e.goMessage(o["\uc544\uc774\ub514\uac00 \uc911\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."])}})},employeeNoCheck:function(){var t={employeeNo:this.$el.find("#employeeNo").val(),userId:this.options==undefined?"":this.options.userId},n=GO.contextRoot+"ad/api/user/employeenocheck",r=this;if(e.trim(t["employeeNo"])==""){this.$el.find("#employee_no_exist").hide();return}e.go(n,t,{qryType:"GET",contentType:"application/json",responseFn:function(e){e.code==="200"&&(r.isDuplicateEmployeeNo=!1,r.$el.find("#employee_no_exist").hide())},error:function(e,t){r.isDuplicateEmployeeNo=!0,r.$el.find("#employee_no_exist").show()}})},__dummyGetMailGroup:function(e,t){var n={mailQuota:"1024",webFolderQuota:"2048"};t(n)},__getMailGroup:function(t,n){var r=GO.contextRoot+"ad/api/mailgroup",i={name:t},s={};return e.go(r,i,{qryType:"GET",async:!0,contentType:"application/json",responseFn:function(e){e.code==="200"&&n(e.data)},error:function(){e.goMessage("defaultGroupInfo Error")}}),s},isFormInvalid:function(t){var n=new k;this.$el.find("p.go_alert").remove(),this.__validateName(n),this.__validateMultiName(n),this.__validateNameHurigana(n),this.__validateFormLoginId(n),this.__validateEmployeeNo(n),this.__validationStatus(n),this.__validationMailGroup(n),t.password&&this.__validatePassword(n),this.__validationMailInfo(n),t.apprPassword&&this.__validateApprPassword(n),this.hasApproval&&this.__validationApprGrade(n),this.__validationMailExpireDate(n),this.__validateApprAbsence(n),this.__validateJob(n);if(n.hasError())throw e.each(n.getErrors(),function(e,t){e==0&&t.el.focus(),t.el.parents(":first").append("<p class='go_alert'>"+t.message+"</p>")}),new Error(400,"")},__validationApprGrade:function(t){var n=this.$el.find("#approval_security_options");e.trim(n.val())==""&&t.add(n,o["\ubcf4\uc548\ub4f1\uae09\uc744 \uc120\ud0dd\ud574 \uc8fc\uc138\uc694."])},__validationMailExpireDate:function(e){var t=this.$el.find("#mailExpireDate").val(),n=new Date,r=n.getFullYear()+"",i=n.getMonth()+1<10?"0"+(n.getMonth()+1):""+(n.getMonth()+1),s=n.getDate()<10?"0"+n.getDate():n.getDate(),u=r+i+s,a=this.$el.find('input[name="status"]:checked').val();this.$el.find("#mailExpireDate").val()!=""&&t<u&&a!="stop"&&e.add(this.$el.find('input[name="status"]:radio[value="stop"]'),o["\uacc4\uc815\ub9cc\ub8cc\uc77c\uc778\uacbd\uc6b0\uc0c1\ud0dc\uacbd\uace0"])},__validateApprAbsence:function(e){this.$("#absenceSettingBtn").hasClass("openSetting")&&((this.$("#startDate").val()==""||this.$("#endDate").val()=="")&&e.add(this.$("#absenceSetting"),o["\ubd80\uc7ac \uae30\uac04\uc744 \uc124\uc815\ud574 \uc8fc\uc138\uc694"]),this.$("[name=absenceContent]").val()==""&&e.add(this.$("#absenceSetting"),o["\ubd80\uc7ac \uc0ac\uc720\ub97c \uc124\uc815\ud574 \uc8fc\uc138\uc694"]),this.$("#addMembers").find("li").not(".creat").length==0&&e.add(this.$("#absenceSetting"),o["\ub300\uacb0\uc790\ub97c \uc120\ud0dd\ud574 \uc8fc\uc138\uc694"]))},__validateNameHurigana:function(t){var r=this.$el.find("#user_name_hurigana");e.trim(r.val())!=""&&!e.goValidation.isCheckLength(1,64,r.val())&&t.add(r,n.i18n(s["0\uc790\uc774\uc0c1 0\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:1,arg2:64}))},__validateName:function(t){var n=this.$el.find("input[name='name']");e.trim(n.val())==""&&t.add(n,this.type.requireData)},__validateJob:function(t){var r=this.$el.find("input[name='job']");if(r.length==0)return;var i=r.val();e.goValidation.isCheckLength(0,150,i)||t.add(r,n.i18n(o["0\uc790\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:"150"}))},__validateMultiName:function(t){var r=this,i=["koName","enName","jpName","zhcnName","zhtwName"];_.forEach(i,function(i){var s=r.$el.find("input[name='"+i+"']"),u=s.val();u!=undefined&&u.length>0&&(e.goValidation.isCheckLength(1,64,u)||t.add(s,n.i18n(o["{{arg1}}\uc740(\ub294) {{arg2}}\uc790\uc774\uc0c1 {{arg3}}\uc774\ud558 \uc785\ub825\ud574\uc57c\ud569\ub2c8\ub2e4."],{arg1:r.type.name+"("+r.type.locale_ko+")",arg2:"1",arg3:"64"})))})},__validatePassword:function(e){var t=this.$("#password").find("input[type=password]"),n=this.$("#password_confirm").find("input[type=password]");t.val()==""?e.add(t,this.type.requireData):n.val()==""?e.add(n,this.type.requireData):t.val()!==n.val()&&e.add(n,this.type.password_not_match)},__validateApprPassword:function(e){var t=this.$("#approval_content").find("input[type=password]");t.val()==""&&e.add(t,this.type.requireData)},__validateFormLoginId:function(e){this.__validateLoginId(e),this.isDuplicateLoginId&&e.add(this.$el.find("#loginId"),this.type.duplicateId)},__validateLoginId:function(t){var n=this.$el.find("#loginId").val();e.trim(n)==""?t.add(this.$el.find("#loginId"),this.type.requireData):e.goValidation.isInvalidEmailId(n)&&t.add(this.$el.find("#loginId"),this.type.invalid_email_id)},__validateEmployeeNo:function(t){var n=this.$el.find("#employeeNo").val();if(e.trim(n)=="")return;this.isDuplicateEmployeeNo&&t.add(this.$el.find("#employeeNo"),this.type.duplicateEmployeeNo)},__validationMailGroup:function(e){this.$el.find("#mailGroup").val()==null&&e.add(this.$el.find("#mailGroup"),this.type.fail_mail_group)},__validationStatus:function(e){this.isChangeStatus||(e.add(this.$el.find("#status_dormant").parent("span"),this.type.dont_change_status),this.$el.find("#status_stop").focus())},__validationMailInfo:function(t){var r=this.$el.find("input:text[name='mailAddQuota']"),i=this.$el.find("input:text[name='webFolderAddQuota']"),u=this.$el.find("#mailMaxSendSize"),a=this.$el.find("input:text[name='quotaWarningRatio']"),f=this.$el.find("input:text[name='quotaOverlookRatio']"),l=this.$el.find("#inboxExpireDaysCustom"),c=this.$el.find("#trashExpireDaysCustom"),h=this.$el.find("#spamExpireDaysCustom"),p=this.$el.find("select[name='inboxExpireDays'] option:selected").val(),d=this.$el.find("select[name='trashExpireDays'] option:selected").val(),v=this.$el.find("select[name='spamExpireDays'] option:selected").val(),m=this.$el.find("input:text[name='maxSendMailCount']");repTelEl=this.$el.find("input:text[name='repTel']"),directTelEl=this.$el.find("input:text[name='directTel']"),mobileNoEl=this.$el.find("input:text[name='mobileNo']"),faxEl=this.$el.find("input:text[name='fax']"),birthdayEl=this.$el.find("input:text[name='birthday']"),anniversaryEl=this.$el.find("input:text[name='anniversary']"),ADD_MAX_MAIL_QUATA=122880,ADD_MIN_MAIL_QUATA=0,ADD_MAX_WEBFOLDER_QUATA=10240,ADD_MIN_WEBFOLDER_QUATA=0,ADD_MAX_DAYS=365,ADD_MIN_DAYS=1,e.trim(r.val())==""?t.add(r,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):e.goValidation.isNumber(r.val())?(r.val()>ADD_MAX_MAIL_QUATA||r.val()<ADD_MIN_MAIL_QUATA)&&t.add(r,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:ADD_MIN_MAIL_QUATA,arg2:ADD_MAX_MAIL_QUATA})):t.add(r,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]),e.trim(i.val())==""?t.add(i,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):e.goValidation.isNumber(i.val())?(i.val()>ADD_MAX_WEBFOLDER_QUATA||i.val()<ADD_MIN_WEBFOLDER_QUATA)&&t.add(i,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:ADD_MIN_WEBFOLDER_QUATA,arg2:ADD_MAX_WEBFOLDER_QUATA})):t.add(i,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]),this.$el.find('input:radio[name="quotaWarningMode"]:checked').val()=="on"&&(e.trim(a.val())==""?t.add(a,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):e.goValidation.isNumber(a.val())?(a.val()>100||a.val()<0)&&t.add(a,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:0,arg2:100})):t.add(a,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."])),this.$el.find('input:radio[name="quotaViolationAction"]:checked').val()=="return"&&(e.trim(f.val())==""?t.add(f,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):e.goValidation.isNumber(f.val())?(f.val()>100||f.val()<0)&&t.add(f,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:0,arg2:100})):t.add(f,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."])),this.$el.find('input:radio[name="maxSendMailCountUse"]:checked').val()=="on"&&(m.val()==""?t.add(m,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):e.goValidation.isNumber(m.val())?(m.val()>1e6||m.val()<1)&&t.add(m,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:1,arg2:1e6})):t.add(m,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."])),p=="custom"&&e.trim(l.val())==""?t.add(l,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):p=="custom"&&!e.goValidation.isNumber(l.val())?t.add(l,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]):p=="custom"&&(l.val()>ADD_MAX_DAYS||l.val()<ADD_MIN_DAYS)&&t.add(l,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:ADD_MIN_DAYS,arg2:ADD_MAX_DAYS})),d=="custom"&&e.trim(c.val())==""?t.add(c,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):d=="custom"&&!e.goValidation.isNumber(c.val())?t.add(c,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]):d=="custom"&&(c.val()>ADD_MAX_DAYS||c.val()<ADD_MIN_DAYS)&&t.add(c,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:ADD_MIN_DAYS,arg2:ADD_MAX_DAYS})),v=="custom"&&e.trim(h.val())==""?t.add(h,s["\ud544\uc218\ud56d\ubaa9\uc744 \uc785\ub825\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."]):v=="custom"&&!e.goValidation.isNumber(h.val())?t.add(h,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."]):v=="custom"&&(h.val()>ADD_MAX_DAYS||h.val()<ADD_MIN_DAYS)&&t.add(h,n.i18n(o["\uc785\ub825\ubc94\uc704\uc54c\ub9bc"],{arg1:ADD_MIN_DAYS,arg2:ADD_MAX_DAYS})),e.trim(repTelEl.val())&&!e.goValidation.isPhoneType(repTelEl.val())&&t.add(repTelEl,o["\uc804\ud654\ubc88\ud638\ud5c8\uc6a9\ubb38\uc790"]),e.trim(directTelEl.val())&&!e.goValidation.isPhoneType(directTelEl.val())&&t.add(directTelEl,o["\uc804\ud654\ubc88\ud638\ud5c8\uc6a9\ubb38\uc790"]),e.trim(mobileNoEl.val())&&!e.goValidation.isPhoneType(mobileNoEl.val())&&t.add(mobileNoEl,o["\uc804\ud654\ubc88\ud638\ud5c8\uc6a9\ubb38\uc790"]),e.trim(faxEl.val())&&!e.goValidation.isPhoneType(faxEl.val())&&t.add(faxEl,o["\uc804\ud654\ubc88\ud638\ud5c8\uc6a9\ubb38\uc790"]);if(_.isEmpty(u.val()))return;e.goValidation.isNumber(u.val())?Number(u.val())>this.mailDomainGroup.get("megaMailMaxSendSize")&&t.add(u,o["\uc1a1\uc2e0\uba54\uc77c \ud06c\uae30 \uc54c\ub9bc"]):t.add(u,o["\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694."])},cancel:function(){this.goList()},addMoreInfoEl:function(t){e("#"+t.target.value).show(),e(t.target).find(":selected").remove(),this.$el.find("#more_info option").size()==1&&(this.$el.find("#addMoreInfo").hide(),this.$el.find("#memo").addClass("last"))},errorMessage:function(t){var n=JSON.parse(t.responseText),r=n.name.split("."),i=r[r.length-1];i=="name"?e("input[name='name']").focus():i=="empno"?e("#employeeNo").focus():i=="mailgroup"?e("mailGroup").focus():i=="id"?e("#loginId").focus():i=="directtel"?e('input[name="directTel"]').focus():i=="reptel"?e('input[name="repTel"]').focus():i=="fax"?e('input[name="fax"]').focus():i=="mobile"?e('input[name="mobileNo"]').focus():i=="location"?e('input[name="location"]').focus():i=="homepage"?e('input[name="homePage"]').focus():i=="messanger"?e('input[name="messanger"]').focus():i=="address"?e('input[name="address"]').focus():i=="memo"?e('input[name="memo"]').focus():i=="info"?e('input[name="selfInfo"]').focus():i=="password"?e('input[name="password"]').focus():i=="namehurigana"?e('input[name="user_name_hurigana"]').focus():i=="job"&&e('input[name="job"]').focus(),e.goMessage(n.message)},deleteAlternateEmail:function(t){e(t.target).parents("li").remove(),this.changeRepresentationEmail()},accountBuilder:function(t){var r=this,i=this.$el.find("form"),s={},a=[],f=[],l=[],c=[],h=[],p=[],d=[],v=[],m={},g=[],y={},b={},w=this.$el.find("#thumbnail_image"),E={filePath:w.attr("data-filepath"),fileName:w.attr("data-filename"),hostId:w.attr("host-id")},S=this.$el.find("#approval_sign_img"),x={filePath:S.attr("data-filepath"),fileName:S.attr("data-filename"),hostId:S.attr("host-id")},T=[];E["filePath"]==undefined&&E["fileName"]==undefined&&(E=null),x["filePath"]==undefined&&x["fileName"]==undefined&&(x=null),e(i.serializeArray()).each(e.proxy(function(o,u){var v=e.trim(u.value);if(u.name=="koName")y[u.name]=v;else if(u.name=="enName")y[u.name]=v;else if(u.name=="jpName")y[u.name]=v;else if(u.name=="zhcnName")y[u.name]=v;else if(u.name=="zhtwName")y[u.name]=v;else if(u.name=="viName")y[u.name]=v;else if(u.name=="memberId")v&&v>0&&(m.id=v);else if(u.name=="deptId")m.deptId=v;else if(u.name=="dutyId")v&&v>0&&(m.dutyId=v),t&&!m.deptId&&(m.deptId=t),a.push(m),m={};else if(u.name=="groupId")f.push({groupId:v});else if(u.name=="alternateEmailId")l.push(u.value);else if(u.name=="userVirtualDomain")c.push(u.value);else if(u.name=="forwardingEmailId")h.push(u.value);else if(u.name=="sendAllowEmail")p.push(u.value);else if(u.name=="hiddenForwardingEmail")d.push(u.value);else if(u.name=="inboxExpireDays")u.value=="custom"?s[u.name]=e.trim(r.$el.find("#inboxExpireDaysCustom").val()):s[u.name]=v;else if(u.name=="trashExpireDays")u.value=="custom"?s[u.name]=e.trim(r.$el.find("#trashExpireDaysCustom").val()):s[u.name]=v;else if(u.name=="spamExpireDays")u.value=="custom"?s[u.name]=e.trim(r.$el.find("#spamExpireDaysCustom").val()):s[u.name]=v;else if(u.name=="anniversary"&&u.value.length>0)s[u.name]=n.util.toISO8601(u.value);else if(u.name=="memo"||u.name=="selfInfo")u.value=u.value.replace(/<br>/gi,""),u.value=u.value.replace(/&nbsp;/gi," "),s[u.name]=u.value;else{if(u.name=="mailSenderName")return!0;if(u.name=="mailSenderEmailId")return!0;u.name=="password"?s[u.name]=i.find("input:password[name='password']").val():u.name=="otpService"?(b.name=u.name,b.value=u.value,b.valueType="boolean",g.push(b),b={}):u.name=="useAbbroadIpCheck"?(b.name=u.name,b.value=u.value,b.valueType="boolean",g.push(b),b={}):u.name=="startDate"?T[0]=e.extend(T[0],{startAt:n.util.toISO8601(u.value)}):u.name=="endDate"?T[0]=e.extend(T[0],{endAt:n.util.toISO8601(n.util.toMoment(u.value).add("days",1).subtract("seconds",1))}):u.name=="absenceContent"?T[0]=e.extend(T[0],{absenceContent:u.value}):u.name=="directTel"?(v=v.replace(/\s/gi,""),s[u.name]=v):u.name=="mobileNo"?(v=v.replace(/\s/gi,""),s[u.name]=v):u.name=="job"?s[u.name]=v:s[u.name]=v}},this)),this.$el.find("#mailSenderListTbody tr.customSenderEmail").each(function(){var t=e(this);v.push({email:t.find("span.senderItem").data("email"),defaultMail:t.find("input:radio[name='defaultMail']").prop("checked"),aliasUser:t.find("span.senderItem").data("alias")})}),s.webmailUsed=this.$el.find("#webmailUsed").prop("checked"),s.popUsed=this.$el.find("#popUsed").prop("checked"),s.imapUsed=this.$el.find("#imapUsed").prop("checked"),s.smtpAuthUsed=this.$el.find("#smtpAuthUsed").prop("checked"),s.additions=y,s.groupMembers=f,s.deptMembers=a,s.attPhoto=E,s.approvalAttPhoto=x,s.alternateAddr=l,s.alternateUserDomain=c,s.forwardingAddr=h,s.sendAllowAddr=p,s.hiddenForwardingAddr=d,s.mailSenders=v,s.configs=g;var N=i.find("#birthdayYear").val(),C=i.find("#birthdayMonth").val(),k=i.find("#birthdayDay").val(),L=N==""||C==""||k=="",A=N==""&&C==""&&k=="";if(N==undefined||L){if(N!=undefined&&this.mailInfo&&this.mailInfo.attributes.birthday!=""&&!A)return e.goAlert(o["\uc0dd\uc77c \uc5f0\uc6d4\uc77c \ubaa8\ub450 \uc785\ub825"]),!1;s.birthday="",s.lunarCal=!1}else{var O=N+"-"+C+"-"+k;s.birthday=n.util.toISO8601(n.util.toMoment(O).add(1,"hours")),s.lunarCal=this.$el.find("#lunarCal").is(":checked")}return this.$el.find("#absenceSettingBtn").hasClass("openSetting")&&(T[0]=e.extend(T[0],{title:GO.i18n(u["{{name}}\ub2d8\uc758 \ubd80\uc7ac\uc815\ubcf4 \uc785\ub2c8\ub2e4."],{name:s.name}),useFlag:!0,deputyUserId:r.$("#addMembers").find("li").attr("data-userid"),deputyUserName:r.$("#addMembers").find("li").attr("data-username"),deputyUserPosition:r.$("#addMembers").find("li").attr("data-userposition")}),s.approvalDeputies=T),s},initProfileUpload:function(){var t=this,n={el:this.$("#swfupload-control"),context_root:GO.contextRoot,mode:"IMAGE",imgTmpl:["<span class='wrap_btn wrap_file_upload'><span class='fileinput-button'>","<span class='ic_adm ic_edit'></span>","<input type='file' name='file' title='{title}' style='height:inherit;' multiple=''/>","</span></span>"].join(""),button_title:s["\uc218\uc815"],button_width:25,button_height:25,progressBarUse:!1,url:"ad/api/file?GOAdminSSOcookie="+e.cookie("GOAdminSSOcookie")};(new T(n)).queue(function(e,t){}).start(function(e,t){}).progress(function(e,t){}).success(function(n,r,i){if(GO.util.fileUploadErrorCheck(r))return e.goMessage(GO.util.serverMessage(r)),!1;var o=r.data,u=o.fileName,a=o.filePath,f=o.hostId,l=o.thumbnail,c=o.fileExt.toLowerCase(),h=new RegExp("(jpeg|jpg|gif|png|bmp)","gi"),p=h.test(c);p?t.$el.find("#thumbnail_image").attr("src",l).attr("data-filepath",a).attr("data-filename",u).attr("host-id",f):e.goMessage(s["\ud3ec\uba67 \uacbd\uace0"])}).complete(function(e,t){}).error(function(e,t){})},initApprovalUpload:function(){var t=this,n={el:this.$("#approval_img_upload"),context_root:GO.contextRoot,button_text:"<span class='buttonText'>"+this.type.upload_sign+"</span>",button_height:26,button_width:78,progressBarUse:!1,url:"ad/api/file?GOAdminSSOcookie="+e.cookie("GOAdminSSOcookie")};(new T(n)).queue(function(e,t){}).start(function(e,t){}).progress(function(e,t){}).success(function(n,r,i){if(GO.util.fileUploadErrorCheck(r))return e.goMessage(GO.util.serverMessage(r)),!1;var o=r.data,u=o.fileName,a=o.filePath,f=o.hostId,l=o.thumbnail,c=o.fileExt.toLowerCase(),h=new RegExp("(jpeg|jpg|gif|png|bmp)","gi"),p=h.test(c);p?t.$el.find("#approval_sign_img").attr("src",l).attr("data-filepath",a).attr("data-filename",u).attr("host-id",f):e.goMessage(s["\ud3ec\uba67 \uacbd\uace0"])}).complete(function(e,t){}).error(function(e,t){})},goList:function(){GO.router.navigate("/accounts",{trigger:!0,replace:!0})},changeRepresentationEmail:function(){var t=this,n=this.$el.find("#repUserEmail option:selected").val(),r=this.makeRepresentationEmail();this.$("#repUserEmail").find("option").remove();if(r==undefined)return;e.each(r,e.proxy(function(e){t.$el.find("#repUserEmail").append("<option value="+r[e]+(r[e]==n?" selected":"")+">"+r[e]+"</option>")},this))},makeRepresentationEmail:function(t){var n=new Array,r=new Array,i=new Array;n.push(this.getDefaultID()),n=n.concat(this.getVirtualEmail());if(n.length==1&&n[0]==""){this.$el.find("#repUserEmail").append("<option value=''>"+o["\ub300\ud45c \uc774\uba54\uc77c \uc8fc\uc18c"]+"</option>");return}return r.push(this.getDefaultDomain()),r=r.concat(this.virtualDomainsToArray()),r=r.concat(this.userVirtualDomainsToArray()),e.each(n,function(t){e.each(r,function(e){i.push(n[t]+"@"+r[e])})}),i},getDefaultID:function(){return loginId=this.$el.find("#loginId").val().toLowerCase()},getDefaultDomain:function(){return domainName=this.companyInfo.domainName},getVirtualEmail:function(){var t=new Array;return e.each(this.$el.find("#alternateEmails li"),function(n,r){t.push(e(this).find('input[name="alternateEmailId"]').val())}),t},virtualDomainsToArray:function(){var t=this.virtualDomains.toJSON(),n=new Array;return e.each(t,function(e){n.push(t[e].virtualDomain)}),n},userVirtualDomainsToArray:function(){var t=new Array;return e.each(this.$el.find("#userVirtualDomains li"),function(n,r){t.push(e(this).find('input[name="userVirtualDomain"]').val())}),t},isSavedGroupAllowList:function(t){var n=!1;return e.each(this.$el.find("ul#sendAllowModeEmails li"),function(r){t==e.trim(e(this).find("input").val())&&(n=!0)}),n},deleteBeforeGroupSendAllow:function(t){var n=this;e.each(t.sendAllowList,function(e,t){n.isSavedGroupAllowList(t)&&n.$el.find('#sendAllowModeEmails li input[value="'+t+'"]').parent("li").remove()})},checkUserCount:function(t){var n=this.mailInfo.toJSON(),r=e(t.currentTarget);if(n.status!="stop"||r.attr("id")!="status_online"&&r.attr("id")!="status_dormant")r.parents("td").find("p.go_alert").hide(),this.isChangeStatus=!0;else{var i=this.getAccountCnt(),s=i.userCount-i.usedCount+i.stopUserCount;s<1?(r.parents("td").find("p.go_alert").show(),this.isChangeStatus=!1):(r.parents("td").find("p.go_alert").hide(),this.isChangeStatus=!0)}},getAccountCnt:function(){var t={},n=GO.contextRoot+"ad/api/company/license";return e.go(n,"",{async:!1,qryType:"GET",contentType:"application/json",responseFn:function(e){e.code==="200"&&(t=e.data)},error:function(t){e.goAlert(type.error)}}),t},setBirthday:function(e){var t=1900,r=moment().format("YYYY"),s=1,o=12,u=1,a=31,f="",l="",c="",h=[];e!=undefined&&e!=""&&(h=e.split("-"));for(i=r;i>=t;i--)parseInt(h[0])==i?f+="<option value="+i+" selected = 'selected'>"+i+this.type.year+"</option>":f+="<option value="+i+">"+i+this.type.year+"</option>";for(i=s;i<=o;i++)parseInt(h[1])==i?l+="<option value="+n.util.leftPad(i,2,"0")+" selected = 'selected'>"+i+this.type.month+"</option>":l+="<option value="+n.util.leftPad(i,2,"0")+">"+i+this.type.month+"</option>";for(i=u;i<=a;i++)parseInt(h[2])==i?c+="<option value="+n.util.leftPad(i,2,"0")+" selected = 'selected'>"+i+this.type.day+"</option>":c+="<option value="+n.util.leftPad(i,2,"0")+">"+i+this.type.day+"</option>";this.$el.find("#birthdayYear").append(f),this.$el.find("#birthdayMonth").append(l),this.$el.find("#birthdayDay").append(c)}}),k=Backbone.View.extend({initialize:function(){this.errors=[]},add:function(t,n){var r=typeof t=="string"?e(t):t;this.errors.push({el:r,message:n})},hasError:function(){return this.errors.length>0},getErrors:function(){return this.errors}});return C})}).call(this);