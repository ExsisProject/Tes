(function(){define(["jquery","backbone","app","i18n!nls/commons","i18n!admin/nls/admin","admin/collections/app_admin_list","admin/views/app_admin_list","hgn!admin/templates/calendar_base_config","jquery.go-orgslide","jquery.go-popup","jquery.go-sdk"],function(e,t,n,r,i,s,o,u){var a,f={"\uce98\ub9b0\ub354\ucd94\uac00":i["\uce98\ub9b0\ub354 \ucd94\uac00"],"\uc21c\uc11c\ubc14\uafb8\uae30":i["\uc21c\uc11c \ubc14\uafb8\uae30"],"\uc0ad\uc81c":r["\uc0ad\uc81c"],"\uce98\ub9b0\ub354\uc81c\ubaa9":i["\uce98\ub9b0\ub354 \uc81c\ubaa9"],"\uc6b4\uc601\uc790":i["\uc6b4\uc601\uc790"],"\uacf5\uac1c\ubc94\uc704":i["\uacf5\uac1c \ubc94\uc704"],"\uc124\uc815":i["\uc124\uc815"]},l=t.Collection.extend({url:n.contextRoot+"ad/api/calendar/list"});return a=n.BaseView.extend({el:"#layoutContent",events:{"click #checkedAll":"checkedAll","click #add":"add","click #changeSort":"changeSort","click #changeSortDone":"changeSortDone","click #remove":"remove","click #companyCalendarList span[data-btntype='modify']":"modify"},initialize:function(){this.$el.off(),this.collection=new l},render:function(){this.collection.fetch({async:!1});var e=function(){var e=[];return this.managers.length==0?"-":(_.each(this.managers,function(t){e.push(t.name+" "+t.position)}),e.join(", "))},t=function(){return this.visibility=="public"?r["\uacf5\uac1c"]:r["\ube44\uacf5\uac1c"]};return this.$el.empty().html(u({lang:f,collection:this.collection.toJSON(),managerNames:e,visible:t})),this.$el},add:function(e){n.router.navigate("/calendar/create",!0)},changeSort:function(e){this.$el.find("#changeSort").hide(),this.$el.find("#changeSortDone").show(),this.$el.find("#companyCalendarList tbody").removeClass().sortable({opacity:"1",delay:100,cursor:"move",items:"tr",containment:".admin_content",hoverClass:"ui-state-hover",placeholder:"ui-sortable-placeholder",start:function(e,t){t.placeholder.html(t.helper.html()),t.placeholder.find("td").css("padding","5px 10px")}})},changeSortDone:function(n){var r=this,i=this.$el.find("#companyCalendarList tbody"),s=i.find("tr").map(function(t,n){return e(n).data("id")}).get();this.model=new t.Model,this.model.url=GO.contextRoot+"ad/api/calendar/sort",this.model.save({ids:s},{type:"PUT",success:function(){r.render()}})},remove:function(){var t=n.contextRoot+"ad/api/calendar/remove",s=this.$el.find("#companyCalendarList tbody input:checkbox:checked"),o={ids:[]},u=this;if(s.length==0)return e.goMessage(i["\uce98\ub9b0\ub354\ub97c \uc120\ud0dd\ud574 \uc8fc\uc138\uc694."]);e.goConfirm(i["\uce98\ub9b0\ub354 \uc0ad\uc81c"],i["\uce98\ub9b0\ub354 \uc0ad\uc81c \uc54c\ub9bc"],function(){s.each(function(){o.ids.push(e(this).val())}),e.go(t,JSON.stringify(o),{qryType:"DELETE",contentType:"application/json",responseFn:function(t){e.goMessage(r["\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."]),u.render()},error:function(e){}})})},modify:function(t){var r=e(t.currentTarget),i=r.closest("tr");n.router.navigate("/calendar/"+i.data("id"),!0)},checkedAll:function(t){var n=e(t.currentTarget);n.prop("checked")?this.$el.find("#companyCalendarList input:checkbox").prop("checked",!0):this.$el.find("#companyCalendarList input:checkbox").prop("checked",!1)}},{__instance__:null}),a})}).call(this);