define(["when","i18n!nls/commons","i18n!admin/nls/admin","i18n!approval/nls/approval","admin/views/approval/appr_form_integration/appr_form_integration_input","admin/views/approval/appr_form_integration/appr_form_integration_output"],function(e,t,n,r,i,s){var o={},u=["<div>",'<div style="position: static; left: 0; top: 0;">','<div id="integration_input"></div>','<div id="integration_output"></div>',"</div>","</div>"].join(""),a=Backbone.View.extend({el:".layer_normal.layer_appr_link .content",dataSources:null,initialize:function(e){this.model=e.model,this.model.makeSubModel(),this.observer=_.extend({},Backbone.Events)},events:{},fetchDataSource:function(){var t=this,n=e.defer();return e($.ajax({type:"GET",dataType:"json",url:GO.config("contextRoot")+"ad/api/approval/integration/datasource",success:function(e){t.dataSource=e.data,n.resolve()},error:function(){n.reject()}})).otherwise(function(t){console.log(t.stack)}),n.promise},getData:function(){var e=this.inputView.getData();this.model.set(e.toJSON());var t=this.outputView.getData();return this.model.set(t.toJSON()),this.model},validate:function(){var e=this.inputView.validate(),t=this.outputView.validate();return e&&t},render:function(){var e=Hogan.compile(u);this.$el.html(e.render({lang:o})),this._renderInputView(),this._renderOutputView()},_renderInputView:function(){this.inputView=new i({model:this.model.getInputModel(),dataSource:_.clone(this.dataSource),observer:this.observer}),this.inputView.render()},_renderOutputView:function(){this.outputView=new s({model:this.model.getOutputModel(),dataSource:_.clone(this.dataSource),observer:this.observer}),this.outputView.render()}});return a});