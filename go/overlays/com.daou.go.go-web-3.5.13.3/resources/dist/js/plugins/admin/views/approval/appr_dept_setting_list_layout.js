define(["jquery","underscore","backbone","when","app","hgn!admin/templates/approval/appr_dept_setting_list_layout","hgn!admin/templates/approval/appr_dept_setting_list_item","i18n!nls/commons","i18n!admin/nls/admin","i18n!approval/nls/approval"],function(e,t,n,r,i,s,o,u,a,f){var l={save:u["\uc800\uc7a5"],cancel:u["\ucde8\uc18c"],"\ubd80\uc11c\uba85":a["\ubd80\uc11c\uba85"],"\ubb38\uc11c\ud568":a["\ubb38\uc11c\ud568"],"\uc218\uc2e0\ud568":a["\uc218\uc2e0\ud568"],"\uacf5\ubb38 \ubc1c\uc1a1\ud568":a["\uacf5\ubb38 \ubc1c\uc1a1\ud568"]},c=n.Model.extend({initialize:function(e){this.options=e||{}}}),h=n.Collection.extend({model:c,initialize:function(e){this.options=e||{}},url:function(){return i.config("contextRoot")+"ad/api/approval/deptsetting"}}),p=n.View.extend({tagName:"tr",initialize:function(e){this.options=e||{},this.model=this.options.model},events:{'change input[name="useDocFolder"]':"changeUseDocFolder",'change input[name="useOfficialDocSend"]':"changeUseOfficialDocSend",'change input[name="useReception"]':"changeUseReception"},changeUseDocFolder:function(t){this.model.set("useDocFolder",e(t.currentTarget).is(":checked")),e(t.currentTarget).is(":checked")||(e(t.currentTarget).parents("tr").find("[type=checkbox]").prop("checked",!1),this.model.set("useOfficialDocSend",!1),this.model.set("useReception",!1))},changeUseOfficialDocSend:function(t){this.model.set("useOfficialDocSend",e(t.currentTarget).is(":checked"))},changeUseReception:function(t){this.model.set("useReception",e(t.currentTarget).is(":checked"))},render:function(){return this.model.get("depth")==0&&this.model.set("root",!0),this.model.get("depth")>0&&this.$el.attr("class","dep"+this.model.get("depth")),this.$el.html(o(this.model.toJSON())),this}}),d=n.View.extend({el:".layer_use_set .content",rowViews:null,events:{},initialize:function(e){this.options=e||{},this.rowViews=[],this.collection=new h},render:function(){var e=this,t=r.defer();return this.collection.fetch({success:function(){e.$el.html(s({lang:l})),e.collection.each(function(n){var r=new p({model:n});e.rowViews.push(r),e.$el.find("#deptApprTbody").append(r.render().$el),t.resolve()})},error:function(){console.log("error"),t.reject()}}),t.promise},getData:function(){var e=[];return t.each(this.rowViews,function(t){e.push(t.model.toJSON())}),e}});return d});