define("admin/views/bread_crumbs",function(require){var e=require("backbone"),t=require("hgn!admin/templates/bread_crumbs"),n=require("underscore"),r=require("app"),i=require("i18n!admin/nls/admin"),s=e.View.extend({events:{"click #favorite":"onClickFavorite","click a.path":"movePage"},initialize:function(e,t){this.sideMenuCollection=t,this.currentMenu=e,this.adminMenuKey=e?e.getMenuKey():"",this.menus=[],this.pushMenuArrays(this.currentMenu)},pushMenuArrays:function(e){if(!e)return;e.parentUid&&(this.pushMenuArrays(this.sideMenuCollection.findMenu(e.parentUid)),this.menus[this.menus.length]=this.sideMenuCollection.findMenu(e.parentUid))},render:function(){var e=GO.config("orgSyncWaitMin")>-1;return this.$el.html(t({title:this.getTitleFromMenu(),breadCrumbs:this.breadCrumbs,favorite:this.favorite,isSubMenu:!!this.subMenu,hasSubLabel:!!this.attributes.subLabel&&e,lang:{syncDescription:e?GO.i18n(i[this.attributes.subLabel]||"",{term:GO.config("orgSyncWaitMin")}):""}})),this.renderBreadCrumbs(),this},renderBreadCrumbs:function(){var e=this.$el.find(".content_nav");e.empty();var t="",r=this.subMenu?this.menus.concat([this.currentMenu]):this.menus;n.forEach(r,function(e){if(!e)return;t&&(t+='<span class="separator">/</span>'),e.href?t+='<a class="path" data-link="'+e.href+'">'+e.labelKey+"</a>":t+='<a class="path" data-link="" style="cursor: default">'+e.labelKey+"</a>"}),e.append(t)},getTitleFromMenu:function(){var e=this.currentMenu?this.currentMenu.labelKey:"";return this.subMenu&&this.subMenu.labelKey&&(e+=" > "+this.subMenu.labelKey),e},movePage:function(e){var t=$(e.currentTarget),n=t.attr("data-link");if(!n)return;n.indexOf("/")!==0&&(n="/"+n),r.router.navigate(n,{trigger:!0,pushState:!0})},setSubMenu:function(e,t){this.subMenu={labelKey:e,href:t}},accessMenu:function(){self=this,this.currentMenu.fetch({async:!1,success:function(e){self.favorite=e.getFavorite(),$("body").trigger("recently.menu.updated")}})},onClickFavorite:function(e){this.currentMenu.updateFavorite(!this.currentMenu.favorite);var t=$(e.currentTarget).find(".ic_adm");t.removeClass("ic_favor_off ic_favor_on"),t.addClass(this.currentMenu.favorite?"ic_favor_on":"ic_favor_off")}});return s});