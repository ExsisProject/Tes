define(["jquery","backbone","app","i18n!nls/commons","i18n!admin/nls/admin","i18n!approval/nls/approval","hgn!admin/templates/appr_form_template_editor","admin/views/appr_official_template_list","admin/views/appr_form_template_editor","components/form_component_manager/official_form_manager","formeditor","jquery.go-sdk","jquery.go-popup","jquery.go-grid"],function(e,t,n,r,i,s,o,u,a,f){var l=a.lang;return a.extend({editorOption:{lang:GO.session("locale"),bUseApprovalType:"official",theme:"form-appr-admin"},initialize:function(e){e=_.extend({},e),_.isString(e.htmlContent)&&(this.htmlContent=e.htmlContent),_.isString(e.previewElId)&&(this.previewElId=e.previewElId),this.TemplateListModule=u},render:function(){var t=_.bind(function(e,t){this.model.set("name",e),this.htmlContent=t},this),n=e(".tWrap"),r=new f(_.extend(this.editorOption,{title:this.model.get("name"),isOfficial:!0,content:this.htmlContent,saveCallback:t,toggleEl:n}));n.hide(),e("body").append(r.render().el)},preview:function(t){t=t||this.model.get("templateHtml");var n=e.goPopup({allowPrevPopup:!0,header:l.template_preview,modal:!0,top:"20%",width:810,pclass:"layer_normal layer_doc_edit_preview",contents:'<form><div class="doc_wrap" style="width:780px" class="ie9-scroll-fix" id="'+this.previewElId+'"></div></form>'});t?(e("#"+this.previewElId).setTemplate({data:t}),parseInt(n.css("height"))<100&&n.css("height",100),n.find("div.content").css({"max-height":"500px",overflow:"auto"}),n.reoffset()):(e.goSlideMessage(l.empty_msg,"caution"),n.close())}})});