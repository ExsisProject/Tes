(function(){define(["backbone","hogan","app","hgn!dashboard/templates/search/webfolder_search","views/pagination","dashboard/views/search/search_form","dashboard/views/search/no_search_result","i18n!nls/commons","jquery.go-sdk"],function(e,t,n,r,i,s,o,u){var a={empty_search_results:u["\uac80\uc0c9\uacb0\uacfc\uc5c6\uc74c"],more:u["\ub354\ubcf4\uae30"],file:u["\uc790\ub8cc\uc2e4"]},f=s.extend({events:{"click #btn_more":"showMore","click #downFiles":"downloadFile","click #moveFile":"moveFileDetail"},initialize:function(){this.$el.off(),this.fileResources=null,this.param=GO.router.getSearch(),_.extend(this.param,{keyWord:this.param.keyword,fullPath:"/",offset:this.param.offset||5,currentPage:parseInt(this.param.page)+1||0,sortby:"date"})},render:function(){this.fileResources=this.getFileResources(this.param);if(this.param.appName!=undefined){var e='<div class="cs_reference_wrap"></div><div class="tool_bar tool_absolute"><div class="dataTables_length"></div></div>';this.$el.append(e)}return this.resetList(this.fileResources),this},getFileResources:function(e){var t="/api/webfolder/folder/list",n="";return $.go(t,e,{qryType:"GET",async:!1,responseFn:function(e){n=e.data},error:function(e){}}),n},moveFileDetail:function(e){window.open("/app/webfolder?searchFolder=user","_blank","scrollbars=yes,resizable=yes,width=1280,height=760")},showMore:function(e){this.param.appName="file",this.showAppSearchMore(this.param)},removeMoreBtn:function(){if(this.param.appName!=undefined)return;if(this.fileResources.currentPage>=this.fileResources.pageCount)return;this.$el.find("#btn_more").css("display","")},downloadFile:function(e){var t=$(e.currentTarget).attr("data-id"),n=$(e.currentTarget).attr("data-type"),r=$(e.currentTarget).attr("data-path"),i=$(e.currentTarget).attr("data-sroot"),s=$(e.currentTarget).attr("data-userseq");window.location.href="/api/webfolder/file/download?uids="+t+"&type="+n+"&path="+r+"&sroot="+i+"&sharedUserSeq="+s},getSearchTotalCount:function(){},pageInfo:function(){var e={total:this.fileResources.total,pageNo:this.fileResources.currentPage-1,pageSize:this.param.offset,lastPageNo:Math.ceil(this.fileResources.total/this.param.offset),pages:[],prev:!1,next:!1},t=Math.floor(e.pageNo/10)*10,n=Math.ceil((e.pageNo+1)/10)*10;t==e.lastPageNo&&e.lastPageNo==0&&e.pages.push(0);for(var r=t;r<n;r++){if(r>=e.lastPageNo)break;e.pages.push(r)}return this.fileResources.currentPage-1>0&&(e.prev=!0),this.fileResources.currentPage<e.lastPageNo&&(e.next=!0),e},resetList:function(e){if(this.param.appName!=undefined){if(this.pageInfo().total==0){var t=new o({appName:u["\uc790\ub8cc\uc2e4"]});this.$el.find("div.cs_reference_wrap").html(t.render().el);return}this.$el.find("div.cs_reference_wrap").html(r({lang:a,dataset:e.messages,ext:function(){var e=["xlsx","pptx","docx"],t=this.webFolderFileExt;return $.inArray(t,e)>0?t.slice(0,-1):t},createAt:function(){return GO.util.snsDate(this.webFolderFileUtcDate,GO.lang)}})),this.renderPages()}else{if(this.pageInfo().total==0)return;this.$el.html(r({lang:a,dataset:e.messages,ext:function(){var e=["xlsx","pptx","docx"],t=this.webFolderFileExt;return $.inArray(t,e)>0?t.slice(0,-1):t},createAt:function(){return GO.util.snsDate(this.webFolderFileUtcDate,GO.lang)}}))}this.removeMoreBtn()},emptyMessage:function(){if(this.pageInfo().total==0)return" "+u["\uc790\ub8cc\uc2e4"]},renderPages:function(){this.pageView=new i({pageInfo:this.pageInfo()}),this.pageView.bind("paging",this.selectPage,this),this.$el.find("div.tool_absolute > div.dataTables_paginate").remove(),this.$el.find("div.tool_absolute").append(this.pageView.render().el)},selectPage:function(e){this.param.page=e,n.router.navigate("unified/app/search?"+this.serializeObj(this.param),!0)}});return f})}).call(this);