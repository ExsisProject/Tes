(function(){define(["backbone","hogan","app","hgn!dashboard/templates/search/approval_search","collections/paginated_collection","dashboard/views/search/search_form","dashboard/views/search/no_search_result","i18n!nls/commons","i18n!approval/nls/approval","GO.util"],function(e,t,n,r,i,s,o,u,a){var f={empty_search_results:u["\uac80\uc0c9\uacb0\uacfc\uc5c6\uc74c"],more:u["\ub354\ubcf4\uae30"],approval:u["\uc804\uc790\uacb0\uc7ac"],createAt:a["\uae30\uc548\uc77c"],creator:a["\uae30\uc548\uc790"],apprStatus:a["\uacb0\uc7ac\uc0c1\ud0dc"],done:a["\uc644\ub8cc"],docNum:a["\ubb38\uc11c\ubc88\ud638"],approvationDate:a["\uacb0\uc7ac\uc77c"]},l=i.extend({url:function(){var e="/api/search/approval",t=$.param({stype:this.stype,type:this.type,keyword:this.keyword,fromDate:this.fromDate,toDate:this.toDate,page:this.pageNo,offset:this.pageSize});return this.stype=="detail"&&(t=$.param({stype:this.stype,type:this.type,keyword:this.keyword,fromDate:this.fromDate,toDate:this.toDate,title:this.title,attachFileNames:this.attachFileNames,attachFileContents:this.attachFileContents,formName:this.formName,searchTerm:this.searchTerm,dateType:this.dateType,page:this.pageNo,offset:this.pageSize,docBody:this.keyword,drafterName:this.keyword,docNum:this.docNum})),e+"?"+t},setListParam:function(){var e=GO.router.getSearch();this.stype=e.stype,this.searchTerm=e.searchTerm,this.keyword=e.keyword?e.keyword.replace(/\+/gi," "):"",this.title=e.keyword,this.attachFileNames=e.keyword,this.attachFileContents=e.searchAttachContents=="true"?this.keyword:"",this.fromDate=e.fromDate,this.toDate=e.toDate,this.type="approval",this.dateType=e.dateType,this.pageNo=e.page?e.page:0,this.pageSize=e.offset?e.offset:5,this.docBody=e.keyword,this.drafterName=this.keyword,this.formName=this.keyword,this.docNum=this.docNum,sessionStorage.clear()}}),c=s.extend({events:{"click #btn_more":"showMore","click #apprTitle":"moveApprDetail"},initialize:function(){this.$el.off(),this.param=GO.router.getSearch(),this.param.stype!="simple"&&(this.param={stype:this.param.stype,title:this.param.keyword,docBody:this.param.keyword,attachFileNames:this.param.keyword,attachFileContents:this.param.searchAttachContents=="true"?this.param.keyword:"",formName:this.param.keyword,docNum:this.param.docNum,drafterName:this.param.keyword,fromDate:this.param.fromDate,toDate:this.param.toDate,page:this.param.page||0,offset:this.param.offset||5,appName:this.param.appName}),this.collection=new l,this.collection.setListParam(),this.collection.bind("reset",this.resetList,this),this.collection.fetch({statusCode:{403:function(){GO.util.error("403")},404:function(){GO.util.error("404",{msgCode:"400-common"})},500:function(){GO.util.error("500")}}})},render:function(){if(this.param.appName!=undefined){var e='<div class="cs_eapproval_wrap"></div><div class="tool_bar tool_absolute"><div class="dataTables_length"></div></div>';this.$el.append(e)}return this},moveApprDetail:function(e){var t=$(e.currentTarget).attr("data-id");window.open("/app/approval/document/"+t,"_blank","scrollbars=yes,resizable=yes,width=1280,height=760")},showMore:function(e){this.param.appName="approval",this.showAppSearchMore(this.param)},getSearchTotalCount:function(){return 0},resetList:function(e){if(this.param.appName!=undefined){if(this.collection.pageInfo().total==0){var t=new o({appName:u["\uc804\uc790\uacb0\uc7ac"]});this.$el.find("div.cs_eapproval_wrap").html(t.render().el);return}this.$el.find("div.cs_eapproval_wrap").html(r({lang:f,dataset:this.collection.toJSON(),docStaus:function(){var e=this.docStatus;if(e=="INPROGRESS")return a["\uc9c4\ud589"];if(e=="COMPLETE")return a["\uc644\ub8cc"];if(e=="RETURN")return a["\ubc18\ub824"];if(e=="TEMPSAVE")return a["\uc784\uc2dc\uc800\uc7a5"]},covertDraftedAt:function(){return this.draftedAt==null?"":GO.util.shortDate(this.draftedAt)},convertCompletedAt:function(){return this.completedAt==null?"":GO.util.shortDate(this.completedAt)}})),this.renderPages()}else{if(this.collection.pageInfo().total==0){$("#approvalEmptyMessage").show();return}this.$el.html(r({lang:f,dataset:this.collection.toJSON(),docStaus:function(){var e=this.docStatus;if(e=="INPROGRESS")return a["\uc9c4\ud589"];if(e=="COMPLETE")return a["\uc644\ub8cc"];if(e=="RETURN")return a["\ubc18\ub824"];if(e=="TEMPSAVE")return a["\uc784\uc2dc\uc800\uc7a5"]},covertDraftedAt:function(){return this.draftedAt==null?"":GO.util.shortDate(this.draftedAt)},convertCompletedAt:function(){return this.completedAt==null?"":GO.util.shortDate(this.completedAt)}}))}this.removeMoreBtn()}});return c})}).call(this);