(function(){define(["backbone","app"],function(e,t){function i(e,t){return this.isNew()?!1:this.get("boxNumber")!==+e?!0:this.get("boxOrder")!==+t?!0:!1}function s(){var e={updatable:!1,removable:!1};return o.call(this)?(e.updatable=!0,e.removable=!0):(e.updatable=this.getGadgetOption("editable")||!1,e.removable=this.getGadgetOption("removable")||!1),e}function o(){return this.isUserType()?!0:t.session("dashboardAdmin")?!0:!1}function u(e,t){return typeof t=="undefined"?e:e[t]}var n={company:"COMPANY",user:"USER"},r;return r=e.Model.extend({urlRoot:"/api/gadget",savePosition:function(e,n){var r=$.Deferred();if(i.call(this,e,n)){var s=t.config("contextRoot")+[_.result(this,"urlRoot"),this.id,"move"].join("/");this.save({boxNumber:+e,boxOrder:+n},{url:s.replace("//","/"),success:function(e){r.resolve(e)},error:function(){r.reject()}})}else r.resolve(this);return r},setPosition:function(e,t){return this.set({boxNumber:+e,boxOrder:+t})},getSpec:function(e){return u(this.get("spec"),e)},getBoxNumber:function(){return this.get("boxNumber")+1},getActions:function(){return _.defaults(this.get("actions")||{},s.call(this))},getGadgetOption:function(t){var n=e.$.parseJSON(this.get("options"))||{};return u(n,t)},isUserType:function(){return this.get("type")===n.user},isCompanyType:function(){return this.get("type")===n.company},updatable:function(){return this.getActions().updatable},removable:function(){return this.getActions().removable}},{TYPE_COMPANY:n.company,TYPE_USER:n.user}),r})})();