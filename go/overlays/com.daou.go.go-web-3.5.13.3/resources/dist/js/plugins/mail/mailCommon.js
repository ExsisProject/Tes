function getListResizeHeight(){var e=jQuery("#mailBottom").offset().top,t=jQuery("#mainContent").offset().top,n=44,r=0;USERSESSION.theme=="THEME_ADVANCED"&&(n=0,r=50),jQuery("#mail_list_content").height(e-t-n-r)}function getReadResizeHeight(){var e=jQuery("#mailBottom").offset().top,t=jQuery("#mainContent").offset().top;jQuery("#mailViewContentWrap").height(e-t-60)}function mailHistoryCallBack(e){var t=historyControl.getHistoryIndex(),n=e.data;if(n&&n.param&&t-1>n.state)checkEscapeWriteMode(function(){switch(n.type){case"list":var e=n.param.folder;if(e!="Drafts"){var t=layoutControl.getContentSplitterMode();t=t?t:"n",layoutControl.contentSplitterChange(t)}else layoutControl.contentNormalSplitter();mailControl.loadMessageList(n.param,!0);break;case"read":var e=n.param.folder;if(e!="Drafts"){var t=layoutControl.getContentSplitterMode();t=t?t:"n",layoutControl.contentSplitterChange(t)}else layoutControl.contentNormalSplitter();t!="n"&&mailControl.loadMessageList(n.param,!0),mailControl.readMessage(n.param,!0);break;case"mdnlist":layoutControl.contentNormalSplitter(),mailControl.loadMdnList(n.param,!0);break;case"mdnread":layoutControl.contentNormalSplitter(),mailControl.loadMdnRead(n.param,!0)}},function(){history.forward()});else if(!n||!n.type){var r=e.url;r.indexOf("app/mail?work=")>0&&checkEscapeWriteMode(function(){history.back()},function(){history.forward()})}}function checkSuccess(e){return e&&e.isSuccess?!0:(e&&e.failMsg&&jQuery.goAlert(e.failMsg),!1)}function changeMailContainer(e){mailMenuStatus=e,jQuery("#toolbar_wrap").show(),e=e?e:"list",e=="setting"?(jQuery("#mainContentWrap").hide(),jQuery("#mailSettingWrap").show()):(e=="list"?(layoutMode=="n"&&jQuery("#mailReadArea").hide(),jQuery("#mailWriteArea").hide(),jQuery("#mailSendArea").hide(),jQuery("#mailListArea").show()):e=="read"?(layoutMode=="n"&&jQuery("#mailListArea").hide(),jQuery("#mailWriteArea").hide(),jQuery("#mailSendArea").hide(),jQuery("#mailReadArea").show(),TABLET&&jQuery("#mailReadArea").css({overflow:"scroll","-webkit-overflow-scrolling":"touch"})):e=="write"?(jQuery("#mailListArea").hide(),jQuery("#mailReadArea").hide(),jQuery("#mailSendArea").hide(),jQuery("#mailWriteArea").show()):e=="send"&&(jQuery("#toolbar_wrap").hide(),jQuery("div[data-tag=write_toolbar_wrap]").hide(),jQuery("#mailListArea").hide(),jQuery("#mailReadArea").hide(),jQuery("#mailWriteArea").hide(),jQuery("#mailSendArea").show()),jQuery("#mailSettingWrap").hide(),jQuery("#mainContentWrap").show()),jQuery(window).trigger("resize")}function getTextMessage(){return contentValue="",isMsie?contentValue=window.textContentFrame.getContent():contentValue=document.getElementById("textContentFrame").contentWindow.getContent(),contentValue}function getHtmlMessage(e){var t=mailControl.getSendData(),n="on"==t.letterMode;if(e=="draft"||e=="ascheck"||e=="secure")return editorControl.getEditorText();if(!n){var r=editorControl.getEditorText(),i="",s=!1;try{jQuery(r).length==1&&jQuery(r).attr("class")=="TerraceMsg"&&(s=!0)}catch(o){s=!1,console.warn("[DO] FAIL! Convert HTML string into Jquery Object")}if(editorControl.oEditor.options.name=="ActiveDesigner"){var u=document.createElement("textarea");u.appendChild(document.createTextNode(r)),i=s?u.outerHTML:"<div class='TerraceMsg' data-content-type='MIME' data-editor='ActiveDesigner'>"+u.outerHTML+"</div>"}else i=s?r:"<div class='TerraceMsg'>"+r+"</div>";return i}var a="{tims_letter_paper_header}",f="{tims_letter_paper_body}",l="{tims_letter_paper_tail}";if(e=="preview"){var c=t.letterData;a=c.header,f=c.body,l=c.tail}var h="<table width='600px' cellspacing='0' cellpadding='0'><tr><td style='line-height:0;'><img src='"+a+"'/></td></tr>"+"<tr>"+"<td class='TerraceMsg' style='padding:10px 30px 0px 30px;' background='"+f+"'>"+editorControl.getEditorText()+"</td></tr>"+"<tr><td style='line-height:0;'><img src='"+l+"'></td></tr>"+"</table>";return h}function getPopupData(){return POPUPDATA}function checkEmailInvalidAddress(e){var t=getEmailArray(e);for(var n=0;n<t.length;n++){var r=t[n];r=jQuery.trim(r);if(r==""||checkEmailFormat(r))continue;return jQuery.goMessage(mailMsg.alert_invalidaddress+'"'+escape_tag(r)+'"'),!1}return!0}function useSearch(e){e?jQuery("section.combine_search").show():jQuery("section.combine_search").hide()}function isContainedTrashMail(){return jQuery("tr[folder=Trash] input:checked").length>0}function getMailListCheckedObj(){var e;return currentMenu=="read"&&layoutMode=="n"?e=jQuery("#messageListId"):e=jQuery("#mail_list_content input[name=msgId]:checked"),e}function getMailListCheckedCount(){return getMailListCheckedObj().length}function getMailListCheckedIdArray(){var e=new Array;return currentMenu=="read"&&layoutMode=="n"?e.push(getMailListCheckedObj().val()):getMailListCheckedObj().each(function(){e.push(jQuery(this).closest("tr").attr("id"))}),e}function getMailListCheckedData(e){var t=new Array;return getMailListCheckedObj().each(function(){t.push(jQuery(this).data(e))}),t}function getMailListCheckedValue(){var e=new Array;return getMailListCheckedObj().each(function(){e.push(jQuery(this).val())}),e}function getListProcessParams(e){var t=[],n=[];for(var r=0;r<e.length;r++){var i=e[r].lastIndexOf("_"),s=e[r].substring(0,i),o=e[r].substring(i+1);t[t.length]=o,isAllFolder?n[n.length]=s:n[0]=s}return{uids:t,fnames:n}}function makeMailHeaderMessege(e){mailControl.makeMailHeaderMsg(e)}function executeFolderInfo(){folderControl.updateFolderCountInfo()}function closeMailFolderOptionLayer(){jQuery("#mailFolderOptionLayer").remove()}function closeMailMoreFolderPopupLayer(){jQuery("#mail_more_folder_popup").remove()}function closeMailTagOptionLayer(){jQuery("#mailTagOptionLayer").remove()}function getTagInfo(e){var t=folderControl.getTagData();if(t&&t.length>0)for(var n=0;n<t.length;n++)if(t[n].id==e)return t[n];return null}function isExistTagName(e,t){var n=!1,r=folderControl.getTagData();if(r&&r.length>0)for(var i=0;i<r.length;i++)if(r[i].name==e&&r[i].id!=t){n=!0;break}return n}function makeDragEvent(e){jQuery(e).draggable({helper:function(){var e="on"==jQuery("#mailListAllCheck").val(),t=getMailListCheckedCount(),n="";e?n=mailMsg.allselect_003:t>0?n=t+mailMsg.mail_moremsg:n=jQuery(this).find("span.subject").text();var r={message:n};return getHandlebarsTemplate("mail_dnd_tmpl",r)},appendTo:"#mailLeftMenuWrap",cursorAt:{top:10,left:-5},scroll:!1})}function makeDropEvent(e){jQuery(e).droppable({accept:"#mail_list_content tr:not(.tb_option,.dateDesc)",tolerance:"pointer",hoverClass:"dropClass",over:function(e,t){var n=jQuery(this).data("droptype");n=n?n:"folder";var r=t.draggable.attr("id"),i=getListProcessParams([r]),s=i.fnames[0],o="on"==jQuery("#mailListAllCheck").val();if(n=="folder"){var u=jQuery(this).closest("a").attr("fname");if(!isAllFolder&&u==s||u=="Sent"||u=="Drafts"||u=="Reserved")return}else if(o)return;jQuery("#dragHelperIcon").removeClass("ic_disallow").addClass("ic_allow")},out:function(e,t){jQuery("#dragHelperIcon").removeClass("ic_allow").addClass("ic_disallow")},drop:function(e,t){var n=jQuery(this).data("droptype");n=n?n:"folder";var r=t.draggable.attr("id"),i=getListProcessParams([r]),s=i.fnames[0],o=i.uids[0],u="on"==jQuery("#mailListAllCheck").val();if(n=="folder"){var a=jQuery(this).closest("a").attr("fname");if(!isAllFolder&&a==s||a=="Sent"||a=="Drafts"||a=="Reserved")return;if(u)allSelectAction("move",a);else{var f={};if(getMailListCheckedCount()>0){var l=getMailListCheckedIdArray(),c=getListProcessParams(l);f={fromFolders:c.fnames,uids:c.uids,toFolder:a}}else f={fromFolders:[s],uids:[o],toFolder:a};mailControl.moveMessage(f)}}else{if(u)return;var h=jQuery(this).closest("a").attr("val"),p={};if(getMailListCheckedCount()>0){var l=getMailListCheckedIdArray(),c=getListProcessParams(l);p={addFlag:"true",tagId:h,folderNames:c.fnames,uids:c.uids}}else p={addFlag:"true",tagId:h,folderNames:[s],uids:[o]};mailControl.taggingMessage(p)}}})}function mailReadInit(e){var t=e.msgContent,n=t.folderEncName+"_"+t.uid;ReadSubMessageChecker.setCurrent(n),t.mdnCheck&&jQuery.goConfirm("",mailMsg.mail_mdn_response_confirm,function(){var e={folderName:t.folderEncName,uid:t.uid};e=mailControl.getSharedFolderParam(e),mailControl.sendMdnResponse(e)});var r=e.tagIdList,i=jQuery("#readTagWrap");if(r&&r.length>0){var s=folderControl.getTagData();for(var o=0;o<r.length;o++)for(var u=0;u<s.length;u++)if(r[o]==s[u].id){var a={messageId:n,tagInfo:s[u]};i.append(getHandlebarsTemplate("mail_read_tag_tmpl",a));break}}readRelationMessage()}function mailWriteInit(data){var msgData={type:"write",name:mailMsg.mail_write};mailControl.makeMailHeaderMsg(msgData),data.rcptMode=="searchaddr"?(isRcptModeNormal=!1,isRcptModeNoneAC=!1):data.rcptMode=="noneac"?(isRcptModeNoneAC=!0,isRcptModeNormal=!0):data.rcptMode=="normal"&&(isRcptModeNoneAC=!1,isRcptModeNormal=!0),isSendInfoCheckUse=data.sendCheckConfig.sendCheckApply,isSendEmailCheckUse=data.sendCheckConfig.sendEmailCheck,isSendAttachCheckUse=data.sendCheckConfig.sendAttachCheck,sendAttachData=data.sendCheckConfig.sendAttachData,isSendKeywordCheckUse=data.sendCheckConfig.sendKeywordCheck,sendKeywordData=data.sendCheckConfig.sendKeywordData,sendAllowUsed=data.sendAllowUsed,sendConfirm=data.sendConfirm;if(isRcptModeNormal){makeInputAddresskeyEvt("to"),makeInputAddresskeyEvt("cc"),makeInputAddresskeyEvt("bcc");if(!isRcptModeNoneAC){var options={autoResizeWidth:!0,makeFormat:!0,makeFormatFunc:makeFormatUnit,multiple:!1,width:"450px",matchCase:!0,max:15,notContact:USE_CONTACT==1?"F":"T"};jQuery("#to").autocomplete(mailControl.searchAddressAction,options),jQuery("#cc").autocomplete(mailControl.searchAddressAction,options),jQuery("#bcc").autocomplete(mailControl.searchAddressAction,options)}makeInputDropEvents("#toAddrWrap ul.name_tag, #ccAddrWrap ul.name_tag, #bccAddrWrap ul.name_tag"),bindAddrAreaEvents("#toAddrWrap ul.name_tag, #ccAddrWrap ul.name_tag, #bccAddrWrap ul.name_tag")}else jQuery("#writeRcptValue").keypress(function(e){e.which==13&&(e.preventDefault(),searchRcptAddress())});mailControl.getLastRcptList(),makeInputAddressFormat("to",data.to),makeInputAddressFormat("cc",data.cc),makeInputAddressFormat("bcc",data.bcc),data.editorMode=="html"&&makeEditorProcess(data),data.editorMode=="text"&&notiMode=="link"&&jQuery("#receivenoti").attr("disabled",!0),MAX_ATTACH_SIZE=data.attachConfig.maxAttachSize,USE_BIGATTACH_MODE=data.attachConfig.useBigAttachMode,BIGATTACH_EXPIRE=data.attachConfig.bigAttachExpireDay,BIGATTACH_DOWNCNT=data.attachConfig.bigAttachDownCnt,today=new Date(Number(data.systemTime)),BIGATTACH_TIMEZONE=data.attachConfig.bigAttachTimezone,BIGATTACH_EXPIRE_DATE=new Date(today.getTime()+(parseInt(BIGATTACH_EXPIRE)-1)*24*60*60*1e3);var quotausage=data.attachConfig.useBigAttachQuota;MAX_BIG_ATTACH_SIZE=data.attachConfig.maxBigAttachSize*1024*1024,MAX_BIG_ATTACH_QUOTA=data.attachConfig.maxBigAttachQuota*1024*1024,BIG_ATTACH_QUOTA=MAX_BIG_ATTACH_QUOTA-quotausage,BIG_ATTACH_QUOTA=BIG_ATTACH_QUOTA<0?0:BIG_ATTACH_QUOTA;var ctrType=USE_BIGATTACH_MODE?"power":"normal",basicControlOpt={controlType:ctrType,btnId:"basicUploadControl",btnCid:"basicUploadBtn",formName:"theFile",param:{uploadType:"flash",email:USER_EMAIL},url:"/api/mail/file/upload",maxFileSize:2097152e3,fileType:"*.*",locale:LOCALE,width:LOCALE=="jp"?90:73,btnText:mailMsg.comn_file_select,debug:!1,autoStart:!1,handler:basicUploadListeners,listId:"basicUploadAttachList",startUploadFunc:startUploadAttach},massControlOpt={controlType:ctrType,btnId:"massUploadControl",btnCid:"massUploadBtn",formName:"theFile",param:{uploadType:"flash",email:USER_EMAIL},url:"/api/mail/file/upload",maxFileSize:104857600,singleSelect:!0,fileType:"*.txt",locale:LOCALE,width:LOCALE=="jp"?90:73,btnText:mailMsg.comn_file_select,debug:!1,autoStart:!1,handler:{swfuploadLoaded:function(e){},fileQueued:function(e,t){if(!isConfirmFile(t.type,"txt")){jQuery.goAlert(msgArgsReplace(mailMsg.error_nofileext,["txt"]));return}jQuery(this).swfupload("startUpload")},fileQueueError:function(e,t,n,r){},fileDialogStart:function(e){},fileDialogComplete:function(e,t,n){},uploadStart:function(e,t){},uploadProgress:function(e,t,n){},uploadSuccess:function(event,file,serverData){var name=file.name,size=(parseInt(file.size)/1024).toFixed(2),data=eval("("+serverData+")"),fileItemTmp=["<span class='item_file' file-path='"+data.filePath+"'>","<span class='ic_file ic_txt'></span>","<span class=''>"+name+"</span>","<span class='size'>"+size+"KB"+"</span>","<span class='btn_bdr'>","<span class='ic_classic ic_del' title='"+mailMsg.comn_del+"'></span>","</span>","</span>"].join("");$fileItemTmp=jQuery(fileItemTmp),jQuery("#massFileItem").html($fileItemTmp),jQuery("#uploadActor").hide(),$fileItemTmp.find("span.ic_del").on("click",function(e){jQuery(this).parents("span.item_file:first").remove(),jQuery("#uploadActor").show()})},uploadComplete:function(e,t){},uploadError:function(e,t,n,r){}},listId:"basicUploadAttachList",startUploadFunc:startUploadAttach};basicAttachUploadControl=new UploadSimpleBasicControl(basicControlOpt),hasFlashPlayer()?massAttachUploadControl=new UploadBasicControl(massControlOpt):massAttachUploadControl=new UploadSimpleBasicControl(massControlOpt);if(USE_BIGATTACH_MODE){jQuery("#bigattachBtn").show(),jQuery("#bigattachMngBtn").show();var bigAttachInfoStr;data.attachConfig.useBigAttachDownCnt?bigAttachInfoStr=msgArgsReplace(mailMsg.bigattach_15,[BIGATTACH_EXPIRE,BIGATTACH_DOWNCNT]):bigAttachInfoStr=msgArgsReplace(mailMsg.bigattach_07,[BIGATTACH_EXPIRE]),jQuery("#bigattachMessageSpan").html(bigAttachInfoStr)}var ocxQuota=mailMsg.mail_attach_normal_simple+" "+"<span id='ocx_normal_size' class='num'>0B</span>/<strong>"+MAX_ATTACH_SIZE+"MB</strong>"+"<span id='ocx_bigattach_size' style='display:none;'>, "+mailMsg.mail_attach_bigattach_simple+" "+"<span id='ocx_huge_size' class='num'>0B</span>/<strong id='ocx_huge_quota'>0B</strong></span>";jQuery("#att_ocx_quota_info").html(ocxQuota);var simpleQuota=mailMsg.mail_attach_normal_simple+" "+"<span id='basic_normal_size' class='current'>0B</span>/<strong>"+MAX_ATTACH_SIZE+"MB</strong>"+"<span id='basic_bigattach_size' style='display:none;'>, "+mailMsg.mail_attach_bigattach_simple+" "+"<span id='basic_huge_size' class='current'>0B</span>/<strong id='basic_huge_quota'>0B</strong></span>";jQuery("#att_simple_quota_info").html(simpleQuota),data.attachConfig.useBigAttachMode&&(jQuery("#ocx_bigattach_size").show(),jQuery("#basic_bigattach_size").show());var checkOcxUpload=getCookie("OcxUpload")=="on"?!0:!1;activeXMake&&activeXUse&&isMsie?chgAttachMod("ocx",!0):isMsie9?(chgAttachMod("ocx",!0),jQuery("#crtBtnSimple").hide()):isMsie&&checkOcxUpload?chgAttachMod("ocx",!0):(chgAttachMod("simple",!0),hasFlashPlayer()||(jQuery("#massUploadControl").hide(),jQuery("#massSimpleFileInit").show())),massAttachUploadControl.init(),massAttachUploadControl.makeBtnControl(),USE_WEBFOLDER&&jQuery("#writeWebfolderBtn").show(),checkMassRcptToggleBtn(data.massRcptConfirm),mailControl.getSignList(makeSignListItem),data.useMailSender&&getMailUserSender(),data.bcc&&data.bcc!=""&&openWriteBccWrap(),setTimeout(function(){checkUploadfile(data.attaches),data.editorMode=="text"&&jQuery("#signSelect").attr("disabled",!0)},1e3),writeAutoSave=setTimeout(function(){runAutoSaveProcess()},5e3)}function openShareFolderSettingLayer(e,t){var n=e.split("."),r=n.length-1,i=n[r];jQuery.goOrgSlide({header:i,desc:mailMsg.mail_folder_share_msg,headerOption:'<input type="checkbox" id="orgShareFlag" checked="checked"/><label for="orgShareFlag">'+mailMsg.mail_folder_share_msg1+'</label><div class="data_result"><ul id="orgDataWrap" class="name_tag" style="max-height:55px;overflow-y:auto;"></ul></div>',isOrgServiceOn:useOrgAccess,type:"node",callback:function(e){if(jQuery("#orgMember_"+e.id).length>0)return;makeShareFolderUser(e)},buttons:[{bclass:"btn_major_s",btext:mailMsg.comn_confirm,callback:function(){var n=!1,r=jQuery("#orgDataWrap li span.name");jQuery("#orgShareFlag").attr("checked")&&r.length!=0&&(n=!0);var i=jQuery("#orgShareFlag").data("shareSeq"),s={},o=[],u=[];if(r.length==0&&jQuery("#orgShareFlag").data("shareSeq")==null){jQuery.goOrgSlide.close();return}var a=!1;r.each(function(){if(jQuery(this).data("id")==SESSION_ID)return a=!0,!1;jQuery(this).data("type")=="org"?u.push(jQuery(this).data("id")):o.push(jQuery(this).data("id"))});if(a){jQuery.goAlert(mailMsg.self_share_impossible);return}s.save=n,s.folderUid=i,s.folderName=e,s.goSeq=!0,s.sharedUserSeq=o,s.sharedDeptSeq=u,folderControl.setSharringReaderList(s,t)}}],contextRoot:"/"})}function openDirectedApproverPopup(){jQuery.goOrgSlide({header:mailMsg.mail_directed_approver,desc:mailMsg.mail_folder_share_msg,headerOption:mailMsg.mail_approver_msg001,isOrgServiceOn:useOrgAccess,type:"node",callback:function(e){var t=e.name,n=e.email,r=e.type;if("MEMBER"!=r&&"MODERATOR"!=r&&"MASTER"!=r){jQuery("#customButtons0").attr("selected",null),jQuery.goAlert(mailMsg.mail_approver_msg004);return}if(USEREMAIL==n){jQuery("#customButtons0").attr("selected",null),jQuery.goAlert(mailMsg.mail_approver_msg002);return}e.postion&&(t+="/"+e.postion),e.deptName&&(t+="/"+e.deptName),jQuery("#customButtons0").attr("selected","selected"),jQuery("#customButtons0").attr("data-address",t+" &lt;"+n+"&gt;")},buttons:[{bclass:"btn_major_s",btext:mailMsg.comn_confirm,callback:function(){if("selected"!=jQuery("#customButtons0").attr("selected")){jQuery.goAlert(mailMsg.comn_error_001);return}var e={};e.address=jQuery("#customButtons0").attr("data-address"),makeDirectedApprover(e),jQuery.goOrgSlide.close()}}],contextRoot:"/"});var e=jQuery("#gpopupLayer"),t=(jQuery(window).width()-e.width())/2,n=(jQuery(window).height()-e.height())/2;e.css("left","156px"),e.css("top","178px")}function makeShareFolderUser(e){var t=jQuery('<span id="" class="name" data-id="'+e.id+'" data-email="'+e.email+'"'+'" data-type="'+e.type+'"></span>').attr("id","orgMember_"+e.id).data("id",e.id).data("email",e.email).text(e.name+" "+(e.position?e.position:"")),n=jQuery('<span class="btn_wrap" title="'+mailMsg.comn_del+'"><span class="ic_classic ic_del"></span></span>').click(function(){jQuery(this).closest("li").remove()});jQuery("#orgDataWrap").append(jQuery("<li></li>").append(t).append(n))}function makeDirectedApprover(e){var t=jQuery("<span class='name'>"+e.address+"</span>"),n=jQuery("<span class='btn_wrap'><span class='ic_classic ic_del' title='"+mailMsg.mail_attach_delete+"'></span></span>").click(function(){jQuery(this).closest("li").remove()});jQuery("#approverAddrWrap ul").append(jQuery("<li approver='"+e.address+"'></li>").append(t).append(n))}function makeShareFolderInfo(e){var t=e;if(t&&t.length>0){var n={};for(var r=0;r<t.length;r++)n={},n.id=t[r].readerUserSeq,n.email=t[r].readerId,n.name=t[r].readerName,n.position="",makeShareFolderUser(n)}}function isPopupView(){return CURRENT_PAGE_NAME=="popup"}function isReloadReady(){return isPopupView()&&window.opener&&window.opener.reloadMessageList}function getFolderType(e){var t="normal";return e=="Inbox"?t="inbox":e=="Sent"?t="sent":e=="Drafts"?t="drafts":e=="Reserved"?t="reserved":e=="Spam"?t="spam":e=="Trash"?t="trash":e=="Quotaviolate"&&(t="quotaviolate"),t}function checkListToolbarSelect(){return currentMenu=="list"&&getMailListCheckedCount()==0?(jQuery.goAlert(mailMsg.mail_message_notselect),!1):!0}function selectCurrentFolderName(e){jQuery("#leftMenuSectionWrap p.title").removeClass("on"),e!=""&&(jQuery("#"+getFolderNameId(e)).length==0?setTimeout(function(){jQuery("#"+getFolderNameId(e)).addClass("on")},1e3):jQuery("#"+getFolderNameId(e)).addClass("on"))}function isDefaultBoxCheck(e){var t=e.toUpperCase();return t=="INBOX"||t=="SENT"||t=="DRAFTS"||t=="TRASH"||t=="SPAM"||t=="RESERVED"||t=="QUOTAVIOLATE"||e==mailMsg.folder_inbox||e==mailMsg.folder_sent||e==mailMsg.folder_drafts||e==mailMsg.folder_reserved||e==mailMsg.folder_spam||e==mailMsg.folder_trash||e==mailMsg.folder_quotaviolate?!0:!1}function isDefaultBox(e){var t=e.toUpperCase();return t=="INBOX"||t=="SENT"||t=="DRAFTS"||t=="TRASH"||t=="SPAM"||t=="RESERVED"||t=="QUOTAVIOLATE"?!0:!1}function checkReserveTime(e,t,n,r,i,s){var o=new Date(e,t-1,n,r,i);o.setFullYear(e,t-1,n),o.setHours(r),o.setMinutes(i);var u=today.getTime()+6e5,a=today.getTime()+s*24*60*60*1e3,f=o.getTime();return f<u?(jQuery.goMessage(mailMsg.alert_minreserved),!1):f>a?(jQuery.goMessage(msgArgsReplace(mailMsg.alert_maxreserved,[s])),!1):!0}function preventDrop(){var e=jQuery("body");e.bind("dragover",function(e){e.preventDefault(),e.stopPropagation(),e.originalEvent.dataTransfer.dropEffect="none"}),e.bind("drop",function(e){console.log("drop"),e.preventDefault(),e.stopPropagation()})}function resizeLeftMenu(){var e=function(){var e=jQuery("#mailBottom").offset().top,t=jQuery("#leftMenuSectionWrap").offset().top,n=jQuery("#mailLeftMenuWrap").height(),r=jQuery("#mailLeftMenuWrap section.gnb_title").outerHeight(),i=jQuery("#mailLeftMenuWrap section.function").outerHeight(),s=jQuery("#mailLeftMenuWrap section.personal_data").outerHeight(),o=50;USERSESSION.theme=="THEME_ADVANCED"&&(o=0),jQuery("#leftMenuSectionWrap").height(e-r-i-s-o)};jQuery(window).on("resize.mail",e),jQuery(window).trigger("resize")}function hideAutoComplate(){jQuery("#to").unautocomplete(),jQuery("#cc").unautocomplete(),jQuery("#bcc").unautocomplete()}function recurrenceParser(e){var t=e.split(";"),n={};for(var r=0;r<t.length;r++){var i=t[r].split("=");n[i[0]]=i[1]}var s=humanizeFrequency(n),o=humanizeIntervalOption(n),u=humanizeUntil(n),a=humanizeCount(n);return s+" "+o+" "+u+" "+a}function humanizeFrequency(e){var t="";switch(e.FREQ){case"DAILY":e.hasOwnProperty("INTERVAL")?t=msgArgsReplace(mailMsg.mail_calendar_recur_day,[e.INTERVAL]):t=mailMsg.mail_calendar_allday;break;case"WEEKLY":e.hasOwnProperty("INTERVAL")?t=msgArgsReplace(mailMsg.mail_calendar_recur_week,[e.INTERVAL]):t=mailMsg.mail_calendar_allweek;break;case"MONTHLY":e.hasOwnProperty("INTERVAL")?t=msgArgsReplace(mailMsg.mail_calendar_recur_month,[e.INTERVAL]):t=mailMsg.mail_calendar_allmonth;break;case"YEARLY":e.hasOwnProperty("INTERVAL")?t=msgArgsReplace(mailMsg.mail_calendar_recur_year,[e.INTERVAL]):t=mailMsg.mail_calendar_allyear}return t}function humanizeIntervalOption(e){var t="";if(e.hasOwnProperty("BYDAY")){var n=e.BYDAY.split(","),r={SU:mailMsg.mail_calendar_sunday,MO:mailMsg.mail_calendar_monday,TU:mailMsg.mail_calendar_tuesday,WE:mailMsg.mail_calendar_wednesday,TH:mailMsg.mail_calendar_thursday,FR:mailMsg.mail_calendar_friday,SA:mailMsg.mail_calendar_saturday};for(var i=0;i<n.length;i++){var s=/([0-9]*)(SU|MO|TU|WE|TH|FR|SA)?$/.exec(n[i]),o=s[1]?s[1]:undefined,u=r[s[2]];e.hasOwnProperty("BYSETPOS")&&(o=e.BYSETPOS),o==null?t+=u:t+=msgArgsReplace(mailMsg.mail_calendar_recur_number,[o,u]),n.length!=i+1&&(t+=", ")}}if(e.hasOwnProperty("BYMONTHDAY")){var n=e.BYMONTHDAY.split(",");for(var i=0;i<n.length;i++)t+=msgArgsReplace(mailMsg.mail_calendar_recur_day,[n[i]]),n.length!=i+1&&(t+=", ")}if(e.hasOwnProperty("BYMONTH")){var n=e.BYMONTHDAY.split(",");for(var i=0;i<n.length;i++)t+=msgArgsReplace(mailMsg.mail_calendar_recur_day,[n[i]]),n.length!=i+1&&(t+=", ")}return t}function humanizeUntil(e){var t="";if(e.hasOwnProperty("UNTIL")){var n=moment(e.UNTIL,"YYYYMMDD");t=msgArgsReplace(mailMsg.mail_calendar_recur_to,[n.format("YYYY-MM-DD")])}return t}function humanizeCount(e){var t="";return e.hasOwnProperty("COUNT")&&(t=msgArgsReplace(mailMsg.mail_calendar_recur_count,[e.COUNT])),t}function securityCetnerFolderInfo(){securityCenter&&ActionLoader.getGoLoadAction("/api/security/mailfolder/list",null,function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++)if(e[t].name=="Todo"){jQuery("#leftMenuSectionWrap .security .approver").show(),jQuery("#leftMenuSectionWrap .security .num").text(e[t].count);break}},"json",function(){})}var layoutControl,basicAttachUploadControl,massAttachUploadControl=null,mailControl,folderControl,mailSettingControl,historyControl,editorControl,editorImgControl,currentFolderType,currentFolderName,currentFolderViewName,layoutMode,isAllfolder,currentMenu,currentMenuType,autoSaveTimeTerm,checkSaveTimeTerm,autoSaveMessageTerm,writeAutoSave,autoReflashTimeTerm,runAutoReflashTime,isAutoReflash=!1,POPUPDATA={},isDocTemplate=!1,isAutoSave=!1,isAutoSaveStart=!1,isSendWork=!1,isRcptModeNormal=!0,isRcptModeNoneAC=!1,sendAllowUsed=!1,isSendInfoCheckUse=!1,isSendEmailCheckUse=!1,isSendAttachCheckUse=!1,sendAttachData="",isSendKeywordCheckUse=!1,sendKeywordData="",today,isOcxUpload=!1,isOcxUploadDownModule=!1,MAX_ATTACH_SIZE=0,MAX_BIG_ATTACH_SIZE=0,BIG_ATTACH_QUOTA=0,MAX_BIG_ATTACH_QUOTA=0,BIGATTACH_TIMEZONE,BIGATTACH_EXPIRE_DATE,BIGATTACH_EXPIRE,BIGATTACH_DOWNCNT,USE_BIGATTACH_MODE=!1,isBookmark=!1,bookmarkType="mail",bookmarkName="",bookmarkValue="",bookmarkSeq=0,listDateStore=-1,popWriteWin,isLetter=!1,mailBadgeCount=0,isModFieldInside=!1,isMaxSendMailCountUse=!1,maxSendMailCount=0,childrenFnameForModify=null,initSendData={},isUseReflashTime=!0,previousSenderEmail="",sendConfirm="",LOCAL_DOMAIN="",mailToolbarRuleMap=new HashMap;mailToolbarRuleMap.put("normal",{quick:!0,tag:!0,"delete":!0,reply:!0,forward:!0,seen:!0,copy:!0,move:!0,erase:!0,save:!0,filter:!0,spam:!0,notspam:!1,reject:!0,allow:!1,resend:!1,layout:!0,print:!0,upload:!0,thismail:!0,attachdelete:!0}),mailToolbarRuleMap.put("inbox",{quick:!0,tag:!0,"delete":!0,reply:!0,forward:!0,seen:!0,copy:!0,move:!0,erase:!0,save:!0,filter:!0,spam:!0,notspam:!1,reject:!0,allow:!1,resend:!1,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!0}),mailToolbarRuleMap.put("sent",{quick:!0,tag:!0,"delete":!0,reply:!0,forward:!0,seen:!0,copy:!0,move:!0,erase:!0,save:!0,filter:!0,spam:!1,notspam:!1,reject:!1,allow:!1,resend:!0,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!0}),mailToolbarRuleMap.put("drafts",{quick:!0,tag:!1,"delete":!0,reply:!1,forward:!1,seen:!1,copy:!0,move:!0,erase:!0,save:!1,filter:!1,spam:!1,notspam:!1,reject:!1,allow:!1,resend:!1,layout:!1,print:!0,upload:!1,thismail:!0,attachdelete:!1}),mailToolbarRuleMap.put("reserved",{quick:!0,tag:!1,"delete":!0,reply:!1,forward:!1,seen:!1,copy:!1,move:!1,erase:!0,save:!0,filter:!1,spam:!1,notspam:!1,reject:!1,allow:!1,resend:!1,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!1}),mailToolbarRuleMap.put("spam",{quick:!0,tag:!0,"delete":!0,reply:!0,forward:!0,seen:!0,copy:!0,move:!0,erase:!0,save:!0,filter:!0,spam:!1,notspam:!0,reject:!1,allow:!0,resend:!1,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!0}),mailToolbarRuleMap.put("trash",{quick:!0,tag:!0,"delete":!0,reply:!0,forward:!0,seen:!0,copy:!0,move:!0,erase:!0,save:!0,filter:!0,spam:!1,notspam:!0,reject:!1,allow:!0,resend:!1,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!0}),mailToolbarRuleMap.put("all",{quick:!0,tag:!0,"delete":!0,reply:!0,forward:!0,seen:!0,copy:!0,move:!0,erase:!0,save:!1,filter:!1,spam:!1,notspam:!1,reject:!1,allow:!1,resend:!1,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!0}),mailToolbarRuleMap.put("shared",{quick:!0,tag:!1,"delete":!1,reply:!0,forward:!0,seen:!1,copy:!0,move:!1,erase:!1,save:!0,filter:!1,spam:!1,notspam:!1,reject:!1,allow:!1,resend:!1,layout:!0,print:!0,upload:!1,thismail:!0,attachdelete:!1}),mailToolbarRuleMap.put("quotaviolate",{quick:!0,tag:!1,"delete":!0,reply:!1,forward:!1,seen:!1,copy:!1,move:!0,erase:!0,save:!1,filter:!1,spam:!1,notspam:!1,reject:!1,allow:!1,resend:!1,layout:!0,print:!1,upload:!1,thismail:!1,attachdelete:!0}),window.layoutMode=layoutMode;var MailControl=function(){var e=this;this.listAction="/api/mail/message/list",this.readAction="/api/mail/message/read",this.writeAction="/api/mail/message/write",this.sendAction="/api/mail/message/send",this.autoSaveAction="/api/mail/message/autosave",this.mdnListAction="/api/mail/message/mdn/list",this.mdnReadAction="/api/mail/message/mdn/read",this.deleteMdnAction="/api/mail/message/mdn/delete",this.recallMessageAction="/api/mail/message/mdn/recall",this.sendMdnResponseAction="/api/mail/message/mdn/send",this.previewAction="/api/mail/message/write/preview",this.sourceAction="/api/mail/message/source",this.downloadAttachFileAction="/api/mail/message/attach/download",this.downloadAllAttachFileAction="/api/mail/message/attach/download/all",this.downloadTnefAttachFileAction="/api/mail/message/tnef/attach/download",this.removeAttachFileAction="/api/mail/message/attach/delete",this.removeAllAttachesFromMessageAction="/api/mail/message/attach/delete/all",this.relationAction="/api/mail/message/relation",this.switchFlagAction="/api/mail/message/flag",this.listSearchQueryAction="/api/mail/searchquery/list",this.saveSearchQueryAction="/api/mail/searchquery/create",this.deleteSearchQueryAction="/api/mail/searchquery/delete",this.readModeOptionAction="/api/mail/setting/basic/readmode",this.pageBaseOptionAction="/api/mail/setting/basic/pagebase",this.autoSaveOptionAction="/api/mail/setting/basic/autosave",this.searchAddressAction="/api/mail/address/search/name",this.searchAddressesAction="/api/mail/address/search/names",this.listBigAttachAction="/api/mail/bigattach/list",this.deleteBigAttachAction="/api/mail/bigattach/delete",this.listLetterAction="/mail/mail/getLetterList.action",this.listDocTemplateAction="/mail/common/listDocTemplate.action",this.readDocTemplateAction="/mail/common/loadDocTemplate.action",this.signListAction="/api/mail/setting/sign/list",this.signContentAction="/api/mail/setting/sign/content",this.bigAttachUpdateAction="/api/mail/bigattach/save",this.resetExtMailAction="/api/mail/pop3/reset",this.downloadOrderExtMailAction="/api/mail/pop3/download/order",this.downloadExtMailAction="/api/mail/pop3/download",this.taggingMessageAction="/api/mail/message/tag",this.deleteMessageAction="/api/mail/message/delete",this.cleanMessageAction="/api/mail/message/clean",this.copyMessageAction="/api/mail/message/copy",this.moveMessageAction="/api/mail/message/move",this.downloadMessageAction="/api/mail/message/download",this.addResistRuleAction="/api/mail/message/rule",this.allSelectMessageProcessAction="/api/mail/message/all",this.saveMailFilterAction="/api/mail/setting/filter",this.sortFilterMessageAction="/api/mail/message/filter",this.registBayesianRuleAction="/api/mail/message/bayesian",this.messageIntegrityAction="/api/mail/message/integrity",this.readNestedAction="/api/mail/message/nested/read",this.webfolderAttachSaveAction="/api/webfolder/mail/attach/save",this.webfolderAttachWriteAction="/api/webfolder/mail/attach/write",this.readMailUserSenderAction="/api/mail/setting/sender/list",this.listSendAllowAction="/api/mail/address/sendallow/list",this.checkSendAllowAction="/api/mail/address/sendallow/check",this.isMailAttachSearchAction="/api/system/mailattachsearch",this.lastRcptListAction="/api/mail/setting/lastrcpt/list",this.listMode="mail",this.listParam={},this.readParam={},this.writeParam={},this.writeData={},this.sendData={},this.sharedFlag=!1,this.currentFolder="Inbox",this.loadMessageList=function(t,n,r,i){t?(this.listParam=t,t.folder&&t.folder!=""&&(this.currentFolder=t.folder,t.folder=htmlEntityDecode(t.folder)),t.sharedFlag&&t.sharedFlag=="shared"?(this.sharedFlag=!0,t.sharedFolderName=htmlEntityDecode(t.sharedFolderName)):this.sharedFlag=!1):t={},this.listParam=t,t.init=r,makeProcessLoader();var s=jQuery("#searchType").val();s=="appSearch"||isPopup?(ActionLoader.postSyncGoJsonLoadAction(this.listAction,t,function(n){i=i?i:!1,n.directRead=i,n.toolbarSort=t.toolbarSort,e.printMessageList(n)},"json"),google.sendPageView(this.listAction)):(isMsie8?window.top.window.location="/app/#unified/search?stype=simple&searchTerm=all&offset=5&page=0&keyword="+encodeURIComponent(t.keyWord):window.top.window.location="/app/unified/search?stype=simple&searchTerm=all&offset=5&page=0&keyword="+encodeURIComponent(t.keyWord),jQuery("#searchType").val("appSearch"),jQuery("#mailSearchKeyWord").val(""),n=!0),n||historyControl.setHistory({type:"list",param:t})},this.initSubMessage=function(){layoutMode!="n"&&(ReadSubMessageChecker.resetUid(),jQuery("#mailReadArea").handlebars("mail_read_default_tmpl"))},this.readRelationMessage=function(t,n){var r=e.readParam;r.page=t,r.sortDir=n,ActionLoader.postGoJsonLoadAction(this.relationAction,r,e.printRelationMessage,"json"),google.sendPageView(this.relationAction)},this.printRelationMessage=function(e){e.total>1&&(e.isPopup=CURRENT_PAGE_NAME=="popup",jQuery("#relationMessageWrapper").show(),jQuery("#relationMessageCount").text(e.total-1),jQuery("#relationContentWrap").handlebars("mail_read_relation_tmpl",e),jQuery("#relation_"+getFolderNameId(e.folderName)+"_"+e.uid).addClass("active"))},this.getSharedFolderParam=function(e){return this.sharedFlag?(e.sharedFlag="shared",e.sharedUserSeq=this.listParam.sharedUserSeq,e.sharedFolderName=this.listParam.sharedFolderName):(e.sharedFlag="user",e.sharedUserSeq="0",e.sharedFolderName=""),e},this.setSharedFolderParam=function(e){e.shared&&(this.sharedFlag=!0,this.listParam&&(this.listParam.sharedUserSeq=e.sharedUserSeq,this.listParam.sharedFolderName=e.folderName))},this.switchMessagesFlags=function(e,t,n,r,i){var s={};s=this.getSharedFolderParam(s),s.folderNames=t,s.uids=e,s.flagType=n,s.used=r,ActionLoader.postGoJsonLoadAction(this.switchFlagAction,s,function(e){i?(changeFlagReadView(r,n),layoutMode!="n"&&changeFlagView(r,n,e)):(changeFlagView(r,n,e),layoutMode!="n"&&changeFlagReadView(r,n)),isReloadReady()&&opener.reloadMessageList()},"json")},this.movePage=function(e){var t=this.listParam;this.listMode=="mdnread"&&(t=this.readParam),t==null&&(t={}),t.page=e,this.listParam=t,this.listMode=="mail"?this.loadMessageList(t):this.listMode=="mdnlist"?this.loadMdnList(t):this.listMode=="mdnread"&&this.loadMdnRead(t)},this.reloadMessageList=function(e){e=e?!1:!0,this.listMode=="mail"?this.loadMessageList(this.listParam,e):this.listMode=="mdnlist"?this.loadMdnList(this.listParam,e):this.listMode=="mdnread"&&this.loadMdnRead(this.readParam,e)},this.sortMessage=function(e,t){var n=this.listParam;n==null&&(n={}),n.page=1,n.sortBy=e,n.sortDir=t,n.toolbarSort=!0,this.listParam=n,this.loadMessageList(n)},this.searchMessage=function(e){e=this.getSharedFolderParam(e),this.loadMessageList(e)},this.printMessageList=function(t){e.initSubMessage(),useSearch(!0),t.init?changeMailContainer("read"):changeMailContainer("list"),listDateStore=-1,currentMenu="list",e.listMode="mail",currentFolderType=t.folderType,currentFolderName=t.folderFullName,currentFolderViewName=t.folderName,isAllFolder=currentFolderType=="all"?!0:!1,isBookmark=t.bookmark,bookmarkType=t.listType,bookmarkName=currentFolderViewName,bookmarkValue=currentFolderName,bookmarkSeq=t.bookmarkSeq,t.extFolder=="on"&&(bookmarkType=t.extType,bookmarkValue=bookmarkType);var n="";Number(bookmarkSeq)>0?n="bookmark_title_"+t.bookmarkSeq:bookmarkType=="tag"?n="tag_link_"+t.tagId:isAllFolder?t.extFolder=="on"&&(n="ext_folder_link_"+bookmarkType):t.folderType=="shared"?n="shared_link_"+t.folderEncName:n="folder_link_"+t.folderEncName,selectCurrentFolderName(n);var r={};r.name=t.folderName,r.totalCnt=t.messageCount,r.unseenCnt=t.unreadMessageCount,r.bookmarkType=bookmarkType,r.bookmarkSeq=bookmarkSeq,r.isBookmark=isBookmark,r.isAllFolder=isAllFolder,r.folderType=t.folderType,r.extFolder=t.extFolder,r.flag=t.flag;if(bookmarkType=="tag"){bookmarkValue=t.tagId;var i=getTagInfo(bookmarkValue);r.type="tag",r.tagInfo=i}makeMailHeaderMessege(r),t.toolbarSort||e.makeListToolbar(t),e.makeMailListContent(t),t.pageInfo.out=!0,e.makeNavigation(t),isFirstLoad||executeFolderInfo(),isFirstLoad=!1,removeProcessLoader()},this.makeListToolbar=function(t){deleteWriteToolbarClass();var n=mailToolbarRuleMap.get(t.folderType);isPopupView()&&(n.isPopup=!0),jQuery("#toolbar_wrap").handlebars("mail_toolbar_tmpl",n);if(t.directRead)e.makeReadToolbar(t);else if(!isPopupView()&&t.pageInfo)if(n.layout){var r={layoutMode:layoutMode,pageBase:t.pageInfo.pageSize,refreshTime:getCookie("reflash_time"),isUseRefreshTime:isUseReflashTime,isAllFolder:isAllFolder};jQuery("#mailOptionBoxWrap").handlebars("mail_list_option_tmpl",r)}else{var r={pageBase:t.pageInfo.pageSize};jQuery("#mailOptionBoxWrap").handlebars("mail_list_option_page_tmpl",r)}},this.makeMailListContent=function(e){var t="mail_list_header_tmpl";e.locale=LOCALE,e.mailExposure=MAIL_EXPOSURE,e.companyDomainList=companyDomainList;var n="mail_list_tmpl";layoutMode=="v"&&e.folderType!="drafts"&&(t="mail_list_horizon_header_tmpl",n="mail_list_horizon_tmpl"),jQuery("#mail_list_content").handlebars(n,e),this.makeMailListPreview()},this.makeMailListPreview=function(){jQuery("#mail_list_content span.preview").tooltipster({theme:["tooltipster-noir","tooltipster-noir-customized"],delay:500,position:"bottom",minWidth:400,maxWidth:400,contentAsHTML:!0,functionBefore:function(e,t){var n=jQuery(t.origin).html(),r=jQuery(t.origin).data("preview"),i={subject:n,content:r};e.content(getHandlebarsTemplate("mail_list_content_preview",i))}})},this.closeMailListPreview=function(){jQuery("div.tooltipster-noir-customized").hide();var e=jQuery.tooltipster.instances();jQuery.each(e,function(e,t){t.close()})},this.makeNavigation=function(e){jQuery("#messageNaviWrap").handlebars("mail_navi_tmpl",e)},this.readMessage=function(t,n){this.readParam=clone(this.listParam),this.readParam.folder=t.folder,this.readParam.uid=t.uid,t.viewImg&&(this.readParam.viewImg=t.viewImg),this.readParam=this.getSharedFolderParam(this.readParam),ActionLoader.postSyncGoJsonLoadAction(this.readAction,this.readParam,function(t){e.printReadMessage(t)},"json"),google.sendPageView(this.readAction),!n&&!isPopupView()&&historyControl.setHistory({type:"read",param:t})},this.reloadReadMessage=function(){var t=e.readParam;e.readMessage(t,!0)},this.printReadMessage=function(t){if(t.readResult&&t.readResult=="fail"){jQuery.goAlert(mailMsg.mail_not_found_message,"",function(){POPUPREAD?(isReloadReady()&&opener.reloadMessageList(),window.close()):layoutMode!="n"&&e.reloadMessageList()});return}changeMailContainer("read"),currentMenu="read",e.listMode="mail";var n="on"==getCookie("rcpt_hidden");t.isRcptHidden=n,e.makeMailReadContent(t),e.makeReadToolbar(t),e.makeNDRGuide(t),mailReadInit(t),executeFolderInfo(),POPUPREAD&&(document.title=t.msgContent.subject+" - "+document.title,POPUPREAD=!1);var r=e.readParam;r&&(r.page=t.page,e.readParam=r);var i=e.listParam;i&&(i.page=t.page,e.listParam=i)},this.makeNDRGuide=function(e){var t=e.msgContent.subject;t.indexOf("[NDR]")==0&&jQuery("#ndrGuide").show().handlebars("mail_ndr_guide_tmpl")},this.makeMailReadContent=function(t){t.useWebfolder=USE_WEBFOLDER,t.useContact=USE_CONTACT&&MAIL_EXPOSURE,t.useCalendar=USE_CALENDAR,t.mailExposure=MAIL_EXPOSURE,t.msgContent.htmlContent=e.convertMSWordTag(t.msgContent.htmlContent),t.msgContent.htmlContent=e.convertIcalTemplate(t.msgContent.icalList)+t.msgContent.htmlContent,layoutMode=="n"&&jQuery("#mailListAllCheck").hide(),jQuery("#mailReadArea").handlebars("mail_read_tmpl",t),this.hideLabel("mailReadArea")},this.convertIcalTemplate=function(e){if(!e||e.length==0)return"";for(var t=0;t<e.length;t++){var n=e[t].icalRecurrence;e[t].icalRecurrenceMsg="",n!=""&&n!=null&&(e[t].icalRecurrenceMsg=recurrenceParser(e[t].icalRecurrence),e[t].icalStartDate="");var r=jQuery.trim(e[t].icalSubject);if(r==""||r==null)e[t].icalSubject=mailMsg.header_nosubject}return getHandlebarsTemplate("mail_icalendar_tmpl",e)},this.hideLabel=function(e){var t={to:[],cc:[]};jQuery.each(["to","cc"],function(n,r){var i=jQuery("#"+e).find("li[data-type="+r+"]");if(i.length>20){t[r]=jQuery("#"+e).find("li[data-type="+r+"]:gt(19)"),t[r].attr("data-more","").hide();var s=['<li evt-rol="moreLabel" data-type="'+r+'" class="add">','<span class="name">',"<span data-label>",mailMsg.mail_more,"</span>",'<span class="ic ic_arrow_down" title="'+mailMsg.mail_more+'"></span>',"</span>","</li>"];i.parent("ul").append(s.join(""))}}),jQuery("#"+e+" li[evt-rol='moreLabel']").on("click",function(e){var n=jQuery(e.currentTarget),r=n.attr("data-type"),i=t[r].is(":visible"),s=i?mailMsg.mail_more:mailMsg.mail_fold;n.find("span[data-label]").text(s),n.find("span.ic").toggleClass("ic_arrow_down").toggleClass("ic_arrow_up"),t[r].toggle(!i)})},this.convertMSWordTag=function(e){if(isMsie9||isMsie8||isMsie7){if(e==null)return e;var t=""+e;return t=t.replace(/&lt;!--\[[^-->]*\]--&gt;/gi,""),t=t.replace(/<!--\[[^-->]*\]-->/gi,""),t=t.replace(/(xmlns=")[\\s\\S]*[^"]*/gi,""),t}return e},this.removeSignAnnotation=function(e){if(e==null)return"";var t=""+e;return t=t.replace(/&lt;!--sign Area start--&gt;/gi,""),t=t.replace(/<!--sign Area start-->/gi,""),t=t.replace(/&lt;!--sign Area end--&gt;/gi,""),t=t.replace(/<!--sign Area end-->/gi,""),t},this.makeReadToolbar=function(e){deleteWriteToolbarClass(),isPopupView()&&(e.isPopup=!0),currentMenu=="read"&&layoutMode=="n"&&jQuery("#mailOptionBoxWrap").handlebars("mail_read_optionbox_tmpl",e)},this.downloadMessages=function(e){jQuery("#reqFrame").attr("src",this.downloadMessageAction+"?"+jQuery.param(e))},this.downloadAttachFile=function(e){if(TABLET||MOBILE){var t=window.location.protocol+"//"+window.location.host;url=this.downloadAttachFileAction+"?"+jQuery.param(e),window.location=t+url}else jQuery("#reqFrame").attr("src",this.downloadAttachFileAction+"?"+jQuery.param(e))},this.downloadTnefAttachFile=function(e){jQuery("#reqFrame").attr("src",this.downloadTnefAttachFileAction+"?"+jQuery.param(e))},this.downloadAllAttachFile=function(t){makeProcessLoader(),ActionLoader.postGoJsonLoadAction(this.downloadAllAttachFileAction,t,function(t){var n={downloadFileName:t.downloadFileName,zipFileName:t.zipFileName};jQuery("#reqFrame").attr("src",e.downloadAllAttachFileAction+"?"+jQuery.param(n)),removeProcessLoader()})},this.removeAttachFile=function(t){ActionLoader.postGoLoadAction(this.removeAttachFileAction,t,function(t){e.readParam.uid=t,layoutMode!="n"&&e.reloadMessageList(),e.readMessage(e.readParam,!0),isReloadReady()&&opener.reloadMessageList(),removeProcessLoader()},"json")},this.removeAllAttachesFromMessage=function(t){ActionLoader.postGoJsonLoadAction(this.removeAllAttachesFromMessageAction,t,function(t){jQuery.goSlideMessage(mailMsg.mail_complete_delete_mail,"caution"),(layoutMode!="n"&&currentMenu=="read"||currentMenu!="read")&&e.reloadMessageList();if(layoutMode!="n"||currentMenu=="read")t>0?(e.readParam.uid=t,e.readMessage(e.readParam,!0)):e.initSubMessage();isReloadReady()&&opener.reloadMessageList(),removeProcessLoader()},"json")},this.readNestedMessage=function(t){ActionLoader.postGoJsonLoadAction(this.readNestedAction,t,function(n){n.useWebfolder=USE_WEBFOLDER,n.msgContent.htmlContent=e.convertMSWordTag(n.msgContent.htmlContent),n.msgContent.htmlContent=e.convertIcalTemplate(n.msgContent.icalList)+n.msgContent.htmlContent,n.folderName=t.folderName,n.uid=t.uid,n.orgPart=t.part,n.nestedPart=t.nestedPart?t.nestedPart:t.part?t.part:"",jQuery("#popupBodyWrap").handlebars("mail_nested_read_tmpl",n)},"json"),google.sendPageView(this.readNestedAction)},this.writeMessage=function(t,n){this.writeParam=t,makeProcessLoader(),ActionLoader.postGoJsonLoadAction(this.writeAction,t,function(t){jQuery.getJSON("/resources/js/conf/editor/editor.config.json",function(n){LOCAL_DOMAIN=t.localDomain?t.localDomain:"",TABLET&&(t.editorMode="text"),changeMailContainer("write"),currentMenu="write",t.isPopupWrite=isPopupWrite,notiMode=t.notiMode,e.writeData=t,e.setSharedFolderParam(t),e.convertSendData(t),e.convertInitSendData(t),e.makeMailWriteToolbar(t),e.makeMailWriteContent(t,n),mailWriteInit(t),TABLET&&jQuery("#writeChangeEditorWrap").hide(),isMaxSendMailCountUse=t.sendMailCount.maxSendMailCountUse,maxSendMailCount=t.sendMailCount.maxSendMailCount,removeProcessLoader(),t.isPopupWrite||e.initWritePageScroll()}).fail(function(e,t,n){console.warn("editor.config.json\ud30c\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.")})},"json"),google.sendPageView(this.writeAction),n||historyControl.setHistory({type:"empty"})},this.initWritePageScroll=function(){var e=jQuery(window).height(),t=jQuery("#mailHeaderWrap").outerHeight(),n=jQuery("#write_toolbar_wrap").outerHeight(),r=e-t-n-10;jQuery("#mailWriteArea").css({"overflow-y":"auto",height:r+"px"})},this.reloadWriteMessage=function(){this.writeMessage(this.writeParam,!0)},this.convertSendData=function(e){this.sendData={},this.sendData.senderEmail=e.senderEmail,this.sendData.senderName=e.senderName,this.sendData.sendType=e.writeType,this.sendData.sendFlag=e.sendFlag,this.sendData.charset=e.encoding,this.sendData.folderName=e.folderName,this.sendData.uids=e.uids,this.sendData.orgMessageId=e.orgMsgId,this.sendData.draftMessageId=e.draftMsgId,e.defaultSignSeq&&e.defaultSignSeq>0&&(this.sendData.attachsign=e.signAttach,this.sendData.signSeq=e.defaultSignSeq),this.sendData.signLocation=e.signLocation,this.sendData.bannerDisplay=e.bannerDisplay,this.sendData.bannerContent=e.bannerContent},this.convertInitSendData=function(e){this.initSendData={},this.initSendData.senderEmail=e.senderEmail,this.initSendData.senderName=e.senderName,this.initSendData.sendType=e.writeType,this.initSendData.sendFlag=e.sendFlag,this.initSendData.charset=e.encoding,this.initSendData.folderName=e.folderName,this.initSendData.uids=e.uids,this.sendData.orgMessageId=e.orgMsgId,this.initSendData.draftMessageId=e.draftMsgId,e.defaultSignSeq&&e.defaultSignSeq>0&&(this.initSendData.attachsign=e.signAttach,this.initSendData.signSeq=e.defaultSignSeq),this.initSendData.signLocation=e.signLocation,this.initSendData.bannerDisplay=e.bannerDisplay,this.initSendData.bannerContent=e.bannerContent},this.getWriteData=function(){return this.writeData},this.getSendData=function(){return this.sendData},this.setSendData=function(e){this.sendData=e},this.getInitSendData=function(){return this.initSendData},this.makeMailWriteContent=function(t,n){var r=n.config.mailWritePrefixHtml,i=BASECONFIG.data.editorConfig,s="SmartEditor",o=i&&i.editorName?i.editorName:s,u=!GO.Editor.isIE()&&GO.Editor.isActiveXType(o)?s:o;r||(console.warn("(daou office) editor.config.json \ud30c\uc77c\uc744 \ucd5c\uc2e0\uc73c\ub85c \uc801\uc6a9\ud574\uc8fc\uc138\uc694."),r={activeDesigner:"<P>&nbsp;</P><P>&nbsp;</P>",dext5:"<P>&nbsp;</P><P>&nbsp;</P>",smartEditor:"<br><p><br></p><p><br></p><br>"});var a=r.activeDesigner,f=r.dext5,l=r.smartEditor,c="",h={ActiveDesigner:function(){c=a},Dext5Editor:function(){c=f},SmartEditor:function(){c=l}};h[o]();var p="",d="",v=e.removeSignAnnotation(t.htmlContent),m=e.removeSignAnnotation(t.textContent);t.sendFlag=="forwardAttached"&&(t.signLocation="outside",v="<div style='font-weight:bold;text-align:center'>"+mailMsg.mail_forwardmessage+"</div><br><br>",m="* "+mailMsg.mail_forwardmessage),t.signAttach&&t.writeType!="drafts"&&t.writeType!="rewrite"?t.signLocation=="inside"?(p="<span>&nbsp;</span><!--sign Area start-->"+t.signContent+"<!--sign Area end-->"+v,d="\n\n"+t.textSignContent+m):(p=v+"<span>&nbsp;</span><!--sign Area start-->"+t.signContent+"<!--sign Area end-->",d=m+"\n\n"+t.textSignContent):(p=v,d=m);if(!t.signAttach&&t.sendFlag=="normal"||t.folderName=="Drafts"||t.sendFlag=="draftForwardAttached"||t.sendFlag=="forward"&&t.writeType=="drafts"||t.writeType=="rewrite")c="";t.htmlContent=c+e.convertMSWordTag(p),t.textContent=e.convertMSWordTag(d),EDITOR_TYPE=u,t.useContact=USE_CONTACT,t.useWebfolder=USE_WEBFOLDER,jQuery("#mailWriteArea").handlebars("mail_write_tmpl",t)},this.makeMailWriteToolbar=function(e){jQuery("div[data-tag=write_toolbar_wrap]").handlebars("mail_write_toolbar_tmpl",e),addWriteToolbarClass()},this.sendMessage=function(t){t.sendType!="draft"&&(makeProcessLoader(),google.sendPageView(this.sendAction)),t=this.getSharedFolderParam(t),ActionLoader.postGoJsonLoadAction(this.sendAction,t,function(n){if(t.sendType=="draft"){if(!n.sendError){var r=mailControl.getSendData();r.draftMessageId=n.messageId,jQuery.goSlideMessage(mailMsg.mail_drafts_success)}isAutoSave=!1}else e.sendMessageResult(n),removeProcessLoader(),executeFolderInfo(),destroyBasicUploadControl(),destroyMassUploadControl(),destoryEditorControl();isSendWork=!1},"json")},this.autoSaveMessage=function(e){e=this.getSharedFolderParam(e),ActionLoader.postGoJsonLoadAction(this.autoSaveAction,e,function(e){resultAutoSave(e)},"json")},this.sendMessageResult=function(e){currentMenu="send",e.pageMode=CURRENT_PAGE_NAME,e.useContact=USE_CONTACT&&MAIL_EXPOSURE,e.mailExposure=MAIL_EXPOSURE,jQuery("#mailSendArea").handlebars("mail_send_tmpl",e),jQuery("#toolbar_wrap").empty(),jQuery("div[data-tag=write_toolbar_wrap]").empty(),changeMailContainer("send")},this.loadMdnList=function(t,n){t=t?t:{},this.listParam=t,ActionLoader.postGoLoadAction(this.mdnListAction,t,e.printMdnList,"json"),google.sendPageView(this.mdnListAction),n||historyControl.setHistory({type:"mdnlist",param:t})},this.printMdnList=function(t){e.listMode="mdnlist",currentMenu="list",changeMailContainer("list"),useSearch(!1);var n={type:"mdn",name:mailMsg.menu_receivenoti};makeMailHeaderMessege(n),t.pageInfo.out=!0,e.makeMdnListToolbar(t),e.makeMdnListContent(t),e.makeNavigation(t),removeProcessLoader()},this.makeMdnListToolbar=function(e){deleteWriteToolbarClass(),jQuery("#toolbar_wrap").handlebars("mail_mdn_list_toolbar_tmpl",e)},this.makeMdnListContent=function(e){e.mailExposure=MAIL_EXPOSURE,jQuery("#mail_list_content").handlebars("mail_mdn_list_tmpl",e)},this.loadMdnRead=function(t,n){this.readParam=t,ActionLoader.postGoLoadAction(this.mdnReadAction,t,e.printMdnRead,"json"),google.sendPageView(this.mdnReadAction),n||historyControl.setHistory({type:"mdnread",param:this.readParam})},this.printMdnRead=function(t){e.listMode="mdnread",currentMenu="list",changeMailContainer("list");var n={type:"mdn",name:mailMsg.menu_receivenoti};makeMailHeaderMessege(n),t.subject=e.readParam.subject,t.dateUtc=e.readParam.dateUtc,t.pageInfo.out=!0,e.makeMdnReadToolbar(t),e.makeMdnReadContent(t),e.makeNavigation(t),removeProcessLoader()},this.makeMdnReadToolbar=function(e){deleteWriteToolbarClass(),jQuery("#toolbar_wrap").handlebars("mail_mdn_read_toolbar_tmpl",e)},this.makeMdnReadContent=function(e){e.mailExposure=MAIL_EXPOSURE,e.companyDomainList=companyDomainList,jQuery("#mail_list_content").handlebars("mail_mdn_read_tmpl",e)},this.deleteMdn=function(t){makeProcessLoader(),ActionLoader.postGoLoadAction(this.deleteMdnAction,t,function(t){removeProcessLoader(),jQuery.goSlideMessage(mailMsg.mail_complete_delete_mail,"caution"),e.reloadMessageList()},"json")},this.recallMessage=function(t){ActionLoader.postGoLoadAction(this.recallMessageAction,t,function(t){e.processRecallResult(t)},"json")},this.processRecallResult=function(t){t.ignoreEmailList&&t.ignoreEmailList.length>0||t.failEmailList&&t.failEmailList.length>0||t.externalEmailList&&t.externalEmailList.length>0?jQuery.goPopup({id:"recallFailAddressPopup",pclass:"layer_normal layer_confim",width:500,header:mailMsg.mail_mdn_message_recall_004,contents:getHandlebarsTemplate("mail_mdn_recall_fail_tmpl",t),closeCallback:function(){e.reloadMessageList()},buttons:[{btype:"close",autoclose:!0,btext:mailMsg.comn_close}]}):(jQuery.goMessage(mailMsg.mail_mdn_message_recall_008),e.reloadMessageList())},this.sendMdnResponse=function(e){ActionLoader.postGoJsonLoadAction(this.sendMdnResponseAction,e,function(e){jQuery.goMessage(mailMsg.mail_send_success)},"json")},this.getSearchQueryList=function(){ocxUploadVisible(!1),ActionLoader.getGoLoadAction(this.listSearchQueryAction,null,function(t){var n={};n.searchAllFolder=searchAllFolder,n.folderList=folderControl.getUserFolderList(),n.queryList=t,jQuery("#detailSearchLayerWrap").handlebars("mail_detail_search_tmpl",n),jQuery("#adStartDate").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:""}),jQuery("#adEndDate").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:""});var r=e.isMailAttachSearch();r&&jQuery("#adAttachContentSearch").show(),jQuery("#detailSearchLayerWrap").show(),jQuery(document).trigger("showLayer.goLayer")},"json")},this.getUnifiedSearchFolderList=function(){jQuery("#detailSearchLayerWrap").handlebars("mail_unified_detail_search_tmpl",{}),jQuery("#fromDate").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:""}),jQuery("#toDate").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearSuffix:""}),ocxUploadVisible(!1),jQuery("#detailSearchLayerWrap").show()},this.saveSearchQuery=function(t){jQuery.ajax({url:this.saveSearchQueryAction,dataType:"json",type:"POST",data:t,success:function(){e.getSearchQueryList()},error:function(e){var t=JSON.parse(e.responseText);e.ignoreProcessLoader=!0,t.code!="401"&&jQuery.goSlideMessage(t.message,"caution")}})},this.deleteSearchQuery=function(t){ActionLoader.postGoLoadAction(this.deleteSearchQueryAction,t,function(t){e.getSearchQueryList()},"json")},this.updateReadModeOption=function(e){ActionLoader.postGoLoadAction(this.readModeOptionAction,e,function(t){contentSplitterChange(e.readMode)},"json")},this.updatePageBaseOption=function(t){ActionLoader.postGoLoadAction(this.pageBaseOptionAction,t,function(t){e.reloadMessageList()},"json")},this.listBigAttachFile=function(e){ActionLoader.postGoLoadAction(this.listBigAttachAction,null,function(t){e&&e(t)},"json")},this.deleteBigAttach=function(e,t,n){ActionLoader.postGoLoadAction(this.deleteBigAttachAction,e,function(e){t&&t(e)},"json",function(e){n&&n(e)})},this.getLetterList=function(e,t){ActionLoader.postLoadAction(this.listLetterAction,e,function(e){t&&t(e)},"json")},this.getDocTemplateList=function(e,t){ActionLoader.postLoadAction(this.listDocTemplateAction,e,function(e){t&&t(e)},"json")},this.getTemplateContent=function(e,t){ActionLoader.postLoadAction(this.readDocTemplateAction,e,function(e){t&&t(e)},"json")},this.updateAutoSaveInfo=function(e,t){var n={term:e};ActionLoader.postGoLoadAction(this.autoSaveOptionAction,n,function(e){t&&t(e)},"json")},this.getSignList=function(e){ActionLoader.getGoLoadAction(this.signListAction,null,function(t){e&&e(t)},"json")},this.signContent=function(e,t){ActionLoader.postGoLoadAction(this.signContentAction,e,function(e){t&&t(e)},"json")},this.getLastRcptList=function(){ActionLoader.getGoLoadAction(this.lastRcptListAction,null,function(e){var t=isRcptModeNormal?"#toRcptList,#ccRcptList,#bccRcptList":"#rcptList";jQuery(t).append(getHandlebarsTemplate("mail_write_last_rcpt_tmpl",e))},"json")},this.mailPreview=function(e){ActionLoader.postGoJsonLoadAction(this.previewAction,e,function(e){jQuery("#popupBodyWrap").handlebars("mail_preview_tmpl",e)},"json")},this.mailPrint=function(t){ActionLoader.postSyncGoJsonLoadAction(this.readAction,t,function(t){t.msgContent.htmlContent=e.convertMSWordTag(t.msgContent.htmlContent),t.msgContent.htmlContent=e.convertIcalTemplate(t.msgContent.icalList)+t.msgContent.htmlContent,jQuery("#popupBodyWrap").handlebars("mail_print_tmpl",t),jQuery("#mailViewArea").find("img").load(function(){jQuery(this).width()>800&&jQuery(this).attr({width:"100%"})}),e.hideLabel("popupBodyWrap")},"json")},this.mailPreviewPrint=function(t){ActionLoader.postGoJsonLoadAction(this.previewAction,t,function(t){jQuery("#popupBodyWrap").handlebars("mail_preview_print_tmpl",t),e.hideLabel("popupBodyWrap"),jQuery("#mailViewArea").find("img").load(function(){jQuery(this).width()>800&&jQuery(this).attr({width:"100%"})})},"json")},this.mailReadPopup=function(t){ActionLoader.postSyncGoJsonLoadAction(this.readAction,t,function(t){jQuery("#mailReadArea").handlebars("mail_read_tmpl",t),e.hideLabel("mailReadArea")},"json")},this.mailSource=function(e){jQuery("#sourceFrame").attr("src",this.sourceAction+"?"+jQuery.param(e))},this.bigAttachUpdate=function(e,t){makeProcessLoader(),ActionLoader.postGoLoadAction(this.bigAttachUpdateAction,e,function(e){sendForBigAttach(e,t),removeProcessLoader()},"json")},this.loadExtMail=function(e){ActionLoader.getGoLoadAction(this.downloadExtMailAction,null,function(t){e&&e(t)},"json")},this.downloadOrderExtMail=function(t){ActionLoader.postGoLoadAction(this.downloadOrderExtMailAction,t,function(t){runCheckPop3Status(),e.downloadExtMail()},"json")},this.downloadExtMail=function(){ActionLoader.postGoLoadAction(this.downloadExtMailAction,{},function(e){},"json")},this.resetExtMail=function(e){ActionLoader.postGoLoadAction(this.resetExtMailAction,e,function(e){runCheckPop3Status()},"json")},this.makeToolbarTagList=function(e){jQuery("#toolbar_tag_list").handlebars("mail_tag_toolbar_tmpl",e)},this.deleteMessages=function(t){makeProcessLoader(),ActionLoader.postGoJsonLoadAction(this.deleteMessageAction,t,function(t){removeProcessLoader(),jQuery.goSlideMessage(mailMsg.mail_complete_delete_mail,"caution"),isPopupView()?(isReloadReady()&&opener.reloadMessageList(),window.close()):e.reloadMessageList(!0)},"json")},this.cleanMessages=function(t){makeProcessLoader(),ActionLoader.postGoJsonLoadAction(this.cleanMessageAction,t,function(t){removeProcessLoader(),jQuery.goSlideMessage(mailMsg.mail_complete_delete_mail,"caution"),isPopupView()?(isReloadReady()&&opener.reloadMessageList(),window.close()):e.reloadMessageList()},"json")},this.copyMessage=function(t){t=this.getSharedFolderParam(t),ActionLoader.postGoJsonLoadAction(this.copyMessageAction,t,function(t){isReloadReady()?opener.reloadMessageList():e.reloadMessageList()},"json",function(e){jQuery.goSlideMessage(e.message,"caution")})},this.moveMessage=function(t){ActionLoader.postGoJsonLoadAction(this.moveMessageAction,t,function(t){isPopupView()?(isReloadReady()&&opener.reloadMessageList(),window.close()):e.reloadMessageList(!0)},"json",function(e){jQuery.goSlideMessage(e.message,"caution")})},this.addResistRule=function(e,t){ActionLoader.postGoJsonLoadAction(this.addResistRuleAction,e,function(n){t&&t(e.ruleType)},"json")},this.searchAddressByKeyowrd=function(e,t){ActionLoader.postGoLoadAction(this.searchAddressesAction,e,function(e){t&&t(e)},"json")},this.allSelectMessageProcess=function(t){makeProcessLoader(),ActionLoader.postGoJsonLoadAction(this.allSelectMessageProcessAction,t,function(n){removeProcessLoader(),(t.actionType=="delete"||t.actionType=="clean")&&jQuery.goSlideMessage(mailMsg.mail_complete_delete_mail,"caution"),e.reloadMessageList()},"json",function(){jQuery.goAlert(mailMsg.allselect_action_error)})},this.saveMailFilter=function(e){ActionLoader.postGoJsonLoadAction(this.saveMailFilterAction,e,function(t){saveMessageFilterResult(e,t)},"json",function(e){e.name=="DuplicatedException"?jQuery.goMessage(mailMsg.conf_filter_exist):jQuery.goMessage(mailMsg.save_fail)})},this.sortFilterMessage=function(t){ActionLoader.postGoJsonLoadAction(this.sortFilterMessageAction,t,function(t){removeProcessLoader(),isPopupView()?(isReloadReady()&&opener.reloadMessageList(),window.close()):e.reloadMessageList()},"json")},this.saveMemberAddress=function(e){var t=JSON.stringify(e);jQuery.ajax({url:"/api/contact/personal/contact",type:"post",contentType:"application/json",dataType:"json",data:t}).done(function(e){e.code=="200"&&e.message=="OK"&&jQuery.goAlert(mailMsg.alert_addr_add)})},this.registBayesianRule=function(t){ActionLoader.postGoLoadAction(this.registBayesianRuleAction,t,function(t){jQuery.goMessage(mailMsg.bayesian_submitmsg),e.reloadReadMessage()},"json",function(){jQuery.goMessage(mailMsg.bayesian_submitmsg_error)})},this.messageIntegrity=function(e,t){ActionLoader.postGoLoadAction(this.messageIntegrityAction,e,function(e){t&&t(e)},"json")},this.getListParam=function(){return this.listParam},this.setListParam=function(e){this.listParam=e,e.sharedFlag&&e.sharedFlag=="shared"&&(this.sharedFlag=!0)},this.webfolderAttachSave=function(e,t){ActionLoader.postGoJsonLoadAction(this.webfolderAttachSaveAction,e,function(e){jQuery.goAlert(mailMsg.mail_attach_webfolder_save,mailMsg.mail_attach_webfolder_save_ok)},"json",function(e){var t=mailMsg.mail_attach_webfolder_save_fail;e.message&&(t=e.message),jQuery.goAlert(mailMsg.mail_attach_webfolder_save,t)})},this.webfolderWriteAttach=function(e,t){ActionLoader.postGoJsonLoadAction(this.webfolderAttachWriteAction,e,function(e){t&&t(e)},"json",function(){jQuery.goAlert(mailMsg.alert_attachFile)})},this.readMailUserSender=function(e){ActionLoader.getGoLoadAction(this.readMailUserSenderAction,null,function(t){e&&e(t)},"json")},this.listSendAllow=function(e){ActionLoader.getGoLoadAction(this.listSendAllowAction,null,function(t){e&&e(t)},"json")},this.checkSendAllow=function(e,t){ActionLoader.postSyncGoLoadAction(this.checkSendAllowAction,e,function(e){t&&t(e)},"json")},this.isMailAttachSearch=function(){var e=!1;return ActionLoader.getSyncGoLoadAction(this.isMailAttachSearchAction,null,function(t){e=t},"json"),e},this.makeMailEvent=function(){var t={everyPreFunc:function(){closeMailFolderOptionLayer()}},n=new EventControl("#mainContentWrap","click","a,span,ins,li,p,tr,td",t);n.add("switch-flag",function(e){var t=jQuery(e).attr("flag"),n="on"==jQuery(e).attr("flaged"),r=jQuery(e).closest("tr").attr("id");switchFlagFlaged([r],t,!n)}),n.add("switch-flag-read",function(t){var n=jQuery(t).attr("flag"),r="on"==jQuery(t).attr("flaged"),i=jQuery("#folderName").val(),s=jQuery("#msgUid").val();e.switchMessagesFlags([s],[i],n,!r,!0)}),n.add("toolbar",function(t){e.executeToolbarAction(t)}),n.add("check-reserved",function(t){var n=e.getSendData(),r=n.secureMail;if(r){jQuery.goAlert(mailMsg.mail_setting_error,mailMsg.write_alert004);return}openReservedLayerPopup(),jQuery(document).trigger("showLayer.goLayer")}),n.add("check-securemail",function(t){var n=e.getSendData(),r=n.reserveMail;if(r){jQuery.goAlert(mailMsg.mail_setting_error,mailMsg.write_alert004);return}openSecureMailLayerPopup(),jQuery(document).trigger("showLayer.goLayer")}),n.add("list-sort",function(t){var n=jQuery(t),r=n.attr("by"),i=n.hasClass("sorting_desc")?"asce":"desc";jQuery("#toolbar_sort_flag li").removeClass("sorting_desc sorting_asce"),jQuery("#toolbar_sort_flag span.sort").removeClass("ic_toolbar sort_up sort_down"),i=="asce"?(n.addClass("sorting_asce"),n.find("span.sort").addClass("ic_toolbar sort_up")):(n.addClass("sorting_desc"),n.find("span.sort").addClass("ic_toolbar sort_down")),e.sortMessage(r,i)}),n.add("toolbar-quick-search",function(e){var t=jQuery(e).attr("data-type");console.log(t),viewQuickList(t)}),n.add("list-page-move",function(t){var n=jQuery(t).attr("page");e.movePage(n),jQuery("#mail_list_content").scrollTop(0)}),n.add("reload-list",function(t){e.reloadMessageList(!0)}),n.add("reload-mdn-list",function(t){e.loadMdnList(e.listParam)}),n.add("read-message-simple",function(e){var t=jQuery(e).attr("folder"),n=jQuery(e).attr("uid");readMessage(t,n)}),n.add("read-message-simple-relation",function(t){var n=jQuery(t).attr("folder"),r=jQuery(t).attr("uid"),i={folder:unescape_tag_title(n)};i=e.getSharedFolderParam(i),layoutMode!="n"&&mailControl.loadMessageList(i,!0,!0,!0),readMessage(n,r)}),n.add("read-message",function(t){e.closeMailListPreview();var n=jQuery(t).closest("tr").attr("folder"),r=jQuery(t).closest("tr").attr("uid");readMessage(n,r)}),n.add("read-message-popup",function(e){var t=jQuery(e).closest("tr").attr("folder"),n=jQuery(e).closest("tr").attr("uid");readMessagePopup(t,n)}),n.add("read-message-relation-popup",function(e){var t=jQuery(e).attr("folder"),n=jQuery(e).attr("uid");readMessagePopup(t,n)}),n.add("draft-message",function(e){var t=jQuery(e).closest("tr").attr("folder"),n=jQuery(e).closest("tr").attr("uid");writeDraftMessage(t,n)}),n.add("mail-read-close-sender-list",function(e){jQuery("#mailReadSenderListWrap").hide(),jQuery(e).hide(),jQuery(e).parent().find(".ic_arrow_down_type4").show(),setCookie("rcpt_hidden","on",365)}),n.add("mail-read-open-sender-list",function(e){jQuery("#mailReadSenderListWrap").show(),jQuery(e).hide(),jQuery(e).parent().find(".ic_arrow_up_type4").show(),setCookie("rcpt_hidden","off",365)}),n.add("mail-read-open-relation-list",function(e){jQuery(e).hide(),jQuery(e).parent().find(".btn_slide_hide").show(),jQuery("#relationContentWrap").show()}),n.add("mail-read-close-relation-list",function(e){jQuery(e).hide(),jQuery(e).parent().find(".btn_slide_show").show(),jQuery("#relationContentWrap").hide()}),n.add("download-attach",function(e){var t=jQuery(e).attr("evt-data");if(t&&t!="")attachChecklayer();else{var n=jQuery("#folderName").val(),r=jQuery("#msgUid").val(),i=jQuery(e).closest("li").attr("part");downloadAttach(n,r,i)}}),n.add("preview-attach",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val(),r=jQuery(e).closest("li").attr("part");previewAttach(n,t,r)}),n.add("save-webfolder",function(e){var t=jQuery(e).attr("evt-data");if(t&&t!="")attachChecklayer();else{var n=jQuery("#folderName").val(),r=jQuery("#msgUid").val(),i=jQuery(e).closest("li").attr("part"),s={folderName:n,uid:r,part:i};jQuery("#shared_folder_wrap").find("p.title.on").length>0&&(s.sharedUserSeq=jQuery("#shared_folder_wrap").find("p.title.on").children().attr("seq"),s.sharedFolderName=n,s.sharedFlag="shared"),openWebfolderPopup(s)}}),n.add("read-view-img",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val();readViewImg(t,n)}),n.add("regist-bayesian-rule",function(e){var t=jQuery(e).data("type"),n=jQuery("#folderName").val(),r=jQuery("#msgUid").val();registBayesianRuleMessage(t,n,r)}),n.add("download-attach-all",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val(),r="";jQuery("#attachListWrap li:not(.deleted)").each(function(){r+=r==""?r:"_",r+=jQuery(this).attr("part")});if(r==""){jQuery.goAlert(mailMsg.mail_attach,mailMsg.alert_download_nofile);return}jQuery.goAlert(mailMsg.mail_attach_all_save_title,mailMsg.mail_attach_all_save_message),downloadAllAttach(t,n,r)}),n.add("delete-attach",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val(),r=jQuery(e).closest("li").attr("part");deleteAttachFile(t,n,r)}),n.add("delete-attach-all",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val(),r="";jQuery("#attachListWrap li").each(function(){jQuery(this).hasClass("deleted")||(r+=r==""?r:"_",r+=jQuery(this).attr("part"))}),deleteAllAttach(t,n,r)}),n.add("read-nested-pop",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val(),r=jQuery(e).closest("li").attr("part");readNestedMessage(t,n,r)}),n.add("help-accordion-collapse",function(e){var t=jQuery(e),n=t.data("id"),r=jQuery("#"+n);t.hasClass("on")?t.removeClass("on"):t.addClass("on"),r.slideToggle("fast")}),n.add("download-tnef-attach",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val(),r=jQuery(e).closest("li").attr("part"),i=jQuery(e).attr("attkey");downLoadTnefAttach(t,n,r,i)}),n.add("view-message-source",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val();viewSource(t,n)}),n.add("view-ndr-guide",function(e){viewNdrGuide()}),n.add("registration-schedule",function(e){var t=jQuery("#messageListId").attr("subject");viewRegistrationSchedule(t)}),n.add("print-message",function(e){printMessage()}),n.add("confirm-integrity",function(e){var t=jQuery("#folderName").val(),n=jQuery("#msgUid").val();confirmIntegrity(t,n)}),n.add("write-toggle-bccwrap",function(e){jQuery(e).hasClass("ic_arrow_down_type4")?(jQuery(e).removeClass("ic_arrow_down_type4").addClass("ic_arrow_up_type4").attr("title",mailMsg.comn_close),jQuery("#writeBccWrap").show()):(jQuery(e).removeClass("ic_arrow_up_type4").addClass("ic_arrow_down_type4").attr("title",mailMsg.comn_open),jQuery("#writeBccWrap").hide())}),n.add("attach-area-toggle",function(e){var t=jQuery(e),n=t.hasClass("ic_arrow_up_type4");getCookie("OcxUpload")=="on"?jQuery("#att_ocx_area").toggle(!n):jQuery("#att_simple_area").toggle(!n),t.toggleClass("ic_arrow_down_type4").toggleClass("ic_arrow_up_type4"),setCookie("isAttachAreaFolded",n,365)}),n.add("write-toggle-massRcptwrap",function(e){var t="on";jQuery(e).hasClass("ic_arrow_down_type4")?(jQuery(e).removeClass("ic_arrow_down_type4").addClass("ic_arrow_up_type4").attr("title",mailMsg.comn_close),jQuery("#massRcptwrap").show(),t="off"):(jQuery(e).removeClass("ic_arrow_up_type4").addClass("ic_arrow_down_type4").attr("title",mailMsg.comn_open),jQuery("#massRcptwrap").hide()),setCookie("DO_MASSRCPT_CLOSE",t,365)}),n.add("bigattach-manage",function(e){viewBigAttachManager()}),n.add("open-write-webfolder",function(e){openWriteWebfolder()}),n.add("letter-layer",function(e){getLetterListLayer()}),n.add("write-change-editor",function(e){getWriteModeLayer()}),n.add("write-mode-change",function(e){var t=jQuery(e).data("mode");chgEditorMod(t)}),n.add("template-layer",function(e){getDocTemplateList()}),n.add("layer-list-page-move",function(e){var t=jQuery("#pageNaviLayerWrap").data("type"),n=jQuery(e).attr("page");t=="letter"?getLetterListLayer(n):t=="docTmpl"&&getDocTemplateList(n)}),n.add("send-message",function(e){if(!contentValidation())return;sendMessage()}),n.add("send-draft",function(e){if(!contentValidation())return;doDraftSave()}),n.add("receive-noti-read",function(e){var t=jQuery(e).attr("messageId"),n=jQuery(e).attr("subject"),r=jQuery(e).attr("date"),i={messageId:t,subject:n,dateUtc:r};mailControl.loadMdnRead(i)}),n.add("add-message-tagging",function(e){var t=jQuery(e).closest("li").data("tid");messageTaggingManager(t,"true")}),n.add("remove-message-tagging",function(e){var t=jQuery(e).closest("li").data("tid");messageTaggingManager(t,"false")}),n.add("self-remove-message-tagging",function(e){var t=jQuery(e).data("tagid"),n,r;if(currentMenu=="read")n=jQuery("#folderName").val(),r=jQuery("#msgUid").val();else{var i=jQuery(e).closest("tr");n=i.attr("folder"),r=i.attr("uid")}selfRemoveMessageTagging(n,r,t)}),n.add("change-flag-seen",function(e){changeSeenFlag(!0)}),n.add("change-flag-unseen",function(e){changeSeenFlag(!1)}),n.add("toolbar-folder",function(e){var t=jQuery(e).attr("fname");copyMoveMessage(t)}),n.add("toolbar-write-reply",function(e){replyWrite("reply")}),n.add("toolbar-write-replyall",function(e){replyWrite("replyall")}),n.add("toolbar-forward-parsed",function(e){forwardMessage("parsed")}),n.add("toolbar-forward-attached",function(e){forwardMessage("attached")}),n.add("toolbar-message-delete",function(e){deleteMessage()}),n.add("toolbar-message-erase",function(e){cleanMessage()}),n.add("toolbar-attach-delete",function(e){deleteMessageAttaches()}),n.add("toolbar-message-save",function(e){if(!checkListToolbarSelect())return;downloadMessage()}),n.add("toolbar-message-filter",function(e){if(!checkListToolbarSelect())return;addMessageFilter()}),n.add("toolbar-print",function(e){if(!checkListToolbarSelect())return;printMessage()}),n.add("toolbar-add-reject",function(e){if(!checkListToolbarSelect())return;registRejectAllow("black")}),n.add("toolbar-add-allow",function(e){if(!checkListToolbarSelect())return;registRejectAllow("white")}),n.add("toolbar-write-cancel",function(e){checkEscapeWriteMode(function(){mailControl.reloadWriteMessage()})}),n.add("toolbar-rewrite",function(e){if(!checkListToolbarSelect())return;reWrite()}),n.add("toolbar-change-mailmode",function(e){var t=jQuery(e).find("span").attr("id"),n=jQuery("#readMode_layer1"),r=jQuery("#readMode_layer2"),i=jQuery("#readMode_layer3");n.removeClass("ic_layer1 ic_layer1_active on"),r.removeClass("ic_layer2 ic_layer2_active on"),i.removeClass("ic_layer3 ic_layer3_active on"),t=="readMode_layer1"?(n.addClass("ic_layer1_active on"),r.addClass("ic_layer2"),i.addClass("ic_layer3")):t=="readMode_layer2"?(n.addClass("ic_layer1"),r.addClass("ic_layer2_active on"),i.addClass("ic_layer3")):(n.addClass("ic_layer1"),r.addClass("ic_layer2"),i.addClass("ic_layer3_active on")),saveLayoutOption()}),n.add("search-rcpt-address",function(e){searchRcptAddress()}),n.add("select-all-message-on",function(e){selectAllMessageOn()}),n.add("select-all-message-off",function(e){selectAllMessageOff()}),n.add("from-to-submenu",function(e){openAddrLayerPopup(e)}),n.add("layer-write-email",function(e){var t=jQuery(e).parent().data("email"),n={wtype:"normal",to:t};goWrieLoad(n),closeAddrLayerPopup(e)}),n.add("layer-save-addr",function(e){var t=jQuery(e).parent().data("email");addAddrBookEmail(t),closeAddrLayerPopup(e)}),n.add("layer-search-mail",function(e){var t=jQuery(e).parent().data("email"),n=get_email(t);searchMessage(n),closeAddrLayerPopup(e)}),n.add("goto-basic-setting",function(e){isPopupView()?(isReloadReady()&&opener.loadBasicSetting(),window.close()):loadBasicSetting()}),n.add("go-home",function(e){parent.GoInitMenu()}),n.add("write-mail",function(e){jQuery(window).scrollTop(0),goWrite()}),n.add("folder",function(e){var t=jQuery(e).attr("fname");goFolder(t)}),n.add("write-add-address",function(e){var t=jQuery(e).data("rcpt");openWriteAddrRcptPopup(t)}),n.add("write-mail-popup",function(e){var t="writePopup"+makeRandom();location.replace("/app/mail/popup",t,"scrollbars=yes,resizable=yes,width=1280,height=790")}),n.add("view-popup-allow-list",function(t){e.listSendAllow(function(e){viewSendAllow(e)})}),n.add("select-field",function(e){selectAddressFieldkeyEvt(jQuery(e).closest("li"))}),n.add("multi-select-field",function(e){var t=jQuery(e).closest("li");t.addClass("on")}),n.add("multi-select-fields",function(e){window.event?window.event.returnValue=!1:event.returnValue=!1;var t=jQuery(e).closest("li"),n=t.closest("ul.name_tag"),r=n.find("li:not(.creat)"),i=r.size();t.addClass("on");var s=r.first(),o=null,u=new Array;for(var a=0;a<i;a++)a==0?(s.hasClass("on")&&u.push(a),o=s.next()):(o.hasClass("on")&&u.push(a),o=o.next());for(var a=u[0];a<u[1];a++)for(var f=0;f<i;f++)f==0&&a==f?(s.addClass("on"),o=s.next()):f!=0&&a==f?(o.addClass("on"),o=o.next()):f==0?o=s.next():o=o.next()}),n.add("toggle-mail-folder",function(e){var t=jQuery(e).attr("status"),n=jQuery(e).closest("li").attr("depth");n=parseInt(n,10);var r=jQuery(e).closest("li").find("ul[depth='"+(n+1)+"']");t=="open"?(r.hide(),jQuery(e).removeClass("close").addClass("open").attr({status:"close",title:mailMsg.comn_open})):(r.show(),jQuery(e).removeClass("open").addClass("close").attr({status:"open",title:mailMsg.comn_close}))}),n.add("refresh-mail-list",function(e){makeProcessLoader(),mailControl.reloadMessageList()}),n.add("refresh-toolbar",function(t){e.makeSubToolbar(jQuery(t))}),n.add("select-refresh-time",function(e){setCookie("reflash_time",jQuery(e).attr("data-value"),365),jQuery("#toolbar_refresh_flag li .ic_check").each(function(){jQuery(this).hide()});var t=getCookie("reflash_time");jQuery("#toolbar_refresh_flag li").each(function(){jQuery(this).attr("data-value")==t&&jQuery(this).find(".ic_board.ic_check").show()}),t!="-1"?jQuery("#refresh_min_text").text(t):jQuery("#refresh_min_text").text("")}),n.add("layout-toolbar",function(t){e.makeLayoutSubToolbar(jQuery(t))}),n.add("sort-toolbar",function(t){e.makeSortAndSearchToolbar(jQuery(t))});var r=new EventControl("#mainContentWrap","click","input");r.add("list-select-all",function(e){var t=jQuery(e).attr("checked"),n=jQuery("#mail_list_content input:checkbox");n.each(function(){listCheckboxControl(jQuery(this),t)}),toggleAllCheckMessage(t)}),r.add("write-myself",function(e){var t=jQuery(e).attr("checked");makeWriteMyself(t)}),r.add("check-list",function(e){ReadSubMessageChecker.resetUid(),listCheckboxControl(jQuery(e),jQuery(e).attr("checked"))}),r.add("mod-field-inside",function(e){isModFieldInside=!0});var i=new EventControl("#mainContentWrap","click","ul");i.add("write-address-to",function(e){isModFieldInside||jQuery("#to").focus()}),i.add("write-address-cc",function(e){isModFieldInside||jQuery("#cc").focus()}),i.add("write-address-bcc",function(e){isModFieldInside||jQuery("#bcc").focus()});var s=new EventControl("#mainContentWrap","change","select");s.add("auto-save",function(e){var t=jQuery(e).val();chgAutoSaveTerm(t)}),s.add("select-rcpt-email",function(e){var t=jQuery(e).data("rcpt"),n=jQuery(e).val();selectRcptEmail(t,n),jQuery(e).val("")}),s.add("change-pagebase",function(e){savePageBase()}),s.add("change-sender-mail",function(e){jQuery(e).find("option:selected").attr("alias")=="true"&&jQuery.goPopup({id:"changeSenderMail",contents:"<p class='add'>"+mailMsg.mail_sender_email_alias_alert+"</p>",closeCallback:function(){jQuery("#senderUserEmail").val(previousSenderEmail)},buttons:[{btype:"confirm",btext:mailMsg.comn_confirm,autoclose:!1,callback:function(){jQuery.goPopup.close()}},{btype:"cancel",btext:mailMsg.comn_cancel}]})});var o=new EventControl("#mailHeaderWrap","click","a,:button,ins");o.add("mail-detail-search",function(e){toggleDetailSearchLayer()}),o.add("mail-search",function(e){searchMessage()}),o.add("add-bookmark",function(e){addBookmark()}),o.add("delete-bookmark",function(e){deleteBookmark()}),o.add("mail-search-cancel",function(e){cancelSearch()}),jQuery("#mainContentWrap").on("mouseover","#mail_list_content table:not(#mail_mdn_list_content,#mail_mdn_read_content) tr:not(.tb_option,.dateDesc)",function(e){makeDragEvent(jQuery(this))}),jQuery("#mailSearchKeyWord").on("keypress",function(e){e.which==13&&searchMessage()}).on("focus",function(){jQuery(this).parent().addClass("search_focus")}).on("blur",function(){jQuery(this).parent().removeClass("search_focus")})},this.makeSortAndSearchToolbar=function(e){var t=function(e,t){var n;e.bind({mouseover:function(){n&&clearTimeout(n)},mouseout:function(){n=setTimeout(function(){t.hide(),e.unbind(),t.unbind()},1e3)}}),t.bind({mouseover:function(){n&&clearTimeout(n)},mouseout:function(){n=setTimeout(function(){t.hide(),e.unbind(),t.unbind()},1e3)}})},n=e.parent().find("div.array_option");n.css("display")=="none"?(jQuery("#toolbar_wrap div.array_option").hide(),jQuery("div[data-tag=write_toolbar_wrap] div.array_option").hide(),n.show(),t(e,n)):(n.hide(),e.unbind(),n.unbind())},this.makeSubToolbar=function(e,t){var n=function(e,t){jQuery("#"+e+" *").unbind(),t.unbind()},r=e.parent().find("ul").attr("id"),i=jQuery("#"+r).closest("div.array_option");if(i.css("display")=="none"){jQuery("#toolbar_wrap div.array_option").hide(),jQuery("div[data-tag=write_toolbar_wrap] div.array_option").hide(),i.show();var s;e.bind("mouseover",function(){s&&clearTimeout(s)}),e.bind("mouseout",function(){s=setTimeout(function(){i.hide(),n(r,e)},1e3)}),jQuery("#"+r).parent().bind("mouseout",function(){s=setTimeout(function(){i.hide(),n(r,e)},1e3)}),jQuery("#"+r).parent().bind("mouseover",function(){s&&clearTimeout(s)}),t=="move"&&jQuery("#"+r).closest("div.array_option").bind("mouseover",function(){s&&clearTimeout(s)}),jQuery("#"+r+" > li").bind("click",function(){jQuery(this).parent().attr("auto-close")!="off"&&(i.hide(),n(r,e));var t=jQuery(this).attr("evt-rol");if(!t)return;if(t=="toolbar-quick-search"){var t=jQuery(this).data("type");viewQuickList(t)}})}else i.hide(),n(r,e)},this.makeLayoutSubToolbar=function(e,t){var n="toolbar_layout_flag",r=jQuery("#"+n).closest("div.array_option");if(r.css("display")=="none"){jQuery("#toolbar_wrap div.array_option").hide(),jQuery("div[data-tag=write_toolbar_wrap] div.array_option").hide(),r.show();var i;e.bind("mouseover",function(){i&&clearTimeout(i)}),e.bind("mouseout",function(){i=setTimeout(function(){r.hide(),jQuery("#"+n+" *").unbind(),e.unbind()},1e3)}),jQuery("#"+n+" > *").bind("mouseout",function(){i=setTimeout(function(){r.hide(),jQuery("#"+n+" *").unbind(),e.unbind()},1e3)}),jQuery("#"+n+" > *").bind("mouseover",function(){i&&clearTimeout(i)}),jQuery("#"+n+" > a").bind("click",function(){jQuery(this).parent().attr("auto-close")!="off"&&(r.hide(),jQuery("#"+n+" *").unbind(),e.unbind())})}else jQuery("#"+n+" *").unbind(),e.unbind(),r.hide()},this.makeMailHeaderMsg=function(e){getCookie("reflash_time")==""&&setCookie("reflash_time",-1,365);var t=getCookie("reflash_time");e.reflashTime=t;var n=e.folderType;if(n=="sent"||n=="drafts"||n=="reserved"||n=="spam"||n=="trash"||n=="all")isUseReflashTime=!1,runAutoReflashTime=null;else if(n=="inbox"||n=="normal")isUseReflashTime=!0;jQuery("#mail_header_msg").handlebars("mail_header_msg_tmpl",e),isUseReflashTime&&t>0&&runAutoReflashTime==null&&(runAutoReflashTime=setTimeout(function(){runAutoReflashProcess()},5e3))},this.getListMode=function(){return this.listMode},this.getCurrentFolder=function(){return this.currentFolder},this.taggingMessage=function(t){ActionLoader.postGoJsonLoadAction(this.taggingMessageAction,t,function(t){isReloadReady()?(opener.reloadMessagePopup(),opener.reloadMessageList()):currentMenu=="read"?e.reloadReadMessage():e.reloadMessageList()},"json")},this.executeToolbarAction=function(t){if(currentMenu=="list"||currentMenu=="read"&&layoutMode!="n"){var n="on"==jQuery(t).attr("ignore");if(!n&&getMailListCheckedCount()==0){if(e.listMode=="mdnread"){jQuery.goAlert(mailMsg.error_noselect);return}if(e.listMode=="mdnlist"){var r=jQuery(t).attr("evt-act");r=="toolbar-mdn-recall-all"?jQuery.goSlideMessage(mailMsg.mail_mdn_message_recall_001,"caution"):jQuery.goSlideMessage(mailMsg.mail_mdn_message_delete_001,"caution");return}jQuery.goAlert(mailMsg.mail_message_notselect);return}}var i="on"==jQuery(t).attr("sub"),s=jQuery(t).attr("menu");if(i)s=="tag"?makeTagToolbar():s=="copy"||s=="move"?makeCopyMoveToolbar():s=="forward"&&(jQuery("#toolbarForwardParsedMenu").show(),getMailListCheckedCount()>1&&jQuery("#toolbarForwardParsedMenu").hide()),e.makeSubToolbar(jQuery(t),s);else{var r=jQuery(t).attr("evt-act");switch(r){case"toolbar-write-preview":writePreview();break;case"toolbar-message-delete":e.listMode=="mdnlist"?deleteMdn():deleteMessage();break;case"toolbar-write-reply":replyWrite("reply");break;case"toolbar-forward-quick":getMailListCheckedCount()>1?forwardMessage("attached"):forwardMessage("parsed");break;case"change-flag-seen":changeSeenFlag(!0);break;case"toolbar-add-spam":addSpamWhiteRule("black");break;case"toolbar-add-white":addSpamWhiteRule("white");break;case"toolbar-mdn-recall":recallMsg();break;case"toolbar-mdn-recall-all":recallSelectMsg();break;case"toolbar-mdn-sent-view":var o=jQuery("#mdnReadUid").val();if(o<0){jQuery.goSlideMessage(mailMsg.mail_not_found_message,"caution");return}readMessagePopup("Sent",o);break;default:return}}}},FolderControl=function(){this.folderInfoAction="/api/mail/folder/info",this.folderAllInfoAction="/api/mail/folder/all",this.folderBasicInfoAction="/api/mail/folder/list",this.addFolderAction="/api/mail/folder/create",this.modifyFolderAction="/api/mail/folder/modify",this.deleteFolderAction="/api/mail/folder/delete",this.emptyFolderAction="/api/mail/folder/empty",this.sharedFolderReaderListAction="/api/mail/folder/share/reader",this.bookmarkListAction="/api/mail/bookmark/list",this.saveBookmarkAction="/api/mail/bookmark/save",this.updateBookmarkAction="/api/mail/bookmark/update",this.deleteBookmarkAction="/api/mail/bookmark/delete",this.changeBookmarkAction="/api/mail/bookmark/change",this.tagListAction="/api/mail/tag/list",this.addTagAction="/api/mail/tag/create",this.modifyTagAction="/api/mail/tag/modify",this.deleteTagAction="/api/mail/tag/delete",this.userFolderList=[],this.quotaInfo={},this.tagData=[];var e=this;this.updateFolderCountInfo=function(){var t={};ActionLoader.getGoLoadAction(this.folderInfoAction,t,function(t){e.printFolderCountUpdate(t),e.printFolderCountUpdateBookMark(t),makeMailBadgeCount()},"json")},this.printFolderCountUpdate=function(t){var n=t;if(n&&n.length>0)for(var r=0;r<n.length;r++){var i=n[r];isMailBadgeUse&&(i.fullName=="Inbox"&&(mailBadgeCount=i.unseenCnt),isDefaultBox(i.fullName)||(mailBadgeCount+=i.unseenCnt));var s=jQuery("#"+i.id+"_num");s.empty();if(i.unseenCnt>0){var o=jQuery("<a></a>"),u=jQuery("<span class='num'></span>");u.text(i.unseenCnt),o.attr({"evt-rol":"unseen-folder",fname:i.fullName}),o.html(u),s.html(o),s.data("unseen",i.unseenCnt)}i.child&&i.child.length>0&&e.printFolderCountUpdate(i.child);if((currentMenu=="list"||currentMenu=="read")&&currentFolderName==i.fullName){isBookmark=!1,jQuery("#mail_bookmark_list li").each(function(){var e=jQuery(this).attr("query"),t=jQuery(this).attr("seq");e==i.fullName&&(isBookmark=!0)});var a={name:currentFolderViewName,totalCnt:i.totalCnt,unseenCnt:i.unseenCnt,isBookmark:isBookmark};if(bookmarkType=="tag"){var f=getTagInfo(bookmarkValue);a.type="tag",a.tagInfo=f}makeMailHeaderMessege(a)}}},this.printFolderCountUpdateBookMark=function(t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];jQuery("#mail_bookmark_list li").each(function(){var e=jQuery(this).attr("query"),t=jQuery(this).attr("seq");if(e==r.fullName){var n=jQuery("#bookmark_num_"+t);n.empty();if(r.unseenCnt>0){var i=jQuery("<a></a>"),s=jQuery("<span class='num'></span>");s.text(r.unseenCnt),i.attr({"evt-rol":"unseen-folder",fname:r.fullName}),i.html(s),n.html(i),n.data("unseen",r.unseenCnt)}}}),r.child&&r.child.length>0&&e.printFolderCountUpdateBookMark(r.child)}},this.getFolderAllInfo=function(){var t={};ActionLoader.getGoLoadAction(this.folderAllInfoAction,t,function(t){e.checkCollapseStatus(),e.printFolderAllInfo(t)},"json")},this.checkCollapseStatus=function(){e.toggleCollapseStatus("mail_tag_wrap","tag_menu_collapse"),e.toggleCollapseStatus("left_mail_box_wrap","mail_menu_collapse"),e.toggleCollapseStatus("uf_smart_area","smart_menu_collapse"),e.toggleCollapseStatus("left_quicksearch_box_wrap","quicksearch_menu_collapse")},this.toggleCollapseStatus=function(e,t){var n=getCookie(e);n=="close"?(jQuery("#"+t).closest("h1").addClass("folded").attr("title",mailMsg.common_menu_show),jQuery("#"+e).hide()):(jQuery("#"+t).closest("h1").removeClass("folded").attr("title",mailMsg.common_menu_hide),jQuery("#"+e).show())},this.getFolderInfo=function(){e.getFolderInfoData(function(t){e.printFolderInfo(t)})},this.getFolderInfoData=function(e){var t={};ActionLoader.getGoLoadAction(this.folderBasicInfoAction,t,function(t){e&&e(t)},"json")},this.getQuotaInfo=function(){return this.quotaInfo},this.setQuotaInfo=function(e){this.quotaInfo=e},this.addFolderAfterFunc=function(e,t){var n={folderName:e};ActionLoader.postGoLoadAction(this.addFolderAction,n,function(e){t&&t(e)},"json")},this.addFolder=function(t){ActionLoader.postGoLoadAction(this.addFolderAction,t,function(t){e.getFolderInfo(),isFolderManageMenu()&&mailSettingControl.loadViewFolderManage(),removeProcessLoader()},"json")},this.modifyFolder=function(t){ActionLoader.postGoLoadAction(this.modifyFolderAction,t,function(n){e.getFolderInfo();var r=t.newName,i="";r.indexOf(".")>0?i=r.substring(r.lastIndexOf(".")+1,r.length):i=r;var s={};s.bookmarkType="mail",s.preBookmarkValue=t.previousName,s.bookmarkName=i,s.bookmarkValue=r,e.changeBookMarkInfo(s),isFolderManageMenu()&&mailSettingControl.loadViewFolderManage()},"json",function(e){jQuery.goSlideMessage(e.message,"caution")})},this.deleteFolder=function(t,n){var r={folderName:t};ActionLoader.postGoLoadAction(this.deleteFolderAction,r,function(r){e.getFolderInfo();var i={};i.bookmarkType="mail",i.bookmarkValue=t,e.deleteBookmark(i),n&&n()},"json")},this.emptyMailFolder=function(e,t){ActionLoader.postGoLoadAction(this.emptyFolderAction,e,function(e){t&&t()},"json")},this.printFolderInfo=function(t){e.makeDefaultFolder(t.defaultFolders),e.makeUserFolder(t.userFolders),e.makeQuotaInfo(t.quotaInfo),e.printFolderCountUpdateBookMark(t.defaultFolders),e.printFolderCountUpdateBookMark(t.userFolders)},this.printFolderAllInfo=function(t){e.printFolderInfo(t),e.makeTagList(t.userTags),e.makeSharedFolderList(t.userSharedFolderList)},this.makeQuotaInfo=function(e){jQuery("#usageQuota").html(e.usageUnit),jQuery("#limitQuota").html(e.limitUnit);var t=e.percent>100?100:e.percent;jQuery("#usagePercent").css("width",t+"%"),this.quotaInfo=e},this.makeDefaultFolder=function(e){var t=!1;if(e&&e.length>0)for(var n=0;n<e.length;n++){var r=e[n];r.fullName=="Quotaviolate"&&(t=!0);var i=jQuery("#"+r.id+"_num");i.empty();if(r.unseenCnt>0){var s=jQuery("<a></a>"),o=jQuery("<span class='num'></span>");o.text(r.unseenCnt),s.attr({"evt-rol":"unseen-folder",fname:r.fullName}),s.html(o),i.html(s),i.data("unseen",r.unseenCnt)}isMailBadgeUse&&r.fullName=="Inbox"&&(mailBadgeCount=r.unseenCnt)}t?jQuery("#df_quotaviolate").show():jQuery("#df_quotaviolate").hide()},this.makeUserFolder=function(e){this.userFolderList=e,e.isInbox=!0;var t=jQuery("#inbox_folder_area");t.handlebars("mail_user_folder_tmpl",e);var n=jQuery("#inbox_toggle_btn");if(t.find("li.folder").length>0){var r=getCookie("DFN_defaultFolder0");r=="C"?(n.addClass("open").removeClass("close").attr({status:"close",title:mailMsg.comn_open}),t.hide()):(n.addClass("close").removeClass("open").attr({status:"open",title:mailMsg.comn_close}),t.show()),n.show()}else n.hide();e.isInbox=!1,jQuery("#uf_folder_area").handlebars("mail_user_folder_tmpl",e),jQuery("#uf_folder_area p.title span.txt").each(function(){makeDropEvent(jQuery(this))}),jQuery("#inbox_folder_area p.title span.txt").each(function(){makeDropEvent(jQuery(this))});if(isMailBadgeUse)for(var i=0;i<e.length;i++)mailBadgeCount+=e[i].unseenCnt;jQuery("#uf_smart_area").handlebars("mail_smart_folder_tmpl",e),jQuery("#uf_smart_area li").length>0?jQuery("#smart_menu").show():jQuery("#smart_menu").hide()},this.makeSharedFolderList=function(e){e&&e.length>0?jQuery("#shared_folder_title").show():jQuery("#shared_folder_title").hide(),jQuery("#shared_folder_wrap").handlebars("shared_folder_tmpl",e)},this.getSharringReaderList=function(e){ActionLoader.getGoLoadAction(this.sharedFolderReaderListAction,e,function(e){makeShareFolderInfo(e)},"json")},this.setSharringReaderList=function(t,n){ActionLoader.putGoJsonLoadAction(this.sharedFolderReaderListAction,t,function(t){jQuery.goOrgSlide.close(),e.getFolderInfo(),n&&n()},"json")},this.getBookmarkInfo=function(){ActionLoader.getGoLoadAction(this.bookmarkListAction,null,function(t){var n=getCookie("mail_bookmark_list");n=="close"?(jQuery("#bookmark_menu_collapse").closest("h1.star").addClass("folded").attr("title",mailMsg.common_menu_show),jQuery("#mail_bookmark_list").hide()):(jQuery("#bookmark_menu_collapse").closest("h1.star").removeClass("folded").attr("title",mailMsg.common_menu_hide),jQuery("#mail_bookmark_list").show()),jQuery("#mail_bookmark_list").handlebars("mail_bookmark_tmpl",t),e.updateFolderCountInfo()},"json")},this.saveBookmark=function(t){ActionLoader.postGoLoadAction(this.saveBookmarkAction,t,function(t){e.changeBookmarkFlag(!0),e.getBookmarkInfo(!0)},"json")},this.updateBookmark=function(t){ActionLoader.postGoLoadAction(this.updateBookmarkAction,t,function(t){e.getBookmarkInfo(!0)},"json")},this.deleteBookmark=function(t){ActionLoader.postGoLoadAction(this.deleteBookmarkAction,t,function(t){e.changeBookmarkFlag(!1),e.getBookmarkInfo()},"json")},this.changeBookMarkInfo=function(t){ActionLoader.postGoLoadAction(this.changeBookmarkAction,t,function(t){e.getBookmarkInfo()},"json")},this.changeBookmarkFlag=function(e){var t=jQuery("#mail_header_msg ins");e?(t.attr("evt-rol","delete-bookmark"),t.removeClass("ic_star_off").addClass("ic_star").attr("title",mailMsg.mail_bookmark_del)):(t.attr("evt-rol","add-bookmark"),t.removeClass("ic_star").addClass("ic_star_off").attr("title",mailMsg.mail_bookmark_add))},this.getTagList=function(){this.getTagListAfterFunc(function(t){e.makeTagList(t)})},this.getTagListAfterFunc=function(e){ActionLoader.getGoLoadAction(this.tagListAction,null,function(t){e&&e(t)},"json")},this.makeTagList=function(t){e.tagData=t,jQuery("#mail_tag_list_area").handlebars("mail_tag_tmpl",t),jQuery("#mail_tag_list_area p.title span.txt").each(function(){makeDropEvent(jQuery(this))})},this.getTagData=function(){return this.tagData},this.setTagData=function(e){this.tagData=e},this.addTag=function(t){this.addTagAfterFunc(t,function(){e.getTagList(),isFolderManageMenu()&&mailSettingControl.loadViewFolderManage()})},this.addTagAfterFunc=function(e,t){ActionLoader.postGoLoadAction(this.addTagAction,e,function(e){t&&t()},"json")},this.modifyTag=function(t,n){ActionLoader.postGoLoadAction(this.modifyTagAction,t,function(r){e.getTagList();var i={};i.bookmarkType="tag",i.preBookmarkValue=t.oldId,i.bookmarkName=t.tagName,i.bookmarkValue=t.oldId,e.changeBookMarkInfo(i),isFolderManageMenu()&&mailSettingControl.loadViewFolderManage(),n&&n()},"json")},this.delTag=function(t,n){var r={tagIds:[t]};ActionLoader.postGoLoadAction(this.deleteTagAction,r,function(r){e.getTagList();var i={};i.bookmarkType="tag",i.bookmarkValue=t,e.deleteBookmark(i),isFolderManageMenu()&&mailSettingControl.loadViewFolderManage(),n&&n()},"json")},this.getUserFolderList=function(){return this.userFolderList},this.setUserFolderList=function(e){this.userFolderList=e},this.makeEvent=function(){var e={everyPreFunc:function(){closeMailFolderOptionLayer()}},t=new EventControl("#mailLeftMenuWrap","click","a,span,li",e);t.add("mail-home",function(){top.location="/app/mail"}),t.add("write-mail",function(e){goWrite()}),t.add("folder",function(e){var t=jQuery(e).attr("fname");goFolder(t)}),t.add("add-folder",function(e){var t=jQuery(e).offset();addFolder(t)}),t.add("more-folder",function(e){var t=jQuery(e).offset();moreFolder(t)}),t.add("mail-folder-option",function(e){var t=jQuery(e).data("depth"),n=jQuery(e).attr("fname"),r=jQuery(e).parent().parent().find("p a");childrenFnameForModify=new Array(r.length),jQuery(e).parent().parent().find("p a").each(function(t){childrenFnameForModify[t]=jQuery(e).attr("fname")});var i=jQuery(e).data("share"),s=jQuery(e).data("shareseq"),o={folderName:n,depth:t,share:i,shareseq:s},u=jQuery(e).offset();o.useSharedfolder=useSharedfolder,jQuery.goPopup({id:"mailFolderOptionLayer",pclass:"layer_normal layer_context",width:115,modal:!1,openCallback:function(){jQuery("#mailFolderOptionLayer header, #mailFolderOptionLayer footer").hide(),jQuery("#mailFolderOptionLayer div.content").css("padding","0"),jQuery("#mailFolderOptionLayer div.content").on("click","li",function(e){var t=jQuery(this).attr("evt-rol"),n=jQuery(this).parent().attr("folder");if(t=="empty-user-folder")emptyFolder(n);else if(t=="modify-folder")modifyFolder(n);else if(t=="delete-folder")deleteFolder(n);else if(t=="add-sub-folder")addSubFolder(n);else if(t=="share-folder"){openShareFolderSettingLayer(n);var r="on"==jQuery(this).parent().data("share");if(r){var i=jQuery(this).parent().data("shareseq");jQuery("#orgShareFlag").attr("checked",!0),jQuery("#orgShareFlag").data("shareSeq",i);var s={folderUid:i};folderControl.getSharringReaderList(s)}}else t=="upload-message"?(upfolderName=n,openUploadMessageLayer()):t=="move-folder"&&moveFolder(n)})},offset:{top:u.top,left:u.left+15},contents:getHandlebarsTemplate("mail_folder_option_tmpl",o),buttons:[]})}),t.add("mail-folder-option-close",function(e){closeMailFolderOptionLayer()}),t.add("empty-spam-folder",function(e){emptyFolder("Spam")}),t.add("empty-trash-folder",function(e){emptyFolder("Trash")}),t.add("shared-folder",function(e){var t=jQuery(e).attr("fname"),n=jQuery(e).attr("seq");goSharedFolder(t,n)}),t.add("unseen-folder",function(e){var t=jQuery(e).attr("fname");goFolder(t,"U")}),t.add("bookmark-modify",function(e){bookmarkManage()}),t.add("bookmark-cancel",function(e){bookmarkCancel()}),t.add("bookmark-submit",function(e){bookmarkModify()}),t.add("bookmark-execute",function(e){if(jQuery("#mail_bookmark_wrap").hasClass("lnb_edit"))return;var t=jQuery(e).closest("li"),n=t.attr("type"),r=t.attr("query"),i=t.attr("seq");bookmarkExecute(i,n,r)}),t.add("bookmark-delete",function(e){jQuery(e).closest("li").remove()}),t.add("tag-add",function(e){var t=jQuery(e),n=t.offset();n.sideTop=t.attr("id"),addMailTag(null,n)}),t.add("mail-tag-option",function(e){var t=jQuery(e).attr("tagid"),n=jQuery(e).attr("tagname"),r=jQuery(e).attr("tagcolor"),i={id:t,name:n,color:r},s=jQuery(e).offset();jQuery.goPopup({id:"mailTagOptionLayer",pclass:"layer_normal layer_context",width:115,modal:!1,openCallback:function(){jQuery("#mailTagOptionLayer header,footer").hide(),jQuery("#mailTagOptionLayer div.content").css("padding","0"),jQuery("#mailTagOptionLayer div.content").on("click","li",function(e){var t=jQuery(this).attr("evt-rol"),n=jQuery(this).parent().attr("tagid");if(t=="tag-modify"){var r=jQuery(this).parent().attr("tagname"),i=jQuery(this).parent().attr("tagcolor"),s={id:n,name:r,color:i,type:"modify"};addMailTag(s)}else t=="tag-delete"&&deleteMailTag(n)})},offset:{top:s.top,left:s.left+15},contents:getHandlebarsTemplate("mail_tag_option_tmpl",i),buttons:[]})}),t.add("mail-tag-option-close",function(e){closeMailTagOptionLayer()}),t.add("tag-message",function(e){var t={folder:"all",listType:"tag",tagId:jQuery(e).attr("val")},n=layoutControl.getContentSplitterMode();n=n?n:"n",layoutControl.contentSplitterChange(n),checkEscapeWriteMode(function(){mailControl.loadMessageList(t)})}),t.add("setting-menu",function(e){selectSettingMenu("basic")}),t.add("receive-noti-list",function(e){loadMdnList()}),t.add("extmail-download",function(e){viewExtMailPopup()}),t.add("go-folder-manager",function(e){selectSettingMenu("folder")}),t.add("change-menu-collapse",function(e){var t=jQuery(e).data("id"),n=jQuery(e).data("icon"),r=jQuery("#"+t),i=r.css("display")=="none",s="open";i?(r.slideDown(),jQuery(e).closest("h1").removeClass("folded").attr("title",mailMsg.common_menu_hide)):(s="close",r.slideUp(),jQuery(e).closest("h1").addClass("folded").attr("title",mailMsg.common_menu_show)),setCookie(t,s,365)}),t.add("folder-execute",function(e){var t=jQuery(e).attr("type");folderExecute(t)}),t.add("toggle-mail-folder",function(e){var t=jQuery(e).attr("status"),n=jQuery(e).attr("fid"),r=jQuery(e).closest("li").attr("depth");r=parseInt(r,10);var i=jQuery(e).closest("li").find("ul[depth='"+(r+1)+"']"),s="O";t=="open"?(i.hide(),jQuery(e).removeClass("close").addClass("open").attr({status:"close",title:mailMsg.comn_open}),s="C"):(i.show(),jQuery(e).removeClass("open").addClass("close").attr({status:"open",title:mailMsg.comn_close})),setCookie("DFN_"+n,s,365)}),t.add("tmw-folder",function(e){window.open("tmwPopup.jsp")}),t.add("move-security-center",function(e){var t=jQuery(e).parent().attr("evt-data-url"),n=jQuery(e).attr("evt-data");n&&(t+="&folder="+n),window.open(t)}),t.add("go-filter-manager",function(e){selectSettingMenu("filter")}),jQuery("#leftMenuSectionWrap li.default_folder p.title span.txt").each(function(){makeDropEvent(jQuery(this))})}},LayoutControl=function(){var e=this;this.opt={},this.contentSplitterMode="n",this.normalMode=!1,this.makeLayout=function(e){e||(e="n"),this.contentSplitterMode=e,this.contentSplitterChange(e,!0)},this.contentSplitterChange=function(e,t){e||(e="n");if(!t&&!this.normalMode&&e==this.contentSplitterMode)return;this.contentSplitterMode=e,e=="n"?this.contentNormalSplitter():e=="h"?this.makeHorizonSplitter():e=="v"&&this.makeVerticalSplitter(t),this.normalMode=!1},this.contentNormalSplitter=function(){jQuery(window).off(".mail"),resizeLeftMenu(),jQuery("#xbar").draggable("destroy").hide(),jQuery("#ybar").draggable("destroy").hide(),jQuery("#mailListArea").removeAttr("style").hide(),jQuery("#mailReadArea").removeAttr("style").hide(),jQuery("#mail_list_content").removeAttr("style"),jQuery(window).on("resize.mail",getListResizeHeight),jQuery(window).on("resize.mail",getReadResizeHeight),jQuery(window).trigger("resize"),jQuery("#mainContent").removeClass("column_inline column_block").addClass("column_block"),this.normalMode=!0},this.makeHorizonSplitter=function(){jQuery(window).off(".mail"),resizeLeftMenu(),jQuery("#xbar").draggable("destroy").hide(),jQuery("#ybar").draggable("destroy").hide(),jQuery("#mail_list_content").removeAttr("style"),jQuery("#mailListArea").removeAttr("style"),jQuery("#mailReadArea").removeAttr("style"),jQuery("#mainContent").removeClass("column_inline column_block").addClass("column_block");var t=getCookie("TL_V_H");t=t?t:200;var n=parseInt(t,10)+64;jQuery("#mail_list_content").height(n),jQuery("#xbar").draggable({containment:"parent",axis:"y",zIndex:100,cursor:"n-resize",start:function(e,t){jQuery('<div class="splitterMask"></div>').insertAfter(jQuery(this))},stop:function(t,n){jQuery("div.splitterMask").remove(),e.makeHorizonBar(jQuery(this),!0)}}),jQuery("#xbar").show(),e.makeHorizonBar(jQuery("#xbar"))},this.makeHorizonBar=function(e,t){var n=parseInt(jQuery(e).offset().top,10);n=n<300?300:n,jQuery(e).css("top","0px");var r=jQuery("#mainContent").offset().top,i=jQuery("#mailBottom").offset().top-10,s=n-r-65;jQuery("#mail_list_content").height(s),jQuery("#mailReadArea").height(i-n-10).show(),TABLET&&jQuery("#mailReadArea").css({overflow:"scroll","-webkit-overflow-scrolling"
:"touch"}),jQuery("#mailViewContentWrap").css("height",jQuery("#mailReadArea").height()-77+"px"),jQuery(window).on("resize.mail",function(){i=jQuery("#mailBottom").offset().top-10,jQuery("#mailReadArea").height(i-n-10)}),setCookie("TL_V_H",s,365),t||jQuery(window).trigger("resize")},this.resizeMailEvent=function(){mailBottomTop=jQuery("#mailBottom").offset().top;var e=mailBottomTop-100;jQuery("#ybar").height(e>510?e:510);var t=mailBottomTop-120-80;jQuery("#mail_list_content").height(t>430?t:430);var n=mailBottomTop-149;jQuery("#mailReadArea").height(n>500?n:500);var r=jQuery("#mainContent").width(),i=jQuery("#mailListArea").outerWidth()+1,s=jQuery("#ybar").outerWidth()+1,o=r-i-s;jQuery("#mailReadArea").width(o)},this.makeVerticalSplitter=function(t){jQuery(window).off(".mail"),resizeLeftMenu(),jQuery("#xbar").draggable("destroy").hide(),jQuery("#ybar").draggable("destroy").hide(),jQuery("#mail_list_content").removeAttr("style"),jQuery("#mailListArea").removeAttr("style"),jQuery("#mailReadArea").removeAttr("style"),jQuery("#mainContent").removeClass("column_inline column_block").addClass("column_inline");var n=e.getLeftMenuWidth(),r=getCookie("TL_H_V");r=r?r:830;var i=r-n;jQuery("#mailListArea").width(i);var s=jQuery("#ybar");s.draggable({containment:"parent",axis:"x",zIndex:100,cursor:"e-resize",start:function(e,t){},stop:function(e,t){}}),s.on("dragstart",function(e,t){jQuery('<div class="splitterMask"></div>').insertAfter(jQuery(this))}),s.on("dragstop",function(t,n){jQuery("div.splitterMask").remove(),e.makeVerticalBar(e.getLeftMenuWidth(),e.getVerticalBaroffsetWidth(),!0)}),s.show(),t||(r=e.getVerticalBaroffsetWidth()),e.makeVerticalBar(n,r,!1)},this.makeVerticalBar=function(e,t,n){var r=jQuery("#mailBottom").offset().top,i=jQuery("#mainContent").width(),s=t-e;t>i-100&&(t-=100),jQuery("#ybar").css("left","0px"),jQuery("#mailListArea").width(s);var o=i-s-jQuery("#ybar").outerWidth();i<=1e3&&(o=1e3-t-7),jQuery("#mailReadArea").width(o);if(!n){var u=r-100;jQuery("#ybar").height(u>510?u:510);var a=r-120-50;jQuery("#mail_list_content").height(a>430?a:430);var f=r-149;jQuery("#mailReadArea").height(f>500?f:500).show(),TABLET&&jQuery("#mailReadArea").css({overflow:"scroll","-webkit-overflow-scrolling":"touch"})}jQuery(window).off("resize.mail"),jQuery(window).on("resize.mail",this.resizeMailEvent),jQuery(window).trigger("resize"),setCookie("TL_H_V",t,365)},this.getVerticalBaroffsetWidth=function(){var e=parseInt(jQuery("#ybar").offset().left-jQuery("div.go_body").offset().left,10);return e=e<700?700:e,e},this.getLeftMenuWidth=function(){var e=jQuery("#mailLeftMenuWrap"),t=e.outerWidth();return e.css("display")=="none"&&(t=0),t},this.getContentSplitterMode=function(){return this.contentSplitterMode},isPopupView()||jQuery(window).on("resize.mail",this.resizeMailEvent)},ReadSubMessageChecker={currentUid:"",setCurrent:function(e){e=getFolderNameId(e),ReadSubMessageChecker.currentUid=e,jQuery("#mail_list_content tr.choice input:checkbox[name=msgId]").each(function(){listCheckboxControl(jQuery(this),!1)}),listCheckboxControl(jQuery("#"+e+" input:checkbox[name=msgId]"),!0)},resetUid:function(){ReadSubMessageChecker.currentUid=""},hasCurrentItem:function(){if(ReadSubMessageChecker.currentUid=="")return!1;var e=jQuery("#"+ReadSubMessageChecker.currentUid+" td input:checkbox[name=msgId]").length>0;return e||layoutMode!="n"&&(e=!0),e}};