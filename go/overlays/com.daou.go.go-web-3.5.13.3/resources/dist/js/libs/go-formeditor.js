define(["app","go-webeditor/editors/smarteditor","formutil","formparse"],function(e){function r(e){return $.editorParser.convertDslToSpan(e)}var t="goFormEditor",n="SmartEditor";$.fn[t]=function(r){var i={contextRoot:e.config("contextRoot"),theme:"form",bUseVerticalResizer:!1,bUseApprovalType:"",bUsePallet:!0,approvalInfo:{}},s=$.extend({},i,r);return this.each(function(){$.data(this,"plugin_"+t)||$.data(this,"plugin_"+t,e.Editor.create(n,this,s))})},$[t]={getContent:function(t){var n=e.Editor.getInstance(t).getContent(),i,s;return i=n.substr(0,5),s=i=="<span"?r(n):r("<span>"+n+"</span>"),s},putContent:function(t,n){var r=$.parseHTML(n,document,!0),i="";$.each($(r),function(e,t){$(t).find("span[data-dsl]").each(function(){$(this).replaceWith($(this).attr("data-dsl"))}),i+=$(t).clone().wrapAll("<div/>").parent().html()}),e.Editor.getInstance(t).setContent(i)},spanToDSL:function(e){var t=$.parseHTML(e,document,!0),n="";return $.each($(t),function(e,t){$(t).find("span[data-dsl]").each(function(){$(this).replaceWith($(this).attr("data-dsl"))}),n+=$(t).clone().wrapAll("<div/>").parent().html()}),n}}});