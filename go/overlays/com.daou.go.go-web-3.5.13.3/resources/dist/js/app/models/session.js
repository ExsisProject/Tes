(function(){define(["backbone","moment"],function(e,t){var n=e.Model.extend({urlRoot:"/api/user/session",instanceType:"user",destroyTime:1800,defaults:{thumbnail:"resources/images/photo_my.jpg",noti:0,updated_at:new Date},url:function(){var e=this.instanceType==="admin"?"/ad":"";return e+_.result(this,"urlRoot")},initialize:function(e,t){t=t||{},this.instanceType="user",t.hasOwnProperty("instanceType")&&this.setInstanceType(t.instanceType)},setInstanceType:function(e){this.instanceType=e},setDestroyTime:function(e){return this.destroyTime=e,this},getDestroyTime:function(){return this.destroyTime},isValid:function(){return typeof this.id!="undefined"&&t().diff(t(this.get("updated_at")),"seconds",!0)<this.getDestroyTime()},updateDate:function(){this.set("updated_at",new Date)},updateSession:function(e){!this.isValid()&&this.instanceType!=="install"&&(window.GO_Session.set(e),this.updateDate(),this.setInstanceType(GO.instanceType),this.setDestroyTime(GO.config("sessionDestroyTime")),this.on("change:locale",function(){location.reload()}),this.set("integratedCompanies",this._getIntegratedCompanies()))},_getIntegratedCompanies:function(){var e=[],t=this.get("companies");if(!t)return[];for(var n=0;n<t.length;n++)t[n].userId&&e.push(t[n]);return e}});return n})}).call(this);