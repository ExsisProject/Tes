define(["jquery","underscore","backbone","app","hgn!templates/layouts/m_action_bar_default"],function(e,t,n,r,i){return n.View.extend({initialize:function(e){this.options=e||{},this.menu=e.useMenuList,this.hasTitle=e.hasTitle},render:function(){return this.$el.html(i()),this.renderToolbar(),this},renderToolbar:function(){this.renderToolbarMenu(this.menu)},renderToolbarMenu:function(t){if(!t)return;var n=0,r=48,i=!1,s=e(window).width(),o=this.hasTitle?e("h1#appTitle").width():0,u=(s-o)/2;t.forEach(e.proxy(function(t){var s=e(this.makeMenuItemTemplate(t));n+=r,u>n&&!t.inMoreBtn?this.$el.find("#moreItemLi").before(s,"\n"):(this.$el.find("#moreMenuItem").append(s,"\n"),i=!0),i&&e("#moreItemLi").show()}),this),i&&this.$el.find("#moreItemLi").show()},menuBarAllowWidthPolicy:function(e,t){var n=34;return t-e.$el.width()+n>0},isSelectType:function(e){return!t.isUndefined(e.selectId)},isCommentType:function(e){return e.id=="show_comment_list"?!0:e.id=="calendar-comment"?!0:e.id=="docs-reply"?!0:e.cls=="btn_comments"?!0:!1},isActivityCommentType:function(e){return e.id=="show_activity_comment_list"?!0:!1},makeMenuItemTemplate:function(e){var t=[];return this.isSelectType(e)?t=this._makeSelectTemplate(t,e):t=this._makeButtonTemplate(t,e),t.join("")},makeMoreMenuItemTemplate:function(e){var n=[],r=t.isUndefined(e.cls)?"":e.cls;return n.push('<li><a id="'+e.id+'" name="'+e.name+'" class="'+r+'">'),n.push('<span class="txt">'+e.text+"</span>"),n.push("</a></li>"),n.join("")},_makeSelectTemplate:function(e,t){var n=this.$el.find("#"+t.selectId);return n.length>0?n.append('<option value="'+t.id+'">'+t.text+"</option>"):(e.push('<li><a href="javascript:;" class="btn_tool btn_slt">'),e.push('<span class="txt">'+t.text+"</span>"),e.push('<span class="ic_cmm ic_dropdown_small"></span>'),e.push('<select class="slt_move" id="'+t.selectId+'" select-trigger="'+t.selectTriggerFunc+'">'),e.push('<option value="'+t.id+'">'+t.text+"</option>"),e.push("</select>"),e.push("</a></li>")),e},_makeButtonTemplate:function(e,n){var r=t.isUndefined(n.cls)?"btn_tool":"btn_tool "+n.cls;return t.isUndefined(n.url)?e.push('<li><a style="'+n.style+'" data-trigger="'+n.triggerFunc+'" data-role="button" id="'+n.id+'" name="'+n.name+'">'):e.push('<li><a style="'+n.style+'" data-trigger="'+n.triggerFunc+'" data-role="button" id="'+n.id+'" name="'+n.name+'" href="'+n.url+'">'),e.push("<span>"+n.text+"</span>"),this.isCommentType(n)&&(t.isUndefined(n.commentsCount)?e.push('<span class="count" id="commentCount"></span>'):(e.push("\n"),e.push('<span class="num" id="commentCount">'+n.commentsCount+"</span>"))),this.isActivityCommentType(n)&&e.push('<span class="count" id="activityCommentCount"></span>'),e.push("</a></li>"),e}})});