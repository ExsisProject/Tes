define("views/circle_tableTmpl",function(require){var e=require("views/circle"),t=require("jquery"),n=require("underscore"),r=require("backbone"),i=require("app"),s=require("helpers/form"),o=require("system/collections/companies"),u=require("i18n!survey/nls/survey"),a=require("i18n!nls/commons"),f=require("i18n!approval/nls/approval"),l=require("i18n!admin/nls/admin"),c=require("i18n!board/nls/board"),h={user:a["\uc0ac\uc6a9\uc790"],company:a["\uc804\uccb4 \uc0ac\uc6a9\uc790"],subdepartment:f["\ubd80\uc11c"],department:f["\ubd80\uc11c"],position:f["\uc9c1\uc704"],duty:l["\uc9c1\ucc45"],grade:l["\uc9c1\uae09"],usergroup:l["\uc0ac\uc6a9\uc790\uadf8\ub8f9"],position_select:l["\uc9c1\uc704 \uc120\ud0dd"],duty_select:l["\uc9c1\ucc45 \uc120\ud0dd"],grade_select:l["\uc9c1\uae09 \uc120\ud0dd"],usergroup_select:l["\uc0ac\uc6a9\uc790\uadf8\ub8f9 \uc120\ud0dd"],including_sub_dept:c["\ud558\uc704 \ubd80\uc11c \ud3ec\ud568"],include_child_dept:u["\ud558\uc704 \ubd80\uc11c \ud3ec\ud568\ud558\uae30"],select_department:u["\ubd80\uc11c \uc120\ud0dd"],select_user:u["\uc0ac\uc6a9\uc790 \uc120\ud0dd"],add:a["\ucd94\uac00"],remove:a["\uc0ad\uc81c"],add_dept:u["\ubd80\uc11c\ucd94\uac00"],dept_name:u["\ubd80\uc11c\uba85"],target_whole:u["\uc804\uc0ac"],target_part:u["\uc77c\ubd80"],select_dept:u["\ubd80\uc11c \uc120\ud0dd"],select_class:u["\ud074\ub798\uc2a4 \uc120\ud0dd"],child_dept:u["\ud558\uc704 \ubd80\uc11c"],site_select:l["\uc0ac\uc774\ud2b8 \uc120\ud0dd"],writable:l["\uc4f0\uae30\uac00\ub2a5"],notUseApprReception:"\ubb38\uc11c \uc218\uc2e0 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \ubd80\uc11c\uc785\ub2c8\ub2e4. \ud574\ub2f9 \ubd80\uc11c\ub97c \ucd94\uac00\ud558\ub824\uba74 [\uc804\uc790\uacb0\uc7ac > \ubd80\uc11c \ubb38\uc11c\ud568 \uad00\ub9ac > \ubd80\uc11c \ubb38\uc11c\ud568 \uc0ac\uc6a9 \uc124\uc815]\uc5d0\uc11c \uc218\uc2e0\ud568\uc744 \uccb4\ud06c\ud574\uc8fc\uc138\uc694.",notUseApprReference:"\ubd80\uc11c\ubb38\uc11c\ud568 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \ubd80\uc11c\uc785\ub2c8\ub2e4. \ud574\ub2f9 \ubd80\uc11c\ub97c \ucd94\uac00\ud558\ub824\uba74 [\uc804\uc790\uacb0\uc7ac > \ubd80\uc11c \ubb38\uc11c\ud568 \uad00\ub9ac > \ubd80\uc11c \ubb38\uc11c\ud568 \uc0ac\uc6a9 \uc124\uc815]\uc5d0\uc11c \ubd80\uc11c\ud568\uc744 \uccb4\ud06c\ud574\uc8fc\uc138\uc694."},p=r.Model.extend({defaults:{nodeId:0,nodeDeptId:"",nodeCompanyId:null,nodeCompanyName:null,nodeType:"user",nodeValue:"",actions:"",members:null},initialize:function(){n.isArray(this.get("members"))||this.set("members",[])},isUserType:function(){return this.get("nodeType")=="user"},isUserWithDeptType:function(){return this.isUserType()&&!this.get("nodeDeptId")},isDeptType:function(e){var t=this.get("nodeType")=="department";return e&&(t=t||this.isSubDeptType()),t},isSubDeptType:function(){return this.get("nodeType")=="subdepartment"},isPositionType:function(){return this.get("nodeType")=="position"},isGradeType:function(){return this.get("nodeType")=="grade"},isDutyType:function(){return this.get("nodeType")=="duty"},isUserGroupType:function(){return this.get("nodeType")=="usergroup"},isCompanyType:function(){return this.get("nodeType")=="company"}}),d=r.Collection.extend({model:p,addNode:function(e){var t=this.getByNodeIdAndType(e.get("nodeId"),e.get("nodeType"),e.get("nodeDeptId"));return n.isUndefined(t)?(this.add(e),!0):!1},getByNodeIdAndType:function(e,t,r){return this.find(function(i){var s=e==i.get("nodeId"),o=t==i.get("nodeType");return n.contains(["department","subdepartment"],t)&&i.isDeptType(!0)&&(o=!0),i.isUserWithDeptType()&&(o=s&&i.get("nodeDeptId")==r),s&&o})},removeByNodeIdAndType:function(e,t,n){var r=this.getByNodeIdAndType(e,t,n);return r?(this.remove(r),!0):!1}}),v=r.Model.extend({defaults:{discription:"",nodes:null},initialize:function(){n.isArray(this.get("nodes"))?this.set("nodes",this.get("nodes").slice()):this.set("nodes",[])},getNodeCollection:function(){return new d(this.get("nodes"))}}),m=r.View.extend({tagName:"span",className:"vertical_wrap",events:{"change #circle_company_select":"_onCompanySelected"},initialize:function(e){this.collection=new o,this.observer=e.observer,n.isArray(e.ids)&&(this.ids=n.map(e.ids,function(e){return""+e}))},render:function(){var e=this;this.collection.fetch({success:function(t){e.$el.append(e._renderTemplate(t.toJSON())),e._notifyCompanySelected()}})},_renderTemplate:function(e){n.isArray(this.ids)&&(e=n.filter(e,function(e){return n.contains(this.ids,""+e.id)},this));var t=['<span class="option_wrap">','    <label class="tit" title="">{{labelTitle}}</label>',"</span>",'<select id="circle_company_select">',"    {{#companies}}",'    <option value="{{name}}" data-id="{{id}}" data-name="{{name}}">{{name}}</option>',"    {{/companies}}","    {{^companies}}","    <option>{{labelNoCompanies}}</option>","    {{/companies}}","</select>"];return Hogan.compile(t.join("\n")).render({labelTitle:h.site_select,labelNoCompanies:l["\uc120\ud0dd\ub41c \uc0ac\uc774\ud2b8\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."],companies:e})},_onCompanySelected:function(e){this._notifyCompanySelected()},_notifyCompanySelected:function(){var e=t("#circle_company_select > option:selected");console.log("onCompanySelected: "+e.attr("data-id")),this.observer.trigger("companySelected",e.attr("data-id"),e.attr("data-name"))}}),g=r.View.extend({initialize:function(e){this.isAdmin=n.isBoolean(e.isAdmin)?e.isAdmin:!0,this.visibleCompanyName=n.isBoolean(e.visibleCompanyName)?e.visibleCompanyName:!1,this.collection=n.isArray(e.collection.models)?new d(e.collection.models):new d,this.withoutSubDept=n.isBoolean(e.withoutSubDept)?e.withoutSubDept:!1,this.addCallback=n.isFunction(e.addCallback)?e.addCallback:null,this.removeCallback=n.isFunction(e.removeCallback)?e.removeCallback:null,this.useAction=n.isBoolean(e.useAction)?e.useAction:!1,this.isExceptionList=n.isBoolean(e.isExceptionList)?e.isExceptionList:!1,this.isUseActionMenu=n.isBoolean(e.isUseActionMenu)?e.isUseActionMenu:!this.isExceptionList},render:function(){this._renderNodeList(),this.$el.off(),this.$el.on("click","span.ic_delete",t.proxy(this._deleteNodeFromList,this)),this.$el.on("click","input[name=include_sub_dept]",t.proxy(this._toggleSubDeptIncluding,this)),this.$el.on("click","input[name=enroll_permission]",t.proxy(this._toggleEnrollPermission,this)),this.$el.on("click","input[name=remove_permission]",t.proxy(this._toggleRemovePermission,this))},addNodeToList:function(e){this.collection.addNode(e),n.isFunction(this.addCallback)&&this.addCallback()},_renderNodeList:function(){this.$el.html(this._makeTemplate({nodes:this._makeTemplateData(this.collection),withoutSubDept:this.withoutSubDept,visibleCompanyName:this.visibleCompanyName,delete_label:h.remove,including_sub_dept_label:h.including_sub_dept,useAction:this.useAction,isUseActionMenu:this.isUseActionMenu,isExceptionList:this.isExceptionList,lang:{accessTarget:l["\uc5f4\ub78c\uc790"],exceptionTarget:l["\uc608\uc678\uc790"],includeSubDept:a["\ud558\uc704\ubd80\uc11c\ud3ec\ud568"],writable:l["\ub4f1\ub85d\uad8c\ud55c"],removable:l["\uc0ad\uc81c\uad8c\ud55c"],remove:a["\uc0ad\uc81c"]}}))},_makeTemplate:function(e){var t=['<table class="in_table">',"   <colgroup>",'       <col width="200px">','       <col width="*">',"   </colgroup>","   <thead>","       <tr>","           <th>{{#isExceptionList}}{{lang.exceptionTarget}}{{/isExceptionList}}{{^isExceptionList}}{{lang.accessTarget}}{{/isExceptionList}}</th>","           <th>{{lang.includeSubDept}}</th>","           {{#isUseActionMenu}}","           <th>{{lang.writable}}</th>","           <th>{{lang.removable}}</th>","           {{/isUseActionMenu}}","           <th>{{lang.remove}}</th>","       </tr>","    </thead>",'    <tbody class="vertical_wrap_s">',"       {{#nodes}}",'       <tr {{#isFirst?}}class="first"{{/isFirst?}} data-nodeId="{{nodeId}}" data-nodeType="{{nodeType}}" data-nodeDeptId="{{nodeDeptId}}" data-actions="{{actions}}">','           <td class="align_c">','               <span class="minor"> {{nodeTypeLabel}} {{#nodeValue}}:{{/nodeValue}} {{nodeValue}}{{#visibleCompanyName}}{{#nodeCompanyName}} - {{nodeCompanyName}}{{/nodeCompanyName}}{{/visibleCompanyName}}',"           </td>",'           <td class="align_c">',"               {{^withoutSubDept}}{{#isDeptOrSubDeptType?}}",'               <span class="sub_depart"> <input type="checkbox" id="include_sub_dept" name="include_sub_dept" {{#isSubDeptType?}}checked{{/isSubDeptType?}}> </span>',"               {{/isDeptOrSubDeptType?}}{{/withoutSubDept}}","           </td>","           {{#isUseActionMenu}}",'           <td class="align_c">','              <span><input type="checkbox" id="enroll_permission" name="enroll_permission" {{#writable}}checked{{/writable}}></span>',"           </td>",'           <td class="align_c">','              <span><input type="checkbox" id="remove_permission" name="remove_permission" {{#removable}}checked{{/removable}}></span>',"           </td>","           {{/isUseActionMenu}}",'           <td class="align_c">','              <span class="btn_border"><span class="ic ic_delete" title="{{delete_label}}"></span></span>',"           </td>","       </tr>","       {{/nodes}}","    </tbody>","</table>"];return Hogan.compile(t.join("\n")).render(e)},_makeTemplateData:function(e){return n.map(e.models,function(e,t){return{"isFirst?":t==0,"isDeptOrSubDeptType?":e.isDeptType(!0),"isSubDeptType?":e.isSubDeptType(),writable:e.get("actions").indexOf(b.WRITABLE)>=0,removable:e.get("actions").indexOf(b.REMOVABLE)>=0,nodeId:e.get("nodeId"),nodeType:e.get("nodeType"),nodeDeptId:e.get("nodeDeptId"),nodeCompanyName:e.get("nodeCompanyName"),nodeValue:e.get("nodeValue"),nodeTypeLabel:h[e.get("nodeType")],actions:e.get("actions"),actionName:function(){var t=e.get("actions"),n=[];return t.indexOf(b.READABLE)>=0&&n.push(l["\uc77d\uae30"]),t.indexOf(b.WRITABLE)>=0&&n.push(l["\uc4f0\uae30"]),t.indexOf(b.REMOVABLE)>=0&&n.push(l["\uc0ad\uc81c"]),n.join("/")}()}})},_deleteNodeFromList:function(e){var r=t(e.currentTarget).parent().parent().parent();this.collection.removeByNodeIdAndType(r.attr("data-nodeId"),r.attr("data-nodeType"),r.attr("data-nodeDeptId")),this._renderNodeList(),n.isFunction(this.removeCallback)&&this.removeCallback(),e.stopPropagation()},deleteAllNodeFromList:function(){n.each(this.getDataAsJSON(),function(e){this.collection.removeByNodeIdAndType(e.nodeId,e.nodeType,e.nodeDeptId)},this),this._renderNodeList()},deleteNodeOfCompany:function(e){var t=this.collection.filter(function(t){return!n.isUndefined(t.get("nodeCompanyId"))&&!n.isUndefined(e)&&String(t.get("nodeCompanyId"))==String(e)?!0:!1});this.collection.remove(t)},_toggleSubDeptIncluding:function(e){var n=t(e.currentTarget).parent().parent().parent(),r=t(e.currentTarget).is(":checked"),i=this.collection.getByNodeIdAndType(n.attr("data-nodeId"),n.attr("data-nodeType"),n.attr("data-nodeDeptId"));i.set("nodeType",r?"subdepartment":"department"),this._renderNodeList(),e.stopPropagation()},_toggleEnrollPermission:function(e){var n=t(e.currentTarget).parent().parent().parent(),r=t(e.currentTarget).is(":checked"),i=this.collection.getByNodeIdAndType(n.attr("data-nodeId"),n.attr("data-nodeType"),n.attr("data-nodeDeptId")),s=i.get("actions").length>0?i.get("actions").split(","):["read"];r?s.push(b.WRITABLE):s.splice(s.indexOf(b.WRITABLE),1),i.set("actions",s.join(",")),this._renderNodeList(),e.stopPropagation()},_toggleRemovePermission:function(e){var n=t(e.currentTarget).parent().parent().parent(),r=t(e.currentTarget).is(":checked"),i=this.collection.getByNodeIdAndType(n.attr("data-nodeId"),n.attr("data-nodeType"),n.attr("data-nodeDeptId")),s=i.get("actions").length>0?i.get("actions").split(","):["read"];r?s.push(b.REMOVABLE):s.splice(s.indexOf(b.REMOVABLE),1),i.set("actions",s.join(",")),this._renderNodeList(),e.stopPropagation()},getDataAsJSON:function(){return this.collection.toJSON()}}),y=r.View.extend({tagName:"span",className:"vertical_wrap",initialize:function(e){this.isAdmin=n.isBoolean(e.isAdmin)?e.isAdmin:!0,this.nodeTypes=n.isArray(e.nodeTypes)?e.nodeTypes:y.NODE_TYPES,this.callback=n.isFunction(e.callback)?e.callback:function(){return},this.labelVisible=n.isBoolean(e.labelVisible)?e.labelVisible:!1,this.useAction=n.isBoolean(e.useAction)?e.useAction:!1,this.useApprReception=n.isBoolean(e.useApprReception)?e.useApprReception:!1,this.useApprReference=n.isBoolean(e.useApprReference)?e.useApprReference:!1,this.observer=e.observer,this.isExceptionList=n.isBoolean(e.isExceptionList)?e.isExceptionList:!1},render:function(e,r){this.$el.html(this._prepareTemplate({labelVisible:this.labelVisible,labelClassSelect:h.select_class,nodeTypes:n.map(this.nodeTypes,function(e){return{value:e,label:h[e]}})})),this._renderSelectableList(null,e,r),this.$el.off().on("change","select.node_type_select",t.proxy(function(n){this._renderSelectableList(t(n.target).val(),e,r)},this)),this.observer.bind("companySelected",function(){var e=arguments[0],t=arguments[1];this.render(e,t)},this)},_prepareTemplate:function(e){var t=["{{#labelVisible}}",'<span class="option_wrap">','    <label class="tit" title="">{{labelClassSelect}}</label>',"</span>","{{/labelVisible}}",'<select class="node_type_select">',"{{#nodeTypes}}",'    <option value="{{value}}">{{label}}</option>',"{{/nodeTypes}}","</select>"],n=Hogan.compile(t.join("\n"));return n.render(e)},_renderSelectableList:function(e,r,i){n.isEmpty(e)&&(e=t("select.node_type_select > option:first",this.$el).val()),t("select.node_type_select",this.$el).nextAll().remove(),this.nodePickerView&&this.nodePickerView.close();var s=n.contains(["company","user","department","subdepartment"],e)?w:E;this.nodePickerView=new s({type:e,companyId:r,isAdmin:this.isAdmin,isExceptionList:this.isExceptionList,useApprReception:this.useApprReception,useApprReference:this.useApprReference,callback:t.proxy(function(e){r&&(e.set("nodeCompanyId",r),e.set("nodeCompanyName",i)),this.callback(e)},this),useAction:this.useAction}),this.nodePickerView.render(),t("select.node_type_select",this.$el).after(this.nodePickerView.$el)}},{NODE_TYPES:["position","grade","duty","usergroup","department","user"]}),b={READABLE:"read",WRITABLE:"write",REMOVABLE:"remove",MANAGABLE:"manage"},w=r.View.extend({tagName:"span",className:"orgNodePicker",orgSlide:null,isAdmin:null,callback:null,useApprReception:null,useApprReference:null,type:null,useAction:null,initialize:function(e){this.type=e.type,this.callback=e.callback,this.isAdmin=n.isBoolean(e.isAdmin)?e.isAdmin:!0,this.companyId=n.isEmpty(e.companyId)?null:e.companyId,this.useAction=n.isBoolean(e.useAction)?e.useAction:!1,this.useApprReception=n.isBoolean(e.useApprReception)?e.useApprReception:!1,this.useApprReference=n.isBoolean(e.useApprReference)?e.useApprReference:!1,this.isExceptionList=n.isBoolean(e.isExceptionList)?e.isExceptionList:!1},render:function(){var e=function(e,r,i){var s=n.contains(["MASTER","MODERATOR","MEMBER"],i.type);if(e=="user"&&!s)return;if(e!="user"&&s)return;if(n.contains(["department","department-nosub"],e)&&i.type!="root"&&this.useApprReception&&!i.useReception){t.goAlert(h.notUseApprReception);return}if(n.contains(["department","department-nosub"],e)&&i.type!="root"&&this.useApprReference&&!i.useReference){t.goAlert(h.notUseApprReference);return}var o=[];if(this.useAction||!this.isExceptionList)o.push(b.READABLE),this.$el.find("#wAuth").prop("checked")&&o.push(b.WRITABLE);r(new p({nodeValue:e=="user"?i.name+" "+i.position:i.name,nodeType:e,nodeId:i.id,nodeDeptId:i.deptId,actions:o.join(",")}))},r=["{{#useAction}}",'<span class="option_wrap">','    <input type="checkbox" value="" class="writePossible" id="wAuth">','    <label for="wAuth">{{lang.writable}}</label>',"</span>","{{/useAction}}",'<span class="btn_wrap">','    <span class="btn_s select_org_node" data-type={{type}}>{{add}}</span>',"</span>"];this.$el.html(Hogan.compile(r.join("\n")).render({type:this.type,add:h.add,useAction:this.useAction,lang:h})),this.$el.off().on("click","span.select_org_node",t.proxy(function(n){var r=t(n.target).data("type");r=="company"?this.callback(new p({nodeValue:h["\uc804\uccb4 \uc0ac\uc6a9\uc790"],nodeId:i.session("companyId"),nodeType:r})):this.orgSlide=t.goOrgSlide({header:h["select_"+r],type:r=="user"?"list":"department",isAdmin:this.isAdmin,companyIds:[this.companyId],contextRoot:i.config("contextRoot"),callback:t.proxy(e,this,this.type,this.callback)})},this))},close:function(){this.orgSlide&&this.orgSlide.close()}}),E=r.View.extend({tagName:"span",className:"classNodePicker",isAdmin:null,callback:null,type:null,useAction:null,initialize:function(e){this.type=e.type,this.companyId=e.companyId,this.callback=e.callback,this.isAdmin=n.isBoolean(e.isAdmin)?e.isAdmin:!0,this.useAction=n.isBoolean(e.useAction)?e.useAction:!1},render:function(){this._fetchClassNodeList(this.type,t.proxy(this._renderClassNodeList,this))},close:function(){return!1},_fetchClassNodeList:function(e,n){var r=i.config("contextRoot")+(this.isAdmin?"ad/":"")+"api/"+e+"/list";this.companyId&&(r+="?companyId="+this.companyId),t.ajax(r).done(function(t){n(t.data,e)})},_renderClassNodeList:function(e,n){var r=["&nbsp;",'<select class="class_selector_option">',"    {{#nodes}}",'    <option value="{{id}}" data-code="{{code}}" data-codeType="{{codeType}}">{{name}}</option>',"    {{/nodes}}","    {{^nodes}}","    <option selected disabled>{{select_name}}</option>","    {{/nodes}}","</select>","{{#useAction}}",'<span class="option_wrap">','    <input type="checkbox" value="" class="writePossible" id="wAuth">','    <label for="wAuth">{{lang.writable}}</label>',"</span>","{{/useAction}}",'<span class="btn_wrap class_selector_button"><span class="btn_s">{{lang.add}}</span></span>'],i=Hogan.compile(r.join("\n"));this.$el.append(i.render({select_name:h[n+"_select"],nodes:e,lang:h,useAction:this.useAction})),this.$el.off(),this.$el.on("click","span.class_selector_button",t.proxy(function(e){var n=t("select.class_selector_option option:selected",this.$el),r=[];this.useAction&&(r.push(b.READABLE),this.$el.find("#wAuth").prop("checked")&&r.push(b.WRITABLE)),this.callback(new p({nodeType:n.attr("data-codetype").toLowerCase(),nodeValue:n.text(),nodeId:n.val(),actions:r.join(",")}))},this))}}),S=r.View.extend({view:null,nodePickerView:null,nodeListView:null,companyListView:null,useApprReception:null,useApprReference:null,initialize:function(e){e=e||{},e.selector&&(this.$el=t(e.selector)),this.isExceptionList=n.isBoolean(e.isExceptionList)?e.isExceptionList:!1,this.isUseActionMenu=n.isBoolean(e.isUseActionMenu)?e.isUseActionMenu:!this.isExceptionList,this.isAdmin=n.isBoolean(e.isAdmin)?e.isAdmin:!0,this.withCompanies=n.isBoolean(e.withCompanies)?e.withCompanies:!1,this.companyIds=n.isArray(e.companyIds)?e.companyIds:[],this.nodeTypes=n.isArray(e.nodeTypes)?e.nodeTypes:y.NODE_TYPES,this.addCallback=n.isFunction(e.addCallback)?e.addCallback:null,this.removeCallback=n.isFunction(e.removeCallback)?e.removeCallback:null,this.useAction=n.isBoolean(e.useAction)?e.useAction:!1,this.useApprReception=n.isBoolean(e.useApprReception)?e.useApprReception:!1,this.useApprReference=n.isBoolean(e.useApprReference)?e.useApprReference:!1,this.noSubDept=n.isBoolean(e.noSubDept)?e.noSubDept:!1;var i=n.isObject(e.circleJSON)?e.circleJSON:{};n.isEmpty(i.nodes)&&(i.nodes=[]),this.model=new v(i);var s=n.extend({},r.Events);this.nodeListView=new g({collection:this.model.getNodeCollection(),visibleCompanyName:this.withCompanies,withoutSubDept:n.contains(this.nodeTypes,"department-nosub")||this.noSubDept,isAdmin:this.isAdmin,isExceptionList:this.isExceptionList,isUseActionMenu:this.isUseActionMenu,addCallback:t.proxy(function(){n.isFunction(this.addCallback)&&this.addCallback(this.getData())},this),removeCallback:t.proxy(function(){n.isFunction(this.removeCallback)&&this.removeCallback(this.getData())},this),useAction:this.useAction}),this.nodePickerView=new y({isAdmin:this.isAdmin,isExceptionList:this.isExceptionList,useApprReception:this.useApprReception,useApprReference:this.useApprReference,observer:s,nodeTypes:n.map(this.nodeTypes,function(e){return"department-nosub"==e?"department":e}),labelVisible:this.withCompanies,callback:t.proxy(function(e){this.nodeListView.addNodeToList(e),this.nodeListView.render()},this),useAction:this.useAction}),this.withCompanies&&(this.companyListView=new m({observer:s,ids:this.companyIds}))},render:function(){return this.nodePickerView.render(),this.nodeListView.render(),this.withCompanies&&(this.companyListView.render(),this.$el.append(this.companyListView.$el)),this.$el.append(this.nodePickerView.$el),this.$el.append(this.nodeListView.$el),this},getData:function(){return{nodes:this.nodeListView.getDataAsJSON()}},show:function(){this.$el.show()},hide:function(){this.$el.hide()},deleteAllData:function(){this.nodeListView.deleteAllNodeFromList()},deleteDataOfCompany:function(e){this.nodeListView.deleteNodeOfCompany(e)}});return S});