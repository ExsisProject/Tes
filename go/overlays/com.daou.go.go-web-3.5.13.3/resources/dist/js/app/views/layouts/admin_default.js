(function(){define(["app","views/layouts/default","admin/views/layout/side_menu_new","admin/views/layout/top_menu","hgn!templates/layouts/admin_default","admin/models/system_menu_list","admin/models/display_config","models/site_config","i18n!nls/commons","i18n!admin/nls/admin","admin/views/layout/sitemap","admin/collections/side_menu_collection","admin/views/layout/admin_guide","GO.util"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=null,d=t.prototype,v=Array.prototype.slice,m,g={tpl:{overlay:'<div id="popOverlay" class="overlay"><div class="processing"></div></div>'}},m=t.extend({initialize:function(){var t=v.call(arguments);d.initialize.apply(this,t),this.variables={};var n=o.read({admin:!0}),r=new Backbone.Model;r.url="/ad/api/mobile/service",r.fetch({async:!1});var i=r.toJSON(),l=u.read({isAdmin:!0}),c=s.read(),h=c.hasApp("board"),p=c.hasApp("calendar"),m=c.hasApp("community"),g=c.hasApp("contact"),y=c.hasApp("webfolder"),b=c.hasApp("asset"),w=c.hasApp("report"),E=c.hasApp("task"),S=c.hasApp("works"),x=c.hasApp("survey"),T=c.hasApp("approval"),N=!1,C=!1,k=!1,L=!1,A=!1,O=!1,M=!1,D=c.hasApp("docs");if(h||m||b||x)C=!0;if(w||E||S)k=!0;T&&(L=!0),i.configValue=="on"&&(N=!0),l.toJSON().mobileAppService=="on"&&(A=!0),l.toJSON().ehrService=="on"&&(O=!0),l.toJSON().smsService=="on"&&(M=!0),_.extend(this.variables,{contextRoot:e.config("contextRoot"),label_logo:this.getLogoName(),label_setting:f["\uc124\uc815"],label_account:f["\uacc4\uc815\uad00\ub9ac"],label_dept:f["\ubd80\uc11c\uad00\ub9ac"],label_statistics:f["\ud1b5\uacc4"],label_mail:a["\uba54\uc77c"],label_file:a["\uc790\ub8cc\uc2e4"],label_address:f["\uc8fc\uc18c\ub85d"],label_appr:f["\uc804\uc790\uacb0\uc7ac"],label_calendar:a["\uce98\ub9b0\ub354"],label_board:a["\uac8c\uc2dc\ud310"],label_community:a["\ucee4\ubba4\ub2c8\ud2f0"],label_asset:f["\uc608\uc57d"],label_mobile:f["\ubaa8\ube4c\ub9ac\ud2f0"],label_admin:f["\uad00\ub9ac\uc790 :"],label_logout:a["\ub85c\uadf8\uc544\uc6c3"],label_guide:a["\ub3c4\uc6c0\ub9d0"],label_survey:a["\uc124\ubb38"],label_report:f["\ubcf4\uace0"],label_task:a["\uc5c5\ubb34"],label_approval:a["\uc804\uc790\uacb0\uc7ac"],label_top_base_setting:f["\uc77c\ubc18"],label_top_account:f["\uacc4\uc815"],label_top_communication:f["\ucee4\ubba4\ub2c8\ucf00\uc774\uc158"],label_top_collaboration:f["\ud611\uc5c5"],label_top_social:f["\uc18c\uc15c"],label_top_approval:f["\uc804\uc790\uacb0\uc7ac_\ud0d1\uba54\ub274"],label_attendance:f["e-HR"],label_sms:f["\ubb38\uc790\ubc1c\uc1a1"],label_docs:f["\ubb38\uc11c\uad00\ub9ac"],model:e.session(),lastLoginedAt:e.util.basicDate(e.session().lastLoginedAt),displayConfig:n.toJSON(),hasBoard:h,hasCommunity:m,hasContact:g,hasCalendar:p,hasFile:y,hasAsset:b,hasReport:w,hasTask:E,hasWorks:S,hasSurvey:x,hasApproval:T,hasMobile:N,hasSocial:C,hasCollaboration:k,hasApprovalLicense:L,hasOrg:e.util.isUseOrgService(!0),logoImg:this.getLogoImg(),hasMobileApp:A,siteName:e.session().companyName,hasEhr:O,hasSms:M,hasDocs:D,isLocaleKo:e.session().locale==="ko",iframeSrc:e.contextRoot+"resources/guide/admin_dostart/admin/start.html",removeDoStartDone:$.cookie("REMOVE_DO_START"+e.session().id)?!0:!1,removeLookAroundOrgDone:$.cookie("REMOVE_LOOK_AROUND_ORG"+e.session().id)?!0:!1})},events:{"click .btn_ic_help3":"viewHelp","click .sitemap":"sitemap","click .popup_admin_gide":"popupAdminGuide","click #do_start_btn, .popup_do_start":"showDoStartLayer","click #do_start_layer .btn_area":"hideDoStartLayer","click #look_around_org_btn":"showLookAroundOrg","click #do_start_btn .ic_cancel_s_w":"removeDoStart","click #look_around_org_btn .ic_cancel_s_w":"removeLookAroundOrg"},render:function(){var e=$.Deferred();return this.renderLayout(),e.resolveWith(this,[this]),this.trigger("rendered:layout",[this]),e},setBrowserTitle:function(){var e=this;setTimeout(function(){var t=e.getTitle();sessionStorage.setItem("browserTitle",t),document.title=t},500)},renderLayout:function(e){this.setBrowserTitle(),e=e||!1;if(!e&&this.isMe())return;this.setCurrentLayout(),this.getPopupElement().remove(),this.$el.find(".tWrap").remove(),this.$el.find(".layer_dostart").remove(),this.$el.find(".btn_dostart").remove(),this.$el.prepend(i(this.variables)),this.resizeSide(),this._initPageEvents(),$("li.more").hide(),this.makeSideMenu(),this.makeTopMenu()},makeTopMenu:function(){var e=new r;this.$el.find("#top_menu").append(e.$el),e.render()},makeSideMenu:function(){var e=new n;this.$el.find(".admin_side_new").append(e.$el),e.render()},setSessionInfo:function(){this.variables["profile?"]=this.profile.toJSON()},getContentElement:function(){return this.$el.find("#layoutContent")},getTitleElement:function(){return this.$el.find("#layoutTitle")},getSideElement:function(){return this.$(".admin_side")},_initPageEvents:function(){e.EventEmitter.on("common","layout:setOverlay",this.setOverlay,this),e.EventEmitter.on("common","layout:clearOverlay",this.clearOverlay,this)},setOverlay:function(){this.clearOverlay(),this.$el.append(g.tpl.overlay)},clearOverlay:function(){this.$el.find("#popOverlay").fadeOut(1e3,function(){$(this).remove()})},clearContent:function(e){var t=this.getContentElement(),n=this.getPopupElement();t.empty(),n.remove()},getLogoName:function(){return e.util.getBrandName(true)=="TMS"?f["TMS Service Admin"]:f["DO Service Admin"]},getLogoImg:function(){return e.util.getBrandName(true)=="TMS"?"/resources/images/admin/logo_admin_site.png":"/resources/images/admin/logo_admin_site_do.png"},getTitle:function(){return e.util.getBrandName(true)=="TMS"?"TMS Site Admin":"DO Site Admin"},viewHelp:function(){var t=jQuery('meta[name="locale"]').attr("content"),n="do";t=="jp"&&(t="ja"),e.util.getBrandName(true)=="TMS"&&(n="tms"),e.util.getServiceType()=="cloud"&&(n="cloud"),window.open("/go/help/"+n+"/"+t+"/site/pdf/"+n+"_site_"+t+".pdf","help","width=1050,height=700,status=yes,scrollbars=no,resizable=no")},popupAdminGuide:function(){this.renderAdminGuideByStep()},renderAdminGuideByStep:function(e){this.adminGuide=new h(e),this.adminGuide.render()},showDoStartLayer:function(){this.$el.find("#do_start_layer").show()},showLookAroundOrg:function(){this.renderAdminGuideByStep({step:"stepOrg1"})},hideDoStartLayer:function(){this.$el.find("#do_start_layer").hide()},removeDoStart:function(t){t.stopPropagation(),this.hideDoStartLayer(),this.$el.find("#do_start_btn").remove(),this.$el.find("#top_menu_help_sub_menu .popup_do_start").parent("li").show(),$.cookie("REMOVE_DO_START"+e.session().id,"done",{expires:3650,path:"/"})},removeLookAroundOrg:function(t){t.stopPropagation(),this.$el.find("#look_around_org_btn").remove(),$.cookie("REMOVE_LOOK_AROUND_ORG"+e.session().id,"done",{expires:3650,path:"/"})},sitemap:function(){this.menuCollection||(this.menuCollection=new c);var e=new l(this.menuCollection);e.render()},selectTopMenu:function(e){selectedGroup="",groupItem=e.split("?")[0];var t=groupItem.split("#");t.length>1?groupItem=t[1]:groupItem=t[0],$.each(topMenu,function(e,t){if($.inArray(groupItem,t)>-1)return selectedGroup=e,!1}),$("#adminTopMenu li").removeClass("on"),$("#adminTopMenu li[data-type='"+selectedGroup+"']").addClass("on"),this.originMenu=groupItem,this.originGroup=selectedGroup}});return new m})}).call(this);