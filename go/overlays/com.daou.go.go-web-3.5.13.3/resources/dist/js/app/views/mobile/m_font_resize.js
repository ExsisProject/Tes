define("views/mobile/m_font_resize",function(require){var e=require("backbone"),t=require("app"),n=require("hgn!templates/mobile/m_font_resize"),r=require("components/backdrop/backdrop"),i=null,s=e.View.extend({events:{"vclick #fontResizeBtn":"_toggleFontResizeLayer","touchmove #fontResizeLayer ul.list_fs":"_moveFontSizeSlide","change #fontResizeLayer input[name=inpFont]":"_changeFontSize"},initialize:function(e){this.targetContentEl=e.targetContentEl,this.$el.addClass("wrap_fontsize")},render:function(){var e=this._getFontSize();return this.$el.html(n()),this.$el.find("#fontResizeLayer li input[value="+e+"]").prop("checked",!0),t.util.contentsParsingForFontSizeResizing($(this.targetContentEl)),this.$el.show(),this.isResizableContent()&&this._resizeFontSize(e),this.el},isResizableContent:function(){return this.$el.length>0},_restoreFontsize:function(){t.util.rollbackFontSizeResizing($(this.targetContentEl))},_getFontSize:function(){var e=t.util.getLocalStorage("lastFontSize_"+t.session().id);return e?e:40},_toggleFontResizeLayer:function(e){this.backdropView=new r,this.backdropView.backdropToggleEl=$("#fontResizeLayer");if(this.backdropView.backdropToggleEl.is(":visible")){this.backdropView.backdropToggleEl.hide();return}this.backdropView.linkBackdrop($(e.currentTarget))},_moveFontSizeSlide:function(e){var t=e.originalEvent.touches[0],n=document.elementFromPoint(t.pageX,t.pageY);$(n)[0]&&$(n)[0].nodeName=="INPUT"&&$(n).trigger("click")},_changeFontSize:function(e){var n=$(e.currentTarget),r=n.val();this._resizeFontSize(parseInt(r)),t.util.setLocalStorage("lastFontSize_"+t.session().id,r)},_hasIframe:function(){return $(this.targetContentEl).find("iframe").length>0},_resizeFontSize:function(e){$(this.targetContentEl).find("span[data-font-resize]").each(function(){var t=$(this).attr("data-origin-fontsize"),n=$(this).attr("data-origin-lineheight"),r=parseFloat(t)+parseFloat(t*e*.01),i=parseFloat(n)+parseFloat(n*e*.01);$(this).css({"font-size":r.toFixed(3)+"px","line-height":i.toFixed(3)+"px"})}),this._hasIframe()&&$.each($(this.targetContentEl).find("iframe"),function(){$(this).contents().find("span[data-font-resize]").each(function(){var t=$(this).attr("data-origin-fontsize"),n=$(this).attr("data-origin-lineheight"),r=parseFloat(t)+parseFloat(t*e*.01),i=parseFloat(n)+parseFloat(n*e*.01);$(this).css({"font-size":r.toFixed(3)+"px","line-height":i.toFixed(3)+"px"})})}),setTimeout(function(){t.util.iscrollRefresh()},500)}});return{render:function(e){return i=new s(e),i.render()},restore:function(){i!=null&&i._restoreFontsize()}}});