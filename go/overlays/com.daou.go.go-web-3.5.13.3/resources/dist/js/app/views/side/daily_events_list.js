(function(){define(["underscore","backbone","app","i18n!nls/commons","i18n!../../../calendar/nls/calendar","../../../calendar/collections/events","hgn!templates/side/daily_events_item","hgn!templates/side/event_regist","hgn!templates/side/daily_events_list"],function(e,t,n,r,i,s,o,u,a){var f,l,c;return c=t.View.extend({tagName:"li",data:{},events:{"click .event":"moveToEventShowPage"},initialize:function(e){this.options=e||{}},render:function(){this.model.get("timeType")=="allday"&&this.$el.addClass("day");var e=[];return e.push("<a class='event'>"),this.model.get("timeType")=="timed"&&(e.push("<span class='time'>"),e.push(this._rephraseDateTime(this.model.get("startTime"))),e.push(" ~ "),e.push(this._rephraseDateTime(this.model.get("endTime"))),e.push("</span>")),e.push("<span class='subject'>"+this.model.get("summary")+"</span>"),e.push("</a>"),this.$el.html(e.join("")),this},moveToEventShowPage:function(){return n.router.navigate("calendar/"+this.model.get("calendarId")+"/event/"+this.model.get("id"),!0),!1},_rephraseDateTime:function(e){return n.util.isSameDate(e,this.options.date)?n.util.hourMinute(e):i["\uacc4\uc18d"]}}),f=t.View.extend({tagName:"li",events:{"click #newEvent":"moveToEventRegist"},initialize:function(e){this.options=e,n.util.isToday(this.options.date)&&this.$el.addClass("today")},moveToEventRegist:function(){return n.router.navigate("calendar/regist?"+$.param({sd:n.util.shortDate(this.options.date)}),!0),!1},render:function(){this._renderTemplate(),this.collection.size()==0?this._renderRegistView():this._renderEventsView()},_renderTemplate:function(){this.$el.html(o({lang:{today:i["\uc624\ub298"]},model:{date:n.util.monthDateDay(this.options.date),isToday:n.util.isToday(this.options.date)}}))},_renderRegistView:function(){this._addSubTemplate(u({lang:{newEvent:i["\uc0c8 \uc77c\uc815"]}}))},_renderEventsView:function(){this.collection.models=e.sortBy(this.collection.models,function(e){return e.get("timeType")=="timed"}),e.each(this.collection.models,function(e){var t=new c({date:this.options.date,model:e});this._addSubTemplate(t.render().$el)},this)},_addSubTemplate:function(e){var t=this.$el.find("ul.item",this.$el);t.append(e)}}),l=t.View.extend({tagName:"section",className:"side_calendar",datePattern:"YYYY-MM-DD",startOfToday:null,events:{"click #newEvent":"moveToEventRegist","click #go_calendar_app":"moveToEventList"},initialize:function(){this.startOfToday=moment().startOf("days")},render:function(){return this._initTemplate(),this.$el},moveToEventRegist:function(){return n.router.navigate("calendar/regist",!0),!1},moveToEventList:function(){return n.router.navigate("calendar",!0),!1},_initTemplate:function(){this.$el.html(a({model:{isToday:n.util.isToday(this.startOfToday)},lang:{today:i["\uc624\ub298"],title:i["\ub0b4 \uc77c\uc815"],more_button:r["\uc790\uc138\ud788 \ubcf4\uae30"],new_button:r["\ucd94\uac00"],new_label:i["\uc0c8 \uc77c\uc815"]}}))},render3DaysEvents:function(t){var n=this.$el.find(".briefing_list");return n.empty(),e.each(t,function(e){var t=new f({collection:new s(e.get("eventList")),date:e.get("datetime")});t.render(),n.append(t.el)},this),this.$el}}),l})}).call(this);